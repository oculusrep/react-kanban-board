var o2=Object.defineProperty;var l2=(e,t,r)=>t in e?o2(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var ae=(e,t,r)=>(l2(e,typeof t!="symbol"?t+"":t,r),r);function Wv(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var Dt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function pl(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Hv(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var s=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return e[n]}})}),r}var qv={exports:{}},Qu={},Vv={exports:{}},_e={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gl=Symbol.for("react.element"),c2=Symbol.for("react.portal"),u2=Symbol.for("react.fragment"),d2=Symbol.for("react.strict_mode"),f2=Symbol.for("react.profiler"),m2=Symbol.for("react.provider"),h2=Symbol.for("react.context"),p2=Symbol.for("react.forward_ref"),g2=Symbol.for("react.suspense"),x2=Symbol.for("react.memo"),y2=Symbol.for("react.lazy"),k0=Symbol.iterator;function b2(e){return e===null||typeof e!="object"?null:(e=k0&&e[k0]||e["@@iterator"],typeof e=="function"?e:null)}var Yv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Gv=Object.assign,Kv={};function yi(e,t,r){this.props=e,this.context=t,this.refs=Kv,this.updater=r||Yv}yi.prototype.isReactComponent={};yi.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};yi.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Qv(){}Qv.prototype=yi.prototype;function rp(e,t,r){this.props=e,this.context=t,this.refs=Kv,this.updater=r||Yv}var np=rp.prototype=new Qv;np.constructor=rp;Gv(np,yi.prototype);np.isPureReactComponent=!0;var N0=Array.isArray,Jv=Object.prototype.hasOwnProperty,sp={current:null},Xv={key:!0,ref:!0,__self:!0,__source:!0};function Zv(e,t,r){var n,s={},a=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(a=""+t.key),t)Jv.call(t,n)&&!Xv.hasOwnProperty(n)&&(s[n]=t[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:gl,type:e,key:a,ref:o,props:s,_owner:sp.current}}function v2(e,t){return{$$typeof:gl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function ap(e){return typeof e=="object"&&e!==null&&e.$$typeof===gl}function w2(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var S0=/\/+/g;function qd(e,t){return typeof e=="object"&&e!==null&&e.key!=null?w2(""+e.key):t.toString(36)}function Cc(e,t,r,n,s){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case gl:case c2:o=!0}}if(o)return o=e,s=s(o),e=n===""?"."+qd(o,0):n,N0(s)?(r="",e!=null&&(r=e.replace(S0,"$&/")+"/"),Cc(s,t,r,"",function(u){return u})):s!=null&&(ap(s)&&(s=v2(s,r+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(S0,"$&/")+"/")+e)),t.push(s)),1;if(o=0,n=n===""?".":n+":",N0(e))for(var l=0;l<e.length;l++){a=e[l];var c=n+qd(a,l);o+=Cc(a,t,r,c,s)}else if(c=b2(e),typeof c=="function")for(e=c.call(e),l=0;!(a=e.next()).done;)a=a.value,c=n+qd(a,l++),o+=Cc(a,t,r,c,s);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function $l(e,t,r){if(e==null)return e;var n=[],s=0;return Cc(e,n,"","",function(a){return t.call(r,a,s++)}),n}function _2(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Bt={current:null},Ec={transition:null},j2={ReactCurrentDispatcher:Bt,ReactCurrentBatchConfig:Ec,ReactCurrentOwner:sp};function ew(){throw Error("act(...) is not supported in production builds of React.")}_e.Children={map:$l,forEach:function(e,t,r){$l(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return $l(e,function(){t++}),t},toArray:function(e){return $l(e,function(t){return t})||[]},only:function(e){if(!ap(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};_e.Component=yi;_e.Fragment=u2;_e.Profiler=f2;_e.PureComponent=rp;_e.StrictMode=d2;_e.Suspense=g2;_e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=j2;_e.act=ew;_e.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Gv({},e.props),s=e.key,a=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,o=sp.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)Jv.call(t,c)&&!Xv.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:gl,type:e.type,key:s,ref:a,props:n,_owner:o}};_e.createContext=function(e){return e={$$typeof:h2,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:m2,_context:e},e.Consumer=e};_e.createElement=Zv;_e.createFactory=function(e){var t=Zv.bind(null,e);return t.type=e,t};_e.createRef=function(){return{current:null}};_e.forwardRef=function(e){return{$$typeof:p2,render:e}};_e.isValidElement=ap;_e.lazy=function(e){return{$$typeof:y2,_payload:{_status:-1,_result:e},_init:_2}};_e.memo=function(e,t){return{$$typeof:x2,type:e,compare:t===void 0?null:t}};_e.startTransition=function(e){var t=Ec.transition;Ec.transition={};try{e()}finally{Ec.transition=t}};_e.unstable_act=ew;_e.useCallback=function(e,t){return Bt.current.useCallback(e,t)};_e.useContext=function(e){return Bt.current.useContext(e)};_e.useDebugValue=function(){};_e.useDeferredValue=function(e){return Bt.current.useDeferredValue(e)};_e.useEffect=function(e,t){return Bt.current.useEffect(e,t)};_e.useId=function(){return Bt.current.useId()};_e.useImperativeHandle=function(e,t,r){return Bt.current.useImperativeHandle(e,t,r)};_e.useInsertionEffect=function(e,t){return Bt.current.useInsertionEffect(e,t)};_e.useLayoutEffect=function(e,t){return Bt.current.useLayoutEffect(e,t)};_e.useMemo=function(e,t){return Bt.current.useMemo(e,t)};_e.useReducer=function(e,t,r){return Bt.current.useReducer(e,t,r)};_e.useRef=function(e){return Bt.current.useRef(e)};_e.useState=function(e){return Bt.current.useState(e)};_e.useSyncExternalStore=function(e,t,r){return Bt.current.useSyncExternalStore(e,t,r)};_e.useTransition=function(){return Bt.current.useTransition()};_e.version="18.3.1";Vv.exports=_e;var x=Vv.exports;const H=pl(x),tw=Wv({__proto__:null,default:H},[x]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var k2=x,N2=Symbol.for("react.element"),S2=Symbol.for("react.fragment"),C2=Object.prototype.hasOwnProperty,E2=k2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,D2={key:!0,ref:!0,__self:!0,__source:!0};function rw(e,t,r){var n,s={},a=null,o=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)C2.call(t,n)&&!D2.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:N2,type:e,key:a,ref:o,props:s,_owner:E2.current}}Qu.Fragment=S2;Qu.jsx=rw;Qu.jsxs=rw;qv.exports=Qu;var i=qv.exports,bm={},nw={exports:{}},ur={},sw={exports:{}},aw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(R,P){var D=R.length;R.push(P);e:for(;0<D;){var z=D-1>>>1,W=R[z];if(0<s(W,P))R[z]=P,R[D]=W,D=z;else break e}}function r(R){return R.length===0?null:R[0]}function n(R){if(R.length===0)return null;var P=R[0],D=R.pop();if(D!==P){R[0]=D;e:for(var z=0,W=R.length,I=W>>>1;z<I;){var ne=2*(z+1)-1,re=R[ne],Q=ne+1,U=R[Q];if(0>s(re,D))Q<W&&0>s(U,re)?(R[z]=U,R[Q]=D,z=Q):(R[z]=re,R[ne]=D,z=ne);else if(Q<W&&0>s(U,D))R[z]=U,R[Q]=D,z=Q;else break e}}return P}function s(R,P){var D=R.sortIndex-P.sortIndex;return D!==0?D:R.id-P.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,f=null,m=3,h=!1,y=!1,v=!1,w=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function p(R){for(var P=r(u);P!==null;){if(P.callback===null)n(u);else if(P.startTime<=R)n(u),P.sortIndex=P.expirationTime,t(c,P);else break;P=r(u)}}function _(R){if(v=!1,p(R),!y)if(r(c)!==null)y=!0,B(j);else{var P=r(u);P!==null&&F(_,P.startTime-R)}}function j(R,P){y=!1,v&&(v=!1,g(S),S=-1),h=!0;var D=m;try{for(p(P),f=r(c);f!==null&&(!(f.expirationTime>P)||R&&!T());){var z=f.callback;if(typeof z=="function"){f.callback=null,m=f.priorityLevel;var W=z(f.expirationTime<=P);P=e.unstable_now(),typeof W=="function"?f.callback=W:f===r(c)&&n(c),p(P)}else n(c);f=r(c)}if(f!==null)var I=!0;else{var ne=r(u);ne!==null&&F(_,ne.startTime-P),I=!1}return I}finally{f=null,m=D,h=!1}}var k=!1,N=null,S=-1,C=5,E=-1;function T(){return!(e.unstable_now()-E<C)}function L(){if(N!==null){var R=e.unstable_now();E=R;var P=!0;try{P=N(!0,R)}finally{P?O():(k=!1,N=null)}}else k=!1}var O;if(typeof b=="function")O=function(){b(L)};else if(typeof MessageChannel<"u"){var A=new MessageChannel,M=A.port2;A.port1.onmessage=L,O=function(){M.postMessage(null)}}else O=function(){w(L,0)};function B(R){N=R,k||(k=!0,O())}function F(R,P){S=w(function(){R(e.unstable_now())},P)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(R){R.callback=null},e.unstable_continueExecution=function(){y||h||(y=!0,B(j))},e.unstable_forceFrameRate=function(R){0>R||125<R?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<R?Math.floor(1e3/R):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(R){switch(m){case 1:case 2:case 3:var P=3;break;default:P=m}var D=m;m=P;try{return R()}finally{m=D}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(R,P){switch(R){case 1:case 2:case 3:case 4:case 5:break;default:R=3}var D=m;m=R;try{return P()}finally{m=D}},e.unstable_scheduleCallback=function(R,P,D){var z=e.unstable_now();switch(typeof D=="object"&&D!==null?(D=D.delay,D=typeof D=="number"&&0<D?z+D:z):D=z,R){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=D+W,R={id:d++,callback:P,priorityLevel:R,startTime:D,expirationTime:W,sortIndex:-1},D>z?(R.sortIndex=D,t(u,R),r(c)===null&&R===r(u)&&(v?(g(S),S=-1):v=!0,F(_,D-z))):(R.sortIndex=W,t(c,R),y||h||(y=!0,B(j))),R},e.unstable_shouldYield=T,e.unstable_wrapCallback=function(R){var P=m;return function(){var D=m;m=P;try{return R.apply(this,arguments)}finally{m=D}}}})(aw);sw.exports=aw;var P2=sw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T2=x,cr=P2;function G(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var iw=new Set,$o={};function ua(e,t){Za(e,t),Za(e+"Capture",t)}function Za(e,t){for($o[e]=t,e=0;e<t.length;e++)iw.add(t[e])}var Mn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),vm=Object.prototype.hasOwnProperty,L2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,C0={},E0={};function I2(e){return vm.call(E0,e)?!0:vm.call(C0,e)?!1:L2.test(e)?E0[e]=!0:(C0[e]=!0,!1)}function R2(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function M2(e,t,r,n){if(t===null||typeof t>"u"||R2(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ut(e,t,r,n,s,a,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var jt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){jt[e]=new Ut(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];jt[t]=new Ut(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){jt[e]=new Ut(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){jt[e]=new Ut(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){jt[e]=new Ut(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){jt[e]=new Ut(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){jt[e]=new Ut(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){jt[e]=new Ut(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){jt[e]=new Ut(e,5,!1,e.toLowerCase(),null,!1,!1)});var ip=/[\-:]([a-z])/g;function op(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(ip,op);jt[t]=new Ut(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(ip,op);jt[t]=new Ut(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(ip,op);jt[t]=new Ut(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){jt[e]=new Ut(e,1,!1,e.toLowerCase(),null,!1,!1)});jt.xlinkHref=new Ut("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){jt[e]=new Ut(e,1,!1,e.toLowerCase(),null,!0,!0)});function lp(e,t,r,n){var s=jt.hasOwnProperty(t)?jt[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(M2(t,r,s,n)&&(r=null),n||s===null?I2(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Un=T2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Fl=Symbol.for("react.element"),Ea=Symbol.for("react.portal"),Da=Symbol.for("react.fragment"),cp=Symbol.for("react.strict_mode"),wm=Symbol.for("react.profiler"),ow=Symbol.for("react.provider"),lw=Symbol.for("react.context"),up=Symbol.for("react.forward_ref"),_m=Symbol.for("react.suspense"),jm=Symbol.for("react.suspense_list"),dp=Symbol.for("react.memo"),Kn=Symbol.for("react.lazy"),cw=Symbol.for("react.offscreen"),D0=Symbol.iterator;function Ai(e){return e===null||typeof e!="object"?null:(e=D0&&e[D0]||e["@@iterator"],typeof e=="function"?e:null)}var et=Object.assign,Vd;function mo(e){if(Vd===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Vd=t&&t[1]||""}return`
`+Vd+e}var Yd=!1;function Gd(e,t){if(!e||Yd)return"";Yd=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),a=n.stack.split(`
`),o=s.length-1,l=a.length-1;1<=o&&0<=l&&s[o]!==a[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==a[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==a[l]){var c=`
`+s[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{Yd=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?mo(e):""}function O2(e){switch(e.tag){case 5:return mo(e.type);case 16:return mo("Lazy");case 13:return mo("Suspense");case 19:return mo("SuspenseList");case 0:case 2:case 15:return e=Gd(e.type,!1),e;case 11:return e=Gd(e.type.render,!1),e;case 1:return e=Gd(e.type,!0),e;default:return""}}function km(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Da:return"Fragment";case Ea:return"Portal";case wm:return"Profiler";case cp:return"StrictMode";case _m:return"Suspense";case jm:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case lw:return(e.displayName||"Context")+".Consumer";case ow:return(e._context.displayName||"Context")+".Provider";case up:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case dp:return t=e.displayName||null,t!==null?t:km(e.type)||"Memo";case Kn:t=e._payload,e=e._init;try{return km(e(t))}catch{}}return null}function A2(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return km(t);case 8:return t===cp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function gs(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function uw(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function $2(e){var t=uw(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){n=""+o,a.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Bl(e){e._valueTracker||(e._valueTracker=$2(e))}function dw(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=uw(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Xc(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Nm(e,t){var r=t.checked;return et({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function P0(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=gs(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function fw(e,t){t=t.checked,t!=null&&lp(e,"checked",t,!1)}function Sm(e,t){fw(e,t);var r=gs(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Cm(e,t.type,r):t.hasOwnProperty("defaultValue")&&Cm(e,t.type,gs(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function T0(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Cm(e,t,r){(t!=="number"||Xc(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var ho=Array.isArray;function za(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+gs(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Em(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(G(91));return et({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function L0(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(G(92));if(ho(r)){if(1<r.length)throw Error(G(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:gs(r)}}function mw(e,t){var r=gs(t.value),n=gs(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function I0(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function hw(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Dm(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?hw(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ul,pw=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ul=Ul||document.createElement("div"),Ul.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ul.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Fo(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var vo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},F2=["Webkit","ms","Moz","O"];Object.keys(vo).forEach(function(e){F2.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),vo[t]=vo[e]})});function gw(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||vo.hasOwnProperty(e)&&vo[e]?(""+t).trim():t+"px"}function xw(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=gw(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var B2=et({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Pm(e,t){if(t){if(B2[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(G(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(G(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(G(61))}if(t.style!=null&&typeof t.style!="object")throw Error(G(62))}}function Tm(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Lm=null;function fp(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Im=null,Wa=null,Ha=null;function R0(e){if(e=bl(e)){if(typeof Im!="function")throw Error(G(280));var t=e.stateNode;t&&(t=td(t),Im(e.stateNode,e.type,t))}}function yw(e){Wa?Ha?Ha.push(e):Ha=[e]:Wa=e}function bw(){if(Wa){var e=Wa,t=Ha;if(Ha=Wa=null,R0(e),t)for(e=0;e<t.length;e++)R0(t[e])}}function vw(e,t){return e(t)}function ww(){}var Kd=!1;function _w(e,t,r){if(Kd)return e(t,r);Kd=!0;try{return vw(e,t,r)}finally{Kd=!1,(Wa!==null||Ha!==null)&&(ww(),bw())}}function Bo(e,t){var r=e.stateNode;if(r===null)return null;var n=td(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(G(231,t,typeof r));return r}var Rm=!1;if(Mn)try{var $i={};Object.defineProperty($i,"passive",{get:function(){Rm=!0}}),window.addEventListener("test",$i,$i),window.removeEventListener("test",$i,$i)}catch{Rm=!1}function U2(e,t,r,n,s,a,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var wo=!1,Zc=null,eu=!1,Mm=null,z2={onError:function(e){wo=!0,Zc=e}};function W2(e,t,r,n,s,a,o,l,c){wo=!1,Zc=null,U2.apply(z2,arguments)}function H2(e,t,r,n,s,a,o,l,c){if(W2.apply(this,arguments),wo){if(wo){var u=Zc;wo=!1,Zc=null}else throw Error(G(198));eu||(eu=!0,Mm=u)}}function da(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function jw(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function M0(e){if(da(e)!==e)throw Error(G(188))}function q2(e){var t=e.alternate;if(!t){if(t=da(e),t===null)throw Error(G(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return M0(s),e;if(a===n)return M0(s),t;a=a.sibling}throw Error(G(188))}if(r.return!==n.return)r=s,n=a;else{for(var o=!1,l=s.child;l;){if(l===r){o=!0,r=s,n=a;break}if(l===n){o=!0,n=s,r=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===r){o=!0,r=a,n=s;break}if(l===n){o=!0,n=a,r=s;break}l=l.sibling}if(!o)throw Error(G(189))}}if(r.alternate!==n)throw Error(G(190))}if(r.tag!==3)throw Error(G(188));return r.stateNode.current===r?e:t}function kw(e){return e=q2(e),e!==null?Nw(e):null}function Nw(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Nw(e);if(t!==null)return t;e=e.sibling}return null}var Sw=cr.unstable_scheduleCallback,O0=cr.unstable_cancelCallback,V2=cr.unstable_shouldYield,Y2=cr.unstable_requestPaint,st=cr.unstable_now,G2=cr.unstable_getCurrentPriorityLevel,mp=cr.unstable_ImmediatePriority,Cw=cr.unstable_UserBlockingPriority,tu=cr.unstable_NormalPriority,K2=cr.unstable_LowPriority,Ew=cr.unstable_IdlePriority,Ju=null,cn=null;function Q2(e){if(cn&&typeof cn.onCommitFiberRoot=="function")try{cn.onCommitFiberRoot(Ju,e,void 0,(e.current.flags&128)===128)}catch{}}var Ar=Math.clz32?Math.clz32:Z2,J2=Math.log,X2=Math.LN2;function Z2(e){return e>>>=0,e===0?32:31-(J2(e)/X2|0)|0}var zl=64,Wl=4194304;function po(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ru(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,a=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~s;l!==0?n=po(l):(a&=o,a!==0&&(n=po(a)))}else o=r&~s,o!==0?n=po(o):a!==0&&(n=po(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,a=t&-t,s>=a||s===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Ar(t),s=1<<r,n|=e[r],t&=~s;return n}function eS(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function tS(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-Ar(a),l=1<<o,c=s[o];c===-1?(!(l&r)||l&n)&&(s[o]=eS(l,t)):c<=t&&(e.expiredLanes|=l),a&=~l}}function Om(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Dw(){var e=zl;return zl<<=1,!(zl&4194240)&&(zl=64),e}function Qd(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function xl(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ar(t),e[t]=r}function rS(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-Ar(r),a=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~a}}function hp(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Ar(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var Fe=0;function Pw(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Tw,pp,Lw,Iw,Rw,Am=!1,Hl=[],ss=null,as=null,is=null,Uo=new Map,zo=new Map,Xn=[],nS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function A0(e,t){switch(e){case"focusin":case"focusout":ss=null;break;case"dragenter":case"dragleave":as=null;break;case"mouseover":case"mouseout":is=null;break;case"pointerover":case"pointerout":Uo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":zo.delete(t.pointerId)}}function Fi(e,t,r,n,s,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},t!==null&&(t=bl(t),t!==null&&pp(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function sS(e,t,r,n,s){switch(t){case"focusin":return ss=Fi(ss,e,t,r,n,s),!0;case"dragenter":return as=Fi(as,e,t,r,n,s),!0;case"mouseover":return is=Fi(is,e,t,r,n,s),!0;case"pointerover":var a=s.pointerId;return Uo.set(a,Fi(Uo.get(a)||null,e,t,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,zo.set(a,Fi(zo.get(a)||null,e,t,r,n,s)),!0}return!1}function Mw(e){var t=Hs(e.target);if(t!==null){var r=da(t);if(r!==null){if(t=r.tag,t===13){if(t=jw(r),t!==null){e.blockedOn=t,Rw(e.priority,function(){Lw(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Dc(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=$m(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Lm=n,r.target.dispatchEvent(n),Lm=null}else return t=bl(r),t!==null&&pp(t),e.blockedOn=r,!1;t.shift()}return!0}function $0(e,t,r){Dc(e)&&r.delete(t)}function aS(){Am=!1,ss!==null&&Dc(ss)&&(ss=null),as!==null&&Dc(as)&&(as=null),is!==null&&Dc(is)&&(is=null),Uo.forEach($0),zo.forEach($0)}function Bi(e,t){e.blockedOn===t&&(e.blockedOn=null,Am||(Am=!0,cr.unstable_scheduleCallback(cr.unstable_NormalPriority,aS)))}function Wo(e){function t(s){return Bi(s,e)}if(0<Hl.length){Bi(Hl[0],e);for(var r=1;r<Hl.length;r++){var n=Hl[r];n.blockedOn===e&&(n.blockedOn=null)}}for(ss!==null&&Bi(ss,e),as!==null&&Bi(as,e),is!==null&&Bi(is,e),Uo.forEach(t),zo.forEach(t),r=0;r<Xn.length;r++)n=Xn[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Xn.length&&(r=Xn[0],r.blockedOn===null);)Mw(r),r.blockedOn===null&&Xn.shift()}var qa=Un.ReactCurrentBatchConfig,nu=!0;function iS(e,t,r,n){var s=Fe,a=qa.transition;qa.transition=null;try{Fe=1,gp(e,t,r,n)}finally{Fe=s,qa.transition=a}}function oS(e,t,r,n){var s=Fe,a=qa.transition;qa.transition=null;try{Fe=4,gp(e,t,r,n)}finally{Fe=s,qa.transition=a}}function gp(e,t,r,n){if(nu){var s=$m(e,t,r,n);if(s===null)of(e,t,n,su,r),A0(e,n);else if(sS(s,e,t,r,n))n.stopPropagation();else if(A0(e,n),t&4&&-1<nS.indexOf(e)){for(;s!==null;){var a=bl(s);if(a!==null&&Tw(a),a=$m(e,t,r,n),a===null&&of(e,t,n,su,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else of(e,t,n,null,r)}}var su=null;function $m(e,t,r,n){if(su=null,e=fp(n),e=Hs(e),e!==null)if(t=da(e),t===null)e=null;else if(r=t.tag,r===13){if(e=jw(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return su=e,null}function Ow(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(G2()){case mp:return 1;case Cw:return 4;case tu:case K2:return 16;case Ew:return 536870912;default:return 16}default:return 16}}var rs=null,xp=null,Pc=null;function Aw(){if(Pc)return Pc;var e,t=xp,r=t.length,n,s="value"in rs?rs.value:rs.textContent,a=s.length;for(e=0;e<r&&t[e]===s[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===s[a-n];n++);return Pc=s.slice(e,1<n?1-n:void 0)}function Tc(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ql(){return!0}function F0(){return!1}function dr(e){function t(r,n,s,a,o){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?ql:F0,this.isPropagationStopped=F0,this}return et(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=ql)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=ql)},persist:function(){},isPersistent:ql}),t}var bi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},yp=dr(bi),yl=et({},bi,{view:0,detail:0}),lS=dr(yl),Jd,Xd,Ui,Xu=et({},yl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bp,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ui&&(Ui&&e.type==="mousemove"?(Jd=e.screenX-Ui.screenX,Xd=e.screenY-Ui.screenY):Xd=Jd=0,Ui=e),Jd)},movementY:function(e){return"movementY"in e?e.movementY:Xd}}),B0=dr(Xu),cS=et({},Xu,{dataTransfer:0}),uS=dr(cS),dS=et({},yl,{relatedTarget:0}),Zd=dr(dS),fS=et({},bi,{animationName:0,elapsedTime:0,pseudoElement:0}),mS=dr(fS),hS=et({},bi,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),pS=dr(hS),gS=et({},bi,{data:0}),U0=dr(gS),xS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},yS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},bS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function vS(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=bS[e])?!!t[e]:!1}function bp(){return vS}var wS=et({},yl,{key:function(e){if(e.key){var t=xS[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Tc(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?yS[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bp,charCode:function(e){return e.type==="keypress"?Tc(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Tc(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),_S=dr(wS),jS=et({},Xu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),z0=dr(jS),kS=et({},yl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bp}),NS=dr(kS),SS=et({},bi,{propertyName:0,elapsedTime:0,pseudoElement:0}),CS=dr(SS),ES=et({},Xu,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),DS=dr(ES),PS=[9,13,27,32],vp=Mn&&"CompositionEvent"in window,_o=null;Mn&&"documentMode"in document&&(_o=document.documentMode);var TS=Mn&&"TextEvent"in window&&!_o,$w=Mn&&(!vp||_o&&8<_o&&11>=_o),W0=String.fromCharCode(32),H0=!1;function Fw(e,t){switch(e){case"keyup":return PS.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bw(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Pa=!1;function LS(e,t){switch(e){case"compositionend":return Bw(t);case"keypress":return t.which!==32?null:(H0=!0,W0);case"textInput":return e=t.data,e===W0&&H0?null:e;default:return null}}function IS(e,t){if(Pa)return e==="compositionend"||!vp&&Fw(e,t)?(e=Aw(),Pc=xp=rs=null,Pa=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return $w&&t.locale!=="ko"?null:t.data;default:return null}}var RS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function q0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!RS[e.type]:t==="textarea"}function Uw(e,t,r,n){yw(n),t=au(t,"onChange"),0<t.length&&(r=new yp("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var jo=null,Ho=null;function MS(e){Xw(e,0)}function Zu(e){var t=Ia(e);if(dw(t))return e}function OS(e,t){if(e==="change")return t}var zw=!1;if(Mn){var ef;if(Mn){var tf="oninput"in document;if(!tf){var V0=document.createElement("div");V0.setAttribute("oninput","return;"),tf=typeof V0.oninput=="function"}ef=tf}else ef=!1;zw=ef&&(!document.documentMode||9<document.documentMode)}function Y0(){jo&&(jo.detachEvent("onpropertychange",Ww),Ho=jo=null)}function Ww(e){if(e.propertyName==="value"&&Zu(Ho)){var t=[];Uw(t,Ho,e,fp(e)),_w(MS,t)}}function AS(e,t,r){e==="focusin"?(Y0(),jo=t,Ho=r,jo.attachEvent("onpropertychange",Ww)):e==="focusout"&&Y0()}function $S(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Zu(Ho)}function FS(e,t){if(e==="click")return Zu(t)}function BS(e,t){if(e==="input"||e==="change")return Zu(t)}function US(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Br=typeof Object.is=="function"?Object.is:US;function qo(e,t){if(Br(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!vm.call(t,s)||!Br(e[s],t[s]))return!1}return!0}function G0(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function K0(e,t){var r=G0(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=G0(r)}}function Hw(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Hw(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function qw(){for(var e=window,t=Xc();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Xc(e.document)}return t}function wp(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function zS(e){var t=qw(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Hw(r.ownerDocument.documentElement,r)){if(n!==null&&wp(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!e.extend&&a>n&&(s=n,n=a,a=s),s=K0(r,a);var o=K0(r,n);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var WS=Mn&&"documentMode"in document&&11>=document.documentMode,Ta=null,Fm=null,ko=null,Bm=!1;function Q0(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Bm||Ta==null||Ta!==Xc(n)||(n=Ta,"selectionStart"in n&&wp(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),ko&&qo(ko,n)||(ko=n,n=au(Fm,"onSelect"),0<n.length&&(t=new yp("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Ta)))}function Vl(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var La={animationend:Vl("Animation","AnimationEnd"),animationiteration:Vl("Animation","AnimationIteration"),animationstart:Vl("Animation","AnimationStart"),transitionend:Vl("Transition","TransitionEnd")},rf={},Vw={};Mn&&(Vw=document.createElement("div").style,"AnimationEvent"in window||(delete La.animationend.animation,delete La.animationiteration.animation,delete La.animationstart.animation),"TransitionEvent"in window||delete La.transitionend.transition);function ed(e){if(rf[e])return rf[e];if(!La[e])return e;var t=La[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Vw)return rf[e]=t[r];return e}var Yw=ed("animationend"),Gw=ed("animationiteration"),Kw=ed("animationstart"),Qw=ed("transitionend"),Jw=new Map,J0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function vs(e,t){Jw.set(e,t),ua(t,[e])}for(var nf=0;nf<J0.length;nf++){var sf=J0[nf],HS=sf.toLowerCase(),qS=sf[0].toUpperCase()+sf.slice(1);vs(HS,"on"+qS)}vs(Yw,"onAnimationEnd");vs(Gw,"onAnimationIteration");vs(Kw,"onAnimationStart");vs("dblclick","onDoubleClick");vs("focusin","onFocus");vs("focusout","onBlur");vs(Qw,"onTransitionEnd");Za("onMouseEnter",["mouseout","mouseover"]);Za("onMouseLeave",["mouseout","mouseover"]);Za("onPointerEnter",["pointerout","pointerover"]);Za("onPointerLeave",["pointerout","pointerover"]);ua("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ua("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ua("onBeforeInput",["compositionend","keypress","textInput","paste"]);ua("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ua("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ua("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var go="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),VS=new Set("cancel close invalid load scroll toggle".split(" ").concat(go));function X0(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,H2(n,t,void 0,e),e.currentTarget=null}function Xw(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==a&&s.isPropagationStopped())break e;X0(s,l,u),a=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==a&&s.isPropagationStopped())break e;X0(s,l,u),a=c}}}if(eu)throw e=Mm,eu=!1,Mm=null,e}function Ve(e,t){var r=t[qm];r===void 0&&(r=t[qm]=new Set);var n=e+"__bubble";r.has(n)||(Zw(t,e,2,!1),r.add(n))}function af(e,t,r){var n=0;t&&(n|=4),Zw(r,e,n,t)}var Yl="_reactListening"+Math.random().toString(36).slice(2);function Vo(e){if(!e[Yl]){e[Yl]=!0,iw.forEach(function(r){r!=="selectionchange"&&(VS.has(r)||af(r,!1,e),af(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Yl]||(t[Yl]=!0,af("selectionchange",!1,t))}}function Zw(e,t,r,n){switch(Ow(t)){case 1:var s=iS;break;case 4:s=oS;break;default:s=gp}r=s.bind(null,t,r,e),s=void 0,!Rm||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function of(e,t,r,n,s){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=Hs(l),o===null)return;if(c=o.tag,c===5||c===6){n=a=o;continue e}l=l.parentNode}}n=n.return}_w(function(){var u=a,d=fp(r),f=[];e:{var m=Jw.get(e);if(m!==void 0){var h=yp,y=e;switch(e){case"keypress":if(Tc(r)===0)break e;case"keydown":case"keyup":h=_S;break;case"focusin":y="focus",h=Zd;break;case"focusout":y="blur",h=Zd;break;case"beforeblur":case"afterblur":h=Zd;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=B0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=uS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=NS;break;case Yw:case Gw:case Kw:h=mS;break;case Qw:h=CS;break;case"scroll":h=lS;break;case"wheel":h=DS;break;case"copy":case"cut":case"paste":h=pS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=z0}var v=(t&4)!==0,w=!v&&e==="scroll",g=v?m!==null?m+"Capture":null:m;v=[];for(var b=u,p;b!==null;){p=b;var _=p.stateNode;if(p.tag===5&&_!==null&&(p=_,g!==null&&(_=Bo(b,g),_!=null&&v.push(Yo(b,_,p)))),w)break;b=b.return}0<v.length&&(m=new h(m,y,null,r,d),f.push({event:m,listeners:v}))}}if(!(t&7)){e:{if(m=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",m&&r!==Lm&&(y=r.relatedTarget||r.fromElement)&&(Hs(y)||y[On]))break e;if((h||m)&&(m=d.window===d?d:(m=d.ownerDocument)?m.defaultView||m.parentWindow:window,h?(y=r.relatedTarget||r.toElement,h=u,y=y?Hs(y):null,y!==null&&(w=da(y),y!==w||y.tag!==5&&y.tag!==6)&&(y=null)):(h=null,y=u),h!==y)){if(v=B0,_="onMouseLeave",g="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(v=z0,_="onPointerLeave",g="onPointerEnter",b="pointer"),w=h==null?m:Ia(h),p=y==null?m:Ia(y),m=new v(_,b+"leave",h,r,d),m.target=w,m.relatedTarget=p,_=null,Hs(d)===u&&(v=new v(g,b+"enter",y,r,d),v.target=p,v.relatedTarget=w,_=v),w=_,h&&y)t:{for(v=h,g=y,b=0,p=v;p;p=xa(p))b++;for(p=0,_=g;_;_=xa(_))p++;for(;0<b-p;)v=xa(v),b--;for(;0<p-b;)g=xa(g),p--;for(;b--;){if(v===g||g!==null&&v===g.alternate)break t;v=xa(v),g=xa(g)}v=null}else v=null;h!==null&&Z0(f,m,h,v,!1),y!==null&&w!==null&&Z0(f,w,y,v,!0)}}e:{if(m=u?Ia(u):window,h=m.nodeName&&m.nodeName.toLowerCase(),h==="select"||h==="input"&&m.type==="file")var j=OS;else if(q0(m))if(zw)j=BS;else{j=$S;var k=AS}else(h=m.nodeName)&&h.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(j=FS);if(j&&(j=j(e,u))){Uw(f,j,r,d);break e}k&&k(e,m,u),e==="focusout"&&(k=m._wrapperState)&&k.controlled&&m.type==="number"&&Cm(m,"number",m.value)}switch(k=u?Ia(u):window,e){case"focusin":(q0(k)||k.contentEditable==="true")&&(Ta=k,Fm=u,ko=null);break;case"focusout":ko=Fm=Ta=null;break;case"mousedown":Bm=!0;break;case"contextmenu":case"mouseup":case"dragend":Bm=!1,Q0(f,r,d);break;case"selectionchange":if(WS)break;case"keydown":case"keyup":Q0(f,r,d)}var N;if(vp)e:{switch(e){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else Pa?Fw(e,r)&&(S="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(S="onCompositionStart");S&&($w&&r.locale!=="ko"&&(Pa||S!=="onCompositionStart"?S==="onCompositionEnd"&&Pa&&(N=Aw()):(rs=d,xp="value"in rs?rs.value:rs.textContent,Pa=!0)),k=au(u,S),0<k.length&&(S=new U0(S,e,null,r,d),f.push({event:S,listeners:k}),N?S.data=N:(N=Bw(r),N!==null&&(S.data=N)))),(N=TS?LS(e,r):IS(e,r))&&(u=au(u,"onBeforeInput"),0<u.length&&(d=new U0("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=N))}Xw(f,t)})}function Yo(e,t,r){return{instance:e,listener:t,currentTarget:r}}function au(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=Bo(e,r),a!=null&&n.unshift(Yo(e,a,s)),a=Bo(e,t),a!=null&&n.push(Yo(e,a,s))),e=e.return}return n}function xa(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Z0(e,t,r,n,s){for(var a=t._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,s?(c=Bo(r,a),c!=null&&o.unshift(Yo(r,c,l))):s||(c=Bo(r,a),c!=null&&o.push(Yo(r,c,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var YS=/\r\n?/g,GS=/\u0000|\uFFFD/g;function ex(e){return(typeof e=="string"?e:""+e).replace(YS,`
`).replace(GS,"")}function Gl(e,t,r){if(t=ex(t),ex(e)!==t&&r)throw Error(G(425))}function iu(){}var Um=null,zm=null;function Wm(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Hm=typeof setTimeout=="function"?setTimeout:void 0,KS=typeof clearTimeout=="function"?clearTimeout:void 0,tx=typeof Promise=="function"?Promise:void 0,QS=typeof queueMicrotask=="function"?queueMicrotask:typeof tx<"u"?function(e){return tx.resolve(null).then(e).catch(JS)}:Hm;function JS(e){setTimeout(function(){throw e})}function lf(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),Wo(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);Wo(t)}function os(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function rx(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var vi=Math.random().toString(36).slice(2),tn="__reactFiber$"+vi,Go="__reactProps$"+vi,On="__reactContainer$"+vi,qm="__reactEvents$"+vi,XS="__reactListeners$"+vi,ZS="__reactHandles$"+vi;function Hs(e){var t=e[tn];if(t)return t;for(var r=e.parentNode;r;){if(t=r[On]||r[tn]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=rx(e);e!==null;){if(r=e[tn])return r;e=rx(e)}return t}e=r,r=e.parentNode}return null}function bl(e){return e=e[tn]||e[On],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ia(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(G(33))}function td(e){return e[Go]||null}var Vm=[],Ra=-1;function ws(e){return{current:e}}function Ye(e){0>Ra||(e.current=Vm[Ra],Vm[Ra]=null,Ra--)}function He(e,t){Ra++,Vm[Ra]=e.current,e.current=t}var xs={},Pt=ws(xs),Yt=ws(!1),ra=xs;function ei(e,t){var r=e.type.contextTypes;if(!r)return xs;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Gt(e){return e=e.childContextTypes,e!=null}function ou(){Ye(Yt),Ye(Pt)}function nx(e,t,r){if(Pt.current!==xs)throw Error(G(168));He(Pt,t),He(Yt,r)}function e_(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(G(108,A2(e)||"Unknown",s));return et({},r,n)}function lu(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||xs,ra=Pt.current,He(Pt,e),He(Yt,Yt.current),!0}function sx(e,t,r){var n=e.stateNode;if(!n)throw Error(G(169));r?(e=e_(e,t,ra),n.__reactInternalMemoizedMergedChildContext=e,Ye(Yt),Ye(Pt),He(Pt,e)):Ye(Yt),He(Yt,r)}var jn=null,rd=!1,cf=!1;function t_(e){jn===null?jn=[e]:jn.push(e)}function eC(e){rd=!0,t_(e)}function _s(){if(!cf&&jn!==null){cf=!0;var e=0,t=Fe;try{var r=jn;for(Fe=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}jn=null,rd=!1}catch(s){throw jn!==null&&(jn=jn.slice(e+1)),Sw(mp,_s),s}finally{Fe=t,cf=!1}}return null}var Ma=[],Oa=0,cu=null,uu=0,gr=[],xr=0,na=null,Nn=1,Sn="";function Rs(e,t){Ma[Oa++]=uu,Ma[Oa++]=cu,cu=e,uu=t}function r_(e,t,r){gr[xr++]=Nn,gr[xr++]=Sn,gr[xr++]=na,na=e;var n=Nn;e=Sn;var s=32-Ar(n)-1;n&=~(1<<s),r+=1;var a=32-Ar(t)+s;if(30<a){var o=s-s%5;a=(n&(1<<o)-1).toString(32),n>>=o,s-=o,Nn=1<<32-Ar(t)+s|r<<s|n,Sn=a+e}else Nn=1<<a|r<<s|n,Sn=e}function _p(e){e.return!==null&&(Rs(e,1),r_(e,1,0))}function jp(e){for(;e===cu;)cu=Ma[--Oa],Ma[Oa]=null,uu=Ma[--Oa],Ma[Oa]=null;for(;e===na;)na=gr[--xr],gr[xr]=null,Sn=gr[--xr],gr[xr]=null,Nn=gr[--xr],gr[xr]=null}var ar=null,rr=null,Ke=!1,Mr=null;function n_(e,t){var r=vr(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function ax(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,ar=e,rr=os(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,ar=e,rr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=na!==null?{id:Nn,overflow:Sn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=vr(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,ar=e,rr=null,!0):!1;default:return!1}}function Ym(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Gm(e){if(Ke){var t=rr;if(t){var r=t;if(!ax(e,t)){if(Ym(e))throw Error(G(418));t=os(r.nextSibling);var n=ar;t&&ax(e,t)?n_(n,r):(e.flags=e.flags&-4097|2,Ke=!1,ar=e)}}else{if(Ym(e))throw Error(G(418));e.flags=e.flags&-4097|2,Ke=!1,ar=e}}}function ix(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ar=e}function Kl(e){if(e!==ar)return!1;if(!Ke)return ix(e),Ke=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Wm(e.type,e.memoizedProps)),t&&(t=rr)){if(Ym(e))throw s_(),Error(G(418));for(;t;)n_(e,t),t=os(t.nextSibling)}if(ix(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(G(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){rr=os(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}rr=null}}else rr=ar?os(e.stateNode.nextSibling):null;return!0}function s_(){for(var e=rr;e;)e=os(e.nextSibling)}function ti(){rr=ar=null,Ke=!1}function kp(e){Mr===null?Mr=[e]:Mr.push(e)}var tC=Un.ReactCurrentBatchConfig;function zi(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(G(309));var n=r.stateNode}if(!n)throw Error(G(147,e));var s=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(o){var l=s.refs;o===null?delete l[a]:l[a]=o},t._stringRef=a,t)}if(typeof e!="string")throw Error(G(284));if(!r._owner)throw Error(G(290,e))}return e}function Ql(e,t){throw e=Object.prototype.toString.call(t),Error(G(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ox(e){var t=e._init;return t(e._payload)}function a_(e){function t(g,b){if(e){var p=g.deletions;p===null?(g.deletions=[b],g.flags|=16):p.push(b)}}function r(g,b){if(!e)return null;for(;b!==null;)t(g,b),b=b.sibling;return null}function n(g,b){for(g=new Map;b!==null;)b.key!==null?g.set(b.key,b):g.set(b.index,b),b=b.sibling;return g}function s(g,b){return g=ds(g,b),g.index=0,g.sibling=null,g}function a(g,b,p){return g.index=p,e?(p=g.alternate,p!==null?(p=p.index,p<b?(g.flags|=2,b):p):(g.flags|=2,b)):(g.flags|=1048576,b)}function o(g){return e&&g.alternate===null&&(g.flags|=2),g}function l(g,b,p,_){return b===null||b.tag!==6?(b=gf(p,g.mode,_),b.return=g,b):(b=s(b,p),b.return=g,b)}function c(g,b,p,_){var j=p.type;return j===Da?d(g,b,p.props.children,_,p.key):b!==null&&(b.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Kn&&ox(j)===b.type)?(_=s(b,p.props),_.ref=zi(g,b,p),_.return=g,_):(_=$c(p.type,p.key,p.props,null,g.mode,_),_.ref=zi(g,b,p),_.return=g,_)}function u(g,b,p,_){return b===null||b.tag!==4||b.stateNode.containerInfo!==p.containerInfo||b.stateNode.implementation!==p.implementation?(b=xf(p,g.mode,_),b.return=g,b):(b=s(b,p.children||[]),b.return=g,b)}function d(g,b,p,_,j){return b===null||b.tag!==7?(b=Js(p,g.mode,_,j),b.return=g,b):(b=s(b,p),b.return=g,b)}function f(g,b,p){if(typeof b=="string"&&b!==""||typeof b=="number")return b=gf(""+b,g.mode,p),b.return=g,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Fl:return p=$c(b.type,b.key,b.props,null,g.mode,p),p.ref=zi(g,null,b),p.return=g,p;case Ea:return b=xf(b,g.mode,p),b.return=g,b;case Kn:var _=b._init;return f(g,_(b._payload),p)}if(ho(b)||Ai(b))return b=Js(b,g.mode,p,null),b.return=g,b;Ql(g,b)}return null}function m(g,b,p,_){var j=b!==null?b.key:null;if(typeof p=="string"&&p!==""||typeof p=="number")return j!==null?null:l(g,b,""+p,_);if(typeof p=="object"&&p!==null){switch(p.$$typeof){case Fl:return p.key===j?c(g,b,p,_):null;case Ea:return p.key===j?u(g,b,p,_):null;case Kn:return j=p._init,m(g,b,j(p._payload),_)}if(ho(p)||Ai(p))return j!==null?null:d(g,b,p,_,null);Ql(g,p)}return null}function h(g,b,p,_,j){if(typeof _=="string"&&_!==""||typeof _=="number")return g=g.get(p)||null,l(b,g,""+_,j);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Fl:return g=g.get(_.key===null?p:_.key)||null,c(b,g,_,j);case Ea:return g=g.get(_.key===null?p:_.key)||null,u(b,g,_,j);case Kn:var k=_._init;return h(g,b,p,k(_._payload),j)}if(ho(_)||Ai(_))return g=g.get(p)||null,d(b,g,_,j,null);Ql(b,_)}return null}function y(g,b,p,_){for(var j=null,k=null,N=b,S=b=0,C=null;N!==null&&S<p.length;S++){N.index>S?(C=N,N=null):C=N.sibling;var E=m(g,N,p[S],_);if(E===null){N===null&&(N=C);break}e&&N&&E.alternate===null&&t(g,N),b=a(E,b,S),k===null?j=E:k.sibling=E,k=E,N=C}if(S===p.length)return r(g,N),Ke&&Rs(g,S),j;if(N===null){for(;S<p.length;S++)N=f(g,p[S],_),N!==null&&(b=a(N,b,S),k===null?j=N:k.sibling=N,k=N);return Ke&&Rs(g,S),j}for(N=n(g,N);S<p.length;S++)C=h(N,g,S,p[S],_),C!==null&&(e&&C.alternate!==null&&N.delete(C.key===null?S:C.key),b=a(C,b,S),k===null?j=C:k.sibling=C,k=C);return e&&N.forEach(function(T){return t(g,T)}),Ke&&Rs(g,S),j}function v(g,b,p,_){var j=Ai(p);if(typeof j!="function")throw Error(G(150));if(p=j.call(p),p==null)throw Error(G(151));for(var k=j=null,N=b,S=b=0,C=null,E=p.next();N!==null&&!E.done;S++,E=p.next()){N.index>S?(C=N,N=null):C=N.sibling;var T=m(g,N,E.value,_);if(T===null){N===null&&(N=C);break}e&&N&&T.alternate===null&&t(g,N),b=a(T,b,S),k===null?j=T:k.sibling=T,k=T,N=C}if(E.done)return r(g,N),Ke&&Rs(g,S),j;if(N===null){for(;!E.done;S++,E=p.next())E=f(g,E.value,_),E!==null&&(b=a(E,b,S),k===null?j=E:k.sibling=E,k=E);return Ke&&Rs(g,S),j}for(N=n(g,N);!E.done;S++,E=p.next())E=h(N,g,S,E.value,_),E!==null&&(e&&E.alternate!==null&&N.delete(E.key===null?S:E.key),b=a(E,b,S),k===null?j=E:k.sibling=E,k=E);return e&&N.forEach(function(L){return t(g,L)}),Ke&&Rs(g,S),j}function w(g,b,p,_){if(typeof p=="object"&&p!==null&&p.type===Da&&p.key===null&&(p=p.props.children),typeof p=="object"&&p!==null){switch(p.$$typeof){case Fl:e:{for(var j=p.key,k=b;k!==null;){if(k.key===j){if(j=p.type,j===Da){if(k.tag===7){r(g,k.sibling),b=s(k,p.props.children),b.return=g,g=b;break e}}else if(k.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Kn&&ox(j)===k.type){r(g,k.sibling),b=s(k,p.props),b.ref=zi(g,k,p),b.return=g,g=b;break e}r(g,k);break}else t(g,k);k=k.sibling}p.type===Da?(b=Js(p.props.children,g.mode,_,p.key),b.return=g,g=b):(_=$c(p.type,p.key,p.props,null,g.mode,_),_.ref=zi(g,b,p),_.return=g,g=_)}return o(g);case Ea:e:{for(k=p.key;b!==null;){if(b.key===k)if(b.tag===4&&b.stateNode.containerInfo===p.containerInfo&&b.stateNode.implementation===p.implementation){r(g,b.sibling),b=s(b,p.children||[]),b.return=g,g=b;break e}else{r(g,b);break}else t(g,b);b=b.sibling}b=xf(p,g.mode,_),b.return=g,g=b}return o(g);case Kn:return k=p._init,w(g,b,k(p._payload),_)}if(ho(p))return y(g,b,p,_);if(Ai(p))return v(g,b,p,_);Ql(g,p)}return typeof p=="string"&&p!==""||typeof p=="number"?(p=""+p,b!==null&&b.tag===6?(r(g,b.sibling),b=s(b,p),b.return=g,g=b):(r(g,b),b=gf(p,g.mode,_),b.return=g,g=b),o(g)):r(g,b)}return w}var ri=a_(!0),i_=a_(!1),du=ws(null),fu=null,Aa=null,Np=null;function Sp(){Np=Aa=fu=null}function Cp(e){var t=du.current;Ye(du),e._currentValue=t}function Km(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Va(e,t){fu=e,Np=Aa=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Vt=!0),e.firstContext=null)}function Nr(e){var t=e._currentValue;if(Np!==e)if(e={context:e,memoizedValue:t,next:null},Aa===null){if(fu===null)throw Error(G(308));Aa=e,fu.dependencies={lanes:0,firstContext:e}}else Aa=Aa.next=e;return t}var qs=null;function Ep(e){qs===null?qs=[e]:qs.push(e)}function o_(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,Ep(t)):(r.next=s.next,s.next=r),t.interleaved=r,An(e,n)}function An(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Qn=!1;function Dp(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function l_(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function En(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ls(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Ee&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,An(e,r)}return s=n.interleaved,s===null?(t.next=t,Ep(n)):(t.next=s.next,s.next=t),n.interleaved=t,An(e,r)}function Lc(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,hp(e,r)}}function lx(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=o:a=a.next=o,r=r.next}while(r!==null);a===null?s=a=t:a=a.next=t}else s=a=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function mu(e,t,r,n){var s=e.updateQueue;Qn=!1;var a=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?a=u:o.next=u,o=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(a!==null){var f=s.baseState;o=0,d=u=c=null,l=a;do{var m=l.lane,h=l.eventTime;if((n&m)===m){d!==null&&(d=d.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var y=e,v=l;switch(m=t,h=r,v.tag){case 1:if(y=v.payload,typeof y=="function"){f=y.call(h,f,m);break e}f=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=v.payload,m=typeof y=="function"?y.call(h,f,m):y,m==null)break e;f=et({},f,m);break e;case 2:Qn=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,m=s.effects,m===null?s.effects=[l]:m.push(l))}else h={eventTime:h,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=h,c=f):d=d.next=h,o|=m;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;m=l,l=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(1);if(d===null&&(c=f),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else a===null&&(s.shared.lanes=0);aa|=o,e.lanes=o,e.memoizedState=f}}function cx(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(G(191,s));s.call(n)}}}var vl={},un=ws(vl),Ko=ws(vl),Qo=ws(vl);function Vs(e){if(e===vl)throw Error(G(174));return e}function Pp(e,t){switch(He(Qo,t),He(Ko,e),He(un,vl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Dm(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Dm(t,e)}Ye(un),He(un,t)}function ni(){Ye(un),Ye(Ko),Ye(Qo)}function c_(e){Vs(Qo.current);var t=Vs(un.current),r=Dm(t,e.type);t!==r&&(He(Ko,e),He(un,r))}function Tp(e){Ko.current===e&&(Ye(un),Ye(Ko))}var Je=ws(0);function hu(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var uf=[];function Lp(){for(var e=0;e<uf.length;e++)uf[e]._workInProgressVersionPrimary=null;uf.length=0}var Ic=Un.ReactCurrentDispatcher,df=Un.ReactCurrentBatchConfig,sa=0,Ze=null,mt=null,pt=null,pu=!1,No=!1,Jo=0,rC=0;function Nt(){throw Error(G(321))}function Ip(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Br(e[r],t[r]))return!1;return!0}function Rp(e,t,r,n,s,a){if(sa=a,Ze=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ic.current=e===null||e.memoizedState===null?iC:oC,e=r(n,s),No){a=0;do{if(No=!1,Jo=0,25<=a)throw Error(G(301));a+=1,pt=mt=null,t.updateQueue=null,Ic.current=lC,e=r(n,s)}while(No)}if(Ic.current=gu,t=mt!==null&&mt.next!==null,sa=0,pt=mt=Ze=null,pu=!1,t)throw Error(G(300));return e}function Mp(){var e=Jo!==0;return Jo=0,e}function Qr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pt===null?Ze.memoizedState=pt=e:pt=pt.next=e,pt}function Sr(){if(mt===null){var e=Ze.alternate;e=e!==null?e.memoizedState:null}else e=mt.next;var t=pt===null?Ze.memoizedState:pt.next;if(t!==null)pt=t,mt=e;else{if(e===null)throw Error(G(310));mt=e,e={memoizedState:mt.memoizedState,baseState:mt.baseState,baseQueue:mt.baseQueue,queue:mt.queue,next:null},pt===null?Ze.memoizedState=pt=e:pt=pt.next=e}return pt}function Xo(e,t){return typeof t=="function"?t(e):t}function ff(e){var t=Sr(),r=t.queue;if(r===null)throw Error(G(311));r.lastRenderedReducer=e;var n=mt,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var o=s.next;s.next=a.next,a.next=o}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var l=o=null,c=null,u=a;do{var d=u.lane;if((sa&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,o=n):c=c.next=f,Ze.lanes|=d,aa|=d}u=u.next}while(u!==null&&u!==a);c===null?o=n:c.next=l,Br(n,t.memoizedState)||(Vt=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do a=s.lane,Ze.lanes|=a,aa|=a,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function mf(e){var t=Sr(),r=t.queue;if(r===null)throw Error(G(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,a=t.memoizedState;if(s!==null){r.pending=null;var o=s=s.next;do a=e(a,o.action),o=o.next;while(o!==s);Br(a,t.memoizedState)||(Vt=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function u_(){}function d_(e,t){var r=Ze,n=Sr(),s=t(),a=!Br(n.memoizedState,s);if(a&&(n.memoizedState=s,Vt=!0),n=n.queue,Op(h_.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||pt!==null&&pt.memoizedState.tag&1){if(r.flags|=2048,Zo(9,m_.bind(null,r,n,s,t),void 0,null),gt===null)throw Error(G(349));sa&30||f_(r,t,s)}return s}function f_(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Ze.updateQueue,t===null?(t={lastEffect:null,stores:null},Ze.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function m_(e,t,r,n){t.value=r,t.getSnapshot=n,p_(t)&&g_(e)}function h_(e,t,r){return r(function(){p_(t)&&g_(e)})}function p_(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Br(e,r)}catch{return!0}}function g_(e){var t=An(e,1);t!==null&&$r(t,e,1,-1)}function ux(e){var t=Qr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Xo,lastRenderedState:e},t.queue=e,e=e.dispatch=aC.bind(null,Ze,e),[t.memoizedState,e]}function Zo(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Ze.updateQueue,t===null?(t={lastEffect:null,stores:null},Ze.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function x_(){return Sr().memoizedState}function Rc(e,t,r,n){var s=Qr();Ze.flags|=e,s.memoizedState=Zo(1|t,r,void 0,n===void 0?null:n)}function nd(e,t,r,n){var s=Sr();n=n===void 0?null:n;var a=void 0;if(mt!==null){var o=mt.memoizedState;if(a=o.destroy,n!==null&&Ip(n,o.deps)){s.memoizedState=Zo(t,r,a,n);return}}Ze.flags|=e,s.memoizedState=Zo(1|t,r,a,n)}function dx(e,t){return Rc(8390656,8,e,t)}function Op(e,t){return nd(2048,8,e,t)}function y_(e,t){return nd(4,2,e,t)}function b_(e,t){return nd(4,4,e,t)}function v_(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function w_(e,t,r){return r=r!=null?r.concat([e]):null,nd(4,4,v_.bind(null,t,e),r)}function Ap(){}function __(e,t){var r=Sr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Ip(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function j_(e,t){var r=Sr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Ip(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function k_(e,t,r){return sa&21?(Br(r,t)||(r=Dw(),Ze.lanes|=r,aa|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Vt=!0),e.memoizedState=r)}function nC(e,t){var r=Fe;Fe=r!==0&&4>r?r:4,e(!0);var n=df.transition;df.transition={};try{e(!1),t()}finally{Fe=r,df.transition=n}}function N_(){return Sr().memoizedState}function sC(e,t,r){var n=us(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},S_(e))C_(t,r);else if(r=o_(e,t,r,n),r!==null){var s=Ft();$r(r,e,n,s),E_(r,t,n)}}function aC(e,t,r){var n=us(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(S_(e))C_(t,s);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var o=t.lastRenderedState,l=a(o,r);if(s.hasEagerState=!0,s.eagerState=l,Br(l,o)){var c=t.interleaved;c===null?(s.next=s,Ep(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}r=o_(e,t,s,n),r!==null&&(s=Ft(),$r(r,e,n,s),E_(r,t,n))}}function S_(e){var t=e.alternate;return e===Ze||t!==null&&t===Ze}function C_(e,t){No=pu=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function E_(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,hp(e,r)}}var gu={readContext:Nr,useCallback:Nt,useContext:Nt,useEffect:Nt,useImperativeHandle:Nt,useInsertionEffect:Nt,useLayoutEffect:Nt,useMemo:Nt,useReducer:Nt,useRef:Nt,useState:Nt,useDebugValue:Nt,useDeferredValue:Nt,useTransition:Nt,useMutableSource:Nt,useSyncExternalStore:Nt,useId:Nt,unstable_isNewReconciler:!1},iC={readContext:Nr,useCallback:function(e,t){return Qr().memoizedState=[e,t===void 0?null:t],e},useContext:Nr,useEffect:dx,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Rc(4194308,4,v_.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Rc(4194308,4,e,t)},useInsertionEffect:function(e,t){return Rc(4,2,e,t)},useMemo:function(e,t){var r=Qr();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Qr();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=sC.bind(null,Ze,e),[n.memoizedState,e]},useRef:function(e){var t=Qr();return e={current:e},t.memoizedState=e},useState:ux,useDebugValue:Ap,useDeferredValue:function(e){return Qr().memoizedState=e},useTransition:function(){var e=ux(!1),t=e[0];return e=nC.bind(null,e[1]),Qr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Ze,s=Qr();if(Ke){if(r===void 0)throw Error(G(407));r=r()}else{if(r=t(),gt===null)throw Error(G(349));sa&30||f_(n,t,r)}s.memoizedState=r;var a={value:r,getSnapshot:t};return s.queue=a,dx(h_.bind(null,n,a,e),[e]),n.flags|=2048,Zo(9,m_.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=Qr(),t=gt.identifierPrefix;if(Ke){var r=Sn,n=Nn;r=(n&~(1<<32-Ar(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Jo++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=rC++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},oC={readContext:Nr,useCallback:__,useContext:Nr,useEffect:Op,useImperativeHandle:w_,useInsertionEffect:y_,useLayoutEffect:b_,useMemo:j_,useReducer:ff,useRef:x_,useState:function(){return ff(Xo)},useDebugValue:Ap,useDeferredValue:function(e){var t=Sr();return k_(t,mt.memoizedState,e)},useTransition:function(){var e=ff(Xo)[0],t=Sr().memoizedState;return[e,t]},useMutableSource:u_,useSyncExternalStore:d_,useId:N_,unstable_isNewReconciler:!1},lC={readContext:Nr,useCallback:__,useContext:Nr,useEffect:Op,useImperativeHandle:w_,useInsertionEffect:y_,useLayoutEffect:b_,useMemo:j_,useReducer:mf,useRef:x_,useState:function(){return mf(Xo)},useDebugValue:Ap,useDeferredValue:function(e){var t=Sr();return mt===null?t.memoizedState=e:k_(t,mt.memoizedState,e)},useTransition:function(){var e=mf(Xo)[0],t=Sr().memoizedState;return[e,t]},useMutableSource:u_,useSyncExternalStore:d_,useId:N_,unstable_isNewReconciler:!1};function Lr(e,t){if(e&&e.defaultProps){t=et({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Qm(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:et({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var sd={isMounted:function(e){return(e=e._reactInternals)?da(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Ft(),s=us(e),a=En(n,s);a.payload=t,r!=null&&(a.callback=r),t=ls(e,a,s),t!==null&&($r(t,e,s,n),Lc(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Ft(),s=us(e),a=En(n,s);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=ls(e,a,s),t!==null&&($r(t,e,s,n),Lc(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Ft(),n=us(e),s=En(r,n);s.tag=2,t!=null&&(s.callback=t),t=ls(e,s,n),t!==null&&($r(t,e,n,r),Lc(t,e,n))}};function fx(e,t,r,n,s,a,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,o):t.prototype&&t.prototype.isPureReactComponent?!qo(r,n)||!qo(s,a):!0}function D_(e,t,r){var n=!1,s=xs,a=t.contextType;return typeof a=="object"&&a!==null?a=Nr(a):(s=Gt(t)?ra:Pt.current,n=t.contextTypes,a=(n=n!=null)?ei(e,s):xs),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=sd,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=a),t}function mx(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&sd.enqueueReplaceState(t,t.state,null)}function Jm(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},Dp(e);var a=t.contextType;typeof a=="object"&&a!==null?s.context=Nr(a):(a=Gt(t)?ra:Pt.current,s.context=ei(e,a)),s.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(Qm(e,t,a,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&sd.enqueueReplaceState(s,s.state,null),mu(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function si(e,t){try{var r="",n=t;do r+=O2(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:s,digest:null}}function hf(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Xm(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var cC=typeof WeakMap=="function"?WeakMap:Map;function P_(e,t,r){r=En(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){yu||(yu=!0,lh=n),Xm(e,t)},r}function T_(e,t,r){r=En(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){Xm(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){Xm(e,t),typeof n!="function"&&(cs===null?cs=new Set([this]):cs.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function hx(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new cC;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=jC.bind(null,e,t,r),t.then(e,e))}function px(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function gx(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=En(-1,1),t.tag=2,ls(r,t,1))),r.lanes|=1),e)}var uC=Un.ReactCurrentOwner,Vt=!1;function Ot(e,t,r,n){t.child=e===null?i_(t,null,r,n):ri(t,e.child,r,n)}function xx(e,t,r,n,s){r=r.render;var a=t.ref;return Va(t,s),n=Rp(e,t,r,n,a,s),r=Mp(),e!==null&&!Vt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,$n(e,t,s)):(Ke&&r&&_p(t),t.flags|=1,Ot(e,t,n,s),t.child)}function yx(e,t,r,n,s){if(e===null){var a=r.type;return typeof a=="function"&&!qp(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,L_(e,t,a,n,s)):(e=$c(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&s)){var o=a.memoizedProps;if(r=r.compare,r=r!==null?r:qo,r(o,n)&&e.ref===t.ref)return $n(e,t,s)}return t.flags|=1,e=ds(a,n),e.ref=t.ref,e.return=t,t.child=e}function L_(e,t,r,n,s){if(e!==null){var a=e.memoizedProps;if(qo(a,n)&&e.ref===t.ref)if(Vt=!1,t.pendingProps=n=a,(e.lanes&s)!==0)e.flags&131072&&(Vt=!0);else return t.lanes=e.lanes,$n(e,t,s)}return Zm(e,t,r,n,s)}function I_(e,t,r){var n=t.pendingProps,s=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},He(Fa,tr),tr|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,He(Fa,tr),tr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,He(Fa,tr),tr|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,He(Fa,tr),tr|=n;return Ot(e,t,s,r),t.child}function R_(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Zm(e,t,r,n,s){var a=Gt(r)?ra:Pt.current;return a=ei(t,a),Va(t,s),r=Rp(e,t,r,n,a,s),n=Mp(),e!==null&&!Vt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,$n(e,t,s)):(Ke&&n&&_p(t),t.flags|=1,Ot(e,t,r,s),t.child)}function bx(e,t,r,n,s){if(Gt(r)){var a=!0;lu(t)}else a=!1;if(Va(t,s),t.stateNode===null)Mc(e,t),D_(t,r,n),Jm(t,r,n,s),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=Nr(u):(u=Gt(r)?ra:Pt.current,u=ei(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==u)&&mx(t,o,n,u),Qn=!1;var m=t.memoizedState;o.state=m,mu(t,n,o,s),c=t.memoizedState,l!==n||m!==c||Yt.current||Qn?(typeof d=="function"&&(Qm(t,r,d,n),c=t.memoizedState),(l=Qn||fx(t,r,l,n,m,c,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=u,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,l_(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:Lr(t.type,l),o.props=u,f=t.pendingProps,m=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=Nr(c):(c=Gt(r)?ra:Pt.current,c=ei(t,c));var h=r.getDerivedStateFromProps;(d=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||m!==c)&&mx(t,o,n,c),Qn=!1,m=t.memoizedState,o.state=m,mu(t,n,o,s);var y=t.memoizedState;l!==f||m!==y||Yt.current||Qn?(typeof h=="function"&&(Qm(t,r,h,n),y=t.memoizedState),(u=Qn||fx(t,r,u,n,m,y,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,y,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,y,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=y),o.props=n,o.state=y,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),n=!1)}return eh(e,t,r,n,a,s)}function eh(e,t,r,n,s,a){R_(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return s&&sx(t,r,!1),$n(e,t,a);n=t.stateNode,uC.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=ri(t,e.child,null,a),t.child=ri(t,null,l,a)):Ot(e,t,l,a),t.memoizedState=n.state,s&&sx(t,r,!0),t.child}function M_(e){var t=e.stateNode;t.pendingContext?nx(e,t.pendingContext,t.pendingContext!==t.context):t.context&&nx(e,t.context,!1),Pp(e,t.containerInfo)}function vx(e,t,r,n,s){return ti(),kp(s),t.flags|=256,Ot(e,t,r,n),t.child}var th={dehydrated:null,treeContext:null,retryLane:0};function rh(e){return{baseLanes:e,cachePool:null,transitions:null}}function O_(e,t,r){var n=t.pendingProps,s=Je.current,a=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),He(Je,s&1),e===null)return Gm(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,a?(n=t.mode,a=t.child,o={mode:"hidden",children:o},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=od(o,n,0,null),e=Js(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=rh(r),t.memoizedState=th,e):$p(t,o));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return dC(e,t,o,n,l,s,r);if(a){a=n.fallback,o=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=ds(s,c),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?a=ds(l,a):(a=Js(a,o,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,o=e.child.memoizedState,o=o===null?rh(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=e.childLanes&~r,t.memoizedState=th,n}return a=e.child,e=a.sibling,n=ds(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function $p(e,t){return t=od({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Jl(e,t,r,n){return n!==null&&kp(n),ri(t,e.child,null,r),e=$p(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function dC(e,t,r,n,s,a,o){if(r)return t.flags&256?(t.flags&=-257,n=hf(Error(G(422))),Jl(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,s=t.mode,n=od({mode:"visible",children:n.children},s,0,null),a=Js(a,s,o,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&ri(t,e.child,null,o),t.child.memoizedState=rh(o),t.memoizedState=th,a);if(!(t.mode&1))return Jl(e,t,o,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,a=Error(G(419)),n=hf(a,n,void 0),Jl(e,t,o,n)}if(l=(o&e.childLanes)!==0,Vt||l){if(n=gt,n!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|o)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,An(e,s),$r(n,e,s,-1))}return Hp(),n=hf(Error(G(421))),Jl(e,t,o,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=kC.bind(null,e),s._reactRetry=t,null):(e=a.treeContext,rr=os(s.nextSibling),ar=t,Ke=!0,Mr=null,e!==null&&(gr[xr++]=Nn,gr[xr++]=Sn,gr[xr++]=na,Nn=e.id,Sn=e.overflow,na=t),t=$p(t,n.children),t.flags|=4096,t)}function wx(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Km(e.return,t,r)}function pf(e,t,r,n,s){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function A_(e,t,r){var n=t.pendingProps,s=n.revealOrder,a=n.tail;if(Ot(e,t,n.children,r),n=Je.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&wx(e,r,t);else if(e.tag===19)wx(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(He(Je,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&hu(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),pf(t,!1,s,r,a);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&hu(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}pf(t,!0,r,null,a);break;case"together":pf(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Mc(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function $n(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),aa|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(G(153));if(t.child!==null){for(e=t.child,r=ds(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=ds(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function fC(e,t,r){switch(t.tag){case 3:M_(t),ti();break;case 5:c_(t);break;case 1:Gt(t.type)&&lu(t);break;case 4:Pp(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;He(du,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(He(Je,Je.current&1),t.flags|=128,null):r&t.child.childLanes?O_(e,t,r):(He(Je,Je.current&1),e=$n(e,t,r),e!==null?e.sibling:null);He(Je,Je.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return A_(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),He(Je,Je.current),n)break;return null;case 22:case 23:return t.lanes=0,I_(e,t,r)}return $n(e,t,r)}var $_,nh,F_,B_;$_=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};nh=function(){};F_=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,Vs(un.current);var a=null;switch(r){case"input":s=Nm(e,s),n=Nm(e,n),a=[];break;case"select":s=et({},s,{value:void 0}),n=et({},n,{value:void 0}),a=[];break;case"textarea":s=Em(e,s),n=Em(e,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=iu)}Pm(r,n);var o;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&($o.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in n){var c=n[u];if(l=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(a||(a=[]),a.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(a=a||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&($o.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Ve("scroll",e),a||l===c||(a=[])):(a=a||[]).push(u,c))}r&&(a=a||[]).push("style",r);var u=a;(t.updateQueue=u)&&(t.flags|=4)}};B_=function(e,t,r,n){r!==n&&(t.flags|=4)};function Wi(e,t){if(!Ke)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function St(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function mC(e,t,r){var n=t.pendingProps;switch(jp(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return St(t),null;case 1:return Gt(t.type)&&ou(),St(t),null;case 3:return n=t.stateNode,ni(),Ye(Yt),Ye(Pt),Lp(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Kl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Mr!==null&&(dh(Mr),Mr=null))),nh(e,t),St(t),null;case 5:Tp(t);var s=Vs(Qo.current);if(r=t.type,e!==null&&t.stateNode!=null)F_(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(G(166));return St(t),null}if(e=Vs(un.current),Kl(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[tn]=t,n[Go]=a,e=(t.mode&1)!==0,r){case"dialog":Ve("cancel",n),Ve("close",n);break;case"iframe":case"object":case"embed":Ve("load",n);break;case"video":case"audio":for(s=0;s<go.length;s++)Ve(go[s],n);break;case"source":Ve("error",n);break;case"img":case"image":case"link":Ve("error",n),Ve("load",n);break;case"details":Ve("toggle",n);break;case"input":P0(n,a),Ve("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},Ve("invalid",n);break;case"textarea":L0(n,a),Ve("invalid",n)}Pm(r,a),s=null;for(var o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="children"?typeof l=="string"?n.textContent!==l&&(a.suppressHydrationWarning!==!0&&Gl(n.textContent,l,e),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&Gl(n.textContent,l,e),s=["children",""+l]):$o.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ve("scroll",n)}switch(r){case"input":Bl(n),T0(n,a,!0);break;case"textarea":Bl(n),I0(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=iu)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=hw(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[tn]=t,e[Go]=n,$_(e,t,!1,!1),t.stateNode=e;e:{switch(o=Tm(r,n),r){case"dialog":Ve("cancel",e),Ve("close",e),s=n;break;case"iframe":case"object":case"embed":Ve("load",e),s=n;break;case"video":case"audio":for(s=0;s<go.length;s++)Ve(go[s],e);s=n;break;case"source":Ve("error",e),s=n;break;case"img":case"image":case"link":Ve("error",e),Ve("load",e),s=n;break;case"details":Ve("toggle",e),s=n;break;case"input":P0(e,n),s=Nm(e,n),Ve("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=et({},n,{value:void 0}),Ve("invalid",e);break;case"textarea":L0(e,n),s=Em(e,n),Ve("invalid",e);break;default:s=n}Pm(r,s),l=s;for(a in l)if(l.hasOwnProperty(a)){var c=l[a];a==="style"?xw(e,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&pw(e,c)):a==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Fo(e,c):typeof c=="number"&&Fo(e,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&($o.hasOwnProperty(a)?c!=null&&a==="onScroll"&&Ve("scroll",e):c!=null&&lp(e,a,c,o))}switch(r){case"input":Bl(e),T0(e,n,!1);break;case"textarea":Bl(e),I0(e);break;case"option":n.value!=null&&e.setAttribute("value",""+gs(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?za(e,!!n.multiple,a,!1):n.defaultValue!=null&&za(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=iu)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return St(t),null;case 6:if(e&&t.stateNode!=null)B_(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(G(166));if(r=Vs(Qo.current),Vs(un.current),Kl(t)){if(n=t.stateNode,r=t.memoizedProps,n[tn]=t,(a=n.nodeValue!==r)&&(e=ar,e!==null))switch(e.tag){case 3:Gl(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Gl(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[tn]=t,t.stateNode=n}return St(t),null;case 13:if(Ye(Je),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ke&&rr!==null&&t.mode&1&&!(t.flags&128))s_(),ti(),t.flags|=98560,a=!1;else if(a=Kl(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(G(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(G(317));a[tn]=t}else ti(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;St(t),a=!1}else Mr!==null&&(dh(Mr),Mr=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Je.current&1?ht===0&&(ht=3):Hp())),t.updateQueue!==null&&(t.flags|=4),St(t),null);case 4:return ni(),nh(e,t),e===null&&Vo(t.stateNode.containerInfo),St(t),null;case 10:return Cp(t.type._context),St(t),null;case 17:return Gt(t.type)&&ou(),St(t),null;case 19:if(Ye(Je),a=t.memoizedState,a===null)return St(t),null;if(n=(t.flags&128)!==0,o=a.rendering,o===null)if(n)Wi(a,!1);else{if(ht!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=hu(e),o!==null){for(t.flags|=128,Wi(a,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,e=o.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return He(Je,Je.current&1|2),t.child}e=e.sibling}a.tail!==null&&st()>ai&&(t.flags|=128,n=!0,Wi(a,!1),t.lanes=4194304)}else{if(!n)if(e=hu(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Wi(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!Ke)return St(t),null}else 2*st()-a.renderingStartTime>ai&&r!==1073741824&&(t.flags|=128,n=!0,Wi(a,!1),t.lanes=4194304);a.isBackwards?(o.sibling=t.child,t.child=o):(r=a.last,r!==null?r.sibling=o:t.child=o,a.last=o)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=st(),t.sibling=null,r=Je.current,He(Je,n?r&1|2:r&1),t):(St(t),null);case 22:case 23:return Wp(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?tr&1073741824&&(St(t),t.subtreeFlags&6&&(t.flags|=8192)):St(t),null;case 24:return null;case 25:return null}throw Error(G(156,t.tag))}function hC(e,t){switch(jp(t),t.tag){case 1:return Gt(t.type)&&ou(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ni(),Ye(Yt),Ye(Pt),Lp(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Tp(t),null;case 13:if(Ye(Je),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(G(340));ti()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ye(Je),null;case 4:return ni(),null;case 10:return Cp(t.type._context),null;case 22:case 23:return Wp(),null;case 24:return null;default:return null}}var Xl=!1,Ct=!1,pC=typeof WeakSet=="function"?WeakSet:Set,ie=null;function $a(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){rt(e,t,n)}else r.current=null}function sh(e,t,r){try{r()}catch(n){rt(e,t,n)}}var _x=!1;function gC(e,t){if(Um=nu,e=qw(),wp(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,u=0,d=0,f=e,m=null;t:for(;;){for(var h;f!==r||s!==0&&f.nodeType!==3||(l=o+s),f!==a||n!==0&&f.nodeType!==3||(c=o+n),f.nodeType===3&&(o+=f.nodeValue.length),(h=f.firstChild)!==null;)m=f,f=h;for(;;){if(f===e)break t;if(m===r&&++u===s&&(l=o),m===a&&++d===n&&(c=o),(h=f.nextSibling)!==null)break;f=m,m=f.parentNode}f=h}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(zm={focusedElem:e,selectionRange:r},nu=!1,ie=t;ie!==null;)if(t=ie,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ie=e;else for(;ie!==null;){t=ie;try{var y=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var v=y.memoizedProps,w=y.memoizedState,g=t.stateNode,b=g.getSnapshotBeforeUpdate(t.elementType===t.type?v:Lr(t.type,v),w);g.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var p=t.stateNode.containerInfo;p.nodeType===1?p.textContent="":p.nodeType===9&&p.documentElement&&p.removeChild(p.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(G(163))}}catch(_){rt(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,ie=e;break}ie=t.return}return y=_x,_x=!1,y}function So(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var a=s.destroy;s.destroy=void 0,a!==void 0&&sh(t,r,a)}s=s.next}while(s!==n)}}function ad(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function ah(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function U_(e){var t=e.alternate;t!==null&&(e.alternate=null,U_(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[tn],delete t[Go],delete t[qm],delete t[XS],delete t[ZS])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function z_(e){return e.tag===5||e.tag===3||e.tag===4}function jx(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||z_(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function ih(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=iu));else if(n!==4&&(e=e.child,e!==null))for(ih(e,t,r),e=e.sibling;e!==null;)ih(e,t,r),e=e.sibling}function oh(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(oh(e,t,r),e=e.sibling;e!==null;)oh(e,t,r),e=e.sibling}var bt=null,Ir=!1;function Wn(e,t,r){for(r=r.child;r!==null;)W_(e,t,r),r=r.sibling}function W_(e,t,r){if(cn&&typeof cn.onCommitFiberUnmount=="function")try{cn.onCommitFiberUnmount(Ju,r)}catch{}switch(r.tag){case 5:Ct||$a(r,t);case 6:var n=bt,s=Ir;bt=null,Wn(e,t,r),bt=n,Ir=s,bt!==null&&(Ir?(e=bt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):bt.removeChild(r.stateNode));break;case 18:bt!==null&&(Ir?(e=bt,r=r.stateNode,e.nodeType===8?lf(e.parentNode,r):e.nodeType===1&&lf(e,r),Wo(e)):lf(bt,r.stateNode));break;case 4:n=bt,s=Ir,bt=r.stateNode.containerInfo,Ir=!0,Wn(e,t,r),bt=n,Ir=s;break;case 0:case 11:case 14:case 15:if(!Ct&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&sh(r,t,o),s=s.next}while(s!==n)}Wn(e,t,r);break;case 1:if(!Ct&&($a(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){rt(r,t,l)}Wn(e,t,r);break;case 21:Wn(e,t,r);break;case 22:r.mode&1?(Ct=(n=Ct)||r.memoizedState!==null,Wn(e,t,r),Ct=n):Wn(e,t,r);break;default:Wn(e,t,r)}}function kx(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new pC),t.forEach(function(n){var s=NC.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Pr(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:bt=l.stateNode,Ir=!1;break e;case 3:bt=l.stateNode.containerInfo,Ir=!0;break e;case 4:bt=l.stateNode.containerInfo,Ir=!0;break e}l=l.return}if(bt===null)throw Error(G(160));W_(a,o,s),bt=null,Ir=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){rt(s,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)H_(t,e),t=t.sibling}function H_(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Pr(t,e),Kr(e),n&4){try{So(3,e,e.return),ad(3,e)}catch(v){rt(e,e.return,v)}try{So(5,e,e.return)}catch(v){rt(e,e.return,v)}}break;case 1:Pr(t,e),Kr(e),n&512&&r!==null&&$a(r,r.return);break;case 5:if(Pr(t,e),Kr(e),n&512&&r!==null&&$a(r,r.return),e.flags&32){var s=e.stateNode;try{Fo(s,"")}catch(v){rt(e,e.return,v)}}if(n&4&&(s=e.stateNode,s!=null)){var a=e.memoizedProps,o=r!==null?r.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&fw(s,a),Tm(l,o);var u=Tm(l,a);for(o=0;o<c.length;o+=2){var d=c[o],f=c[o+1];d==="style"?xw(s,f):d==="dangerouslySetInnerHTML"?pw(s,f):d==="children"?Fo(s,f):lp(s,d,f,u)}switch(l){case"input":Sm(s,a);break;case"textarea":mw(s,a);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var h=a.value;h!=null?za(s,!!a.multiple,h,!1):m!==!!a.multiple&&(a.defaultValue!=null?za(s,!!a.multiple,a.defaultValue,!0):za(s,!!a.multiple,a.multiple?[]:"",!1))}s[Go]=a}catch(v){rt(e,e.return,v)}}break;case 6:if(Pr(t,e),Kr(e),n&4){if(e.stateNode===null)throw Error(G(162));s=e.stateNode,a=e.memoizedProps;try{s.nodeValue=a}catch(v){rt(e,e.return,v)}}break;case 3:if(Pr(t,e),Kr(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Wo(t.containerInfo)}catch(v){rt(e,e.return,v)}break;case 4:Pr(t,e),Kr(e);break;case 13:Pr(t,e),Kr(e),s=e.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(Up=st())),n&4&&kx(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Ct=(u=Ct)||d,Pr(t,e),Ct=u):Pr(t,e),Kr(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(ie=e,d=e.child;d!==null;){for(f=ie=d;ie!==null;){switch(m=ie,h=m.child,m.tag){case 0:case 11:case 14:case 15:So(4,m,m.return);break;case 1:$a(m,m.return);var y=m.stateNode;if(typeof y.componentWillUnmount=="function"){n=m,r=m.return;try{t=n,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(v){rt(n,r,v)}}break;case 5:$a(m,m.return);break;case 22:if(m.memoizedState!==null){Sx(f);continue}}h!==null?(h.return=m,ie=h):Sx(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{s=f.stateNode,u?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=gw("display",o))}catch(v){rt(e,e.return,v)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(v){rt(e,e.return,v)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Pr(t,e),Kr(e),n&4&&kx(e);break;case 21:break;default:Pr(t,e),Kr(e)}}function Kr(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(z_(r)){var n=r;break e}r=r.return}throw Error(G(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Fo(s,""),n.flags&=-33);var a=jx(e);oh(e,a,s);break;case 3:case 4:var o=n.stateNode.containerInfo,l=jx(e);ih(e,l,o);break;default:throw Error(G(161))}}catch(c){rt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function xC(e,t,r){ie=e,q_(e)}function q_(e,t,r){for(var n=(e.mode&1)!==0;ie!==null;){var s=ie,a=s.child;if(s.tag===22&&n){var o=s.memoizedState!==null||Xl;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||Ct;l=Xl;var u=Ct;if(Xl=o,(Ct=c)&&!u)for(ie=s;ie!==null;)o=ie,c=o.child,o.tag===22&&o.memoizedState!==null?Cx(s):c!==null?(c.return=o,ie=c):Cx(s);for(;a!==null;)ie=a,q_(a),a=a.sibling;ie=s,Xl=l,Ct=u}Nx(e)}else s.subtreeFlags&8772&&a!==null?(a.return=s,ie=a):Nx(e)}}function Nx(e){for(;ie!==null;){var t=ie;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ct||ad(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Ct)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:Lr(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&cx(t,a,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}cx(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Wo(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(G(163))}Ct||t.flags&512&&ah(t)}catch(m){rt(t,t.return,m)}}if(t===e){ie=null;break}if(r=t.sibling,r!==null){r.return=t.return,ie=r;break}ie=t.return}}function Sx(e){for(;ie!==null;){var t=ie;if(t===e){ie=null;break}var r=t.sibling;if(r!==null){r.return=t.return,ie=r;break}ie=t.return}}function Cx(e){for(;ie!==null;){var t=ie;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{ad(4,t)}catch(c){rt(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(c){rt(t,s,c)}}var a=t.return;try{ah(t)}catch(c){rt(t,a,c)}break;case 5:var o=t.return;try{ah(t)}catch(c){rt(t,o,c)}}}catch(c){rt(t,t.return,c)}if(t===e){ie=null;break}var l=t.sibling;if(l!==null){l.return=t.return,ie=l;break}ie=t.return}}var yC=Math.ceil,xu=Un.ReactCurrentDispatcher,Fp=Un.ReactCurrentOwner,_r=Un.ReactCurrentBatchConfig,Ee=0,gt=null,lt=null,_t=0,tr=0,Fa=ws(0),ht=0,el=null,aa=0,id=0,Bp=0,Co=null,Ht=null,Up=0,ai=1/0,wn=null,yu=!1,lh=null,cs=null,Zl=!1,ns=null,bu=0,Eo=0,ch=null,Oc=-1,Ac=0;function Ft(){return Ee&6?st():Oc!==-1?Oc:Oc=st()}function us(e){return e.mode&1?Ee&2&&_t!==0?_t&-_t:tC.transition!==null?(Ac===0&&(Ac=Dw()),Ac):(e=Fe,e!==0||(e=window.event,e=e===void 0?16:Ow(e.type)),e):1}function $r(e,t,r,n){if(50<Eo)throw Eo=0,ch=null,Error(G(185));xl(e,r,n),(!(Ee&2)||e!==gt)&&(e===gt&&(!(Ee&2)&&(id|=r),ht===4&&Zn(e,_t)),Kt(e,n),r===1&&Ee===0&&!(t.mode&1)&&(ai=st()+500,rd&&_s()))}function Kt(e,t){var r=e.callbackNode;tS(e,t);var n=ru(e,e===gt?_t:0);if(n===0)r!==null&&O0(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&O0(r),t===1)e.tag===0?eC(Ex.bind(null,e)):t_(Ex.bind(null,e)),QS(function(){!(Ee&6)&&_s()}),r=null;else{switch(Pw(n)){case 1:r=mp;break;case 4:r=Cw;break;case 16:r=tu;break;case 536870912:r=Ew;break;default:r=tu}r=Z_(r,V_.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function V_(e,t){if(Oc=-1,Ac=0,Ee&6)throw Error(G(327));var r=e.callbackNode;if(Ya()&&e.callbackNode!==r)return null;var n=ru(e,e===gt?_t:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=vu(e,n);else{t=n;var s=Ee;Ee|=2;var a=G_();(gt!==e||_t!==t)&&(wn=null,ai=st()+500,Qs(e,t));do try{wC();break}catch(l){Y_(e,l)}while(1);Sp(),xu.current=a,Ee=s,lt!==null?t=0:(gt=null,_t=0,t=ht)}if(t!==0){if(t===2&&(s=Om(e),s!==0&&(n=s,t=uh(e,s))),t===1)throw r=el,Qs(e,0),Zn(e,n),Kt(e,st()),r;if(t===6)Zn(e,n);else{if(s=e.current.alternate,!(n&30)&&!bC(s)&&(t=vu(e,n),t===2&&(a=Om(e),a!==0&&(n=a,t=uh(e,a))),t===1))throw r=el,Qs(e,0),Zn(e,n),Kt(e,st()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(G(345));case 2:Ms(e,Ht,wn);break;case 3:if(Zn(e,n),(n&130023424)===n&&(t=Up+500-st(),10<t)){if(ru(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){Ft(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Hm(Ms.bind(null,e,Ht,wn),t);break}Ms(e,Ht,wn);break;case 4:if(Zn(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var o=31-Ar(n);a=1<<o,o=t[o],o>s&&(s=o),n&=~a}if(n=s,n=st()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*yC(n/1960))-n,10<n){e.timeoutHandle=Hm(Ms.bind(null,e,Ht,wn),n);break}Ms(e,Ht,wn);break;case 5:Ms(e,Ht,wn);break;default:throw Error(G(329))}}}return Kt(e,st()),e.callbackNode===r?V_.bind(null,e):null}function uh(e,t){var r=Co;return e.current.memoizedState.isDehydrated&&(Qs(e,t).flags|=256),e=vu(e,t),e!==2&&(t=Ht,Ht=r,t!==null&&dh(t)),e}function dh(e){Ht===null?Ht=e:Ht.push.apply(Ht,e)}function bC(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!Br(a(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Zn(e,t){for(t&=~Bp,t&=~id,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Ar(t),n=1<<r;e[r]=-1,t&=~n}}function Ex(e){if(Ee&6)throw Error(G(327));Ya();var t=ru(e,0);if(!(t&1))return Kt(e,st()),null;var r=vu(e,t);if(e.tag!==0&&r===2){var n=Om(e);n!==0&&(t=n,r=uh(e,n))}if(r===1)throw r=el,Qs(e,0),Zn(e,t),Kt(e,st()),r;if(r===6)throw Error(G(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ms(e,Ht,wn),Kt(e,st()),null}function zp(e,t){var r=Ee;Ee|=1;try{return e(t)}finally{Ee=r,Ee===0&&(ai=st()+500,rd&&_s())}}function ia(e){ns!==null&&ns.tag===0&&!(Ee&6)&&Ya();var t=Ee;Ee|=1;var r=_r.transition,n=Fe;try{if(_r.transition=null,Fe=1,e)return e()}finally{Fe=n,_r.transition=r,Ee=t,!(Ee&6)&&_s()}}function Wp(){tr=Fa.current,Ye(Fa)}function Qs(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,KS(r)),lt!==null)for(r=lt.return;r!==null;){var n=r;switch(jp(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&ou();break;case 3:ni(),Ye(Yt),Ye(Pt),Lp();break;case 5:Tp(n);break;case 4:ni();break;case 13:Ye(Je);break;case 19:Ye(Je);break;case 10:Cp(n.type._context);break;case 22:case 23:Wp()}r=r.return}if(gt=e,lt=e=ds(e.current,null),_t=tr=t,ht=0,el=null,Bp=id=aa=0,Ht=Co=null,qs!==null){for(t=0;t<qs.length;t++)if(r=qs[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var o=a.next;a.next=s,n.next=o}r.pending=n}qs=null}return e}function Y_(e,t){do{var r=lt;try{if(Sp(),Ic.current=gu,pu){for(var n=Ze.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}pu=!1}if(sa=0,pt=mt=Ze=null,No=!1,Jo=0,Fp.current=null,r===null||r.return===null){ht=1,el=t,lt=null;break}e:{var a=e,o=r.return,l=r,c=t;if(t=_t,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var m=d.alternate;m?(d.updateQueue=m.updateQueue,d.memoizedState=m.memoizedState,d.lanes=m.lanes):(d.updateQueue=null,d.memoizedState=null)}var h=px(o);if(h!==null){h.flags&=-257,gx(h,o,l,a,t),h.mode&1&&hx(a,u,t),t=h,c=u;var y=t.updateQueue;if(y===null){var v=new Set;v.add(c),t.updateQueue=v}else y.add(c);break e}else{if(!(t&1)){hx(a,u,t),Hp();break e}c=Error(G(426))}}else if(Ke&&l.mode&1){var w=px(o);if(w!==null){!(w.flags&65536)&&(w.flags|=256),gx(w,o,l,a,t),kp(si(c,l));break e}}a=c=si(c,l),ht!==4&&(ht=2),Co===null?Co=[a]:Co.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var g=P_(a,c,t);lx(a,g);break e;case 1:l=c;var b=a.type,p=a.stateNode;if(!(a.flags&128)&&(typeof b.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(cs===null||!cs.has(p)))){a.flags|=65536,t&=-t,a.lanes|=t;var _=T_(a,l,t);lx(a,_);break e}}a=a.return}while(a!==null)}Q_(r)}catch(j){t=j,lt===r&&r!==null&&(lt=r=r.return);continue}break}while(1)}function G_(){var e=xu.current;return xu.current=gu,e===null?gu:e}function Hp(){(ht===0||ht===3||ht===2)&&(ht=4),gt===null||!(aa&268435455)&&!(id&268435455)||Zn(gt,_t)}function vu(e,t){var r=Ee;Ee|=2;var n=G_();(gt!==e||_t!==t)&&(wn=null,Qs(e,t));do try{vC();break}catch(s){Y_(e,s)}while(1);if(Sp(),Ee=r,xu.current=n,lt!==null)throw Error(G(261));return gt=null,_t=0,ht}function vC(){for(;lt!==null;)K_(lt)}function wC(){for(;lt!==null&&!V2();)K_(lt)}function K_(e){var t=X_(e.alternate,e,tr);e.memoizedProps=e.pendingProps,t===null?Q_(e):lt=t,Fp.current=null}function Q_(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=hC(r,t),r!==null){r.flags&=32767,lt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ht=6,lt=null;return}}else if(r=mC(r,t,tr),r!==null){lt=r;return}if(t=t.sibling,t!==null){lt=t;return}lt=t=e}while(t!==null);ht===0&&(ht=5)}function Ms(e,t,r){var n=Fe,s=_r.transition;try{_r.transition=null,Fe=1,_C(e,t,r,n)}finally{_r.transition=s,Fe=n}return null}function _C(e,t,r,n){do Ya();while(ns!==null);if(Ee&6)throw Error(G(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(G(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(rS(e,a),e===gt&&(lt=gt=null,_t=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Zl||(Zl=!0,Z_(tu,function(){return Ya(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=_r.transition,_r.transition=null;var o=Fe;Fe=1;var l=Ee;Ee|=4,Fp.current=null,gC(e,r),H_(r,e),zS(zm),nu=!!Um,zm=Um=null,e.current=r,xC(r),Y2(),Ee=l,Fe=o,_r.transition=a}else e.current=r;if(Zl&&(Zl=!1,ns=e,bu=s),a=e.pendingLanes,a===0&&(cs=null),Q2(r.stateNode),Kt(e,st()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(yu)throw yu=!1,e=lh,lh=null,e;return bu&1&&e.tag!==0&&Ya(),a=e.pendingLanes,a&1?e===ch?Eo++:(Eo=0,ch=e):Eo=0,_s(),null}function Ya(){if(ns!==null){var e=Pw(bu),t=_r.transition,r=Fe;try{if(_r.transition=null,Fe=16>e?16:e,ns===null)var n=!1;else{if(e=ns,ns=null,bu=0,Ee&6)throw Error(G(331));var s=Ee;for(Ee|=4,ie=e.current;ie!==null;){var a=ie,o=a.child;if(ie.flags&16){var l=a.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(ie=u;ie!==null;){var d=ie;switch(d.tag){case 0:case 11:case 15:So(8,d,a)}var f=d.child;if(f!==null)f.return=d,ie=f;else for(;ie!==null;){d=ie;var m=d.sibling,h=d.return;if(U_(d),d===u){ie=null;break}if(m!==null){m.return=h,ie=m;break}ie=h}}}var y=a.alternate;if(y!==null){var v=y.child;if(v!==null){y.child=null;do{var w=v.sibling;v.sibling=null,v=w}while(v!==null)}}ie=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,ie=o;else e:for(;ie!==null;){if(a=ie,a.flags&2048)switch(a.tag){case 0:case 11:case 15:So(9,a,a.return)}var g=a.sibling;if(g!==null){g.return=a.return,ie=g;break e}ie=a.return}}var b=e.current;for(ie=b;ie!==null;){o=ie;var p=o.child;if(o.subtreeFlags&2064&&p!==null)p.return=o,ie=p;else e:for(o=b;ie!==null;){if(l=ie,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:ad(9,l)}}catch(j){rt(l,l.return,j)}if(l===o){ie=null;break e}var _=l.sibling;if(_!==null){_.return=l.return,ie=_;break e}ie=l.return}}if(Ee=s,_s(),cn&&typeof cn.onPostCommitFiberRoot=="function")try{cn.onPostCommitFiberRoot(Ju,e)}catch{}n=!0}return n}finally{Fe=r,_r.transition=t}}return!1}function Dx(e,t,r){t=si(r,t),t=P_(e,t,1),e=ls(e,t,1),t=Ft(),e!==null&&(xl(e,1,t),Kt(e,t))}function rt(e,t,r){if(e.tag===3)Dx(e,e,r);else for(;t!==null;){if(t.tag===3){Dx(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(cs===null||!cs.has(n))){e=si(r,e),e=T_(t,e,1),t=ls(t,e,1),e=Ft(),t!==null&&(xl(t,1,e),Kt(t,e));break}}t=t.return}}function jC(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Ft(),e.pingedLanes|=e.suspendedLanes&r,gt===e&&(_t&r)===r&&(ht===4||ht===3&&(_t&130023424)===_t&&500>st()-Up?Qs(e,0):Bp|=r),Kt(e,t)}function J_(e,t){t===0&&(e.mode&1?(t=Wl,Wl<<=1,!(Wl&130023424)&&(Wl=4194304)):t=1);var r=Ft();e=An(e,t),e!==null&&(xl(e,t,r),Kt(e,r))}function kC(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),J_(e,r)}function NC(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(G(314))}n!==null&&n.delete(t),J_(e,r)}var X_;X_=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Yt.current)Vt=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Vt=!1,fC(e,t,r);Vt=!!(e.flags&131072)}else Vt=!1,Ke&&t.flags&1048576&&r_(t,uu,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Mc(e,t),e=t.pendingProps;var s=ei(t,Pt.current);Va(t,r),s=Rp(null,t,n,e,s,r);var a=Mp();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Gt(n)?(a=!0,lu(t)):a=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Dp(t),s.updater=sd,t.stateNode=s,s._reactInternals=t,Jm(t,n,e,r),t=eh(null,t,n,!0,a,r)):(t.tag=0,Ke&&a&&_p(t),Ot(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Mc(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=CC(n),e=Lr(n,e),s){case 0:t=Zm(null,t,n,e,r);break e;case 1:t=bx(null,t,n,e,r);break e;case 11:t=xx(null,t,n,e,r);break e;case 14:t=yx(null,t,n,Lr(n.type,e),r);break e}throw Error(G(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Lr(n,s),Zm(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Lr(n,s),bx(e,t,n,s,r);case 3:e:{if(M_(t),e===null)throw Error(G(387));n=t.pendingProps,a=t.memoizedState,s=a.element,l_(e,t),mu(t,n,null,r);var o=t.memoizedState;if(n=o.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){s=si(Error(G(423)),t),t=vx(e,t,n,r,s);break e}else if(n!==s){s=si(Error(G(424)),t),t=vx(e,t,n,r,s);break e}else for(rr=os(t.stateNode.containerInfo.firstChild),ar=t,Ke=!0,Mr=null,r=i_(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ti(),n===s){t=$n(e,t,r);break e}Ot(e,t,n,r)}t=t.child}return t;case 5:return c_(t),e===null&&Gm(t),n=t.type,s=t.pendingProps,a=e!==null?e.memoizedProps:null,o=s.children,Wm(n,s)?o=null:a!==null&&Wm(n,a)&&(t.flags|=32),R_(e,t),Ot(e,t,o,r),t.child;case 6:return e===null&&Gm(t),null;case 13:return O_(e,t,r);case 4:return Pp(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=ri(t,null,n,r):Ot(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Lr(n,s),xx(e,t,n,s,r);case 7:return Ot(e,t,t.pendingProps,r),t.child;case 8:return Ot(e,t,t.pendingProps.children,r),t.child;case 12:return Ot(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,a=t.memoizedProps,o=s.value,He(du,n._currentValue),n._currentValue=o,a!==null)if(Br(a.value,o)){if(a.children===s.children&&!Yt.current){t=$n(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var l=a.dependencies;if(l!==null){o=a.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(a.tag===1){c=En(-1,r&-r),c.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}a.lanes|=r,c=a.alternate,c!==null&&(c.lanes|=r),Km(a.return,r,t),l.lanes|=r;break}c=c.next}}else if(a.tag===10)o=a.type===t.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(G(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),Km(o,r,t),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===t){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}Ot(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Va(t,r),s=Nr(s),n=n(s),t.flags|=1,Ot(e,t,n,r),t.child;case 14:return n=t.type,s=Lr(n,t.pendingProps),s=Lr(n.type,s),yx(e,t,n,s,r);case 15:return L_(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Lr(n,s),Mc(e,t),t.tag=1,Gt(n)?(e=!0,lu(t)):e=!1,Va(t,r),D_(t,n,s),Jm(t,n,s,r),eh(null,t,n,!0,e,r);case 19:return A_(e,t,r);case 22:return I_(e,t,r)}throw Error(G(156,t.tag))};function Z_(e,t){return Sw(e,t)}function SC(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function vr(e,t,r,n){return new SC(e,t,r,n)}function qp(e){return e=e.prototype,!(!e||!e.isReactComponent)}function CC(e){if(typeof e=="function")return qp(e)?1:0;if(e!=null){if(e=e.$$typeof,e===up)return 11;if(e===dp)return 14}return 2}function ds(e,t){var r=e.alternate;return r===null?(r=vr(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function $c(e,t,r,n,s,a){var o=2;if(n=e,typeof e=="function")qp(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Da:return Js(r.children,s,a,t);case cp:o=8,s|=8;break;case wm:return e=vr(12,r,t,s|2),e.elementType=wm,e.lanes=a,e;case _m:return e=vr(13,r,t,s),e.elementType=_m,e.lanes=a,e;case jm:return e=vr(19,r,t,s),e.elementType=jm,e.lanes=a,e;case cw:return od(r,s,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case ow:o=10;break e;case lw:o=9;break e;case up:o=11;break e;case dp:o=14;break e;case Kn:o=16,n=null;break e}throw Error(G(130,e==null?e:typeof e,""))}return t=vr(o,r,t,s),t.elementType=e,t.type=n,t.lanes=a,t}function Js(e,t,r,n){return e=vr(7,e,n,t),e.lanes=r,e}function od(e,t,r,n){return e=vr(22,e,n,t),e.elementType=cw,e.lanes=r,e.stateNode={isHidden:!1},e}function gf(e,t,r){return e=vr(6,e,null,t),e.lanes=r,e}function xf(e,t,r){return t=vr(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function EC(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Qd(0),this.expirationTimes=Qd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Qd(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Vp(e,t,r,n,s,a,o,l,c){return e=new EC(e,t,r,l,c),t===1?(t=1,a===!0&&(t|=8)):t=0,a=vr(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Dp(a),e}function DC(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ea,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function e1(e){if(!e)return xs;e=e._reactInternals;e:{if(da(e)!==e||e.tag!==1)throw Error(G(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Gt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(G(171))}if(e.tag===1){var r=e.type;if(Gt(r))return e_(e,r,t)}return t}function t1(e,t,r,n,s,a,o,l,c){return e=Vp(r,n,!0,e,s,a,o,l,c),e.context=e1(null),r=e.current,n=Ft(),s=us(r),a=En(n,s),a.callback=t??null,ls(r,a,s),e.current.lanes=s,xl(e,s,n),Kt(e,n),e}function ld(e,t,r,n){var s=t.current,a=Ft(),o=us(s);return r=e1(r),t.context===null?t.context=r:t.pendingContext=r,t=En(a,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=ls(s,t,o),e!==null&&($r(e,s,o,a),Lc(e,s,o)),o}function wu(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Px(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Yp(e,t){Px(e,t),(e=e.alternate)&&Px(e,t)}function PC(){return null}var r1=typeof reportError=="function"?reportError:function(e){console.error(e)};function Gp(e){this._internalRoot=e}cd.prototype.render=Gp.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(G(409));ld(e,t,null,null)};cd.prototype.unmount=Gp.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ia(function(){ld(null,e,null,null)}),t[On]=null}};function cd(e){this._internalRoot=e}cd.prototype.unstable_scheduleHydration=function(e){if(e){var t=Iw();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Xn.length&&t!==0&&t<Xn[r].priority;r++);Xn.splice(r,0,e),r===0&&Mw(e)}};function Kp(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ud(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Tx(){}function TC(e,t,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var u=wu(o);a.call(u)}}var o=t1(t,n,e,0,null,!1,!1,"",Tx);return e._reactRootContainer=o,e[On]=o.current,Vo(e.nodeType===8?e.parentNode:e),ia(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var u=wu(c);l.call(u)}}var c=Vp(e,0,!1,null,null,!1,!1,"",Tx);return e._reactRootContainer=c,e[On]=c.current,Vo(e.nodeType===8?e.parentNode:e),ia(function(){ld(t,c,r,n)}),c}function dd(e,t,r,n,s){var a=r._reactRootContainer;if(a){var o=a;if(typeof s=="function"){var l=s;s=function(){var c=wu(o);l.call(c)}}ld(t,o,e,s)}else o=TC(r,t,e,s,n);return wu(o)}Tw=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=po(t.pendingLanes);r!==0&&(hp(t,r|1),Kt(t,st()),!(Ee&6)&&(ai=st()+500,_s()))}break;case 13:ia(function(){var n=An(e,1);if(n!==null){var s=Ft();$r(n,e,1,s)}}),Yp(e,1)}};pp=function(e){if(e.tag===13){var t=An(e,134217728);if(t!==null){var r=Ft();$r(t,e,134217728,r)}Yp(e,134217728)}};Lw=function(e){if(e.tag===13){var t=us(e),r=An(e,t);if(r!==null){var n=Ft();$r(r,e,t,n)}Yp(e,t)}};Iw=function(){return Fe};Rw=function(e,t){var r=Fe;try{return Fe=e,t()}finally{Fe=r}};Im=function(e,t,r){switch(t){case"input":if(Sm(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=td(n);if(!s)throw Error(G(90));dw(n),Sm(n,s)}}}break;case"textarea":mw(e,r);break;case"select":t=r.value,t!=null&&za(e,!!r.multiple,t,!1)}};vw=zp;ww=ia;var LC={usingClientEntryPoint:!1,Events:[bl,Ia,td,yw,bw,zp]},Hi={findFiberByHostInstance:Hs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},IC={bundleType:Hi.bundleType,version:Hi.version,rendererPackageName:Hi.rendererPackageName,rendererConfig:Hi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Un.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=kw(e),e===null?null:e.stateNode},findFiberByHostInstance:Hi.findFiberByHostInstance||PC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ec=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ec.isDisabled&&ec.supportsFiber)try{Ju=ec.inject(IC),cn=ec}catch{}}ur.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=LC;ur.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Kp(t))throw Error(G(200));return DC(e,t,null,r)};ur.createRoot=function(e,t){if(!Kp(e))throw Error(G(299));var r=!1,n="",s=r1;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Vp(e,1,!1,null,null,r,!1,n,s),e[On]=t.current,Vo(e.nodeType===8?e.parentNode:e),new Gp(t)};ur.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(G(188)):(e=Object.keys(e).join(","),Error(G(268,e)));return e=kw(t),e=e===null?null:e.stateNode,e};ur.flushSync=function(e){return ia(e)};ur.hydrate=function(e,t,r){if(!ud(t))throw Error(G(200));return dd(null,e,t,!0,r)};ur.hydrateRoot=function(e,t,r){if(!Kp(e))throw Error(G(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",o=r1;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=t1(t,null,e,1,r??null,s,!1,a,o),e[On]=t.current,Vo(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new cd(t)};ur.render=function(e,t,r){if(!ud(t))throw Error(G(200));return dd(null,e,t,!1,r)};ur.unmountComponentAtNode=function(e){if(!ud(e))throw Error(G(40));return e._reactRootContainer?(ia(function(){dd(null,null,e,!1,function(){e._reactRootContainer=null,e[On]=null})}),!0):!1};ur.unstable_batchedUpdates=zp;ur.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!ud(r))throw Error(G(200));if(e==null||e._reactInternals===void 0)throw Error(G(38));return dd(e,t,r,!1,n)};ur.version="18.3.1-next-f1338f8080-20240426";function n1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n1)}catch(e){console.error(e)}}n1(),nw.exports=ur;var wl=nw.exports;const s1=pl(wl);var Lx=wl;bm.createRoot=Lx.createRoot,bm.hydrateRoot=Lx.hydrateRoot;const RC="modulepreload",MC=function(e){return"/"+e},Ix={},wi=function(t,r,n){if(!r||r.length===0)return t();const s=document.getElementsByTagName("link");return Promise.all(r.map(a=>{if(a=MC(a),a in Ix)return;Ix[a]=!0;const o=a.endsWith(".css"),l=o?'[rel="stylesheet"]':"";if(!!n)for(let d=s.length-1;d>=0;d--){const f=s[d];if(f.href===a&&(!o||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${l}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":RC,o||(u.as="script",u.crossOrigin=""),u.href=a,document.head.appendChild(u),o)return new Promise((d,f)=>{u.addEventListener("load",d),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${a}`)))})})).then(()=>t()).catch(a=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a})};var Rx="popstate";function OC(e={}){function t(n,s){let{pathname:a,search:o,hash:l}=n.location;return fh("",{pathname:a,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:tl(s)}return $C(t,r,null,e)}function Qe(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Ur(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function AC(){return Math.random().toString(36).substring(2,10)}function Mx(e,t){return{usr:e.state,key:e.key,idx:t}}function fh(e,t,r=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?_i(t):t,state:r,key:t&&t.key||n||AC()}}function tl({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function _i(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function $C(e,t,r,n={}){let{window:s=document.defaultView,v5Compat:a=!1}=n,o=s.history,l="POP",c=null,u=d();u==null&&(u=0,o.replaceState({...o.state,idx:u},""));function d(){return(o.state||{idx:null}).idx}function f(){l="POP";let w=d(),g=w==null?null:w-u;u=w,c&&c({action:l,location:v.location,delta:g})}function m(w,g){l="PUSH";let b=fh(v.location,w,g);r&&r(b,w),u=d()+1;let p=Mx(b,u),_=v.createHref(b);try{o.pushState(p,"",_)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;s.location.assign(_)}a&&c&&c({action:l,location:v.location,delta:1})}function h(w,g){l="REPLACE";let b=fh(v.location,w,g);r&&r(b,w),u=d();let p=Mx(b,u),_=v.createHref(b);o.replaceState(p,"",_),a&&c&&c({action:l,location:v.location,delta:0})}function y(w){return FC(w)}let v={get action(){return l},get location(){return e(s,o)},listen(w){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(Rx,f),c=w,()=>{s.removeEventListener(Rx,f),c=null}},createHref(w){return t(s,w)},createURL:y,encodeLocation(w){let g=y(w);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:m,replace:h,go(w){return o.go(w)}};return v}function FC(e,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),Qe(r,"No window.location.(origin|href) available to create URL");let n=typeof e=="string"?e:tl(e);return n=n.replace(/ $/,"%20"),!t&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function a1(e,t,r="/"){return BC(e,t,r,!1)}function BC(e,t,r,n){let s=typeof t=="string"?_i(t):t,a=Fn(s.pathname||"/",r);if(a==null)return null;let o=i1(e);UC(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=XC(a);l=QC(o[c],u,n)}return l}function i1(e,t=[],r=[],n="",s=!1){let a=(o,l,c=s,u)=>{let d={relativePath:u===void 0?o.path||"":u,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};if(d.relativePath.startsWith("/")){if(!d.relativePath.startsWith(n)&&c)return;Qe(d.relativePath.startsWith(n),`Absolute route path "${d.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(n.length)}let f=Dn([n,d.relativePath]),m=r.concat(d);o.children&&o.children.length>0&&(Qe(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),i1(o.children,t,m,f,c)),!(o.path==null&&!o.index)&&t.push({path:f,score:GC(f,o.index),routesMeta:m})};return e.forEach((o,l)=>{var c;if(o.path===""||!((c=o.path)!=null&&c.includes("?")))a(o,l);else for(let u of o1(o.path))a(o,l,!0,u)}),t}function o1(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let o=o1(n.join("/")),l=[];return l.push(...o.map(c=>c===""?a:[a,c].join("/"))),s&&l.push(...o),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function UC(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:KC(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var zC=/^:[\w-]+$/,WC=3,HC=2,qC=1,VC=10,YC=-2,Ox=e=>e==="*";function GC(e,t){let r=e.split("/"),n=r.length;return r.some(Ox)&&(n+=YC),t&&(n+=HC),r.filter(s=>!Ox(s)).reduce((s,a)=>s+(zC.test(a)?WC:a===""?qC:VC),n)}function KC(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function QC(e,t,r=!1){let{routesMeta:n}=e,s={},a="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],u=l===n.length-1,d=a==="/"?t:t.slice(a.length)||"/",f=_u({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),m=c.route;if(!f&&u&&r&&!n[n.length-1].route.index&&(f=_u({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!f)return null;Object.assign(s,f.params),o.push({params:s,pathname:Dn([a,f.pathname]),pathnameBase:rE(Dn([a,f.pathnameBase])),route:m}),f.pathnameBase!=="/"&&(a=Dn([a,f.pathnameBase]))}return o}function _u(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=JC(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let a=s[0],o=a.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:n.reduce((u,{paramName:d,isOptional:f},m)=>{if(d==="*"){let y=l[m]||"";o=a.slice(0,a.length-y.length).replace(/(.)\/+$/,"$1")}const h=l[m];return f&&!h?u[d]=void 0:u[d]=(h||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:o,pattern:e}}function JC(e,t=!1,r=!0){Ur(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function XC(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Ur(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Fn(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function ZC(e,t="/"){let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?_i(e):e;return{pathname:r?r.startsWith("/")?r:eE(r,t):t,search:nE(n),hash:sE(s)}}function eE(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function yf(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function tE(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Qp(e){let t=tE(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function Jp(e,t,r,n=!1){let s;typeof e=="string"?s=_i(e):(s={...e},Qe(!s.pathname||!s.pathname.includes("?"),yf("?","pathname","search",s)),Qe(!s.pathname||!s.pathname.includes("#"),yf("#","pathname","hash",s)),Qe(!s.search||!s.search.includes("#"),yf("#","search","hash",s)));let a=e===""||s.pathname==="",o=a?"/":s.pathname,l;if(o==null)l=r;else{let f=t.length-1;if(!n&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),f-=1;s.pathname=m.join("/")}l=f>=0?t[f]:"/"}let c=ZC(s,l),u=o&&o!=="/"&&o.endsWith("/"),d=(a||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}var Dn=e=>e.join("/").replace(/\/\/+/g,"/"),rE=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),nE=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,sE=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function aE(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var l1=["POST","PUT","PATCH","DELETE"];new Set(l1);var iE=["GET",...l1];new Set(iE);var ji=x.createContext(null);ji.displayName="DataRouter";var fd=x.createContext(null);fd.displayName="DataRouterState";x.createContext(!1);var c1=x.createContext({isTransitioning:!1});c1.displayName="ViewTransition";var oE=x.createContext(new Map);oE.displayName="Fetchers";var lE=x.createContext(null);lE.displayName="Await";var Hr=x.createContext(null);Hr.displayName="Navigation";var _l=x.createContext(null);_l.displayName="Location";var qr=x.createContext({outlet:null,matches:[],isDataRoute:!1});qr.displayName="Route";var Xp=x.createContext(null);Xp.displayName="RouteError";function cE(e,{relative:t}={}){Qe(ki(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=x.useContext(Hr),{hash:s,pathname:a,search:o}=jl(e,{relative:t}),l=a;return r!=="/"&&(l=a==="/"?r:Dn([r,a])),n.createHref({pathname:l,search:o,hash:s})}function ki(){return x.useContext(_l)!=null}function Vr(){return Qe(ki(),"useLocation() may be used only in the context of a <Router> component."),x.useContext(_l).location}var u1="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function d1(e){x.useContext(Hr).static||x.useLayoutEffect(e)}function Jt(){let{isDataRoute:e}=x.useContext(qr);return e?_E():uE()}function uE(){Qe(ki(),"useNavigate() may be used only in the context of a <Router> component.");let e=x.useContext(ji),{basename:t,navigator:r}=x.useContext(Hr),{matches:n}=x.useContext(qr),{pathname:s}=Vr(),a=JSON.stringify(Qp(n)),o=x.useRef(!1);return d1(()=>{o.current=!0}),x.useCallback((c,u={})=>{if(Ur(o.current,u1),!o.current)return;if(typeof c=="number"){r.go(c);return}let d=Jp(c,JSON.parse(a),s,u.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:Dn([t,d.pathname])),(u.replace?r.replace:r.push)(d,u.state,u)},[t,r,a,s,e])}x.createContext(null);function Ni(){let{matches:e}=x.useContext(qr),t=e[e.length-1];return t?t.params:{}}function jl(e,{relative:t}={}){let{matches:r}=x.useContext(qr),{pathname:n}=Vr(),s=JSON.stringify(Qp(r));return x.useMemo(()=>Jp(e,JSON.parse(s),n,t==="path"),[e,s,n,t])}function dE(e,t){return f1(e,t)}function f1(e,t,r,n,s){var b;Qe(ki(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=x.useContext(Hr),{matches:o}=x.useContext(qr),l=o[o.length-1],c=l?l.params:{},u=l?l.pathname:"/",d=l?l.pathnameBase:"/",f=l&&l.route;{let p=f&&f.path||"";m1(u,!f||p.endsWith("*")||p.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${p}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${p}"> to <Route path="${p==="/"?"*":`${p}/*`}">.`)}let m=Vr(),h;if(t){let p=typeof t=="string"?_i(t):t;Qe(d==="/"||((b=p.pathname)==null?void 0:b.startsWith(d)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${d}" but pathname "${p.pathname}" was given in the \`location\` prop.`),h=p}else h=m;let y=h.pathname||"/",v=y;if(d!=="/"){let p=d.replace(/^\//,"").split("/");v="/"+y.replace(/^\//,"").split("/").slice(p.length).join("/")}let w=a1(e,{pathname:v});Ur(f||w!=null,`No routes matched location "${h.pathname}${h.search}${h.hash}" `),Ur(w==null||w[w.length-1].route.element!==void 0||w[w.length-1].route.Component!==void 0||w[w.length-1].route.lazy!==void 0,`Matched leaf route at location "${h.pathname}${h.search}${h.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let g=gE(w&&w.map(p=>Object.assign({},p,{params:Object.assign({},c,p.params),pathname:Dn([d,a.encodeLocation?a.encodeLocation(p.pathname).pathname:p.pathname]),pathnameBase:p.pathnameBase==="/"?d:Dn([d,a.encodeLocation?a.encodeLocation(p.pathnameBase).pathname:p.pathnameBase])})),o,r,n,s);return t&&g?x.createElement(_l.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...h},navigationType:"POP"}},g):g}function fE(){let e=wE(),t=aE(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:n},a={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=x.createElement(x.Fragment,null,x.createElement("p",null," Hey developer "),x.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",x.createElement("code",{style:a},"ErrorBoundary")," or"," ",x.createElement("code",{style:a},"errorElement")," prop on your route.")),x.createElement(x.Fragment,null,x.createElement("h2",null,"Unexpected Application Error!"),x.createElement("h3",{style:{fontStyle:"italic"}},t),r?x.createElement("pre",{style:s},r):null,o)}var mE=x.createElement(fE,null),hE=class extends x.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return this.state.error!==void 0?x.createElement(qr.Provider,{value:this.props.routeContext},x.createElement(Xp.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function pE({routeContext:e,match:t,children:r}){let n=x.useContext(ji);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),x.createElement(qr.Provider,{value:e},r)}function gE(e,t=[],r=null,n=null,s=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let a=e,o=r==null?void 0:r.errors;if(o!=null){let u=a.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);Qe(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,u+1))}let l=!1,c=-1;if(r)for(let u=0;u<a.length;u++){let d=a[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=u),d.route.id){let{loaderData:f,errors:m}=r,h=d.route.loader&&!f.hasOwnProperty(d.route.id)&&(!m||m[d.route.id]===void 0);if(d.route.lazy||h){l=!0,c>=0?a=a.slice(0,c+1):a=[a[0]];break}}}return a.reduceRight((u,d,f)=>{let m,h=!1,y=null,v=null;r&&(m=o&&d.route.id?o[d.route.id]:void 0,y=d.route.errorElement||mE,l&&(c<0&&f===0?(m1("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,v=null):c===f&&(h=!0,v=d.route.hydrateFallbackElement||null)));let w=t.concat(a.slice(0,f+1)),g=()=>{let b;return m?b=y:h?b=v:d.route.Component?b=x.createElement(d.route.Component,null):d.route.element?b=d.route.element:b=u,x.createElement(pE,{match:d,routeContext:{outlet:u,matches:w,isDataRoute:r!=null},children:b})};return r&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?x.createElement(hE,{location:r.location,revalidation:r.revalidation,component:y,error:m,children:g(),routeContext:{outlet:null,matches:w,isDataRoute:!0},unstable_onError:n}):g()},null)}function Zp(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function xE(e){let t=x.useContext(ji);return Qe(t,Zp(e)),t}function yE(e){let t=x.useContext(fd);return Qe(t,Zp(e)),t}function bE(e){let t=x.useContext(qr);return Qe(t,Zp(e)),t}function eg(e){let t=bE(e),r=t.matches[t.matches.length-1];return Qe(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function vE(){return eg("useRouteId")}function wE(){var n;let e=x.useContext(Xp),t=yE("useRouteError"),r=eg("useRouteError");return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function _E(){let{router:e}=xE("useNavigate"),t=eg("useNavigate"),r=x.useRef(!1);return d1(()=>{r.current=!0}),x.useCallback(async(s,a={})=>{Ur(r.current,u1),r.current&&(typeof s=="number"?e.navigate(s):await e.navigate(s,{fromRouteId:t,...a}))},[e,t])}var Ax={};function m1(e,t,r){!t&&!Ax[e]&&(Ax[e]=!0,Ur(!1,r))}x.memo(jE);function jE({routes:e,future:t,state:r,unstable_onError:n}){return f1(e,void 0,r,n,t)}function kE({to:e,replace:t,state:r,relative:n}){Qe(ki(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=x.useContext(Hr);Ur(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:a}=x.useContext(qr),{pathname:o}=Vr(),l=Jt(),c=Jp(e,Qp(a),o,n==="path"),u=JSON.stringify(c);return x.useEffect(()=>{l(JSON.parse(u),{replace:t,state:r,relative:n})},[l,u,n,t,r]),null}function ut(e){Qe(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function NE({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:s,static:a=!1}){Qe(!ki(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),l=x.useMemo(()=>({basename:o,navigator:s,static:a,future:{}}),[o,s,a]);typeof r=="string"&&(r=_i(r));let{pathname:c="/",search:u="",hash:d="",state:f=null,key:m="default"}=r,h=x.useMemo(()=>{let y=Fn(c,o);return y==null?null:{location:{pathname:y,search:u,hash:d,state:f,key:m},navigationType:n}},[o,c,u,d,f,m,n]);return Ur(h!=null,`<Router basename="${o}"> is not able to match the URL "${c}${u}${d}" because it does not start with the basename, so the <Router> won't render anything.`),h==null?null:x.createElement(Hr.Provider,{value:l},x.createElement(_l.Provider,{children:t,value:h}))}function SE({children:e,location:t}){return dE(mh(e),t)}function mh(e,t=[]){let r=[];return x.Children.forEach(e,(n,s)=>{if(!x.isValidElement(n))return;let a=[...t,s];if(n.type===x.Fragment){r.push.apply(r,mh(n.props.children,a));return}Qe(n.type===ut,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Qe(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=mh(n.props.children,a)),r.push(o)}),r}var Fc="get",Bc="application/x-www-form-urlencoded";function md(e){return e!=null&&typeof e.tagName=="string"}function CE(e){return md(e)&&e.tagName.toLowerCase()==="button"}function EE(e){return md(e)&&e.tagName.toLowerCase()==="form"}function DE(e){return md(e)&&e.tagName.toLowerCase()==="input"}function PE(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function TE(e,t){return e.button===0&&(!t||t==="_self")&&!PE(e)}var tc=null;function LE(){if(tc===null)try{new FormData(document.createElement("form"),0),tc=!1}catch{tc=!0}return tc}var IE=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function bf(e){return e!=null&&!IE.has(e)?(Ur(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Bc}"`),null):e}function RE(e,t){let r,n,s,a,o;if(EE(e)){let l=e.getAttribute("action");n=l?Fn(l,t):null,r=e.getAttribute("method")||Fc,s=bf(e.getAttribute("enctype"))||Bc,a=new FormData(e)}else if(CE(e)||DE(e)&&(e.type==="submit"||e.type==="image")){let l=e.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=e.getAttribute("formaction")||l.getAttribute("action");if(n=c?Fn(c,t):null,r=e.getAttribute("formmethod")||l.getAttribute("method")||Fc,s=bf(e.getAttribute("formenctype"))||bf(l.getAttribute("enctype"))||Bc,a=new FormData(l,e),!LE()){let{name:u,type:d,value:f}=e;if(d==="image"){let m=u?`${u}.`:"";a.append(`${m}x`,"0"),a.append(`${m}y`,"0")}else u&&a.append(u,f)}}else{if(md(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Fc,n=null,s=Bc,o=e}return a&&s==="text/plain"&&(o=a,a=void 0),{action:n,method:r.toLowerCase(),encType:s,formData:a,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function tg(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function ME(e,t,r){let n=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return n.pathname==="/"?n.pathname=`_root.${r}`:t&&Fn(n.pathname,t)==="/"?n.pathname=`${t.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function OE(e,t){if(e.id in t)return t[e.id];try{let r=await wi(()=>import(e.module),[]);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function AE(e){return e!=null&&typeof e.page=="string"}function $E(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function FE(e,t,r){let n=await Promise.all(e.map(async s=>{let a=t.routes[s.route.id];if(a){let o=await OE(a,r);return o.links?o.links():[]}return[]}));return WE(n.flat(1).filter($E).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function $x(e,t,r,n,s,a){let o=(c,u)=>r[u]?c.route.id!==r[u].route.id:!0,l=(c,u)=>{var d;return r[u].pathname!==c.pathname||((d=r[u].route.path)==null?void 0:d.endsWith("*"))&&r[u].params["*"]!==c.params["*"]};return a==="assets"?t.filter((c,u)=>o(c,u)||l(c,u)):a==="data"?t.filter((c,u)=>{var f;let d=n.routes[c.route.id];if(!d||!d.hasLoader)return!1;if(o(c,u)||l(c,u))return!0;if(c.route.shouldRevalidate){let m=c.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((f=r[0])==null?void 0:f.params)||{},nextUrl:new URL(e,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function BE(e,t,{includeHydrateFallback:r}={}){return UE(e.map(n=>{let s=t.routes[n.route.id];if(!s)return[];let a=[s.module];return s.clientActionModule&&(a=a.concat(s.clientActionModule)),s.clientLoaderModule&&(a=a.concat(s.clientLoaderModule)),r&&s.hydrateFallbackModule&&(a=a.concat(s.hydrateFallbackModule)),s.imports&&(a=a.concat(s.imports)),a}).flat(1))}function UE(e){return[...new Set(e)]}function zE(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function WE(e,t){let r=new Set,n=new Set(t);return e.reduce((s,a)=>{if(t&&!AE(a)&&a.as==="script"&&a.href&&n.has(a.href))return s;let l=JSON.stringify(zE(a));return r.has(l)||(r.add(l),s.push({key:l,link:a})),s},[])}function h1(){let e=x.useContext(ji);return tg(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function HE(){let e=x.useContext(fd);return tg(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var rg=x.createContext(void 0);rg.displayName="FrameworkContext";function p1(){let e=x.useContext(rg);return tg(e,"You must render this element inside a <HydratedRouter> element"),e}function qE(e,t){let r=x.useContext(rg),[n,s]=x.useState(!1),[a,o]=x.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:f}=t,m=x.useRef(null);x.useEffect(()=>{if(e==="render"&&o(!0),e==="viewport"){let v=g=>{g.forEach(b=>{o(b.isIntersecting)})},w=new IntersectionObserver(v,{threshold:.5});return m.current&&w.observe(m.current),()=>{w.disconnect()}}},[e]),x.useEffect(()=>{if(n){let v=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(v)}}},[n]);let h=()=>{s(!0)},y=()=>{s(!1),o(!1)};return r?e!=="intent"?[a,m,{}]:[a,m,{onFocus:qi(l,h),onBlur:qi(c,y),onMouseEnter:qi(u,h),onMouseLeave:qi(d,y),onTouchStart:qi(f,h)}]:[!1,m,{}]}function qi(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function VE({page:e,...t}){let{router:r}=h1(),n=x.useMemo(()=>a1(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?x.createElement(GE,{page:e,matches:n,...t}):null}function YE(e){let{manifest:t,routeModules:r}=p1(),[n,s]=x.useState([]);return x.useEffect(()=>{let a=!1;return FE(e,t,r).then(o=>{a||s(o)}),()=>{a=!0}},[e,t,r]),n}function GE({page:e,matches:t,...r}){let n=Vr(),{manifest:s,routeModules:a}=p1(),{basename:o}=h1(),{loaderData:l,matches:c}=HE(),u=x.useMemo(()=>$x(e,t,c,s,n,"data"),[e,t,c,s,n]),d=x.useMemo(()=>$x(e,t,c,s,n,"assets"),[e,t,c,s,n]),f=x.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let y=new Set,v=!1;if(t.forEach(g=>{var p;let b=s.routes[g.route.id];!b||!b.hasLoader||(!u.some(_=>_.route.id===g.route.id)&&g.route.id in l&&((p=a[g.route.id])!=null&&p.shouldRevalidate)||b.hasClientLoader?v=!0:y.add(g.route.id))}),y.size===0)return[];let w=ME(e,o,"data");return v&&y.size>0&&w.searchParams.set("_routes",t.filter(g=>y.has(g.route.id)).map(g=>g.route.id).join(",")),[w.pathname+w.search]},[o,l,n,s,u,t,e,a]),m=x.useMemo(()=>BE(d,s),[d,s]),h=YE(d);return x.createElement(x.Fragment,null,f.map(y=>x.createElement("link",{key:y,rel:"prefetch",as:"fetch",href:y,...r})),m.map(y=>x.createElement("link",{key:y,rel:"modulepreload",href:y,...r})),h.map(({key:y,link:v})=>x.createElement("link",{key:y,nonce:r.nonce,...v})))}function KE(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var g1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{g1&&(window.__reactRouterVersion="7.9.0")}catch{}function QE({basename:e,children:t,window:r}){let n=x.useRef();n.current==null&&(n.current=OC({window:r,v5Compat:!0}));let s=n.current,[a,o]=x.useState({action:s.action,location:s.location}),l=x.useCallback(c=>{x.startTransition(()=>o(c))},[o]);return x.useLayoutEffect(()=>s.listen(l),[s,l]),x.createElement(NE,{basename:e,children:t,location:a.location,navigationType:a.action,navigator:s})}var x1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ga=x.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:s,reloadDocument:a,replace:o,state:l,target:c,to:u,preventScrollReset:d,viewTransition:f,...m},h){let{basename:y}=x.useContext(Hr),v=typeof u=="string"&&x1.test(u),w,g=!1;if(typeof u=="string"&&v&&(w=u,g1))try{let C=new URL(window.location.href),E=u.startsWith("//")?new URL(C.protocol+u):new URL(u),T=Fn(E.pathname,y);E.origin===C.origin&&T!=null?u=T+E.search+E.hash:g=!0}catch{Ur(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let b=cE(u,{relative:s}),[p,_,j]=qE(n,m),k=eD(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:s,viewTransition:f});function N(C){t&&t(C),C.defaultPrevented||k(C)}let S=x.createElement("a",{...m,...j,href:w||b,onClick:g||a?t:N,ref:KE(h,_),target:c,"data-discover":!v&&r==="render"?"true":void 0});return p&&!v?x.createElement(x.Fragment,null,S,x.createElement(VE,{page:b})):S});Ga.displayName="Link";var JE=x.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:s=!1,style:a,to:o,viewTransition:l,children:c,...u},d){let f=jl(o,{relative:u.relative}),m=Vr(),h=x.useContext(fd),{navigator:y,basename:v}=x.useContext(Hr),w=h!=null&&aD(f)&&l===!0,g=y.encodeLocation?y.encodeLocation(f).pathname:f.pathname,b=m.pathname,p=h&&h.navigation&&h.navigation.location?h.navigation.location.pathname:null;r||(b=b.toLowerCase(),p=p?p.toLowerCase():null,g=g.toLowerCase()),p&&v&&(p=Fn(p,v)||p);const _=g!=="/"&&g.endsWith("/")?g.length-1:g.length;let j=b===g||!s&&b.startsWith(g)&&b.charAt(_)==="/",k=p!=null&&(p===g||!s&&p.startsWith(g)&&p.charAt(g.length)==="/"),N={isActive:j,isPending:k,isTransitioning:w},S=j?t:void 0,C;typeof n=="function"?C=n(N):C=[n,j?"active":null,k?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let E=typeof a=="function"?a(N):a;return x.createElement(Ga,{...u,"aria-current":S,className:C,ref:d,style:E,to:o,viewTransition:l},typeof c=="function"?c(N):c)});JE.displayName="NavLink";var XE=x.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:s,state:a,method:o=Fc,action:l,onSubmit:c,relative:u,preventScrollReset:d,viewTransition:f,...m},h)=>{let y=nD(),v=sD(l,{relative:u}),w=o.toLowerCase()==="get"?"get":"post",g=typeof l=="string"&&x1.test(l),b=p=>{if(c&&c(p),p.defaultPrevented)return;p.preventDefault();let _=p.nativeEvent.submitter,j=(_==null?void 0:_.getAttribute("formmethod"))||o;y(_||p.currentTarget,{fetcherKey:t,method:j,navigate:r,replace:s,state:a,relative:u,preventScrollReset:d,viewTransition:f})};return x.createElement("form",{ref:h,method:w,action:v,onSubmit:n?c:b,...m,"data-discover":!g&&e==="render"?"true":void 0})});XE.displayName="Form";function ZE(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function y1(e){let t=x.useContext(ji);return Qe(t,ZE(e)),t}function eD(e,{target:t,replace:r,state:n,preventScrollReset:s,relative:a,viewTransition:o}={}){let l=Jt(),c=Vr(),u=jl(e,{relative:a});return x.useCallback(d=>{if(TE(d,t)){d.preventDefault();let f=r!==void 0?r:tl(c)===tl(u);l(e,{replace:f,state:n,preventScrollReset:s,relative:a,viewTransition:o})}},[c,l,u,r,n,t,e,s,a,o])}var tD=0,rD=()=>`__${String(++tD)}__`;function nD(){let{router:e}=y1("useSubmit"),{basename:t}=x.useContext(Hr),r=vE();return x.useCallback(async(n,s={})=>{let{action:a,method:o,encType:l,formData:c,body:u}=RE(n,t);if(s.navigate===!1){let d=s.fetcherKey||rD();await e.fetch(d,r,s.action||a,{preventScrollReset:s.preventScrollReset,formData:c,body:u,formMethod:s.method||o,formEncType:s.encType||l,flushSync:s.flushSync})}else await e.navigate(s.action||a,{preventScrollReset:s.preventScrollReset,formData:c,body:u,formMethod:s.method||o,formEncType:s.encType||l,replace:s.replace,state:s.state,fromRouteId:r,flushSync:s.flushSync,viewTransition:s.viewTransition})},[e,t,r])}function sD(e,{relative:t}={}){let{basename:r}=x.useContext(Hr),n=x.useContext(qr);Qe(n,"useFormAction must be used inside a RouteContext");let[s]=n.matches.slice(-1),a={...jl(e||".",{relative:t})},o=Vr();if(e==null){a.search=o.search;let l=new URLSearchParams(a.search),c=l.getAll("index");if(c.some(d=>d==="")){l.delete("index"),c.filter(f=>f).forEach(f=>l.append("index",f));let d=l.toString();a.search=d?`?${d}`:""}}return(!e||e===".")&&s.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(a.pathname=a.pathname==="/"?r:Dn([r,a.pathname])),tl(a)}function aD(e,{relative:t}={}){let r=x.useContext(c1);Qe(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=y1("useViewTransitionState"),s=jl(e,{relative:t});if(!r.isTransitioning)return!1;let a=Fn(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=Fn(r.nextLocation.pathname,n)||r.nextLocation.pathname;return _u(s.pathname,o)!=null||_u(s.pathname,a)!=null}const iD=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>wi(()=>Promise.resolve().then(()=>Si),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class ng extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class oD extends ng{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Fx extends ng{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Bx extends ng{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var hh;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(hh||(hh={}));var lD=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(d){try{u(n.next(d))}catch(f){o(f)}}function c(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?a(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};class cD{constructor(t,{headers:r={},customFetch:n,region:s=hh.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=iD(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return lD(this,void 0,void 0,function*(){try{const{headers:s,method:a,body:o}=r;let l={},{region:c}=r;c||(c=this.region);const u=new URL(`${this.url}/${t}`);c&&c!=="any"&&(l["x-region"]=c,u.searchParams.set("forceFunctionRegion",c));let d;o&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",d=o):typeof o=="string"?(l["Content-Type"]="text/plain",d=o):typeof FormData<"u"&&o instanceof FormData?d=o:(l["Content-Type"]="application/json",d=JSON.stringify(o)));const f=yield this.fetch(u.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),s),body:d}).catch(v=>{throw new oD(v)}),m=f.headers.get("x-relay-error");if(m&&m==="true")throw new Fx(f);if(!f.ok)throw new Bx(f);let h=((n=f.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),y;return h==="application/json"?y=yield f.json():h==="application/octet-stream"?y=yield f.blob():h==="text/event-stream"?y=f:h==="multipart/form-data"?y=yield f.formData():y=yield f.text(),{data:y,error:null,response:f}}catch(s){return{data:null,error:s,response:s instanceof Bx||s instanceof Fx?s.context:void 0}}})}}var qt={},sg={},hd={},kl={},pd={},gd={},uD=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},ii=uD();const dD=ii.fetch,b1=ii.fetch.bind(ii),v1=ii.Headers,fD=ii.Request,mD=ii.Response,Si=Object.freeze(Object.defineProperty({__proto__:null,Headers:v1,Request:fD,Response:mD,default:b1,fetch:dD},Symbol.toStringTag,{value:"Module"})),hD=Hv(Si);var xd={};Object.defineProperty(xd,"__esModule",{value:!0});let pD=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};xd.default=pD;var w1=Dt&&Dt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(gd,"__esModule",{value:!0});const gD=w1(hD),xD=w1(xd);let yD=class{constructor(t){var r,n;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(r=t.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=gD.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=new Headers(this.headers),this.headers.set(t,r),this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{var o,l,c,u;let d=null,f=null,m=null,h=a.status,y=a.statusText;if(a.ok){if(this.method!=="HEAD"){const b=await a.text();b===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((o=this.headers.get("Accept"))===null||o===void 0)&&o.includes("application/vnd.pgrst.plan+text"))?f=b:f=JSON.parse(b))}const w=(l=this.headers.get("Prefer"))===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),g=(c=a.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");w&&g&&g.length>1&&(m=parseInt(g[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(f)&&(f.length>1?(d={code:"PGRST116",details:`Results contain ${f.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},f=null,m=null,h=406,y="Not Acceptable"):f.length===1?f=f[0]:f=null)}else{const w=await a.text();try{d=JSON.parse(w),Array.isArray(d)&&a.status===404&&(f=[],d=null,h=200,y="OK")}catch{a.status===404&&w===""?(h=204,y="No Content"):d={message:w}}if(d&&this.isMaybeSingle&&(!((u=d==null?void 0:d.details)===null||u===void 0)&&u.includes("0 rows"))&&(d=null,h=200,y="OK"),d&&this.shouldThrowOnError)throw new xD.default(d)}return{error:d,data:f,count:m,status:h,statusText:y}});return this.shouldThrowOnError||(s=s.catch(a=>{var o,l,c;return{error:{message:`${(o=a==null?void 0:a.name)!==null&&o!==void 0?o:"FetchError"}: ${a==null?void 0:a.message}`,details:`${(l=a==null?void 0:a.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=a==null?void 0:a.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),s.then(t,r)}returns(){return this}overrideTypes(){return this}};gd.default=yD;var bD=Dt&&Dt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(pd,"__esModule",{value:!0});const vD=bD(gd);let wD=class extends vD.default{select(t){let r=!1;const n=(t??"*").split("").map(s=>/\s/.test(s)&&!r?"":(s==='"'&&(r=!r),s)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:s,referencedTable:a=s}={}){const o=a?`${a}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:s=n}={}){const a=typeof s>"u"?"offset":`${s}.offset`,o=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(a,`${t}`),this.url.searchParams.set(o,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:s=!1,wal:a=!1,format:o="text"}={}){var l;const c=[t?"analyze":null,r?"verbose":null,n?"settings":null,s?"buffers":null,a?"wal":null].filter(Boolean).join("|"),u=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${o}; for="${u}"; options=${c};`),o==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};pd.default=wD;var _D=Dt&&Dt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(kl,"__esModule",{value:!0});const jD=_D(pd);let kD=class extends jD.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:s}={}){let a="";s==="plain"?a="pl":s==="phrase"?a="ph":s==="websearch"&&(a="w");const o=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${a}fts${o}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};kl.default=kD;var ND=Dt&&Dt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(hd,"__esModule",{value:!0});const Vi=ND(kl);let SD=class{constructor(t,{headers:r={},schema:n,fetch:s}){this.url=t,this.headers=new Headers(r),this.schema=n,this.fetch=s}select(t,{head:r=!1,count:n}={}){const s=r?"HEAD":"GET";let a=!1;const o=(t??"*").split("").map(l=>/\s/.test(l)&&!a?"":(l==='"'&&(a=!a),l)).join("");return this.url.searchParams.set("select",o),n&&this.headers.append("Prefer",`count=${n}`),new Vi.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:r,defaultToNull:n=!0}={}){var s;const a="POST";if(r&&this.headers.append("Prefer",`count=${r}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const o=t.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new Vi.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:s,defaultToNull:a=!0}={}){var o;const l="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),s&&this.headers.append("Prefer",`count=${s}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const c=t.reduce((u,d)=>u.concat(Object.keys(d)),[]);if(c.length>0){const u=[...new Set(c)].map(d=>`"${d}"`);this.url.searchParams.set("columns",u.join(","))}}return new Vi.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}update(t,{count:r}={}){var n;const s="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new Vi.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:t}={}){var r;const n="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new Vi.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};hd.default=SD;var _1=Dt&&Dt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(sg,"__esModule",{value:!0});const CD=_1(hd),ED=_1(kl);let DD=class j1{constructor(t,{headers:r={},schema:n,fetch:s}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=s}from(t){const r=new URL(`${this.url}/${t}`);return new CD.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new j1(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:s=!1,count:a}={}){var o;let l;const c=new URL(`${this.url}/rpc/${t}`);let u;n||s?(l=n?"HEAD":"GET",Object.entries(r).filter(([f,m])=>m!==void 0).map(([f,m])=>[f,Array.isArray(m)?`{${m.join(",")}}`:`${m}`]).forEach(([f,m])=>{c.searchParams.append(f,m)})):(l="POST",u=r);const d=new Headers(this.headers);return a&&d.set("Prefer",`count=${a}`),new ED.default({method:l,url:c,headers:d,schema:this.schemaName,body:u,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};sg.default=DD;var Ci=Dt&&Dt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(qt,"__esModule",{value:!0});qt.PostgrestError=qt.PostgrestBuilder=qt.PostgrestTransformBuilder=qt.PostgrestFilterBuilder=qt.PostgrestQueryBuilder=qt.PostgrestClient=void 0;const k1=Ci(sg);qt.PostgrestClient=k1.default;const N1=Ci(hd);qt.PostgrestQueryBuilder=N1.default;const S1=Ci(kl);qt.PostgrestFilterBuilder=S1.default;const C1=Ci(pd);qt.PostgrestTransformBuilder=C1.default;const E1=Ci(gd);qt.PostgrestBuilder=E1.default;const D1=Ci(xd);qt.PostgrestError=D1.default;var PD=qt.default={PostgrestClient:k1.default,PostgrestQueryBuilder:N1.default,PostgrestFilterBuilder:S1.default,PostgrestTransformBuilder:C1.default,PostgrestBuilder:E1.default,PostgrestError:D1.default};const{PostgrestClient:TD,PostgrestQueryBuilder:QW,PostgrestFilterBuilder:JW,PostgrestTransformBuilder:XW,PostgrestBuilder:ZW,PostgrestError:eH}=PD;class LD{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,s=parseInt(n.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const ID="2.15.5",RD=`realtime-js/${ID}`,MD="1.0.0",ph=1e4,OD=1e3,AD=100;var Do;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Do||(Do={}));var dt;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(dt||(dt={}));var Rr;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Rr||(Rr={}));var gh;(function(e){e.websocket="websocket"})(gh||(gh={}));var Bs;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Bs||(Bs={}));class $D{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const s=r.getUint8(1),a=r.getUint8(2);let o=this.HEADER_LENGTH+2;const l=n.decode(t.slice(o,o+s));o=o+s;const c=n.decode(t.slice(o,o+a));o=o+a;const u=JSON.parse(n.decode(t.slice(o,t.byteLength)));return{ref:null,topic:l,event:c,payload:u}}}class P1{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ze;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(ze||(ze={}));const Ux=(e,t,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((a,o)=>(a[o]=FD(o,e,t,s),a),{})},FD=(e,t,r,n)=>{const s=t.find(l=>l.name===e),a=s==null?void 0:s.type,o=r[e];return a&&!n.includes(a)?T1(a,o):xh(o)},T1=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return WD(t,r)}switch(e){case ze.bool:return BD(t);case ze.float4:case ze.float8:case ze.int2:case ze.int4:case ze.int8:case ze.numeric:case ze.oid:return UD(t);case ze.json:case ze.jsonb:return zD(t);case ze.timestamp:return HD(t);case ze.abstime:case ze.date:case ze.daterange:case ze.int4range:case ze.int8range:case ze.money:case ze.reltime:case ze.text:case ze.time:case ze.timestamptz:case ze.timetz:case ze.tsrange:case ze.tstzrange:return xh(t);default:return xh(t)}},xh=e=>e,BD=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},UD=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},zD=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},WD=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let a;const o=e.slice(1,r);try{a=JSON.parse("["+o+"]")}catch{a=o?o.split(","):[]}return a.map(l=>T1(t,l))}return e},HD=e=>typeof e=="string"?e.replace(" ","T"):e,L1=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class vf{constructor(t,r,n={},s=ph){this.channel=t,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var zx;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(zx||(zx={}));class Po{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Po.syncState(this.state,s,a,o),this.pendingDiffs.forEach(c=>{this.state=Po.syncDiff(this.state,c,a,o)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},s=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Po.syncDiff(this.state,s,a,o),l())}),this.onJoin((s,a,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:a,newPresences:o})}),this.onLeave((s,a,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:a,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,s){const a=this.cloneDeep(t),o=this.transformState(r),l={},c={};return this.map(a,(u,d)=>{o[u]||(c[u]=d)}),this.map(o,(u,d)=>{const f=a[u];if(f){const m=d.map(w=>w.presence_ref),h=f.map(w=>w.presence_ref),y=d.filter(w=>h.indexOf(w.presence_ref)<0),v=f.filter(w=>m.indexOf(w.presence_ref)<0);y.length>0&&(l[u]=y),v.length>0&&(c[u]=v)}else l[u]=d}),this.syncDiff(a,{joins:l,leaves:c},n,s)}static syncDiff(t,r,n,s){const{joins:a,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(a,(l,c)=>{var u;const d=(u=t[l])!==null&&u!==void 0?u:[];if(t[l]=this.cloneDeep(c),d.length>0){const f=t[l].map(h=>h.presence_ref),m=d.filter(h=>f.indexOf(h.presence_ref)<0);t[l].unshift(...m)}n(l,d,c)}),this.map(o,(l,c)=>{let u=t[l];if(!u)return;const d=c.map(f=>f.presence_ref);u=u.filter(f=>d.indexOf(f.presence_ref)<0),t[l]=u,s(l,u,c),u.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const s=t[n];return"metas"in s?r[n]=s.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):r[n]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Wx;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Wx||(Wx={}));var To;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(To||(To={}));var _n;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(_n||(_n={}));class ag{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=dt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new vf(this,Rr.join,this.params,this.timeout),this.rejoinTimer=new P1(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=dt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=dt.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=dt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=dt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=dt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Rr.reply,{},(s,a)=>{this._trigger(this._replyEventName(a),s)}),this.presence=new Po(this),this.broadcastEndpointURL=L1(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,s,a;if(this.socket.isConnected()||this.socket.connect(),this.state==dt.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,u=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(h=>h.filter))!==null&&s!==void 0?s:[],d=!!this.bindings[To.PRESENCE]&&this.bindings[To.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,f={},m={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:d}),postgres_changes:u,private:c};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(h=>t==null?void 0:t(_n.CHANNEL_ERROR,h)),this._onClose(()=>t==null?void 0:t(_n.CLOSED)),this.updateJoinPayload(Object.assign({config:m},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:h})=>{var y;if(this.socket.setAuth(),h===void 0){t==null||t(_n.SUBSCRIBED);return}else{const v=this.bindings.postgres_changes,w=(y=v==null?void 0:v.length)!==null&&y!==void 0?y:0,g=[];for(let b=0;b<w;b++){const p=v[b],{filter:{event:_,schema:j,table:k,filter:N}}=p,S=h&&h[b];if(S&&S.event===_&&S.schema===j&&S.table===k&&S.filter===N)g.push(Object.assign(Object.assign({},p),{id:S.id}));else{this.unsubscribe(),this.state=dt.errored,t==null||t(_n.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,t&&t(_n.SUBSCRIBED);return}}).receive("error",h=>{this.state=dt.errored,t==null||t(_n.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(h).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(_n.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===dt.joined&&t===To.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async send(t,r={}){var n,s;if(!this._canPush()&&t.type==="broadcast"){const{event:a,payload:o}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=u.body)===null||s===void 0?void 0:s.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var o,l,c;const u=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&a("ok"),u.receive("ok",()=>a("ok")),u.receive("error",()=>a("error")),u.receive("timeout",()=>a("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=dt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Rr.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new vf(this,Rr.leave,{},t),n.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=dt.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const s=new AbortController,a=setTimeout(()=>s.abort(),n),o=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(a),o}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new vf(this,t,r,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>AD){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var s,a;const o=t.toLocaleLowerCase(),{close:l,error:c,leave:u,join:d}=Rr;if(n&&[l,c,u,d].indexOf(o)>=0&&n!==this._joinRef())return;let m=this._onMessage(o,r,n);if(r&&!m)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(h=>{var y,v,w;return((y=h.filter)===null||y===void 0?void 0:y.event)==="*"||((w=(v=h.filter)===null||v===void 0?void 0:v.event)===null||w===void 0?void 0:w.toLocaleLowerCase())===o}).map(h=>h.callback(m,n)):(a=this.bindings[o])===null||a===void 0||a.filter(h=>{var y,v,w,g,b,p;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in h){const _=h.id,j=(y=h.filter)===null||y===void 0?void 0:y.event;return _&&((v=r.ids)===null||v===void 0?void 0:v.includes(_))&&(j==="*"||(j==null?void 0:j.toLocaleLowerCase())===((w=r.data)===null||w===void 0?void 0:w.type.toLocaleLowerCase()))}else{const _=(b=(g=h==null?void 0:h.filter)===null||g===void 0?void 0:g.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return _==="*"||_===((p=r==null?void 0:r.event)===null||p===void 0?void 0:p.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===o}).map(h=>{if(typeof m=="object"&&"ids"in m){const y=m.data,{schema:v,table:w,commit_timestamp:g,type:b,errors:p}=y;m=Object.assign(Object.assign({},{schema:v,table:w,commit_timestamp:g,eventType:b,new:{},old:{},errors:p}),this._getPayloadRecords(y))}h.callback(m,n)})}_isClosed(){return this.state===dt.closed}_isJoined(){return this.state===dt.joined}_isJoining(){return this.state===dt.joining}_isLeaving(){return this.state===dt.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const s=t.toLocaleLowerCase(),a={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(a):this.bindings[s]=[a],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var a;return!(((a=s.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===n&&ag.isEqual(s.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Rr.close,{},t)}_onError(t){this._on(Rr.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=dt.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Ux(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Ux(t.columns,t.old_record)),r}}const wf=()=>{},rc={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},qD=[1e3,2e3,5e3,1e4],VD=1e4,YD=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class GD{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=ph,this.transport=null,this.heartbeatIntervalMs=rc.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=wf,this.ref=0,this.reconnectTimer=null,this.logger=wf,this.conn=null,this.sendBuffer=[],this.serializer=new $D,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>{let a;return s?a=s:typeof fetch>"u"?a=(...o)=>wi(()=>Promise.resolve().then(()=>Si),void 0).then(({default:l})=>l(...o)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):a=fetch,(...o)=>a(...o)},!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${gh.websocket}`,this.httpEndpoint=L1(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=LD.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:MD}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Do.connecting:return Bs.Connecting;case Do.open:return Bs.Open;case Do.closing:return Bs.Closing;default:return Bs.Closed}}isConnected(){return this.connectionState()===Bs.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,s=this.getChannels().find(a=>a.topic===n);if(s)return s;{const a=new ag(`realtime:${t}`,r,this);return this.channels.push(a),a}}push(t){const{topic:r,event:n,payload:s,ref:a}=t,o=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${n} (${a})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(OD,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},rc.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:s,payload:a,ref:o}=r,l=o?`(${o})`:"",c=a.status||"";this.log("receive",`${c} ${n} ${s} ${l}`.trim(),a),this.channels.filter(u=>u._isMember(n)).forEach(u=>u._trigger(s,a,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Rr.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${n}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([YD],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const s={access_token:r,version:RD};r&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(Rr.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(s){this.log("error",`error in ${t} callback`,s)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new P1(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},rc.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,s,a,o,l,c,u,d;if(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:ph,this.heartbeatIntervalMs=(s=t==null?void 0:t.heartbeatIntervalMs)!==null&&s!==void 0?s:rc.HEARTBEAT_INTERVAL,this.worker=(a=t==null?void 0:t.worker)!==null&&a!==void 0?a:!1,this.accessToken=(o=t==null?void 0:t.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=t==null?void 0:t.heartbeatCallback)!==null&&l!==void 0?l:wf,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t==null?void 0:t.reconnectAfterMs)!==null&&c!==void 0?c:f=>qD[f-1]||VD,this.encode=(u=t==null?void 0:t.encode)!==null&&u!==void 0?u:(f,m)=>m(JSON.stringify(f)),this.decode=(d=t==null?void 0:t.decode)!==null&&d!==void 0?d:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class ig extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function ft(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class KD extends ig{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class yh extends ig{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var QD=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(d){try{u(n.next(d))}catch(f){o(f)}}function c(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?a(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};const I1=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>wi(()=>Promise.resolve().then(()=>Si),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},JD=()=>QD(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield wi(()=>Promise.resolve().then(()=>Si),void 0)).Response:Response}),bh=e=>{if(Array.isArray(e))return e.map(r=>bh(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));t[s]=bh(n)}),t},XD=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var fa=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(d){try{u(n.next(d))}catch(f){o(f)}}function c(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?a(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};const _f=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),ZD=(e,t,r)=>fa(void 0,void 0,void 0,function*(){const n=yield JD();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(s=>{const a=e.status||500,o=(s==null?void 0:s.statusCode)||a+"";t(new KD(_f(s),a,o))}).catch(s=>{t(new yh(_f(s),s))}):t(new yh(_f(e),e))}),e4=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?s:(XD(n)?(s.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),s.body=JSON.stringify(n)):s.body=n,t!=null&&t.duplex&&(s.duplex=t.duplex),Object.assign(Object.assign({},s),r))};function Nl(e,t,r,n,s,a){return fa(this,void 0,void 0,function*(){return new Promise((o,l)=>{e(r,e4(t,n,s,a)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>ZD(c,l,n))})})}function ju(e,t,r,n){return fa(this,void 0,void 0,function*(){return Nl(e,"GET",t,r,n)})}function Jr(e,t,r,n,s){return fa(this,void 0,void 0,function*(){return Nl(e,"POST",t,n,s,r)})}function vh(e,t,r,n,s){return fa(this,void 0,void 0,function*(){return Nl(e,"PUT",t,n,s,r)})}function t4(e,t,r,n){return fa(this,void 0,void 0,function*(){return Nl(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function R1(e,t,r,n,s){return fa(this,void 0,void 0,function*(){return Nl(e,"DELETE",t,n,s,r)})}var It=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(d){try{u(n.next(d))}catch(f){o(f)}}function c(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?a(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};const r4={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Hx={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class n4{constructor(t,r={},n,s){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=n,this.fetch=I1(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,n,s){return It(this,void 0,void 0,function*(){try{let a;const o=Object.assign(Object.assign({},Hx),s);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&n instanceof Blob?(a=new FormData,a.append("cacheControl",o.cacheControl),c&&a.append("metadata",this.encodeMetadata(c)),a.append("",n)):typeof FormData<"u"&&n instanceof FormData?(a=n,a.append("cacheControl",o.cacheControl),c&&a.append("metadata",this.encodeMetadata(c))):(a=n,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),s!=null&&s.headers&&(l=Object.assign(Object.assign({},l),s.headers));const u=this._removeEmptyFolders(r),d=this._getFinalPath(u),f=yield(t=="PUT"?vh:Jr)(this.fetch,`${this.url}/object/${d}`,a,Object.assign({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:u,id:f.Id,fullPath:f.Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ft(a))return{data:null,error:a};throw a}})}upload(t,r,n){return It(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,s){return It(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(t),o=this._getFinalPath(a),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",r);try{let c;const u=Object.assign({upsert:Hx.upsert},s),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",u.cacheControl)):(c=n,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const f=yield vh(this.fetch,l.toString(),c,{headers:d});return{data:{path:a,fullPath:f.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(ft(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return It(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const s=Object.assign({},this.headers);r!=null&&r.upsert&&(s["x-upsert"]="true");const a=yield Jr(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),o=new URL(this.url+a.url),l=o.searchParams.get("token");if(!l)throw new ig("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:l},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ft(n))return{data:null,error:n};throw n}})}update(t,r,n){return It(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return It(this,void 0,void 0,function*(){try{return{data:yield Jr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ft(s))return{data:null,error:s};throw s}})}copy(t,r,n){return It(this,void 0,void 0,function*(){try{return{data:{path:(yield Jr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ft(s))return{data:null,error:s};throw s}})}createSignedUrl(t,r,n){return It(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),a=yield Jr(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${o}`)},{data:a,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ft(s))return{data:null,error:s};throw s}})}createSignedUrls(t,r,n){return It(this,void 0,void 0,function*(){try{const s=yield Jr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${a}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ft(s))return{data:null,error:s};throw s}})}download(t,r){return It(this,void 0,void 0,function*(){const s=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),o=a?`?${a}`:"";try{const l=this._getFinalPath(t);return{data:yield(yield ju(this.fetch,`${this.url}/${s}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(ft(l))return{data:null,error:l};throw l}})}info(t){return It(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield ju(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:bh(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ft(n))return{data:null,error:n};throw n}})}exists(t){return It(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield t4(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ft(n)&&n instanceof yh){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),s=[],a=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";a!==""&&s.push(a);const l=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&s.push(c);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${u}`)}}}remove(t){return It(this,void 0,void 0,function*(){try{return{data:yield R1(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ft(r))return{data:null,error:r};throw r}})}list(t,r,n){return It(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},r4),r),{prefix:t||""});return{data:yield Jr(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ft(s))return{data:null,error:s};throw s}})}listV2(t,r){return It(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield Jr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ft(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const s4="2.12.1",a4={"X-Client-Info":`storage-js/${s4}`};var ya=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(d){try{u(n.next(d))}catch(f){o(f)}}function c(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?a(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};class i4{constructor(t,r={},n,s){this.shouldThrowOnError=!1;const a=new URL(t);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href,this.headers=Object.assign(Object.assign({},a4),r),this.fetch=I1(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return ya(this,void 0,void 0,function*(){try{return{data:yield ju(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ft(t))return{data:null,error:t};throw t}})}getBucket(t){return ya(this,void 0,void 0,function*(){try{return{data:yield ju(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ft(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return ya(this,void 0,void 0,function*(){try{return{data:yield Jr(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ft(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return ya(this,void 0,void 0,function*(){try{return{data:yield vh(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ft(n))return{data:null,error:n};throw n}})}emptyBucket(t){return ya(this,void 0,void 0,function*(){try{return{data:yield Jr(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ft(r))return{data:null,error:r};throw r}})}deleteBucket(t){return ya(this,void 0,void 0,function*(){try{return{data:yield R1(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ft(r))return{data:null,error:r};throw r}})}}class o4 extends i4{constructor(t,r={},n,s){super(t,r,n,s)}from(t){return new n4(this.url,this.headers,t,this.fetch)}}const l4="2.57.4";let xo="";typeof Deno<"u"?xo="deno":typeof document<"u"?xo="web":typeof navigator<"u"&&navigator.product==="ReactNative"?xo="react-native":xo="node";const c4={"X-Client-Info":`supabase-js-${xo}/${l4}`},u4={headers:c4},d4={schema:"public"},f4={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},m4={};var h4=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(d){try{u(n.next(d))}catch(f){o(f)}}function c(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?a(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};const p4=e=>{let t;return e?t=e:typeof fetch>"u"?t=b1:t=fetch,(...r)=>t(...r)},g4=()=>typeof Headers>"u"?v1:Headers,x4=(e,t,r)=>{const n=p4(r),s=g4();return(a,o)=>h4(void 0,void 0,void 0,function*(){var l;const c=(l=yield t())!==null&&l!==void 0?l:e;let u=new s(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),n(a,Object.assign(Object.assign({},o),{headers:u}))})};var y4=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(d){try{u(n.next(d))}catch(f){o(f)}}function c(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?a(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};function b4(e){return e.endsWith("/")?e:e+"/"}function v4(e,t){var r,n;const{db:s,auth:a,realtime:o,global:l}=e,{db:c,auth:u,realtime:d,global:f}=t,m={db:Object.assign(Object.assign({},c),s),auth:Object.assign(Object.assign({},u),a),realtime:Object.assign(Object.assign({},d),o),storage:{},global:Object.assign(Object.assign(Object.assign({},f),l),{headers:Object.assign(Object.assign({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(n=l==null?void 0:l.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>y4(this,void 0,void 0,function*(){return""})};return e.accessToken?m.accessToken=e.accessToken:delete m.accessToken,m}function w4(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(b4(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const M1="2.71.1",Na=30*1e3,wh=3,jf=wh*Na,_4="http://localhost:9999",j4="supabase.auth.token",k4={"X-Client-Info":`gotrue-js/${M1}`},_h="X-Supabase-Api-Version",O1={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},N4=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,S4=10*60*1e3;class og extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function ge(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class C4 extends og{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function E4(e){return ge(e)&&e.name==="AuthApiError"}class A1 extends og{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class js extends og{constructor(t,r,n,s){super(t,n,s),this.name=r,this.status=n}}class Yn extends js{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function D4(e){return ge(e)&&e.name==="AuthSessionMissingError"}class nc extends js{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class sc extends js{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class ac extends js{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function P4(e){return ge(e)&&e.name==="AuthImplicitGrantRedirectError"}class qx extends js{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class jh extends js{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function kf(e){return ge(e)&&e.name==="AuthRetryableFetchError"}class Vx extends js{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class kh extends js{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const ku="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Yx=` 	
\r=`.split(""),T4=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Yx.length;t+=1)e[Yx[t].charCodeAt(0)]=-2;for(let t=0;t<ku.length;t+=1)e[ku[t].charCodeAt(0)]=t;return e})();function Gx(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(ku[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(ku[n]),t.queuedBits-=6}}function $1(e,t,r){const n=T4[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Kx(e){const t=[],r=o=>{t.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},a=o=>{R4(o,n,r)};for(let o=0;o<e.length;o+=1)$1(e.charCodeAt(o),s,a);return t.join("")}function L4(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function I4(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}L4(n,t)}}function R4(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function M4(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)$1(e.charCodeAt(s),r,n);return new Uint8Array(t)}function O4(e){const t=[];return I4(e,r=>t.push(r)),new Uint8Array(t)}function A4(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};return e.forEach(s=>Gx(s,r,n)),Gx(null,r,n),t.join("")}function $4(e){return Math.round(Date.now()/1e3)+e}function F4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const Tr=()=>typeof window<"u"&&typeof document<"u",Ds={tested:!1,writable:!1},F1=()=>{if(!Tr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ds.tested)return Ds.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Ds.tested=!0,Ds.writable=!0}catch{Ds.tested=!0,Ds.writable=!1}return Ds.writable};function B4(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,a)=>{t[a]=s})}catch{}return r.searchParams.forEach((n,s)=>{t[s]=n}),t}const B1=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>wi(()=>Promise.resolve().then(()=>Si),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},U4=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Sa=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Ps=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Hn=async(e,t)=>{await e.removeItem(t)};class yd{constructor(){this.promise=new yd.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}yd.promiseConstructor=Promise;function Nf(e){const t=e.split(".");if(t.length!==3)throw new kh("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!N4.test(t[n]))throw new kh("JWT not in base64url format");return{header:JSON.parse(Kx(t[0])),payload:JSON.parse(Kx(t[1])),signature:M4(t[2]),raw:{header:t[0],payload:t[1]}}}async function z4(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function W4(e,t){return new Promise((n,s)=>{(async()=>{for(let a=0;a<1/0;a++)try{const o=await e(a);if(!t(a,null,o)){n(o);return}}catch(o){if(!t(a,o)){s(o);return}}})()})}function H4(e){return("0"+e.toString(16)).substr(-2)}function q4(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let a=0;a<56;a++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(t),Array.from(t,H4).join("")}async function V4(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(a=>String.fromCharCode(a)).join("")}async function Y4(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await V4(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ba(e,t,r=!1){const n=q4();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await Sa(e,`${t}-code-verifier`,s);const a=await Y4(n);return[a,n===a?"plain":"s256"]}const G4=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function K4(e){const t=e.headers.get(_h);if(!t||!t.match(G4))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function Q4(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function J4(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const X4=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function va(e){if(!X4.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Sf(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Qx(e){return JSON.parse(JSON.stringify(e))}var Z4=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};const Os=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),eP=[502,503,504];async function Jx(e){var t;if(!U4(e))throw new jh(Os(e),0);if(eP.includes(e.status))throw new jh(Os(e),e.status);let r;try{r=await e.json()}catch(a){throw new A1(Os(a),a)}let n;const s=K4(e);if(s&&s.getTime()>=O1["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Vx(Os(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Yn}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((a,o)=>a&&typeof o=="string",!0))throw new Vx(Os(r),e.status,r.weak_password.reasons);throw new C4(Os(r),e.status||500,n)}const tP=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function we(e,t,r,n){var s;const a=Object.assign({},n==null?void 0:n.headers);a[_h]||(a[_h]=O1["2024-01-01"].name),n!=null&&n.jwt&&(a.Authorization=`Bearer ${n.jwt}`);const o=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await rP(e,t,r+l,{headers:a,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function rP(e,t,r,n,s,a){const o=tP(t,n,s,a);let l;try{l=await e(r,Object.assign({},o))}catch(c){throw console.error(c),new jh(Os(c),0)}if(l.ok||await Jx(l),n!=null&&n.noResolveJson)return l;try{return await l.json()}catch(c){await Jx(c)}}function vn(e){var t;let r=null;iP(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=$4(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function Xx(e){const t=vn(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function es(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function nP(e){return{data:e,error:null}}function sP(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:a}=e,o=Z4(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:a},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function aP(e){return e}function iP(e){return e.access_token&&e.refresh_token&&e.expires_in}const Cf=["global","local","others"];var oP=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};class lP{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=B1(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=Cf[0]){if(Cf.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Cf.join(", ")}`);try{return await we(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(ge(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await we(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:es})}catch(n){if(ge(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=oP(t,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await we(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:sP,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(ge(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await we(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:es})}catch(r){if(ge(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,s,a,o,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await we(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(a=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:aP});if(d.error)throw d.error;const f=await d.json(),m=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,h=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return h.length>0&&(h.forEach(y=>{const v=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),w=JSON.parse(y.split(";")[1].split("=")[1]);u[`${w}Page`]=v}),u.total=parseInt(m)),{data:Object.assign(Object.assign({},f),u),error:null}}catch(u){if(ge(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){va(t);try{return await we(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:es})}catch(r){if(ge(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){va(t);try{return await we(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:es})}catch(n){if(ge(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){va(t);try{return await we(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:es})}catch(n){if(ge(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){va(t.userId);try{const{data:r,error:n}=await we(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(ge(r))return{data:null,error:r};throw r}}async _deleteFactor(t){va(t.userId),va(t.id);try{return{data:await we(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(ge(r))return{data:null,error:r};throw r}}}function Zx(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function cP(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const wa={debug:!!(globalThis&&F1()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class U1 extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class uP extends U1{}async function dP(e,t,r){wa.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),wa.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){wa.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{wa.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw wa.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new uP(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(wa.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}cP();const fP={url:_4,storageKey:j4,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:k4,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function ey(e,t,r){return await r()}const _a={};class rl{constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=rl.nextInstanceID,rl.nextInstanceID+=1,this.instanceID>0&&Tr()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},fP),t);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new lP({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=B1(s.fetch),this.lock=s.lock||ey,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:Tr()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=dP:this.lock=ey,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:F1()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Zx(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=Zx(this.memoryStorage)),Tr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}get jwks(){var t,r;return(r=(t=_a[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){_a[this.storageKey]=Object.assign(Object.assign({},_a[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=_a[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){_a[this.storageKey]=Object.assign(Object.assign({},_a[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${M1}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=B4(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),Tr()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:a}=await this._getSessionFromURL(r,n);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),P4(a)){const c=(t=a.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:o,redirectType:l}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return ge(r)?{error:r}:{error:new A1("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,s;try{const a=await we(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.captchaToken}},xform:vn}),{data:o,error:l}=a;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(a){if(ge(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(t){var r,n,s;try{let a;if("email"in t){const{email:d,password:f,options:m}=t;let h=null,y=null;this.flowType==="pkce"&&([h,y]=await ba(this.storage,this.storageKey)),a=await we(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:m==null?void 0:m.emailRedirectTo,body:{email:d,password:f,data:(r=m==null?void 0:m.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken},code_challenge:h,code_challenge_method:y},xform:vn})}else if("phone"in t){const{phone:d,password:f,options:m}=t;a=await we(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:f,data:(n=m==null?void 0:m.data)!==null&&n!==void 0?n:{},channel:(s=m==null?void 0:m.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken}},xform:vn})}else throw new sc("You must provide either an email or phone number and a password");const{data:o,error:l}=a;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(a){if(ge(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(t){try{let r;if("email"in t){const{email:a,password:o,options:l}=t;r=await we(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Xx})}else if("phone"in t){const{phone:a,password:o,options:l}=t;r=await we(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Xx})}else throw new sc("You must provide either an email or phone number and a password");const{data:n,error:s}=r;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new nc}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(ge(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,s,a;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(a=t.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,s,a,o,l,c,u,d,f,m,h;let y,v;if("message"in t)y=t.message,v=t.signature;else{const{chain:w,wallet:g,statement:b,options:p}=t;let _;if(Tr())if(typeof g=="object")_=g;else{const k=window;if("solana"in k&&typeof k.solana=="object"&&("signIn"in k.solana&&typeof k.solana.signIn=="function"||"signMessage"in k.solana&&typeof k.solana.signMessage=="function"))_=k.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(p!=null&&p.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=g}const j=new URL((r=p==null?void 0:p.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in _&&_.signIn){const k=await _.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},p==null?void 0:p.signInWithSolana),{version:"1",domain:j.host,uri:j.href}),b?{statement:b}:null));let N;if(Array.isArray(k)&&k[0]&&typeof k[0]=="object")N=k[0];else if(k&&typeof k=="object"&&"signedMessage"in k&&"signature"in k)N=k;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in N&&"signature"in N&&(typeof N.signedMessage=="string"||N.signedMessage instanceof Uint8Array)&&N.signature instanceof Uint8Array)y=typeof N.signedMessage=="string"?N.signedMessage:new TextDecoder().decode(N.signedMessage),v=N.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in _)||typeof _.signMessage!="function"||!("publicKey"in _)||typeof _!="object"||!_.publicKey||!("toBase58"in _.publicKey)||typeof _.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");y=[`${j.host} wants you to sign in with your Solana account:`,_.publicKey.toBase58(),...b?["",b,""]:[""],"Version: 1",`URI: ${j.href}`,`Issued At: ${(s=(n=p==null?void 0:p.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((a=p==null?void 0:p.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${p.signInWithSolana.notBefore}`]:[],...!((o=p==null?void 0:p.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${p.signInWithSolana.expirationTime}`]:[],...!((l=p==null?void 0:p.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${p.signInWithSolana.chainId}`]:[],...!((c=p==null?void 0:p.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${p.signInWithSolana.nonce}`]:[],...!((u=p==null?void 0:p.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${p.signInWithSolana.requestId}`]:[],...!((f=(d=p==null?void 0:p.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||f===void 0)&&f.length?["Resources",...p.signInWithSolana.resources.map(N=>`- ${N}`)]:[]].join(`
`);const k=await _.signMessage(new TextEncoder().encode(y),"utf8");if(!k||!(k instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");v=k}}try{const{data:w,error:g}=await we(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:y,signature:A4(v)},!((m=t.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:vn});if(g)throw g;return!w||!w.session||!w.user?{data:{user:null,session:null},error:new nc}:(w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),{data:Object.assign({},w),error:g})}catch(w){if(ge(w))return{data:{user:null,session:null},error:w};throw w}}async _exchangeCodeForSession(t){const r=await Ps(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:a,error:o}=await we(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:vn});if(await Hn(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new nc}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:s??null}),error:o})}catch(a){if(ge(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(t){try{const{options:r,provider:n,token:s,access_token:a,nonce:o}=t,l=await we(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:a,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:vn}),{data:c,error:u}=l;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new nc}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(r){if(ge(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,s,a,o;try{if("email"in t){const{email:l,options:c}=t;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await ba(this.storage,this.storageKey));const{error:f}=await we(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in t){const{phone:l,options:c}=t,{data:u,error:d}=await we(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d}}throw new sc("You must provide either an email or phone number.")}catch(l){if(ge(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(t){var r,n;try{let s,a;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,a=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:l}=await we(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:a}}),redirectTo:s,xform:vn});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,u=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(s){if(ge(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(t){var r,n,s;try{let a=null,o=null;return this.flowType==="pkce"&&([a,o]=await ba(this.storage,this.storageKey)),await we(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=t==null?void 0:t.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:o}),headers:this.headers,xform:nP})}catch(a){if(ge(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Yn;const{error:s}=await we(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}})}catch(t){if(ge(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:s,options:a}=t,{error:o}=await we(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in t){const{phone:n,type:s,options:a}=t,{data:o,error:l}=await we(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new sc("You must provide either an email or phone number and a type")}catch(r){if(ge(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Ps(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<jf:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const o=await Ps(this.userStorage,this.storageKey+"-user");o!=null&&o.user?t.user=o.user:t.user=Sf()}if(this.storage.isServer&&t.user){let o=this.suppressGetSessionWarning;t=new Proxy(t,{get:(c,u,d)=>(!o&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,u,d))})}return{data:{session:t},error:null}}const{session:s,error:a}=await this._callRefreshToken(t.refresh_token);return a?{data:{session:null},error:a}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await we(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:es}):await this._useSession(async r=>{var n,s,a;const{data:o,error:l}=r;if(l)throw l;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Yn}:await we(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0,xform:es})})}catch(r){if(ge(r))return D4(r)&&(await this._removeSession(),await Hn(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:s,error:a}=n;if(a)throw a;if(!s.session)throw new Yn;const o=s.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await ba(this.storage,this.storageKey));const{data:u,error:d}=await we(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:es});if(d)throw d;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(n){if(ge(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Yn;const r=Date.now()/1e3;let n=r,s=!0,a=null;const{payload:o}=Nf(t.access_token);if(o.exp&&(n=o.exp,s=n<=r),s){const{session:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};a=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;a={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(r){if(ge(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:o,error:l}=r;if(l)throw l;t=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Yn;const{session:s,error:a}=await this._callRefreshToken(t.refresh_token);return a?{data:{user:null,session:null},error:a}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(ge(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!Tr())throw new ac("No browser detected.");if(t.error||t.error_description||t.error_code)throw new ac(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new qx("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ac("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new qx("No code detected.");const{data:b,error:p}=await this._exchangeCodeForSession(t.code);if(p)throw p;const _=new URL(window.location.href);return _.searchParams.delete("code"),window.history.replaceState(window.history.state,"",_.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:a,refresh_token:o,expires_in:l,expires_at:c,token_type:u}=t;if(!a||!l||!o||!u)throw new ac("No session defined in URL");const d=Math.round(Date.now()/1e3),f=parseInt(l);let m=d+f;c&&(m=parseInt(c));const h=m-d;h*1e3<=Na&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${f}s`);const y=m-f;d-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,m,d):d-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,m,d);const{data:v,error:w}=await this._getUser(a);if(w)throw w;const g={provider_token:n,provider_refresh_token:s,access_token:a,expires_in:f,expires_at:m,refresh_token:o,token_type:u,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:t.type},error:null}}catch(n){if(ge(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Ps(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:a}=r;if(a)return{error:a};const o=(n=s.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:l}=await this.admin.signOut(o,t);if(l&&!(E4(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return t!=="others"&&(await this._removeSession(),await Hn(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=F4(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,s;try{const{data:{session:a},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",t,"session",a)}catch(a){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",a),console.error(a)}})}async resetPasswordForEmail(t,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await ba(this.storage,this.storageKey,!0));try{return await we(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(a){if(ge(a))return{data:null,error:a};throw a}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(ge(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:s}=await this._useSession(async a=>{var o,l,c,u,d;const{data:f,error:m}=a;if(m)throw m;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await we(this.fetch,"GET",h,{headers:this.headers,jwt:(d=(u=f.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(s)throw s;return Tr()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(ge(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,s;const{data:a,error:o}=r;if(o)throw o;return await we(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(ge(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await W4(async s=>(s>0&&await z4(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await we(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:vn})),(s,a)=>{const o=200*Math.pow(2,s);return a&&kf(a)&&Date.now()+o-n<Na})}catch(n){if(this._debug(r,"error",n),ge(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),Tr()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await Ps(this.storage,this.storageKey);if(s&&this.userStorage){let o=await Ps(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await Sa(this.userStorage,this.storageKey+"-user",o)),s.user=(t=o==null?void 0:o.user)!==null&&t!==void 0?t:Sf()}else if(s&&!s.user&&!s.user){const o=await Ps(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(s.user=o.user,await Hn(this.storage,this.storageKey+"-user"),await Sa(this.storage,this.storageKey,s)):s.user=Sf()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const a=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<jf;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${jf}s`),a){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),kf(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(s.access_token);!l&&(o!=null&&o.user)?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Yn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new yd;const{data:a,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!a.session)throw new Yn;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const l={session:a.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(a){if(this._debug(s,"error",a),ge(a)){const o={session:null,error:a};return kf(a)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(a),a}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,n=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const a=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,r)}catch(c){a.push(c)}});if(await Promise.all(o),a.length>0){for(let l=0;l<a.length;l+=1)console.error(a[l]);throw a[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Sa(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const a=Qx(s);await Sa(this.storage,this.storageKey,a)}else{const s=Qx(r);await Sa(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await Hn(this.storage,this.storageKey),await Hn(this.storage,this.storageKey+"-code-verifier"),await Hn(this.storage,this.storageKey+"-user"),this.userStorage&&await Hn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Tr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Na);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-t)/Na);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Na}ms, refresh threshold is ${wh} ticks`),s<=wh&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof U1)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Tr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[a,o]=await ba(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(l.toString())}if(n!=null&&n.queryParams){const a=new URLSearchParams(n.queryParams);s.push(a.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;return a?{data:null,error:a}:await we(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(ge(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,s;const{data:a,error:o}=r;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:c,error:u}=await we(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(t.factorType==="totp"&&(!((s=c==null?void 0:c.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(r){if(ge(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;if(a)return{data:null,error:a};const{data:o,error:l}=await we(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(r){if(ge(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;return a?{data:null,error:a}:await we(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(ge(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],s=n.filter(o=>o.factor_type==="totp"&&o.status==="verified"),a=n.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:n,totp:s,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:s},error:a}=t;if(a)return{data:null,error:a};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Nf(s.access_token);let l=null;o.aal&&(l=o.aal);let c=l;((n=(r=s.user.factors)===null||r===void 0?void 0:r.filter(f=>f.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(c="aal2");const d=o.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(l=>l.kid===t);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(l=>l.kid===t),n&&this.jwks_cached_at+S4>s)return n;const{data:a,error:o}=await we(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=s,n=a.keys.find(l=>l.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:h,error:y}=await this.getSession();if(y||!h.session)return{data:null,error:y};n=h.session.access_token}const{header:s,payload:a,signature:o,raw:{header:l,payload:c}}=Nf(n);r!=null&&r.allowExpired||Q4(a.exp);const u=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:h}=await this.getUser(n);if(h)throw h;return{data:{claims:a,header:s,signature:o},error:null}}const d=J4(s.alg),f=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,f,o,O4(`${l}.${c}`)))throw new kh("Invalid JWT signature");return{data:{claims:a,header:s,signature:o},error:null}}catch(n){if(ge(n))return{data:null,error:n};throw n}}}rl.nextInstanceID=0;const mP=rl;class hP extends mP{constructor(t){super(t)}}var pP=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(d){try{u(n.next(d))}catch(f){o(f)}}function c(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?a(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};class gP{constructor(t,r,n){var s,a,o;this.supabaseUrl=t,this.supabaseKey=r;const l=w4(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:d4,realtime:m4,auth:Object.assign(Object.assign({},f4),{storageKey:c}),global:u4},d=v4(n??{},u);this.storageKey=(s=d.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(a=d.global.headers)!==null&&a!==void 0?a:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(f,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=d.auth)!==null&&o!==void 0?o:{},this.headers,d.global.fetch),this.fetch=x4(r,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new TD(new URL("rest/v1",l).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new o4(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new cD(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return pP(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:a,storageKey:o,flowType:l,lock:c,debug:u},d,f){const m={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new hP({url:this.authUrl.href,headers:Object.assign(Object.assign({},m),d),storageKey:o,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:a,flowType:l,lock:c,debug:u,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(h=>h.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new GD(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const xP=(e,t,r)=>new gP(e,t,r);function yP(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}yP()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const bP="https://rqbvcvwbziilnycqtmnc.supabase.co",vP="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJxYnZjdndiemlpbG55Y3F0bW5jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAyMzk5ODIsImV4cCI6MjA2NTgxNTk4Mn0.819LDXCnlu2dgCPw91oMbZIojeFom-UxqJn2hA5yjBM",$=xP(bP,vP),z1=x.createContext(void 0);function lg(){const e=x.useContext(z1);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e}function wP({children:e}){const[t,r]=x.useState(null),[n,s]=x.useState(null),[a,o]=x.useState(!0);x.useEffect(()=>{$.auth.getSession().then(({data:{session:m}})=>{s(m),r((m==null?void 0:m.user)??null),o(!1)});const{data:{subscription:f}}=$.auth.onAuthStateChange(async(m,h)=>{s(h),r((h==null?void 0:h.user)??null),o(!1)});return()=>f.unsubscribe()},[]);const d={user:t,session:n,loading:a,signIn:async(f,m)=>await $.auth.signInWithPassword({email:f,password:m}),signUp:async(f,m)=>await $.auth.signUp({email:f,password:m}),signOut:async()=>{await $.auth.signOut()}};return i.jsx(z1.Provider,{value:d,children:e})}function _P({children:e}){return i.jsx(i.Fragment,{children:e})}function Mt(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var jP=(()=>typeof Symbol=="function"&&Symbol.observable||"@@observable")(),ty=jP,Ef=()=>Math.random().toString(36).substring(7).split("").join("."),kP={INIT:`@@redux/INIT${Ef()}`,REPLACE:`@@redux/REPLACE${Ef()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Ef()}`},ry=kP;function NP(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function W1(e,t,r){if(typeof e!="function")throw new Error(Mt(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Mt(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Mt(1));return r(W1)(e,t)}let n=e,s=t,a=new Map,o=a,l=0,c=!1;function u(){o===a&&(o=new Map,a.forEach((w,g)=>{o.set(g,w)}))}function d(){if(c)throw new Error(Mt(3));return s}function f(w){if(typeof w!="function")throw new Error(Mt(4));if(c)throw new Error(Mt(5));let g=!0;u();const b=l++;return o.set(b,w),function(){if(g){if(c)throw new Error(Mt(6));g=!1,u(),o.delete(b),a=null}}}function m(w){if(!NP(w))throw new Error(Mt(7));if(typeof w.type>"u")throw new Error(Mt(8));if(typeof w.type!="string")throw new Error(Mt(17));if(c)throw new Error(Mt(9));try{c=!0,s=n(s,w)}finally{c=!1}return(a=o).forEach(b=>{b()}),w}function h(w){if(typeof w!="function")throw new Error(Mt(10));n=w,m({type:ry.REPLACE})}function y(){const w=f;return{subscribe(g){if(typeof g!="object"||g===null)throw new Error(Mt(11));function b(){const _=g;_.next&&_.next(d())}return b(),{unsubscribe:w(b)}},[ty](){return this}}}return m({type:ry.INIT}),{dispatch:m,subscribe:f,getState:d,replaceReducer:h,[ty]:y}}function ny(e,t){return function(...r){return t(e.apply(this,r))}}function sy(e,t){if(typeof e=="function")return ny(e,t);if(typeof e!="object"||e===null)throw new Error(Mt(16));const r={};for(const n in e){const s=e[n];typeof s=="function"&&(r[n]=ny(s,t))}return r}function H1(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function SP(...e){return t=>(r,n)=>{const s=t(r,n);let a=()=>{throw new Error(Mt(15))};const o={getState:s.getState,dispatch:(c,...u)=>a(c,...u)},l=e.map(c=>c(o));return a=H1(...l)(s.dispatch),{...s,dispatch:a}}}var CP={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sl=x;function EP(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var DP=typeof Object.is=="function"?Object.is:EP,PP=Sl.useSyncExternalStore,TP=Sl.useRef,LP=Sl.useEffect,IP=Sl.useMemo,RP=Sl.useDebugValue;CP.useSyncExternalStoreWithSelector=function(e,t,r,n,s){var a=TP(null);if(a.current===null){var o={hasValue:!1,value:null};a.current=o}else o=a.current;a=IP(function(){function c(h){if(!u){if(u=!0,d=h,h=n(h),s!==void 0&&o.hasValue){var y=o.value;if(s(y,h))return f=y}return f=h}if(y=f,DP(d,h))return y;var v=n(h);return s!==void 0&&s(y,v)?(d=h,y):(d=h,f=v)}var u=!1,d,f,m=r===void 0?null:r;return[function(){return c(t())},m===null?void 0:function(){return c(m())}]},[t,r,n,s]);var l=PP(e,a[0],a[1]);return LP(function(){o.hasValue=!0,o.value=l},[l]),RP(l),l};var MP=x.version.startsWith("19"),OP=Symbol.for(MP?"react.transitional.element":"react.element"),AP=Symbol.for("react.portal"),$P=Symbol.for("react.fragment"),FP=Symbol.for("react.strict_mode"),BP=Symbol.for("react.profiler"),UP=Symbol.for("react.consumer"),zP=Symbol.for("react.context"),q1=Symbol.for("react.forward_ref"),WP=Symbol.for("react.suspense"),HP=Symbol.for("react.suspense_list"),cg=Symbol.for("react.memo"),qP=Symbol.for("react.lazy"),VP=q1,YP=cg;function GP(e){if(typeof e=="object"&&e!==null){const{$$typeof:t}=e;switch(t){case OP:switch(e=e.type,e){case $P:case BP:case FP:case WP:case HP:return e;default:switch(e=e&&e.$$typeof,e){case zP:case q1:case qP:case cg:return e;case UP:return e;default:return t}}case AP:return t}}}function KP(e){return GP(e)===cg}function QP(e,t,r,n,{areStatesEqual:s,areOwnPropsEqual:a,areStatePropsEqual:o}){let l=!1,c,u,d,f,m;function h(b,p){return c=b,u=p,d=e(c,u),f=t(n,u),m=r(d,f,u),l=!0,m}function y(){return d=e(c,u),t.dependsOnOwnProps&&(f=t(n,u)),m=r(d,f,u),m}function v(){return e.dependsOnOwnProps&&(d=e(c,u)),t.dependsOnOwnProps&&(f=t(n,u)),m=r(d,f,u),m}function w(){const b=e(c,u),p=!o(b,d);return d=b,p&&(m=r(d,f,u)),m}function g(b,p){const _=!a(p,u),j=!s(b,c,p,u);return c=b,u=p,_&&j?y():_?v():j?w():m}return function(p,_){return l?g(p,_):h(p,_)}}function JP(e,{initMapStateToProps:t,initMapDispatchToProps:r,initMergeProps:n,...s}){const a=t(e,s),o=r(e,s),l=n(e,s);return QP(a,o,l,e,s)}function XP(e,t){const r={};for(const n in e){const s=e[n];typeof s=="function"&&(r[n]=(...a)=>t(s(...a)))}return r}function Nh(e){return function(r){const n=e(r);function s(){return n}return s.dependsOnOwnProps=!1,s}}function ay(e){return e.dependsOnOwnProps?!!e.dependsOnOwnProps:e.length!==1}function V1(e,t){return function(n,{displayName:s}){const a=function(l,c){return a.dependsOnOwnProps?a.mapToProps(l,c):a.mapToProps(l,void 0)};return a.dependsOnOwnProps=!0,a.mapToProps=function(l,c){a.mapToProps=e,a.dependsOnOwnProps=ay(e);let u=a(l,c);return typeof u=="function"&&(a.mapToProps=u,a.dependsOnOwnProps=ay(u),u=a(l,c)),u},a}}function ug(e,t){return(r,n)=>{throw new Error(`Invalid value of type ${typeof e} for ${t} argument when connecting component ${n.wrappedComponentName}.`)}}function ZP(e){return e&&typeof e=="object"?Nh(t=>XP(e,t)):e?typeof e=="function"?V1(e):ug(e,"mapDispatchToProps"):Nh(t=>({dispatch:t}))}function e5(e){return e?typeof e=="function"?V1(e):ug(e,"mapStateToProps"):Nh(()=>({}))}function t5(e,t,r){return{...r,...e,...t}}function r5(e){return function(r,{displayName:n,areMergedPropsEqual:s}){let a=!1,o;return function(c,u,d){const f=e(c,u,d);return a?s(f,o)||(o=f):(a=!0,o=f),o}}}function n5(e){return e?typeof e=="function"?r5(e):ug(e,"mergeProps"):()=>t5}function s5(e){e()}function a5(){let e=null,t=null;return{clear(){e=null,t=null},notify(){s5(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const s=t={callback:r,next:null,prev:t};return s.prev?s.prev.next=s:e=s,function(){!n||e===null||(n=!1,s.next?s.next.prev=s.prev:t=s.prev,s.prev?s.prev.next=s.next:e=s.next)}}}}var iy={notify(){},get:()=>[]};function Y1(e,t){let r,n=iy,s=0,a=!1;function o(v){d();const w=n.subscribe(v);let g=!1;return()=>{g||(g=!0,w(),f())}}function l(){n.notify()}function c(){y.onStateChange&&y.onStateChange()}function u(){return a}function d(){s++,r||(r=t?t.addNestedSub(c):e.subscribe(c),n=a5())}function f(){s--,r&&s===0&&(r(),r=void 0,n.clear(),n=iy)}function m(){a||(a=!0,d())}function h(){a&&(a=!1,f())}const y={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:u,trySubscribe:m,tryUnsubscribe:h,getListeners:()=>n};return y}var i5=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",o5=i5(),l5=()=>typeof navigator<"u"&&navigator.product==="ReactNative",c5=l5(),u5=()=>o5||c5?x.useLayoutEffect:x.useEffect,Nu=u5();function oy(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function Df(e,t){if(oy(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(!Object.prototype.hasOwnProperty.call(t,r[s])||!oy(e[r[s]],t[r[s]]))return!1;return!0}var d5={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},f5={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},m5={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},G1={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},h5={[VP]:m5,[YP]:G1};function ly(e){return KP(e)?G1:h5[e.$$typeof]||d5}var p5=Object.defineProperty,g5=Object.getOwnPropertyNames,cy=Object.getOwnPropertySymbols,x5=Object.getOwnPropertyDescriptor,y5=Object.getPrototypeOf,uy=Object.prototype;function Sh(e,t){if(typeof t!="string"){if(uy){const a=y5(t);a&&a!==uy&&Sh(e,a)}let r=g5(t);cy&&(r=r.concat(cy(t)));const n=ly(e),s=ly(t);for(let a=0;a<r.length;++a){const o=r[a];if(!f5[o]&&!(s&&s[o])&&!(n&&n[o])){const l=x5(t,o);try{p5(e,o,l)}catch{}}}}return e}var Pf=Symbol.for("react-redux-context"),Tf=typeof globalThis<"u"?globalThis:{};function b5(){if(!x.createContext)return{};const e=Tf[Pf]??(Tf[Pf]=new Map);let t=e.get(x.createContext);return t||(t=x.createContext(null),e.set(x.createContext,t)),t}var K1=b5(),v5=[null,null];function w5(e,t,r){Nu(()=>e(...t),r)}function _5(e,t,r,n,s,a){e.current=n,r.current=!1,s.current&&(s.current=null,a())}function j5(e,t,r,n,s,a,o,l,c,u,d){if(!e)return()=>{};let f=!1,m=null;const h=()=>{if(f||!l.current)return;const v=t.getState();let w,g;try{w=n(v,s.current)}catch(b){g=b,m=b}g||(m=null),w===a.current?o.current||u():(a.current=w,c.current=w,o.current=!0,d())};return r.onStateChange=h,r.trySubscribe(),h(),()=>{if(f=!0,r.tryUnsubscribe(),r.onStateChange=null,m)throw m}}function k5(e,t){return e===t}function N5(e,t,r,{pure:n,areStatesEqual:s=k5,areOwnPropsEqual:a=Df,areStatePropsEqual:o=Df,areMergedPropsEqual:l=Df,forwardRef:c=!1,context:u=K1}={}){const d=u,f=e5(e),m=ZP(t),h=n5(r),y=!!e;return w=>{const g=w.displayName||w.name||"Component",b=`Connect(${g})`,p={shouldHandleStateChanges:y,displayName:b,wrappedComponentName:g,WrappedComponent:w,initMapStateToProps:f,initMapDispatchToProps:m,initMergeProps:h,areStatesEqual:s,areStatePropsEqual:o,areOwnPropsEqual:a,areMergedPropsEqual:l};function _(N){const[S,C,E]=x.useMemo(()=>{const{reactReduxForwardedRef:De,...Se}=N;return[N.context,De,Se]},[N]),T=x.useMemo(()=>{let De=d;return S!=null&&S.Consumer,De},[S,d]),L=x.useContext(T),O=!!N.store&&!!N.store.getState&&!!N.store.dispatch,A=!!L&&!!L.store,M=O?N.store:L.store,B=A?L.getServerState:M.getState,F=x.useMemo(()=>JP(M.dispatch,p),[M]),[R,P]=x.useMemo(()=>{if(!y)return v5;const De=Y1(M,O?void 0:L.subscription),Se=De.notifyNestedSubs.bind(De);return[De,Se]},[M,O,L]),D=x.useMemo(()=>O?L:{...L,subscription:R},[O,L,R]),z=x.useRef(void 0),W=x.useRef(E),I=x.useRef(void 0),ne=x.useRef(!1),re=x.useRef(!1),Q=x.useRef(void 0);Nu(()=>(re.current=!0,()=>{re.current=!1}),[]);const U=x.useMemo(()=>()=>I.current&&E===W.current?I.current:F(M.getState(),E),[M,E]),J=x.useMemo(()=>Se=>R?j5(y,M,R,F,W,z,ne,re,I,P,Se):()=>{},[R]);w5(_5,[W,z,ne,E,I,P]);let X;try{X=x.useSyncExternalStore(J,U,B?()=>F(B(),E):U)}catch(De){throw Q.current&&(De.message+=`
The error may be correlated with this previous error:
${Q.current.stack}

`),De}Nu(()=>{Q.current=void 0,I.current=void 0,z.current=X});const ue=x.useMemo(()=>x.createElement(w,{...X,ref:C}),[C,w,X]);return x.useMemo(()=>y?x.createElement(T.Provider,{value:D},ue):ue,[T,ue,D])}const k=x.memo(_);if(k.WrappedComponent=w,k.displayName=_.displayName=b,c){const S=x.forwardRef(function(E,T){return x.createElement(k,{...E,reactReduxForwardedRef:T})});return S.displayName=b,S.WrappedComponent=w,Sh(S,w)}return Sh(k,w)}}var Q1=N5;function S5(e){const{children:t,context:r,serverState:n,store:s}=e,a=x.useMemo(()=>{const c=Y1(s);return{store:s,subscription:c,getServerState:n?()=>n:void 0}},[s,n]),o=x.useMemo(()=>s.getState(),[s]);Nu(()=>{const{subscription:c}=a;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==s.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[a,o]);const l=r||K1;return x.createElement(l.Provider,{value:a},t)}var C5=S5,E5=!0,Lf="Invariant failed";function D5(e,t){if(!e){if(E5)throw new Error(Lf);var r=typeof t=="function"?t():t,n=r?"".concat(Lf,": ").concat(r):Lf;throw new Error(n)}}var Or=function(t){var r=t.top,n=t.right,s=t.bottom,a=t.left,o=n-a,l=s-r,c={top:r,right:n,bottom:s,left:a,width:o,height:l,x:a,y:r,center:{x:(n+a)/2,y:(s+r)/2}};return c},dg=function(t,r){return{top:t.top-r.top,left:t.left-r.left,bottom:t.bottom+r.bottom,right:t.right+r.right}},dy=function(t,r){return{top:t.top+r.top,left:t.left+r.left,bottom:t.bottom-r.bottom,right:t.right-r.right}},P5=function(t,r){return{top:t.top+r.y,left:t.left+r.x,bottom:t.bottom+r.y,right:t.right+r.x}},If={top:0,right:0,bottom:0,left:0},fg=function(t){var r=t.borderBox,n=t.margin,s=n===void 0?If:n,a=t.border,o=a===void 0?If:a,l=t.padding,c=l===void 0?If:l,u=Or(dg(r,s)),d=Or(dy(r,o)),f=Or(dy(d,c));return{marginBox:u,borderBox:Or(r),paddingBox:d,contentBox:f,margin:s,border:o,padding:c}},mr=function(t){var r=t.slice(0,-2),n=t.slice(-2);if(n!=="px")return 0;var s=Number(r);return isNaN(s)&&D5(!1),s},T5=function(){return{x:window.pageXOffset,y:window.pageYOffset}},Su=function(t,r){var n=t.borderBox,s=t.border,a=t.margin,o=t.padding,l=P5(n,r);return fg({borderBox:l,border:s,margin:a,padding:o})},Cu=function(t,r){return r===void 0&&(r=T5()),Su(t,r)},J1=function(t,r){var n={top:mr(r.marginTop),right:mr(r.marginRight),bottom:mr(r.marginBottom),left:mr(r.marginLeft)},s={top:mr(r.paddingTop),right:mr(r.paddingRight),bottom:mr(r.paddingBottom),left:mr(r.paddingLeft)},a={top:mr(r.borderTopWidth),right:mr(r.borderRightWidth),bottom:mr(r.borderBottomWidth),left:mr(r.borderLeftWidth)};return fg({borderBox:t,margin:n,padding:s,border:a})},X1=function(t){var r=t.getBoundingClientRect(),n=window.getComputedStyle(t);return J1(r,n)},L5=function(t){var r=[],n=null,s=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];r=l,!n&&(n=requestAnimationFrame(function(){n=null,t.apply(void 0,r)}))};return s.cancel=function(){n&&(cancelAnimationFrame(n),n=null)},s};const nl=L5;function Eu(){return Eu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Eu.apply(null,arguments)}function Z1(e,t){}Z1.bind(null,"warn");Z1.bind(null,"error");function fs(){}function I5(e,t){return{...e,...t}}function wr(e,t,r){const n=t.map(s=>{const a=I5(r,s.options);return e.addEventListener(s.eventName,s.fn,a),function(){e.removeEventListener(s.eventName,s.fn,a)}});return function(){n.forEach(a=>{a()})}}const R5="Invariant failed";class Du extends Error{}Du.prototype.toString=function(){return this.message};function Z(e,t){throw new Du(R5)}class M5 extends H.Component{constructor(...t){super(...t),this.callbacks=null,this.unbind=fs,this.onWindowError=r=>{const n=this.getCallbacks();n.isDragging()&&n.tryAbort(),r.error instanceof Du&&r.preventDefault()},this.getCallbacks=()=>{if(!this.callbacks)throw new Error("Unable to find AppCallbacks in <ErrorBoundary/>");return this.callbacks},this.setCallbacks=r=>{this.callbacks=r}}componentDidMount(){this.unbind=wr(window,[{eventName:"error",fn:this.onWindowError}])}componentDidCatch(t){if(t instanceof Du){this.setState({});return}throw t}componentWillUnmount(){this.unbind()}render(){return this.props.children(this.setCallbacks)}}const O5=`
  Press space bar to start a drag.
  When dragging you can use the arrow keys to move the item around and escape to cancel.
  Some screen readers may require you to be in focus mode or to use your pass through key
`,Pu=e=>e+1,A5=e=>`
  You have lifted an item in position ${Pu(e.source.index)}
`,ej=(e,t)=>{const r=e.droppableId===t.droppableId,n=Pu(e.index),s=Pu(t.index);return r?`
      You have moved the item from position ${n}
      to position ${s}
    `:`
    You have moved the item from position ${n}
    in list ${e.droppableId}
    to list ${t.droppableId}
    in position ${s}
  `},tj=(e,t,r)=>t.droppableId===r.droppableId?`
      The item ${e}
      has been combined with ${r.draggableId}`:`
      The item ${e}
      in list ${t.droppableId}
      has been combined with ${r.draggableId}
      in list ${r.droppableId}
    `,$5=e=>{const t=e.destination;if(t)return ej(e.source,t);const r=e.combine;return r?tj(e.draggableId,e.source,r):"You are over an area that cannot be dropped on"},fy=e=>`
  The item has returned to its starting position
  of ${Pu(e.index)}
`,F5=e=>{if(e.reason==="CANCEL")return`
      Movement cancelled.
      ${fy(e.source)}
    `;const t=e.destination,r=e.combine;return t?`
      You have dropped the item.
      ${ej(e.source,t)}
    `:r?`
      You have dropped the item.
      ${tj(e.draggableId,e.source,r)}
    `:`
    The item has been dropped while not over a drop area.
    ${fy(e.source)}
  `},Uc={dragHandleUsageInstructions:O5,onDragStart:A5,onDragUpdate:$5,onDragEnd:F5};function B5(e,t){return!!(e===t||Number.isNaN(e)&&Number.isNaN(t))}function rj(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!B5(e[r],t[r]))return!1;return!0}function Ce(e,t){const r=x.useState(()=>({inputs:t,result:e()}))[0],n=x.useRef(!0),s=x.useRef(r),o=n.current||!!(t&&s.current.inputs&&rj(t,s.current.inputs))?s.current:{inputs:t,result:e()};return x.useEffect(()=>{n.current=!1,s.current=o},[o]),o.result}function ce(e,t){return Ce(()=>e,t)}const yt={x:0,y:0},vt=(e,t)=>({x:e.x+t.x,y:e.y+t.y}),nr=(e,t)=>({x:e.x-t.x,y:e.y-t.y}),ms=(e,t)=>e.x===t.x&&e.y===t.y,Ei=e=>({x:e.x!==0?-e.x:0,y:e.y!==0?-e.y:0}),oa=(e,t,r=0)=>e==="x"?{x:t,y:r}:{x:r,y:t},sl=(e,t)=>Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2),my=(e,t)=>Math.min(...t.map(r=>sl(e,r))),nj=e=>t=>({x:e(t.x),y:e(t.y)});var U5=(e,t)=>{const r=Or({top:Math.max(t.top,e.top),right:Math.min(t.right,e.right),bottom:Math.min(t.bottom,e.bottom),left:Math.max(t.left,e.left)});return r.width<=0||r.height<=0?null:r};const Cl=(e,t)=>({top:e.top+t.y,left:e.left+t.x,bottom:e.bottom+t.y,right:e.right+t.x}),hy=e=>[{x:e.left,y:e.top},{x:e.right,y:e.top},{x:e.left,y:e.bottom},{x:e.right,y:e.bottom}],z5={top:0,right:0,bottom:0,left:0},W5=(e,t)=>t?Cl(e,t.scroll.diff.displacement):e,H5=(e,t,r)=>r&&r.increasedBy?{...e,[t.end]:e[t.end]+r.increasedBy[t.line]}:e,q5=(e,t)=>t&&t.shouldClipSubject?U5(t.pageMarginBox,e):Or(e);var oi=({page:e,withPlaceholder:t,axis:r,frame:n})=>{const s=W5(e.marginBox,n),a=H5(s,r,t),o=q5(a,n);return{page:e,withPlaceholder:t,active:o}},mg=(e,t)=>{e.frame||Z();const r=e.frame,n=nr(t,r.scroll.initial),s=Ei(n),a={...r,scroll:{initial:r.scroll.initial,current:t,diff:{value:n,displacement:s},max:r.scroll.max}},o=oi({page:e.subject.page,withPlaceholder:e.subject.withPlaceholder,axis:e.axis,frame:a});return{...e,frame:a,subject:o}};function xt(e,t=rj){let r=null;function n(...s){if(r&&r.lastThis===this&&t(s,r.lastArgs))return r.lastResult;const a=e.apply(this,s);return r={lastResult:a,lastArgs:s,lastThis:this},a}return n.clear=function(){r=null},n}const sj=xt(e=>e.reduce((t,r)=>(t[r.descriptor.id]=r,t),{})),aj=xt(e=>e.reduce((t,r)=>(t[r.descriptor.id]=r,t),{})),bd=xt(e=>Object.values(e)),V5=xt(e=>Object.values(e));var Di=xt((e,t)=>V5(t).filter(n=>e===n.descriptor.droppableId).sort((n,s)=>n.descriptor.index-s.descriptor.index));function hg(e){return e.at&&e.at.type==="REORDER"?e.at.destination:null}function vd(e){return e.at&&e.at.type==="COMBINE"?e.at.combine:null}var wd=xt((e,t)=>t.filter(r=>r.descriptor.id!==e.descriptor.id)),Y5=({isMovingForward:e,draggable:t,destination:r,insideDestination:n,previousImpact:s})=>{if(!r.isCombineEnabled||!hg(s))return null;function o(h){const y={type:"COMBINE",combine:{draggableId:h,droppableId:r.descriptor.id}};return{...s,at:y}}const l=s.displaced.all,c=l.length?l[0]:null;if(e)return c?o(c):null;const u=wd(t,n);if(!c){if(!u.length)return null;const h=u[u.length-1];return o(h.descriptor.id)}const d=u.findIndex(h=>h.descriptor.id===c);d===-1&&Z();const f=d-1;if(f<0)return null;const m=u[f];return o(m.descriptor.id)},Pi=(e,t)=>e.descriptor.droppableId===t.descriptor.id;const ij={point:yt,value:0},al={invisible:{},visible:{},all:[]},G5={displaced:al,displacedBy:ij,at:null};var jr=(e,t)=>r=>e<=r&&r<=t,oj=e=>{const t=jr(e.top,e.bottom),r=jr(e.left,e.right);return n=>{if(t(n.top)&&t(n.bottom)&&r(n.left)&&r(n.right))return!0;const a=t(n.top)||t(n.bottom),o=r(n.left)||r(n.right);if(a&&o)return!0;const c=n.top<e.top&&n.bottom>e.bottom,u=n.left<e.left&&n.right>e.right;return c&&u?!0:c&&o||u&&a}},K5=e=>{const t=jr(e.top,e.bottom),r=jr(e.left,e.right);return n=>t(n.top)&&t(n.bottom)&&r(n.left)&&r(n.right)};const pg={direction:"vertical",line:"y",crossAxisLine:"x",start:"top",end:"bottom",size:"height",crossAxisStart:"left",crossAxisEnd:"right",crossAxisSize:"width"},lj={direction:"horizontal",line:"x",crossAxisLine:"y",start:"left",end:"right",size:"width",crossAxisStart:"top",crossAxisEnd:"bottom",crossAxisSize:"height"};var Q5=e=>t=>{const r=jr(t.top,t.bottom),n=jr(t.left,t.right);return s=>e===pg?r(s.top)&&r(s.bottom):n(s.left)&&n(s.right)};const J5=(e,t)=>{const r=t.frame?t.frame.scroll.diff.displacement:yt;return Cl(e,r)},X5=(e,t,r)=>t.subject.active?r(t.subject.active)(e):!1,Z5=(e,t,r)=>r(t)(e),gg=({target:e,destination:t,viewport:r,withDroppableDisplacement:n,isVisibleThroughFrameFn:s})=>{const a=n?J5(e,t):e;return X5(a,t,s)&&Z5(a,r,s)},eT=e=>gg({...e,isVisibleThroughFrameFn:oj}),cj=e=>gg({...e,isVisibleThroughFrameFn:K5}),tT=e=>gg({...e,isVisibleThroughFrameFn:Q5(e.destination.axis)}),rT=(e,t,r)=>{if(typeof r=="boolean")return r;if(!t)return!0;const{invisible:n,visible:s}=t;if(n[e])return!1;const a=s[e];return a?a.shouldAnimate:!0};function nT(e,t){const r=e.page.marginBox,n={top:t.point.y,right:0,bottom:0,left:t.point.x};return Or(dg(r,n))}function il({afterDragging:e,destination:t,displacedBy:r,viewport:n,forceShouldAnimate:s,last:a}){return e.reduce(function(l,c){const u=nT(c,r),d=c.descriptor.id;if(l.all.push(d),!eT({target:u,destination:t,viewport:n,withDroppableDisplacement:!0}))return l.invisible[c.descriptor.id]=!0,l;const m=rT(d,a,s),h={draggableId:d,shouldAnimate:m};return l.visible[d]=h,l},{all:[],visible:{},invisible:{}})}function sT(e,t){if(!e.length)return 0;const r=e[e.length-1].descriptor.index;return t.inHomeList?r:r+1}function py({insideDestination:e,inHomeList:t,displacedBy:r,destination:n}){const s=sT(e,{inHomeList:t});return{displaced:al,displacedBy:r,at:{type:"REORDER",destination:{droppableId:n.descriptor.id,index:s}}}}function Tu({draggable:e,insideDestination:t,destination:r,viewport:n,displacedBy:s,last:a,index:o,forceShouldAnimate:l}){const c=Pi(e,r);if(o==null)return py({insideDestination:t,inHomeList:c,displacedBy:s,destination:r});const u=t.find(y=>y.descriptor.index===o);if(!u)return py({insideDestination:t,inHomeList:c,displacedBy:s,destination:r});const d=wd(e,t),f=t.indexOf(u),m=d.slice(f);return{displaced:il({afterDragging:m,destination:r,displacedBy:s,last:a,viewport:n.frame,forceShouldAnimate:l}),displacedBy:s,at:{type:"REORDER",destination:{droppableId:r.descriptor.id,index:o}}}}function ys(e,t){return!!t.effected[e]}var aT=({isMovingForward:e,destination:t,draggables:r,combine:n,afterCritical:s})=>{if(!t.isCombineEnabled)return null;const a=n.draggableId,l=r[a].descriptor.index;return ys(a,s)?e?l:l-1:e?l+1:l},iT=({isMovingForward:e,isInHomeList:t,insideDestination:r,location:n})=>{if(!r.length)return null;const s=n.index,a=e?s+1:s-1,o=r[0].descriptor.index,l=r[r.length-1].descriptor.index,c=t?l:l+1;return a<o||a>c?null:a},oT=({isMovingForward:e,isInHomeList:t,draggable:r,draggables:n,destination:s,insideDestination:a,previousImpact:o,viewport:l,afterCritical:c})=>{const u=o.at;if(u||Z(),u.type==="REORDER"){const f=iT({isMovingForward:e,isInHomeList:t,location:u.destination,insideDestination:a});return f==null?null:Tu({draggable:r,insideDestination:a,destination:s,viewport:l,last:o.displaced,displacedBy:o.displacedBy,index:f})}const d=aT({isMovingForward:e,destination:s,displaced:o.displaced,draggables:n,combine:u.combine,afterCritical:c});return d==null?null:Tu({draggable:r,insideDestination:a,destination:s,viewport:l,last:o.displaced,displacedBy:o.displacedBy,index:d})},lT=({displaced:e,afterCritical:t,combineWith:r,displacedBy:n})=>{const s=!!(e.visible[r]||e.invisible[r]);return ys(r,t)?s?yt:Ei(n.point):s?n.point:yt},cT=({afterCritical:e,impact:t,draggables:r})=>{const n=vd(t);n||Z();const s=n.draggableId,a=r[s].page.borderBox.center,o=lT({displaced:t.displaced,afterCritical:e,combineWith:s,displacedBy:t.displacedBy});return vt(a,o)};const uj=(e,t)=>t.margin[e.start]+t.borderBox[e.size]/2,uT=(e,t)=>t.margin[e.end]+t.borderBox[e.size]/2,xg=(e,t,r)=>t[e.crossAxisStart]+r.margin[e.crossAxisStart]+r.borderBox[e.crossAxisSize]/2,gy=({axis:e,moveRelativeTo:t,isMoving:r})=>oa(e.line,t.marginBox[e.end]+uj(e,r),xg(e,t.marginBox,r)),xy=({axis:e,moveRelativeTo:t,isMoving:r})=>oa(e.line,t.marginBox[e.start]-uT(e,r),xg(e,t.marginBox,r)),dT=({axis:e,moveInto:t,isMoving:r})=>oa(e.line,t.contentBox[e.start]+uj(e,r),xg(e,t.contentBox,r));var fT=({impact:e,draggable:t,draggables:r,droppable:n,afterCritical:s})=>{const a=Di(n.descriptor.id,r),o=t.page,l=n.axis;if(!a.length)return dT({axis:l,moveInto:n.page,isMoving:o});const{displaced:c,displacedBy:u}=e,d=c.all[0];if(d){const m=r[d];if(ys(d,s))return xy({axis:l,moveRelativeTo:m.page,isMoving:o});const h=Su(m.page,u.point);return xy({axis:l,moveRelativeTo:h,isMoving:o})}const f=a[a.length-1];if(f.descriptor.id===t.descriptor.id)return o.borderBox.center;if(ys(f.descriptor.id,s)){const m=Su(f.page,Ei(s.displacedBy.point));return gy({axis:l,moveRelativeTo:m,isMoving:o})}return gy({axis:l,moveRelativeTo:f.page,isMoving:o})},Ch=(e,t)=>{const r=e.frame;return r?vt(t,r.scroll.diff.displacement):t};const mT=({impact:e,draggable:t,droppable:r,draggables:n,afterCritical:s})=>{const a=t.page.borderBox.center,o=e.at;return!r||!o?a:o.type==="REORDER"?fT({impact:e,draggable:t,draggables:n,droppable:r,afterCritical:s}):cT({impact:e,draggables:n,afterCritical:s})};var _d=e=>{const t=mT(e),r=e.droppable;return r?Ch(r,t):t},dj=(e,t)=>{const r=nr(t,e.scroll.initial),n=Ei(r);return{frame:Or({top:t.y,bottom:t.y+e.frame.height,left:t.x,right:t.x+e.frame.width}),scroll:{initial:e.scroll.initial,max:e.scroll.max,current:t,diff:{value:r,displacement:n}}}};function yy(e,t){return e.map(r=>t[r])}function hT(e,t){for(let r=0;r<t.length;r++){const n=t[r].visible[e];if(n)return n}return null}var pT=({impact:e,viewport:t,destination:r,draggables:n,maxScrollChange:s})=>{const a=dj(t,vt(t.scroll.current,s)),o=r.frame?mg(r,vt(r.frame.scroll.current,s)):r,l=e.displaced,c=il({afterDragging:yy(l.all,n),destination:r,displacedBy:e.displacedBy,viewport:a.frame,last:l,forceShouldAnimate:!1}),u=il({afterDragging:yy(l.all,n),destination:o,displacedBy:e.displacedBy,viewport:t.frame,last:l,forceShouldAnimate:!1}),d={},f={},m=[l,c,u];return l.all.forEach(y=>{const v=hT(y,m);if(v){f[y]=v;return}d[y]=!0}),{...e,displaced:{all:l.all,invisible:d,visible:f}}},gT=(e,t)=>vt(e.scroll.diff.displacement,t),yg=({pageBorderBoxCenter:e,draggable:t,viewport:r})=>{const n=gT(r,e),s=nr(n,t.page.borderBox.center);return vt(t.client.borderBox.center,s)},fj=({draggable:e,destination:t,newPageBorderBoxCenter:r,viewport:n,withDroppableDisplacement:s,onlyOnMainAxis:a=!1})=>{const o=nr(r,e.page.borderBox.center),c={target:Cl(e.page.borderBox,o),destination:t,withDroppableDisplacement:s,viewport:n};return a?tT(c):cj(c)},xT=({isMovingForward:e,draggable:t,destination:r,draggables:n,previousImpact:s,viewport:a,previousPageBorderBoxCenter:o,previousClientSelection:l,afterCritical:c})=>{if(!r.isEnabled)return null;const u=Di(r.descriptor.id,n),d=Pi(t,r),f=Y5({isMovingForward:e,draggable:t,destination:r,insideDestination:u,previousImpact:s})||oT({isMovingForward:e,isInHomeList:d,draggable:t,draggables:n,destination:r,insideDestination:u,previousImpact:s,viewport:a,afterCritical:c});if(!f)return null;const m=_d({impact:f,draggable:t,droppable:r,draggables:n,afterCritical:c});if(fj({draggable:t,destination:r,newPageBorderBoxCenter:m,viewport:a.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0}))return{clientSelection:yg({pageBorderBoxCenter:m,draggable:t,viewport:a}),impact:f,scrollJumpRequest:null};const y=nr(m,o),v=pT({impact:f,viewport:a,destination:r,draggables:n,maxScrollChange:y});return{clientSelection:l,impact:v,scrollJumpRequest:y}};const Rt=e=>{const t=e.subject.active;return t||Z(),t};var yT=({isMovingForward:e,pageBorderBoxCenter:t,source:r,droppables:n,viewport:s})=>{const a=r.subject.active;if(!a)return null;const o=r.axis,l=jr(a[o.start],a[o.end]),c=bd(n).filter(d=>d!==r).filter(d=>d.isEnabled).filter(d=>!!d.subject.active).filter(d=>oj(s.frame)(Rt(d))).filter(d=>{const f=Rt(d);return e?a[o.crossAxisEnd]<f[o.crossAxisEnd]:f[o.crossAxisStart]<a[o.crossAxisStart]}).filter(d=>{const f=Rt(d),m=jr(f[o.start],f[o.end]);return l(f[o.start])||l(f[o.end])||m(a[o.start])||m(a[o.end])}).sort((d,f)=>{const m=Rt(d)[o.crossAxisStart],h=Rt(f)[o.crossAxisStart];return e?m-h:h-m}).filter((d,f,m)=>Rt(d)[o.crossAxisStart]===Rt(m[0])[o.crossAxisStart]);if(!c.length)return null;if(c.length===1)return c[0];const u=c.filter(d=>jr(Rt(d)[o.start],Rt(d)[o.end])(t[o.line]));return u.length===1?u[0]:u.length>1?u.sort((d,f)=>Rt(d)[o.start]-Rt(f)[o.start])[0]:c.sort((d,f)=>{const m=my(t,hy(Rt(d))),h=my(t,hy(Rt(f)));return m!==h?m-h:Rt(d)[o.start]-Rt(f)[o.start]})[0]};const by=(e,t)=>{const r=e.page.borderBox.center;return ys(e.descriptor.id,t)?nr(r,t.displacedBy.point):r},bT=(e,t)=>{const r=e.page.borderBox;return ys(e.descriptor.id,t)?Cl(r,Ei(t.displacedBy.point)):r};var vT=({pageBorderBoxCenter:e,viewport:t,destination:r,insideDestination:n,afterCritical:s})=>n.filter(o=>cj({target:bT(o,s),destination:r,viewport:t.frame,withDroppableDisplacement:!0})).sort((o,l)=>{const c=sl(e,Ch(r,by(o,s))),u=sl(e,Ch(r,by(l,s)));return c<u?-1:u<c?1:o.descriptor.index-l.descriptor.index})[0]||null,El=xt(function(t,r){const n=r[t.line];return{value:n,point:oa(t.line,n)}});const wT=(e,t,r)=>{const n=e.axis;if(e.descriptor.mode==="virtual")return oa(n.line,t[n.line]);const s=e.subject.page.contentBox[n.size],c=Di(e.descriptor.id,r).reduce((u,d)=>u+d.client.marginBox[n.size],0)+t[n.line]-s;return c<=0?null:oa(n.line,c)},mj=(e,t)=>({...e,scroll:{...e.scroll,max:t}}),hj=(e,t,r)=>{const n=e.frame;Pi(t,e)&&Z(),e.subject.withPlaceholder&&Z();const s=El(e.axis,t.displaceBy).point,a=wT(e,s,r),o={placeholderSize:s,increasedBy:a,oldFrameMaxScroll:e.frame?e.frame.scroll.max:null};if(!n){const d=oi({page:e.subject.page,withPlaceholder:o,axis:e.axis,frame:e.frame});return{...e,subject:d}}const l=a?vt(n.scroll.max,a):n.scroll.max,c=mj(n,l),u=oi({page:e.subject.page,withPlaceholder:o,axis:e.axis,frame:c});return{...e,subject:u,frame:c}},_T=e=>{const t=e.subject.withPlaceholder;t||Z();const r=e.frame;if(!r){const o=oi({page:e.subject.page,axis:e.axis,frame:null,withPlaceholder:null});return{...e,subject:o}}const n=t.oldFrameMaxScroll;n||Z();const s=mj(r,n),a=oi({page:e.subject.page,axis:e.axis,frame:s,withPlaceholder:null});return{...e,subject:a,frame:s}};var jT=({previousPageBorderBoxCenter:e,moveRelativeTo:t,insideDestination:r,draggable:n,draggables:s,destination:a,viewport:o,afterCritical:l})=>{if(!t){if(r.length)return null;const f={displaced:al,displacedBy:ij,at:{type:"REORDER",destination:{droppableId:a.descriptor.id,index:0}}},m=_d({impact:f,draggable:n,droppable:a,draggables:s,afterCritical:l}),h=Pi(n,a)?a:hj(a,n,s);return fj({draggable:n,destination:h,newPageBorderBoxCenter:m,viewport:o.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0})?f:null}const c=e[a.axis.line]<=t.page.borderBox.center[a.axis.line],u=(()=>{const f=t.descriptor.index;return t.descriptor.id===n.descriptor.id||c?f:f+1})(),d=El(a.axis,n.displaceBy);return Tu({draggable:n,insideDestination:r,destination:a,viewport:o,displacedBy:d,last:al,index:u})},kT=({isMovingForward:e,previousPageBorderBoxCenter:t,draggable:r,isOver:n,draggables:s,droppables:a,viewport:o,afterCritical:l})=>{const c=yT({isMovingForward:e,pageBorderBoxCenter:t,source:n,droppables:a,viewport:o});if(!c)return null;const u=Di(c.descriptor.id,s),d=vT({pageBorderBoxCenter:t,viewport:o,destination:c,insideDestination:u,afterCritical:l}),f=jT({previousPageBorderBoxCenter:t,destination:c,draggable:r,draggables:s,moveRelativeTo:d,insideDestination:u,viewport:o,afterCritical:l});if(!f)return null;const m=_d({impact:f,draggable:r,droppable:c,draggables:s,afterCritical:l});return{clientSelection:yg({pageBorderBoxCenter:m,draggable:r,viewport:o}),impact:f,scrollJumpRequest:null}},ir=e=>{const t=e.at;return t?t.type==="REORDER"?t.destination.droppableId:t.combine.droppableId:null};const NT=(e,t)=>{const r=ir(e);return r?t[r]:null};var ST=({state:e,type:t})=>{const r=NT(e.impact,e.dimensions.droppables),n=!!r,s=e.dimensions.droppables[e.critical.droppable.id],a=r||s,o=a.axis.direction,l=o==="vertical"&&(t==="MOVE_UP"||t==="MOVE_DOWN")||o==="horizontal"&&(t==="MOVE_LEFT"||t==="MOVE_RIGHT");if(l&&!n)return null;const c=t==="MOVE_DOWN"||t==="MOVE_RIGHT",u=e.dimensions.draggables[e.critical.draggable.id],d=e.current.page.borderBoxCenter,{draggables:f,droppables:m}=e.dimensions;return l?xT({isMovingForward:c,previousPageBorderBoxCenter:d,draggable:u,destination:a,draggables:f,viewport:e.viewport,previousClientSelection:e.current.client.selection,previousImpact:e.impact,afterCritical:e.afterCritical}):kT({isMovingForward:c,previousPageBorderBoxCenter:d,draggable:u,isOver:a,draggables:f,droppables:m,viewport:e.viewport,afterCritical:e.afterCritical})};function As(e){return e.phase==="DRAGGING"||e.phase==="COLLECTING"}function pj(e){const t=jr(e.top,e.bottom),r=jr(e.left,e.right);return function(s){return t(s.y)&&r(s.x)}}function CT(e,t){return e.left<t.right&&e.right>t.left&&e.top<t.bottom&&e.bottom>t.top}function ET({pageBorderBox:e,draggable:t,candidates:r}){const n=t.page.borderBox.center,s=r.map(a=>{const o=a.axis,l=oa(a.axis.line,e.center[o.line],a.page.borderBox.center[o.crossAxisLine]);return{id:a.descriptor.id,distance:sl(n,l)}}).sort((a,o)=>o.distance-a.distance);return s[0]?s[0].id:null}function DT({pageBorderBox:e,draggable:t,droppables:r}){const n=bd(r).filter(s=>{if(!s.isEnabled)return!1;const a=s.subject.active;if(!a||!CT(e,a))return!1;if(pj(a)(e.center))return!0;const o=s.axis,l=a.center[o.crossAxisLine],c=e[o.crossAxisStart],u=e[o.crossAxisEnd],d=jr(a[o.crossAxisStart],a[o.crossAxisEnd]),f=d(c),m=d(u);return!f&&!m?!0:f?c<l:u>l});return n.length?n.length===1?n[0].descriptor.id:ET({pageBorderBox:e,draggable:t,candidates:n}):null}const gj=(e,t)=>Or(Cl(e,t));var PT=(e,t)=>{const r=e.frame;return r?gj(t,r.scroll.diff.value):t};function xj({displaced:e,id:t}){return!!(e.visible[t]||e.invisible[t])}function TT({draggable:e,closest:t,inHomeList:r}){return t?r&&t.descriptor.index>e.descriptor.index?t.descriptor.index-1:t.descriptor.index:null}var LT=({pageBorderBoxWithDroppableScroll:e,draggable:t,destination:r,insideDestination:n,last:s,viewport:a,afterCritical:o})=>{const l=r.axis,c=El(r.axis,t.displaceBy),u=c.value,d=e[l.start],f=e[l.end],h=wd(t,n).find(v=>{const w=v.descriptor.id,g=v.page.borderBox.center[l.line],b=ys(w,o),p=xj({displaced:s,id:w});return b?p?f<=g:d<g-u:p?f<=g+u:d<g})||null,y=TT({draggable:t,closest:h,inHomeList:Pi(t,r)});return Tu({draggable:t,insideDestination:n,destination:r,viewport:a,last:s,displacedBy:c,index:y})};const IT=4;var RT=({draggable:e,pageBorderBoxWithDroppableScroll:t,previousImpact:r,destination:n,insideDestination:s,afterCritical:a})=>{if(!n.isCombineEnabled)return null;const o=n.axis,l=El(n.axis,e.displaceBy),c=l.value,u=t[o.start],d=t[o.end],m=wd(e,s).find(y=>{const v=y.descriptor.id,w=y.page.borderBox,b=w[o.size]/IT,p=ys(v,a),_=xj({displaced:r.displaced,id:v});return p?_?d>w[o.start]+b&&d<w[o.end]-b:u>w[o.start]-c+b&&u<w[o.end]-c-b:_?d>w[o.start]+c+b&&d<w[o.end]+c-b:u>w[o.start]+b&&u<w[o.end]-b});return m?{displacedBy:l,displaced:r.displaced,at:{type:"COMBINE",combine:{draggableId:m.descriptor.id,droppableId:n.descriptor.id}}}:null},yj=({pageOffset:e,draggable:t,draggables:r,droppables:n,previousImpact:s,viewport:a,afterCritical:o})=>{const l=gj(t.page.borderBox,e),c=DT({pageBorderBox:l,draggable:t,droppables:n});if(!c)return G5;const u=n[c],d=Di(u.descriptor.id,r),f=PT(u,l);return RT({pageBorderBoxWithDroppableScroll:f,draggable:t,previousImpact:s,destination:u,insideDestination:d,afterCritical:o})||LT({pageBorderBoxWithDroppableScroll:f,draggable:t,destination:u,insideDestination:d,last:s.displaced,viewport:a,afterCritical:o})},bg=(e,t)=>({...e,[t.descriptor.id]:t});const MT=({previousImpact:e,impact:t,droppables:r})=>{const n=ir(e),s=ir(t);if(!n||n===s)return r;const a=r[n];if(!a.subject.withPlaceholder)return r;const o=_T(a);return bg(r,o)};var OT=({draggable:e,draggables:t,droppables:r,previousImpact:n,impact:s})=>{const a=MT({previousImpact:n,impact:s,droppables:r}),o=ir(s);if(!o)return a;const l=r[o];if(Pi(e,l)||l.subject.withPlaceholder)return a;const c=hj(l,e,t);return bg(a,c)},Lo=({state:e,clientSelection:t,dimensions:r,viewport:n,impact:s,scrollJumpRequest:a})=>{const o=n||e.viewport,l=r||e.dimensions,c=t||e.current.client.selection,u=nr(c,e.initial.client.selection),d={offset:u,selection:c,borderBoxCenter:vt(e.initial.client.borderBoxCenter,u)},f={selection:vt(d.selection,o.scroll.current),borderBoxCenter:vt(d.borderBoxCenter,o.scroll.current),offset:vt(d.offset,o.scroll.diff.value)},m={client:d,page:f};if(e.phase==="COLLECTING")return{...e,dimensions:l,viewport:o,current:m};const h=l.draggables[e.critical.draggable.id],y=s||yj({pageOffset:f.offset,draggable:h,draggables:l.draggables,droppables:l.droppables,previousImpact:e.impact,viewport:o,afterCritical:e.afterCritical}),v=OT({draggable:h,impact:y,previousImpact:e.impact,draggables:l.draggables,droppables:l.droppables});return{...e,current:m,dimensions:{draggables:l.draggables,droppables:v},impact:y,viewport:o,scrollJumpRequest:a||null,forceShouldAnimate:a?!1:null}};function AT(e,t){return e.map(r=>t[r])}var bj=({impact:e,viewport:t,draggables:r,destination:n,forceShouldAnimate:s})=>{const a=e.displaced,o=AT(a.all,r),l=il({afterDragging:o,destination:n,displacedBy:e.displacedBy,viewport:t.frame,forceShouldAnimate:s,last:a});return{...e,displaced:l}},vj=({impact:e,draggable:t,droppable:r,draggables:n,viewport:s,afterCritical:a})=>{const o=_d({impact:e,draggable:t,draggables:n,droppable:r,afterCritical:a});return yg({pageBorderBoxCenter:o,draggable:t,viewport:s})},wj=({state:e,dimensions:t,viewport:r})=>{e.movementMode!=="SNAP"&&Z();const n=e.impact,s=r||e.viewport,a=t||e.dimensions,{draggables:o,droppables:l}=a,c=o[e.critical.draggable.id],u=ir(n);u||Z();const d=l[u],f=bj({impact:n,viewport:s,destination:d,draggables:o}),m=vj({impact:f,draggable:c,droppable:d,draggables:o,viewport:s,afterCritical:e.afterCritical});return Lo({impact:f,clientSelection:m,state:e,dimensions:a,viewport:s})},$T=e=>({index:e.index,droppableId:e.droppableId}),_j=({draggable:e,home:t,draggables:r,viewport:n})=>{const s=El(t.axis,e.displaceBy),a=Di(t.descriptor.id,r),o=a.indexOf(e);o===-1&&Z();const l=a.slice(o+1),c=l.reduce((m,h)=>(m[h.descriptor.id]=!0,m),{}),u={inVirtualList:t.descriptor.mode==="virtual",displacedBy:s,effected:c};return{impact:{displaced:il({afterDragging:l,destination:t,displacedBy:s,last:null,viewport:n.frame,forceShouldAnimate:!1}),displacedBy:s,at:{type:"REORDER",destination:$T(e.descriptor)}},afterCritical:u}},FT=(e,t)=>({draggables:e.draggables,droppables:bg(e.droppables,t)}),BT=({draggable:e,offset:t,initialWindowScroll:r})=>{const n=Su(e.client,t),s=Cu(n,r);return{...e,placeholder:{...e.placeholder,client:n},client:n,page:s}},UT=e=>{const t=e.frame;return t||Z(),t},zT=({additions:e,updatedDroppables:t,viewport:r})=>{const n=r.scroll.diff.value;return e.map(s=>{const a=s.descriptor.droppableId,o=t[a],c=UT(o).scroll.diff.value,u=vt(n,c);return BT({draggable:s,offset:u,initialWindowScroll:r.scroll.initial})})},WT=({state:e,published:t})=>{const r=t.modified.map(g=>{const b=e.dimensions.droppables[g.droppableId];return mg(b,g.scroll)}),n={...e.dimensions.droppables,...sj(r)},s=aj(zT({additions:t.additions,updatedDroppables:n,viewport:e.viewport})),a={...e.dimensions.draggables,...s};t.removals.forEach(g=>{delete a[g]});const o={droppables:n,draggables:a},l=ir(e.impact),c=l?o.droppables[l]:null,u=o.draggables[e.critical.draggable.id],d=o.droppables[e.critical.droppable.id],{impact:f,afterCritical:m}=_j({draggable:u,home:d,draggables:a,viewport:e.viewport}),h=c&&c.isCombineEnabled?e.impact:f,y=yj({pageOffset:e.current.page.offset,draggable:o.draggables[e.critical.draggable.id],draggables:o.draggables,droppables:o.droppables,previousImpact:h,viewport:e.viewport,afterCritical:m}),v={...e,phase:"DRAGGING",impact:y,onLiftImpact:f,dimensions:o,afterCritical:m,forceShouldAnimate:!1};return e.phase==="COLLECTING"?v:{...v,phase:"DROP_PENDING",reason:e.reason,isWaiting:!1}};const Eh=e=>e.movementMode==="SNAP",Rf=(e,t,r)=>{const n=FT(e.dimensions,t);return!Eh(e)||r?Lo({state:e,dimensions:n}):wj({state:e,dimensions:n})};function Mf(e){return e.isDragging&&e.movementMode==="SNAP"?{...e,scrollJumpRequest:null}:e}const vy={phase:"IDLE",completed:null,shouldFlush:!1};var HT=(e=vy,t)=>{if(t.type==="FLUSH")return{...vy,shouldFlush:!0};if(t.type==="INITIAL_PUBLISH"){e.phase!=="IDLE"&&Z();const{critical:r,clientSelection:n,viewport:s,dimensions:a,movementMode:o}=t.payload,l=a.draggables[r.draggable.id],c=a.droppables[r.droppable.id],u={selection:n,borderBoxCenter:l.client.borderBox.center,offset:yt},d={client:u,page:{selection:vt(u.selection,s.scroll.initial),borderBoxCenter:vt(u.selection,s.scroll.initial),offset:vt(u.selection,s.scroll.diff.value)}},f=bd(a.droppables).every(v=>!v.isFixedOnPage),{impact:m,afterCritical:h}=_j({draggable:l,home:c,draggables:a.draggables,viewport:s});return{phase:"DRAGGING",isDragging:!0,critical:r,movementMode:o,dimensions:a,initial:d,current:d,isWindowScrollAllowed:f,impact:m,afterCritical:h,onLiftImpact:m,viewport:s,scrollJumpRequest:null,forceShouldAnimate:null}}if(t.type==="COLLECTION_STARTING")return e.phase==="COLLECTING"||e.phase==="DROP_PENDING"?e:(e.phase!=="DRAGGING"&&Z(),{...e,phase:"COLLECTING"});if(t.type==="PUBLISH_WHILE_DRAGGING")return e.phase==="COLLECTING"||e.phase==="DROP_PENDING"||Z(),WT({state:e,published:t.payload});if(t.type==="MOVE"){if(e.phase==="DROP_PENDING")return e;As(e)||Z();const{client:r}=t.payload;return ms(r,e.current.client.selection)?e:Lo({state:e,clientSelection:r,impact:Eh(e)?e.impact:null})}if(t.type==="UPDATE_DROPPABLE_SCROLL"){if(e.phase==="DROP_PENDING"||e.phase==="COLLECTING")return Mf(e);As(e)||Z();const{id:r,newScroll:n}=t.payload,s=e.dimensions.droppables[r];if(!s)return e;const a=mg(s,n);return Rf(e,a,!1)}if(t.type==="UPDATE_DROPPABLE_IS_ENABLED"){if(e.phase==="DROP_PENDING")return e;As(e)||Z();const{id:r,isEnabled:n}=t.payload,s=e.dimensions.droppables[r];s||Z(),s.isEnabled===n&&Z();const a={...s,isEnabled:n};return Rf(e,a,!0)}if(t.type==="UPDATE_DROPPABLE_IS_COMBINE_ENABLED"){if(e.phase==="DROP_PENDING")return e;As(e)||Z();const{id:r,isCombineEnabled:n}=t.payload,s=e.dimensions.droppables[r];s||Z(),s.isCombineEnabled===n&&Z();const a={...s,isCombineEnabled:n};return Rf(e,a,!0)}if(t.type==="MOVE_BY_WINDOW_SCROLL"){if(e.phase==="DROP_PENDING"||e.phase==="DROP_ANIMATING")return e;As(e)||Z(),e.isWindowScrollAllowed||Z();const r=t.payload.newScroll;if(ms(e.viewport.scroll.current,r))return Mf(e);const n=dj(e.viewport,r);return Eh(e)?wj({state:e,viewport:n}):Lo({state:e,viewport:n})}if(t.type==="UPDATE_VIEWPORT_MAX_SCROLL"){if(!As(e))return e;const r=t.payload.maxScroll;if(ms(r,e.viewport.scroll.max))return e;const n={...e.viewport,scroll:{...e.viewport.scroll,max:r}};return{...e,viewport:n}}if(t.type==="MOVE_UP"||t.type==="MOVE_DOWN"||t.type==="MOVE_LEFT"||t.type==="MOVE_RIGHT"){if(e.phase==="COLLECTING"||e.phase==="DROP_PENDING")return e;e.phase!=="DRAGGING"&&Z();const r=ST({state:e,type:t.type});return r?Lo({state:e,impact:r.impact,clientSelection:r.clientSelection,scrollJumpRequest:r.scrollJumpRequest}):e}if(t.type==="DROP_PENDING"){const r=t.payload.reason;return e.phase!=="COLLECTING"&&Z(),{...e,phase:"DROP_PENDING",isWaiting:!0,reason:r}}if(t.type==="DROP_ANIMATE"){const{completed:r,dropDuration:n,newHomeClientOffset:s}=t.payload;return e.phase==="DRAGGING"||e.phase==="DROP_PENDING"||Z(),{phase:"DROP_ANIMATING",completed:r,dropDuration:n,newHomeClientOffset:s,dimensions:e.dimensions}}if(t.type==="DROP_COMPLETE"){const{completed:r}=t.payload;return{phase:"IDLE",completed:r,shouldFlush:!1}}return e};function Me(e,t){return e instanceof Object&&"type"in e&&e.type===t}const qT=e=>({type:"BEFORE_INITIAL_CAPTURE",payload:e}),VT=e=>({type:"LIFT",payload:e}),YT=e=>({type:"INITIAL_PUBLISH",payload:e}),GT=e=>({type:"PUBLISH_WHILE_DRAGGING",payload:e}),KT=()=>({type:"COLLECTION_STARTING",payload:null}),QT=e=>({type:"UPDATE_DROPPABLE_SCROLL",payload:e}),JT=e=>({type:"UPDATE_DROPPABLE_IS_ENABLED",payload:e}),XT=e=>({type:"UPDATE_DROPPABLE_IS_COMBINE_ENABLED",payload:e}),jj=e=>({type:"MOVE",payload:e}),ZT=e=>({type:"MOVE_BY_WINDOW_SCROLL",payload:e}),e3=e=>({type:"UPDATE_VIEWPORT_MAX_SCROLL",payload:e}),t3=()=>({type:"MOVE_UP",payload:null}),r3=()=>({type:"MOVE_DOWN",payload:null}),n3=()=>({type:"MOVE_RIGHT",payload:null}),s3=()=>({type:"MOVE_LEFT",payload:null}),vg=()=>({type:"FLUSH",payload:null}),a3=e=>({type:"DROP_ANIMATE",payload:e}),wg=e=>({type:"DROP_COMPLETE",payload:e}),kj=e=>({type:"DROP",payload:e}),i3=e=>({type:"DROP_PENDING",payload:e}),Nj=()=>({type:"DROP_ANIMATION_FINISHED",payload:null});var o3=e=>({getState:t,dispatch:r})=>n=>s=>{if(!Me(s,"LIFT")){n(s);return}const{id:a,clientSelection:o,movementMode:l}=s.payload,c=t();c.phase==="DROP_ANIMATING"&&r(wg({completed:c.completed})),t().phase!=="IDLE"&&Z(),r(vg()),r(qT({draggableId:a,movementMode:l}));const d={draggableId:a,scrollOptions:{shouldPublishImmediately:l==="SNAP"}},{critical:f,dimensions:m,viewport:h}=e.startPublishing(d);r(YT({critical:f,dimensions:m,clientSelection:o,movementMode:l,viewport:h}))},l3=e=>()=>t=>r=>{Me(r,"INITIAL_PUBLISH")&&e.dragging(),Me(r,"DROP_ANIMATE")&&e.dropping(r.payload.completed.result.reason),(Me(r,"FLUSH")||Me(r,"DROP_COMPLETE"))&&e.resting(),t(r)};const _g={outOfTheWay:"cubic-bezier(0.2, 0, 0, 1)",drop:"cubic-bezier(.2,1,.1,1)"},ol={opacity:{drop:0,combining:.7},scale:{drop:.75}},Sj={outOfTheWay:.2,minDropTime:.33,maxDropTime:.55},Ts=`${Sj.outOfTheWay}s ${_g.outOfTheWay}`,Io={fluid:`opacity ${Ts}`,snap:`transform ${Ts}, opacity ${Ts}`,drop:e=>{const t=`${e}s ${_g.drop}`;return`transform ${t}, opacity ${t}`},outOfTheWay:`transform ${Ts}`,placeholder:`height ${Ts}, width ${Ts}, margin ${Ts}`},wy=e=>ms(e,yt)?void 0:`translate(${e.x}px, ${e.y}px)`,Dh={moveTo:wy,drop:(e,t)=>{const r=wy(e);if(r)return t?`${r} scale(${ol.scale.drop})`:r}},{minDropTime:Ph,maxDropTime:Cj}=Sj,c3=Cj-Ph,_y=1500,u3=.6;var d3=({current:e,destination:t,reason:r})=>{const n=sl(e,t);if(n<=0)return Ph;if(n>=_y)return Cj;const s=n/_y,a=Ph+c3*s,o=r==="CANCEL"?a*u3:a;return Number(o.toFixed(2))},f3=({impact:e,draggable:t,dimensions:r,viewport:n,afterCritical:s})=>{const{draggables:a,droppables:o}=r,l=ir(e),c=l?o[l]:null,u=o[t.descriptor.droppableId],d=vj({impact:e,draggable:t,draggables:a,afterCritical:s,droppable:c||u,viewport:n});return nr(d,t.client.borderBox.center)},m3=({draggables:e,reason:t,lastImpact:r,home:n,viewport:s,onLiftImpact:a})=>!r.at||t!=="DROP"?{impact:bj({draggables:e,impact:a,destination:n,viewport:s,forceShouldAnimate:!0}),didDropInsideDroppable:!1}:r.at.type==="REORDER"?{impact:r,didDropInsideDroppable:!0}:{impact:{...r,displaced:al},didDropInsideDroppable:!0};const h3=({getState:e,dispatch:t})=>r=>n=>{if(!Me(n,"DROP")){r(n);return}const s=e(),a=n.payload.reason;if(s.phase==="COLLECTING"){t(i3({reason:a}));return}if(s.phase==="IDLE")return;s.phase==="DROP_PENDING"&&s.isWaiting&&Z(),s.phase==="DRAGGING"||s.phase==="DROP_PENDING"||Z();const l=s.critical,c=s.dimensions,u=c.draggables[s.critical.draggable.id],{impact:d,didDropInsideDroppable:f}=m3({reason:a,lastImpact:s.impact,afterCritical:s.afterCritical,onLiftImpact:s.onLiftImpact,home:s.dimensions.droppables[s.critical.droppable.id],viewport:s.viewport,draggables:s.dimensions.draggables}),m=f?hg(d):null,h=f?vd(d):null,y={index:l.draggable.index,droppableId:l.droppable.id},v={draggableId:u.descriptor.id,type:u.descriptor.type,source:y,reason:a,mode:s.movementMode,destination:m,combine:h},w=f3({impact:d,draggable:u,dimensions:c,viewport:s.viewport,afterCritical:s.afterCritical}),g={critical:s.critical,afterCritical:s.afterCritical,result:v,impact:d};if(!(!ms(s.current.client.offset,w)||!!v.combine)){t(wg({completed:g}));return}const p=d3({current:s.current.client.offset,destination:w,reason:a});t(a3({newHomeClientOffset:w,dropDuration:p,completed:g}))};var Ej=()=>({x:window.pageXOffset,y:window.pageYOffset});function p3(e){return{eventName:"scroll",options:{passive:!0,capture:!1},fn:t=>{t.target!==window&&t.target!==window.document||e()}}}function g3({onWindowScroll:e}){function t(){e(Ej())}const r=nl(t),n=p3(r);let s=fs;function a(){return s!==fs}function o(){a()&&Z(),s=wr(window,[n])}function l(){a()||Z(),r.cancel(),s(),s=fs}return{start:o,stop:l,isActive:a}}const x3=e=>Me(e,"DROP_COMPLETE")||Me(e,"DROP_ANIMATE")||Me(e,"FLUSH"),y3=e=>{const t=g3({onWindowScroll:r=>{e.dispatch(ZT({newScroll:r}))}});return r=>n=>{!t.isActive()&&Me(n,"INITIAL_PUBLISH")&&t.start(),t.isActive()&&x3(n)&&t.stop(),r(n)}};var b3=e=>{let t=!1,r=!1;const n=setTimeout(()=>{r=!0}),s=a=>{t||r||(t=!0,e(a),clearTimeout(n))};return s.wasCalled=()=>t,s},v3=()=>{const e=[],t=s=>{const a=e.findIndex(l=>l.timerId===s);a===-1&&Z();const[o]=e.splice(a,1);o.callback()};return{add:s=>{const a=setTimeout(()=>t(a)),o={timerId:a,callback:s};e.push(o)},flush:()=>{if(!e.length)return;const s=[...e];e.length=0,s.forEach(a=>{clearTimeout(a.timerId),a.callback()})}}};const w3=(e,t)=>e==null&&t==null?!0:e==null||t==null?!1:e.droppableId===t.droppableId&&e.index===t.index,_3=(e,t)=>e==null&&t==null?!0:e==null||t==null?!1:e.draggableId===t.draggableId&&e.droppableId===t.droppableId,j3=(e,t)=>{if(e===t)return!0;const r=e.draggable.id===t.draggable.id&&e.draggable.droppableId===t.draggable.droppableId&&e.draggable.type===t.draggable.type&&e.draggable.index===t.draggable.index,n=e.droppable.id===t.droppable.id&&e.droppable.type===t.droppable.type;return r&&n},Yi=(e,t)=>{t()},ic=(e,t)=>({draggableId:e.draggable.id,type:e.droppable.type,source:{droppableId:e.droppable.id,index:e.draggable.index},mode:t});function Of(e,t,r,n){if(!e){r(n(t));return}const s=b3(r);e(t,{announce:s}),s.wasCalled()||r(n(t))}var k3=(e,t)=>{const r=v3();let n=null;const s=(f,m)=>{n&&Z(),Yi("onBeforeCapture",()=>{const h=e().onBeforeCapture;h&&h({draggableId:f,mode:m})})},a=(f,m)=>{n&&Z(),Yi("onBeforeDragStart",()=>{const h=e().onBeforeDragStart;h&&h(ic(f,m))})},o=(f,m)=>{n&&Z();const h=ic(f,m);n={mode:m,lastCritical:f,lastLocation:h.source,lastCombine:null},r.add(()=>{Yi("onDragStart",()=>Of(e().onDragStart,h,t,Uc.onDragStart))})},l=(f,m)=>{const h=hg(m),y=vd(m);n||Z();const v=!j3(f,n.lastCritical);v&&(n.lastCritical=f);const w=!w3(n.lastLocation,h);w&&(n.lastLocation=h);const g=!_3(n.lastCombine,y);if(g&&(n.lastCombine=y),!v&&!w&&!g)return;const b={...ic(f,n.mode),combine:y,destination:h};r.add(()=>{Yi("onDragUpdate",()=>Of(e().onDragUpdate,b,t,Uc.onDragUpdate))})},c=()=>{n||Z(),r.flush()},u=f=>{n||Z(),n=null,Yi("onDragEnd",()=>Of(e().onDragEnd,f,t,Uc.onDragEnd))};return{beforeCapture:s,beforeStart:a,start:o,update:l,flush:c,drop:u,abort:()=>{if(!n)return;const f={...ic(n.lastCritical,n.mode),combine:null,destination:null,reason:"CANCEL"};u(f)}}},N3=(e,t)=>{const r=k3(e,t);return n=>s=>a=>{if(Me(a,"BEFORE_INITIAL_CAPTURE")){r.beforeCapture(a.payload.draggableId,a.payload.movementMode);return}if(Me(a,"INITIAL_PUBLISH")){const l=a.payload.critical;r.beforeStart(l,a.payload.movementMode),s(a),r.start(l,a.payload.movementMode);return}if(Me(a,"DROP_COMPLETE")){const l=a.payload.completed.result;r.flush(),s(a),r.drop(l);return}if(s(a),Me(a,"FLUSH")){r.abort();return}const o=n.getState();o.phase==="DRAGGING"&&r.update(o.critical,o.impact)}};const S3=e=>t=>r=>{if(!Me(r,"DROP_ANIMATION_FINISHED")){t(r);return}const n=e.getState();n.phase!=="DROP_ANIMATING"&&Z(),e.dispatch(wg({completed:n.completed}))},C3=e=>{let t=null,r=null;function n(){r&&(cancelAnimationFrame(r),r=null),t&&(t(),t=null)}return s=>a=>{if((Me(a,"FLUSH")||Me(a,"DROP_COMPLETE")||Me(a,"DROP_ANIMATION_FINISHED"))&&n(),s(a),!Me(a,"DROP_ANIMATE"))return;const o={eventName:"scroll",options:{capture:!0,passive:!1,once:!0},fn:function(){e.getState().phase==="DROP_ANIMATING"&&e.dispatch(Nj())}};r=requestAnimationFrame(()=>{r=null,t=wr(window,[o])})}};var E3=e=>()=>t=>r=>{(Me(r,"DROP_COMPLETE")||Me(r,"FLUSH")||Me(r,"DROP_ANIMATE"))&&e.stopPublishing(),t(r)},D3=e=>{let t=!1;return()=>r=>n=>{if(Me(n,"INITIAL_PUBLISH")){t=!0,e.tryRecordFocus(n.payload.critical.draggable.id),r(n),e.tryRestoreFocusRecorded();return}if(r(n),!!t){if(Me(n,"FLUSH")){t=!1,e.tryRestoreFocusRecorded();return}if(Me(n,"DROP_COMPLETE")){t=!1;const s=n.payload.completed.result;s.combine&&e.tryShiftRecord(s.draggableId,s.combine.draggableId),e.tryRestoreFocusRecorded()}}}};const P3=e=>Me(e,"DROP_COMPLETE")||Me(e,"DROP_ANIMATE")||Me(e,"FLUSH");var T3=e=>t=>r=>n=>{if(P3(n)){e.stop(),r(n);return}if(Me(n,"INITIAL_PUBLISH")){r(n);const s=t.getState();s.phase!=="DRAGGING"&&Z(),e.start(s);return}r(n),e.scroll(t.getState())};const L3=e=>t=>r=>{if(t(r),!Me(r,"PUBLISH_WHILE_DRAGGING"))return;const n=e.getState();n.phase==="DROP_PENDING"&&(n.isWaiting||e.dispatch(kj({reason:n.reason})))},I3=H1;var R3=({dimensionMarshal:e,focusMarshal:t,styleMarshal:r,getResponders:n,announce:s,autoScroller:a})=>W1(HT,I3(SP(l3(r),E3(e),o3(e),h3,S3,C3,L3,T3(a),y3,D3(t),N3(n,s))));const Af=()=>({additions:{},removals:{},modified:{}});function M3({registry:e,callbacks:t}){let r=Af(),n=null;const s=()=>{n||(t.collectionStarting(),n=requestAnimationFrame(()=>{n=null;const{additions:c,removals:u,modified:d}=r,f=Object.keys(c).map(y=>e.draggable.getById(y).getDimension(yt)).sort((y,v)=>y.descriptor.index-v.descriptor.index),m=Object.keys(d).map(y=>{const w=e.droppable.getById(y).callbacks.getScrollWhileDragging();return{droppableId:y,scroll:w}}),h={additions:f,removals:Object.keys(u),modified:m};r=Af(),t.publish(h)}))};return{add:c=>{const u=c.descriptor.id;r.additions[u]=c,r.modified[c.descriptor.droppableId]=!0,r.removals[u]&&delete r.removals[u],s()},remove:c=>{const u=c.descriptor;r.removals[u.id]=!0,r.modified[u.droppableId]=!0,r.additions[u.id]&&delete r.additions[u.id],s()},stop:()=>{n&&(cancelAnimationFrame(n),n=null,r=Af())}}}var Dj=({scrollHeight:e,scrollWidth:t,height:r,width:n})=>{const s=nr({x:t,y:e},{x:n,y:r});return{x:Math.max(0,s.x),y:Math.max(0,s.y)}},Pj=()=>{const e=document.documentElement;return e||Z(),e},Tj=()=>{const e=Pj();return Dj({scrollHeight:e.scrollHeight,scrollWidth:e.scrollWidth,width:e.clientWidth,height:e.clientHeight})},O3=()=>{const e=Ej(),t=Tj(),r=e.y,n=e.x,s=Pj(),a=s.clientWidth,o=s.clientHeight,l=n+a,c=r+o;return{frame:Or({top:r,left:n,right:l,bottom:c}),scroll:{initial:e,current:e,max:t,diff:{value:yt,displacement:yt}}}},A3=({critical:e,scrollOptions:t,registry:r})=>{const n=O3(),s=n.scroll.current,a=e.droppable,o=r.droppable.getAllByType(a.type).map(d=>d.callbacks.getDimensionAndWatchScroll(s,t)),l=r.draggable.getAllByType(e.draggable.type).map(d=>d.getDimension(s));return{dimensions:{draggables:aj(l),droppables:sj(o)},critical:e,viewport:n}};function jy(e,t,r){return!(r.descriptor.id===t.id||r.descriptor.type!==t.type||e.droppable.getById(r.descriptor.droppableId).descriptor.mode!=="virtual")}var $3=(e,t)=>{let r=null;const n=M3({callbacks:{publish:t.publishWhileDragging,collectionStarting:t.collectionStarting},registry:e}),s=(m,h)=>{e.droppable.exists(m)||Z(),r&&t.updateDroppableIsEnabled({id:m,isEnabled:h})},a=(m,h)=>{r&&(e.droppable.exists(m)||Z(),t.updateDroppableIsCombineEnabled({id:m,isCombineEnabled:h}))},o=(m,h)=>{r&&(e.droppable.exists(m)||Z(),t.updateDroppableScroll({id:m,newScroll:h}))},l=(m,h)=>{r&&e.droppable.getById(m).callbacks.scroll(h)},c=()=>{if(!r)return;n.stop();const m=r.critical.droppable;e.droppable.getAllByType(m.type).forEach(h=>h.callbacks.dragStopped()),r.unsubscribe(),r=null},u=m=>{r||Z();const h=r.critical.draggable;m.type==="ADDITION"&&jy(e,h,m.value)&&n.add(m.value),m.type==="REMOVAL"&&jy(e,h,m.value)&&n.remove(m.value)};return{updateDroppableIsEnabled:s,updateDroppableIsCombineEnabled:a,scrollDroppable:l,updateDroppableScroll:o,startPublishing:m=>{r&&Z();const h=e.draggable.getById(m.draggableId),y=e.droppable.getById(h.descriptor.droppableId),v={draggable:h.descriptor,droppable:y.descriptor},w=e.subscribe(u);return r={critical:v,unsubscribe:w},A3({critical:v,registry:e,scrollOptions:m.scrollOptions})},stopPublishing:c}},Lj=(e,t)=>e.phase==="IDLE"?!0:e.phase!=="DROP_ANIMATING"||e.completed.result.draggableId===t?!1:e.completed.result.reason==="DROP",F3=e=>{window.scrollBy(e.x,e.y)};const B3=xt(e=>bd(e).filter(t=>!(!t.isEnabled||!t.frame))),U3=(e,t)=>B3(t).find(n=>(n.frame||Z(),pj(n.frame.pageMarginBox)(e)))||null;var z3=({center:e,destination:t,droppables:r})=>{if(t){const s=r[t];return s.frame?s:null}return U3(e,r)};const ll={startFromPercentage:.25,maxScrollAtPercentage:.05,maxPixelScroll:28,ease:e=>e**2,durationDampening:{stopDampeningAt:1200,accelerateAt:360},disabled:!1};var W3=(e,t,r=()=>ll)=>{const n=r(),s=e[t.size]*n.startFromPercentage,a=e[t.size]*n.maxScrollAtPercentage;return{startScrollingFrom:s,maxScrollValueAt:a}},Ij=({startOfRange:e,endOfRange:t,current:r})=>{const n=t-e;return n===0?0:(r-e)/n},jg=1,H3=(e,t,r=()=>ll)=>{const n=r();if(e>t.startScrollingFrom)return 0;if(e<=t.maxScrollValueAt)return n.maxPixelScroll;if(e===t.startScrollingFrom)return jg;const a=1-Ij({startOfRange:t.maxScrollValueAt,endOfRange:t.startScrollingFrom,current:e}),o=n.maxPixelScroll*n.ease(a);return Math.ceil(o)},q3=(e,t,r)=>{const n=r(),s=n.durationDampening.accelerateAt,a=n.durationDampening.stopDampeningAt,o=t,l=a,u=Date.now()-o;if(u>=a)return e;if(u<s)return jg;const d=Ij({startOfRange:s,endOfRange:l,current:u}),f=e*n.ease(d);return Math.ceil(f)},ky=({distanceToEdge:e,thresholds:t,dragStartTime:r,shouldUseTimeDampening:n,getAutoScrollerOptions:s})=>{const a=H3(e,t,s);return a===0?0:n?Math.max(q3(a,r,s),jg):a},Ny=({container:e,distanceToEdges:t,dragStartTime:r,axis:n,shouldUseTimeDampening:s,getAutoScrollerOptions:a})=>{const o=W3(e,n,a);return t[n.end]<t[n.start]?ky({distanceToEdge:t[n.end],thresholds:o,dragStartTime:r,shouldUseTimeDampening:s,getAutoScrollerOptions:a}):-1*ky({distanceToEdge:t[n.start],thresholds:o,dragStartTime:r,shouldUseTimeDampening:s,getAutoScrollerOptions:a})},V3=({container:e,subject:t,proposedScroll:r})=>{const n=t.height>e.height,s=t.width>e.width;return!s&&!n?r:s&&n?null:{x:s?0:r.x,y:n?0:r.y}};const Y3=nj(e=>e===0?0:e);var Rj=({dragStartTime:e,container:t,subject:r,center:n,shouldUseTimeDampening:s,getAutoScrollerOptions:a})=>{const o={top:n.y-t.top,right:t.right-n.x,bottom:t.bottom-n.y,left:n.x-t.left},l=Ny({container:t,distanceToEdges:o,dragStartTime:e,axis:pg,shouldUseTimeDampening:s,getAutoScrollerOptions:a}),c=Ny({container:t,distanceToEdges:o,dragStartTime:e,axis:lj,shouldUseTimeDampening:s,getAutoScrollerOptions:a}),u=Y3({x:c,y:l});if(ms(u,yt))return null;const d=V3({container:t,subject:r,proposedScroll:u});return d?ms(d,yt)?null:d:null};const G3=nj(e=>e===0?0:e>0?1:-1),kg=(()=>{const e=(t,r)=>t<0?t:t>r?t-r:0;return({current:t,max:r,change:n})=>{const s=vt(t,n),a={x:e(s.x,r.x),y:e(s.y,r.y)};return ms(a,yt)?null:a}})(),Mj=({max:e,current:t,change:r})=>{const n={x:Math.max(t.x,e.x),y:Math.max(t.y,e.y)},s=G3(r),a=kg({max:n,current:t,change:s});return!a||s.x!==0&&a.x===0||s.y!==0&&a.y===0},Ng=(e,t)=>Mj({current:e.scroll.current,max:e.scroll.max,change:t}),K3=(e,t)=>{if(!Ng(e,t))return null;const r=e.scroll.max,n=e.scroll.current;return kg({current:n,max:r,change:t})},Sg=(e,t)=>{const r=e.frame;return r?Mj({current:r.scroll.current,max:r.scroll.max,change:t}):!1},Q3=(e,t)=>{const r=e.frame;return!r||!Sg(e,t)?null:kg({current:r.scroll.current,max:r.scroll.max,change:t})};var J3=({viewport:e,subject:t,center:r,dragStartTime:n,shouldUseTimeDampening:s,getAutoScrollerOptions:a})=>{const o=Rj({dragStartTime:n,container:e.frame,subject:t,center:r,shouldUseTimeDampening:s,getAutoScrollerOptions:a});return o&&Ng(e,o)?o:null},X3=({droppable:e,subject:t,center:r,dragStartTime:n,shouldUseTimeDampening:s,getAutoScrollerOptions:a})=>{const o=e.frame;if(!o)return null;const l=Rj({dragStartTime:n,container:o.pageMarginBox,subject:t,center:r,shouldUseTimeDampening:s,getAutoScrollerOptions:a});return l&&Sg(e,l)?l:null},Sy=({state:e,dragStartTime:t,shouldUseTimeDampening:r,scrollWindow:n,scrollDroppable:s,getAutoScrollerOptions:a})=>{const o=e.current.page.borderBoxCenter,c=e.dimensions.draggables[e.critical.draggable.id].page.marginBox;if(e.isWindowScrollAllowed){const f=e.viewport,m=J3({dragStartTime:t,viewport:f,subject:c,center:o,shouldUseTimeDampening:r,getAutoScrollerOptions:a});if(m){n(m);return}}const u=z3({center:o,destination:ir(e.impact),droppables:e.dimensions.droppables});if(!u)return;const d=X3({dragStartTime:t,droppable:u,subject:c,center:o,shouldUseTimeDampening:r,getAutoScrollerOptions:a});d&&s(u.descriptor.id,d)},Z3=({scrollWindow:e,scrollDroppable:t,getAutoScrollerOptions:r=()=>ll})=>{const n=nl(e),s=nl(t);let a=null;const o=u=>{a||Z();const{shouldUseTimeDampening:d,dragStartTime:f}=a;Sy({state:u,scrollWindow:n,scrollDroppable:s,dragStartTime:f,shouldUseTimeDampening:d,getAutoScrollerOptions:r})};return{start:u=>{a&&Z();const d=Date.now();let f=!1;const m=()=>{f=!0};Sy({state:u,dragStartTime:0,shouldUseTimeDampening:!1,scrollWindow:m,scrollDroppable:m,getAutoScrollerOptions:r}),a={dragStartTime:d,shouldUseTimeDampening:f},f&&o(u)},stop:()=>{a&&(n.cancel(),s.cancel(),a=null)},scroll:o}},eL=({move:e,scrollDroppable:t,scrollWindow:r})=>{const n=(l,c)=>{const u=vt(l.current.client.selection,c);e({client:u})},s=(l,c)=>{if(!Sg(l,c))return c;const u=Q3(l,c);if(!u)return t(l.descriptor.id,c),null;const d=nr(c,u);return t(l.descriptor.id,d),nr(c,d)},a=(l,c,u)=>{if(!l||!Ng(c,u))return u;const d=K3(c,u);if(!d)return r(u),null;const f=nr(u,d);return r(f),nr(u,f)};return l=>{const c=l.scrollJumpRequest;if(!c)return;const u=ir(l.impact);u||Z();const d=s(l.dimensions.droppables[u],c);if(!d)return;const f=l.viewport,m=a(l.isWindowScrollAllowed,f,d);m&&n(l,m)}},tL=({scrollDroppable:e,scrollWindow:t,move:r,getAutoScrollerOptions:n})=>{const s=Z3({scrollWindow:t,scrollDroppable:e,getAutoScrollerOptions:n}),a=eL({move:r,scrollWindow:t,scrollDroppable:e});return{scroll:c=>{if(!(n().disabled||c.phase!=="DRAGGING")){if(c.movementMode==="FLUID"){s.scroll(c);return}c.scrollJumpRequest&&a(c)}},start:s.start,stop:s.stop}};const li="data-rfd",ci=(()=>{const e=`${li}-drag-handle`;return{base:e,draggableId:`${e}-draggable-id`,contextId:`${e}-context-id`}})(),Th=(()=>{const e=`${li}-draggable`;return{base:e,contextId:`${e}-context-id`,id:`${e}-id`}})(),rL=(()=>{const e=`${li}-droppable`;return{base:e,contextId:`${e}-context-id`,id:`${e}-id`}})(),Cy={contextId:`${li}-scroll-container-context-id`},nL=e=>t=>`[${t}="${e}"]`,Gi=(e,t)=>e.map(r=>{const n=r.styles[t];return n?`${r.selector} { ${n} }`:""}).join(" "),sL="pointer-events: none;";var aL=e=>{const t=nL(e),r=(()=>{const l=`
      cursor: -webkit-grab;
      cursor: grab;
    `;return{selector:t(ci.contextId),styles:{always:`
          -webkit-touch-callout: none;
          -webkit-tap-highlight-color: rgba(0,0,0,0);
          touch-action: manipulation;
        `,resting:l,dragging:sL,dropAnimating:l}}})(),n=(()=>{const l=`
      transition: ${Io.outOfTheWay};
    `;return{selector:t(Th.contextId),styles:{dragging:l,dropAnimating:l,userCancel:l}}})(),s={selector:t(rL.contextId),styles:{always:"overflow-anchor: none;"}},o=[n,r,s,{selector:"body",styles:{dragging:`
        cursor: grabbing;
        cursor: -webkit-grabbing;
        user-select: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        overflow-anchor: none;
      `}}];return{always:Gi(o,"always"),resting:Gi(o,"resting"),dragging:Gi(o,"dragging"),dropAnimating:Gi(o,"dropAnimating"),userCancel:Gi(o,"userCancel")}};const or=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?x.useLayoutEffect:x.useEffect,$f=()=>{const e=document.querySelector("head");return e||Z(),e},Ey=e=>{const t=document.createElement("style");return e&&t.setAttribute("nonce",e),t.type="text/css",t};function iL(e,t){const r=Ce(()=>aL(e),[e]),n=x.useRef(null),s=x.useRef(null),a=ce(xt(f=>{const m=s.current;m||Z(),m.textContent=f}),[]),o=ce(f=>{const m=n.current;m||Z(),m.textContent=f},[]);or(()=>{!n.current&&!s.current||Z();const f=Ey(t),m=Ey(t);return n.current=f,s.current=m,f.setAttribute(`${li}-always`,e),m.setAttribute(`${li}-dynamic`,e),$f().appendChild(f),$f().appendChild(m),o(r.always),a(r.resting),()=>{const h=y=>{const v=y.current;v||Z(),$f().removeChild(v),y.current=null};h(n),h(s)}},[t,o,a,r.always,r.resting,e]);const l=ce(()=>a(r.dragging),[a,r.dragging]),c=ce(f=>{if(f==="DROP"){a(r.dropAnimating);return}a(r.userCancel)},[a,r.dropAnimating,r.userCancel]),u=ce(()=>{s.current&&a(r.resting)},[a,r.resting]);return Ce(()=>({dragging:l,dropping:c,resting:u}),[l,c,u])}function Oj(e,t){return Array.from(e.querySelectorAll(t))}var Aj=e=>e&&e.ownerDocument&&e.ownerDocument.defaultView?e.ownerDocument.defaultView:window;function jd(e){return e instanceof Aj(e).HTMLElement}function oL(e,t){const r=`[${ci.contextId}="${e}"]`,n=Oj(document,r);if(!n.length)return null;const s=n.find(a=>a.getAttribute(ci.draggableId)===t);return!s||!jd(s)?null:s}function lL(e){const t=x.useRef({}),r=x.useRef(null),n=x.useRef(null),s=x.useRef(!1),a=ce(function(m,h){const y={id:m,focus:h};return t.current[m]=y,function(){const w=t.current;w[m]!==y&&delete w[m]}},[]),o=ce(function(m){const h=oL(e,m);h&&h!==document.activeElement&&h.focus()},[e]),l=ce(function(m,h){r.current===m&&(r.current=h)},[]),c=ce(function(){n.current||s.current&&(n.current=requestAnimationFrame(()=>{n.current=null;const m=r.current;m&&o(m)}))},[o]),u=ce(function(m){r.current=null;const h=document.activeElement;h&&h.getAttribute(ci.draggableId)===m&&(r.current=m)},[]);return or(()=>(s.current=!0,function(){s.current=!1;const m=n.current;m&&cancelAnimationFrame(m)}),[]),Ce(()=>({register:a,tryRecordFocus:u,tryRestoreFocusRecorded:c,tryShiftRecord:l}),[a,u,c,l])}function cL(){const e={draggables:{},droppables:{}},t=[];function r(f){return t.push(f),function(){const h=t.indexOf(f);h!==-1&&t.splice(h,1)}}function n(f){t.length&&t.forEach(m=>m(f))}function s(f){return e.draggables[f]||null}function a(f){const m=s(f);return m||Z(),m}const o={register:f=>{e.draggables[f.descriptor.id]=f,n({type:"ADDITION",value:f})},update:(f,m)=>{const h=e.draggables[m.descriptor.id];h&&h.uniqueId===f.uniqueId&&(delete e.draggables[m.descriptor.id],e.draggables[f.descriptor.id]=f)},unregister:f=>{const m=f.descriptor.id,h=s(m);h&&f.uniqueId===h.uniqueId&&(delete e.draggables[m],e.droppables[f.descriptor.droppableId]&&n({type:"REMOVAL",value:f}))},getById:a,findById:s,exists:f=>!!s(f),getAllByType:f=>Object.values(e.draggables).filter(m=>m.descriptor.type===f)};function l(f){return e.droppables[f]||null}function c(f){const m=l(f);return m||Z(),m}const u={register:f=>{e.droppables[f.descriptor.id]=f},unregister:f=>{const m=l(f.descriptor.id);m&&f.uniqueId===m.uniqueId&&delete e.droppables[f.descriptor.id]},getById:c,findById:l,exists:f=>!!l(f),getAllByType:f=>Object.values(e.droppables).filter(m=>m.descriptor.type===f)};function d(){e.draggables={},e.droppables={},t.length=0}return{draggable:o,droppable:u,subscribe:r,clean:d}}function uL(){const e=Ce(cL,[]);return x.useEffect(()=>function(){e.clean()},[e]),e}var Cg=H.createContext(null),Lu=()=>{const e=document.body;return e||Z(),e};const dL={position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",overflow:"hidden",clip:"rect(0 0 0 0)","clip-path":"inset(100%)"},fL=e=>`rfd-announcement-${e}`;function mL(e){const t=Ce(()=>fL(e),[e]),r=x.useRef(null);return x.useEffect(function(){const a=document.createElement("div");return r.current=a,a.id=t,a.setAttribute("aria-live","assertive"),a.setAttribute("aria-atomic","true"),Eu(a.style,dL),Lu().appendChild(a),function(){setTimeout(function(){const c=Lu();c.contains(a)&&c.removeChild(a),a===r.current&&(r.current=null)})}},[t]),ce(s=>{const a=r.current;if(a){a.textContent=s;return}},[])}const hL={separator:"::"};function Eg(e,t=hL){const r=H.useId();return Ce(()=>`${e}${t.separator}${r}`,[t.separator,e,r])}function pL({contextId:e,uniqueId:t}){return`rfd-hidden-text-${e}-${t}`}function gL({contextId:e,text:t}){const r=Eg("hidden-text",{separator:"-"}),n=Ce(()=>pL({contextId:e,uniqueId:r}),[r,e]);return x.useEffect(function(){const a=document.createElement("div");return a.id=n,a.textContent=t,a.style.display="none",Lu().appendChild(a),function(){const l=Lu();l.contains(a)&&l.removeChild(a)}},[n,t]),n}var kd=H.createContext(null);function $j(e){const t=x.useRef(e);return x.useEffect(()=>{t.current=e}),t}function xL(){let e=null;function t(){return!!e}function r(o){return o===e}function n(o){e&&Z();const l={abandon:o};return e=l,l}function s(){e||Z(),e=null}function a(){e&&(e.abandon(),s())}return{isClaimed:t,isActive:r,claim:n,release:s,tryAbandon:a}}function cl(e){return e.phase==="IDLE"||e.phase==="DROP_ANIMATING"?!1:e.isDragging}const yL=9,bL=13,Dg=27,Fj=32,vL=33,wL=34,_L=35,jL=36,kL=37,NL=38,SL=39,CL=40,EL={[bL]:!0,[yL]:!0};var Bj=e=>{EL[e.keyCode]&&e.preventDefault()};const Nd=(()=>{const e="visibilitychange";return typeof document>"u"?e:[e,`ms${e}`,`webkit${e}`,`moz${e}`,`o${e}`].find(n=>`on${n}`in document)||e})(),Uj=0,Dy=5;function DL(e,t){return Math.abs(t.x-e.x)>=Dy||Math.abs(t.y-e.y)>=Dy}const Py={type:"IDLE"};function PL({cancel:e,completed:t,getPhase:r,setPhase:n}){return[{eventName:"mousemove",fn:s=>{const{button:a,clientX:o,clientY:l}=s;if(a!==Uj)return;const c={x:o,y:l},u=r();if(u.type==="DRAGGING"){s.preventDefault(),u.actions.move(c);return}u.type!=="PENDING"&&Z();const d=u.point;if(!DL(d,c))return;s.preventDefault();const f=u.actions.fluidLift(c);n({type:"DRAGGING",actions:f})}},{eventName:"mouseup",fn:s=>{const a=r();if(a.type!=="DRAGGING"){e();return}s.preventDefault(),a.actions.drop({shouldBlockNextClick:!0}),t()}},{eventName:"mousedown",fn:s=>{r().type==="DRAGGING"&&s.preventDefault(),e()}},{eventName:"keydown",fn:s=>{if(r().type==="PENDING"){e();return}if(s.keyCode===Dg){s.preventDefault(),e();return}Bj(s)}},{eventName:"resize",fn:e},{eventName:"scroll",options:{passive:!0,capture:!1},fn:()=>{r().type==="PENDING"&&e()}},{eventName:"webkitmouseforcedown",fn:s=>{const a=r();if(a.type==="IDLE"&&Z(),a.actions.shouldRespectForcePress()){e();return}s.preventDefault()}},{eventName:Nd,fn:e}]}function TL(e){const t=x.useRef(Py),r=x.useRef(fs),n=Ce(()=>({eventName:"mousedown",fn:function(f){if(f.defaultPrevented||f.button!==Uj||f.ctrlKey||f.metaKey||f.shiftKey||f.altKey)return;const m=e.findClosestDraggableId(f);if(!m)return;const h=e.tryGetLock(m,o,{sourceEvent:f});if(!h)return;f.preventDefault();const y={x:f.clientX,y:f.clientY};r.current(),u(h,y)}}),[e]),s=Ce(()=>({eventName:"webkitmouseforcewillbegin",fn:d=>{if(d.defaultPrevented)return;const f=e.findClosestDraggableId(d);if(!f)return;const m=e.findOptionsForDraggable(f);m&&(m.shouldRespectForcePress||e.canGetLock(f)&&d.preventDefault())}}),[e]),a=ce(function(){const f={passive:!1,capture:!0};r.current=wr(window,[s,n],f)},[s,n]),o=ce(()=>{t.current.type!=="IDLE"&&(t.current=Py,r.current(),a())},[a]),l=ce(()=>{const d=t.current;o(),d.type==="DRAGGING"&&d.actions.cancel({shouldBlockNextClick:!0}),d.type==="PENDING"&&d.actions.abort()},[o]),c=ce(function(){const f={capture:!0,passive:!1},m=PL({cancel:l,completed:o,getPhase:()=>t.current,setPhase:h=>{t.current=h}});r.current=wr(window,m,f)},[l,o]),u=ce(function(f,m){t.current.type!=="IDLE"&&Z(),t.current={type:"PENDING",point:m,actions:f},c()},[c]);or(function(){return a(),function(){r.current()}},[a])}function LL(){}const IL={[wL]:!0,[vL]:!0,[jL]:!0,[_L]:!0};function RL(e,t){function r(){t(),e.cancel()}function n(){t(),e.drop()}return[{eventName:"keydown",fn:s=>{if(s.keyCode===Dg){s.preventDefault(),r();return}if(s.keyCode===Fj){s.preventDefault(),n();return}if(s.keyCode===CL){s.preventDefault(),e.moveDown();return}if(s.keyCode===NL){s.preventDefault(),e.moveUp();return}if(s.keyCode===SL){s.preventDefault(),e.moveRight();return}if(s.keyCode===kL){s.preventDefault(),e.moveLeft();return}if(IL[s.keyCode]){s.preventDefault();return}Bj(s)}},{eventName:"mousedown",fn:r},{eventName:"mouseup",fn:r},{eventName:"click",fn:r},{eventName:"touchstart",fn:r},{eventName:"resize",fn:r},{eventName:"wheel",fn:r,options:{passive:!0}},{eventName:Nd,fn:r}]}function ML(e){const t=x.useRef(LL),r=Ce(()=>({eventName:"keydown",fn:function(a){if(a.defaultPrevented||a.keyCode!==Fj)return;const o=e.findClosestDraggableId(a);if(!o)return;const l=e.tryGetLock(o,d,{sourceEvent:a});if(!l)return;a.preventDefault();let c=!0;const u=l.snapLift();t.current();function d(){c||Z(),c=!1,t.current(),n()}t.current=wr(window,RL(u,d),{capture:!0,passive:!1})}}),[e]),n=ce(function(){const a={passive:!1,capture:!0};t.current=wr(window,[r],a)},[r]);or(function(){return n(),function(){t.current()}},[n])}const Ff={type:"IDLE"},OL=120,AL=.15;function $L({cancel:e,getPhase:t}){return[{eventName:"orientationchange",fn:e},{eventName:"resize",fn:e},{eventName:"contextmenu",fn:r=>{r.preventDefault()}},{eventName:"keydown",fn:r=>{if(t().type!=="DRAGGING"){e();return}r.keyCode===Dg&&r.preventDefault(),e()}},{eventName:Nd,fn:e}]}function FL({cancel:e,completed:t,getPhase:r}){return[{eventName:"touchmove",options:{capture:!1},fn:n=>{const s=r();if(s.type!=="DRAGGING"){e();return}s.hasMoved=!0;const{clientX:a,clientY:o}=n.touches[0],l={x:a,y:o};n.preventDefault(),s.actions.move(l)}},{eventName:"touchend",fn:n=>{const s=r();if(s.type!=="DRAGGING"){e();return}n.preventDefault(),s.actions.drop({shouldBlockNextClick:!0}),t()}},{eventName:"touchcancel",fn:n=>{if(r().type!=="DRAGGING"){e();return}n.preventDefault(),e()}},{eventName:"touchforcechange",fn:n=>{const s=r();s.type==="IDLE"&&Z();const a=n.touches[0];if(!a||!(a.force>=AL))return;const l=s.actions.shouldRespectForcePress();if(s.type==="PENDING"){l&&e();return}if(l){if(s.hasMoved){n.preventDefault();return}e();return}n.preventDefault()}},{eventName:Nd,fn:e}]}function BL(e){const t=x.useRef(Ff),r=x.useRef(fs),n=ce(function(){return t.current},[]),s=ce(function(h){t.current=h},[]),a=Ce(()=>({eventName:"touchstart",fn:function(h){if(h.defaultPrevented)return;const y=e.findClosestDraggableId(h);if(!y)return;const v=e.tryGetLock(y,l,{sourceEvent:h});if(!v)return;const w=h.touches[0],{clientX:g,clientY:b}=w,p={x:g,y:b};r.current(),f(v,p)}}),[e]),o=ce(function(){const h={capture:!0,passive:!1};r.current=wr(window,[a],h)},[a]),l=ce(()=>{const m=t.current;m.type!=="IDLE"&&(m.type==="PENDING"&&clearTimeout(m.longPressTimerId),s(Ff),r.current(),o())},[o,s]),c=ce(()=>{const m=t.current;l(),m.type==="DRAGGING"&&m.actions.cancel({shouldBlockNextClick:!0}),m.type==="PENDING"&&m.actions.abort()},[l]),u=ce(function(){const h={capture:!0,passive:!1},y={cancel:c,completed:l,getPhase:n},v=wr(window,FL(y),h),w=wr(window,$L(y),h);r.current=function(){v(),w()}},[c,n,l]),d=ce(function(){const h=n();h.type!=="PENDING"&&Z();const y=h.actions.fluidLift(h.point);s({type:"DRAGGING",actions:y,hasMoved:!1})},[n,s]),f=ce(function(h,y){n().type!=="IDLE"&&Z();const v=setTimeout(d,OL);s({type:"PENDING",point:y,actions:h,longPressTimerId:v}),u()},[u,n,s,d]);or(function(){return o(),function(){r.current();const y=n();y.type==="PENDING"&&(clearTimeout(y.longPressTimerId),s(Ff))}},[n,o,s]),or(function(){return wr(window,[{eventName:"touchmove",fn:()=>{},options:{capture:!1,passive:!1}}])},[])}const UL=["input","button","textarea","select","option","optgroup","video","audio"];function zj(e,t){if(t==null)return!1;if(UL.includes(t.tagName.toLowerCase()))return!0;const n=t.getAttribute("contenteditable");return n==="true"||n===""?!0:t===e?!1:zj(e,t.parentElement)}function zL(e,t){const r=t.target;return jd(r)?zj(e,r):!1}var WL=e=>Or(e.getBoundingClientRect()).center;function HL(e){return e instanceof Aj(e).Element}const qL=(()=>{const e="matches";return typeof document>"u"?e:[e,"msMatchesSelector","webkitMatchesSelector"].find(n=>n in Element.prototype)||e})();function Wj(e,t){return e==null?null:e[qL](t)?e:Wj(e.parentElement,t)}function VL(e,t){return e.closest?e.closest(t):Wj(e,t)}function YL(e){return`[${ci.contextId}="${e}"]`}function GL(e,t){const r=t.target;if(!HL(r))return null;const n=YL(e),s=VL(r,n);return!s||!jd(s)?null:s}function KL(e,t){const r=GL(e,t);return r?r.getAttribute(ci.draggableId):null}function QL(e,t){const r=`[${Th.contextId}="${e}"]`,s=Oj(document,r).find(a=>a.getAttribute(Th.id)===t);return!s||!jd(s)?null:s}function JL(e){e.preventDefault()}function oc({expected:e,phase:t,isLockActive:r,shouldWarn:n}){return!(!r()||e!==t)}function Hj({lockAPI:e,store:t,registry:r,draggableId:n}){if(e.isClaimed())return!1;const s=r.draggable.findById(n);return!(!s||!s.options.isEnabled||!Lj(t.getState(),n))}function XL({lockAPI:e,contextId:t,store:r,registry:n,draggableId:s,forceSensorStop:a,sourceEvent:o}){if(!Hj({lockAPI:e,store:r,registry:n,draggableId:s}))return null;const c=n.draggable.getById(s),u=QL(t,c.descriptor.id);if(!u||o&&!c.options.canDragInteractiveElements&&zL(u,o))return null;const d=e.claim(a||fs);let f="PRE_DRAG";function m(){return c.options.shouldRespectForcePress}function h(){return e.isActive(d)}function y(j,k){oc({expected:j,phase:f,isLockActive:h,shouldWarn:!0})&&r.dispatch(k())}const v=y.bind(null,"DRAGGING");function w(j){function k(){e.release(),f="COMPLETED"}f!=="PRE_DRAG"&&(k(),Z()),r.dispatch(VT(j.liftActionArgs)),f="DRAGGING";function N(S,C={shouldBlockNextClick:!1}){if(j.cleanup(),C.shouldBlockNextClick){const E=wr(window,[{eventName:"click",fn:JL,options:{once:!0,passive:!1,capture:!0}}]);setTimeout(E)}k(),r.dispatch(kj({reason:S}))}return{isActive:()=>oc({expected:"DRAGGING",phase:f,isLockActive:h,shouldWarn:!1}),shouldRespectForcePress:m,drop:S=>N("DROP",S),cancel:S=>N("CANCEL",S),...j.actions}}function g(j){const k=nl(S=>{v(()=>jj({client:S}))});return{...w({liftActionArgs:{id:s,clientSelection:j,movementMode:"FLUID"},cleanup:()=>k.cancel(),actions:{move:k}}),move:k}}function b(){const j={moveUp:()=>v(t3),moveRight:()=>v(n3),moveDown:()=>v(r3),moveLeft:()=>v(s3)};return w({liftActionArgs:{id:s,clientSelection:WL(u),movementMode:"SNAP"},cleanup:fs,actions:j})}function p(){oc({expected:"PRE_DRAG",phase:f,isLockActive:h,shouldWarn:!0})&&e.release()}return{isActive:()=>oc({expected:"PRE_DRAG",phase:f,isLockActive:h,shouldWarn:!1}),shouldRespectForcePress:m,fluidLift:g,snapLift:b,abort:p}}const ZL=[TL,ML,BL];function eI({contextId:e,store:t,registry:r,customSensors:n,enableDefaultSensors:s}){const a=[...s?ZL:[],...n||[]],o=x.useState(()=>xL())[0],l=ce(function(w,g){cl(w)&&!cl(g)&&o.tryAbandon()},[o]);or(function(){let w=t.getState();return t.subscribe(()=>{const b=t.getState();l(w,b),w=b})},[o,t,l]),or(()=>o.tryAbandon,[o.tryAbandon]);const c=ce(v=>Hj({lockAPI:o,registry:r,store:t,draggableId:v}),[o,r,t]),u=ce((v,w,g)=>XL({lockAPI:o,registry:r,contextId:e,store:t,draggableId:v,forceSensorStop:w||null,sourceEvent:g&&g.sourceEvent?g.sourceEvent:null}),[e,o,r,t]),d=ce(v=>KL(e,v),[e]),f=ce(v=>{const w=r.draggable.findById(v);return w?w.options:null},[r.draggable]),m=ce(function(){o.isClaimed()&&(o.tryAbandon(),t.getState().phase!=="IDLE"&&t.dispatch(vg()))},[o,t]),h=ce(()=>o.isClaimed(),[o]),y=Ce(()=>({canGetLock:c,tryGetLock:u,findClosestDraggableId:d,findOptionsForDraggable:f,tryReleaseLock:m,isLockClaimed:h}),[c,u,d,f,m,h]);for(let v=0;v<a.length;v++)a[v](y)}const tI=e=>({onBeforeCapture:t=>{const r=()=>{e.onBeforeCapture&&e.onBeforeCapture(t)};wl.flushSync(r)},onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragEnd:e.onDragEnd,onDragUpdate:e.onDragUpdate}),rI=e=>({...ll,...e.autoScrollerOptions,durationDampening:{...ll.durationDampening,...e.autoScrollerOptions}});function Ki(e){return e.current||Z(),e.current}function nI(e){const{contextId:t,setCallbacks:r,sensors:n,nonce:s,dragHandleUsageInstructions:a}=e,o=x.useRef(null),l=$j(e),c=ce(()=>tI(l.current),[l]),u=ce(()=>rI(l.current),[l]),d=mL(t),f=gL({contextId:t,text:a}),m=iL(t,s),h=ce(E=>{Ki(o).dispatch(E)},[]),y=Ce(()=>sy({publishWhileDragging:GT,updateDroppableScroll:QT,updateDroppableIsEnabled:JT,updateDroppableIsCombineEnabled:XT,collectionStarting:KT},h),[h]),v=uL(),w=Ce(()=>$3(v,y),[v,y]),g=Ce(()=>tL({scrollWindow:F3,scrollDroppable:w.scrollDroppable,getAutoScrollerOptions:u,...sy({move:jj},h)}),[w.scrollDroppable,h,u]),b=lL(t),p=Ce(()=>R3({announce:d,autoScroller:g,dimensionMarshal:w,focusMarshal:b,getResponders:c,styleMarshal:m}),[d,g,w,b,c,m]);o.current=p;const _=ce(()=>{const E=Ki(o);E.getState().phase!=="IDLE"&&E.dispatch(vg())},[]),j=ce(()=>{const E=Ki(o).getState();return E.phase==="DROP_ANIMATING"?!0:E.phase==="IDLE"?!1:E.isDragging},[]),k=Ce(()=>({isDragging:j,tryAbort:_}),[j,_]);r(k);const N=ce(E=>Lj(Ki(o).getState(),E),[]),S=ce(()=>As(Ki(o).getState()),[]),C=Ce(()=>({marshal:w,focus:b,contextId:t,canLift:N,isMovementAllowed:S,dragHandleUsageInstructionsId:f,registry:v}),[t,w,f,b,N,S,v]);return eI({contextId:t,store:p,registry:v,customSensors:n||null,enableDefaultSensors:e.enableDefaultSensors!==!1}),x.useEffect(()=>_,[_]),H.createElement(kd.Provider,{value:C},H.createElement(C5,{context:Cg,store:p},e.children))}function sI(){return H.useId()}function aI(e){const t=sI(),r=e.dragHandleUsageInstructions||Uc.dragHandleUsageInstructions;return H.createElement(M5,null,n=>H.createElement(nI,{nonce:e.nonce,contextId:t,setCallbacks:n,dragHandleUsageInstructions:r,enableDefaultSensors:e.enableDefaultSensors,sensors:e.sensors,onBeforeCapture:e.onBeforeCapture,onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragUpdate:e.onDragUpdate,onDragEnd:e.onDragEnd,autoScrollerOptions:e.autoScrollerOptions},e.children))}const Ty={dragging:5e3,dropAnimating:4500},iI=(e,t)=>t?Io.drop(t.duration):e?Io.snap:Io.fluid,oI=(e,t)=>{if(e)return t?ol.opacity.drop:ol.opacity.combining},lI=e=>e.forceShouldAnimate!=null?e.forceShouldAnimate:e.mode==="SNAP";function cI(e){const r=e.dimension.client,{offset:n,combineWith:s,dropping:a}=e,o=!!s,l=lI(e),c=!!a,u=c?Dh.drop(n,o):Dh.moveTo(n);return{position:"fixed",top:r.marginBox.top,left:r.marginBox.left,boxSizing:"border-box",width:r.borderBox.width,height:r.borderBox.height,transition:iI(l,a),transform:u,opacity:oI(o,c),zIndex:c?Ty.dropAnimating:Ty.dragging,pointerEvents:"none"}}function uI(e){return{transform:Dh.moveTo(e.offset),transition:e.shouldAnimateDisplacement?void 0:"none"}}function dI(e){return e.type==="DRAGGING"?cI(e):uI(e)}function fI(e,t,r=yt){const n=window.getComputedStyle(t),s=t.getBoundingClientRect(),a=J1(s,n),o=Cu(a,r),l={client:a,tagName:t.tagName.toLowerCase(),display:n.display},c={x:a.marginBox.width,y:a.marginBox.height};return{descriptor:e,placeholder:l,displaceBy:c,client:a,page:o}}function mI(e){const t=Eg("draggable"),{descriptor:r,registry:n,getDraggableRef:s,canDragInteractiveElements:a,shouldRespectForcePress:o,isEnabled:l}=e,c=Ce(()=>({canDragInteractiveElements:a,shouldRespectForcePress:o,isEnabled:l}),[a,l,o]),u=ce(h=>{const y=s();return y||Z(),fI(r,y,h)},[r,s]),d=Ce(()=>({uniqueId:t,descriptor:r,options:c,getDimension:u}),[r,u,c,t]),f=x.useRef(d),m=x.useRef(!0);or(()=>(n.draggable.register(f.current),()=>n.draggable.unregister(f.current)),[n.draggable]),or(()=>{if(m.current){m.current=!1;return}const h=f.current;f.current=d,n.draggable.update(d,h)},[d,n.draggable])}var Pg=H.createContext(null);function Iu(e){const t=x.useContext(e);return t||Z(),t}function hI(e){e.preventDefault()}const pI=e=>{const t=x.useRef(null),r=ce((k=null)=>{t.current=k},[]),n=ce(()=>t.current,[]),{contextId:s,dragHandleUsageInstructionsId:a,registry:o}=Iu(kd),{type:l,droppableId:c}=Iu(Pg),u=Ce(()=>({id:e.draggableId,index:e.index,type:l,droppableId:c}),[e.draggableId,e.index,l,c]),{children:d,draggableId:f,isEnabled:m,shouldRespectForcePress:h,canDragInteractiveElements:y,isClone:v,mapped:w,dropAnimationFinished:g}=e;if(!v){const k=Ce(()=>({descriptor:u,registry:o,getDraggableRef:n,canDragInteractiveElements:y,shouldRespectForcePress:h,isEnabled:m}),[u,o,n,y,h,m]);mI(k)}const b=Ce(()=>m?{tabIndex:0,role:"button","aria-describedby":a,"data-rfd-drag-handle-draggable-id":f,"data-rfd-drag-handle-context-id":s,draggable:!1,onDragStart:hI}:null,[s,a,f,m]),p=ce(k=>{w.type==="DRAGGING"&&w.dropping&&k.propertyName==="transform"&&wl.flushSync(g)},[g,w]),_=Ce(()=>{const k=dI(w),N=w.type==="DRAGGING"&&w.dropping?p:void 0;return{innerRef:r,draggableProps:{"data-rfd-draggable-context-id":s,"data-rfd-draggable-id":f,style:k,onTransitionEnd:N},dragHandleProps:b}},[s,b,f,w,p,r]),j=Ce(()=>({draggableId:u.id,type:u.type,source:{index:u.index,droppableId:u.droppableId}}),[u.droppableId,u.id,u.index,u.type]);return H.createElement(H.Fragment,null,d(_,w.snapshot,j))};var qj=(e,t)=>e===t,Vj=e=>{const{combine:t,destination:r}=e;return r?r.droppableId:t?t.droppableId:null};const gI=e=>e.combine?e.combine.draggableId:null,xI=e=>e.at&&e.at.type==="COMBINE"?e.at.combine.draggableId:null;function yI(){const e=xt((s,a)=>({x:s,y:a})),t=xt((s,a,o=null,l=null,c=null)=>({isDragging:!0,isClone:a,isDropAnimating:!!c,dropAnimation:c,mode:s,draggingOver:o,combineWith:l,combineTargetFor:null})),r=xt((s,a,o,l,c=null,u=null,d=null)=>({mapped:{type:"DRAGGING",dropping:null,draggingOver:c,combineWith:u,mode:a,offset:s,dimension:o,forceShouldAnimate:d,snapshot:t(a,l,c,u,null)}}));return(s,a)=>{if(cl(s)){if(s.critical.draggable.id!==a.draggableId)return null;const o=s.current.client.offset,l=s.dimensions.draggables[a.draggableId],c=ir(s.impact),u=xI(s.impact),d=s.forceShouldAnimate;return r(e(o.x,o.y),s.movementMode,l,a.isClone,c,u,d)}if(s.phase==="DROP_ANIMATING"){const o=s.completed;if(o.result.draggableId!==a.draggableId)return null;const l=a.isClone,c=s.dimensions.draggables[a.draggableId],u=o.result,d=u.mode,f=Vj(u),m=gI(u),y={duration:s.dropDuration,curve:_g.drop,moveTo:s.newHomeClientOffset,opacity:m?ol.opacity.drop:null,scale:m?ol.scale.drop:null};return{mapped:{type:"DRAGGING",offset:s.newHomeClientOffset,dimension:c,dropping:y,draggingOver:f,combineWith:m,mode:d,forceShouldAnimate:null,snapshot:t(d,l,f,m,y)}}}return null}}function Yj(e=null){return{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,mode:null,draggingOver:null,combineTargetFor:e,combineWith:null}}const bI={mapped:{type:"SECONDARY",offset:yt,combineTargetFor:null,shouldAnimateDisplacement:!0,snapshot:Yj(null)}};function vI(){const e=xt((o,l)=>({x:o,y:l})),t=xt(Yj),r=xt((o,l=null,c)=>({mapped:{type:"SECONDARY",offset:o,combineTargetFor:l,shouldAnimateDisplacement:c,snapshot:t(l)}})),n=o=>o?r(yt,o,!0):null,s=(o,l,c,u)=>{const d=c.displaced.visible[o],f=!!(u.inVirtualList&&u.effected[o]),m=vd(c),h=m&&m.draggableId===o?l:null;if(!d){if(!f)return n(h);if(c.displaced.invisible[o])return null;const w=Ei(u.displacedBy.point),g=e(w.x,w.y);return r(g,h,!0)}if(f)return n(h);const y=c.displacedBy.point,v=e(y.x,y.y);return r(v,h,d.shouldAnimate)};return(o,l)=>{if(cl(o))return o.critical.draggable.id===l.draggableId?null:s(l.draggableId,o.critical.draggable.id,o.impact,o.afterCritical);if(o.phase==="DROP_ANIMATING"){const c=o.completed;return c.result.draggableId===l.draggableId?null:s(l.draggableId,c.result.draggableId,c.impact,c.afterCritical)}return null}}const wI=()=>{const e=yI(),t=vI();return(n,s)=>e(n,s)||t(n,s)||bI},_I={dropAnimationFinished:Nj},jI=Q1(wI,_I,null,{context:Cg,areStatePropsEqual:qj})(pI);function Gj(e){return Iu(Pg).isUsingCloneFor===e.draggableId&&!e.isClone?null:H.createElement(jI,e)}function kI(e){const t=typeof e.isDragDisabled=="boolean"?!e.isDragDisabled:!0,r=!!e.disableInteractiveElementBlocking,n=!!e.shouldRespectForcePress;return H.createElement(Gj,Eu({},e,{isClone:!1,isEnabled:t,canDragInteractiveElements:r,shouldRespectForcePress:n}))}const Kj=e=>t=>e===t,NI=Kj("scroll"),SI=Kj("auto"),Ly=(e,t)=>t(e.overflowX)||t(e.overflowY),CI=e=>{const t=window.getComputedStyle(e),r={overflowX:t.overflowX,overflowY:t.overflowY};return Ly(r,NI)||Ly(r,SI)},EI=()=>!1,Qj=e=>e==null?null:e===document.body?EI()?e:null:e===document.documentElement?null:CI(e)?e:Qj(e.parentElement);var Lh=e=>({x:e.scrollLeft,y:e.scrollTop});const Jj=e=>e?window.getComputedStyle(e).position==="fixed"?!0:Jj(e.parentElement):!1;var DI=e=>{const t=Qj(e),r=Jj(e);return{closestScrollable:t,isFixedOnPage:r}},PI=({descriptor:e,isEnabled:t,isCombineEnabled:r,isFixedOnPage:n,direction:s,client:a,page:o,closest:l})=>{const c=(()=>{if(!l)return null;const{scrollSize:m,client:h}=l,y=Dj({scrollHeight:m.scrollHeight,scrollWidth:m.scrollWidth,height:h.paddingBox.height,width:h.paddingBox.width});return{pageMarginBox:l.page.marginBox,frameClient:h,scrollSize:m,shouldClipSubject:l.shouldClipSubject,scroll:{initial:l.scroll,current:l.scroll,max:y,diff:{value:yt,displacement:yt}}}})(),u=s==="vertical"?pg:lj,d=oi({page:o,withPlaceholder:null,axis:u,frame:c});return{descriptor:e,isCombineEnabled:r,isFixedOnPage:n,axis:u,isEnabled:t,client:a,page:o,frame:c,subject:d}};const TI=(e,t)=>{const r=X1(e);if(!t||e!==t)return r;const n=r.paddingBox.top-t.scrollTop,s=r.paddingBox.left-t.scrollLeft,a=n+t.scrollHeight,o=s+t.scrollWidth,c=dg({top:n,right:o,bottom:a,left:s},r.border);return fg({borderBox:c,margin:r.margin,border:r.border,padding:r.padding})};var LI=({ref:e,descriptor:t,env:r,windowScroll:n,direction:s,isDropDisabled:a,isCombineEnabled:o,shouldClipSubject:l})=>{const c=r.closestScrollable,u=TI(e,c),d=Cu(u,n),f=(()=>{if(!c)return null;const h=X1(c),y={scrollHeight:c.scrollHeight,scrollWidth:c.scrollWidth};return{client:h,page:Cu(h,n),scroll:Lh(c),scrollSize:y,shouldClipSubject:l}})();return PI({descriptor:t,isEnabled:!a,isCombineEnabled:o,isFixedOnPage:r.isFixedOnPage,direction:s,client:u,page:d,closest:f})};const II={passive:!1},RI={passive:!0};var Iy=e=>e.shouldPublishImmediately?II:RI;const lc=e=>e&&e.env.closestScrollable||null;function MI(e){const t=x.useRef(null),r=Iu(kd),n=Eg("droppable"),{registry:s,marshal:a}=r,o=$j(e),l=Ce(()=>({id:e.droppableId,type:e.type,mode:e.mode}),[e.droppableId,e.mode,e.type]),c=x.useRef(l),u=Ce(()=>xt((_,j)=>{t.current||Z();const k={x:_,y:j};a.updateDroppableScroll(l.id,k)}),[l.id,a]),d=ce(()=>{const _=t.current;return!_||!_.env.closestScrollable?yt:Lh(_.env.closestScrollable)},[]),f=ce(()=>{const _=d();u(_.x,_.y)},[d,u]),m=Ce(()=>nl(f),[f]),h=ce(()=>{const _=t.current,j=lc(_);if(_&&j||Z(),_.scrollOptions.shouldPublishImmediately){f();return}m()},[m,f]),y=ce((_,j)=>{t.current&&Z();const k=o.current,N=k.getDroppableRef();N||Z();const S=DI(N),C={ref:N,descriptor:l,env:S,scrollOptions:j};t.current=C;const E=LI({ref:N,descriptor:l,env:S,windowScroll:_,direction:k.direction,isDropDisabled:k.isDropDisabled,isCombineEnabled:k.isCombineEnabled,shouldClipSubject:!k.ignoreContainerClipping}),T=S.closestScrollable;return T&&(T.setAttribute(Cy.contextId,r.contextId),T.addEventListener("scroll",h,Iy(C.scrollOptions))),E},[r.contextId,l,h,o]),v=ce(()=>{const _=t.current,j=lc(_);return _&&j||Z(),Lh(j)},[]),w=ce(()=>{const _=t.current;_||Z();const j=lc(_);t.current=null,j&&(m.cancel(),j.removeAttribute(Cy.contextId),j.removeEventListener("scroll",h,Iy(_.scrollOptions)))},[h,m]),g=ce(_=>{const j=t.current;j||Z();const k=lc(j);k||Z(),k.scrollTop+=_.y,k.scrollLeft+=_.x},[]),b=Ce(()=>({getDimensionAndWatchScroll:y,getScrollWhileDragging:v,dragStopped:w,scroll:g}),[w,y,v,g]),p=Ce(()=>({uniqueId:n,descriptor:l,callbacks:b}),[b,l,n]);or(()=>(c.current=p.descriptor,s.droppable.register(p),()=>{t.current&&w(),s.droppable.unregister(p)}),[b,l,w,p,a,s.droppable]),or(()=>{t.current&&a.updateDroppableIsEnabled(c.current.id,!e.isDropDisabled)},[e.isDropDisabled,a]),or(()=>{t.current&&a.updateDroppableIsCombineEnabled(c.current.id,e.isCombineEnabled)},[e.isCombineEnabled,a])}function Bf(){}const Ry={width:0,height:0,margin:z5},OI=({isAnimatingOpenOnMount:e,placeholder:t,animate:r})=>e||r==="close"?Ry:{height:t.client.borderBox.height,width:t.client.borderBox.width,margin:t.client.margin},AI=({isAnimatingOpenOnMount:e,placeholder:t,animate:r})=>{const n=OI({isAnimatingOpenOnMount:e,placeholder:t,animate:r});return{display:t.display,boxSizing:"border-box",width:n.width,height:n.height,marginTop:n.margin.top,marginRight:n.margin.right,marginBottom:n.margin.bottom,marginLeft:n.margin.left,flexShrink:"0",flexGrow:"0",pointerEvents:"none",transition:r!=="none"?Io.placeholder:null}},$I=e=>{const t=x.useRef(null),r=ce(()=>{t.current&&(clearTimeout(t.current),t.current=null)},[]),{animate:n,onTransitionEnd:s,onClose:a,contextId:o}=e,[l,c]=x.useState(e.animate==="open");x.useEffect(()=>l?n!=="open"?(r(),c(!1),Bf):t.current?Bf:(t.current=setTimeout(()=>{t.current=null,c(!1)}),r):Bf,[n,l,r]);const u=ce(f=>{f.propertyName==="height"&&(s(),n==="close"&&a())},[n,a,s]),d=AI({isAnimatingOpenOnMount:l,animate:e.animate,placeholder:e.placeholder});return H.createElement(e.placeholder.tagName,{style:d,"data-rfd-placeholder-context-id":o,onTransitionEnd:u,ref:e.innerRef})};var FI=H.memo($I);class BI extends H.PureComponent{constructor(...t){super(...t),this.state={isVisible:!!this.props.on,data:this.props.on,animate:this.props.shouldAnimate&&this.props.on?"open":"none"},this.onClose=()=>{this.state.animate==="close"&&this.setState({isVisible:!1})}}static getDerivedStateFromProps(t,r){return t.shouldAnimate?t.on?{isVisible:!0,data:t.on,animate:"open"}:r.isVisible?{isVisible:!0,data:r.data,animate:"close"}:{isVisible:!1,animate:"close",data:null}:{isVisible:!!t.on,data:t.on,animate:"none"}}render(){if(!this.state.isVisible)return null;const t={onClose:this.onClose,data:this.state.data,animate:this.state.animate};return this.props.children(t)}}const UI=e=>{const t=x.useContext(kd);t||Z();const{contextId:r,isMovementAllowed:n}=t,s=x.useRef(null),a=x.useRef(null),{children:o,droppableId:l,type:c,mode:u,direction:d,ignoreContainerClipping:f,isDropDisabled:m,isCombineEnabled:h,snapshot:y,useClone:v,updateViewportMaxScroll:w,getContainerForClone:g}=e,b=ce(()=>s.current,[]),p=ce((T=null)=>{s.current=T},[]);ce(()=>a.current,[]);const _=ce((T=null)=>{a.current=T},[]),j=ce(()=>{n()&&w({maxScroll:Tj()})},[n,w]);MI({droppableId:l,type:c,mode:u,direction:d,isDropDisabled:m,isCombineEnabled:h,ignoreContainerClipping:f,getDroppableRef:b});const k=Ce(()=>H.createElement(BI,{on:e.placeholder,shouldAnimate:e.shouldAnimatePlaceholder},({onClose:T,data:L,animate:O})=>H.createElement(FI,{placeholder:L,onClose:T,innerRef:_,animate:O,contextId:r,onTransitionEnd:j})),[r,j,e.placeholder,e.shouldAnimatePlaceholder,_]),N=Ce(()=>({innerRef:p,placeholder:k,droppableProps:{"data-rfd-droppable-id":l,"data-rfd-droppable-context-id":r}}),[r,l,k,p]),S=v?v.dragging.draggableId:null,C=Ce(()=>({droppableId:l,type:c,isUsingCloneFor:S}),[l,S,c]);function E(){if(!v)return null;const{dragging:T,render:L}=v,O=H.createElement(Gj,{draggableId:T.draggableId,index:T.source.index,isClone:!0,isEnabled:!0,shouldRespectForcePress:!1,canDragInteractiveElements:!0},(A,M)=>L(A,M,T));return s1.createPortal(O,g())}return H.createElement(Pg.Provider,{value:C},o(N,y),E())};function zI(){return document.body||Z(),document.body}const My={mode:"standard",type:"DEFAULT",direction:"vertical",isDropDisabled:!1,isCombineEnabled:!1,ignoreContainerClipping:!1,renderClone:null,getContainerForClone:zI},Xj=e=>{let t={...e},r;for(r in My)e[r]===void 0&&(t={...t,[r]:My[r]});return t},Uf=(e,t)=>e===t.droppable.type,Oy=(e,t)=>t.draggables[e.draggable.id],WI=()=>{const e={placeholder:null,shouldAnimatePlaceholder:!0,snapshot:{isDraggingOver:!1,draggingOverWith:null,draggingFromThisWith:null,isUsingPlaceholder:!1},useClone:null},t={...e,shouldAnimatePlaceholder:!1},r=xt(a=>({draggableId:a.id,type:a.type,source:{index:a.index,droppableId:a.droppableId}})),n=xt((a,o,l,c,u,d)=>{const f=u.descriptor.id;if(u.descriptor.droppableId===a){const y=d?{render:d,dragging:r(u.descriptor)}:null,v={isDraggingOver:l,draggingOverWith:l?f:null,draggingFromThisWith:f,isUsingPlaceholder:!0};return{placeholder:u.placeholder,shouldAnimatePlaceholder:!1,snapshot:v,useClone:y}}if(!o)return t;if(!c)return e;const h={isDraggingOver:l,draggingOverWith:f,draggingFromThisWith:null,isUsingPlaceholder:!0};return{placeholder:u.placeholder,shouldAnimatePlaceholder:!0,snapshot:h,useClone:null}});return(a,o)=>{const l=Xj(o),c=l.droppableId,u=l.type,d=!l.isDropDisabled,f=l.renderClone;if(cl(a)){const m=a.critical;if(!Uf(u,m))return t;const h=Oy(m,a.dimensions),y=ir(a.impact)===c;return n(c,d,y,y,h,f)}if(a.phase==="DROP_ANIMATING"){const m=a.completed;if(!Uf(u,m.critical))return t;const h=Oy(m.critical,a.dimensions);return n(c,d,Vj(m.result)===c,ir(m.impact)===c,h,f)}if(a.phase==="IDLE"&&a.completed&&!a.shouldFlush){const m=a.completed;if(!Uf(u,m.critical))return t;const h=ir(m.impact)===c,y=!!(m.impact.at&&m.impact.at.type==="COMBINE"),v=m.critical.droppable.id===c;return h?y?e:t:v?e:t}return t}},HI={updateViewportMaxScroll:e3},qI=Q1(WI,HI,(e,t,r)=>({...Xj(r),...e,...t}),{context:Cg,areStatePropsEqual:qj})(UI);function VI(){const[e,t]=x.useState([]),[r,n]=x.useState([]),[s,a]=x.useState(!0);return x.useEffect(()=>{(async()=>{try{console.log(" Fetching kanban data (safe version)...");const{data:l,error:c}=await $.from("deal_stage").select("id, label, description, sort_order, active").eq("active",!0).order("sort_order",{ascending:!0});if(console.log(" Stages:",l),c)throw console.error(" Stage error:",c),c;const{data:u,error:d}=await $.from("deal").select("id, deal_name, fee, deal_value, closed_date, stage_id, kanban_position, client_id, created_at").order("kanban_position",{ascending:!0});if(console.log(" Deals:",(u==null?void 0:u.length)||0,"deals fetched"),d)throw console.error(" Deal error:",d),d;const{data:f,error:m}=await $.from("client").select("id, client_name");console.log(" Clients:",(f==null?void 0:f.length)||0,"clients fetched"),m&&console.warn(" Client error (non-fatal):",m);const h=new Map;f==null||f.forEach(p=>{h.set(p.id,p.client_name)});const y=u.map(p=>({id:p.id,deal_name:p.deal_name,fee:p.fee,deal_value:p.deal_value,closed_date:p.closed_date,stage_id:p.stage_id,kanban_position:p.kanban_position,client_name:p.client_id&&h.get(p.client_id)||null,created_at:p.created_at})),v=new Map;l.forEach(p=>{v.set(p.id,p.label)});const w=new Set(l.map(p=>p.id)),g=new Date;g.setFullYear(g.getFullYear()-2);const b=y.filter(p=>!p.stage_id||!w.has(p.stage_id)?!1:v.get(p.stage_id)==="Lost"?p.created_at?new Date(p.created_at)>=g:!1:!0);console.log(" Final cards:",b.length),console.log(" Final columns:",l.length),t(l||[]),n(b)}catch(l){console.error(" Error:",l)}finally{a(!1)}})()},[]),{columns:e,cards:r,loading:s}}function YI(){const{columns:e,cards:t,loading:r}=VI(),[n,s]=x.useState([]);x.useEffect(()=>{s(t)},[t]),x.useEffect(()=>{document.title="Master Pipeline"},[]);const a=async c=>{const{destination:u,draggableId:d}=c;if(!u)return;const f=u.droppableId,m=[...n],h=m.find(w=>w.id===d);if(!h)return;h.stage_id=f;const y=m.filter(w=>w.stage_id===f&&w.id!==d).sort((w,g)=>(w.kanban_position??0)-(g.kanban_position??0));y.splice(u.index,0,h),y.forEach((w,g)=>{w.kanban_position=g}),s(m);const v=y.map(w=>$.from("deal").update({stage_id:w.stage_id,kanban_position:w.kanban_position}).eq("id",w.id));await Promise.all(v)},o=(c,u=0)=>typeof c=="number"?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:u,maximumFractionDigits:u}).format(c):"--",l=new Date().getFullYear();return r?i.jsx("div",{className:"p-4",children:"Loading..."}):i.jsxs("div",{className:"p-4 overflow-x-auto bg-gray-100 min-h-screen",children:[i.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Master Pipeline"}),i.jsx("div",{className:"flex min-w-max gap-[2px]",children:i.jsx(aI,{onDragEnd:a,children:e.map((c,u)=>{let d=n.filter(y=>y.stage_id===c.id).sort((y,v)=>(y.kanban_position??0)-(v.kanban_position??0));c.label==="Closed Paid"&&(d=d.filter(y=>y.closed_date?new Date(y.closed_date).getFullYear()===l:!1));const f=d.reduce((y,v)=>y+(v.fee??0),0),m=u===e.length-1,h=u===0;return i.jsx(qI,{droppableId:c.id,children:(y,v)=>i.jsxs("div",{ref:y.innerRef,...y.droppableProps,className:`relative min-w-[240px] max-w-[280px] bg-white shadow-sm flex flex-col ${v.isDraggingOver?"bg-blue-50":""}`,children:[i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:`chevron-header ${h?"first":""} ${m?"last":""} flex items-center justify-center`,children:i.jsxs("div",{className:"text-center font-semibold text-sm",children:[c.label," (",d.length,")"]})}),i.jsx("div",{className:"bg-white text-center py-2 border-b",children:i.jsx("div",{className:"text-green-600 text-lg font-bold",children:o(f)})})]}),i.jsxs("div",{className:"p-2 flex-1",children:[d.map((w,g)=>i.jsx(kI,{draggableId:w.id,index:g,children:(b,p)=>i.jsxs("div",{ref:b.innerRef,...b.draggableProps,...b.dragHandleProps,className:`bg-white p-2 rounded shadow mb-2 border text-sm ${p.isDragging?"bg-yellow-100":""}`,children:[i.jsx("div",{className:"font-semibold",children:i.jsx(Ga,{to:`/deal/${w.id}`,className:"text-blue-600 hover:underline",children:w.deal_name||"Untitled Deal"})}),i.jsx("div",{className:"text-gray-700",children:o(w.fee)}),i.jsx("div",{className:"text-gray-500 text-xs",children:w.client_name||"No Client"}),i.jsx("div",{className:"text-gray-800",children:o(w.deal_value)})]})},w.id)),y.placeholder]})]})},c.id)})})})]})}function Ro(e,t=0){return e==null||isNaN(e)?"":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:t,maximumFractionDigits:t}).format(e)}function Ih(e,t=2){return typeof e!="number"||isNaN(e)?"":`${e.toFixed(t)}%`}function GI(e){return typeof e!="number"?"":Math.round(e)+"%"}function Ys({label:e,value:t,onChange:r,format:n,editingField:s,setEditingField:a,fieldKey:o,tabIndex:l}){const c=s===o,u=x.useRef(null);x.useEffect(()=>{c&&u.current&&u.current.focus()},[c]);const d=()=>{a(null)},f=h=>{(h.key==="Enter"||h.key===" ")&&(h.preventDefault(),a(o))},m=()=>{a(o)};return i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:e}),c?i.jsx("input",{ref:u,type:"number",value:t??"",onChange:h=>r(h.target.value),onBlur:d,className:"mt-1 block w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",tabIndex:l}):i.jsx("div",{onClick:()=>a(o),onKeyDown:f,onFocus:m,className:"mt-1 p-2 bg-gray-100 rounded text-sm cursor-pointer",tabIndex:l,children:t==null||t===""?"":n(t)})]})}function Zj(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=Zj(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function wt(){for(var e,t,r=0,n="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=Zj(e))&&(n&&(n+=" "),n+=t);return n}const ek=6048e5,KI=864e5,Sd=6e4,Cd=36e5,QI=1e3,cc=43200,Ay=1440,$y=Symbol.for("constructDateFrom");function Oe(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&$y in e?e[$y](t):e instanceof Date?new e.constructor(t):new Date(t)}function oe(e,t){return Oe(t||e,e)}function Fr(e,t,r){const n=oe(e,r==null?void 0:r.in);return isNaN(t)?Oe((r==null?void 0:r.in)||e,NaN):(t&&n.setDate(n.getDate()+t),n)}function zr(e,t,r){const n=oe(e,r==null?void 0:r.in);if(isNaN(t))return Oe((r==null?void 0:r.in)||e,NaN);if(!t)return n;const s=n.getDate(),a=Oe((r==null?void 0:r.in)||e,n.getTime());a.setMonth(n.getMonth()+t+1,0);const o=a.getDate();return s>=o?a:(n.setFullYear(a.getFullYear(),a.getMonth(),s),n)}function tk(e,t,r){return Oe((r==null?void 0:r.in)||e,+oe(e)+t)}function JI(e,t,r){return tk(e,t*Cd,r)}let XI={};function ks(){return XI}function Bn(e,t){var l,c,u,d;const r=ks(),n=(t==null?void 0:t.weekStartsOn)??((c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.weekStartsOn)??0,s=oe(e,t==null?void 0:t.in),a=s.getDay(),o=(a<n?7:0)+a-n;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function ui(e,t){return Bn(e,{...t,weekStartsOn:1})}function rk(e,t){const r=oe(e,t==null?void 0:t.in),n=r.getFullYear(),s=Oe(r,0);s.setFullYear(n+1,0,4),s.setHours(0,0,0,0);const a=ui(s),o=Oe(r,0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);const l=ui(o);return r.getTime()>=a.getTime()?n+1:r.getTime()>=l.getTime()?n:n-1}function di(e){const t=oe(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function Yr(e,...t){const r=Oe.bind(null,e||t.find(n=>typeof n=="object"));return t.map(r)}function Wr(e,t){const r=oe(e,t==null?void 0:t.in);return r.setHours(0,0,0,0),r}function fi(e,t,r){const[n,s]=Yr(r==null?void 0:r.in,e,t),a=Wr(n),o=Wr(s),l=+a-di(a),c=+o-di(o);return Math.round((l-c)/KI)}function ZI(e,t){const r=rk(e,t),n=Oe((t==null?void 0:t.in)||e,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),ui(n)}function Rh(e,t,r){const n=oe(e,r==null?void 0:r.in);return n.setTime(n.getTime()+t*Sd),n}function Tg(e,t,r){return zr(e,t*3,r)}function eR(e,t,r){return tk(e,t*1e3,r)}function Ru(e,t,r){return Fr(e,t*7,r)}function Pn(e,t,r){return zr(e,t*12,r)}function Fy(e,t){let r,n=t==null?void 0:t.in;return e.forEach(s=>{!n&&typeof s=="object"&&(n=Oe.bind(null,s));const a=oe(s,n);(!r||r<a||isNaN(+a))&&(r=a)}),Oe(n,r||NaN)}function By(e,t){let r,n=t==null?void 0:t.in;return e.forEach(s=>{!n&&typeof s=="object"&&(n=Oe.bind(null,s));const a=oe(s,n);(!r||r>a||isNaN(+a))&&(r=a)}),Oe(n,r||NaN)}function zc(e,t){const r=+oe(e)-+oe(t);return r<0?-1:r>0?1:r}function tR(e){return Oe(e,Date.now())}function rR(e,t,r){const[n,s]=Yr(r==null?void 0:r.in,e,t);return+Wr(n)==+Wr(s)}function Tn(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Mu(e){return!(!Tn(e)&&typeof e!="number"||isNaN(+oe(e)))}function ul(e,t,r){const[n,s]=Yr(r==null?void 0:r.in,e,t),a=n.getFullYear()-s.getFullYear(),o=n.getMonth()-s.getMonth();return a*12+o}function Xs(e,t){const r=oe(e,t==null?void 0:t.in);return Math.trunc(r.getMonth()/3)+1}function Ou(e,t,r){const[n,s]=Yr(r==null?void 0:r.in,e,t),a=n.getFullYear()-s.getFullYear(),o=Xs(n)-Xs(s);return a*4+o}function Au(e,t,r){const[n,s]=Yr(r==null?void 0:r.in,e,t);return n.getFullYear()-s.getFullYear()}function nR(e,t,r){const[n,s]=Yr(r==null?void 0:r.in,e,t),a=Uy(n,s),o=Math.abs(fi(n,s));n.setDate(n.getDate()-a*o);const l=+(Uy(n,s)===-a),c=a*(o-l);return c===0?0:c}function Uy(e,t){const r=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return r<0?-1:r>0?1:r}function sR(e){return t=>{const n=(e?Math[e]:Math.trunc)(t);return n===0?0:n}}function aR(e,t){return+oe(e)-+oe(t)}function Lg(e,t){const r=oe(e,t==null?void 0:t.in);return r.setHours(23,59,59,999),r}function Ig(e,t){const r=oe(e,t==null?void 0:t.in),n=r.getMonth();return r.setFullYear(r.getFullYear(),n+1,0),r.setHours(23,59,59,999),r}function iR(e,t){const r=oe(e,t==null?void 0:t.in);return+Lg(r,t)==+Ig(r,t)}function oR(e,t,r){const[n,s,a]=Yr(r==null?void 0:r.in,e,e,t),o=zc(s,a),l=Math.abs(ul(s,a));if(l<1)return 0;s.getMonth()===1&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-o*l);let c=zc(s,a)===-o;iR(n)&&l===1&&zc(n,a)===1&&(c=!1);const u=o*(l-+c);return u===0?0:u}function lR(e,t,r){const n=aR(e,t)/1e3;return sR(r==null?void 0:r.roundingMethod)(n)}function Mh(e,t){const r=oe(e,t==null?void 0:t.in),n=r.getMonth(),s=n-n%3;return r.setMonth(s,1),r.setHours(0,0,0,0),r}function nk(e,t){const r=oe(e,t==null?void 0:t.in);return r.setDate(1),r.setHours(0,0,0,0),r}function sk(e,t){const r=oe(e,t==null?void 0:t.in),n=r.getFullYear();return r.setFullYear(n+1,0,0),r.setHours(23,59,59,999),r}function Ed(e,t){const r=oe(e,t==null?void 0:t.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}function cR(e,t){var l,c,u,d;const r=ks(),n=(t==null?void 0:t.weekStartsOn)??((c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.weekStartsOn)??0,s=oe(e,t==null?void 0:t.in),a=s.getDay(),o=(a<n?-7:0)+6-(a-n);return s.setDate(s.getDate()+o),s.setHours(23,59,59,999),s}const uR={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},dR=(e,t,r)=>{let n;const s=uR[e];return typeof s=="string"?n=s:t===1?n=s.one:n=s.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function zf(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const fR={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},mR={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},hR={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},pR={date:zf({formats:fR,defaultWidth:"full"}),time:zf({formats:mR,defaultWidth:"full"}),dateTime:zf({formats:hR,defaultWidth:"full"})},gR={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},xR=(e,t,r,n)=>gR[e];function Qi(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let s;if(n==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,l=r!=null&&r.width?String(r.width):o;s=e.formattingValues[l]||e.formattingValues[o]}else{const o=e.defaultWidth,l=r!=null&&r.width?String(r.width):e.defaultWidth;s=e.values[l]||e.values[o]}const a=e.argumentCallback?e.argumentCallback(t):t;return s[a]}}const yR={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},bR={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},vR={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},wR={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},_R={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},jR={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},kR=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},NR={ordinalNumber:kR,era:Qi({values:yR,defaultWidth:"wide"}),quarter:Qi({values:bR,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Qi({values:vR,defaultWidth:"wide"}),day:Qi({values:wR,defaultWidth:"wide"}),dayPeriod:Qi({values:_R,defaultWidth:"wide",formattingValues:jR,defaultFormattingWidth:"wide"})};function Ji(e){return(t,r={})=>{const n=r.width,s=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],a=t.match(s);if(!a)return null;const o=a[0],l=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(l)?CR(l,f=>f.test(o)):SR(l,f=>f.test(o));let u;u=e.valueCallback?e.valueCallback(c):c,u=r.valueCallback?r.valueCallback(u):u;const d=t.slice(o.length);return{value:u,rest:d}}}function SR(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function CR(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function ER(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const s=n[0],a=t.match(e.parsePattern);if(!a)return null;let o=e.valueCallback?e.valueCallback(a[0]):a[0];o=r.valueCallback?r.valueCallback(o):o;const l=t.slice(s.length);return{value:o,rest:l}}}const DR=/^(\d+)(th|st|nd|rd)?/i,PR=/\d+/i,TR={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},LR={any:[/^b/i,/^(a|c)/i]},IR={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},RR={any:[/1/i,/2/i,/3/i,/4/i]},MR={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},OR={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},AR={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},$R={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},FR={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},BR={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},UR={ordinalNumber:ER({matchPattern:DR,parsePattern:PR,valueCallback:e=>parseInt(e,10)}),era:Ji({matchPatterns:TR,defaultMatchWidth:"wide",parsePatterns:LR,defaultParseWidth:"any"}),quarter:Ji({matchPatterns:IR,defaultMatchWidth:"wide",parsePatterns:RR,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Ji({matchPatterns:MR,defaultMatchWidth:"wide",parsePatterns:OR,defaultParseWidth:"any"}),day:Ji({matchPatterns:AR,defaultMatchWidth:"wide",parsePatterns:$R,defaultParseWidth:"any"}),dayPeriod:Ji({matchPatterns:FR,defaultMatchWidth:"any",parsePatterns:BR,defaultParseWidth:"any"})},Rg={code:"en-US",formatDistance:dR,formatLong:pR,formatRelative:xR,localize:NR,match:UR,options:{weekStartsOn:0,firstWeekContainsDate:1}};function zR(e,t){const r=oe(e,t==null?void 0:t.in);return fi(r,Ed(r))+1}function Mg(e,t){const r=oe(e,t==null?void 0:t.in),n=+ui(r)-+ZI(r);return Math.round(n/ek)+1}function Og(e,t){var d,f,m,h;const r=oe(e,t==null?void 0:t.in),n=r.getFullYear(),s=ks(),a=(t==null?void 0:t.firstWeekContainsDate)??((f=(d=t==null?void 0:t.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??s.firstWeekContainsDate??((h=(m=s.locale)==null?void 0:m.options)==null?void 0:h.firstWeekContainsDate)??1,o=Oe((t==null?void 0:t.in)||e,0);o.setFullYear(n+1,0,a),o.setHours(0,0,0,0);const l=Bn(o,t),c=Oe((t==null?void 0:t.in)||e,0);c.setFullYear(n,0,a),c.setHours(0,0,0,0);const u=Bn(c,t);return+r>=+l?n+1:+r>=+u?n:n-1}function WR(e,t){var l,c,u,d;const r=ks(),n=(t==null?void 0:t.firstWeekContainsDate)??((c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??r.firstWeekContainsDate??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??1,s=Og(e,t),a=Oe((t==null?void 0:t.in)||e,0);return a.setFullYear(s,0,n),a.setHours(0,0,0,0),Bn(a,t)}function ak(e,t){const r=oe(e,t==null?void 0:t.in),n=+Bn(r,t)-+WR(r,t);return Math.round(n/ek)+1}function Ae(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const qn={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return Ae(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Ae(r+1,2)},d(e,t){return Ae(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Ae(e.getHours()%12||12,t.length)},H(e,t){return Ae(e.getHours(),t.length)},m(e,t){return Ae(e.getMinutes(),t.length)},s(e,t){return Ae(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),s=Math.trunc(n*Math.pow(10,r-3));return Ae(s,t.length)}},ja={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},zy={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),s=n>0?n:1-n;return r.ordinalNumber(s,{unit:"year"})}return qn.y(e,t)},Y:function(e,t,r,n){const s=Og(e,n),a=s>0?s:1-s;if(t==="YY"){const o=a%100;return Ae(o,2)}return t==="Yo"?r.ordinalNumber(a,{unit:"year"}):Ae(a,t.length)},R:function(e,t){const r=rk(e);return Ae(r,t.length)},u:function(e,t){const r=e.getFullYear();return Ae(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return Ae(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return Ae(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return qn.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return Ae(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const s=ak(e,n);return t==="wo"?r.ordinalNumber(s,{unit:"week"}):Ae(s,t.length)},I:function(e,t,r){const n=Mg(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):Ae(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):qn.d(e,t)},D:function(e,t,r){const n=zR(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Ae(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const s=e.getDay(),a=(s-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(a);case"ee":return Ae(a,2);case"eo":return r.ordinalNumber(a,{unit:"day"});case"eee":return r.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(s,{width:"short",context:"formatting"});case"eeee":default:return r.day(s,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const s=e.getDay(),a=(s-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(a);case"cc":return Ae(a,t.length);case"co":return r.ordinalNumber(a,{unit:"day"});case"ccc":return r.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(s,{width:"narrow",context:"standalone"});case"cccccc":return r.day(s,{width:"short",context:"standalone"});case"cccc":default:return r.day(s,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),s=n===0?7:n;switch(t){case"i":return String(s);case"ii":return Ae(s,t.length);case"io":return r.ordinalNumber(s,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const s=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let s;switch(n===12?s=ja.noon:n===0?s=ja.midnight:s=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let s;switch(n>=17?s=ja.evening:n>=12?s=ja.afternoon:n>=4?s=ja.morning:s=ja.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return qn.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):qn.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Ae(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):Ae(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):qn.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):qn.s(e,t)},S:function(e,t){return qn.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return Hy(n);case"XXXX":case"XX":return $s(n);case"XXXXX":case"XXX":default:return $s(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return Hy(n);case"xxxx":case"xx":return $s(n);case"xxxxx":case"xxx":default:return $s(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Wy(n,":");case"OOOO":default:return"GMT"+$s(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Wy(n,":");case"zzzz":default:return"GMT"+$s(n,":")}},t:function(e,t,r){const n=Math.trunc(+e/1e3);return Ae(n,t.length)},T:function(e,t,r){return Ae(+e,t.length)}};function Wy(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),s=Math.trunc(n/60),a=n%60;return a===0?r+String(s):r+String(s)+t+Ae(a,2)}function Hy(e,t){return e%60===0?(e>0?"-":"+")+Ae(Math.abs(e)/60,2):$s(e,t)}function $s(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),s=Ae(Math.trunc(n/60),2),a=Ae(n%60,2);return r+s+t+a}const qy=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},ik=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},HR=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],s=r[2];if(!s)return qy(e,t);let a;switch(n){case"P":a=t.dateTime({width:"short"});break;case"PP":a=t.dateTime({width:"medium"});break;case"PPP":a=t.dateTime({width:"long"});break;case"PPPP":default:a=t.dateTime({width:"full"});break}return a.replace("{{date}}",qy(n,t)).replace("{{time}}",ik(s,t))},Oh={p:ik,P:HR},qR=/^D+$/,VR=/^Y+$/,YR=["D","DD","YY","YYYY"];function ok(e){return qR.test(e)}function lk(e){return VR.test(e)}function Ah(e,t,r){const n=GR(e,t,r);if(console.warn(n),YR.includes(e))throw new RangeError(n)}function GR(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const KR=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,QR=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,JR=/^'([^]*?)'?$/,XR=/''/g,ZR=/[a-zA-Z]/;function kr(e,t,r){var d,f,m,h,y,v,w,g;const n=ks(),s=(r==null?void 0:r.locale)??n.locale??Rg,a=(r==null?void 0:r.firstWeekContainsDate)??((f=(d=r==null?void 0:r.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??n.firstWeekContainsDate??((h=(m=n.locale)==null?void 0:m.options)==null?void 0:h.firstWeekContainsDate)??1,o=(r==null?void 0:r.weekStartsOn)??((v=(y=r==null?void 0:r.locale)==null?void 0:y.options)==null?void 0:v.weekStartsOn)??n.weekStartsOn??((g=(w=n.locale)==null?void 0:w.options)==null?void 0:g.weekStartsOn)??0,l=oe(e,r==null?void 0:r.in);if(!Mu(l))throw new RangeError("Invalid time value");let c=t.match(QR).map(b=>{const p=b[0];if(p==="p"||p==="P"){const _=Oh[p];return _(b,s.formatLong)}return b}).join("").match(KR).map(b=>{if(b==="''")return{isToken:!1,value:"'"};const p=b[0];if(p==="'")return{isToken:!1,value:eM(b)};if(zy[p])return{isToken:!0,value:b};if(p.match(ZR))throw new RangeError("Format string contains an unescaped latin alphabet character `"+p+"`");return{isToken:!1,value:b}});s.localize.preprocessor&&(c=s.localize.preprocessor(l,c));const u={firstWeekContainsDate:a,weekStartsOn:o,locale:s};return c.map(b=>{if(!b.isToken)return b.value;const p=b.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&lk(p)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&ok(p))&&Ah(p,t,String(e));const _=zy[p[0]];return _(l,p,s.localize,u)}).join("")}function eM(e){const t=e.match(JR);return t?t[1].replace(XR,"'"):e}function tM(e,t,r){const n=ks(),s=(r==null?void 0:r.locale)??n.locale??Rg,a=2520,o=zc(e,t);if(isNaN(o))throw new RangeError("Invalid time value");const l=Object.assign({},r,{addSuffix:r==null?void 0:r.addSuffix,comparison:o}),[c,u]=Yr(r==null?void 0:r.in,...o>0?[t,e]:[e,t]),d=lR(u,c),f=(di(u)-di(c))/1e3,m=Math.round((d-f)/60);let h;if(m<2)return r!=null&&r.includeSeconds?d<5?s.formatDistance("lessThanXSeconds",5,l):d<10?s.formatDistance("lessThanXSeconds",10,l):d<20?s.formatDistance("lessThanXSeconds",20,l):d<40?s.formatDistance("halfAMinute",0,l):d<60?s.formatDistance("lessThanXMinutes",1,l):s.formatDistance("xMinutes",1,l):m===0?s.formatDistance("lessThanXMinutes",1,l):s.formatDistance("xMinutes",m,l);if(m<45)return s.formatDistance("xMinutes",m,l);if(m<90)return s.formatDistance("aboutXHours",1,l);if(m<Ay){const y=Math.round(m/60);return s.formatDistance("aboutXHours",y,l)}else{if(m<a)return s.formatDistance("xDays",1,l);if(m<cc){const y=Math.round(m/Ay);return s.formatDistance("xDays",y,l)}else if(m<cc*2)return h=Math.round(m/cc),s.formatDistance("aboutXMonths",h,l)}if(h=oR(u,c),h<12){const y=Math.round(m/cc);return s.formatDistance("xMonths",y,l)}else{const y=h%12,v=Math.trunc(h/12);return y<3?s.formatDistance("aboutXYears",v,l):y<9?s.formatDistance("overXYears",v,l):s.formatDistance("almostXYears",v+1,l)}}function Vy(e,t){return tM(e,tR(e),t)}function Yy(e,t){return oe(e,t==null?void 0:t.in).getDate()}function rM(e,t){return oe(e,t==null?void 0:t.in).getDay()}function nM(e,t){const r=oe(e,t==null?void 0:t.in),n=r.getFullYear(),s=r.getMonth(),a=Oe(r,0);return a.setFullYear(n,s+1,0),a.setHours(0,0,0,0),a.getDate()}function sM(){return Object.assign({},ks())}function Ln(e,t){return oe(e,t==null?void 0:t.in).getHours()}function aM(e,t){const r=oe(e,t==null?void 0:t.in).getDay();return r===0?7:r}function In(e,t){return oe(e,t==null?void 0:t.in).getMinutes()}function Et(e,t){return oe(e,t==null?void 0:t.in).getMonth()}function hs(e){return oe(e).getSeconds()}function $h(e){return+oe(e)}function ve(e,t){return oe(e,t==null?void 0:t.in).getFullYear()}function fn(e,t){return+oe(e)>+oe(t)}function on(e,t){return+oe(e)<+oe(t)}function iM(e,t){return+oe(e)==+oe(t)}function oM(e,t){const r=lM(t)?new t(0):Oe(t,0);return r.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),r.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),r}function lM(e){var t;return typeof e=="function"&&((t=e.prototype)==null?void 0:t.constructor)===e}const cM=10;class ck{constructor(){ae(this,"subPriority",0)}validate(t,r){return!0}}class uM extends ck{constructor(t,r,n,s,a){super(),this.value=t,this.validateValue=r,this.setValue=n,this.priority=s,a&&(this.subPriority=a)}validate(t,r){return this.validateValue(t,this.value,r)}set(t,r,n){return this.setValue(t,r,this.value,n)}}class dM extends ck{constructor(r,n){super();ae(this,"priority",cM);ae(this,"subPriority",-1);this.context=r||(s=>Oe(n,s))}set(r,n){return n.timestampIsSet?r:Oe(r,oM(r,this.context))}}class Le{run(t,r,n,s){const a=this.parse(t,r,n,s);return a?{setter:new uM(a.value,this.validate,this.set,this.priority,this.subPriority),rest:a.rest}:null}validate(t,r,n){return!0}}class fM extends Le{constructor(){super(...arguments);ae(this,"priority",140);ae(this,"incompatibleTokens",["R","u","t","T"])}parse(r,n,s){switch(n){case"G":case"GG":case"GGG":return s.era(r,{width:"abbreviated"})||s.era(r,{width:"narrow"});case"GGGGG":return s.era(r,{width:"narrow"});case"GGGG":default:return s.era(r,{width:"wide"})||s.era(r,{width:"abbreviated"})||s.era(r,{width:"narrow"})}}set(r,n,s){return n.era=s,r.setFullYear(s,0,1),r.setHours(0,0,0,0),r}}const at={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},rn={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function it(e,t){return e&&{value:t(e.value),rest:e.rest}}function Xe(e,t){const r=t.match(e);return r?{value:parseInt(r[0],10),rest:t.slice(r[0].length)}:null}function nn(e,t){const r=t.match(e);if(!r)return null;if(r[0]==="Z")return{value:0,rest:t.slice(1)};const n=r[1]==="+"?1:-1,s=r[2]?parseInt(r[2],10):0,a=r[3]?parseInt(r[3],10):0,o=r[5]?parseInt(r[5],10):0;return{value:n*(s*Cd+a*Sd+o*QI),rest:t.slice(r[0].length)}}function uk(e){return Xe(at.anyDigitsSigned,e)}function nt(e,t){switch(e){case 1:return Xe(at.singleDigit,t);case 2:return Xe(at.twoDigits,t);case 3:return Xe(at.threeDigits,t);case 4:return Xe(at.fourDigits,t);default:return Xe(new RegExp("^\\d{1,"+e+"}"),t)}}function $u(e,t){switch(e){case 1:return Xe(at.singleDigitSigned,t);case 2:return Xe(at.twoDigitsSigned,t);case 3:return Xe(at.threeDigitsSigned,t);case 4:return Xe(at.fourDigitsSigned,t);default:return Xe(new RegExp("^-?\\d{1,"+e+"}"),t)}}function Ag(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function dk(e,t){const r=t>0,n=r?t:1-t;let s;if(n<=50)s=e||100;else{const a=n+50,o=Math.trunc(a/100)*100,l=e>=a%100;s=e+o-(l?100:0)}return r?s:1-s}function fk(e){return e%400===0||e%4===0&&e%100!==0}class mM extends Le{constructor(){super(...arguments);ae(this,"priority",130);ae(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(r,n,s){const a=o=>({year:o,isTwoDigitYear:n==="yy"});switch(n){case"y":return it(nt(4,r),a);case"yo":return it(s.ordinalNumber(r,{unit:"year"}),a);default:return it(nt(n.length,r),a)}}validate(r,n){return n.isTwoDigitYear||n.year>0}set(r,n,s){const a=r.getFullYear();if(s.isTwoDigitYear){const l=dk(s.year,a);return r.setFullYear(l,0,1),r.setHours(0,0,0,0),r}const o=!("era"in n)||n.era===1?s.year:1-s.year;return r.setFullYear(o,0,1),r.setHours(0,0,0,0),r}}class hM extends Le{constructor(){super(...arguments);ae(this,"priority",130);ae(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(r,n,s){const a=o=>({year:o,isTwoDigitYear:n==="YY"});switch(n){case"Y":return it(nt(4,r),a);case"Yo":return it(s.ordinalNumber(r,{unit:"year"}),a);default:return it(nt(n.length,r),a)}}validate(r,n){return n.isTwoDigitYear||n.year>0}set(r,n,s,a){const o=Og(r,a);if(s.isTwoDigitYear){const c=dk(s.year,o);return r.setFullYear(c,0,a.firstWeekContainsDate),r.setHours(0,0,0,0),Bn(r,a)}const l=!("era"in n)||n.era===1?s.year:1-s.year;return r.setFullYear(l,0,a.firstWeekContainsDate),r.setHours(0,0,0,0),Bn(r,a)}}class pM extends Le{constructor(){super(...arguments);ae(this,"priority",130);ae(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(r,n){return $u(n==="R"?4:n.length,r)}set(r,n,s){const a=Oe(r,0);return a.setFullYear(s,0,4),a.setHours(0,0,0,0),ui(a)}}class gM extends Le{constructor(){super(...arguments);ae(this,"priority",130);ae(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(r,n){return $u(n==="u"?4:n.length,r)}set(r,n,s){return r.setFullYear(s,0,1),r.setHours(0,0,0,0),r}}class xM extends Le{constructor(){super(...arguments);ae(this,"priority",120);ae(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(r,n,s){switch(n){case"Q":case"QQ":return nt(n.length,r);case"Qo":return s.ordinalNumber(r,{unit:"quarter"});case"QQQ":return s.quarter(r,{width:"abbreviated",context:"formatting"})||s.quarter(r,{width:"narrow",context:"formatting"});case"QQQQQ":return s.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return s.quarter(r,{width:"wide",context:"formatting"})||s.quarter(r,{width:"abbreviated",context:"formatting"})||s.quarter(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=1&&n<=4}set(r,n,s){return r.setMonth((s-1)*3,1),r.setHours(0,0,0,0),r}}class yM extends Le{constructor(){super(...arguments);ae(this,"priority",120);ae(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(r,n,s){switch(n){case"q":case"qq":return nt(n.length,r);case"qo":return s.ordinalNumber(r,{unit:"quarter"});case"qqq":return s.quarter(r,{width:"abbreviated",context:"standalone"})||s.quarter(r,{width:"narrow",context:"standalone"});case"qqqqq":return s.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return s.quarter(r,{width:"wide",context:"standalone"})||s.quarter(r,{width:"abbreviated",context:"standalone"})||s.quarter(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=1&&n<=4}set(r,n,s){return r.setMonth((s-1)*3,1),r.setHours(0,0,0,0),r}}class bM extends Le{constructor(){super(...arguments);ae(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]);ae(this,"priority",110)}parse(r,n,s){const a=o=>o-1;switch(n){case"M":return it(Xe(at.month,r),a);case"MM":return it(nt(2,r),a);case"Mo":return it(s.ordinalNumber(r,{unit:"month"}),a);case"MMM":return s.month(r,{width:"abbreviated",context:"formatting"})||s.month(r,{width:"narrow",context:"formatting"});case"MMMMM":return s.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return s.month(r,{width:"wide",context:"formatting"})||s.month(r,{width:"abbreviated",context:"formatting"})||s.month(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=11}set(r,n,s){return r.setMonth(s,1),r.setHours(0,0,0,0),r}}class vM extends Le{constructor(){super(...arguments);ae(this,"priority",110);ae(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(r,n,s){const a=o=>o-1;switch(n){case"L":return it(Xe(at.month,r),a);case"LL":return it(nt(2,r),a);case"Lo":return it(s.ordinalNumber(r,{unit:"month"}),a);case"LLL":return s.month(r,{width:"abbreviated",context:"standalone"})||s.month(r,{width:"narrow",context:"standalone"});case"LLLLL":return s.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return s.month(r,{width:"wide",context:"standalone"})||s.month(r,{width:"abbreviated",context:"standalone"})||s.month(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=0&&n<=11}set(r,n,s){return r.setMonth(s,1),r.setHours(0,0,0,0),r}}function wM(e,t,r){const n=oe(e,r==null?void 0:r.in),s=ak(n,r)-t;return n.setDate(n.getDate()-s*7),oe(n,r==null?void 0:r.in)}class _M extends Le{constructor(){super(...arguments);ae(this,"priority",100);ae(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(r,n,s){switch(n){case"w":return Xe(at.week,r);case"wo":return s.ordinalNumber(r,{unit:"week"});default:return nt(n.length,r)}}validate(r,n){return n>=1&&n<=53}set(r,n,s,a){return Bn(wM(r,s,a),a)}}function jM(e,t,r){const n=oe(e,r==null?void 0:r.in),s=Mg(n,r)-t;return n.setDate(n.getDate()-s*7),n}class kM extends Le{constructor(){super(...arguments);ae(this,"priority",100);ae(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(r,n,s){switch(n){case"I":return Xe(at.week,r);case"Io":return s.ordinalNumber(r,{unit:"week"});default:return nt(n.length,r)}}validate(r,n){return n>=1&&n<=53}set(r,n,s){return ui(jM(r,s))}}const NM=[31,28,31,30,31,30,31,31,30,31,30,31],SM=[31,29,31,30,31,30,31,31,30,31,30,31];class CM extends Le{constructor(){super(...arguments);ae(this,"priority",90);ae(this,"subPriority",1);ae(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(r,n,s){switch(n){case"d":return Xe(at.date,r);case"do":return s.ordinalNumber(r,{unit:"date"});default:return nt(n.length,r)}}validate(r,n){const s=r.getFullYear(),a=fk(s),o=r.getMonth();return a?n>=1&&n<=SM[o]:n>=1&&n<=NM[o]}set(r,n,s){return r.setDate(s),r.setHours(0,0,0,0),r}}class EM extends Le{constructor(){super(...arguments);ae(this,"priority",90);ae(this,"subpriority",1);ae(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(r,n,s){switch(n){case"D":case"DD":return Xe(at.dayOfYear,r);case"Do":return s.ordinalNumber(r,{unit:"date"});default:return nt(n.length,r)}}validate(r,n){const s=r.getFullYear();return fk(s)?n>=1&&n<=366:n>=1&&n<=365}set(r,n,s){return r.setMonth(0,s),r.setHours(0,0,0,0),r}}function $g(e,t,r){var f,m,h,y;const n=ks(),s=(r==null?void 0:r.weekStartsOn)??((m=(f=r==null?void 0:r.locale)==null?void 0:f.options)==null?void 0:m.weekStartsOn)??n.weekStartsOn??((y=(h=n.locale)==null?void 0:h.options)==null?void 0:y.weekStartsOn)??0,a=oe(e,r==null?void 0:r.in),o=a.getDay(),c=(t%7+7)%7,u=7-s,d=t<0||t>6?t-(o+u)%7:(c+u)%7-(o+u)%7;return Fr(a,d,r)}class DM extends Le{constructor(){super(...arguments);ae(this,"priority",90);ae(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(r,n,s){switch(n){case"E":case"EE":case"EEE":return s.day(r,{width:"abbreviated",context:"formatting"})||s.day(r,{width:"short",context:"formatting"})||s.day(r,{width:"narrow",context:"formatting"});case"EEEEE":return s.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return s.day(r,{width:"short",context:"formatting"})||s.day(r,{width:"narrow",context:"formatting"});case"EEEE":default:return s.day(r,{width:"wide",context:"formatting"})||s.day(r,{width:"abbreviated",context:"formatting"})||s.day(r,{width:"short",context:"formatting"})||s.day(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=6}set(r,n,s,a){return r=$g(r,s,a),r.setHours(0,0,0,0),r}}class PM extends Le{constructor(){super(...arguments);ae(this,"priority",90);ae(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(r,n,s,a){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+a.weekStartsOn+6)%7+c};switch(n){case"e":case"ee":return it(nt(n.length,r),o);case"eo":return it(s.ordinalNumber(r,{unit:"day"}),o);case"eee":return s.day(r,{width:"abbreviated",context:"formatting"})||s.day(r,{width:"short",context:"formatting"})||s.day(r,{width:"narrow",context:"formatting"});case"eeeee":return s.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return s.day(r,{width:"short",context:"formatting"})||s.day(r,{width:"narrow",context:"formatting"});case"eeee":default:return s.day(r,{width:"wide",context:"formatting"})||s.day(r,{width:"abbreviated",context:"formatting"})||s.day(r,{width:"short",context:"formatting"})||s.day(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=6}set(r,n,s,a){return r=$g(r,s,a),r.setHours(0,0,0,0),r}}class TM extends Le{constructor(){super(...arguments);ae(this,"priority",90);ae(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(r,n,s,a){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+a.weekStartsOn+6)%7+c};switch(n){case"c":case"cc":return it(nt(n.length,r),o);case"co":return it(s.ordinalNumber(r,{unit:"day"}),o);case"ccc":return s.day(r,{width:"abbreviated",context:"standalone"})||s.day(r,{width:"short",context:"standalone"})||s.day(r,{width:"narrow",context:"standalone"});case"ccccc":return s.day(r,{width:"narrow",context:"standalone"});case"cccccc":return s.day(r,{width:"short",context:"standalone"})||s.day(r,{width:"narrow",context:"standalone"});case"cccc":default:return s.day(r,{width:"wide",context:"standalone"})||s.day(r,{width:"abbreviated",context:"standalone"})||s.day(r,{width:"short",context:"standalone"})||s.day(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=0&&n<=6}set(r,n,s,a){return r=$g(r,s,a),r.setHours(0,0,0,0),r}}function LM(e,t,r){const n=oe(e,r==null?void 0:r.in),s=aM(n,r),a=t-s;return Fr(n,a,r)}class IM extends Le{constructor(){super(...arguments);ae(this,"priority",90);ae(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(r,n,s){const a=o=>o===0?7:o;switch(n){case"i":case"ii":return nt(n.length,r);case"io":return s.ordinalNumber(r,{unit:"day"});case"iii":return it(s.day(r,{width:"abbreviated",context:"formatting"})||s.day(r,{width:"short",context:"formatting"})||s.day(r,{width:"narrow",context:"formatting"}),a);case"iiiii":return it(s.day(r,{width:"narrow",context:"formatting"}),a);case"iiiiii":return it(s.day(r,{width:"short",context:"formatting"})||s.day(r,{width:"narrow",context:"formatting"}),a);case"iiii":default:return it(s.day(r,{width:"wide",context:"formatting"})||s.day(r,{width:"abbreviated",context:"formatting"})||s.day(r,{width:"short",context:"formatting"})||s.day(r,{width:"narrow",context:"formatting"}),a)}}validate(r,n){return n>=1&&n<=7}set(r,n,s){return r=LM(r,s),r.setHours(0,0,0,0),r}}class RM extends Le{constructor(){super(...arguments);ae(this,"priority",80);ae(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(r,n,s){switch(n){case"a":case"aa":case"aaa":return s.dayPeriod(r,{width:"abbreviated",context:"formatting"})||s.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaaa":return s.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return s.dayPeriod(r,{width:"wide",context:"formatting"})||s.dayPeriod(r,{width:"abbreviated",context:"formatting"})||s.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,s){return r.setHours(Ag(s),0,0,0),r}}class MM extends Le{constructor(){super(...arguments);ae(this,"priority",80);ae(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(r,n,s){switch(n){case"b":case"bb":case"bbb":return s.dayPeriod(r,{width:"abbreviated",context:"formatting"})||s.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbbb":return s.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return s.dayPeriod(r,{width:"wide",context:"formatting"})||s.dayPeriod(r,{width:"abbreviated",context:"formatting"})||s.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,s){return r.setHours(Ag(s),0,0,0),r}}class OM extends Le{constructor(){super(...arguments);ae(this,"priority",80);ae(this,"incompatibleTokens",["a","b","t","T"])}parse(r,n,s){switch(n){case"B":case"BB":case"BBB":return s.dayPeriod(r,{width:"abbreviated",context:"formatting"})||s.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBBB":return s.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return s.dayPeriod(r,{width:"wide",context:"formatting"})||s.dayPeriod(r,{width:"abbreviated",context:"formatting"})||s.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,s){return r.setHours(Ag(s),0,0,0),r}}class AM extends Le{constructor(){super(...arguments);ae(this,"priority",70);ae(this,"incompatibleTokens",["H","K","k","t","T"])}parse(r,n,s){switch(n){case"h":return Xe(at.hour12h,r);case"ho":return s.ordinalNumber(r,{unit:"hour"});default:return nt(n.length,r)}}validate(r,n){return n>=1&&n<=12}set(r,n,s){const a=r.getHours()>=12;return a&&s<12?r.setHours(s+12,0,0,0):!a&&s===12?r.setHours(0,0,0,0):r.setHours(s,0,0,0),r}}class $M extends Le{constructor(){super(...arguments);ae(this,"priority",70);ae(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(r,n,s){switch(n){case"H":return Xe(at.hour23h,r);case"Ho":return s.ordinalNumber(r,{unit:"hour"});default:return nt(n.length,r)}}validate(r,n){return n>=0&&n<=23}set(r,n,s){return r.setHours(s,0,0,0),r}}class FM extends Le{constructor(){super(...arguments);ae(this,"priority",70);ae(this,"incompatibleTokens",["h","H","k","t","T"])}parse(r,n,s){switch(n){case"K":return Xe(at.hour11h,r);case"Ko":return s.ordinalNumber(r,{unit:"hour"});default:return nt(n.length,r)}}validate(r,n){return n>=0&&n<=11}set(r,n,s){return r.getHours()>=12&&s<12?r.setHours(s+12,0,0,0):r.setHours(s,0,0,0),r}}class BM extends Le{constructor(){super(...arguments);ae(this,"priority",70);ae(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(r,n,s){switch(n){case"k":return Xe(at.hour24h,r);case"ko":return s.ordinalNumber(r,{unit:"hour"});default:return nt(n.length,r)}}validate(r,n){return n>=1&&n<=24}set(r,n,s){const a=s<=24?s%24:s;return r.setHours(a,0,0,0),r}}class UM extends Le{constructor(){super(...arguments);ae(this,"priority",60);ae(this,"incompatibleTokens",["t","T"])}parse(r,n,s){switch(n){case"m":return Xe(at.minute,r);case"mo":return s.ordinalNumber(r,{unit:"minute"});default:return nt(n.length,r)}}validate(r,n){return n>=0&&n<=59}set(r,n,s){return r.setMinutes(s,0,0),r}}class zM extends Le{constructor(){super(...arguments);ae(this,"priority",50);ae(this,"incompatibleTokens",["t","T"])}parse(r,n,s){switch(n){case"s":return Xe(at.second,r);case"so":return s.ordinalNumber(r,{unit:"second"});default:return nt(n.length,r)}}validate(r,n){return n>=0&&n<=59}set(r,n,s){return r.setSeconds(s,0),r}}class WM extends Le{constructor(){super(...arguments);ae(this,"priority",30);ae(this,"incompatibleTokens",["t","T"])}parse(r,n){const s=a=>Math.trunc(a*Math.pow(10,-n.length+3));return it(nt(n.length,r),s)}set(r,n,s){return r.setMilliseconds(s),r}}class HM extends Le{constructor(){super(...arguments);ae(this,"priority",10);ae(this,"incompatibleTokens",["t","T","x"])}parse(r,n){switch(n){case"X":return nn(rn.basicOptionalMinutes,r);case"XX":return nn(rn.basic,r);case"XXXX":return nn(rn.basicOptionalSeconds,r);case"XXXXX":return nn(rn.extendedOptionalSeconds,r);case"XXX":default:return nn(rn.extended,r)}}set(r,n,s){return n.timestampIsSet?r:Oe(r,r.getTime()-di(r)-s)}}class qM extends Le{constructor(){super(...arguments);ae(this,"priority",10);ae(this,"incompatibleTokens",["t","T","X"])}parse(r,n){switch(n){case"x":return nn(rn.basicOptionalMinutes,r);case"xx":return nn(rn.basic,r);case"xxxx":return nn(rn.basicOptionalSeconds,r);case"xxxxx":return nn(rn.extendedOptionalSeconds,r);case"xxx":default:return nn(rn.extended,r)}}set(r,n,s){return n.timestampIsSet?r:Oe(r,r.getTime()-di(r)-s)}}class VM extends Le{constructor(){super(...arguments);ae(this,"priority",40);ae(this,"incompatibleTokens","*")}parse(r){return uk(r)}set(r,n,s){return[Oe(r,s*1e3),{timestampIsSet:!0}]}}class YM extends Le{constructor(){super(...arguments);ae(this,"priority",20);ae(this,"incompatibleTokens","*")}parse(r){return uk(r)}set(r,n,s){return[Oe(r,s),{timestampIsSet:!0}]}}const GM={G:new fM,y:new mM,Y:new hM,R:new pM,u:new gM,Q:new xM,q:new yM,M:new bM,L:new vM,w:new _M,I:new kM,d:new CM,D:new EM,E:new DM,e:new PM,c:new TM,i:new IM,a:new RM,b:new MM,B:new OM,h:new AM,H:new $M,K:new FM,k:new BM,m:new UM,s:new zM,S:new WM,X:new HM,x:new qM,t:new VM,T:new YM},KM=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,QM=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,JM=/^'([^]*?)'?$/,XM=/''/g,ZM=/\S/,eO=/[a-zA-Z]/;function tO(e,t,r,n){var w,g,b,p,_,j,k,N;const s=()=>Oe((n==null?void 0:n.in)||r,NaN),a=sM(),o=(n==null?void 0:n.locale)??a.locale??Rg,l=(n==null?void 0:n.firstWeekContainsDate)??((g=(w=n==null?void 0:n.locale)==null?void 0:w.options)==null?void 0:g.firstWeekContainsDate)??a.firstWeekContainsDate??((p=(b=a.locale)==null?void 0:b.options)==null?void 0:p.firstWeekContainsDate)??1,c=(n==null?void 0:n.weekStartsOn)??((j=(_=n==null?void 0:n.locale)==null?void 0:_.options)==null?void 0:j.weekStartsOn)??a.weekStartsOn??((N=(k=a.locale)==null?void 0:k.options)==null?void 0:N.weekStartsOn)??0;if(!t)return e?s():oe(r,n==null?void 0:n.in);const u={firstWeekContainsDate:l,weekStartsOn:c,locale:o},d=[new dM(n==null?void 0:n.in,r)],f=t.match(QM).map(S=>{const C=S[0];if(C in Oh){const E=Oh[C];return E(S,o.formatLong)}return S}).join("").match(KM),m=[];for(let S of f){!(n!=null&&n.useAdditionalWeekYearTokens)&&lk(S)&&Ah(S,t,e),!(n!=null&&n.useAdditionalDayOfYearTokens)&&ok(S)&&Ah(S,t,e);const C=S[0],E=GM[C];if(E){const{incompatibleTokens:T}=E;if(Array.isArray(T)){const O=m.find(A=>T.includes(A.token)||A.token===C);if(O)throw new RangeError(`The format string mustn't contain \`${O.fullToken}\` and \`${S}\` at the same time`)}else if(E.incompatibleTokens==="*"&&m.length>0)throw new RangeError(`The format string mustn't contain \`${S}\` and any other token at the same time`);m.push({token:C,fullToken:S});const L=E.run(e,S,o.match,u);if(!L)return s();d.push(L.setter),e=L.rest}else{if(C.match(eO))throw new RangeError("Format string contains an unescaped latin alphabet character `"+C+"`");if(S==="''"?S="'":C==="'"&&(S=rO(S)),e.indexOf(S)===0)e=e.slice(S.length);else return s()}}if(e.length>0&&ZM.test(e))return s();const h=d.map(S=>S.priority).sort((S,C)=>C-S).filter((S,C,E)=>E.indexOf(S)===C).map(S=>d.filter(C=>C.priority===S).sort((C,E)=>E.subPriority-C.subPriority)).map(S=>S[0]);let y=oe(r,n==null?void 0:n.in);if(isNaN(+y))return s();const v={};for(const S of h){if(!S.validate(y,u))return s();const C=S.set(y,v,u);Array.isArray(C)?(y=C[0],Object.assign(v,C[1])):y=C}return y}function rO(e){return e.match(JM)[1].replace(XM,"'")}function nO(e,t,r){const[n,s]=Yr(r==null?void 0:r.in,e,t);return n.getFullYear()===s.getFullYear()&&n.getMonth()===s.getMonth()}function sO(e,t,r){const[n,s]=Yr(r==null?void 0:r.in,e,t);return+Mh(n)==+Mh(s)}function aO(e,t,r){const[n,s]=Yr(r==null?void 0:r.in,e,t);return n.getFullYear()===s.getFullYear()}function dl(e,t,r){const n=+oe(e,r==null?void 0:r.in),[s,a]=[+oe(t.start,r==null?void 0:r.in),+oe(t.end,r==null?void 0:r.in)].sort((o,l)=>o-l);return n>=s&&n<=a}function iO(e,t,r){return Fr(e,-t,r)}function Fg(e,t){const r=()=>Oe(t==null?void 0:t.in,NaN),n=(t==null?void 0:t.additionalDigits)??2,s=uO(e);let a;if(s.date){const u=dO(s.date,n);a=fO(u.restDateString,u.year)}if(!a||isNaN(+a))return r();const o=+a;let l=0,c;if(s.time&&(l=mO(s.time),isNaN(l)))return r();if(s.timezone){if(c=hO(s.timezone),isNaN(c))return r()}else{const u=new Date(o+l),d=oe(0,t==null?void 0:t.in);return d.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),d.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),d}return oe(o+l+c,t==null?void 0:t.in)}const uc={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},oO=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,lO=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,cO=/^([+-])(\d{2})(?::?(\d{2}))?$/;function uO(e){const t={},r=e.split(uc.dateTimeDelimiter);let n;if(r.length>2)return t;if(/:/.test(r[0])?n=r[0]:(t.date=r[0],n=r[1],uc.timeZoneDelimiter.test(t.date)&&(t.date=e.split(uc.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){const s=uc.timezone.exec(n);s?(t.time=n.replace(s[1],""),t.timezone=s[1]):t.time=n}return t}function dO(e,t){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(r);if(!n)return{year:NaN,restDateString:""};const s=n[1]?parseInt(n[1]):null,a=n[2]?parseInt(n[2]):null;return{year:a===null?s:a*100,restDateString:e.slice((n[1]||n[2]).length)}}function fO(e,t){if(t===null)return new Date(NaN);const r=e.match(oO);if(!r)return new Date(NaN);const n=!!r[4],s=Xi(r[1]),a=Xi(r[2])-1,o=Xi(r[3]),l=Xi(r[4]),c=Xi(r[5])-1;if(n)return bO(t,l,c)?pO(t,l,c):new Date(NaN);{const u=new Date(0);return!xO(t,a,o)||!yO(t,s)?new Date(NaN):(u.setUTCFullYear(t,a,Math.max(s,o)),u)}}function Xi(e){return e?parseInt(e):1}function mO(e){const t=e.match(lO);if(!t)return NaN;const r=Wf(t[1]),n=Wf(t[2]),s=Wf(t[3]);return vO(r,n,s)?r*Cd+n*Sd+s*1e3:NaN}function Wf(e){return e&&parseFloat(e.replace(",","."))||0}function hO(e){if(e==="Z")return 0;const t=e.match(cO);if(!t)return 0;const r=t[1]==="+"?-1:1,n=parseInt(t[2]),s=t[3]&&parseInt(t[3])||0;return wO(n,s)?r*(n*Cd+s*Sd):NaN}function pO(e,t,r){const n=new Date(0);n.setUTCFullYear(e,0,4);const s=n.getUTCDay()||7,a=(t-1)*7+r+1-s;return n.setUTCDate(n.getUTCDate()+a),n}const gO=[31,null,31,30,31,30,31,31,30,31,30,31];function mk(e){return e%400===0||e%4===0&&e%100!==0}function xO(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(gO[t]||(mk(e)?29:28))}function yO(e,t){return t>=1&&t<=(mk(e)?366:365)}function bO(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function vO(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function wO(e,t){return t>=0&&t<=59}function pr(e,t,r){const n=oe(e,r==null?void 0:r.in),s=n.getFullYear(),a=n.getDate(),o=Oe((r==null?void 0:r.in)||e,0);o.setFullYear(s,t,15),o.setHours(0,0,0,0);const l=nM(o);return n.setMonth(t,Math.min(a,l)),n}function Wc(e,t,r){const n=oe(e,r==null?void 0:r.in);return n.setHours(t),n}function Hc(e,t,r){const n=oe(e,r==null?void 0:r.in);return n.setMinutes(t),n}function Ca(e,t,r){const n=oe(e,r==null?void 0:r.in),s=Math.trunc(n.getMonth()/3)+1,a=t-s;return pr(n,n.getMonth()+a*3)}function qc(e,t,r){const n=oe(e,r==null?void 0:r.in);return n.setSeconds(t),n}function Zr(e,t,r){const n=oe(e,r==null?void 0:r.in);return isNaN(+n)?Oe((r==null?void 0:r.in)||e,NaN):(n.setFullYear(t),n)}function Zs(e,t,r){return zr(e,-t,r)}function hk(e,t,r){return Tg(e,-t,r)}function Gy(e,t,r){return Ru(e,-t,r)}function mi(e,t,r){return Pn(e,-t,r)}function Dd(){return typeof window<"u"}function Ti(e){return pk(e)?(e.nodeName||"").toLowerCase():"#document"}function lr(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function pn(e){var t;return(t=(pk(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function pk(e){return Dd()?e instanceof Node||e instanceof lr(e).Node:!1}function $t(e){return Dd()?e instanceof Element||e instanceof lr(e).Element:!1}function mn(e){return Dd()?e instanceof HTMLElement||e instanceof lr(e).HTMLElement:!1}function Ky(e){return!Dd()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof lr(e).ShadowRoot}const _O=new Set(["inline","contents"]);function Dl(e){const{overflow:t,overflowX:r,overflowY:n,display:s}=Cr(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!_O.has(s)}const jO=new Set(["table","td","th"]);function kO(e){return jO.has(Ti(e))}const NO=[":popover-open",":modal"];function Pd(e){return NO.some(t=>{try{return e.matches(t)}catch{return!1}})}const SO=["transform","translate","scale","rotate","perspective"],CO=["transform","translate","scale","rotate","perspective","filter"],EO=["paint","layout","strict","content"];function Bg(e){const t=Ug(),r=$t(e)?Cr(e):e;return SO.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||CO.some(n=>(r.willChange||"").includes(n))||EO.some(n=>(r.contain||"").includes(n))}function DO(e){let t=bs(e);for(;mn(t)&&!hi(t);){if(Bg(t))return t;if(Pd(t))return null;t=bs(t)}return null}function Ug(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const PO=new Set(["html","body","#document"]);function hi(e){return PO.has(Ti(e))}function Cr(e){return lr(e).getComputedStyle(e)}function Td(e){return $t(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function bs(e){if(Ti(e)==="html")return e;const t=e.assignedSlot||e.parentNode||Ky(e)&&e.host||pn(e);return Ky(t)?t.host:t}function gk(e){const t=bs(e);return hi(t)?e.ownerDocument?e.ownerDocument.body:e.body:mn(t)&&Dl(t)?t:gk(t)}function fl(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const s=gk(e),a=s===((n=e.ownerDocument)==null?void 0:n.body),o=lr(s);if(a){const l=Fh(o);return t.concat(o,o.visualViewport||[],Dl(s)?s:[],l&&r?fl(l):[])}return t.concat(s,fl(s,[],r))}function Fh(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}const pi=Math.min,ea=Math.max,Fu=Math.round,dc=Math.floor,dn=e=>({x:e,y:e}),TO={left:"right",right:"left",bottom:"top",top:"bottom"},LO={start:"end",end:"start"};function IO(e,t,r){return ea(e,pi(t,r))}function Ld(e,t){return typeof e=="function"?e(t):e}function gi(e){return e.split("-")[0]}function Pl(e){return e.split("-")[1]}function RO(e){return e==="x"?"y":"x"}function zg(e){return e==="y"?"height":"width"}const MO=new Set(["top","bottom"]);function Gs(e){return MO.has(gi(e))?"y":"x"}function Wg(e){return RO(Gs(e))}function OO(e,t,r){r===void 0&&(r=!1);const n=Pl(e),s=Wg(e),a=zg(s);let o=s==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[a]>t.floating[a]&&(o=Bu(o)),[o,Bu(o)]}function AO(e){const t=Bu(e);return[Bh(e),t,Bh(t)]}function Bh(e){return e.replace(/start|end/g,t=>LO[t])}const Qy=["left","right"],Jy=["right","left"],$O=["top","bottom"],FO=["bottom","top"];function BO(e,t,r){switch(e){case"top":case"bottom":return r?t?Jy:Qy:t?Qy:Jy;case"left":case"right":return t?$O:FO;default:return[]}}function UO(e,t,r,n){const s=Pl(e);let a=BO(gi(e),r==="start",n);return s&&(a=a.map(o=>o+"-"+s),t&&(a=a.concat(a.map(Bh)))),a}function Bu(e){return e.replace(/left|right|bottom|top/g,t=>TO[t])}function zO(e){return{top:0,right:0,bottom:0,left:0,...e}}function xk(e){return typeof e!="number"?zO(e):{top:e,right:e,bottom:e,left:e}}function Uu(e){const{x:t,y:r,width:n,height:s}=e;return{width:n,height:s,top:r,left:t,right:t+n,bottom:r+s,x:t,y:r}}var WO=typeof document<"u",HO=function(){},zu=WO?x.useLayoutEffect:HO;const qO={...tw},VO=qO.useInsertionEffect,YO=VO||(e=>e());function GO(e){const t=x.useRef(()=>{});return YO(()=>{t.current=e}),x.useCallback(function(){for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return t.current==null?void 0:t.current(...n)},[])}function Xy(e,t,r){let{reference:n,floating:s}=e;const a=Gs(t),o=Wg(t),l=zg(o),c=gi(t),u=a==="y",d=n.x+n.width/2-s.width/2,f=n.y+n.height/2-s.height/2,m=n[l]/2-s[l]/2;let h;switch(c){case"top":h={x:d,y:n.y-s.height};break;case"bottom":h={x:d,y:n.y+n.height};break;case"right":h={x:n.x+n.width,y:f};break;case"left":h={x:n.x-s.width,y:f};break;default:h={x:n.x,y:n.y}}switch(Pl(t)){case"start":h[o]-=m*(r&&u?-1:1);break;case"end":h[o]+=m*(r&&u?-1:1);break}return h}const KO=async(e,t,r)=>{const{placement:n="bottom",strategy:s="absolute",middleware:a=[],platform:o}=r,l=a.filter(Boolean),c=await(o.isRTL==null?void 0:o.isRTL(t));let u=await o.getElementRects({reference:e,floating:t,strategy:s}),{x:d,y:f}=Xy(u,n,c),m=n,h={},y=0;for(let v=0;v<l.length;v++){const{name:w,fn:g}=l[v],{x:b,y:p,data:_,reset:j}=await g({x:d,y:f,initialPlacement:n,placement:m,strategy:s,middlewareData:h,rects:u,platform:o,elements:{reference:e,floating:t}});d=b??d,f=p??f,h={...h,[w]:{...h[w],..._}},j&&y<=50&&(y++,typeof j=="object"&&(j.placement&&(m=j.placement),j.rects&&(u=j.rects===!0?await o.getElementRects({reference:e,floating:t,strategy:s}):j.rects),{x:d,y:f}=Xy(u,m,c)),v=-1)}return{x:d,y:f,placement:m,strategy:s,middlewareData:h}};async function QO(e,t){var r;t===void 0&&(t={});const{x:n,y:s,platform:a,rects:o,elements:l,strategy:c}=e,{boundary:u="clippingAncestors",rootBoundary:d="viewport",elementContext:f="floating",altBoundary:m=!1,padding:h=0}=Ld(t,e),y=xk(h),w=l[m?f==="floating"?"reference":"floating":f],g=Uu(await a.getClippingRect({element:(r=await(a.isElement==null?void 0:a.isElement(w)))==null||r?w:w.contextElement||await(a.getDocumentElement==null?void 0:a.getDocumentElement(l.floating)),boundary:u,rootBoundary:d,strategy:c})),b=f==="floating"?{x:n,y:s,width:o.floating.width,height:o.floating.height}:o.reference,p=await(a.getOffsetParent==null?void 0:a.getOffsetParent(l.floating)),_=await(a.isElement==null?void 0:a.isElement(p))?await(a.getScale==null?void 0:a.getScale(p))||{x:1,y:1}:{x:1,y:1},j=Uu(a.convertOffsetParentRelativeRectToViewportRelativeRect?await a.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:b,offsetParent:p,strategy:c}):b);return{top:(g.top-j.top+y.top)/_.y,bottom:(j.bottom-g.bottom+y.bottom)/_.y,left:(g.left-j.left+y.left)/_.x,right:(j.right-g.right+y.right)/_.x}}const JO=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:s,rects:a,platform:o,elements:l,middlewareData:c}=t,{element:u,padding:d=0}=Ld(e,t)||{};if(u==null)return{};const f=xk(d),m={x:r,y:n},h=Wg(s),y=zg(h),v=await o.getDimensions(u),w=h==="y",g=w?"top":"left",b=w?"bottom":"right",p=w?"clientHeight":"clientWidth",_=a.reference[y]+a.reference[h]-m[h]-a.floating[y],j=m[h]-a.reference[h],k=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u));let N=k?k[p]:0;(!N||!await(o.isElement==null?void 0:o.isElement(k)))&&(N=l.floating[p]||a.floating[y]);const S=_/2-j/2,C=N/2-v[y]/2-1,E=pi(f[g],C),T=pi(f[b],C),L=E,O=N-v[y]-T,A=N/2-v[y]/2+S,M=IO(L,A,O),B=!c.arrow&&Pl(s)!=null&&A!==M&&a.reference[y]/2-(A<L?E:T)-v[y]/2<0,F=B?A<L?A-L:A-O:0;return{[h]:m[h]+F,data:{[h]:M,centerOffset:A-M-F,...B&&{alignmentOffset:F}},reset:B}}}),XO=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:s,middlewareData:a,rects:o,initialPlacement:l,platform:c,elements:u}=t,{mainAxis:d=!0,crossAxis:f=!0,fallbackPlacements:m,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:y="none",flipAlignment:v=!0,...w}=Ld(e,t);if((r=a.arrow)!=null&&r.alignmentOffset)return{};const g=gi(s),b=Gs(l),p=gi(l)===l,_=await(c.isRTL==null?void 0:c.isRTL(u.floating)),j=m||(p||!v?[Bu(l)]:AO(l)),k=y!=="none";!m&&k&&j.push(...UO(l,v,y,_));const N=[l,...j],S=await QO(t,w),C=[];let E=((n=a.flip)==null?void 0:n.overflows)||[];if(d&&C.push(S[g]),f){const A=OO(s,o,_);C.push(S[A[0]],S[A[1]])}if(E=[...E,{placement:s,overflows:C}],!C.every(A=>A<=0)){var T,L;const A=(((T=a.flip)==null?void 0:T.index)||0)+1,M=N[A];if(M&&(!(f==="alignment"?b!==Gs(M):!1)||E.every(R=>Gs(R.placement)===b?R.overflows[0]>0:!0)))return{data:{index:A,overflows:E},reset:{placement:M}};let B=(L=E.filter(F=>F.overflows[0]<=0).sort((F,R)=>F.overflows[1]-R.overflows[1])[0])==null?void 0:L.placement;if(!B)switch(h){case"bestFit":{var O;const F=(O=E.filter(R=>{if(k){const P=Gs(R.placement);return P===b||P==="y"}return!0}).map(R=>[R.placement,R.overflows.filter(P=>P>0).reduce((P,D)=>P+D,0)]).sort((R,P)=>R[1]-P[1])[0])==null?void 0:O[0];F&&(B=F);break}case"initialPlacement":B=l;break}if(s!==B)return{reset:{placement:B}}}return{}}}},ZO=new Set(["left","top"]);async function eA(e,t){const{placement:r,platform:n,elements:s}=e,a=await(n.isRTL==null?void 0:n.isRTL(s.floating)),o=gi(r),l=Pl(r),c=Gs(r)==="y",u=ZO.has(o)?-1:1,d=a&&c?-1:1,f=Ld(t,e);let{mainAxis:m,crossAxis:h,alignmentAxis:y}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return l&&typeof y=="number"&&(h=l==="end"?y*-1:y),c?{x:h*d,y:m*u}:{x:m*u,y:h*d}}const tA=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:s,y:a,placement:o,middlewareData:l}=t,c=await eA(t,e);return o===((r=l.offset)==null?void 0:r.placement)&&(n=l.arrow)!=null&&n.alignmentOffset?{}:{x:s+c.x,y:a+c.y,data:{...c,placement:o}}}}};function yk(e){const t=Cr(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const s=mn(e),a=s?e.offsetWidth:r,o=s?e.offsetHeight:n,l=Fu(r)!==a||Fu(n)!==o;return l&&(r=a,n=o),{width:r,height:n,$:l}}function Hg(e){return $t(e)?e:e.contextElement}function Ka(e){const t=Hg(e);if(!mn(t))return dn(1);const r=t.getBoundingClientRect(),{width:n,height:s,$:a}=yk(t);let o=(a?Fu(r.width):r.width)/n,l=(a?Fu(r.height):r.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!l||!Number.isFinite(l))&&(l=1),{x:o,y:l}}const rA=dn(0);function bk(e){const t=lr(e);return!Ug()||!t.visualViewport?rA:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function nA(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==lr(e)?!1:t}function la(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const s=e.getBoundingClientRect(),a=Hg(e);let o=dn(1);t&&(n?$t(n)&&(o=Ka(n)):o=Ka(e));const l=nA(a,r,n)?bk(a):dn(0);let c=(s.left+l.x)/o.x,u=(s.top+l.y)/o.y,d=s.width/o.x,f=s.height/o.y;if(a){const m=lr(a),h=n&&$t(n)?lr(n):n;let y=m,v=Fh(y);for(;v&&n&&h!==y;){const w=Ka(v),g=v.getBoundingClientRect(),b=Cr(v),p=g.left+(v.clientLeft+parseFloat(b.paddingLeft))*w.x,_=g.top+(v.clientTop+parseFloat(b.paddingTop))*w.y;c*=w.x,u*=w.y,d*=w.x,f*=w.y,c+=p,u+=_,y=lr(v),v=Fh(y)}}return Uu({width:d,height:f,x:c,y:u})}function Id(e,t){const r=Td(e).scrollLeft;return t?t.left+r:la(pn(e)).left+r}function vk(e,t){const r=e.getBoundingClientRect(),n=r.left+t.scrollLeft-Id(e,r),s=r.top+t.scrollTop;return{x:n,y:s}}function sA(e){let{elements:t,rect:r,offsetParent:n,strategy:s}=e;const a=s==="fixed",o=pn(n),l=t?Pd(t.floating):!1;if(n===o||l&&a)return r;let c={scrollLeft:0,scrollTop:0},u=dn(1);const d=dn(0),f=mn(n);if((f||!f&&!a)&&((Ti(n)!=="body"||Dl(o))&&(c=Td(n)),mn(n))){const h=la(n);u=Ka(n),d.x=h.x+n.clientLeft,d.y=h.y+n.clientTop}const m=o&&!f&&!a?vk(o,c):dn(0);return{width:r.width*u.x,height:r.height*u.y,x:r.x*u.x-c.scrollLeft*u.x+d.x+m.x,y:r.y*u.y-c.scrollTop*u.y+d.y+m.y}}function aA(e){return Array.from(e.getClientRects())}function iA(e){const t=pn(e),r=Td(e),n=e.ownerDocument.body,s=ea(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),a=ea(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let o=-r.scrollLeft+Id(e);const l=-r.scrollTop;return Cr(n).direction==="rtl"&&(o+=ea(t.clientWidth,n.clientWidth)-s),{width:s,height:a,x:o,y:l}}const Zy=25;function oA(e,t){const r=lr(e),n=pn(e),s=r.visualViewport;let a=n.clientWidth,o=n.clientHeight,l=0,c=0;if(s){a=s.width,o=s.height;const d=Ug();(!d||d&&t==="fixed")&&(l=s.offsetLeft,c=s.offsetTop)}const u=Id(n);if(u<=0){const d=n.ownerDocument,f=d.body,m=getComputedStyle(f),h=d.compatMode==="CSS1Compat"&&parseFloat(m.marginLeft)+parseFloat(m.marginRight)||0,y=Math.abs(n.clientWidth-f.clientWidth-h);y<=Zy&&(a-=y)}else u<=Zy&&(a+=u);return{width:a,height:o,x:l,y:c}}const lA=new Set(["absolute","fixed"]);function cA(e,t){const r=la(e,!0,t==="fixed"),n=r.top+e.clientTop,s=r.left+e.clientLeft,a=mn(e)?Ka(e):dn(1),o=e.clientWidth*a.x,l=e.clientHeight*a.y,c=s*a.x,u=n*a.y;return{width:o,height:l,x:c,y:u}}function eb(e,t,r){let n;if(t==="viewport")n=oA(e,r);else if(t==="document")n=iA(pn(e));else if($t(t))n=cA(t,r);else{const s=bk(e);n={x:t.x-s.x,y:t.y-s.y,width:t.width,height:t.height}}return Uu(n)}function wk(e,t){const r=bs(e);return r===t||!$t(r)||hi(r)?!1:Cr(r).position==="fixed"||wk(r,t)}function uA(e,t){const r=t.get(e);if(r)return r;let n=fl(e,[],!1).filter(l=>$t(l)&&Ti(l)!=="body"),s=null;const a=Cr(e).position==="fixed";let o=a?bs(e):e;for(;$t(o)&&!hi(o);){const l=Cr(o),c=Bg(o);!c&&l.position==="fixed"&&(s=null),(a?!c&&!s:!c&&l.position==="static"&&!!s&&lA.has(s.position)||Dl(o)&&!c&&wk(e,o))?n=n.filter(d=>d!==o):s=l,o=bs(o)}return t.set(e,n),n}function dA(e){let{element:t,boundary:r,rootBoundary:n,strategy:s}=e;const o=[...r==="clippingAncestors"?Pd(t)?[]:uA(t,this._c):[].concat(r),n],l=o[0],c=o.reduce((u,d)=>{const f=eb(t,d,s);return u.top=ea(f.top,u.top),u.right=pi(f.right,u.right),u.bottom=pi(f.bottom,u.bottom),u.left=ea(f.left,u.left),u},eb(t,l,s));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function fA(e){const{width:t,height:r}=yk(e);return{width:t,height:r}}function mA(e,t,r){const n=mn(t),s=pn(t),a=r==="fixed",o=la(e,!0,a,t);let l={scrollLeft:0,scrollTop:0};const c=dn(0);function u(){c.x=Id(s)}if(n||!n&&!a)if((Ti(t)!=="body"||Dl(s))&&(l=Td(t)),n){const h=la(t,!0,a,t);c.x=h.x+t.clientLeft,c.y=h.y+t.clientTop}else s&&u();a&&!n&&s&&u();const d=s&&!n&&!a?vk(s,l):dn(0),f=o.left+l.scrollLeft-c.x-d.x,m=o.top+l.scrollTop-c.y-d.y;return{x:f,y:m,width:o.width,height:o.height}}function Hf(e){return Cr(e).position==="static"}function tb(e,t){if(!mn(e)||Cr(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return pn(e)===r&&(r=r.ownerDocument.body),r}function _k(e,t){const r=lr(e);if(Pd(e))return r;if(!mn(e)){let s=bs(e);for(;s&&!hi(s);){if($t(s)&&!Hf(s))return s;s=bs(s)}return r}let n=tb(e,t);for(;n&&kO(n)&&Hf(n);)n=tb(n,t);return n&&hi(n)&&Hf(n)&&!Bg(n)?r:n||DO(e)||r}const hA=async function(e){const t=this.getOffsetParent||_k,r=this.getDimensions,n=await r(e.floating);return{reference:mA(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function pA(e){return Cr(e).direction==="rtl"}const gA={convertOffsetParentRelativeRectToViewportRelativeRect:sA,getDocumentElement:pn,getClippingRect:dA,getOffsetParent:_k,getElementRects:hA,getClientRects:aA,getDimensions:fA,getScale:Ka,isElement:$t,isRTL:pA};function jk(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function xA(e,t){let r=null,n;const s=pn(e);function a(){var l;clearTimeout(n),(l=r)==null||l.disconnect(),r=null}function o(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),a();const u=e.getBoundingClientRect(),{left:d,top:f,width:m,height:h}=u;if(l||t(),!m||!h)return;const y=dc(f),v=dc(s.clientWidth-(d+m)),w=dc(s.clientHeight-(f+h)),g=dc(d),p={rootMargin:-y+"px "+-v+"px "+-w+"px "+-g+"px",threshold:ea(0,pi(1,c))||1};let _=!0;function j(k){const N=k[0].intersectionRatio;if(N!==c){if(!_)return o();N?o(!1,N):n=setTimeout(()=>{o(!1,1e-7)},1e3)}N===1&&!jk(u,e.getBoundingClientRect())&&o(),_=!1}try{r=new IntersectionObserver(j,{...p,root:s.ownerDocument})}catch{r=new IntersectionObserver(j,p)}r.observe(e)}return o(!0),a}function yA(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:a=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=n,u=Hg(e),d=s||a?[...u?fl(u):[],...fl(t)]:[];d.forEach(g=>{s&&g.addEventListener("scroll",r,{passive:!0}),a&&g.addEventListener("resize",r)});const f=u&&l?xA(u,r):null;let m=-1,h=null;o&&(h=new ResizeObserver(g=>{let[b]=g;b&&b.target===u&&h&&(h.unobserve(t),cancelAnimationFrame(m),m=requestAnimationFrame(()=>{var p;(p=h)==null||p.observe(t)})),r()}),u&&!c&&h.observe(u),h.observe(t));let y,v=c?la(e):null;c&&w();function w(){const g=la(e);v&&!jk(v,g)&&r(),v=g,y=requestAnimationFrame(w)}return r(),()=>{var g;d.forEach(b=>{s&&b.removeEventListener("scroll",r),a&&b.removeEventListener("resize",r)}),f==null||f(),(g=h)==null||g.disconnect(),h=null,c&&cancelAnimationFrame(y)}}const bA=tA,vA=XO,rb=JO,wA=(e,t,r)=>{const n=new Map,s={platform:gA,...r},a={...s.platform,_c:n};return KO(e,t,{...s,platform:a})};var _A=typeof document<"u",jA=function(){},Vc=_A?x.useLayoutEffect:jA;function Wu(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,s;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!Wu(e[n],t[n]))return!1;return!0}if(s=Object.keys(e),r=s.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,s[n]))return!1;for(n=r;n--!==0;){const a=s[n];if(!(a==="_owner"&&e.$$typeof)&&!Wu(e[a],t[a]))return!1}return!0}return e!==e&&t!==t}function kk(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function nb(e,t){const r=kk(e);return Math.round(t*r)/r}function qf(e){const t=x.useRef(e);return Vc(()=>{t.current=e}),t}function kA(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:s,elements:{reference:a,floating:o}={},transform:l=!0,whileElementsMounted:c,open:u}=e,[d,f]=x.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[m,h]=x.useState(n);Wu(m,n)||h(n);const[y,v]=x.useState(null),[w,g]=x.useState(null),b=x.useCallback(R=>{R!==k.current&&(k.current=R,v(R))},[]),p=x.useCallback(R=>{R!==N.current&&(N.current=R,g(R))},[]),_=a||y,j=o||w,k=x.useRef(null),N=x.useRef(null),S=x.useRef(d),C=c!=null,E=qf(c),T=qf(s),L=qf(u),O=x.useCallback(()=>{if(!k.current||!N.current)return;const R={placement:t,strategy:r,middleware:m};T.current&&(R.platform=T.current),wA(k.current,N.current,R).then(P=>{const D={...P,isPositioned:L.current!==!1};A.current&&!Wu(S.current,D)&&(S.current=D,wl.flushSync(()=>{f(D)}))})},[m,t,r,T,L]);Vc(()=>{u===!1&&S.current.isPositioned&&(S.current.isPositioned=!1,f(R=>({...R,isPositioned:!1})))},[u]);const A=x.useRef(!1);Vc(()=>(A.current=!0,()=>{A.current=!1}),[]),Vc(()=>{if(_&&(k.current=_),j&&(N.current=j),_&&j){if(E.current)return E.current(_,j,O);O()}},[_,j,O,E,C]);const M=x.useMemo(()=>({reference:k,floating:N,setReference:b,setFloating:p}),[b,p]),B=x.useMemo(()=>({reference:_,floating:j}),[_,j]),F=x.useMemo(()=>{const R={position:r,left:0,top:0};if(!B.floating)return R;const P=nb(B.floating,d.x),D=nb(B.floating,d.y);return l?{...R,transform:"translate("+P+"px, "+D+"px)",...kk(B.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:P,top:D}},[r,l,B.floating,d.x,d.y]);return x.useMemo(()=>({...d,update:O,refs:M,elements:B,floatingStyles:F}),[d,O,M,B,F])}const NA=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:s}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?rb({element:n.current,padding:s}).fn(r):{}:n?rb({element:n,padding:s}).fn(r):{}}}},SA=(e,t)=>({...bA(e),options:[e,t]}),CA=(e,t)=>({...vA(e),options:[e,t]}),EA=(e,t)=>({...NA(e),options:[e,t]}),DA={...tw};let sb=!1,PA=0;const ab=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+PA++;function TA(){const[e,t]=x.useState(()=>sb?ab():void 0);return zu(()=>{e==null&&t(ab())},[]),x.useEffect(()=>{sb=!0},[]),e}const LA=DA.useId,Nk=LA||TA,IA=x.forwardRef(function(t,r){const{context:{placement:n,elements:{floating:s},middlewareData:{arrow:a,shift:o}},width:l=14,height:c=7,tipRadius:u=0,strokeWidth:d=0,staticOffset:f,stroke:m,d:h,style:{transform:y,...v}={},...w}=t,g=Nk(),[b,p]=x.useState(!1);if(zu(()=>{if(!s)return;Cr(s).direction==="rtl"&&p(!0)},[s]),!s)return null;const[_,j]=n.split("-"),k=_==="top"||_==="bottom";let N=f;(k&&o!=null&&o.x||!k&&o!=null&&o.y)&&(N=null);const S=d*2,C=S/2,E=l/2*(u/-8+1),T=c/2*u/4,L=!!h,O=N&&j==="end"?"bottom":"top";let A=N&&j==="end"?"right":"left";N&&b&&(A=j==="end"?"left":"right");const M=(a==null?void 0:a.x)!=null?N||a.x:"",B=(a==null?void 0:a.y)!=null?N||a.y:"",F=h||"M0,0"+(" H"+l)+(" L"+(l-E)+","+(c-T))+(" Q"+l/2+","+c+" "+E+","+(c-T))+" Z",R={top:L?"rotate(180deg)":"",left:L?"rotate(90deg)":"rotate(-90deg)",bottom:L?"":"rotate(180deg)",right:L?"rotate(-90deg)":"rotate(90deg)"}[_];return i.jsxs("svg",{...w,"aria-hidden":!0,ref:r,width:L?l:l+S,height:l,viewBox:"0 0 "+l+" "+(c>l?c:l),style:{position:"absolute",pointerEvents:"none",[A]:M,[O]:B,[_]:k||L?"100%":"calc(100% - "+S/2+"px)",transform:[R,y].filter(P=>!!P).join(" "),...v},children:[S>0&&i.jsx("path",{clipPath:"url(#"+g+")",fill:"none",stroke:m,strokeWidth:S+(h?0:1),d:F}),i.jsx("path",{stroke:S&&!h?w.fill:"none",d:F}),i.jsx("clipPath",{id:g,children:i.jsx("rect",{x:-C,y:C*(L?-1:1),width:l+S,height:l})})]})});function RA(){const e=new Map;return{emit(t,r){var n;(n=e.get(t))==null||n.forEach(s=>s(r))},on(t,r){e.has(t)||e.set(t,new Set),e.get(t).add(r)},off(t,r){var n;(n=e.get(t))==null||n.delete(r)}}}const MA=x.createContext(null),OA=x.createContext(null),AA=()=>{var e;return((e=x.useContext(MA))==null?void 0:e.id)||null},$A=()=>x.useContext(OA);function FA(e){const{open:t=!1,onOpenChange:r,elements:n}=e,s=Nk(),a=x.useRef({}),[o]=x.useState(()=>RA()),l=AA()!=null,[c,u]=x.useState(n.reference),d=GO((h,y,v)=>{a.current.openEvent=h?y:void 0,o.emit("openchange",{open:h,event:y,reason:v,nested:l}),r==null||r(h,y,v)}),f=x.useMemo(()=>({setPositionReference:u}),[]),m=x.useMemo(()=>({reference:c||n.reference||null,floating:n.floating||null,domReference:n.reference}),[c,n.reference,n.floating]);return x.useMemo(()=>({dataRef:a,open:t,onOpenChange:d,elements:m,events:o,floatingId:s,refs:f}),[t,d,m,o,s,f])}function BA(e){e===void 0&&(e={});const{nodeId:t}=e,r=FA({...e,elements:{reference:null,floating:null,...e.elements}}),n=e.rootContext||r,s=n.elements,[a,o]=x.useState(null),[l,c]=x.useState(null),d=(s==null?void 0:s.domReference)||a,f=x.useRef(null),m=$A();zu(()=>{d&&(f.current=d)},[d]);const h=kA({...e,elements:{...s,...l&&{reference:l}}}),y=x.useCallback(p=>{const _=$t(p)?{getBoundingClientRect:()=>p.getBoundingClientRect(),getClientRects:()=>p.getClientRects(),contextElement:p}:p;c(_),h.refs.setReference(_)},[h.refs]),v=x.useCallback(p=>{($t(p)||p===null)&&(f.current=p,o(p)),($t(h.refs.reference.current)||h.refs.reference.current===null||p!==null&&!$t(p))&&h.refs.setReference(p)},[h.refs]),w=x.useMemo(()=>({...h.refs,setReference:v,setPositionReference:y,domReference:f}),[h.refs,v,y]),g=x.useMemo(()=>({...h.elements,domReference:d}),[h.elements,d]),b=x.useMemo(()=>({...h,...n,refs:w,elements:g,nodeId:t}),[h,w,g,t,n]);return zu(()=>{n.dataRef.current.floatingContext=b;const p=m==null?void 0:m.nodesRef.current.find(_=>_.id===t);p&&(p.context=b)}),x.useMemo(()=>({...h,context:b,refs:w,elements:g}),[h,w,g,b])}/*!
  react-datepicker v8.7.0
  https://github.com/Hacker0x01/react-datepicker
  Released under the MIT License.
*/var Uh=function(t,r){return Uh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(n[a]=s[a])},Uh(t,r)};function kt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Uh(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var ke=function(){return ke=Object.assign||function(r){for(var n,s=1,a=arguments.length;s<a;s++){n=arguments[s];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])}return r},ke.apply(this,arguments)};function ln(e,t,r){if(r||arguments.length===2)for(var n=0,s=t.length,a;n<s;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}var UA=function(e){var t=e.showTimeSelectOnly,r=t===void 0?!1:t,n=e.showTime,s=n===void 0?!1:n,a=e.className,o=e.children,l=r?"Choose Time":"Choose Date".concat(s?" and Time":"");return H.createElement("div",{className:a,role:"dialog","aria-label":l,"aria-modal":"true"},o)},zA=function(e,t){var r=x.useRef(null),n=x.useRef(e);n.current=e;var s=x.useCallback(function(a){var o,l=a.composed&&a.composedPath&&a.composedPath().find(function(c){return c instanceof Node})||a.target;r.current&&!r.current.contains(l)&&(t&&l instanceof HTMLElement&&l.classList.contains(t)||(o=n.current)===null||o===void 0||o.call(n,a))},[t]);return x.useEffect(function(){return document.addEventListener("mousedown",s),function(){document.removeEventListener("mousedown",s)}},[s]),r},Rd=function(e){var t=e.children,r=e.onClickOutside,n=e.className,s=e.containerRef,a=e.style,o=e.ignoreClass,l=zA(r,o);return H.createElement("div",{className:n,style:a,ref:function(c){l.current=c,s&&(s.current=c)}},t)},se;(function(e){e.ArrowUp="ArrowUp",e.ArrowDown="ArrowDown",e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.PageUp="PageUp",e.PageDown="PageDown",e.Home="Home",e.End="End",e.Enter="Enter",e.Space=" ",e.Tab="Tab",e.Escape="Escape",e.Backspace="Backspace",e.X="x"})(se||(se={}));function Sk(){var e=typeof window<"u"?window:globalThis;return e}var Tl=12;function Re(e){if(e==null)return new Date;var t=typeof e=="string"?Fg(e):oe(e);return Md(t)?t:new Date}function Vf(e,t,r,n,s){s===void 0&&(s=Re());for(var a=xi(r)||xi(qg()),o=Array.isArray(t)?t:[t],l=0,c=o;l<c.length;l++){var u=c[l],d=tO(e,u,s,{locale:a,useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0});if(Md(d)&&(!n||e===Ge(d,u,r)))return d}return null}function Md(e,t){return Mu(e)&&!on(e,new Date("1/1/1800"))}function Ge(e,t,r){if(r==="en")return kr(e,t,{useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0});var n=r?xi(r):void 0;return r&&!n&&console.warn('A locale object was not found for the provided string ["'.concat(r,'"].')),n=n||xi(qg()),kr(e,t,{locale:n,useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0})}function hr(e,t){var r=t.dateFormat,n=t.locale,s=Array.isArray(r)&&r.length>0?r[0]:r;return e&&Ge(e,s,n)||""}var Ck=" - ";function WA(e,t,r){if(!e&&!t)return"";var n=e?hr(e,r):"",s=t?hr(t,r):"",a=r.rangeSeparator||Ck;return"".concat(n).concat(a).concat(s)}function HA(e,t){if(!(e!=null&&e.length))return"";var r=e[0]?hr(e[0],t):"";if(e.length===1)return r;if(e.length===2&&e[1]){var n=hr(e[1],t);return"".concat(r,", ").concat(n)}var s=e.length-1;return"".concat(r," (+").concat(s,")")}function Yf(e,t){var r=t.hour,n=r===void 0?0:r,s=t.minute,a=s===void 0?0:s,o=t.second,l=o===void 0?0:o;return Wc(Hc(qc(e,l),a),n)}function qA(e){return Mg(e)}function VA(e,t){return Ge(e,"ddd",t)}function Yc(e){return Wr(e)}function ps(e,t,r){var n=xi(t||qg());return Bn(e,{locale:n,weekStartsOn:r})}function Rn(e){return nk(e)}function yo(e){return Ed(e)}function ib(e){return Mh(e)}function ob(){return Wr(Re())}function lb(e){return Lg(e)}function YA(e){return cR(e)}function GA(e){return Ig(e)}function en(e,t){return e&&t?aO(e,t):!e&&!t}function At(e,t){return e&&t?nO(e,t):!e&&!t}function Hu(e,t){return e&&t?sO(e,t):!e&&!t}function je(e,t){return e&&t?rR(e,t):!e&&!t}function Ks(e,t){return e&&t?iM(e,t):!e&&!t}function Fs(e,t,r){var n,s=Wr(t),a=Lg(r);try{n=dl(e,{start:s,end:a})}catch{n=!1}return n}function qg(){var e=Sk();return e.__localeId__}function xi(e){if(typeof e=="string"){var t=Sk();return t.__localeData__?t.__localeData__[e]:void 0}else return e}function KA(e,t,r){return t(Ge(e,"EEEE",r))}function QA(e,t){return Ge(e,"EEEEEE",t)}function JA(e,t){return Ge(e,"EEE",t)}function Vg(e,t){return Ge(pr(Re(),e),"LLLL",t)}function Ek(e,t){return Ge(pr(Re(),e),"LLL",t)}function XA(e,t){return Ge(Ca(Re(),e),"QQQ",t)}function yr(e,t){var r=t===void 0?{}:t,n=r.minDate,s=r.maxDate,a=r.excludeDates,o=r.excludeDateIntervals,l=r.includeDates,c=r.includeDateIntervals,u=r.filterDate;return Ll(e,{minDate:n,maxDate:s})||a&&a.some(function(d){return d instanceof Date?je(e,d):je(e,d.date)})||o&&o.some(function(d){var f=d.start,m=d.end;return dl(e,{start:f,end:m})})||l&&!l.some(function(d){return je(e,d)})||c&&!c.some(function(d){var f=d.start,m=d.end;return dl(e,{start:f,end:m})})||u&&!u(Re(e))||!1}function Yg(e,t){var r=t===void 0?{}:t,n=r.excludeDates,s=r.excludeDateIntervals;return s&&s.length>0?s.some(function(a){var o=a.start,l=a.end;return dl(e,{start:o,end:l})}):n&&n.some(function(a){var o;return a instanceof Date?je(e,a):je(e,(o=a.date)!==null&&o!==void 0?o:new Date)})||!1}function Dk(e,t){var r=t===void 0?{}:t,n=r.minDate,s=r.maxDate,a=r.excludeDates,o=r.includeDates,l=r.filterDate;return Ll(e,{minDate:n?nk(n):void 0,maxDate:s?Ig(s):void 0})||(a==null?void 0:a.some(function(c){return At(e,c instanceof Date?c:c.date)}))||o&&!o.some(function(c){return At(e,c)})||l&&!l(Re(e))||!1}function fc(e,t,r,n){var s=ve(e),a=Et(e),o=ve(t),l=Et(t),c=ve(n);return s===o&&s===c?a<=r&&r<=l:s<o?c===s&&a<=r||c===o&&l>=r||c<o&&c>s:!1}function ZA(e,t){var r=t===void 0?{}:t,n=r.minDate,s=r.maxDate,a=r.excludeDates,o=r.includeDates;return Ll(e,{minDate:n,maxDate:s})||a&&a.some(function(l){return At(l instanceof Date?l:l.date,e)})||o&&!o.some(function(l){return At(l,e)})||!1}function mc(e,t){var r=t===void 0?{}:t,n=r.minDate,s=r.maxDate,a=r.excludeDates,o=r.includeDates,l=r.filterDate;return Ll(e,{minDate:n,maxDate:s})||(a==null?void 0:a.some(function(c){return Hu(e,c instanceof Date?c:c.date)}))||o&&!o.some(function(c){return Hu(e,c)})||l&&!l(Re(e))||!1}function hc(e,t,r){if(!t||!r||!Mu(t)||!Mu(r))return!1;var n=ve(t),s=ve(r);return n<=e&&s>=e}function Gc(e,t){var r=t===void 0?{}:t,n=r.minDate,s=r.maxDate,a=r.excludeDates,o=r.includeDates,l=r.filterDate,c=new Date(e,0,1);return Ll(c,{minDate:n?Ed(n):void 0,maxDate:s?sk(s):void 0})||(a==null?void 0:a.some(function(u){return en(c,u instanceof Date?u:u.date)}))||o&&!o.some(function(u){return en(c,u)})||l&&!l(Re(c))||!1}function pc(e,t,r,n){var s=ve(e),a=Xs(e),o=ve(t),l=Xs(t),c=ve(n);return s===o&&s===c?a<=r&&r<=l:s<o?c===s&&a<=r||c===o&&l>=r||c<o&&c>s:!1}function Ll(e,t){var r,n=t===void 0?{}:t,s=n.minDate,a=n.maxDate;return(r=s&&fi(e,s)<0||a&&fi(e,a)>0)!==null&&r!==void 0?r:!1}function cb(e,t){return t.some(function(r){return Ln(r)===Ln(e)&&In(r)===In(e)&&hs(r)===hs(e)})}function ub(e,t){var r=t===void 0?{}:t,n=r.excludeTimes,s=r.includeTimes,a=r.filterTime;return n&&cb(e,n)||s&&!cb(e,s)||a&&!a(e)||!1}function db(e,t){var r=t.minTime,n=t.maxTime;if(!r||!n)throw new Error("Both minTime and maxTime props required");var s=Re();s=Wc(s,Ln(e)),s=Hc(s,In(e)),s=qc(s,hs(e));var a=Re();a=Wc(a,Ln(r)),a=Hc(a,In(r)),a=qc(a,hs(r));var o=Re();o=Wc(o,Ln(n)),o=Hc(o,In(n)),o=qc(o,hs(n));var l;try{l=!dl(s,{start:a,end:o})}catch{l=!1}return l}function fb(e,t){var r=t===void 0?{}:t,n=r.minDate,s=r.includeDates,a=Zs(e,1);return n&&ul(n,a)>0||s&&s.every(function(o){return ul(o,a)>0})||!1}function mb(e,t){var r=t===void 0?{}:t,n=r.maxDate,s=r.includeDates,a=zr(e,1);return n&&ul(a,n)>0||s&&s.every(function(o){return ul(a,o)>0})||!1}function e$(e,t){var r=t===void 0?{}:t,n=r.minDate,s=r.includeDates,a=Ed(e),o=hk(a,1);return n&&Ou(n,o)>0||s&&s.every(function(l){return Ou(l,o)>0})||!1}function t$(e,t){var r=t===void 0?{}:t,n=r.maxDate,s=r.includeDates,a=sk(e),o=Tg(a,1);return n&&Ou(o,n)>0||s&&s.every(function(l){return Ou(o,l)>0})||!1}function hb(e,t){var r=t===void 0?{}:t,n=r.minDate,s=r.includeDates,a=mi(e,1);return n&&Au(n,a)>0||s&&s.every(function(o){return Au(o,a)>0})||!1}function r$(e,t){var r=t===void 0?{}:t,n=r.minDate,s=r.yearItemNumber,a=s===void 0?Tl:s,o=yo(mi(e,a)),l=Cn(o,a).endPeriod,c=n&&ve(n);return c&&c>l||!1}function pb(e,t){var r=t===void 0?{}:t,n=r.maxDate,s=r.includeDates,a=Pn(e,1);return n&&Au(a,n)>0||s&&s.every(function(o){return Au(a,o)>0})||!1}function n$(e,t){var r=t===void 0?{}:t,n=r.maxDate,s=r.yearItemNumber,a=s===void 0?Tl:s,o=Pn(e,a),l=Cn(o,a).startPeriod,c=n&&ve(n);return c&&c<l||!1}function Pk(e){var t=e.minDate,r=e.includeDates;if(r&&t){var n=r.filter(function(s){return fi(s,t)>=0});return By(n)}else return r?By(r):t}function Tk(e){var t=e.maxDate,r=e.includeDates;if(r&&t){var n=r.filter(function(s){return fi(s,t)<=0});return Fy(n)}else return r?Fy(r):t}function gb(e,t){var r;e===void 0&&(e=[]),t===void 0&&(t="react-datepicker__day--highlighted");for(var n=new Map,s=0,a=e.length;s<a;s++){var o=e[s];if(Tn(o)){var l=Ge(o,"MM.dd.yyyy"),c=n.get(l)||[];c.includes(t)||(c.push(t),n.set(l,c))}else if(typeof o=="object"){var u=Object.keys(o),d=(r=u[0])!==null&&r!==void 0?r:"",f=o[d];if(typeof d=="string"&&Array.isArray(f))for(var m=0,h=f.length;m<h;m++){var y=f[m];if(y){var l=Ge(y,"MM.dd.yyyy"),c=n.get(l)||[];c.includes(d)||(c.push(d),n.set(l,c))}}}}return n}function s$(e,t){return e.length!==t.length?!1:e.every(function(r,n){return r===t[n]})}function a$(e,t){e===void 0&&(e=[]),t===void 0&&(t="react-datepicker__day--holidays");var r=new Map;return e.forEach(function(n){var s=n.date,a=n.holidayName;if(Tn(s)){var o=Ge(s,"MM.dd.yyyy"),l=r.get(o)||{className:"",holidayNames:[]};if(!("className"in l&&l.className===t&&s$(l.holidayNames,[a]))){l.className=t;var c=l.holidayNames;l.holidayNames=c?ln(ln([],c,!0),[a],!1):[a],r.set(o,l)}}}),r}function i$(e,t,r,n,s){for(var a=s.length,o=[],l=0;l<a;l++){var c=e,u=s[l];u&&(c=JI(c,Ln(u)),c=Rh(c,In(u)),c=eR(c,hs(u)));var d=Rh(e,(r+1)*n);fn(c,t)&&on(c,d)&&u!=null&&o.push(u)}return o}function xb(e){return e<10?"0".concat(e):"".concat(e)}function Cn(e,t){t===void 0&&(t=Tl);var r=Math.ceil(ve(e)/t)*t,n=r-(t-1);return{startPeriod:n,endPeriod:r}}function o$(e){var t=new Date(e.getFullYear(),e.getMonth(),e.getDate()),r=new Date(e.getFullYear(),e.getMonth(),e.getDate(),24);return Math.round((+r-+t)/36e5)}function yb(e){var t=e.getSeconds(),r=e.getMilliseconds();return oe(e.getTime()-t*1e3-r)}function l$(e,t){return yb(e).getTime()===yb(t).getTime()}function bb(e){if(!Tn(e))throw new Error("Invalid date");var t=new Date(e);return t.setHours(0,0,0,0),t}function Gf(e,t){if(!Tn(e)||!Tn(t))throw new Error("Invalid date received");var r=bb(e),n=bb(t);return on(r,n)}function Lk(e){return e.key===se.Space}var c$=function(e){kt(t,e);function t(r){var n=e.call(this,r)||this;return n.inputRef=H.createRef(),n.onTimeChange=function(s){var a,o;n.setState({time:s});var l=n.props.date,c=l instanceof Date&&!isNaN(+l),u=c?l:new Date;if(s!=null&&s.includes(":")){var d=s.split(":"),f=d[0],m=d[1];u.setHours(Number(f)),u.setMinutes(Number(m))}(o=(a=n.props).onChange)===null||o===void 0||o.call(a,u)},n.renderTimeInput=function(){var s=n.state.time,a=n.props,o=a.date,l=a.timeString,c=a.customTimeInput;return c?x.cloneElement(c,{date:o,value:s,onChange:n.onTimeChange}):H.createElement("input",{type:"time",className:"react-datepicker-time__input",placeholder:"Time",name:"time-input",ref:n.inputRef,onClick:function(){var u;(u=n.inputRef.current)===null||u===void 0||u.focus()},required:!0,value:s,onChange:function(u){n.onTimeChange(u.target.value||l)}})},n.state={time:n.props.timeString},n}return t.getDerivedStateFromProps=function(r,n){return r.timeString!==n.time?{time:r.timeString}:null},t.prototype.render=function(){return H.createElement("div",{className:"react-datepicker__input-time-container"},H.createElement("div",{className:"react-datepicker-time__caption"},this.props.timeInputLabel),H.createElement("div",{className:"react-datepicker-time__input-container"},H.createElement("div",{className:"react-datepicker-time__input"},this.renderTimeInput())))},t}(x.Component),u$=function(e){kt(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.dayEl=x.createRef(),r.handleClick=function(n){!r.isDisabled()&&r.props.onClick&&r.props.onClick(n)},r.handleMouseEnter=function(n){!r.isDisabled()&&r.props.onMouseEnter&&r.props.onMouseEnter(n)},r.handleOnKeyDown=function(n){var s,a,o=n.key;o===se.Space&&(n.preventDefault(),n.key=se.Enter),(a=(s=r.props).handleOnKeyDown)===null||a===void 0||a.call(s,n)},r.isSameDay=function(n){return je(r.props.day,n)},r.isKeyboardSelected=function(){var n;if(r.props.disabledKeyboardNavigation)return!1;var s=r.props.selectsMultiple?(n=r.props.selectedDates)===null||n===void 0?void 0:n.some(function(o){return r.isSameDayOrWeek(o)}):r.isSameDayOrWeek(r.props.selected),a=r.props.preSelection&&r.isDisabled(r.props.preSelection);return!s&&r.isSameDayOrWeek(r.props.preSelection)&&!a},r.isDisabled=function(n){return n===void 0&&(n=r.props.day),yr(n,{minDate:r.props.minDate,maxDate:r.props.maxDate,excludeDates:r.props.excludeDates,excludeDateIntervals:r.props.excludeDateIntervals,includeDateIntervals:r.props.includeDateIntervals,includeDates:r.props.includeDates,filterDate:r.props.filterDate})},r.isExcluded=function(){return Yg(r.props.day,{excludeDates:r.props.excludeDates,excludeDateIntervals:r.props.excludeDateIntervals})},r.isStartOfWeek=function(){return je(r.props.day,ps(r.props.day,r.props.locale,r.props.calendarStartDay))},r.isSameWeek=function(n){return r.props.showWeekPicker&&je(n,ps(r.props.day,r.props.locale,r.props.calendarStartDay))},r.isSameDayOrWeek=function(n){return r.isSameDay(n)||r.isSameWeek(n)},r.getHighLightedClass=function(){var n=r.props,s=n.day,a=n.highlightDates;if(!a)return!1;var o=Ge(s,"MM.dd.yyyy");return a.get(o)},r.getHolidaysClass=function(){var n,s=r.props,a=s.day,o=s.holidays;if(!o)return[void 0];var l=Ge(a,"MM.dd.yyyy");return o.has(l)?[(n=o.get(l))===null||n===void 0?void 0:n.className]:[void 0]},r.isInRange=function(){var n=r.props,s=n.day,a=n.startDate,o=n.endDate;return!a||!o?!1:Fs(s,a,o)},r.isInSelectingRange=function(){var n,s=r.props,a=s.day,o=s.selectsStart,l=s.selectsEnd,c=s.selectsRange,u=s.selectsDisabledDaysInRange,d=s.startDate,f=s.swapRange,m=s.endDate,h=(n=r.props.selectingDate)!==null&&n!==void 0?n:r.props.preSelection;if(!(o||l||c)||!h||!u&&r.isDisabled())return!1;if(o&&m&&(on(h,m)||Ks(h,m)))return Fs(a,h,m);if(l&&d&&(fn(h,d)||Ks(h,d)))return Fs(a,d,h);if(c&&d&&!m){if(Ks(h,d)||fn(h,d))return Fs(a,d,h);if(f&&on(h,d))return Fs(a,h,d)}return!1},r.isSelectingRangeStart=function(){var n;if(!r.isInSelectingRange())return!1;var s=r.props,a=s.day,o=s.startDate,l=s.selectsStart,c=s.swapRange,u=s.selectsRange,d=(n=r.props.selectingDate)!==null&&n!==void 0?n:r.props.preSelection;return l?je(a,d):u&&c&&o&&d?je(a,on(d,o)?d:o):je(a,o)},r.isSelectingRangeEnd=function(){var n;if(!r.isInSelectingRange())return!1;var s=r.props,a=s.day,o=s.endDate,l=s.selectsEnd,c=s.selectsRange,u=s.swapRange,d=s.startDate,f=(n=r.props.selectingDate)!==null&&n!==void 0?n:r.props.preSelection;return l?je(a,f):c&&u&&d&&f?je(a,on(f,d)?d:f):c?je(a,f):je(a,o)},r.isRangeStart=function(){var n=r.props,s=n.day,a=n.startDate,o=n.endDate;return!a||!o?!1:je(a,s)},r.isRangeEnd=function(){var n=r.props,s=n.day,a=n.startDate,o=n.endDate;return!a||!o?!1:je(o,s)},r.isWeekend=function(){var n=rM(r.props.day);return n===0||n===6},r.isAfterMonth=function(){return r.props.month!==void 0&&(r.props.month+1)%12===Et(r.props.day)},r.isBeforeMonth=function(){return r.props.month!==void 0&&(Et(r.props.day)+1)%12===r.props.month},r.isCurrentDay=function(){return r.isSameDay(Re())},r.isSelected=function(){var n;return r.props.selectsMultiple?(n=r.props.selectedDates)===null||n===void 0?void 0:n.some(function(s){return r.isSameDayOrWeek(s)}):r.isSameDayOrWeek(r.props.selected)},r.getClassNames=function(n){var s=r.props.dayClassName?r.props.dayClassName(n):void 0;return wt("react-datepicker__day",s,"react-datepicker__day--"+VA(r.props.day),{"react-datepicker__day--disabled":r.isDisabled(),"react-datepicker__day--excluded":r.isExcluded(),"react-datepicker__day--selected":r.isSelected(),"react-datepicker__day--keyboard-selected":r.isKeyboardSelected(),"react-datepicker__day--range-start":r.isRangeStart(),"react-datepicker__day--range-end":r.isRangeEnd(),"react-datepicker__day--in-range":r.isInRange(),"react-datepicker__day--in-selecting-range":r.isInSelectingRange(),"react-datepicker__day--selecting-range-start":r.isSelectingRangeStart(),"react-datepicker__day--selecting-range-end":r.isSelectingRangeEnd(),"react-datepicker__day--today":r.isCurrentDay(),"react-datepicker__day--weekend":r.isWeekend(),"react-datepicker__day--outside-month":r.isAfterMonth()||r.isBeforeMonth()},r.getHighLightedClass(),r.getHolidaysClass())},r.getAriaLabel=function(){var n=r.props,s=n.day,a=n.ariaLabelPrefixWhenEnabled,o=a===void 0?"Choose":a,l=n.ariaLabelPrefixWhenDisabled,c=l===void 0?"Not available":l,u=r.isDisabled()||r.isExcluded()?c:o;return"".concat(u," ").concat(Ge(s,"PPPP",r.props.locale))},r.getTitle=function(){var n=r.props,s=n.day,a=n.holidays,o=a===void 0?new Map:a,l=n.excludeDates,c=Ge(s,"MM.dd.yyyy"),u=[];return o.has(c)&&u.push.apply(u,o.get(c).holidayNames),r.isExcluded()&&u.push(l==null?void 0:l.filter(function(d){return d instanceof Date?je(d,s):je(d==null?void 0:d.date,s)}).map(function(d){if(!(d instanceof Date))return d==null?void 0:d.message})),u.join(", ")},r.getTabIndex=function(){var n=r.props.selected,s=r.props.preSelection,a=!(r.props.showWeekPicker&&(r.props.showWeekNumber||!r.isStartOfWeek()))&&(r.isKeyboardSelected()||r.isSameDay(n)&&je(s,n))?0:-1;return a},r.handleFocusDay=function(){var n;r.shouldFocusDay()&&((n=r.dayEl.current)===null||n===void 0||n.focus({preventScroll:!0}))},r.renderDayContents=function(){return r.props.monthShowsDuplicateDaysEnd&&r.isAfterMonth()||r.props.monthShowsDuplicateDaysStart&&r.isBeforeMonth()?null:r.props.renderDayContents?r.props.renderDayContents(Yy(r.props.day),r.props.day):Yy(r.props.day)},r.render=function(){return H.createElement("div",{ref:r.dayEl,className:r.getClassNames(r.props.day),onKeyDown:r.handleOnKeyDown,onClick:r.handleClick,onMouseEnter:r.props.usePointerEvent?void 0:r.handleMouseEnter,onPointerEnter:r.props.usePointerEvent?r.handleMouseEnter:void 0,tabIndex:r.getTabIndex(),"aria-label":r.getAriaLabel(),role:"gridcell",title:r.getTitle(),"aria-disabled":r.isDisabled(),"aria-current":r.isCurrentDay()?"date":void 0,"aria-selected":r.isSelected()||r.isInRange()},r.renderDayContents(),r.getTitle()!==""&&H.createElement("span",{className:"overlay"},r.getTitle()))},r}return t.prototype.componentDidMount=function(){this.handleFocusDay()},t.prototype.componentDidUpdate=function(){this.handleFocusDay()},t.prototype.shouldFocusDay=function(){var r=!1;return this.getTabIndex()===0&&this.isSameDay(this.props.preSelection)&&((!document.activeElement||document.activeElement===document.body)&&(r=!0),this.props.inline&&!this.props.shouldFocusDayInline&&(r=!1),this.isDayActiveElement()&&(r=!0),this.isDuplicateDay()&&(r=!1)),r},t.prototype.isDayActiveElement=function(){var r,n,s;return((n=(r=this.props.containerRef)===null||r===void 0?void 0:r.current)===null||n===void 0?void 0:n.contains(document.activeElement))&&((s=document.activeElement)===null||s===void 0?void 0:s.classList.contains("react-datepicker__day"))},t.prototype.isDuplicateDay=function(){return this.props.monthShowsDuplicateDaysEnd&&this.isAfterMonth()||this.props.monthShowsDuplicateDaysStart&&this.isBeforeMonth()},t}(x.Component),d$=function(e){kt(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.weekNumberEl=x.createRef(),r.handleClick=function(n){r.props.onClick&&r.props.onClick(n)},r.handleOnKeyDown=function(n){var s,a,o=n.key;o===se.Space&&(n.preventDefault(),n.key=se.Enter),(a=(s=r.props).handleOnKeyDown)===null||a===void 0||a.call(s,n)},r.isKeyboardSelected=function(){return!r.props.disabledKeyboardNavigation&&!je(r.props.date,r.props.selected)&&je(r.props.date,r.props.preSelection)},r.getTabIndex=function(){return r.props.showWeekPicker&&r.props.showWeekNumber&&(r.isKeyboardSelected()||je(r.props.date,r.props.selected)&&je(r.props.preSelection,r.props.selected))?0:-1},r.handleFocusWeekNumber=function(n){var s=!1;r.getTabIndex()===0&&!(n!=null&&n.isInputFocused)&&je(r.props.date,r.props.preSelection)&&((!document.activeElement||document.activeElement===document.body)&&(s=!0),r.props.inline&&!r.props.shouldFocusDayInline&&(s=!1),r.props.containerRef&&r.props.containerRef.current&&r.props.containerRef.current.contains(document.activeElement)&&document.activeElement&&document.activeElement.classList.contains("react-datepicker__week-number")&&(s=!0)),s&&r.weekNumberEl.current&&r.weekNumberEl.current.focus({preventScroll:!0})},r}return Object.defineProperty(t,"defaultProps",{get:function(){return{ariaLabelPrefix:"week "}},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){this.handleFocusWeekNumber()},t.prototype.componentDidUpdate=function(r){this.handleFocusWeekNumber(r)},t.prototype.render=function(){var r=this.props,n=r.weekNumber,s=r.isWeekDisabled,a=r.ariaLabelPrefix,o=a===void 0?t.defaultProps.ariaLabelPrefix:a,l=r.onClick,c={"react-datepicker__week-number":!0,"react-datepicker__week-number--clickable":!!l&&!s,"react-datepicker__week-number--selected":!!l&&je(this.props.date,this.props.selected)};return H.createElement("div",{ref:this.weekNumberEl,className:wt(c),"aria-label":"".concat(o," ").concat(this.props.weekNumber),onClick:this.handleClick,onKeyDown:this.handleOnKeyDown,tabIndex:this.getTabIndex(),role:"gridcell"},n)},t}(x.Component),f$=function(e){kt(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.isDisabled=function(n){return yr(n,{minDate:r.props.minDate,maxDate:r.props.maxDate,excludeDates:r.props.excludeDates,excludeDateIntervals:r.props.excludeDateIntervals,includeDateIntervals:r.props.includeDateIntervals,includeDates:r.props.includeDates,filterDate:r.props.filterDate})},r.handleDayClick=function(n,s){r.props.onDayClick&&r.props.onDayClick(n,s)},r.handleDayMouseEnter=function(n){r.props.onDayMouseEnter&&r.props.onDayMouseEnter(n)},r.handleWeekClick=function(n,s,a){for(var o,l,c,u=new Date(n),d=0;d<7;d++){var f=new Date(n);f.setDate(f.getDate()+d);var m=!r.isDisabled(f);if(m){u=f;break}}typeof r.props.onWeekSelect=="function"&&r.props.onWeekSelect(u,s,a),r.props.showWeekPicker&&r.handleDayClick(u,a),((o=r.props.shouldCloseOnSelect)!==null&&o!==void 0?o:t.defaultProps.shouldCloseOnSelect)&&((c=(l=r.props).setOpen)===null||c===void 0||c.call(l,!1))},r.formatWeekNumber=function(n){return r.props.formatWeekNumber?r.props.formatWeekNumber(n):qA(n)},r.isWeekDisabled=function(){for(var n=r.startOfWeek(),s=Fr(n,6),a=new Date(n);a<=s;){if(!r.isDisabled(a))return!1;a=Fr(a,1)}return!0},r.renderDays=function(){var n=r.startOfWeek(),s=[],a=r.formatWeekNumber(n);if(r.props.showWeekNumber){var o=r.props.onWeekSelect||r.props.showWeekPicker?r.handleWeekClick.bind(r,n,a):void 0;s.push(H.createElement(d$,ke({key:"W"},t.defaultProps,r.props,{weekNumber:a,isWeekDisabled:r.isWeekDisabled(),date:n,onClick:o})))}return s.concat([0,1,2,3,4,5,6].map(function(l){var c=Fr(n,l);return H.createElement(u$,ke({},t.defaultProps,r.props,{ariaLabelPrefixWhenEnabled:r.props.chooseDayAriaLabelPrefix,ariaLabelPrefixWhenDisabled:r.props.disabledDayAriaLabelPrefix,key:c.valueOf(),day:c,onClick:r.handleDayClick.bind(r,c),onMouseEnter:r.handleDayMouseEnter.bind(r,c)}))}))},r.startOfWeek=function(){return ps(r.props.day,r.props.locale,r.props.calendarStartDay)},r.isKeyboardSelected=function(){return!r.props.disabledKeyboardNavigation&&!je(r.startOfWeek(),r.props.selected)&&je(r.startOfWeek(),r.props.preSelection)},r}return Object.defineProperty(t,"defaultProps",{get:function(){return{shouldCloseOnSelect:!0}},enumerable:!1,configurable:!0}),t.prototype.render=function(){var r={"react-datepicker__week":!0,"react-datepicker__week--selected":je(this.startOfWeek(),this.props.selected),"react-datepicker__week--keyboard-selected":this.isKeyboardSelected()},n=this.props.weekClassName?this.props.weekClassName(this.startOfWeek()):void 0;return H.createElement("div",{className:wt(r,n),role:"row"},this.renderDays())},t}(x.Component),Zi,m$=6,Qa={TWO_COLUMNS:"two_columns",THREE_COLUMNS:"three_columns",FOUR_COLUMNS:"four_columns"},Kf=(Zi={},Zi[Qa.TWO_COLUMNS]={grid:[[0,1],[2,3],[4,5],[6,7],[8,9],[10,11]],verticalNavigationOffset:2},Zi[Qa.THREE_COLUMNS]={grid:[[0,1,2],[3,4,5],[6,7,8],[9,10,11]],verticalNavigationOffset:3},Zi[Qa.FOUR_COLUMNS]={grid:[[0,1,2,3],[4,5,6,7],[8,9,10,11]],verticalNavigationOffset:4},Zi),gc=1;function vb(e,t){return e?Qa.FOUR_COLUMNS:t?Qa.TWO_COLUMNS:Qa.THREE_COLUMNS}var h$=function(e){kt(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.MONTH_REFS=ln([],Array(12),!0).map(function(){return x.createRef()}),r.QUARTER_REFS=ln([],Array(4),!0).map(function(){return x.createRef()}),r.isDisabled=function(n){return yr(n,{minDate:r.props.minDate,maxDate:r.props.maxDate,excludeDates:r.props.excludeDates,excludeDateIntervals:r.props.excludeDateIntervals,includeDateIntervals:r.props.includeDateIntervals,includeDates:r.props.includeDates,filterDate:r.props.filterDate})},r.isExcluded=function(n){return Yg(n,{excludeDates:r.props.excludeDates,excludeDateIntervals:r.props.excludeDateIntervals})},r.handleDayClick=function(n,s){var a,o;(o=(a=r.props).onDayClick)===null||o===void 0||o.call(a,n,s,r.props.orderInDisplay)},r.handleDayMouseEnter=function(n){var s,a;(a=(s=r.props).onDayMouseEnter)===null||a===void 0||a.call(s,n)},r.handleMouseLeave=function(){var n,s;(s=(n=r.props).onMouseLeave)===null||s===void 0||s.call(n)},r.isRangeStartMonth=function(n){var s=r.props,a=s.day,o=s.startDate,l=s.endDate;return!o||!l?!1:At(pr(a,n),o)},r.isRangeStartQuarter=function(n){var s=r.props,a=s.day,o=s.startDate,l=s.endDate;return!o||!l?!1:Hu(Ca(a,n),o)},r.isRangeEndMonth=function(n){var s=r.props,a=s.day,o=s.startDate,l=s.endDate;return!o||!l?!1:At(pr(a,n),l)},r.isRangeEndQuarter=function(n){var s=r.props,a=s.day,o=s.startDate,l=s.endDate;return!o||!l?!1:Hu(Ca(a,n),l)},r.isInSelectingRangeMonth=function(n){var s,a=r.props,o=a.day,l=a.selectsStart,c=a.selectsEnd,u=a.selectsRange,d=a.startDate,f=a.endDate,m=(s=r.props.selectingDate)!==null&&s!==void 0?s:r.props.preSelection;return!(l||c||u)||!m?!1:l&&f?fc(m,f,n,o):c&&d||u&&d&&!f?fc(d,m,n,o):!1},r.isSelectingMonthRangeStart=function(n){var s;if(!r.isInSelectingRangeMonth(n))return!1;var a=r.props,o=a.day,l=a.startDate,c=a.selectsStart,u=pr(o,n),d=(s=r.props.selectingDate)!==null&&s!==void 0?s:r.props.preSelection;return c?At(u,d):At(u,l)},r.isSelectingMonthRangeEnd=function(n){var s;if(!r.isInSelectingRangeMonth(n))return!1;var a=r.props,o=a.day,l=a.endDate,c=a.selectsEnd,u=a.selectsRange,d=pr(o,n),f=(s=r.props.selectingDate)!==null&&s!==void 0?s:r.props.preSelection;return c||u?At(d,f):At(d,l)},r.isInSelectingRangeQuarter=function(n){var s,a=r.props,o=a.day,l=a.selectsStart,c=a.selectsEnd,u=a.selectsRange,d=a.startDate,f=a.endDate,m=(s=r.props.selectingDate)!==null&&s!==void 0?s:r.props.preSelection;return!(l||c||u)||!m?!1:l&&f?pc(m,f,n,o):c&&d||u&&d&&!f?pc(d,m,n,o):!1},r.isWeekInMonth=function(n){var s=r.props.day,a=Fr(n,6);return At(n,s)||At(a,s)},r.isCurrentMonth=function(n,s){return ve(n)===ve(Re())&&s===Et(Re())},r.isCurrentQuarter=function(n,s){return ve(n)===ve(Re())&&s===Xs(Re())},r.isSelectedMonth=function(n,s,a){return Et(a)===s&&ve(n)===ve(a)},r.isSelectMonthInList=function(n,s,a){return a.some(function(o){return r.isSelectedMonth(n,s,o)})},r.isSelectedQuarter=function(n,s,a){return Xs(n)===s&&ve(n)===ve(a)},r.isMonthSelected=function(){var n=r.props,s=n.day,a=n.selected,o=n.selectedDates,l=n.selectsMultiple,c=Et(s);return l?o==null?void 0:o.some(function(u){return r.isSelectedMonth(s,c,u)}):!!a&&r.isSelectedMonth(s,c,a)},r.renderWeeks=function(){for(var n=[],s=r.props.fixedHeight,a=0,o=!1,l=ps(Rn(r.props.day),r.props.locale,r.props.calendarStartDay),c=function(y){return r.props.showWeekPicker?ps(y,r.props.locale,r.props.calendarStartDay):r.props.preSelection},u=function(y){return r.props.showWeekPicker?ps(y,r.props.locale,r.props.calendarStartDay):r.props.selected},d=r.props.selected?u(r.props.selected):void 0,f=r.props.preSelection?c(r.props.preSelection):void 0;n.push(H.createElement(f$,ke({},r.props,{ariaLabelPrefix:r.props.weekAriaLabelPrefix,key:a,day:l,month:Et(r.props.day),onDayClick:r.handleDayClick,onDayMouseEnter:r.handleDayMouseEnter,selected:d,preSelection:f,showWeekNumber:r.props.showWeekNumbers}))),!o;){a++,l=Ru(l,1);var m=s&&a>=m$,h=!s&&!r.isWeekInMonth(l);if(m||h)if(r.props.peekNextMonth)o=!0;else break}return n},r.onMonthClick=function(n,s){var a=r.isMonthDisabledForLabelDate(s),o=a.isDisabled,l=a.labelDate;o||r.handleDayClick(Rn(l),n)},r.onMonthMouseEnter=function(n){var s=r.isMonthDisabledForLabelDate(n),a=s.isDisabled,o=s.labelDate;a||r.handleDayMouseEnter(Rn(o))},r.handleMonthNavigation=function(n,s){var a,o,l,c;(o=(a=r.props).setPreSelection)===null||o===void 0||o.call(a,s),(c=(l=r.MONTH_REFS[n])===null||l===void 0?void 0:l.current)===null||c===void 0||c.focus()},r.handleKeyboardNavigation=function(n,s,a){var o,l=r.props,c=l.selected,u=l.preSelection,d=l.setPreSelection,f=l.minDate,m=l.maxDate,h=l.showFourColumnMonthYearPicker,y=l.showTwoColumnMonthYearPicker;if(u){var v=vb(h,y),w=r.getVerticalOffset(v),g=(o=Kf[v])===null||o===void 0?void 0:o.grid,b=function(N,S,C){var E,T,L=S,O=C;switch(N){case se.ArrowRight:L=zr(S,gc),O=C===11?0:C+gc;break;case se.ArrowLeft:L=Zs(S,gc),O=C===0?11:C-gc;break;case se.ArrowUp:L=Zs(S,w),O=!((E=g==null?void 0:g[0])===null||E===void 0)&&E.includes(C)?C+12-w:C-w;break;case se.ArrowDown:L=zr(S,w),O=!((T=g==null?void 0:g[g.length-1])===null||T===void 0)&&T.includes(C)?C-12+w:C+w;break}return{newCalculatedDate:L,newCalculatedMonth:O}},p=function(N,S,C){for(var E=40,T=N,L=!1,O=0,A=b(T,S,C),M=A.newCalculatedDate,B=A.newCalculatedMonth;!L;){if(O>=E){M=S,B=C;break}if(f&&M<f){T=se.ArrowRight;var F=b(T,M,B);M=F.newCalculatedDate,B=F.newCalculatedMonth}if(m&&M>m){T=se.ArrowLeft;var F=b(T,M,B);M=F.newCalculatedDate,B=F.newCalculatedMonth}if(ZA(M,r.props)){var F=b(T,M,B);M=F.newCalculatedDate,B=F.newCalculatedMonth}else L=!0;O++}return{newCalculatedDate:M,newCalculatedMonth:B}};if(s===se.Enter){r.isMonthDisabled(a)||(r.onMonthClick(n,a),d==null||d(c));return}var _=p(s,u,a),j=_.newCalculatedDate,k=_.newCalculatedMonth;switch(s){case se.ArrowRight:case se.ArrowLeft:case se.ArrowUp:case se.ArrowDown:r.handleMonthNavigation(k,j);break}}},r.getVerticalOffset=function(n){var s,a;return(a=(s=Kf[n])===null||s===void 0?void 0:s.verticalNavigationOffset)!==null&&a!==void 0?a:0},r.onMonthKeyDown=function(n,s){var a=r.props,o=a.disabledKeyboardNavigation,l=a.handleOnMonthKeyDown,c=n.key;c!==se.Tab&&n.preventDefault(),o||r.handleKeyboardNavigation(n,c,s),l&&l(n)},r.onQuarterClick=function(n,s){var a=Ca(r.props.day,s);mc(a,r.props)||r.handleDayClick(ib(a),n)},r.onQuarterMouseEnter=function(n){var s=Ca(r.props.day,n);mc(s,r.props)||r.handleDayMouseEnter(ib(s))},r.handleQuarterNavigation=function(n,s){var a,o,l,c;r.isDisabled(s)||r.isExcluded(s)||((o=(a=r.props).setPreSelection)===null||o===void 0||o.call(a,s),(c=(l=r.QUARTER_REFS[n-1])===null||l===void 0?void 0:l.current)===null||c===void 0||c.focus())},r.onQuarterKeyDown=function(n,s){var a,o,l=n.key;if(!r.props.disabledKeyboardNavigation)switch(l){case se.Enter:r.onQuarterClick(n,s),(o=(a=r.props).setPreSelection)===null||o===void 0||o.call(a,r.props.selected);break;case se.ArrowRight:if(!r.props.preSelection)break;r.handleQuarterNavigation(s===4?1:s+1,Tg(r.props.preSelection,1));break;case se.ArrowLeft:if(!r.props.preSelection)break;r.handleQuarterNavigation(s===1?4:s-1,hk(r.props.preSelection,1));break}},r.isMonthDisabledForLabelDate=function(n){var s,a=r.props,o=a.day,l=a.minDate,c=a.maxDate,u=a.excludeDates,d=a.includeDates,f=pr(o,n);return{isDisabled:(s=(l||c||u||d)&&Dk(f,r.props))!==null&&s!==void 0?s:!1,labelDate:f}},r.isMonthDisabled=function(n){var s=r.isMonthDisabledForLabelDate(n).isDisabled;return s},r.getMonthClassNames=function(n){var s=r.props,a=s.day,o=s.startDate,l=s.endDate,c=s.preSelection,u=s.monthClassName,d=u?u(pr(a,n)):void 0,f=r.getSelection();return wt("react-datepicker__month-text","react-datepicker__month-".concat(n),d,{"react-datepicker__month-text--disabled":r.isMonthDisabled(n),"react-datepicker__month-text--selected":f?r.isSelectMonthInList(a,n,f):void 0,"react-datepicker__month-text--keyboard-selected":!r.props.disabledKeyboardNavigation&&c&&r.isSelectedMonth(a,n,c)&&!r.isMonthSelected()&&!r.isMonthDisabled(n),"react-datepicker__month-text--in-selecting-range":r.isInSelectingRangeMonth(n),"react-datepicker__month-text--in-range":o&&l?fc(o,l,n,a):void 0,"react-datepicker__month-text--range-start":r.isRangeStartMonth(n),"react-datepicker__month-text--range-end":r.isRangeEndMonth(n),"react-datepicker__month-text--selecting-range-start":r.isSelectingMonthRangeStart(n),"react-datepicker__month-text--selecting-range-end":r.isSelectingMonthRangeEnd(n),"react-datepicker__month-text--today":r.isCurrentMonth(a,n)})},r.getTabIndex=function(n){if(r.props.preSelection==null)return"-1";var s=Et(r.props.preSelection),a=r.isMonthDisabledForLabelDate(s).isDisabled,o=n===s&&!(a||r.props.disabledKeyboardNavigation)?"0":"-1";return o},r.getQuarterTabIndex=function(n){if(r.props.preSelection==null)return"-1";var s=Xs(r.props.preSelection),a=mc(r.props.day,r.props),o=n===s&&!(a||r.props.disabledKeyboardNavigation)?"0":"-1";return o},r.getAriaLabel=function(n){var s=r.props,a=s.chooseDayAriaLabelPrefix,o=a===void 0?"Choose":a,l=s.disabledDayAriaLabelPrefix,c=l===void 0?"Not available":l,u=s.day,d=s.locale,f=pr(u,n),m=r.isDisabled(f)||r.isExcluded(f)?c:o;return"".concat(m," ").concat(Ge(f,"MMMM yyyy",d))},r.getQuarterClassNames=function(n){var s=r.props,a=s.day,o=s.startDate,l=s.endDate,c=s.selected,u=s.minDate,d=s.maxDate,f=s.excludeDates,m=s.includeDates,h=s.filterDate,y=s.preSelection,v=s.disabledKeyboardNavigation,w=(u||d||f||m||h)&&mc(Ca(a,n),r.props);return wt("react-datepicker__quarter-text","react-datepicker__quarter-".concat(n),{"react-datepicker__quarter-text--disabled":w,"react-datepicker__quarter-text--selected":c?r.isSelectedQuarter(a,n,c):void 0,"react-datepicker__quarter-text--keyboard-selected":!v&&y&&r.isSelectedQuarter(a,n,y)&&!w,"react-datepicker__quarter-text--in-selecting-range":r.isInSelectingRangeQuarter(n),"react-datepicker__quarter-text--in-range":o&&l?pc(o,l,n,a):void 0,"react-datepicker__quarter-text--range-start":r.isRangeStartQuarter(n),"react-datepicker__quarter-text--range-end":r.isRangeEndQuarter(n),"react-datepicker__quarter-text--today":r.isCurrentQuarter(a,n)})},r.getMonthContent=function(n){var s=r.props,a=s.showFullMonthYearPicker,o=s.renderMonthContent,l=s.locale,c=s.day,u=Ek(n,l),d=Vg(n,l);return o?o(n,u,d,c):a?d:u},r.getQuarterContent=function(n){var s,a=r.props,o=a.renderQuarterContent,l=a.locale,c=XA(n,l);return(s=o==null?void 0:o(n,c))!==null&&s!==void 0?s:c},r.renderMonths=function(){var n,s=r.props,a=s.showTwoColumnMonthYearPicker,o=s.showFourColumnMonthYearPicker,l=s.day,c=s.selected,u=(n=Kf[vb(o,a)])===null||n===void 0?void 0:n.grid;return u==null?void 0:u.map(function(d,f){return H.createElement("div",{className:"react-datepicker__month-wrapper",key:f},d.map(function(m,h){return H.createElement("div",{ref:r.MONTH_REFS[m],key:h,onClick:function(y){r.onMonthClick(y,m)},onKeyDown:function(y){Lk(y)&&(y.preventDefault(),y.key=se.Enter),r.onMonthKeyDown(y,m)},onMouseEnter:r.props.usePointerEvent?void 0:function(){return r.onMonthMouseEnter(m)},onPointerEnter:r.props.usePointerEvent?function(){return r.onMonthMouseEnter(m)}:void 0,tabIndex:Number(r.getTabIndex(m)),className:r.getMonthClassNames(m),"aria-disabled":r.isMonthDisabled(m),role:"option","aria-label":r.getAriaLabel(m),"aria-current":r.isCurrentMonth(l,m)?"date":void 0,"aria-selected":c?r.isSelectedMonth(l,m,c):void 0},r.getMonthContent(m))}))})},r.renderQuarters=function(){var n=r.props,s=n.day,a=n.selected,o=[1,2,3,4];return H.createElement("div",{className:"react-datepicker__quarter-wrapper"},o.map(function(l,c){return H.createElement("div",{key:c,ref:r.QUARTER_REFS[c],role:"option",onClick:function(u){r.onQuarterClick(u,l)},onKeyDown:function(u){r.onQuarterKeyDown(u,l)},onMouseEnter:r.props.usePointerEvent?void 0:function(){return r.onQuarterMouseEnter(l)},onPointerEnter:r.props.usePointerEvent?function(){return r.onQuarterMouseEnter(l)}:void 0,className:r.getQuarterClassNames(l),"aria-selected":a?r.isSelectedQuarter(s,l,a):void 0,tabIndex:Number(r.getQuarterTabIndex(l)),"aria-current":r.isCurrentQuarter(s,l)?"date":void 0},r.getQuarterContent(l))}))},r.getClassNames=function(){var n=r.props,s=n.selectingDate,a=n.selectsStart,o=n.selectsEnd,l=n.showMonthYearPicker,c=n.showQuarterYearPicker,u=n.showWeekPicker;return wt("react-datepicker__month",{"react-datepicker__month--selecting-range":s&&(a||o)},{"react-datepicker__monthPicker":l},{"react-datepicker__quarterPicker":c},{"react-datepicker__weekPicker":u})},r}return t.prototype.getSelection=function(){var r=this.props,n=r.selected,s=r.selectedDates,a=r.selectsMultiple;if(a)return s;if(n)return[n]},t.prototype.render=function(){var r=this.props,n=r.showMonthYearPicker,s=r.showQuarterYearPicker,a=r.day,o=r.ariaLabelPrefix,l=o===void 0?"Month ":o,c=l?l.trim()+" ":"",u=n||s;return u?H.createElement("div",{className:this.getClassNames(),onMouseLeave:this.props.usePointerEvent?void 0:this.handleMouseLeave,onPointerLeave:this.props.usePointerEvent?this.handleMouseLeave:void 0,"aria-label":"".concat(c).concat(Ge(a,"MMMM, yyyy",this.props.locale)),role:"listbox"},n?this.renderMonths():this.renderQuarters()):H.createElement("div",{role:"table"},this.props.dayNamesHeader&&H.createElement("div",{role:"rowgroup"},this.props.dayNamesHeader),H.createElement("div",{className:this.getClassNames(),onMouseLeave:this.props.usePointerEvent?void 0:this.handleMouseLeave,onPointerLeave:this.props.usePointerEvent?this.handleMouseLeave:void 0,"aria-label":"".concat(c).concat(Ge(a,"MMMM, yyyy",this.props.locale)),role:"rowgroup"},this.renderWeeks()))},t}(x.Component),p$=function(e){kt(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.monthOptionButtonsRef={},r.isSelectedMonth=function(n){return r.props.month===n},r.handleOptionKeyDown=function(n,s){var a;switch(s.key){case"Enter":s.preventDefault(),r.onChange(n);break;case"Escape":s.preventDefault(),r.props.onCancel();break;case"ArrowUp":case"ArrowDown":{s.preventDefault();var o=(n+(s.key==="ArrowUp"?-1:1)+r.props.monthNames.length)%r.props.monthNames.length;(a=r.monthOptionButtonsRef[o])===null||a===void 0||a.focus();break}}},r.renderOptions=function(){return r.monthOptionButtonsRef={},r.props.monthNames.map(function(n,s){return H.createElement("div",{ref:function(a){r.monthOptionButtonsRef[s]=a,r.isSelectedMonth(s)&&(a==null||a.focus())},role:"button",tabIndex:0,className:r.isSelectedMonth(s)?"react-datepicker__month-option react-datepicker__month-option--selected_month":"react-datepicker__month-option",key:n,onClick:r.onChange.bind(r,s),onKeyDown:r.handleOptionKeyDown.bind(r,s),"aria-selected":r.isSelectedMonth(s)?"true":void 0},r.isSelectedMonth(s)?H.createElement("span",{className:"react-datepicker__month-option--selected"},""):"",n)})},r.onChange=function(n){return r.props.onChange(n)},r.handleClickOutside=function(){return r.props.onCancel()},r}return t.prototype.render=function(){return H.createElement(Rd,{className:"react-datepicker__month-dropdown",onClickOutside:this.handleClickOutside},this.renderOptions())},t}(x.Component),g$=function(e){kt(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.state={dropdownVisible:!1},r.renderSelectOptions=function(n){return n.map(function(s,a){return H.createElement("option",{key:s,value:a},s)})},r.renderSelectMode=function(n){return H.createElement("select",{value:r.props.month,className:"react-datepicker__month-select",onChange:function(s){return r.onChange(parseInt(s.target.value))}},r.renderSelectOptions(n))},r.renderReadView=function(n,s){return H.createElement("button",{key:"read",type:"button",style:{visibility:n?"visible":"hidden"},className:"react-datepicker__month-read-view",onClick:r.toggleDropdown},H.createElement("span",{className:"react-datepicker__month-read-view--down-arrow"}),H.createElement("span",{className:"react-datepicker__month-read-view--selected-month"},s[r.props.month]))},r.renderDropdown=function(n){return H.createElement(p$,ke({key:"dropdown"},r.props,{monthNames:n,onChange:r.onChange,onCancel:r.toggleDropdown}))},r.renderScrollMode=function(n){var s=r.state.dropdownVisible,a=[r.renderReadView(!s,n)];return s&&a.unshift(r.renderDropdown(n)),a},r.onChange=function(n){r.toggleDropdown(),n!==r.props.month&&r.props.onChange(n)},r.toggleDropdown=function(){return r.setState({dropdownVisible:!r.state.dropdownVisible})},r}return t.prototype.render=function(){var r=this,n=[0,1,2,3,4,5,6,7,8,9,10,11].map(this.props.useShortMonthInDropdown?function(a){return Ek(a,r.props.locale)}:function(a){return Vg(a,r.props.locale)}),s;switch(this.props.dropdownMode){case"scroll":s=this.renderScrollMode(n);break;case"select":s=this.renderSelectMode(n);break}return H.createElement("div",{className:"react-datepicker__month-dropdown-container react-datepicker__month-dropdown-container--".concat(this.props.dropdownMode)},s)},t}(x.Component);function x$(e,t){for(var r=[],n=Rn(e),s=Rn(t);!fn(n,s);)r.push(Re(n)),n=zr(n,1);return r}var y$=function(e){kt(t,e);function t(r){var n=e.call(this,r)||this;return n.renderOptions=function(){return n.state.monthYearsList.map(function(s){var a=$h(s),o=en(n.props.date,s)&&At(n.props.date,s);return H.createElement("div",{className:o?"react-datepicker__month-year-option--selected_month-year":"react-datepicker__month-year-option",key:a,onClick:n.onChange.bind(n,a),"aria-selected":o?"true":void 0},o?H.createElement("span",{className:"react-datepicker__month-year-option--selected"},""):"",Ge(s,n.props.dateFormat,n.props.locale))})},n.onChange=function(s){return n.props.onChange(s)},n.handleClickOutside=function(){n.props.onCancel()},n.state={monthYearsList:x$(n.props.minDate,n.props.maxDate)},n}return t.prototype.render=function(){var r=wt({"react-datepicker__month-year-dropdown":!0,"react-datepicker__month-year-dropdown--scrollable":this.props.scrollableMonthYearDropdown});return H.createElement(Rd,{className:r,onClickOutside:this.handleClickOutside},this.renderOptions())},t}(x.Component),b$=function(e){kt(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.state={dropdownVisible:!1},r.renderSelectOptions=function(){for(var n=Rn(r.props.minDate),s=Rn(r.props.maxDate),a=[];!fn(n,s);){var o=$h(n);a.push(H.createElement("option",{key:o,value:o},Ge(n,r.props.dateFormat,r.props.locale))),n=zr(n,1)}return a},r.onSelectChange=function(n){r.onChange(parseInt(n.target.value))},r.renderSelectMode=function(){return H.createElement("select",{value:$h(Rn(r.props.date)),className:"react-datepicker__month-year-select",onChange:r.onSelectChange},r.renderSelectOptions())},r.renderReadView=function(n){var s=Ge(r.props.date,r.props.dateFormat,r.props.locale);return H.createElement("div",{key:"read",style:{visibility:n?"visible":"hidden"},className:"react-datepicker__month-year-read-view",onClick:r.toggleDropdown},H.createElement("span",{className:"react-datepicker__month-year-read-view--down-arrow"}),H.createElement("span",{className:"react-datepicker__month-year-read-view--selected-month-year"},s))},r.renderDropdown=function(){return H.createElement(y$,ke({key:"dropdown"},r.props,{onChange:r.onChange,onCancel:r.toggleDropdown}))},r.renderScrollMode=function(){var n=r.state.dropdownVisible,s=[r.renderReadView(!n)];return n&&s.unshift(r.renderDropdown()),s},r.onChange=function(n){r.toggleDropdown();var s=Re(n);en(r.props.date,s)&&At(r.props.date,s)||r.props.onChange(s)},r.toggleDropdown=function(){return r.setState({dropdownVisible:!r.state.dropdownVisible})},r}return t.prototype.render=function(){var r;switch(this.props.dropdownMode){case"scroll":r=this.renderScrollMode();break;case"select":r=this.renderSelectMode();break}return H.createElement("div",{className:"react-datepicker__month-year-dropdown-container react-datepicker__month-year-dropdown-container--".concat(this.props.dropdownMode)},r)},t}(x.Component),v$=function(e){kt(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.state={height:null},r.scrollToTheSelectedTime=function(){requestAnimationFrame(function(){var n,s,a;r.list&&(r.list.scrollTop=(a=r.centerLi&&t.calcCenterPosition(r.props.monthRef?r.props.monthRef.clientHeight-((s=(n=r.header)===null||n===void 0?void 0:n.clientHeight)!==null&&s!==void 0?s:0):r.list.clientHeight,r.centerLi))!==null&&a!==void 0?a:0)})},r.handleClick=function(n){var s,a;(r.props.minTime||r.props.maxTime)&&db(n,r.props)||(r.props.excludeTimes||r.props.includeTimes||r.props.filterTime)&&ub(n,r.props)||(a=(s=r.props).onChange)===null||a===void 0||a.call(s,n)},r.isSelectedTime=function(n){return r.props.selected&&l$(r.props.selected,n)},r.isDisabledTime=function(n){return(r.props.minTime||r.props.maxTime)&&db(n,r.props)||(r.props.excludeTimes||r.props.includeTimes||r.props.filterTime)&&ub(n,r.props)},r.liClasses=function(n){var s,a=["react-datepicker__time-list-item",r.props.timeClassName?r.props.timeClassName(n):void 0];return r.isSelectedTime(n)&&a.push("react-datepicker__time-list-item--selected"),r.isDisabledTime(n)&&a.push("react-datepicker__time-list-item--disabled"),r.props.injectTimes&&(Ln(n)*3600+In(n)*60+hs(n))%(((s=r.props.intervals)!==null&&s!==void 0?s:t.defaultProps.intervals)*60)!==0&&a.push("react-datepicker__time-list-item--injected"),a.join(" ")},r.handleOnKeyDown=function(n,s){var a,o;n.key===se.Space&&(n.preventDefault(),n.key=se.Enter),(n.key===se.ArrowUp||n.key===se.ArrowLeft)&&n.target instanceof HTMLElement&&n.target.previousSibling&&(n.preventDefault(),n.target.previousSibling instanceof HTMLElement&&n.target.previousSibling.focus()),(n.key===se.ArrowDown||n.key===se.ArrowRight)&&n.target instanceof HTMLElement&&n.target.nextSibling&&(n.preventDefault(),n.target.nextSibling instanceof HTMLElement&&n.target.nextSibling.focus()),n.key===se.Enter&&r.handleClick(s),(o=(a=r.props).handleOnKeyDown)===null||o===void 0||o.call(a,n)},r.renderTimes=function(){for(var n,s=[],a=typeof r.props.format=="string"?r.props.format:"p",o=(n=r.props.intervals)!==null&&n!==void 0?n:t.defaultProps.intervals,l=r.props.selected||r.props.openToDate||Re(),c=Yc(l),u=r.props.injectTimes&&r.props.injectTimes.sort(function(w,g){return w.getTime()-g.getTime()}),d=60*o$(l),f=d/o,m=0;m<f;m++){var h=Rh(c,m*o);if(s.push(h),u){var y=i$(c,h,m,o,u);s=s.concat(y)}}var v=s.reduce(function(w,g){return g.getTime()<=l.getTime()?g:w},s[0]);return s.map(function(w){return H.createElement("li",{key:w.valueOf(),onClick:r.handleClick.bind(r,w),className:r.liClasses(w),ref:function(g){w===v&&(r.centerLi=g)},onKeyDown:function(g){r.handleOnKeyDown(g,w)},tabIndex:w===v?0:-1,role:"option","aria-selected":r.isSelectedTime(w)?"true":void 0,"aria-disabled":r.isDisabledTime(w)?"true":void 0},Ge(w,a,r.props.locale))})},r.renderTimeCaption=function(){return r.props.showTimeCaption===!1?H.createElement(H.Fragment,null):H.createElement("div",{className:"react-datepicker__header react-datepicker__header--time ".concat(r.props.showTimeSelectOnly?"react-datepicker__header--time--only":""),ref:function(n){r.header=n}},H.createElement("div",{className:"react-datepicker-time__header"},r.props.timeCaption))},r}return Object.defineProperty(t,"defaultProps",{get:function(){return{intervals:30,todayButton:null,timeCaption:"Time",showTimeCaption:!0}},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){this.scrollToTheSelectedTime(),this.observeDatePickerHeightChanges()},t.prototype.componentWillUnmount=function(){var r;(r=this.resizeObserver)===null||r===void 0||r.disconnect()},t.prototype.observeDatePickerHeightChanges=function(){var r=this,n=this.props.monthRef;this.updateContainerHeight(),n&&(this.resizeObserver=new ResizeObserver(function(){r.updateContainerHeight()}),this.resizeObserver.observe(n))},t.prototype.updateContainerHeight=function(){this.props.monthRef&&this.header&&this.setState({height:this.props.monthRef.clientHeight-this.header.clientHeight})},t.prototype.render=function(){var r=this,n,s=this.state.height;return H.createElement("div",{className:"react-datepicker__time-container ".concat(((n=this.props.todayButton)!==null&&n!==void 0?n:t.defaultProps.todayButton)?"react-datepicker__time-container--with-today-button":"")},this.renderTimeCaption(),H.createElement("div",{className:"react-datepicker__time"},H.createElement("div",{className:"react-datepicker__time-box"},H.createElement("ul",{className:"react-datepicker__time-list",ref:function(a){r.list=a},style:s?{height:s}:{},role:"listbox","aria-label":this.props.timeCaption},this.renderTimes()))))},t.calcCenterPosition=function(r,n){return n.offsetTop-(r/2-n.clientHeight/2)},t}(x.Component),wb=3,w$=function(e){kt(t,e);function t(r){var n=e.call(this,r)||this;return n.YEAR_REFS=ln([],Array(n.props.yearItemNumber),!0).map(function(){return x.createRef()}),n.isDisabled=function(s){return yr(s,{minDate:n.props.minDate,maxDate:n.props.maxDate,excludeDates:n.props.excludeDates,includeDates:n.props.includeDates,filterDate:n.props.filterDate})},n.isExcluded=function(s){return Yg(s,{excludeDates:n.props.excludeDates})},n.selectingDate=function(){var s;return(s=n.props.selectingDate)!==null&&s!==void 0?s:n.props.preSelection},n.updateFocusOnPaginate=function(s){var a=function(){var o,l;(l=(o=n.YEAR_REFS[s])===null||o===void 0?void 0:o.current)===null||l===void 0||l.focus()};window.requestAnimationFrame(a)},n.handleYearClick=function(s,a){n.props.onDayClick&&n.props.onDayClick(s,a)},n.handleYearNavigation=function(s,a){var o,l,c,u,d=n.props,f=d.date,m=d.yearItemNumber;if(!(f===void 0||m===void 0)){var h=Cn(f,m).startPeriod;n.isDisabled(a)||n.isExcluded(a)||((l=(o=n.props).setPreSelection)===null||l===void 0||l.call(o,a),s-h<0?n.updateFocusOnPaginate(m-(h-s)):s-h>=m?n.updateFocusOnPaginate(Math.abs(m-(s-h))):(u=(c=n.YEAR_REFS[s-h])===null||c===void 0?void 0:c.current)===null||u===void 0||u.focus())}},n.isSameDay=function(s,a){return je(s,a)},n.isCurrentYear=function(s){return s===ve(Re())},n.isRangeStart=function(s){return n.props.startDate&&n.props.endDate&&en(Zr(Re(),s),n.props.startDate)},n.isRangeEnd=function(s){return n.props.startDate&&n.props.endDate&&en(Zr(Re(),s),n.props.endDate)},n.isInRange=function(s){return hc(s,n.props.startDate,n.props.endDate)},n.isInSelectingRange=function(s){var a=n.props,o=a.selectsStart,l=a.selectsEnd,c=a.selectsRange,u=a.startDate,d=a.endDate;return!(o||l||c)||!n.selectingDate()?!1:o&&d?hc(s,n.selectingDate(),d):l&&u||c&&u&&!d?hc(s,u,n.selectingDate()):!1},n.isSelectingRangeStart=function(s){var a;if(!n.isInSelectingRange(s))return!1;var o=n.props,l=o.startDate,c=o.selectsStart,u=Zr(Re(),s);return c?en(u,(a=n.selectingDate())!==null&&a!==void 0?a:null):en(u,l??null)},n.isSelectingRangeEnd=function(s){var a;if(!n.isInSelectingRange(s))return!1;var o=n.props,l=o.endDate,c=o.selectsEnd,u=o.selectsRange,d=Zr(Re(),s);return c||u?en(d,(a=n.selectingDate())!==null&&a!==void 0?a:null):en(d,l??null)},n.isKeyboardSelected=function(s){if(!(n.props.disabledKeyboardNavigation||n.props.date===void 0||n.props.preSelection==null)){var a=n.props,o=a.minDate,l=a.maxDate,c=a.excludeDates,u=a.includeDates,d=a.filterDate,f=a.selected,m=yo(Zr(n.props.date,s)),h=(o||l||c||u||d)&&Gc(s,n.props),y=!!f&&je(m,yo(f)),v=je(m,yo(n.props.preSelection));return!n.props.inline&&!y&&v&&!h}},n.isSelectedYear=function(s){var a=n.props,o=a.selectsMultiple,l=a.selected,c=a.selectedDates;return o?c==null?void 0:c.some(function(u){return s===ve(u)}):!!l&&s===ve(l)},n.onYearClick=function(s,a){var o=n.props.date;o!==void 0&&n.handleYearClick(yo(Zr(o,a)),s)},n.onYearKeyDown=function(s,a){var o,l,c=s.key,u=n.props,d=u.date,f=u.yearItemNumber,m=u.handleOnKeyDown;if(c!==se.Tab&&s.preventDefault(),!n.props.disabledKeyboardNavigation)switch(c){case se.Enter:if(n.props.selected==null)break;n.onYearClick(s,a),(l=(o=n.props).setPreSelection)===null||l===void 0||l.call(o,n.props.selected);break;case se.ArrowRight:if(n.props.preSelection==null)break;n.handleYearNavigation(a+1,Pn(n.props.preSelection,1));break;case se.ArrowLeft:if(n.props.preSelection==null)break;n.handleYearNavigation(a-1,mi(n.props.preSelection,1));break;case se.ArrowUp:{if(d===void 0||f===void 0||n.props.preSelection==null)break;var h=Cn(d,f).startPeriod,y=wb,v=a-y;if(v<h){var w=f%y;a>=h&&a<h+w?y=w:y+=w,v=a-y}n.handleYearNavigation(v,mi(n.props.preSelection,y));break}case se.ArrowDown:{if(d===void 0||f===void 0||n.props.preSelection==null)break;var g=Cn(d,f).endPeriod,y=wb,v=a+y;if(v>g){var w=f%y;a<=g&&a>g-w?y=w:y+=w,v=a+y}n.handleYearNavigation(v,Pn(n.props.preSelection,y));break}}m&&m(s)},n.getYearClassNames=function(s){var a=n.props,o=a.date,l=a.minDate,c=a.maxDate,u=a.excludeDates,d=a.includeDates,f=a.filterDate,m=a.yearClassName;return wt("react-datepicker__year-text","react-datepicker__year-".concat(s),o?m==null?void 0:m(Zr(o,s)):void 0,{"react-datepicker__year-text--selected":n.isSelectedYear(s),"react-datepicker__year-text--disabled":(l||c||u||d||f)&&Gc(s,n.props),"react-datepicker__year-text--keyboard-selected":n.isKeyboardSelected(s),"react-datepicker__year-text--range-start":n.isRangeStart(s),"react-datepicker__year-text--range-end":n.isRangeEnd(s),"react-datepicker__year-text--in-range":n.isInRange(s),"react-datepicker__year-text--in-selecting-range":n.isInSelectingRange(s),"react-datepicker__year-text--selecting-range-start":n.isSelectingRangeStart(s),"react-datepicker__year-text--selecting-range-end":n.isSelectingRangeEnd(s),"react-datepicker__year-text--today":n.isCurrentYear(s)})},n.getYearTabIndex=function(s){if(n.props.disabledKeyboardNavigation||n.props.preSelection==null)return"-1";var a=ve(n.props.preSelection),o=Gc(s,n.props);return s===a&&!o?"0":"-1"},n.getYearContent=function(s){return n.props.renderYearContent?n.props.renderYearContent(s):s},n}return t.prototype.render=function(){var r=this,n=[],s=this.props,a=s.date,o=s.yearItemNumber,l=s.onYearMouseEnter,c=s.onYearMouseLeave;if(a===void 0)return null;for(var u=Cn(a,o),d=u.startPeriod,f=u.endPeriod,m=function(v){n.push(H.createElement("div",{ref:h.YEAR_REFS[v-d],onClick:function(w){r.onYearClick(w,v)},onKeyDown:function(w){Lk(w)&&(w.preventDefault(),w.key=se.Enter),r.onYearKeyDown(w,v)},tabIndex:Number(h.getYearTabIndex(v)),className:h.getYearClassNames(v),onMouseEnter:h.props.usePointerEvent?void 0:function(w){return l(w,v)},onPointerEnter:h.props.usePointerEvent?function(w){return l(w,v)}:void 0,onMouseLeave:h.props.usePointerEvent?void 0:function(w){return c(w,v)},onPointerLeave:h.props.usePointerEvent?function(w){return c(w,v)}:void 0,key:v,"aria-current":h.isCurrentYear(v)?"date":void 0},h.getYearContent(v)))},h=this,y=d;y<=f;y++)m(y);return H.createElement("div",{className:"react-datepicker__year"},H.createElement("div",{className:"react-datepicker__year-wrapper",onMouseLeave:this.props.usePointerEvent?void 0:this.props.clearSelectingDate,onPointerLeave:this.props.usePointerEvent?this.props.clearSelectingDate:void 0},n))},t}(x.Component);function _$(e,t,r,n){for(var s=[],a=0;a<2*t+1;a++){var o=e+t-a,l=!0;r&&(l=ve(r)<=o),n&&l&&(l=ve(n)>=o),l&&s.push(o)}return s}var j$=function(e){kt(t,e);function t(r){var n=e.call(this,r)||this;n.yearOptionButtonsRef={},n.handleOptionKeyDown=function(l,c){var u;switch(c.key){case"Enter":c.preventDefault(),n.onChange(l);break;case"Escape":c.preventDefault(),n.props.onCancel();break;case"ArrowUp":case"ArrowDown":{c.preventDefault();var d=l+(c.key==="ArrowUp"?1:-1);n.yearOptionButtonsRef[d]&&((u=n.yearOptionButtonsRef[d])===null||u===void 0||u.focus());break}}},n.renderOptions=function(){n.yearOptionButtonsRef={};var l=n.props.year,c=n.state.yearsList.map(function(f){return H.createElement("div",{ref:function(m){n.yearOptionButtonsRef[f]=m,f===l&&(m==null||m.focus())},role:"button",tabIndex:0,className:l===f?"react-datepicker__year-option react-datepicker__year-option--selected_year":"react-datepicker__year-option",key:f,onClick:n.onChange.bind(n,f),onKeyDown:n.handleOptionKeyDown.bind(n,f),"aria-selected":l===f?"true":void 0},l===f?H.createElement("span",{className:"react-datepicker__year-option--selected"},""):"",f)}),u=n.props.minDate?ve(n.props.minDate):null,d=n.props.maxDate?ve(n.props.maxDate):null;return(!d||!n.state.yearsList.find(function(f){return f===d}))&&c.unshift(H.createElement("div",{className:"react-datepicker__year-option",key:"upcoming",onClick:n.incrementYears},H.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-upcoming"}))),(!u||!n.state.yearsList.find(function(f){return f===u}))&&c.push(H.createElement("div",{className:"react-datepicker__year-option",key:"previous",onClick:n.decrementYears},H.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-previous"}))),c},n.onChange=function(l){n.props.onChange(l)},n.handleClickOutside=function(){n.props.onCancel()},n.shiftYears=function(l){var c=n.state.yearsList.map(function(u){return u+l});n.setState({yearsList:c})},n.incrementYears=function(){return n.shiftYears(1)},n.decrementYears=function(){return n.shiftYears(-1)};var s=r.yearDropdownItemNumber,a=r.scrollableYearDropdown,o=s||(a?10:5);return n.state={yearsList:_$(n.props.year,o,n.props.minDate,n.props.maxDate)},n.dropdownRef=x.createRef(),n}return t.prototype.componentDidMount=function(){var r=this.dropdownRef.current;if(r){var n=r.children?Array.from(r.children):null,s=n?n.find(function(a){return a.ariaSelected}):null;r.scrollTop=s&&s instanceof HTMLElement?s.offsetTop+(s.clientHeight-r.clientHeight)/2:(r.scrollHeight-r.clientHeight)/2}},t.prototype.render=function(){var r=wt({"react-datepicker__year-dropdown":!0,"react-datepicker__year-dropdown--scrollable":this.props.scrollableYearDropdown});return H.createElement(Rd,{className:r,containerRef:this.dropdownRef,onClickOutside:this.handleClickOutside},this.renderOptions())},t}(x.Component),k$=function(e){kt(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.state={dropdownVisible:!1},r.renderSelectOptions=function(){for(var n=r.props.minDate?ve(r.props.minDate):1900,s=r.props.maxDate?ve(r.props.maxDate):2100,a=[],o=n;o<=s;o++)a.push(H.createElement("option",{key:o,value:o},o));return a},r.onSelectChange=function(n){r.onChange(parseInt(n.target.value))},r.renderSelectMode=function(){return H.createElement("select",{value:r.props.year,className:"react-datepicker__year-select",onChange:r.onSelectChange},r.renderSelectOptions())},r.renderReadView=function(n){return H.createElement("button",{key:"read",type:"button",style:{visibility:n?"visible":"hidden"},className:"react-datepicker__year-read-view",onClick:r.toggleDropdown},H.createElement("span",{className:"react-datepicker__year-read-view--down-arrow"}),H.createElement("span",{className:"react-datepicker__year-read-view--selected-year"},r.props.year))},r.renderDropdown=function(){return H.createElement(j$,ke({key:"dropdown"},r.props,{onChange:r.onChange,onCancel:r.toggleDropdown}))},r.renderScrollMode=function(){var n=r.state.dropdownVisible,s=[r.renderReadView(!n)];return n&&s.unshift(r.renderDropdown()),s},r.onChange=function(n){r.toggleDropdown(),n!==r.props.year&&r.props.onChange(n)},r.toggleDropdown=function(n){r.setState({dropdownVisible:!r.state.dropdownVisible},function(){r.props.adjustDateOnChange&&r.handleYearChange(r.props.date,n)})},r.handleYearChange=function(n,s){var a;(a=r.onSelect)===null||a===void 0||a.call(r,n,s),r.setOpen()},r.onSelect=function(n,s){var a,o;(o=(a=r.props).onSelect)===null||o===void 0||o.call(a,n,s)},r.setOpen=function(){var n,s;(s=(n=r.props).setOpen)===null||s===void 0||s.call(n,!0)},r}return t.prototype.render=function(){var r;switch(this.props.dropdownMode){case"scroll":r=this.renderScrollMode();break;case"select":r=this.renderSelectMode();break}return H.createElement("div",{className:"react-datepicker__year-dropdown-container react-datepicker__year-dropdown-container--".concat(this.props.dropdownMode)},r)},t}(x.Component),N$=["react-datepicker__year-select","react-datepicker__month-select","react-datepicker__month-year-select"],Ik="react-datepicker-ignore-onclickoutside",S$=function(e){var t=(e.className||"").split(/\s+/);return N$.some(function(r){return t.indexOf(r)>=0})},C$=function(e){kt(t,e);function t(r){var n=e.call(this,r)||this;return n.monthContainer=void 0,n.handleClickOutside=function(s){n.props.onClickOutside(s)},n.setClickOutsideRef=function(){return n.containerRef.current},n.handleDropdownFocus=function(s){var a,o;S$(s.target)&&((o=(a=n.props).onDropdownFocus)===null||o===void 0||o.call(a,s))},n.getDateInView=function(){var s=n.props,a=s.preSelection,o=s.selected,l=s.openToDate,c=Pk(n.props),u=Tk(n.props),d=Re(),f=l||o||a;return f||(c&&on(d,c)?c:u&&fn(d,u)?u:d)},n.increaseMonth=function(){n.setState(function(s){var a=s.date;return{date:zr(a,1)}},function(){return n.handleMonthChange(n.state.date)})},n.decreaseMonth=function(){n.setState(function(s){var a=s.date;return{date:Zs(a,1)}},function(){return n.handleMonthChange(n.state.date)})},n.handleDayClick=function(s,a,o){n.props.onSelect(s,a,o),n.props.setPreSelection&&n.props.setPreSelection(s)},n.handleDayMouseEnter=function(s){n.setState({selectingDate:s}),n.props.onDayMouseEnter&&n.props.onDayMouseEnter(s)},n.handleMonthMouseLeave=function(){n.setState({selectingDate:void 0}),n.props.onMonthMouseLeave&&n.props.onMonthMouseLeave()},n.handleYearMouseEnter=function(s,a){n.setState({selectingDate:Zr(Re(),a)}),n.props.onYearMouseEnter&&n.props.onYearMouseEnter(s,a)},n.handleYearMouseLeave=function(s,a){n.props.onYearMouseLeave&&n.props.onYearMouseLeave(s,a)},n.handleYearChange=function(s){var a,o,l,c;(o=(a=n.props).onYearChange)===null||o===void 0||o.call(a,s),n.setState({isRenderAriaLiveMessage:!0}),n.props.adjustDateOnChange&&(n.props.onSelect(s),(c=(l=n.props).setOpen)===null||c===void 0||c.call(l,!0)),n.props.setPreSelection&&n.props.setPreSelection(s)},n.getEnabledPreSelectionDateForMonth=function(s){if(!yr(s,n.props))return s;for(var a=Rn(s),o=GA(s),l=nR(o,a),c=null,u=0;u<=l;u++){var d=Fr(a,u);if(!yr(d,n.props)){c=d;break}}return c},n.handleMonthChange=function(s){var a,o,l,c=(a=n.getEnabledPreSelectionDateForMonth(s))!==null&&a!==void 0?a:s;n.handleCustomMonthChange(c),n.props.adjustDateOnChange&&(n.props.onSelect(c),(l=(o=n.props).setOpen)===null||l===void 0||l.call(o,!0)),n.props.setPreSelection&&n.props.setPreSelection(c)},n.handleCustomMonthChange=function(s){var a,o;(o=(a=n.props).onMonthChange)===null||o===void 0||o.call(a,s),n.setState({isRenderAriaLiveMessage:!0})},n.handleMonthYearChange=function(s){n.handleYearChange(s),n.handleMonthChange(s)},n.changeYear=function(s){n.setState(function(a){var o=a.date;return{date:Zr(o,Number(s))}},function(){return n.handleYearChange(n.state.date)})},n.changeMonth=function(s){n.setState(function(a){var o=a.date;return{date:pr(o,Number(s))}},function(){return n.handleMonthChange(n.state.date)})},n.changeMonthYear=function(s){n.setState(function(a){var o=a.date;return{date:Zr(pr(o,Et(s)),ve(s))}},function(){return n.handleMonthYearChange(n.state.date)})},n.header=function(s){s===void 0&&(s=n.state.date);var a=ps(s,n.props.locale,n.props.calendarStartDay),o=[];return n.props.showWeekNumbers&&o.push(H.createElement("div",{key:"W",className:"react-datepicker__day-name",role:"columnheader"},H.createElement("span",{className:"react-datepicker__sr-only"},"Week number"),H.createElement("span",{"aria-hidden":"true"},n.props.weekLabel||"#"))),o.concat([0,1,2,3,4,5,6].map(function(l){var c=Fr(a,l),u=n.formatWeekday(c,n.props.locale),d=n.props.weekDayClassName?n.props.weekDayClassName(c):void 0;return H.createElement("div",{key:l,role:"columnheader",className:wt("react-datepicker__day-name",d)},H.createElement("span",{className:"react-datepicker__sr-only"},Ge(c,"EEEE",n.props.locale)),H.createElement("span",{"aria-hidden":"true"},u))}))},n.formatWeekday=function(s,a){return n.props.formatWeekDay?KA(s,n.props.formatWeekDay,a):n.props.useWeekdaysShort?JA(s,a):QA(s,a)},n.decreaseYear=function(){n.setState(function(s){var a,o=s.date;return{date:mi(o,n.props.showYearPicker?(a=n.props.yearItemNumber)!==null&&a!==void 0?a:t.defaultProps.yearItemNumber:1)}},function(){return n.handleYearChange(n.state.date)})},n.clearSelectingDate=function(){n.setState({selectingDate:void 0})},n.renderPreviousButton=function(){var s,a,o;if(!n.props.renderCustomHeader){var l=(s=n.props.monthsShown)!==null&&s!==void 0?s:t.defaultProps.monthsShown,c=n.props.showPreviousMonths?l-1:0,u=(a=n.props.monthSelectedIn)!==null&&a!==void 0?a:c,d=Zs(n.state.date,u),f;switch(!0){case n.props.showMonthYearPicker:f=hb(n.state.date,n.props);break;case n.props.showYearPicker:f=r$(n.state.date,n.props);break;case n.props.showQuarterYearPicker:f=e$(n.state.date,n.props);break;default:f=fb(d,n.props);break}if(!(!((o=n.props.forceShowMonthNavigation)!==null&&o!==void 0?o:t.defaultProps.forceShowMonthNavigation)&&!n.props.showDisabledMonthNavigation&&f||n.props.showTimeSelectOnly)){var m=["react-datepicker__navigation-icon","react-datepicker__navigation-icon--previous"],h=["react-datepicker__navigation","react-datepicker__navigation--previous"],y=n.decreaseMonth;(n.props.showMonthYearPicker||n.props.showQuarterYearPicker||n.props.showYearPicker)&&(y=n.decreaseYear),f&&n.props.showDisabledMonthNavigation&&(h.push("react-datepicker__navigation--previous--disabled"),y=void 0);var v=n.props.showMonthYearPicker||n.props.showQuarterYearPicker||n.props.showYearPicker,w=n.props,g=w.previousMonthButtonLabel,b=g===void 0?t.defaultProps.previousMonthButtonLabel:g,p=w.previousYearButtonLabel,_=p===void 0?t.defaultProps.previousYearButtonLabel:p,j=n.props,k=j.previousMonthAriaLabel,N=k===void 0?typeof b=="string"?b:"Previous Month":k,S=j.previousYearAriaLabel,C=S===void 0?typeof _=="string"?_:"Previous Year":S;return H.createElement("button",{type:"button",className:h.join(" "),onClick:y,onKeyDown:n.props.handleOnKeyDown,"aria-label":v?C:N},H.createElement("span",{className:m.join(" ")},v?_:b))}}},n.increaseYear=function(){n.setState(function(s){var a,o=s.date;return{date:Pn(o,n.props.showYearPicker?(a=n.props.yearItemNumber)!==null&&a!==void 0?a:t.defaultProps.yearItemNumber:1)}},function(){return n.handleYearChange(n.state.date)})},n.renderNextButton=function(){var s;if(!n.props.renderCustomHeader){var a;switch(!0){case n.props.showMonthYearPicker:a=pb(n.state.date,n.props);break;case n.props.showYearPicker:a=n$(n.state.date,n.props);break;case n.props.showQuarterYearPicker:a=t$(n.state.date,n.props);break;default:a=mb(n.state.date,n.props);break}if(!(!((s=n.props.forceShowMonthNavigation)!==null&&s!==void 0?s:t.defaultProps.forceShowMonthNavigation)&&!n.props.showDisabledMonthNavigation&&a||n.props.showTimeSelectOnly)){var o=["react-datepicker__navigation","react-datepicker__navigation--next"],l=["react-datepicker__navigation-icon","react-datepicker__navigation-icon--next"];n.props.showTimeSelect&&o.push("react-datepicker__navigation--next--with-time"),n.props.todayButton&&o.push("react-datepicker__navigation--next--with-today-button");var c=n.increaseMonth;(n.props.showMonthYearPicker||n.props.showQuarterYearPicker||n.props.showYearPicker)&&(c=n.increaseYear),a&&n.props.showDisabledMonthNavigation&&(o.push("react-datepicker__navigation--next--disabled"),c=void 0);var u=n.props.showMonthYearPicker||n.props.showQuarterYearPicker||n.props.showYearPicker,d=n.props,f=d.nextMonthButtonLabel,m=f===void 0?t.defaultProps.nextMonthButtonLabel:f,h=d.nextYearButtonLabel,y=h===void 0?t.defaultProps.nextYearButtonLabel:h,v=n.props,w=v.nextMonthAriaLabel,g=w===void 0?typeof m=="string"?m:"Next Month":w,b=v.nextYearAriaLabel,p=b===void 0?typeof y=="string"?y:"Next Year":b;return H.createElement("button",{type:"button",className:o.join(" "),onClick:c,onKeyDown:n.props.handleOnKeyDown,"aria-label":u?p:g},H.createElement("span",{className:l.join(" ")},u?y:m))}}},n.renderCurrentMonth=function(s){s===void 0&&(s=n.state.date);var a=["react-datepicker__current-month"];return n.props.showYearDropdown&&a.push("react-datepicker__current-month--hasYearDropdown"),n.props.showMonthDropdown&&a.push("react-datepicker__current-month--hasMonthDropdown"),n.props.showMonthYearDropdown&&a.push("react-datepicker__current-month--hasMonthYearDropdown"),H.createElement("h2",{className:a.join(" ")},Ge(s,n.props.dateFormat,n.props.locale))},n.renderYearDropdown=function(s){if(s===void 0&&(s=!1),!(!n.props.showYearDropdown||s))return H.createElement(k$,ke({},t.defaultProps,n.props,{date:n.state.date,onChange:n.changeYear,year:ve(n.state.date)}))},n.renderMonthDropdown=function(s){if(s===void 0&&(s=!1),!(!n.props.showMonthDropdown||s))return H.createElement(g$,ke({},t.defaultProps,n.props,{month:Et(n.state.date),onChange:n.changeMonth}))},n.renderMonthYearDropdown=function(s){if(s===void 0&&(s=!1),!(!n.props.showMonthYearDropdown||s))return H.createElement(b$,ke({},t.defaultProps,n.props,{date:n.state.date,onChange:n.changeMonthYear}))},n.handleTodayButtonClick=function(s){n.props.onSelect(ob(),s),n.props.setPreSelection&&n.props.setPreSelection(ob())},n.renderTodayButton=function(){if(!(!n.props.todayButton||n.props.showTimeSelectOnly))return H.createElement("div",{className:"react-datepicker__today-button",onClick:n.handleTodayButtonClick},n.props.todayButton)},n.renderDayNamesHeader=function(s){return H.createElement("div",{className:"react-datepicker__day-names",role:"row"},n.header(s))},n.renderDefaultHeader=function(s){var a=s.monthDate,o=s.i;return H.createElement("div",{className:"react-datepicker__header ".concat(n.props.showTimeSelect?"react-datepicker__header--has-time-select":"")},n.renderCurrentMonth(a),H.createElement("div",{className:"react-datepicker__header__dropdown react-datepicker__header__dropdown--".concat(n.props.dropdownMode),onFocus:n.handleDropdownFocus},n.renderMonthDropdown(o!==0),n.renderMonthYearDropdown(o!==0),n.renderYearDropdown(o!==0)))},n.renderCustomHeader=function(s){var a,o,l=s.monthDate,c=s.i;if(n.props.showTimeSelect&&!n.state.monthContainer||n.props.showTimeSelectOnly)return null;var u=n.props,d=u.showYearPicker,f=u.yearItemNumber,m;if(d){var h=Cn(l,f),y=h.startPeriod,v=h.endPeriod;m={startYear:y,endYear:v}}var w=fb(n.state.date,n.props),g=mb(n.state.date,n.props),b=hb(n.state.date,n.props),p=pb(n.state.date,n.props);return H.createElement("div",{className:"react-datepicker__header react-datepicker__header--custom",onFocus:n.props.onDropdownFocus},(o=(a=n.props).renderCustomHeader)===null||o===void 0?void 0:o.call(a,ke(ke(ke({},n.state),d&&{visibleYearsRange:m}),{customHeaderCount:c,monthDate:l,changeMonth:n.changeMonth,changeYear:n.changeYear,decreaseMonth:n.decreaseMonth,increaseMonth:n.increaseMonth,decreaseYear:n.decreaseYear,increaseYear:n.increaseYear,prevMonthButtonDisabled:w,nextMonthButtonDisabled:g,prevYearButtonDisabled:b,nextYearButtonDisabled:p})))},n.renderYearHeader=function(s){var a=s.monthDate,o=n.props,l=o.showYearPicker,c=o.yearItemNumber,u=c===void 0?t.defaultProps.yearItemNumber:c,d=Cn(a,u),f=d.startPeriod,m=d.endPeriod;return H.createElement("div",{className:"react-datepicker__header react-datepicker-year-header"},l?"".concat(f," - ").concat(m):ve(a))},n.renderHeader=function(s){var a=s.monthDate,o=s.i,l=o===void 0?0:o,c={monthDate:a,i:l};switch(!0){case n.props.renderCustomHeader!==void 0:return n.renderCustomHeader(c);case(n.props.showMonthYearPicker||n.props.showQuarterYearPicker||n.props.showYearPicker):return n.renderYearHeader(c);default:return n.renderDefaultHeader(c)}},n.renderMonths=function(){var s,a;if(!(n.props.showTimeSelectOnly||n.props.showYearPicker)){for(var o=[],l=(s=n.props.monthsShown)!==null&&s!==void 0?s:t.defaultProps.monthsShown,c=n.props.showPreviousMonths?l-1:0,u=n.props.showMonthYearPicker||n.props.showQuarterYearPicker?Pn(n.state.date,c):Zs(n.state.date,c),d=(a=n.props.monthSelectedIn)!==null&&a!==void 0?a:c,f=0;f<l;++f){var m=f-d+c,h=n.props.showMonthYearPicker||n.props.showQuarterYearPicker?Pn(u,m):zr(u,m),y="month-".concat(f),v=f<l-1,w=f>0;o.push(H.createElement("div",{key:y,ref:function(g){n.monthContainer=g??void 0},className:"react-datepicker__month-container"},n.renderHeader({monthDate:h,i:f}),H.createElement(h$,ke({},t.defaultProps,n.props,{containerRef:n.containerRef,ariaLabelPrefix:n.props.monthAriaLabelPrefix,day:h,onDayClick:n.handleDayClick,handleOnKeyDown:n.props.handleOnDayKeyDown,handleOnMonthKeyDown:n.props.handleOnKeyDown,onDayMouseEnter:n.handleDayMouseEnter,onMouseLeave:n.handleMonthMouseLeave,orderInDisplay:f,selectingDate:n.state.selectingDate,monthShowsDuplicateDaysEnd:v,monthShowsDuplicateDaysStart:w,dayNamesHeader:n.renderDayNamesHeader(h)}))))}return o}},n.renderYears=function(){if(!n.props.showTimeSelectOnly&&n.props.showYearPicker)return H.createElement("div",{className:"react-datepicker__year--container"},n.renderHeader({monthDate:n.state.date}),H.createElement(w$,ke({},t.defaultProps,n.props,{selectingDate:n.state.selectingDate,date:n.state.date,onDayClick:n.handleDayClick,clearSelectingDate:n.clearSelectingDate,onYearMouseEnter:n.handleYearMouseEnter,onYearMouseLeave:n.handleYearMouseLeave})))},n.renderTimeSection=function(){if(n.props.showTimeSelect&&(n.state.monthContainer||n.props.showTimeSelectOnly))return H.createElement(v$,ke({},t.defaultProps,n.props,{onChange:n.props.onTimeChange,format:n.props.timeFormat,intervals:n.props.timeIntervals,monthRef:n.state.monthContainer}))},n.renderInputTimeSection=function(){var s=n.props.selected?new Date(n.props.selected):void 0,a=s&&Md(s)&&!!n.props.selected,o=a?"".concat(xb(s.getHours()),":").concat(xb(s.getMinutes())):"";if(n.props.showTimeInput)return H.createElement(c$,ke({},t.defaultProps,n.props,{date:s,timeString:o,onChange:n.props.onTimeChange}))},n.renderAriaLiveRegion=function(){var s,a=Cn(n.state.date,(s=n.props.yearItemNumber)!==null&&s!==void 0?s:t.defaultProps.yearItemNumber),o=a.startPeriod,l=a.endPeriod,c;return n.props.showYearPicker?c="".concat(o," - ").concat(l):n.props.showMonthYearPicker||n.props.showQuarterYearPicker?c=ve(n.state.date):c="".concat(Vg(Et(n.state.date),n.props.locale)," ").concat(ve(n.state.date)),H.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},n.state.isRenderAriaLiveMessage&&c)},n.renderChildren=function(){if(n.props.children)return H.createElement("div",{className:"react-datepicker__children-container"},n.props.children)},n.containerRef=x.createRef(),n.state={date:n.getDateInView(),selectingDate:void 0,monthContainer:void 0,isRenderAriaLiveMessage:!1},n}return Object.defineProperty(t,"defaultProps",{get:function(){return{monthsShown:1,forceShowMonthNavigation:!1,outsideClickIgnoreClass:Ik,timeCaption:"Time",previousYearButtonLabel:"Previous Year",nextYearButtonLabel:"Next Year",previousMonthButtonLabel:"Previous Month",nextMonthButtonLabel:"Next Month",yearItemNumber:Tl}},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){var r=this;this.props.showTimeSelect&&(this.assignMonthContainer=function(){r.setState({monthContainer:r.monthContainer})}())},t.prototype.componentDidUpdate=function(r){var n=this;if(this.props.preSelection&&(!je(this.props.preSelection,r.preSelection)||this.props.monthSelectedIn!==r.monthSelectedIn)){var s=!At(this.state.date,this.props.preSelection);this.setState({date:this.props.preSelection},function(){return s&&n.handleCustomMonthChange(n.state.date)})}else this.props.openToDate&&!je(this.props.openToDate,r.openToDate)&&this.setState({date:this.props.openToDate})},t.prototype.render=function(){var r=this.props.container||UA;return H.createElement(Rd,{onClickOutside:this.handleClickOutside,style:{display:"contents"},ignoreClass:this.props.outsideClickIgnoreClass},H.createElement("div",{style:{display:"contents"},ref:this.containerRef},H.createElement(r,{className:wt("react-datepicker",this.props.className,{"react-datepicker--time-only":this.props.showTimeSelectOnly}),showTime:this.props.showTimeSelect||this.props.showTimeInput,showTimeSelectOnly:this.props.showTimeSelectOnly},this.renderAriaLiveRegion(),this.renderPreviousButton(),this.renderNextButton(),this.renderMonths(),this.renderYears(),this.renderTodayButton(),this.renderTimeSection(),this.renderInputTimeSection(),this.renderChildren())))},t}(x.Component),E$=function(e){var t=e.icon,r=e.className,n=r===void 0?"":r,s=e.onClick,a="react-datepicker__calendar-icon";if(typeof t=="string")return H.createElement("i",{className:"".concat(a," ").concat(t," ").concat(n),"aria-hidden":"true",onClick:s});if(H.isValidElement(t)){var o=t;return H.cloneElement(o,{className:"".concat(o.props.className||""," ").concat(a," ").concat(n),onClick:function(l){typeof o.props.onClick=="function"&&o.props.onClick(l),typeof s=="function"&&s(l)}})}return H.createElement("svg",{className:"".concat(a," ").concat(n),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",onClick:s},H.createElement("path",{d:"M96 32V64H48C21.5 64 0 85.5 0 112v48H448V112c0-26.5-21.5-48-48-48H352V32c0-17.7-14.3-32-32-32s-32 14.3-32 32V64H160V32c0-17.7-14.3-32-32-32S96 14.3 96 32zM448 192H0V464c0 26.5 21.5 48 48 48H400c26.5 0 48-21.5 48-48V192z"}))},Rk=function(e){kt(t,e);function t(r){var n=e.call(this,r)||this;return n.portalRoot=null,n.el=document.createElement("div"),n}return t.prototype.componentDidMount=function(){this.portalRoot=(this.props.portalHost||document).getElementById(this.props.portalId),this.portalRoot||(this.portalRoot=document.createElement("div"),this.portalRoot.setAttribute("id",this.props.portalId),(this.props.portalHost||document.body).appendChild(this.portalRoot)),this.portalRoot.appendChild(this.el)},t.prototype.componentWillUnmount=function(){this.portalRoot&&this.portalRoot.removeChild(this.el)},t.prototype.render=function(){return s1.createPortal(this.props.children,this.el)},t}(x.Component),D$="[tabindex], a, button, input, select, textarea",P$=function(e){return(e instanceof HTMLAnchorElement||!e.disabled)&&e.tabIndex!==-1},Mk=function(e){kt(t,e);function t(r){var n=e.call(this,r)||this;return n.getTabChildren=function(){var s;return Array.prototype.slice.call((s=n.tabLoopRef.current)===null||s===void 0?void 0:s.querySelectorAll(D$),1,-1).filter(P$)},n.handleFocusStart=function(){var s=n.getTabChildren();s&&s.length>1&&s[s.length-1].focus()},n.handleFocusEnd=function(){var s=n.getTabChildren();s&&s.length>1&&s[0].focus()},n.tabLoopRef=x.createRef(),n}return t.prototype.render=function(){var r;return((r=this.props.enableTabLoop)!==null&&r!==void 0?r:t.defaultProps.enableTabLoop)?H.createElement("div",{className:"react-datepicker__tab-loop",ref:this.tabLoopRef},H.createElement("div",{className:"react-datepicker__tab-loop__start",tabIndex:0,onFocus:this.handleFocusStart}),this.props.children,H.createElement("div",{className:"react-datepicker__tab-loop__end",tabIndex:0,onFocus:this.handleFocusEnd})):this.props.children},t.defaultProps={enableTabLoop:!0},t}(x.Component);function T$(e){function t(r){var n,s=typeof r.hidePopper=="boolean"?r.hidePopper:!0,a=x.useRef(null),o=BA(ke({open:!s,whileElementsMounted:yA,placement:r.popperPlacement,middleware:ln([CA({padding:15}),SA(10),EA({element:a})],(n=r.popperModifiers)!==null&&n!==void 0?n:[],!0)},r.popperProps)),l=ke(ke({},r),{hidePopper:s,popperProps:ke(ke({},o),{arrowRef:a})});return H.createElement(e,ke({},l))}return t.displayName="withFloating(".concat(e.displayName||e.name||"Component",")"),t}var L$=function(e){var t=e.className,r=e.wrapperClassName,n=e.hidePopper,s=n===void 0?!0:n,a=e.popperComponent,o=e.targetComponent,l=e.enableTabLoop,c=e.popperOnKeyDown,u=e.portalId,d=e.portalHost,f=e.popperProps,m=e.showArrow,h=void 0;if(!s){var y=wt("react-datepicker-popper",t);h=H.createElement(Mk,{enableTabLoop:l},H.createElement("div",{ref:f.refs.setFloating,style:f.floatingStyles,className:y,"data-placement":f.placement,onKeyDown:c},a,m&&H.createElement(IA,{ref:f.arrowRef,context:f.context,fill:"currentColor",strokeWidth:1,height:8,width:16,style:{transform:"translateY(-1px)"},className:"react-datepicker__triangle"})))}e.popperContainer&&(h=x.createElement(e.popperContainer,{},h)),u&&!s&&(h=H.createElement(Rk,{portalId:u,portalHost:d},h));var v=wt("react-datepicker-wrapper",r);return H.createElement(H.Fragment,null,H.createElement("div",{ref:f.refs.setReference,className:v},o),h)},I$=T$(L$);function R$(e,t){return e&&t?Et(e)!==Et(t)||ve(e)!==ve(t):e!==t}var Qf="Date input not valid.",Ok=function(e){kt(t,e);function t(r){var n=e.call(this,r)||this;return n.calendar=null,n.input=null,n.getPreSelection=function(){return n.props.openToDate?n.props.openToDate:n.props.selectsEnd&&n.props.startDate?n.props.startDate:n.props.selectsStart&&n.props.endDate?n.props.endDate:Re()},n.modifyHolidays=function(){var s;return(s=n.props.holidays)===null||s===void 0?void 0:s.reduce(function(a,o){var l=new Date(o.date);return Md(l)?ln(ln([],a,!0),[ke(ke({},o),{date:l})],!1):a},[])},n.calcInitialState=function(){var s,a=n.getPreSelection(),o=Pk(n.props),l=Tk(n.props),c=o&&on(a,Yc(o))?o:l&&fn(a,lb(l))?l:a;return{open:n.props.startOpen||!1,preventFocus:!1,inputValue:null,preSelection:(s=n.props.selectsRange?n.props.startDate:n.props.selected)!==null&&s!==void 0?s:c,highlightDates:gb(n.props.highlightDates),focused:!1,shouldFocusDayInline:!1,isRenderAriaLiveMessage:!1,wasHidden:!1}},n.getInputValue=function(){var s,a=n.props,o=a.locale,l=a.startDate,c=a.endDate,u=a.rangeSeparator,d=a.selected,f=a.selectedDates,m=a.selectsMultiple,h=a.selectsRange,y=a.value,v=(s=n.props.dateFormat)!==null&&s!==void 0?s:t.defaultProps.dateFormat,w=n.state.inputValue;return typeof y=="string"?y:typeof w=="string"?w:h?WA(l,c,{dateFormat:v,locale:o,rangeSeparator:u}):m?HA(f??[],{dateFormat:v,locale:o}):hr(d,{dateFormat:v,locale:o})},n.resetHiddenStatus=function(){n.setState(ke(ke({},n.state),{wasHidden:!1}))},n.setHiddenStatus=function(){n.setState(ke(ke({},n.state),{wasHidden:!0}))},n.setHiddenStateOnVisibilityHidden=function(){document.visibilityState==="hidden"&&n.setHiddenStatus()},n.clearPreventFocusTimeout=function(){n.preventFocusTimeout&&clearTimeout(n.preventFocusTimeout)},n.setFocus=function(){var s,a;(a=(s=n.input)===null||s===void 0?void 0:s.focus)===null||a===void 0||a.call(s,{preventScroll:!0})},n.setBlur=function(){var s,a;(a=(s=n.input)===null||s===void 0?void 0:s.blur)===null||a===void 0||a.call(s),n.cancelFocusInput()},n.deferBlur=function(){requestAnimationFrame(function(){n.setBlur()})},n.setOpen=function(s,a){a===void 0&&(a=!1),n.setState({open:s,preSelection:s&&n.state.open?n.state.preSelection:n.calcInitialState().preSelection,lastPreSelectChange:Jf},function(){s||n.setState(function(o){return{focused:a?o.focused:!1}},function(){!a&&n.deferBlur(),n.setState({inputValue:null})})})},n.inputOk=function(){return Tn(n.state.preSelection)},n.isCalendarOpen=function(){return n.props.open===void 0?n.state.open&&!n.props.disabled&&!n.props.readOnly:n.props.open},n.handleFocus=function(s){var a,o,l=n.state.wasHidden,c=l?n.state.open:!0;l&&n.resetHiddenStatus(),n.state.preventFocus||((o=(a=n.props).onFocus)===null||o===void 0||o.call(a,s),c&&!n.props.preventOpenOnFocus&&!n.props.readOnly&&n.setOpen(!0)),n.setState({focused:!0})},n.sendFocusBackToInput=function(){n.preventFocusTimeout&&n.clearPreventFocusTimeout(),n.setState({preventFocus:!0},function(){n.preventFocusTimeout=setTimeout(function(){n.setFocus(),n.setState({preventFocus:!1})})})},n.cancelFocusInput=function(){clearTimeout(n.inputFocusTimeout),n.inputFocusTimeout=void 0},n.deferFocusInput=function(){n.cancelFocusInput(),n.inputFocusTimeout=setTimeout(function(){return n.setFocus()},1)},n.handleDropdownFocus=function(){n.cancelFocusInput()},n.resetInputValue=function(){n.setState(ke(ke({},n.state),{inputValue:null}))},n.handleBlur=function(s){var a,o;(!n.state.open||n.props.withPortal||n.props.showTimeInput)&&((o=(a=n.props).onBlur)===null||o===void 0||o.call(a,s)),n.resetInputValue(),n.state.open&&n.props.open===!1&&n.setOpen(!1),n.setState({focused:!1})},n.handleCalendarClickOutside=function(s){var a,o;n.props.inline||n.setOpen(!1),(o=(a=n.props).onClickOutside)===null||o===void 0||o.call(a,s),n.props.withPortal&&s.preventDefault()},n.handleChange=function(){for(var s,a,o,l,c,u=[],d=0;d<arguments.length;d++)u[d]=arguments[d];var f=u[0];if(!(n.props.onChangeRaw&&(n.props.onChangeRaw.apply(n,u),!f||typeof f.isDefaultPrevented!="function"||f.isDefaultPrevented()))){n.setState({inputValue:(f==null?void 0:f.target)instanceof HTMLInputElement?f.target.value:null,lastPreSelectChange:M$});var m=n.props,h=m.selectsRange,y=m.startDate,v=m.endDate,w=(s=n.props.dateFormat)!==null&&s!==void 0?s:t.defaultProps.dateFormat,g=(a=n.props.strictParsing)!==null&&a!==void 0?a:t.defaultProps.strictParsing,b=(f==null?void 0:f.target)instanceof HTMLInputElement?f.target.value:"";if(h){var p=n.props.rangeSeparator,_=p.trim(),j=b.split(w.includes(_)?p:_,2).map(function(O){return O.trim()}),k=j[0],N=j[1],S=Vf(k??"",w,n.props.locale,g),C=S?Vf(N??"",w,n.props.locale,g):null,E=(y==null?void 0:y.getTime())!==(S==null?void 0:S.getTime()),T=(v==null?void 0:v.getTime())!==(C==null?void 0:C.getTime());if(!E&&!T||S&&yr(S,n.props)||C&&yr(C,n.props))return;(l=(o=n.props).onChange)===null||l===void 0||l.call(o,[S,C],f)}else{var L=Vf(b,w,n.props.locale,g,(c=n.props.selected)!==null&&c!==void 0?c:void 0);(L||!b)&&n.setSelected(L,f,!0)}}},n.handleSelect=function(s,a,o){if(!n.props.readOnly){var l=n.props,c=l.selectsRange,u=l.startDate,d=l.endDate,f=l.swapRange,m=!c||u&&!d&&(f||!Gf(s,u));n.props.shouldCloseOnSelect&&!n.props.showTimeSelect&&m&&n.sendFocusBackToInput(),n.props.onChangeRaw&&n.props.onChangeRaw(a),n.setSelected(s,a,!1,o),n.props.showDateSelect&&n.setState({isRenderAriaLiveMessage:!0}),!n.props.shouldCloseOnSelect||n.props.showTimeSelect?n.setPreSelection(s):m&&n.setOpen(!1)}},n.setSelected=function(s,a,o,l){var c,u,d=s;if(n.props.showYearPicker){if(d!==null&&Gc(ve(d),n.props))return}else if(n.props.showMonthYearPicker){if(d!==null&&Dk(d,n.props))return}else if(d!==null&&yr(d,n.props))return;var f=n.props,m=f.onChange,h=f.selectsRange,y=f.startDate,v=f.endDate,w=f.selectsMultiple,g=f.selectedDates,b=f.minTime,p=f.swapRange;if(!Ks(n.props.selected,d)||n.props.allowSameDay||h||w)if(d!==null&&(n.props.selected&&(!o||!n.props.showTimeSelect&&!n.props.showTimeSelectOnly&&!n.props.showTimeInput)&&(d=Yf(d,{hour:Ln(n.props.selected),minute:In(n.props.selected),second:hs(n.props.selected)})),!o&&(n.props.showTimeSelect||n.props.showTimeSelectOnly)&&b&&(d=Yf(d,{hour:b.getHours(),minute:b.getMinutes(),second:b.getSeconds()})),n.props.inline||n.setState({preSelection:d}),n.props.focusSelectedMonth||n.setState({monthSelectedIn:l})),h){var _=!y&&!v,j=y&&!v,k=!y&&!!v,N=y&&v;_?m==null||m([d,null],a):j?d===null?m==null||m([null,null],a):Gf(d,y)?p?m==null||m([d,y],a):m==null||m([d,null],a):m==null||m([y,d],a):k&&(d&&Gf(d,v)?m==null||m([d,v],a):m==null||m([d,null],a)),N&&(m==null||m([d,null],a))}else if(w){if(d!==null)if(!(g!=null&&g.length))m==null||m([d],a);else{var S=g.some(function(E){return je(E,d)});if(S){var C=g.filter(function(E){return!je(E,d)});m==null||m(C,a)}else m==null||m(ln(ln([],g,!0),[d],!1),a)}}else m==null||m(d,a);o||((u=(c=n.props).onSelect)===null||u===void 0||u.call(c,d,a),n.setState({inputValue:null}))},n.setPreSelection=function(s){if(!n.props.readOnly){var a=Tn(n.props.minDate),o=Tn(n.props.maxDate),l=!0;if(s){var c=Yc(s);if(a&&o)l=Fs(s,n.props.minDate,n.props.maxDate);else if(a){var u=Yc(n.props.minDate);l=fn(s,u)||Ks(c,u)}else if(o){var d=lb(n.props.maxDate);l=on(s,d)||Ks(c,d)}}l&&n.setState({preSelection:s})}},n.toggleCalendar=function(){n.setOpen(!n.state.open)},n.handleTimeChange=function(s){var a,o;if(!(n.props.selectsRange||n.props.selectsMultiple)){var l=n.props.selected?n.props.selected:n.getPreSelection(),c=n.props.selected?s:Yf(l,{hour:Ln(s),minute:In(s)});n.setState({preSelection:c}),(o=(a=n.props).onChange)===null||o===void 0||o.call(a,c),n.props.shouldCloseOnSelect&&!n.props.showTimeInput&&(n.sendFocusBackToInput(),n.setOpen(!1)),n.props.showTimeInput&&n.setOpen(!0),(n.props.showTimeSelectOnly||n.props.showTimeSelect)&&n.setState({isRenderAriaLiveMessage:!0}),n.setState({inputValue:null})}},n.onInputClick=function(){var s,a;!n.props.disabled&&!n.props.readOnly&&n.setOpen(!0),(a=(s=n.props).onInputClick)===null||a===void 0||a.call(s)},n.onInputKeyDown=function(s){var a,o,l,c,u,d;(o=(a=n.props).onKeyDown)===null||o===void 0||o.call(a,s);var f=s.key;if(!n.state.open&&!n.props.inline&&!n.props.preventOpenOnFocus){(f===se.ArrowDown||f===se.ArrowUp||f===se.Enter)&&((l=n.onInputClick)===null||l===void 0||l.call(n));return}if(n.state.open){if(f===se.ArrowDown||f===se.ArrowUp){s.preventDefault();var m=n.props.showTimeSelectOnly?".react-datepicker__time-list-item[tabindex='0']":n.props.showWeekPicker&&n.props.showWeekNumbers?'.react-datepicker__week-number[tabindex="0"]':n.props.showFullMonthYearPicker||n.props.showMonthYearPicker?'.react-datepicker__month-text[tabindex="0"]':'.react-datepicker__day[tabindex="0"]',h=((c=n.calendar)===null||c===void 0?void 0:c.containerRef.current)instanceof Element&&n.calendar.containerRef.current.querySelector(m);h instanceof HTMLElement&&h.focus({preventScroll:!0});return}var y=Re(n.state.preSelection);f===se.Enter?(s.preventDefault(),s.target.blur(),n.inputOk()&&n.state.lastPreSelectChange===Jf?(n.handleSelect(y,s),!n.props.shouldCloseOnSelect&&n.setPreSelection(y)):n.setOpen(!1)):f===se.Escape?(s.preventDefault(),s.target.blur(),n.sendFocusBackToInput(),n.setOpen(!1)):f===se.Tab&&n.setOpen(!1),n.inputOk()||(d=(u=n.props).onInputError)===null||d===void 0||d.call(u,{code:1,msg:Qf})}},n.onPortalKeyDown=function(s){var a=s.key;a===se.Escape&&(s.preventDefault(),n.setState({preventFocus:!0},function(){n.setOpen(!1),setTimeout(function(){n.setFocus(),n.setState({preventFocus:!1})})}))},n.onDayKeyDown=function(s){var a,o,l,c,u,d,f=n.props,m=f.minDate,h=f.maxDate,y=f.disabledKeyboardNavigation,v=f.showWeekPicker,w=f.shouldCloseOnSelect,g=f.locale,b=f.calendarStartDay,p=f.adjustDateOnChange,_=f.inline;if((o=(a=n.props).onKeyDown)===null||o===void 0||o.call(a,s),!y){var j=s.key,k=s.shiftKey,N=Re(n.state.preSelection),S=function(M,B){var F=B;switch(M){case se.ArrowRight:F=v?Ru(B,1):Fr(B,1);break;case se.ArrowLeft:F=v?Gy(B,1):iO(B,1);break;case se.ArrowUp:F=Gy(B,1);break;case se.ArrowDown:F=Ru(B,1);break;case se.PageUp:F=k?mi(B,1):Zs(B,1);break;case se.PageDown:F=k?Pn(B,1):zr(B,1);break;case se.Home:F=ps(B,g,b);break;case se.End:F=YA(B);break}return F},C=function(M,B){for(var F=40,R=M,P=!1,D=0,z=S(M,B);!P;){if(D>=F){z=B;break}m&&z<m&&(R=se.ArrowRight,z=yr(m,n.props)?S(R,z):m),h&&z>h&&(R=se.ArrowLeft,z=yr(h,n.props)?S(R,z):h),yr(z,n.props)?((R===se.PageUp||R===se.Home)&&(R=se.ArrowRight),(R===se.PageDown||R===se.End)&&(R=se.ArrowLeft),z=S(R,z)):P=!0,D++}return z};if(j===se.Enter){s.preventDefault(),n.handleSelect(N,s),!w&&n.setPreSelection(N);return}else if(j===se.Escape){s.preventDefault(),n.setOpen(!1),n.inputOk()||(c=(l=n.props).onInputError)===null||c===void 0||c.call(l,{code:1,msg:Qf});return}var E=null;switch(j){case se.ArrowLeft:case se.ArrowRight:case se.ArrowUp:case se.ArrowDown:case se.PageUp:case se.PageDown:case se.Home:case se.End:E=C(j,N);break}if(!E){(d=(u=n.props).onInputError)===null||d===void 0||d.call(u,{code:1,msg:Qf});return}if(s.preventDefault(),n.setState({lastPreSelectChange:Jf}),p&&n.setSelected(E),n.setPreSelection(E),_){var T=Et(N),L=Et(E),O=ve(N),A=ve(E);T!==L||O!==A?n.setState({shouldFocusDayInline:!0}):n.setState({shouldFocusDayInline:!1})}}},n.onPopperKeyDown=function(s){var a=s.key;a===se.Escape&&(s.preventDefault(),n.sendFocusBackToInput(),n.setOpen(!1))},n.onClearClick=function(s){s&&s.preventDefault&&s.preventDefault(),n.sendFocusBackToInput();var a=n.props,o=a.selectsRange,l=a.onChange;o?l==null||l([null,null],s):l==null||l(null,s),n.setState({inputValue:null})},n.clear=function(){n.onClearClick()},n.onScroll=function(s){typeof n.props.closeOnScroll=="boolean"&&n.props.closeOnScroll?(s.target===document||s.target===document.documentElement||s.target===document.body)&&n.setOpen(!1):typeof n.props.closeOnScroll=="function"&&n.props.closeOnScroll(s)&&n.setOpen(!1)},n.renderCalendar=function(){var s,a;return!n.props.inline&&!n.isCalendarOpen()?null:H.createElement(C$,ke({showMonthYearDropdown:void 0,ref:function(o){n.calendar=o}},n.props,n.state,{setOpen:n.setOpen,dateFormat:(s=n.props.dateFormatCalendar)!==null&&s!==void 0?s:t.defaultProps.dateFormatCalendar,onSelect:n.handleSelect,onClickOutside:n.handleCalendarClickOutside,holidays:a$(n.modifyHolidays()),outsideClickIgnoreClass:n.props.outsideClickIgnoreClass,onDropdownFocus:n.handleDropdownFocus,onTimeChange:n.handleTimeChange,className:n.props.calendarClassName,container:n.props.calendarContainer,handleOnKeyDown:n.props.onKeyDown,handleOnDayKeyDown:n.onDayKeyDown,setPreSelection:n.setPreSelection,dropdownMode:(a=n.props.dropdownMode)!==null&&a!==void 0?a:t.defaultProps.dropdownMode}),n.props.children)},n.renderAriaLiveRegion=function(){var s,a=n.props.locale,o=(s=n.props.dateFormat)!==null&&s!==void 0?s:t.defaultProps.dateFormat,l=n.props.showTimeInput||n.props.showTimeSelect,c=l?"PPPPp":"PPPP",u;return n.props.selectsRange?u="Selected start date: ".concat(hr(n.props.startDate,{dateFormat:c,locale:a}),". ").concat(n.props.endDate?"End date: "+hr(n.props.endDate,{dateFormat:c,locale:a}):""):n.props.showTimeSelectOnly?u="Selected time: ".concat(hr(n.props.selected,{dateFormat:o,locale:a})):n.props.showYearPicker?u="Selected year: ".concat(hr(n.props.selected,{dateFormat:"yyyy",locale:a})):n.props.showMonthYearPicker?u="Selected month: ".concat(hr(n.props.selected,{dateFormat:"MMMM yyyy",locale:a})):n.props.showQuarterYearPicker?u="Selected quarter: ".concat(hr(n.props.selected,{dateFormat:"yyyy, QQQ",locale:a})):u="Selected date: ".concat(hr(n.props.selected,{dateFormat:c,locale:a})),H.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},u)},n.renderDateInput=function(){var s,a,o=wt(n.props.className,(s={},s[n.props.outsideClickIgnoreClass||t.defaultProps.outsideClickIgnoreClass]=n.state.open,s)),l=n.props.customInput||H.createElement("input",{type:"text"}),c=n.props.customInputRef||"ref";return x.cloneElement(l,(a={},a[c]=function(u){n.input=u},a.value=n.getInputValue(),a.onBlur=n.handleBlur,a.onChange=n.handleChange,a.onClick=n.onInputClick,a.onFocus=n.handleFocus,a.onKeyDown=n.onInputKeyDown,a.id=n.props.id,a.name=n.props.name,a.form=n.props.form,a.autoFocus=n.props.autoFocus,a.placeholder=n.props.placeholderText,a.disabled=n.props.disabled,a.autoComplete=n.props.autoComplete,a.className=wt(l.props.className,o),a.title=n.props.title,a.readOnly=n.props.readOnly,a.required=n.props.required,a.tabIndex=n.props.tabIndex,a["aria-describedby"]=n.props.ariaDescribedBy,a["aria-invalid"]=n.props.ariaInvalid,a["aria-labelledby"]=n.props.ariaLabelledBy,a["aria-required"]=n.props.ariaRequired,a))},n.renderClearButton=function(){var s=n.props,a=s.isClearable,o=s.disabled,l=s.selected,c=s.startDate,u=s.endDate,d=s.clearButtonTitle,f=s.clearButtonClassName,m=f===void 0?"":f,h=s.ariaLabelClose,y=h===void 0?"Close":h,v=s.selectedDates,w=s.readOnly;return a&&!w&&(l!=null||c!=null||u!=null||v!=null&&v.length)?H.createElement("button",{type:"button",className:wt("react-datepicker__close-icon",m,{"react-datepicker__close-icon--disabled":o}),disabled:o,"aria-label":y,onClick:n.onClearClick,title:d,tabIndex:-1}):null},n.state=n.calcInitialState(),n.preventFocusTimeout=void 0,n}return Object.defineProperty(t,"defaultProps",{get:function(){return{allowSameDay:!1,dateFormat:"MM/dd/yyyy",dateFormatCalendar:"LLLL yyyy",disabled:!1,disabledKeyboardNavigation:!1,dropdownMode:"scroll",preventOpenOnFocus:!1,monthsShown:1,outsideClickIgnoreClass:Ik,readOnly:!1,rangeSeparator:Ck,withPortal:!1,selectsDisabledDaysInRange:!1,shouldCloseOnSelect:!0,showTimeSelect:!1,showTimeInput:!1,showPreviousMonths:!1,showMonthYearPicker:!1,showFullMonthYearPicker:!1,showTwoColumnMonthYearPicker:!1,showFourColumnMonthYearPicker:!1,showYearPicker:!1,showQuarterYearPicker:!1,showWeekPicker:!1,strictParsing:!1,swapRange:!1,timeIntervals:30,timeCaption:"Time",previousMonthAriaLabel:"Previous Month",previousMonthButtonLabel:"Previous Month",nextMonthAriaLabel:"Next Month",nextMonthButtonLabel:"Next Month",previousYearAriaLabel:"Previous Year",previousYearButtonLabel:"Previous Year",nextYearAriaLabel:"Next Year",nextYearButtonLabel:"Next Year",timeInputLabel:"Time",enableTabLoop:!0,yearItemNumber:Tl,focusSelectedMonth:!1,showPopperArrow:!0,excludeScrollbar:!0,customTimeInput:null,calendarStartDay:void 0,toggleCalendarOnIconClick:!1,usePointerEvent:!1}},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){window.addEventListener("scroll",this.onScroll,!0),document.addEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},t.prototype.componentDidUpdate=function(r,n){var s,a,o,l;r.inline&&R$(r.selected,this.props.selected)&&this.setPreSelection(this.props.selected),this.state.monthSelectedIn!==void 0&&r.monthsShown!==this.props.monthsShown&&this.setState({monthSelectedIn:0}),r.highlightDates!==this.props.highlightDates&&this.setState({highlightDates:gb(this.props.highlightDates)}),!n.focused&&!Ks(r.selected,this.props.selected)&&this.setState({inputValue:null}),n.open!==this.state.open&&(n.open===!1&&this.state.open===!0&&((a=(s=this.props).onCalendarOpen)===null||a===void 0||a.call(s)),n.open===!0&&this.state.open===!1&&((l=(o=this.props).onCalendarClose)===null||l===void 0||l.call(o)))},t.prototype.componentWillUnmount=function(){this.clearPreventFocusTimeout(),window.removeEventListener("scroll",this.onScroll,!0),document.removeEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},t.prototype.renderInputContainer=function(){var r=this.props,n=r.showIcon,s=r.icon,a=r.calendarIconClassname,o=r.calendarIconClassName,l=r.toggleCalendarOnIconClick,c=this.state.open;return a&&console.warn("calendarIconClassname props is deprecated. should use calendarIconClassName props."),H.createElement("div",{className:"react-datepicker__input-container".concat(n?" react-datepicker__view-calendar-icon":"")},n&&H.createElement(E$,ke({icon:s,className:wt(o,!o&&a,c&&"react-datepicker-ignore-onclickoutside")},l?{onClick:this.toggleCalendar}:null)),this.state.isRenderAriaLiveMessage&&this.renderAriaLiveRegion(),this.renderDateInput(),this.renderClearButton())},t.prototype.render=function(){var r=this.renderCalendar();if(this.props.inline)return r;if(this.props.withPortal){var n=this.state.open?H.createElement(Mk,{enableTabLoop:this.props.enableTabLoop},H.createElement("div",{className:"react-datepicker__portal",tabIndex:-1,onKeyDown:this.onPortalKeyDown},r)):null;return this.state.open&&this.props.portalId&&(n=H.createElement(Rk,ke({portalId:this.props.portalId},this.props),n)),H.createElement("div",null,this.renderInputContainer(),n)}return H.createElement(I$,ke({},this.props,{className:this.props.popperClassName,hidePopper:!this.isCalendarOpen(),targetComponent:this.renderInputContainer(),popperComponent:r,popperOnKeyDown:this.onPopperKeyDown,showArrow:this.props.showPopperArrow}))},t}(x.Component),M$="input",Jf="navigate";function O$({value:e,onChange:t,label:r="Site Submit"}){const[n,s]=x.useState(""),[a,o]=x.useState([]),[l,c]=x.useState(null),[u,d]=x.useState(!1),f=x.useRef(null),m=x.useRef(null);x.useEffect(()=>{e?$.from("site_submit").select("*").eq("id",e).single().then(({data:w})=>{w&&(c(w),s(w.code||""))}):(c(null),s(""))},[e]),x.useEffect(()=>{const g=setTimeout(async()=>{if(n.length===0){o([]);return}const{data:b}=await $.from("site_submit").select("*").or(`site_submit_name.ilike.%${n}%,code.ilike.%${n}%`).limit(10).order("site_submit_name");b&&o(b)},300);return()=>clearTimeout(g)},[n]),x.useEffect(()=>{const w=g=>{m.current&&!m.current.contains(g.target)&&f.current&&!f.current.contains(g.target)&&d(!1)};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]);const h=w=>{c(w),s(w.code||""),t(w.id),d(!1),o([])},y=w=>{s(w.target.value),d(!0),w.target.value===""&&(t(null),c(null))},v=()=>{f.current&&f.current.select(),n.length>0&&d(!0)};return i.jsxs("div",{className:"relative",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:r}),i.jsxs("div",{className:"relative mt-1",children:[i.jsx("input",{ref:f,type:"text",value:n,onChange:y,onFocus:v,placeholder:"Search by site submit name...",className:"block w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm"}),u&&a.length>0&&i.jsx("div",{ref:m,className:"absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-md shadow-lg max-h-48 overflow-auto",children:a.map(w=>i.jsxs("div",{onClick:()=>h(w),className:"p-2 hover:bg-gray-100 cursor-pointer text-sm",children:[i.jsx("div",{className:"font-medium",children:w.code}),w.site_submit_name&&i.jsx("div",{className:"text-xs text-gray-500",children:w.site_submit_name})]},w.id))})]}),l&&i.jsx("div",{className:"mt-1",children:i.jsx("button",{type:"button",className:"text-xs text-blue-600 hover:text-blue-800",onClick:()=>{console.log("View site submit:",l.id)},children:"View Site Submit Details "})})]})}function Gg({value:e,onChange:t,propertyId:r,label:n="Property Unit"}){const[s,a]=x.useState(""),[o,l]=x.useState([]),[c,u]=x.useState(null),[d,f]=x.useState(!1),m=x.useRef(null),h=x.useRef(null);x.useEffect(()=>{e?$.from("property_unit").select("*").eq("id",e).single().then(({data:b})=>{b&&(u(b),a(b.property_unit_name||""))}):(u(null),a(""))},[e]),x.useEffect(()=>{const p=setTimeout(async()=>{if(!r){l([]);return}let _=$.from("property_unit").select("*").eq("property_id",r);s.length>0&&(_=_.ilike("property_unit_name",`%${s}%`));const{data:j}=await _.limit(20).order("property_unit_name");j&&l(j)},300);return()=>clearTimeout(p)},[s,r,d]),x.useEffect(()=>{const b=p=>{h.current&&!h.current.contains(p.target)&&m.current&&!m.current.contains(p.target)&&f(!1)};return document.addEventListener("mousedown",b),()=>document.removeEventListener("mousedown",b)},[]);const y=b=>{u(b),a(b.property_unit_name||""),t(b.id),f(!1)},v=b=>{a(b.target.value),f(!0),b.target.value===""&&(t(null),u(null))},w=()=>{r&&(m.current&&m.current.select(),f(!0))},g=b=>{const p=[];b.sqft&&p.push(`${Number(b.sqft).toLocaleString()} sqft`),b.rent&&p.push(`$${Number(b.rent).toLocaleString()}/mo`);const _=[];return b.inline===!0&&_.push("Inline"),b.end_cap===!0&&_.push("End Cap"),b.patio===!0&&_.push("Patio"),_.length>0&&p.push(_.join(", ")),p.join("  ")};return i.jsxs("div",{className:"relative",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:n}),i.jsxs("div",{className:"relative mt-1",children:[i.jsx("input",{ref:m,type:"text",value:s,onChange:v,onFocus:w,placeholder:r?"Search or select unit...":"Select a property first",disabled:!r,className:"block w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm disabled:bg-gray-100 disabled:cursor-not-allowed"}),d&&o.length>0&&r&&i.jsx("div",{ref:h,className:"absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-md shadow-lg max-h-48 overflow-auto",children:o.map(b=>i.jsxs("div",{onClick:()=>y(b),className:"p-2 hover:bg-gray-100 cursor-pointer text-sm",children:[i.jsx("div",{className:"font-medium",children:b.property_unit_name}),i.jsx("div",{className:"text-xs text-gray-500",children:g(b)})]},b.id))}),d&&o.length===0&&r&&s.length>0&&i.jsx("div",{className:"absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-md shadow-lg p-2 text-sm text-gray-500",children:"No units found for this property"})]}),c&&i.jsx("div",{className:"mt-1",children:i.jsx("button",{type:"button",className:"text-xs text-blue-600 hover:text-blue-800",onClick:()=>{console.log("View property unit:",c.id)},children:"View Property Unit Details "})})]})}function Kg({value:e,onChange:t,label:r="Property"}){const n=Jt(),[s,a]=x.useState(""),[o,l]=x.useState([]),[c,u]=x.useState(null),[d,f]=x.useState(!1),[m,h]=x.useState(!1),y=x.useRef(null),v=x.useRef(null);x.useEffect(()=>{e?$.from("property").select("*").eq("id",e).single().then(({data:p})=>{p&&(u(p),a(p.property_name||""))}):(u(null),a(""))},[e]),x.useEffect(()=>{const _=setTimeout(async()=>{if(!s||s.trim().length===0){l([]);return}h(!0),console.log("Searching for:",s);const{data:j,error:k}=await $.from("property").select("*").ilike("property_name",`%${s}%`).limit(10).order("property_name");l(j||[]),h(!1)},300);return()=>clearTimeout(_)},[s]),x.useEffect(()=>{const p=_=>{v.current&&!v.current.contains(_.target)&&y.current&&!y.current.contains(_.target)&&f(!1)};return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[]);const w=p=>{u(p),a(p.property_name||""),t(p.id),f(!1),l([])},g=p=>{const _=p.target.value;a(_),_.length>0&&f(!0),c&&_!==c.property_name&&(u(null),t(null)),_===""&&(t(null),u(null),l([]),f(!1))},b=()=>{y.current&&y.current.select(),o.length>0&&f(!0)};return i.jsxs("div",{className:"relative",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:r}),i.jsxs("div",{className:"relative mt-1",children:[i.jsx("input",{ref:y,type:"text",value:s,onChange:g,onFocus:b,placeholder:"Type to search properties...",className:"block w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm"}),d&&i.jsx("div",{ref:v,className:"absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-md shadow-lg max-h-48 overflow-auto",children:m?i.jsx("div",{className:"p-2 text-sm text-gray-500",children:"Loading..."}):o.length>0?o.map(p=>{var _,j,k,N;return i.jsxs("div",{onClick:()=>w(p),className:"p-2 hover:bg-gray-100 cursor-pointer text-sm",children:[i.jsx("div",{className:"font-medium",children:p.property_name}),(((_=p.property_type)==null?void 0:_.label)||((j=p.property_stage)==null?void 0:j.label))&&i.jsx("div",{className:"text-xs text-gray-500",children:[(k=p.property_type)==null?void 0:k.label,(N=p.property_stage)==null?void 0:N.label].filter(Boolean).join("  ")})]},p.id)}):s.length>0?i.jsx("div",{className:"p-2 text-sm text-gray-500",children:"No properties found"}):null})]}),c&&i.jsx("div",{className:"mt-1",children:i.jsx("button",{type:"button",className:"text-xs text-blue-600 hover:text-blue-800 transition-colors",onClick:()=>{n(`/property/${c.id}`)},children:"View Property Details "})})]})}const A$={"Negotiating LOI":50,"At Lease/PSA":75,"Under Contract / Contingent":85,Booked:90,"Executed Payable":95,"Closed Paid":100,Lost:0};function $$({deal:e,onSave:t}){const r=Jt(),[n,s]=x.useState(e),[a,o]=x.useState(!1),[l,c]=x.useState(null),[u,d]=x.useState([]),[f,m]=x.useState([]),[h,y]=x.useState(""),[v,w]=x.useState(""),[g,b]=x.useState([]),[p,_]=x.useState({}),[j,k]=x.useState(!1),[N,S]=x.useState(!1),C=x.useRef(null),E=x.useRef(!0);x.useEffect(()=>{s(e),_({}),S(!1),C.current=e.stage_id??null,E.current=!0},[e]),x.useEffect(()=>{$.from("deal_stage").select("id, label").then(({data:P})=>P&&d(P)),$.from("deal_team").select("id, label").then(({data:P})=>P&&m(P)),e.updated_by_id&&$.from("user").select("name").eq("id",e.updated_by_id).maybeSingle().then(({data:P})=>(P==null?void 0:P.name)&&y(P.name)),e.client_id?$.from("client").select("client_name").eq("id",e.client_id).maybeSingle().then(({data:P})=>(P==null?void 0:P.client_name)&&w(P.client_name)):w("")},[e.client_id,e.property_id]),x.useEffect(()=>{const D=setTimeout(async()=>{const z=v.trim();if(!z)return b([]);const{data:W}=await $.from("client").select("id, client_name").ilike("client_name",`%${z}%`).order("client_name",{ascending:!0}).limit(5);W&&b(W.map(I=>({id:I.id,label:I.client_name})))},150);return()=>clearTimeout(D)},[v]);const T=(P,D)=>{P==="probability"&&S(!0);const z={...n,[P]:D};if(s(z),["deal_name","deal_value","commission_percent"].includes(P)){const W=A(P,D);_(I=>{const ne={...I},re=W[P];return re?ne[P]=re:delete ne[P],ne})}if(P==="commission_percent"){const W=z.flat_fee_override??(z.deal_value??0)*((D??0)/100);(async()=>{if(!n.id){console.log("Skipping auto-save for new deal");return}const{data:ne,error:re}=await $.from("deal").update({commission_percent:D,fee:W}).eq("id",n.id).select().single();re?console.error("Error auto-saving commission:",re):ne&&t(ne)})()}},L=n.flat_fee_override??(n.deal_value??0)*((n.commission_percent??0)/100),O=()=>{var P;return(P=u.find(D=>D.id===n.stage_id))==null?void 0:P.label};x.useEffect(()=>{if(!n.stage_id||u.length===0)return;const P=O();if(!P)return;const D=A$[P];if(E.current){if(E.current=!1,n.probability==null&&typeof D=="number"){s(I=>({...I,probability:D})),k(!0);const W=setTimeout(()=>k(!1),800);return()=>clearTimeout(W)}return}if(C.current!==n.stage_id&&typeof D=="number"){s(I=>({...I,probability:D})),S(!1),k(!0);const W=setTimeout(()=>k(!1),800);return C.current=n.stage_id,()=>clearTimeout(W)}C.current=n.stage_id},[n.stage_id,u]);const A=(P,D)=>{const z={};if(P==="deal_name"&&(!D||String(D).trim().length===0)&&(z.deal_name="Deal Name is required."),P==="deal_value"&&(D===null||D===""||isNaN(Number(D))?z.deal_value="Enter a number.":Number(D)<0&&(z.deal_value="Must be  0.")),P==="commission_percent"){const W=Number(D);D===null||D===""||isNaN(W)?z.commission_percent="Enter a percent.":(W<0||W>100)&&(z.commission_percent="0100 only.")}return z},M=P=>{const D={};return Object.assign(D,A("deal_name",P.deal_name)),Object.assign(D,A("deal_value",P.deal_value)),Object.assign(D,A("commission_percent",P.commission_percent)),D},B=async()=>{const P=M(n);if(_(P),Object.keys(P).length>0)return;o(!0);const D={deal_name:n.deal_name,client_id:n.client_id,property_id:n.property_id,property_unit_id:n.property_unit_id,site_submit_id:n.site_submit_id,deal_value:n.deal_value,commission_percent:n.commission_percent,flat_fee_override:n.flat_fee_override,fee:L,target_close_date:n.target_close_date,loi_signed_date:n.loi_signed_date,closed_date:n.closed_date,probability:n.probability,deal_team_id:n.deal_team_id,stage_id:n.stage_id,house_percent:n.house_percent,origination_percent:n.origination_percent,site_percent:n.site_percent,deal_percent:n.deal_percent,number_of_payments:n.number_of_payments,updated_at:new Date().toISOString()};let z,W;if(n.id){const I=await $.from("deal").update(D).eq("id",n.id).select().single();z=I.data,W=I.error}else{D.created_at=new Date().toISOString();const I=await $.from("deal").insert([D]).select().single();z=I.data,W=I.error}o(!1),W?alert("Error saving: "+W.message):z&&t(z)},F=O(),R=F==="Closed Paid";return i.jsxs("div",{className:"relative",children:[i.jsx(xc,{title:"Deal Context",help:"Name the opportunity, choose the client, property, and deal team.",children:i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsx(F$,{label:"Deal Name",value:n.deal_name,onChange:P=>T("deal_name",P)}),i.jsx(B$,{label:"Client",search:v,setSearch:w,suggestions:g,onSelect:(P,D)=>{T("client_id",P),w(D),b([])},selectedId:n.client_id,onNavigate:P=>r(`/client/${P}`)}),i.jsx(Kg,{value:n.property_id,onChange:P=>T("property_id",P),label:"Property"}),i.jsx(Gg,{value:n.property_unit_id,onChange:P=>T("property_unit_id",P),propertyId:n.property_id,label:"Property Unit"}),i.jsx(O$,{value:n.site_submit_id,onChange:P=>T("site_submit_id",P),label:"Site Submit"}),i.jsx(_b,{label:"Deal Team",value:n.deal_team_id,onChange:P=>T("deal_team_id",P),options:f}),p.deal_name&&i.jsx(Xf,{msg:p.deal_name,className:"col-span-2"})]})}),i.jsx(xc,{title:"Financials",help:"Set value and commission. Fee auto-calculates unless a flat fee is set.",children:i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsx(Ys,{label:"Deal Value",value:n.deal_value,onChange:P=>T("deal_value",P===""?null:parseFloat(P)),format:P=>Ro(P,2),editingField:l,setEditingField:c,fieldKey:"deal_value"}),p.deal_value&&i.jsx(Xf,{msg:p.deal_value}),i.jsx(Ys,{label:"Commission %",value:n.commission_percent,onChange:P=>T("commission_percent",P===""?null:parseFloat(P)),format:P=>Ih(P,2),editingField:l,setEditingField:c,fieldKey:"commission_percent"}),p.commission_percent&&i.jsx(Xf,{msg:p.commission_percent}),i.jsx(Ys,{label:"Flat Fee Override",value:n.flat_fee_override,onChange:P=>T("flat_fee_override",P===""?null:parseFloat(P)),format:P=>P===null?"":Ro(P,2),editingField:l,setEditingField:c,fieldKey:"flat_fee_override"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Calculated Fee"}),i.jsx("div",{className:"mt-1 p-2 bg-gray-100 rounded text-sm",children:isNaN(L)?"":Ro(L,2)})]})]})}),i.jsx(xc,{title:"Stage & Probability",help:"Choosing a stage will set a default probability. You can override it.",children:i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsx(_b,{label:"Stage",value:n.stage_id,onChange:P=>T("stage_id",P),options:u}),i.jsx("div",{className:"rounded transition-colors duration-700 "+(j?"bg-yellow-50":"bg-transparent"),children:i.jsx(Ys,{label:"Probability %",value:n.probability,onChange:P=>T("probability",P===""?null:parseFloat(P)),format:P=>GI(P),editingField:l,setEditingField:c,fieldKey:"probability"})})]})}),i.jsx(xc,{title:"Timeline",help:"Target and actual dates. Closed Date enabled only at Closed Paid.",children:i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsx(Zf,{label:"Target Close Date",value:n.target_close_date,onChange:P=>T("target_close_date",P)}),i.jsx(Zf,{label:"LOI Signed Date",value:n.loi_signed_date,onChange:P=>T("loi_signed_date",P)}),i.jsx(Zf,{label:"Closed Date",value:n.closed_date,onChange:P=>T("closed_date",P),disabled:!R,tooltip:R?void 0:"Set Stage to 'Closed Paid' to enable"})]})}),i.jsxs("div",{className:"sticky bottom-0 left-0 right-0 bg-white border-t mt-6 p-3 flex items-center justify-between shadow-sm",children:[i.jsx("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:n.updated_at?i.jsxs(i.Fragment,{children:[i.jsx("span",{children:"Last Updated by"}),i.jsx("span",{className:"font-medium",children:h||"Unknown"}),i.jsxs("span",{children:[new Date(n.updated_at).toLocaleDateString()," ",new Date(n.updated_at).toLocaleTimeString()]})]}):i.jsx("span",{children:"Not yet saved"})}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"text-xs text-gray-500",children:F?`Stage: ${F}`:"No stage selected"}),i.jsx("button",{onClick:B,disabled:a||Object.keys(p).length>0,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-60",children:a?"Saving...":"Save Deal"})]})]})]})}function xc({title:e,help:t,children:r}){return i.jsxs("section",{className:"bg-white rounded-md border p-4 mb-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:e}),t&&i.jsx("span",{className:"text-gray-500 text-xs border rounded-full w-4 h-4 inline-flex items-center justify-center",title:t,"aria-label":t,children:"i"})]}),r]})}function Xf({msg:e,className:t=""}){return i.jsx("p",{className:"text-xs text-red-600 mt-1 "+t,children:e})}function F$({label:e,value:t,onChange:r,type:n="text",className:s=""}){return i.jsxs("div",{className:s,children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:e}),i.jsx("input",{type:n,value:t??"",onChange:a=>r(a.target.value),className:"mt-1 block w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm"})]})}function Zf({label:e,value:t,onChange:r,disabled:n,tooltip:s}){const a=t?Fg(t):null;return i.jsxs("div",{title:s,children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:e}),i.jsx(Ok,{selected:a,onChange:o=>r(o?kr(o,"yyyy-MM-dd"):null),className:`mt-1 block w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${n?"bg-gray-100 cursor-not-allowed":""}`,dateFormat:"MM/dd/yyyy",isClearable:!0,disabled:n})]})}function _b({label:e,value:t,onChange:r,options:n}){return i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:e}),i.jsxs("select",{value:t??"",onChange:s=>r(s.target.value),className:"mt-1 block w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",children:[i.jsx("option",{value:"",children:"-- Select --"}),n.map(s=>i.jsx("option",{value:s.id,children:s.label},s.id))]})]})}function B$({label:e,search:t,setSearch:r,suggestions:n,onSelect:s,selectedId:a,onNavigate:o}){const l=x.useRef(null),c=()=>{l.current&&l.current.select()},u=a&&t.trim();return i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:e}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("input",{ref:l,type:"text",value:t,onChange:d=>r(d.target.value),onFocus:c,placeholder:`Search ${e.toLowerCase()}...`,className:"mt-1 block w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm"}),u&&o&&i.jsx("button",{type:"button",onClick:()=>o(a),className:"mt-1 inline-flex items-center px-3 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",title:`View ${e}`,children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})})]}),n.filter(d=>d.label!==t).length>0&&i.jsx("ul",{className:"bg-white border border-gray-300 rounded mt-1 max-h-48 overflow-auto",children:n.filter(d=>d.label!==t).map(d=>i.jsx("li",{onClick:()=>s(d.id,d.label),className:"p-2 hover:bg-gray-100 cursor-pointer text-sm",children:d.label},d.id))})]})}const Ak=x.createContext(null),$k=()=>{const e=x.useContext(Ak);if(!e)throw new Error("usePanelManager must be used within a FloatingPanelManager");return e},U$=({children:e})=>{const[t,r]=x.useState(null),n=o=>{r(o)},s=()=>{r(null)},a=o=>{t===o?s():n(o)};return i.jsx(Ak.Provider,{value:{activePanel:t,openPanel:n,closePanel:s,togglePanel:a},children:e})},eo=({type:e,icon:t,count:r,label:n,position:s})=>{const{activePanel:a,togglePanel:o}=$k(),l=a===e;return i.jsxs("div",{className:"relative group",children:[i.jsxs("button",{onClick:()=>o(e),className:`
          relative flex items-center justify-center w-10 h-10 rounded-full shadow-md
          transition-all duration-300 ease-out hover:scale-110 hover:shadow-lg
          backdrop-blur-sm border
          ${l?"bg-blue-600 text-white border-blue-500 shadow-blue-200":"bg-white/90 text-gray-600 hover:bg-white border-gray-200 hover:text-gray-800"}
        `,title:n,children:[i.jsx("span",{className:"text-sm",children:t}),r!==void 0&&r>0&&i.jsx("span",{className:`
            absolute -top-1 -right-1 flex items-center justify-center w-5 h-5 text-xs font-medium rounded-full
            border-2 border-white
            ${l?"bg-white text-blue-600":"bg-red-500 text-white"}
          `,children:r>99?"99+":r})]}),i.jsxs("div",{className:"absolute right-full mr-3 px-3 py-1.5 bg-gray-900 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none",children:[n,r!==void 0&&i.jsxs("span",{className:"ml-1 text-gray-300",children:["(",r,")"]}),i.jsx("div",{className:"absolute left-full top-1/2 transform -translate-y-1/2 w-0 h-0 border-l-4 border-l-gray-900 border-t-4 border-t-transparent border-b-4 border-b-transparent"})]})]})},z$=({children:e,contactCount:t=0,notesCount:r=0,filesCount:n=0,activityCount:s=0,paymentsCount:a=0})=>i.jsxs("div",{className:"relative",children:[e,i.jsxs("div",{className:"fixed right-4 top-1/2 transform -translate-y-1/2 space-y-3",style:{zIndex:50},children:[i.jsx(eo,{type:"contacts",icon:"",count:t,label:"Contact Roles",position:0}),i.jsx(eo,{type:"notes",icon:"",count:r,label:"Notes",position:1}),i.jsx(eo,{type:"files",icon:"",count:n,label:"Files",position:2}),i.jsx(eo,{type:"activity",icon:"",count:s,label:"Activity",position:3}),i.jsx(eo,{type:"payments",icon:"",count:a,label:"Payments",position:4})]})]}),Fk=e=>{const[t,r]=x.useState([]),[n,s]=x.useState(!0),[a,o]=x.useState(null);return x.useEffect(()=>{(async()=>{if(!e){r([]),s(!1);return}try{s(!0),o(null);const{data:c,error:u}=await $.from("deal_contact").select("id, contact_id, role_id, primary_contact").eq("deal_id",e);if(u)throw u;if(!c||c.length===0){r([]),s(!1);return}const d=[...new Set(c.map(p=>p.contact_id).filter(Boolean))],f=[...new Set(c.map(p=>p.role_id).filter(Boolean))],{data:m,error:h}=await $.from("contact").select("id, first_name, last_name, email, phone, mobile_phone").in("id",d);if(h)throw h;const{data:y,error:v}=await $.from("contact_role").select("role_id, label").in("role_id",f);if(v)throw v;const w=new Map;m==null||m.forEach(p=>{w.set(p.id,p)});const g=new Map;y==null||y.forEach(p=>{g.set(p.role_id,p)});const b=c.map(p=>{const _=w.get(p.contact_id),j=g.get(p.role_id);let k="Unknown Contact";if(_){const N=_.first_name||"",S=_.last_name||"";N&&S?k=`${N} ${S}`:N?k=N:S&&(k=S)}return{id:p.id,contact_name:k,contact_email:(_==null?void 0:_.email)||null,contact_phone:(_==null?void 0:_.phone)||null,contact_mobile:(_==null?void 0:_.mobile_phone)||null,role_label:(j==null?void 0:j.label)||"No Role",primary_contact:p.primary_contact||!1,contact_id:p.contact_id}});b.sort((p,_)=>p.primary_contact&&!_.primary_contact?-1:!p.primary_contact&&_.primary_contact?1:p.role_label.localeCompare(_.role_label)),r(b)}catch(c){console.error("Error fetching deal contacts:",c),o("Failed to load contacts")}finally{s(!1)}})()},[e]),{contacts:t,loading:n,error:a,refetch:()=>{e&&s(!0)}}},W$=({dealId:e})=>{const{activePanel:t,closePanel:r}=$k(),{contacts:n,loading:s,error:a}=Fk(e),o=t==="contacts",l=u=>{const d=u.split(" ");return d.length>=2?`${d[0].charAt(0)}${d[d.length-1].charAt(0)}`.toUpperCase():u.charAt(0).toUpperCase()||"?"},c=(u,d)=>{u&&window.open(`tel:${u}`,"_self")};return o?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 bg-black/10 transition-all duration-300 z-40",onClick:r}),i.jsxs("div",{className:`
        fixed right-0 top-0 h-full w-80 bg-white shadow-2xl border-l border-gray-200
        transform transition-all duration-300 ease-out z-50
        ${o?"translate-x-0":"translate-x-full"}
        flex flex-col
      `,children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-100 bg-white shrink-0",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center shadow-sm",children:i.jsx("span",{className:"text-white text-sm",children:""})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Contacts"}),i.jsxs("p",{className:"text-xs text-gray-500",children:[n.length," contact",n.length!==1?"s":""," on this deal"]})]})]}),i.jsx("button",{onClick:r,className:"w-8 h-8 flex items-center justify-center rounded-lg hover:bg-gray-100 transition-colors",children:i.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsx("div",{className:"flex-1 overflow-y-auto",children:s?i.jsx("div",{className:"p-4 space-y-4",children:[...Array(3)].map((u,d)=>i.jsx("div",{className:"animate-pulse",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2"}),i.jsx("div",{className:"h-3 bg-gray-200 rounded w-2/3"})]})]})},d))}):a?i.jsxs("div",{className:"p-6 text-center",children:[i.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-3",children:i.jsx("span",{className:"text-red-500 text-lg",children:""})}),i.jsx("p",{className:"text-red-600 font-medium mb-1",children:"Error Loading Contacts"}),i.jsx("p",{className:"text-sm text-gray-500",children:a})]}):n.length===0?i.jsxs("div",{className:"p-6 text-center",children:[i.jsx("div",{className:"w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx("span",{className:"text-gray-300 text-2xl",children:""})}),i.jsx("p",{className:"text-gray-700 font-medium mb-2",children:"No Contacts Yet"}),i.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Add contacts to this deal to see them here"}),i.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",children:"Add Contact"})]}):i.jsx("div",{className:"divide-y divide-gray-50",children:n.map(u=>i.jsx("div",{className:"p-4 hover:bg-gray-25 transition-colors",children:i.jsxs("div",{className:"flex items-start space-x-3",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-400 to-blue-500 rounded-full flex items-center justify-center shadow-sm",children:i.jsx("span",{className:"text-white font-medium text-sm",children:l(u.contact_name)})})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[i.jsx("button",{className:"text-sm font-semibold text-gray-900 hover:text-blue-600 transition-colors truncate",onClick:()=>{console.log("View contact:",u.contact_id)},children:u.contact_name}),u.primary_contact&&i.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-green-100 text-green-700 border border-green-200",children:"Primary"})]}),i.jsx("p",{className:"text-xs font-medium text-blue-600 mb-2",children:u.role_label}),i.jsxs("div",{className:"space-y-1",children:[u.contact_email&&i.jsxs("p",{className:"text-xs text-gray-600 truncate",children:[" ",u.contact_email]}),u.contact_phone&&i.jsxs("button",{onClick:()=>c(u.contact_phone,u.contact_name),className:"text-xs text-gray-600 hover:text-blue-600 transition-colors cursor-pointer",children:[" ",u.contact_phone]}),u.contact_mobile&&i.jsxs("button",{onClick:()=>c(u.contact_mobile,u.contact_name),className:"text-xs text-gray-600 hover:text-blue-600 transition-colors cursor-pointer block",children:[" ",u.contact_mobile]})]})]})]})},u.id))})}),i.jsx("div",{className:"p-4 border-t border-gray-100 bg-gray-50 shrink-0",children:i.jsxs("button",{className:"w-full flex items-center justify-center px-4 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",children:[i.jsx("span",{className:"mr-2",children:"+"}),"Add Contact Role"]})})]})]}):null},kn=({label:e,value:t,onChange:r,disabled:n=!1})=>{const[s,a]=x.useState(!1),[o,l]=x.useState(""),c=t?`${t.toFixed(1)}%`:"0.0%",u=()=>{n||(a(!0),l((t==null?void 0:t.toString())||""))},d=()=>{const h=parseFloat(o);r(isNaN(h)?null:h),a(!1)},f=()=>{a(!1),l("")},m=h=>{h.key==="Enter"?(h.preventDefault(),h.stopPropagation(),d()):h.key==="Escape"&&(h.preventDefault(),h.stopPropagation(),f())};return s?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),i.jsx("input",{type:"number",step:"0.1",value:o,onChange:h=>l(h.target.value),onBlur:d,onKeyDown:m,className:"mt-1 block w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",autoFocus:!0})]}):i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:e}),i.jsx("div",{onClick:u,className:`mt-1 block w-full rounded border-gray-300 shadow-sm px-3 py-2 transition-colors border text-sm ${n?"bg-gray-100 cursor-not-allowed border-gray-200":"cursor-pointer hover:bg-blue-50 border-transparent hover:border-blue-200"}`,title:n?"Not editable":"Click to edit",children:c})]})},Bk=({value:e,onChange:t,label:r="Referral Payee",tabIndex:n})=>{const[s,a]=x.useState(""),[o,l]=x.useState([]),c=x.useRef(null);x.useEffect(()=>{(async()=>{if(e){const{data:h}=await $.from("client").select("client_name").eq("id",e).single();h!=null&&h.client_name&&a(h.client_name)}else a("")})()},[e]),x.useEffect(()=>{const h=setTimeout(async()=>{const y=s.trim();if(!y)return l([]);const{data:v}=await $.from("client").select("id, client_name").ilike("client_name",`%${y}%`).order("client_name",{ascending:!0}).limit(5);v&&l(v.map(w=>({id:w.id,label:w.client_name})))},150);return()=>clearTimeout(h)},[s]);const u=()=>{c.current&&c.current.select()},d=(m,h)=>{t(m),a(h),l([])},f=m=>{const h=m.target.value;a(h),h===""&&t(null)};return i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:r}),i.jsx("input",{ref:c,type:"text",value:s,onChange:f,onFocus:u,placeholder:`Search ${r.toLowerCase()}...`,className:"mt-1 block w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",tabIndex:n}),o.filter(m=>m.label!==s).length>0&&i.jsx("ul",{className:"bg-white border border-gray-300 rounded mt-1 max-h-48 overflow-auto",children:o.filter(m=>m.label!==s).map(m=>i.jsx("li",{onClick:()=>d(m.id,m.label),className:"p-2 hover:bg-gray-100 cursor-pointer text-sm",children:m.label},m.id))})]})},Qg=(e,t=[])=>x.useMemo(()=>{const r=(e==null?void 0:e.fee)||0,n=(e==null?void 0:e.referral_fee_usd)||0,s=(e==null?void 0:e.house_usd)||0,a=r-n-s,o=(e==null?void 0:e.origination_percent)||0,l=(e==null?void 0:e.site_percent)||0,c=(e==null?void 0:e.deal_percent)||0,u=o/100*a,d=l/100*a,f=c/100*a,m=u+d+f,h=t.map(b=>{const p=(b==null?void 0:b.split_origination_percent)||0,_=(b==null?void 0:b.split_site_percent)||0,j=(b==null?void 0:b.split_deal_percent)||0,k=p/100*u,N=_/100*d,S=j/100*f,C=k+N+S;return{...b,calculatedOriginationUSD:k,calculatedSiteUSD:N,calculatedDealUSD:S,calculatedTotalUSD:C}}),y=h.reduce((b,p)=>b+(p.split_origination_percent||0),0),v=h.reduce((b,p)=>b+(p.split_site_percent||0),0),w=h.reduce((b,p)=>b+(p.split_deal_percent||0),0),g=h.reduce((b,p)=>b+p.calculatedTotalUSD,0);return{baseAmounts:{gci:r,referralFeeUsd:n,houseUsd:s,agci:a,originationPercent:o,sitePercent:l,dealPercent:c,originationUSD:u,siteUSD:d,dealUSD:f,totalDealUSD:m},brokerSplits:h,totals:{originationPercent:y,sitePercent:v,dealPercent:w,brokerUSD:g},validation:{isOriginationValid:y<=100,isSiteValid:v<=100,isDealValid:w<=100,areAllValid:y<=100&&v<=100&&w<=100}}},[e,t]),H$=({title:e,help:t,children:r})=>i.jsxs("section",{className:"bg-white rounded-md border p-4 mb-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:e}),t&&i.jsx("span",{className:"text-gray-500 text-xs border rounded-full w-4 h-4 inline-flex items-center justify-center",title:t,"aria-label":t,children:"i"})]}),r]}),q$=({deal:e,onFieldUpdate:t})=>{const{baseAmounts:r}=Qg(e),n=a=>a==null?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a),s=a=>a==null?"0.0%":`${a.toFixed(1)}%`;return i.jsx(H$,{title:"Commission Details",help:"Set commission percentages and amounts. Click any percentage to edit.",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Deal Fee"}),i.jsx("div",{className:"mt-1 p-2 bg-gray-100 rounded text-sm",children:n(e.fee)})]}),i.jsx(kn,{label:"Commission Rate %",value:e.commission_percent,onChange:a=>t("commission_percent",a)}),i.jsx(kn,{label:"Referral Fee %",value:e.referral_fee_percent,onChange:a=>t("referral_fee_percent",a)}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Referral Fee $"}),i.jsx("div",{className:"mt-1 p-2 bg-gray-100 rounded text-sm",children:n(e.referral_fee_usd)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Number of Payments"}),i.jsx("input",{type:"number",step:"1",min:"1",value:e.number_of_payments||1,onChange:a=>t("number_of_payments",parseInt(a.target.value)||1),className:"mt-1 block w-full rounded border-gray-300 shadow-sm cursor-pointer hover:bg-blue-50 px-3 py-2 transition-colors border border-transparent hover:border-blue-200 text-sm"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsx(Bk,{value:e.referral_payee_client_id,onChange:a=>t("referral_payee_client_id",a),label:"Referral Payee"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"GCI"}),i.jsx("div",{className:"mt-1 p-2 bg-gray-100 rounded text-sm",children:n(e.gci)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"AGCI"}),i.jsx("div",{className:"mt-1 p-2 bg-gray-100 rounded text-sm",children:n(e.agci)})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsx(kn,{label:"House %",value:e.house_percent,onChange:a=>t("house_percent",a)}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"House $"}),i.jsx("div",{className:"mt-1 p-2 bg-gray-100 rounded text-sm",children:n(e.house_usd)})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsx(kn,{label:"Origination %",value:e.origination_percent,onChange:a=>t("origination_percent",a)}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Origination $"}),i.jsx("div",{className:"mt-1 p-2 bg-gray-100 rounded text-sm",children:n(r.originationUSD)})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsx(kn,{label:"Site %",value:e.site_percent,onChange:a=>t("site_percent",a)}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Site $"}),i.jsx("div",{className:"mt-1 p-2 bg-gray-100 rounded text-sm",children:n(r.siteUSD)})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsx(kn,{label:"Deal %",value:e.deal_percent,onChange:a=>t("deal_percent",a)}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Deal $"}),i.jsx("div",{className:"mt-1 p-2 bg-gray-100 rounded text-sm",children:n(r.dealUSD)})]})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[i.jsx("h4",{className:"text-xs font-medium text-blue-800 mb-2",children:"Broker Split Summary (Origination + Site + Deal)"}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-xs",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-blue-700",children:"Origination:"})," ",s(e.origination_percent)]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-blue-700",children:"Site:"})," ",s(e.site_percent)]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-blue-700",children:"Deal:"})," ",s(e.deal_percent)]}),i.jsxs("div",{className:"font-semibold",children:[i.jsx("span",{className:"text-blue-700",children:"Total:"})," ",s((e.origination_percent||0)+(e.site_percent||0)+(e.deal_percent||0))]})]}),i.jsx("div",{className:"mt-2 text-xs text-blue-600",children:"House % is separate and not included in the 100% split validation."})]})]})})},Uk=({isOpen:e,onClose:t,onConfirm:r,title:n,itemName:s,message:a})=>e?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.962-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),i.jsx("div",{className:"ml-3",children:i.jsx("h3",{className:"text-lg font-medium text-gray-900",children:n})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("p",{className:"text-sm text-gray-600",children:["Are you sure you want to delete ",i.jsx("strong",{children:s}),"?"]}),a&&i.jsx("p",{className:"text-sm text-gray-600 mt-2",children:a})]}),i.jsxs("div",{className:"flex justify-end space-x-3",children:[i.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:"Cancel"}),i.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md transition-colors",children:"Delete"})]})]})}):null,bn=e=>e==null||isNaN(e)?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(e),em=({value:e,onChange:t,label:r})=>{const[n,s]=x.useState(!1),[a,o]=x.useState(""),l=e?`${e.toFixed(1)}%`:"0.0%",c=()=>{s(!0),o((e==null?void 0:e.toString())||"0")},u=()=>{const m=parseFloat(a);t(isNaN(m)?null:m),s(!1)},d=()=>{s(!1),o("")},f=m=>{m.key==="Enter"?u():m.key==="Escape"&&d()};return n?i.jsx("input",{type:"number",step:"0.1",value:a,onChange:m=>o(m.target.value),onBlur:u,onKeyDown:f,className:"w-16 px-1 py-0.5 text-sm border border-blue-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",autoFocus:!0}):i.jsx("span",{onClick:c,className:"cursor-pointer hover:bg-blue-50 px-1 py-0.5 rounded text-sm",title:`Click to edit ${r||"percentage"}`,children:l})},V$=({deal:e,onDealUpdate:t})=>{const[r,n]=x.useState([]),[s,a]=x.useState([]),[o,l]=x.useState(!0),[c,u]=x.useState(null),[d,f]=x.useState({isOpen:!1,splitId:"",brokerName:""}),{baseAmounts:m}=Qg(e,r),h=j=>{const k=s.find(N=>N.id===j);return k?k.name:"Unknown Broker"};x.useEffect(()=>{(async()=>{if(e.id)try{l(!0);const{data:k,error:N}=await $.from("commission_split").select("*").eq("deal_id",e.id).order("created_at");if(N)throw N;const{data:S,error:C}=await $.from("broker").select("*").order("name");if(C)throw C;n(k||[]),a(S||[])}catch(k){console.error("Error fetching commission data:",k),u("Failed to load commission splits")}finally{l(!1)}})()},[e.id]);const y=async(j,k,N)=>{console.log(" updateCommissionSplit called:",{splitId:j,field:k,value:N});try{const S=r.find(T=>T.id===j);if(!S)return;const C={...S};k==="split_origination_percent"?(C.split_origination_percent=N||0,C.split_origination_usd=(N||0)/100*m.originationUSD):k==="split_site_percent"?(C.split_site_percent=N||0,C.split_site_usd=(N||0)/100*m.siteUSD):k==="split_deal_percent"&&(C.split_deal_percent=N||0,C.split_deal_usd=(N||0)/100*m.dealUSD),C.split_broker_total=(C.split_origination_usd||0)+(C.split_site_usd||0)+(C.split_deal_usd||0);const{error:E}=await $.from("commission_split").update({split_origination_percent:C.split_origination_percent,split_origination_usd:C.split_origination_usd,split_site_percent:C.split_site_percent,split_site_usd:C.split_site_usd,split_deal_percent:C.split_deal_percent,split_deal_usd:C.split_deal_usd,split_broker_total:C.split_broker_total}).eq("id",j);if(E)throw E;n(T=>T.map(L=>L.id===j?C:L)),console.log(" Commission split updated successfully")}catch(S){console.error("Error updating commission split:",S),u("Failed to update commission split")}},v=async j=>{if(e.id)try{if(!s.find(E=>E.id===j))return;const N={deal_id:e.id,broker_id:j,split_origination_percent:0,split_origination_usd:0,split_site_percent:0,split_site_usd:0,split_deal_percent:0,split_deal_usd:0,split_broker_total:0},{data:S,error:C}=await $.from("commission_split").insert(N).select("*").single();if(C)throw C;n([...r,S])}catch(k){console.error("Error adding broker split:",k),u("Failed to add broker split")}},w=async j=>{try{const{error:k}=await $.from("commission_split").delete().eq("id",j);if(k){if(k.code==="23503"&&k.message.includes("payment_split")){u("Cannot delete this broker split because it has related payments. You must delete the payments first, or contact support to safely remove this split.");return}throw k}n(N=>N.filter(S=>S.id!==j)),u(null),f({isOpen:!1,splitId:"",brokerName:""})}catch(k){console.error("Error deleting broker split:",k),u("Failed to delete broker split: "+(k instanceof Error?k.message:"Unknown error")),f({isOpen:!1,splitId:"",brokerName:""})}},g=(j,k)=>{f({isOpen:!0,splitId:j,brokerName:k})},b=()=>{w(d.splitId)},p=()=>{f({isOpen:!1,splitId:"",brokerName:""})},_=s.filter(j=>!r.some(k=>k.broker_id===j.id));return o?i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Broker Commission Splits"}),i.jsx("div",{className:"text-gray-500",children:"Loading..."})]}):i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Broker Commission Splits"}),_.length>0&&i.jsxs("select",{className:"border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",onChange:j=>{j.target.value&&(v(j.target.value),j.target.value="")},defaultValue:"",children:[i.jsx("option",{value:"",children:"+ Add Broker"}),_.map(j=>i.jsx("option",{value:j.id,children:j.name},j.id))]})]}),c&&i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3 mb-4",children:i.jsx("p",{className:"text-red-600 text-sm",children:c})}),r.length===0?i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx("p",{children:"No broker splits configured for this deal."}),_.length>0&&i.jsx("p",{className:"text-sm mt-2",children:"Use the dropdown above to add brokers."})]}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"border-b border-gray-200",children:[i.jsx("th",{className:"text-left py-3 px-3 text-xs font-medium text-gray-500 uppercase tracking-wider w-48",children:"Broker"}),i.jsx("th",{className:"text-center py-3 px-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Origination %"}),i.jsx("th",{className:"text-right py-3 px-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Origination $"}),i.jsx("th",{className:"text-center py-3 px-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Site %"}),i.jsx("th",{className:"text-right py-3 px-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Site $"}),i.jsx("th",{className:"text-center py-3 px-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Deal %"}),i.jsx("th",{className:"text-right py-3 px-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Deal $"}),i.jsx("th",{className:"text-right py-3 px-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total $"}),i.jsx("th",{className:"w-16 text-center py-3 px-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{children:r.map(j=>i.jsxs("tr",{className:"border-b border-gray-100",children:[i.jsx("td",{className:"py-3 px-3 w-48 whitespace-nowrap",children:i.jsx("div",{className:"text-xs text-gray-900 font-medium",children:h(j.broker_id)})}),i.jsx("td",{className:"py-3 px-3 text-center",children:i.jsx(em,{value:j.split_origination_percent,onChange:k=>y(j.id,"split_origination_percent",k),label:"Origination %"})}),i.jsx("td",{className:"py-3 px-3 text-right text-sm text-gray-900",children:bn((j.split_origination_percent||0)/100*m.originationUSD)}),i.jsx("td",{className:"py-3 px-3 text-center",children:i.jsx(em,{value:j.split_site_percent,onChange:k=>y(j.id,"split_site_percent",k),label:"Site %"})}),i.jsx("td",{className:"py-3 px-3 text-right text-sm text-gray-900",children:bn((j.split_site_percent||0)/100*m.siteUSD)}),i.jsx("td",{className:"py-3 px-3 text-center",children:i.jsx(em,{value:j.split_deal_percent,onChange:k=>y(j.id,"split_deal_percent",k),label:"Deal %"})}),i.jsx("td",{className:"py-3 px-3 text-right text-sm text-gray-900",children:bn((j.split_deal_percent||0)/100*m.dealUSD)}),i.jsx("td",{className:"py-3 px-3 text-right text-sm font-medium text-gray-900",children:bn((j.split_origination_percent||0)/100*m.originationUSD+(j.split_site_percent||0)/100*m.siteUSD+(j.split_deal_percent||0)/100*m.dealUSD)}),i.jsx("td",{className:"py-3 px-3 text-center",children:i.jsx("button",{onClick:()=>g(j.id,h(j.broker_id)),className:"text-red-500 hover:text-red-700 font-bold text-lg",title:"Delete broker split",children:""})})]},j.id))}),i.jsx("tfoot",{children:i.jsxs("tr",{className:"border-t-2 border-gray-300 font-semibold bg-gray-50",children:[i.jsx("td",{className:"py-3 px-3 text-sm text-gray-900",children:"TOTALS"}),i.jsx("td",{className:"py-3 px-3 text-center",children:(()=>{const j=r.reduce((N,S)=>N+(Number(S.split_origination_percent)||0),0),k=Math.abs(j-100)<.1;return i.jsxs("span",{className:`text-sm ${k?"text-blue-600":"text-red-600"}`,children:[j.toFixed(1),"%"]})})()}),i.jsx("td",{className:"py-3 px-3 text-right text-sm text-blue-600",children:bn(r.reduce((j,k)=>j+(k.split_origination_percent||0)/100*m.originationUSD,0))}),i.jsx("td",{className:"py-3 px-3 text-center",children:(()=>{const j=r.reduce((N,S)=>N+(Number(S.split_site_percent)||0),0),k=Math.abs(j-100)<.1;return i.jsxs("span",{className:`text-sm ${k?"text-blue-600":"text-red-600"}`,children:[j.toFixed(1),"%"]})})()}),i.jsx("td",{className:"py-3 px-3 text-right text-sm text-blue-600",children:bn(r.reduce((j,k)=>j+(k.split_site_percent||0)/100*m.siteUSD,0))}),i.jsx("td",{className:"py-3 px-3 text-center",children:(()=>{const j=r.reduce((N,S)=>N+(Number(S.split_deal_percent)||0),0),k=Math.abs(j-100)<.1;return i.jsxs("span",{className:`text-sm ${k?"text-blue-600":"text-red-600"}`,children:[j.toFixed(1),"%"]})})()}),i.jsx("td",{className:"py-3 px-3 text-right text-sm text-blue-600",children:bn(r.reduce((j,k)=>j+(k.split_deal_percent||0)/100*m.dealUSD,0))}),i.jsx("td",{className:"py-3 px-3 text-right text-sm font-semibold text-blue-600",children:bn(r.reduce((j,k)=>{const N=(k.split_origination_percent||0)/100*m.originationUSD,S=(k.split_site_percent||0)/100*m.siteUSD,C=(k.split_deal_percent||0)/100*m.dealUSD;return j+N+S+C},0))}),i.jsx("td",{className:"py-3 px-3"})]})})]})}),i.jsxs("div",{className:"mt-4 text-sm text-gray-600 space-y-1",children:[i.jsxs("p",{children:[" Split percentages are applied to AGCI: ",bn(Number(e.agci||0))]}),i.jsx("p",{children:" These splits serve as templates for payment generation"}),i.jsx("p",{children:" Click on percentage values to edit them directly"})]}),i.jsx(Uk,{isOpen:d.isOpen,onClose:p,onConfirm:b,title:"Delete Broker Split",itemName:d.brokerName,message:"This action cannot be undone. If this broker has related payments, the deletion will be blocked."})]})},jb=({title:e,help:t,children:r})=>i.jsxs("section",{className:"bg-white rounded-md border p-4 mb-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:e}),t&&i.jsx("span",{className:"text-gray-500 text-xs border rounded-full w-4 h-4 inline-flex items-center justify-center",title:t,"aria-label":t,children:"i"})]}),r]}),kb=new Map,Y$=5*60*1e3,G$=({dealId:e,deal:t,onDealUpdate:r,onSwitchToPayments:n})=>{const[s,a]=x.useState(t),[o,l]=x.useState([]),[c,u]=x.useState([]),[d,f]=x.useState([]),[m,h]=x.useState(!0),[y,v]=x.useState(null),w=x.useCallback(N=>{if(!N)return[];const S=[],C=Number(N.origination_percent)||0,E=Number(N.site_percent)||0,T=Number(N.deal_percent)||0,L=Number(N.commission_percent)||0,O=Number(N.referral_fee_percent)||0,A=C+E+T;return A>100&&S.push(`Broker split percentages total ${A.toFixed(1)}% (over 100%)`),L>50&&S.push(`Commission rate ${L.toFixed(1)}% seems high`),O>100&&S.push(`Referral fee ${O.toFixed(1)}% cannot exceed 100%`),S},[]),g=x.useMemo(()=>d.length>0,[d.length]),b=x.useMemo(()=>w(s||t),[s,t,w]);x.useEffect(()=>{a(t)},[t]);const p=x.useCallback(async()=>{const N=kb.get(e),S=Date.now();if(N&&S-N.timestamp<Y$){console.log("Using cached commission data for deal:",e),l(N.splits),u(N.brokers),f(N.payments),h(!1);return}try{h(!0);const[C,E]=await Promise.all([$.from("commission_split").select("*").eq("deal_id",e),$.from("broker").select("id, name")]);if(C.error)throw C.error;if(E.error)throw E.error;const T=C.data||[],L=E.data||[];u(L);const O=T.map(F=>{const R=L.find(P=>P.id===F.broker_id);return{...F,broker_name:R?R.name:"Unknown Broker"}});l(O);const{data:A,error:M}=await $.from("payment").select("id, payment_sequence, payment_amount, payment_date_estimated, sf_payment_date_actual, deal_id").eq("deal_id",e);if(M)throw M;console.log("CommissionTab fetchCommissionData - payments found:",{dealId:e,paymentsCount:(A==null?void 0:A.length)||0,payments:(A==null?void 0:A.map(F=>({id:F.id,sequence:F.payment_sequence,amount:F.payment_amount,estimated_date:F.payment_date_estimated,actual_date:F.sf_payment_date_actual})))||[]}),f(A||[]);const B={splits:O,brokers:L,payments:A||[],timestamp:Date.now()};kb.set(e,B)}catch(C){const E=C instanceof Error?C.message:"An error occurred";v(E)}finally{h(!1)}},[e]);x.useEffect(()=>{p()},[p]);const _=N=>{const S=N.deal_value||0,C=N.commission_percent||0,E=N.referral_fee_percent||0,T=N.flat_fee_override??S*(C/100),L=T*(E/100),O=T-L,A=O*((N.house_percent||0)/100),M=O-A,B=M*((N.origination_percent||0)/100),F=M*((N.site_percent||0)/100),R=M*((N.deal_percent||0)/100);return{...N,fee:Math.round(T*100)/100,gci:Math.round(O*100)/100,referral_fee_usd:Math.round(L*100)/100,agci:Math.round(M*100)/100,house_usd:Math.round(A*100)/100,origination_usd:Math.round(B*100)/100,site_usd:Math.round(F*100)/100,deal_usd:Math.round(R*100)/100}},j=x.useCallback(async(N,S)=>{if(!s)return;const C={...s,[N]:S},E=["commission_percent","referral_fee_percent","house_percent","origination_percent","site_percent","deal_percent"];let T=C;E.includes(N)&&(T=_(C));const L={commission_percent:T.commission_percent,referral_fee_percent:T.referral_fee_percent,house_percent:T.house_percent,origination_percent:T.origination_percent,site_percent:T.site_percent,deal_percent:T.deal_percent,number_of_payments:T.number_of_payments,fee:T.fee,updated_at:new Date().toISOString()};T.gci!==void 0&&(L.gci=T.gci),T.referral_fee_usd!==void 0&&(L.referral_fee_usd=T.referral_fee_usd),T.agci!==void 0&&(L.agci=T.agci),T.house_usd!==void 0&&(L.house_usd=T.house_usd),T.origination_usd!==void 0&&(L.origination_usd=T.origination_usd),T.site_usd!==void 0&&(L.site_usd=T.site_usd),T.deal_usd!==void 0&&(L.deal_usd=T.deal_usd),N==="referral_payee_client_id"&&T.referral_payee_client_id!==void 0&&(L.referral_payee_client_id=T.referral_payee_client_id);try{console.log("Updating field:",N,"with value:",S),console.log("Update payload:",L);const{data:O,error:A}=await $.from("deal").update(L).eq("id",e).select().single();if(A)throw console.error("Supabase error:",A),A;console.log("Update successful:",O),a(O),r(O)}catch(O){const A=O instanceof Error?O.message:"Failed to save";console.error("Error saving:",O),alert(`Error saving: ${A}`)}},[s,e,r]),k=N=>N==null?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(N);return m?i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsx("div",{className:"text-sm text-gray-600",children:"Loading commission data..."})}):y?i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[i.jsx("h3",{className:"text-sm font-semibold text-red-800 mb-2",children:"Error Loading Commission Data"}),i.jsx("p",{className:"text-sm text-red-600",children:y}),i.jsx("button",{onClick:p,className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 text-sm",children:"Try Again"})]}):s?i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[i.jsx("h3",{className:"text-xs font-medium text-blue-800 mb-1",children:"Deal Fee"}),i.jsx("p",{className:"text-lg font-bold text-blue-900",children:k(s.fee)})]}),i.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[i.jsx("h3",{className:"text-xs font-medium text-purple-800 mb-1",children:"Number of Payments"}),i.jsx("p",{className:"text-lg font-bold text-purple-900",children:s.number_of_payments})]}),i.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[i.jsx("h3",{className:"text-xs font-medium text-orange-800 mb-1",children:"Commission Rate"}),i.jsx("p",{className:"text-lg font-bold text-orange-900",children:s.commission_percent?`${s.commission_percent.toFixed(1)}%`:"0%"})]})]}),b.length>0&&i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Validation Warnings"}),i.jsx("ul",{className:"mt-1 text-xs text-yellow-700 list-disc list-inside",children:b.map((N,S)=>i.jsx("li",{children:N},S))})]})]})}),g&&i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Payments Already Generated"}),i.jsxs("p",{className:"mt-1 text-xs text-yellow-700",children:["This deal already has ",d.length," payment",d.length!==1?"s":""," generated. To regenerate payments, you would need to delete the existing ones first."]})]})]})}),o.length===0&&i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"No Commission Splits Found"}),i.jsx("p",{className:"mt-1 text-xs text-blue-700",children:"Commission splits are imported from Salesforce. If this deal should have commission data, check that it exists in Salesforce and run the migration again."})]})]})}),i.jsx(q$,{deal:s,onFieldUpdate:j}),i.jsx(V$,{deal:s,onDealUpdate:r}),i.jsxs(jb,{title:"Payment Management",help:"Manage payments based on commission splits",children:[i.jsx("div",{className:"flex justify-end mb-3",children:i.jsx("button",{onClick:n,className:"px-4 py-2 rounded font-medium text-sm bg-blue-600 text-white hover:bg-blue-700",children:"Go to Payments Tab"})}),o.length===0&&i.jsx("div",{className:"text-center text-gray-500 py-4",children:i.jsx("p",{className:"text-sm",children:"No commission splits available. Commission splits are needed for payment generation."})})]}),o.length>0&&i.jsx(jb,{title:"Quick Summary",help:"Overview of commission allocation",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:[i.jsx("h4",{className:"text-xs font-medium text-green-800 mb-1",children:"Total Commission Splits"}),i.jsx("p",{className:"text-lg font-bold text-green-900",children:o.length})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[i.jsx("h4",{className:"text-xs font-medium text-blue-800 mb-1",children:"Total Broker Amount"}),i.jsx("p",{className:"text-lg font-bold text-blue-900",children:k(o.reduce((N,S)=>N+(S.split_broker_total||0),0))})]}),i.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-3",children:[i.jsx("h4",{className:"text-xs font-medium text-purple-800 mb-1",children:"Payments Status"}),i.jsx("p",{className:"text-lg font-bold text-purple-900",children:g?`${d.length} Generated`:"Not Generated"})]}),i.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-3",children:[i.jsx("h4",{className:"text-xs font-medium text-orange-800 mb-1",children:"Per Payment Amount"}),i.jsx("p",{className:"text-lg font-bold text-orange-900",children:s.number_of_payments&&s.fee?k(s.fee/s.number_of_payments):"$0.00"})]})]})})]}):i.jsx("div",{className:"text-center text-gray-600 py-8",children:i.jsx("p",{className:"text-sm",children:"Deal not found"})})},zk=(e,t=[],r=[])=>{const n=x.useMemo(()=>{const c=e.fee||0,u=e.number_of_payments||1,d=u>0?c/u:0,f=d*u;return{calculatedPaymentAmount:d,totalCalculatedPayments:f}},[e.fee,e.number_of_payments]),s=x.useMemo(()=>{const c=n.calculatedPaymentAmount,u=e.referral_fee_usd||0,d=e.number_of_payments||1,f=u/d,h=(e.house_usd||0)/d,y=c-f-h,v=e.origination_percent||0,w=e.site_percent||0,g=e.deal_percent||0,b=v/100*y,p=w/100*y,_=g/100*y;return{gci:c,referral_fee_usd:f,house_usd:h,agci:y,origination_percent:v,origination_usd:b,site_percent:w,site_usd:p,deal_percent:g,deal_usd:_}},[n.calculatedPaymentAmount,e.fee,e.referral_fee_usd,e.house_usd,e.number_of_payments,e.origination_percent,e.site_percent,e.deal_percent]),a=x.useMemo(()=>c=>c.map(u=>{const d=(u.split_origination_percent||0)/100*s.origination_usd,f=(u.split_site_percent||0)/100*s.site_usd,m=(u.split_deal_percent||0)/100*s.deal_usd,h=d+f+m;return{broker_id:u.broker_id||"",origination_amount:d,site_amount:f,deal_amount:m,total_amount:h}}),[s]),o=x.useMemo(()=>{const c=[];let u=!0;return(!e.fee||e.fee<=0)&&(c.push("Commission fee is not set"),u=!1),(!e.number_of_payments||e.number_of_payments<1)&&(c.push("Number of payments must be at least 1"),u=!1),e.number_of_payments&&e.number_of_payments>10&&(c.push("Number of payments cannot exceed 10"),u=!1),(e.origination_percent||0)+(e.site_percent||0)+(e.deal_percent||0)===0&&c.push("Commission split percentages are not configured"),{canGeneratePayments:u,validationMessages:c}},[e.fee,e.number_of_payments,e.origination_percent,e.site_percent,e.deal_percent]),l=x.useMemo(()=>t.map(c=>({payment_id:c.payment_id,calculated_amount:n.calculatedPaymentAmount,database_amount:c.payment_amount||0,needs_update:Math.abs((c.payment_amount||0)-n.calculatedPaymentAmount)>.01})),[t,n.calculatedPaymentAmount]);return{calculatedPaymentAmount:n.calculatedPaymentAmount,totalCalculatedPayments:n.totalCalculatedPayments,paymentCommissionBreakdown:s,calculateBrokerSplitsForPayment:a,canGeneratePayments:o.canGeneratePayments,validationMessages:o.validationMessages,paymentComparisons:l}},K$=({deal:e,hasPayments:t,existingPayments:r=[],commissionSplits:n=[],onGeneratePayments:s,onUpdatePaymentAmounts:a,generatingPayments:o})=>{const{calculatedPaymentAmount:l,totalCalculatedPayments:c,paymentCommissionBreakdown:u,canGeneratePayments:d,validationMessages:f,paymentComparisons:m}=zk(e,r,n),h=e.number_of_payments||1,y=g=>g.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),v=m.some(g=>g.needs_update);r.length<h;const w=r.length===h;return i.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Payment Generation"}),t&&i.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[r.length," of ",h," Payments Created"]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"font-medium text-gray-900",children:"Payment Actions"}),i.jsxs("div",{className:"space-y-3",children:[w?i.jsxs("div",{className:"text-sm text-green-600 bg-green-50 border border-green-200 rounded-md p-3",children:[i.jsx("div",{className:"font-medium mb-1",children:" All Payments Created"}),i.jsxs("div",{children:["All ",h," payments have been created for this deal."]})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:s,disabled:!d||o,className:`w-full px-4 py-3 rounded-md font-medium transition-colors ${d&&!o?"bg-blue-600 text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:o?i.jsxs("div",{className:"flex items-center justify-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),t?"Creating Additional Payments...":"Generating Payments..."]}):t?`Create Remaining ${h-r.length} Payments`:`Generate ${h} Payment${h>1?"s":""}`}),t&&i.jsxs("div",{className:"text-sm text-blue-600 bg-blue-50 border border-blue-200 rounded-md p-3",children:[i.jsx("div",{className:"font-medium mb-1",children:" Safe Generation"}),i.jsx("div",{children:"This will create the remaining payments without affecting existing payment records or their associated invoice data."})]})]}),t&&v&&a&&i.jsx("button",{onClick:a,disabled:o,className:"w-full px-4 py-2 border border-amber-300 bg-amber-50 text-amber-700 rounded-md font-medium hover:bg-amber-100 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:"Update Payment Amounts"}),!d&&i.jsxs("div",{className:"text-sm text-gray-600 bg-gray-50 border border-gray-200 rounded-md p-3",children:[i.jsx("div",{className:"font-medium mb-1",children:"Configuration Required"}),i.jsx("div",{children:"Complete commission configuration in the Commission tab before generating payments."})]})]}),d&&h>1||t&&m.length>0?i.jsxs("div",{className:"mt-4 grid grid-cols-1 lg:grid-cols-2 gap-4",children:[d&&h>1&&i.jsxs("div",{className:"p-3 bg-green-50 border border-green-200 rounded-md",children:[i.jsx("div",{className:"text-sm font-medium text-green-800 mb-2",children:"Payment Schedule Preview"}),i.jsxs("div",{className:"text-sm text-green-700 space-y-1",children:[Array.from({length:h},(g,b)=>{const p=r.find(_=>_.payment_sequence===b+1);return i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("span",{children:["Payment ",b+1,":"]}),i.jsxs("div",{className:"text-right",children:[i.jsxs("div",{className:`font-medium ${p?"text-green-600":""}`,children:["$",y(l),p&&" "]}),i.jsxs("div",{className:"text-xs text-green-600 opacity-75",children:["AGCI: $",y(u.agci)]})]})]},b)}),i.jsxs("div",{className:"flex justify-between border-t pt-1 font-semibold",children:[i.jsx("span",{children:"Total:"}),i.jsxs("div",{className:"text-right",children:[i.jsxs("div",{children:["$",y(c)]}),i.jsxs("div",{className:"text-xs text-green-600 opacity-75 font-normal",children:["Total AGCI: $",y(u.agci*h)]})]})]})]})]}),t&&m.length>0&&i.jsxs("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded-md",children:[i.jsx("div",{className:"text-sm font-medium text-gray-800 mb-2",children:"Current vs Calculated"}),i.jsx("div",{className:"text-sm text-gray-700 space-y-1",children:m.map((g,b)=>i.jsxs("div",{className:"flex justify-between",children:[i.jsxs("span",{children:["Payment ",b+1,":"]}),i.jsxs("span",{className:g.needs_update?"text-amber-700 font-medium":"text-gray-600",children:["$",y(g.database_amount),"  $",y(g.calculated_amount),g.needs_update&&" "]})]},b))})]})]}):null]})]})};function Q$({title:e,titleId:t,...r},n){return x.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?x.createElement("title",{id:t},e):null,x.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"}))}const J$=x.forwardRef(Q$),X$=J$;function Z$({title:e,titleId:t,...r},n){return x.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?x.createElement("title",{id:t},e):null,x.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 15 3 9m0 0 6-6M3 9h12a6 6 0 0 1 0 12h-3"}))}const e6=x.forwardRef(Z$),Nb=e6;function t6({title:e,titleId:t,...r},n){return x.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?x.createElement("title",{id:t},e):null,x.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"}))}const r6=x.forwardRef(t6),bo=r6;function n6({title:e,titleId:t,...r},n){return x.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?x.createElement("title",{id:t},e):null,x.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const s6=x.forwardRef(n6),ml=s6;function a6({title:e,titleId:t,...r},n){return x.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?x.createElement("title",{id:t},e):null,x.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))}const i6=x.forwardRef(a6),o6=i6;function l6({title:e,titleId:t,...r},n){return x.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?x.createElement("title",{id:t},e):null,x.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))}const c6=x.forwardRef(l6),Od=c6;function u6({title:e,titleId:t,...r},n){return x.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?x.createElement("title",{id:t},e):null,x.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"}))}const d6=x.forwardRef(u6),Jg=d6;function f6({title:e,titleId:t,...r},n){return x.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?x.createElement("title",{id:t},e):null,x.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 15.75 7.5-7.5 7.5 7.5"}))}const m6=x.forwardRef(f6),h6=m6;function p6({title:e,titleId:t,...r},n){return x.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?x.createElement("title",{id:t},e):null,x.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const g6=x.forwardRef(p6),qu=g6;function x6({title:e,titleId:t,...r},n){return x.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?x.createElement("title",{id:t},e):null,x.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const y6=x.forwardRef(x6),b6=y6;function v6({title:e,titleId:t,...r},n){return x.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?x.createElement("title",{id:t},e):null,x.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"}))}const w6=x.forwardRef(v6),Ad=w6;function _6({title:e,titleId:t,...r},n){return x.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?x.createElement("title",{id:t},e):null,x.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const j6=x.forwardRef(_6),k6=j6;function N6({title:e,titleId:t,...r},n){return x.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?x.createElement("title",{id:t},e):null,x.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),x.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const S6=x.forwardRef(N6),C6=S6;function E6({title:e,titleId:t,...r},n){return x.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?x.createElement("title",{id:t},e):null,x.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"}))}const D6=x.forwardRef(E6),P6=D6;function T6({title:e,titleId:t,...r},n){return x.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?x.createElement("title",{id:t},e):null,x.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const L6=x.forwardRef(T6),Xg=L6;function I6({title:e,titleId:t,...r},n){return x.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?x.createElement("title",{id:t},e):null,x.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m18.375 12.739-7.693 7.693a4.5 4.5 0 0 1-6.364-6.364l10.94-10.94A3 3 0 1 1 19.5 7.372L8.552 18.32m.009-.01-.01.01m5.699-9.941-7.81 7.81a1.5 1.5 0 0 0 2.112 2.13"}))}const R6=x.forwardRef(I6),M6=R6;function O6({title:e,titleId:t,...r},n){return x.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?x.createElement("title",{id:t},e):null,x.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))}const A6=x.forwardRef(O6),$6=A6;function F6({title:e,titleId:t,...r},n){return x.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?x.createElement("title",{id:t},e):null,x.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 0 0 2.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 0 1-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 0 0-1.091-.852H4.5A2.25 2.25 0 0 0 2.25 4.5v2.25Z"}))}const B6=x.forwardRef(F6),ca=B6;function U6({title:e,titleId:t,...r},n){return x.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?x.createElement("title",{id:t},e):null,x.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const z6=x.forwardRef(U6),Sb=z6;function W6({title:e,titleId:t,...r},n){return x.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?x.createElement("title",{id:t},e):null,x.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"}))}const H6=x.forwardRef(W6),Vu=H6;function q6({title:e,titleId:t,...r},n){return x.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?x.createElement("title",{id:t},e):null,x.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const V6=x.forwardRef(q6),Wk=V6,Hk=e=>{if(!e)return"Unknown";const[t,r,n]=e.split("-").map(Number);return new Date(t,r-1,n).toLocaleDateString()},Ls=(e,t="Not set")=>e?Hk(e):t,Y6=e=>e||"",G6=({payment:e,totalPayments:t,isExpanded:r,onToggleExpansion:n,onUpdatePayment:s,onDeletePayment:a})=>(console.log(" PaymentSummaryRow payment dates:",{id:e.id,payment_sequence:e.payment_sequence,payment_date_estimated:e.payment_date_estimated,payment_received_date:e.payment_received_date}),i.jsxs("div",{className:"p-4 grid grid-cols-12 items-center gap-4",children:[i.jsxs("div",{className:"col-span-3 flex items-center space-x-3",children:[i.jsx("button",{onClick:n,className:"p-1 hover:bg-gray-200 rounded flex-shrink-0",children:r?i.jsx(Od,{className:"h-4 w-4 text-gray-500"}):i.jsx(Jg,{className:"h-4 w-4 text-gray-500"})}),i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsxs("div",{className:"text-sm font-medium text-gray-900 truncate",children:["Payment ",e.payment_sequence," of ",t]}),i.jsxs("div",{className:"text-xs text-gray-500",children:["$",(e.payment_amount||0).toLocaleString("en-US",{minimumFractionDigits:2})]})]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Invoice #"}),i.jsx("div",{className:"text-sm text-gray-900",children:e.orep_invoice||"-"})]}),i.jsxs("div",{className:"col-span-2 flex items-center space-x-2",children:[i.jsx("input",{type:"checkbox",checked:e.payment_received||!1,onChange:o=>s({payment_received:o.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded flex-shrink-0"}),i.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${e.payment_received?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:e.payment_received?"Received":"Pending"})]}),i.jsx("div",{className:"col-span-3",children:e.payment_received?i.jsx("div",{className:"w-full px-2 py-1 text-sm",children:i.jsxs("div",{className:"font-medium text-green-800",children:["Paid Date: ",Hk(e.payment_received_date)]})}):i.jsxs("div",{children:[e.payment_date_estimated&&i.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Estimated Pmt Date"}),i.jsx("input",{type:"date",value:e.payment_date_estimated||"",onChange:o=>s({payment_date_estimated:o.target.value}),className:"w-full border border-gray-300 rounded-md px-2 py-1 text-sm",placeholder:"Estimated payment date"}),!e.payment_date_estimated&&i.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Set estimated payment date"})]})}),i.jsx("div",{className:"col-span-2 text-right",children:i.jsx("button",{onClick:a,className:"text-red-600 hover:text-red-900 text-sm whitespace-nowrap",children:"Delete"})})]})),K6=({split:e,brokerName:t,paymentAmount:r,onPercentageChange:n,validationTotals:s})=>i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[i.jsxs("div",{className:"flex justify-between items-start mb-4",children:[i.jsx("div",{children:i.jsx("h5",{className:"text-sm font-medium text-gray-900",children:t})}),i.jsx("div",{className:"text-right",children:i.jsxs("div",{className:"text-sm font-semibold text-gray-900",children:["$",(e.split_broker_total||0).toLocaleString("en-US",{minimumFractionDigits:2})]})})]}),i.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[i.jsxs("div",{className:"bg-white rounded-md p-2 border border-gray-200",children:[i.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Origination"}),i.jsx(kn,{label:"",value:e.split_origination_percent||0,onChange:a=>n("split_origination_percent",a)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["$",(e.split_origination_usd||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),i.jsxs("div",{className:"bg-white rounded-md p-2 border border-gray-200",children:[i.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Site"}),i.jsx(kn,{label:"",value:e.split_site_percent||0,onChange:a=>n("split_site_percent",a)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["$",(e.split_site_usd||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),i.jsxs("div",{className:"bg-white rounded-md p-2 border border-gray-200",children:[i.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Deal"}),i.jsx(kn,{label:"",value:e.split_deal_percent||0,onChange:a=>n("split_deal_percent",a)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["$",(e.split_deal_usd||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),i.jsxs("div",{className:"bg-white rounded-md p-2 border border-gray-200",children:[i.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Total"}),i.jsxs("div",{className:`text-sm font-semibold ${s&&!s.isValid?"text-red-600":"text-blue-600"}`,children:["$",(e.split_broker_total||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]}),s&&!s.isValid&&i.jsx("div",{className:"text-xs text-red-500 mt-1",children:"Check totals"})]})]})]}),Ba=e=>e==null||isNaN(e)?"$0.00":`$${e.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`,Cb=({payeeName:e,amount:t,paid:r,onTogglePaid:n,disabled:s=!1})=>{const a=()=>{s||n(!r)};return i.jsxs("div",{className:`
        flex items-center justify-between p-4 rounded-lg border-2 transition-all duration-200 cursor-pointer
        ${r?"bg-green-50 border-green-200 hover:border-green-300":"bg-white border-gray-200 hover:border-gray-300"}
        ${s?"opacity-50 cursor-not-allowed":"hover:shadow-sm"}
      `,onClick:a,role:"button",tabIndex:0,onKeyDown:o=>{(o.key==="Enter"||o.key===" ")&&!s&&(o.preventDefault(),a())},"aria-label":`${r?"Mark as unpaid":"Mark as paid"} - ${e} - ${Ba(t)}`,children:[i.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[i.jsx("div",{className:`
          flex-shrink-0 w-6 h-6 rounded-md border-2 flex items-center justify-center transition-all duration-200
          ${r?"bg-green-500 border-green-500":"bg-white border-gray-300 hover:border-green-400"}
        `,children:r&&i.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:`
            text-sm font-medium truncate transition-colors duration-200
            ${r?"text-green-900":"text-gray-900"}
          `,children:e}),i.jsx("p",{className:`
            text-xs transition-colors duration-200
            ${r?"text-green-700":"text-gray-500"}
          `,children:r?"Check written":"Pending payment"})]})]}),i.jsxs("div",{className:"flex-shrink-0 text-right",children:[i.jsx("p",{className:`
          text-lg font-semibold transition-colors duration-200
          ${r?"text-green-900":"text-gray-900"}
        `,children:Ba(t)}),r&&i.jsxs("div",{className:"flex items-center justify-end mt-1",children:[i.jsx("svg",{className:"w-3 h-3 text-green-600 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),i.jsx("span",{className:"text-xs text-green-600 font-medium",children:"Paid"})]})]})]})},Q6=({isOpen:e,onClose:t,payment:r,deal:n,clients:s,brokers:a,paymentSplits:o,onUpdateReferralPaid:l,onUpdatePaymentSplitPaid:c})=>{const[u,d]=x.useState([]),[f,m]=x.useState(!1);x.useEffect(()=>{if(e){const p=[];if(n.referral_payee_client_id&&n.referral_fee_usd&&n.referral_fee_usd>0){const _=s.find(S=>S.id===n.referral_payee_client_id),j=n.fee||n.deal_usd||0,k=r.payment_amount||0,N=j>0?n.referral_fee_usd*(k/j):0;N>0&&p.push({id:`referral-${r.id}`,type:"referral",payeeName:(_==null?void 0:_.client_name)||"Unknown Referral Client",amount:N,paid:r.referral_fee_paid||!1})}console.log(" Payment splits for disbursement modal:",o),o.forEach(_=>{const j=a.find(N=>N.id===_.broker_id),k=_.paid||!1;console.log(" Processing split:",{paymentSplitId:_.id,brokerName:j==null?void 0:j.name,brokerPaid:k,amount:_.split_broker_total}),_.split_broker_total&&_.split_broker_total>0&&p.push({id:_.id,type:"broker",payeeName:(j==null?void 0:j.name)||"Unknown Broker",amount:_.split_broker_total,paid:k})}),d(p)}},[e,r,n,s,a,o]);const h=async(p,_)=>{m(!0);try{p.type==="referral"?await l(r.id,_):await c(p.id,_),d(j=>j.map(k=>k.id===p.id?{...k,paid:_}:k))}catch(j){console.error("Error updating disbursement status:",j)}finally{m(!1)}},y=r.payment_amount||0,v=u.reduce((p,_)=>p+(_.paid?_.amount:0),0),w=y-v,g=u.filter(p=>p.paid).length,b=u.length;return e?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full mx-4 max-h-[90vh] overflow-hidden flex flex-col",children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-green-500 to-green-600 rounded-lg flex items-center justify-center shadow-sm",children:i.jsx("span",{className:"text-white text-sm",children:""})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Payment Disbursement"}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Payment ",r.payment_sequence," - ",Ba(y)]})]})]}),i.jsx("button",{onClick:t,className:"w-8 h-8 flex items-center justify-center rounded-lg hover:bg-gray-100 transition-colors",disabled:f,children:i.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsxs("div",{className:"p-4 bg-gray-50 border-b border-gray-200",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Disbursement Progress: ",g," of ",b," checks written"]}),i.jsxs("span",{className:"text-sm text-gray-600",children:[Math.round(g/Math.max(b,1)*100),"% Complete"]})]}),i.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:i.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:`${g/Math.max(b,1)*100}%`}})})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:u.length===0?i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx("span",{className:"text-gray-400 text-2xl",children:""})}),i.jsx("p",{className:"text-gray-700 font-medium mb-2",children:"No Disbursements Required"}),i.jsx("p",{className:"text-sm text-gray-500",children:"This payment has no referral fees or broker commissions to disburse."})]}):i.jsxs("div",{className:"space-y-4",children:[u.some(p=>p.type==="referral")&&i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-medium text-gray-700 uppercase tracking-wide mb-3",children:"Referral Payments"}),i.jsx("div",{className:"space-y-2",children:u.filter(p=>p.type==="referral").map(p=>i.jsx(Cb,{payeeName:p.payeeName,amount:p.amount,paid:p.paid,onTogglePaid:_=>h(p,_),disabled:f},p.id))})]}),u.some(p=>p.type==="broker")&&i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-medium text-gray-700 uppercase tracking-wide mb-3",children:"Broker Commissions"}),i.jsx("div",{className:"space-y-2",children:u.filter(p=>p.type==="broker").map(p=>i.jsx(Cb,{payeeName:p.payeeName,amount:p.amount,paid:p.paid,onTogglePaid:_=>h(p,_),disabled:f},p.id))})]})]})}),u.length>0&&i.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:i.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Payment Received:"}),i.jsx("p",{className:"font-semibold text-gray-900",children:Ba(y)})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Disbursed:"}),i.jsx("p",{className:"font-semibold text-green-600",children:Ba(v)})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Remaining:"}),i.jsx("p",{className:`font-semibold ${w>=0?"text-gray-900":"text-red-600"}`,children:Ba(w)})]})]})})]})}):null},J6=({payment:e,deal:t,clients:r,brokers:n,paymentSplits:s,commissionSplits:a,onUpdatePayment:o,onUpdateReferralPaid:l,onUpdatePaymentSplitPaid:c})=>{const[u,d]=x.useState(!1),f=()=>{if(!t.referral_payee_client_id)return"No referral payee set";if(!r||r.length===0)return"Client data not available";const v=r.find(w=>w.id===t.referral_payee_client_id);return v?v.client_name||"Unknown Client":"Client not found"},m=()=>{if(!t.referral_fee_usd||t.referral_fee_usd===0)return 0;const v=t.fee||t.deal_usd||0,w=e.payment_amount||0;return v===0?0:t.referral_fee_usd*(w/v)},h=(v,w,g=!1)=>{const b=e[w];return i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:v}),g&&b&&i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:Ls(b)}),i.jsx("input",{type:"date",value:Y6(b),onChange:p=>o({[w]:p.target.value||null}),className:"w-full border border-gray-300 rounded-md px-2 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})},y=(v,w,g)=>{const b=e[w];return i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:v}),i.jsx("input",{type:"text",value:b||"",onChange:p=>o({[w]:p.target.value||null}),placeholder:g,className:"w-full border border-gray-300 rounded-md px-2 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})};return i.jsxs("div",{className:"border-t border-gray-200 bg-gray-50",children:[i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-4",children:"Payment Details"}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h5",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide mb-3",children:"Payment Dates & Tracking"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-4 md:gap-6",children:[h("Estimated Payment Date","payment_date_estimated"),h("Payment Received Date","payment_received_date"),h("Invoice Date","payment_invoice_date"),y("OREP Invoice","orep_invoice","Enter OREP Invoice number")]})]}),(t.referral_payee_client_id||t.referral_fee_usd||t.referral_fee_percent)&&i.jsxs("div",{className:"mb-6",children:[i.jsx("h5",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide mb-3",children:"Referral Information"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"Referral Payee"}),i.jsx("div",{className:"w-full px-3 py-2 text-sm bg-gray-100 border border-gray-200 rounded-md text-gray-600",children:f()})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"Referral Fee"}),i.jsx("div",{className:"w-full px-3 py-2 text-sm bg-gray-100 border border-gray-200 rounded-md text-gray-600",children:(()=>{const v=m(),w=t.referral_fee_usd||0;return v===0?"No referral fee for this payment":i.jsxs(i.Fragment,{children:["$",v.toLocaleString("en-US",{minimumFractionDigits:2}),i.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["($",w.toLocaleString("en-US",{minimumFractionDigits:2})," total)"]}),t.referral_fee_percent&&i.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(",t.referral_fee_percent,"%)"]})]})})()})]})]})]}),(e.sf_payment_date_est||e.sf_payment_date_actual||e.sf_payment_date_received||e.sf_payment_invoice_date)&&i.jsxs("div",{className:"mt-6",children:[i.jsx("h5",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide mb-3",children:"Salesforce Date Fields (Read-only)"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-xs",children:[e.sf_payment_date_est&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-600",children:"SF Est Date:"})," ",i.jsx("span",{className:"text-gray-500",children:Ls(e.sf_payment_date_est)})]}),e.sf_payment_date_actual&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-600",children:"SF Actual Date:"})," ",i.jsx("span",{className:"text-gray-500",children:Ls(e.sf_payment_date_actual)})]}),e.sf_payment_date_received&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-600",children:"SF Received Date:"})," ",i.jsx("span",{className:"text-gray-500",children:Ls(e.sf_payment_date_received)})]}),e.sf_payment_invoice_date&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-600",children:"SF Invoice Date:"})," ",i.jsx("span",{className:"text-gray-500",children:Ls(e.sf_payment_invoice_date)})]})]})]}),i.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-xs text-gray-500",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Payment Received:"})," ",e.payment_received?"Yes":"No",e.payment_received_date&&i.jsxs("span",{className:"ml-1",children:["(",Ls(e.payment_received_date),")"]})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"SF Payment Status:"})," ",e.sf_payment_status||"Not set"]}),e.qb_sync_status&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"QB Sync Status:"})," ",e.qb_sync_status]}),e.qb_last_sync&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Last QB Sync:"})," ",Ls(e.qb_last_sync)]})]})}),i.jsx("div",{className:"mt-6 p-4 border border-blue-200 rounded-lg bg-blue-50",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("input",{type:"checkbox",id:`payment-received-${e.id}`,checked:e.payment_received||!1,onChange:async v=>{const w=v.target.checked;await o({payment_received:w}),w&&(t.referral_fee_usd&&t.referral_fee_usd>0||s&&s.some(g=>(g.split_broker_total||0)>0))&&d(!0)},className:"h-5 w-5 text-blue-600 rounded border-2 border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:`payment-received-${e.id}`,className:"text-sm font-semibold text-blue-900 cursor-pointer",children:"Payment Received"}),i.jsx("p",{className:"text-xs text-blue-700",children:e.payment_received?"Payment has been received - manage disbursements below":"Check when payment is received to manage disbursements"})]})]}),e.payment_received&&i.jsx("button",{onClick:()=>d(!0),className:"px-3 py-1.5 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Manage Disbursements"})]})})]}),u&&i.jsx(Q6,{isOpen:u,onClose:()=>d(!1),payment:e,deal:t,clients:r||[],brokers:n||[],paymentSplits:s||[],onUpdateReferralPaid:l||(async()=>{}),onUpdatePaymentSplitPaid:c||(async()=>{})})]})},X6=e=>{const t={deal:0,site:0,origination:0,isValid:!0};return e.forEach(r=>{t.deal+=r.split_deal_percent||0,t.site+=r.split_site_percent||0,t.origination+=r.split_origination_percent||0}),t.isValid=t.deal===100&&t.site===100&&t.origination===100,t},Z6=(e,t,r,n)=>e.map(s=>{let a=s.split_origination_usd||0,o=s.split_site_usd||0,l=s.split_deal_usd||0,c=s.split_broker_total||0;if(r&&n){const u=r.number_of_payments||1,d=(r.referral_fee_usd||0)/u,f=(r.house_usd||0)/u,m=n-d-f,h=(r.origination_percent||0)/100*m,y=(r.site_percent||0)/100*m,v=(r.deal_percent||0)/100*m;a=h*(s.split_origination_percent||0)/100,o=y*(s.split_site_percent||0)/100,l=v*(s.split_deal_percent||0)/100,c=a+o+l}return{...s,split_origination_usd:a,split_site_usd:o,split_deal_usd:l,split_broker_total:c}}),eF=()=>{const[e,t]=x.useState(!1),[r,n]=x.useState(null),s=x.useCallback(async d=>{t(!0),n(null);try{const{data:f,error:m}=await $.from("payment").select("*").eq("id",d).single();if(m)throw m;const{data:h,error:y}=await $.from("payment_split").select("*").eq("payment_id",d);if(y)throw y;return{payment:f,paymentSplits:h||[]}}catch(f){const m=f instanceof Error?f.message:"Failed to load disbursement data";return n(m),console.error("Error loading disbursement data:",f),null}finally{t(!1)}},[]),a=x.useCallback(async(d,f)=>{t(!0),n(null);try{const{error:m}=await $.from("payment").update({referral_fee_paid:f}).eq("id",d);if(m)throw m}catch(m){const h=m instanceof Error?m.message:"Failed to update referral payment status";throw n(h),console.error("Error updating referral paid status:",m),m}finally{t(!1)}},[]),o=x.useCallback(async(d,f)=>{t(!0),n(null),console.log(" Updating payment split paid status:",{splitId:d,paid:f});try{const{error:m,data:h}=await $.from("payment_split").update({paid:f}).eq("id",d).select();if(m)throw console.error(" Supabase error updating payment split:",m),m;console.log(" Payment split updated successfully:",h)}catch(m){const h=m instanceof Error?m.message:"Failed to update payment split status";throw n(h),console.error("Error updating payment split paid status:",m),m}finally{t(!1)}},[]),l=x.useCallback((d,f,m)=>{const h=d.payment_amount||0,y=m||0,v=d.referral_fee_paid&&y>0?y:0,w=f.reduce((C,E)=>C+(E.paid&&E.split_broker_total||0),0),g=v+w,b=h-g,p=y>0?1:0,_=f.filter(C=>(C.split_broker_total||0)>0).length,j=p+_,k=d.referral_fee_paid&&y>0?1:0,N=f.filter(C=>C.paid&&(C.split_broker_total||0)>0).length,S=k+N;return{paymentAmount:h,referralAmount:y,referralDisbursed:v,brokerDisbursed:w,totalDisbursed:g,remainingBalance:b,totalItems:j,paidItems:S,completionPercentage:j>0?Math.round(S/j*100):0,isOverDisbursed:g>h,isFullyDisbursed:S===j&&j>0}},[]),c=x.useCallback((d,f)=>f>d?{isValid:!1,message:`Disbursements exceed payment by $${(f-d).toLocaleString("en-US",{minimumFractionDigits:2})}`}:{isValid:!0},[]),u=x.useCallback(()=>{n(null)},[]);return{loading:e,error:r,loadDisbursementData:s,updateReferralPaid:a,updatePaymentSplitPaid:o,calculateDisbursementTotals:l,validateDisbursement:c,clearError:u}},tF=({payment:e,splits:t,brokers:r,clients:n,commissionSplits:s,dealAmounts:a,deal:o,onSplitPercentageChange:l,onUpdatePayment:c,onUpdatePaymentSplit:u})=>{const[d,f]=x.useState(!1),m=j=>{const k=r.find(N=>N.id===j);return k?k.name:"Unknown Broker"},y=(()=>{const j=e.payment_amount||0,k=o.number_of_payments||1,N=(o.referral_fee_usd||0)/k,S=(o.house_usd||0)/k;return j-N-S})(),v=Z6(t,a,o,e.payment_amount||0),w=X6(v),{updateReferralPaid:g,updatePaymentSplitPaid:b}=eF(),p=async(j,k)=>{try{await g(j,k)}catch(N){console.error("Error updating referral payment status:",N)}},_=async(j,k)=>{try{await b(j,k),u&&(await u(j,{paid:k}),console.log(" Payment split paid status updated, parent state refreshed"))}catch(N){console.error("Error updating payment split status:",N)}};return i.jsxs("div",{className:"border-t border-gray-200 bg-white",children:[i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h4",{className:"text-base font-medium text-gray-900",children:"Commission Breakdown"}),i.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Payment #",e.payment_sequence,"  AGCI: $",y.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),i.jsx("div",{className:"space-y-4",children:v.map(j=>i.jsx(K6,{split:j,brokerName:m(j.broker_id),paymentAmount:e.payment_amount||0,onPercentageChange:(k,N)=>l(j.id,k,N),validationTotals:w},j.id))}),!w.isValid&&i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mt-4",children:[i.jsx("div",{className:"text-sm font-medium text-red-800",children:"Percentage Validation Errors:"}),i.jsxs("div",{className:"text-xs text-red-600 mt-1",children:[w.origination!==100&&`Origination: ${w.origination}% `,w.site!==100&&`Site: ${w.site}% `,w.deal!==100&&`Deal: ${w.deal}% `,"(must equal 100% each)"]})]})]}),i.jsxs("div",{className:"border-t border-gray-200",children:[i.jsx("div",{className:"p-4 bg-gray-50 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>f(!d),children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Payment Details"}),i.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Dates, tracking, and referral information"})]}),i.jsx("button",{className:"p-1 hover:bg-gray-200 rounded",children:d?i.jsx(Od,{className:"h-4 w-4 text-gray-500"}):i.jsx(Jg,{className:"h-4 w-4 text-gray-500"})})]})}),d&&i.jsx(J6,{payment:e,deal:o,clients:n,brokers:r,paymentSplits:t,commissionSplits:s,onUpdatePayment:c,onUpdateReferralPaid:p,onUpdatePaymentSplitPaid:_})]})]})},rF=({payments:e,paymentSplits:t,brokers:r,clients:n,commissionSplits:s,deal:a,onUpdatePayment:o,onDeletePayment:l,onUpdatePaymentSplit:c})=>{const[u,d]=x.useState(new Set),[f,m]=x.useState(!1),[h,y]=x.useState(null),v=_=>{d(j=>{const k=new Set(j);return k.has(_)?k.delete(_):k.add(_),k})},w=_=>t.filter(j=>j.payment_id===_),g=_=>{y(_),m(!0)},b=async()=>{if(h)try{await l(h.id),m(!1),y(null)}catch(_){console.error("Error deleting payment:",_)}},p=async(_,j,k)=>{try{const{error:N}=await $.from("payment_split").update({[j]:k||0}).eq("id",_);if(N)throw console.error("Supabase error:",N),N;c&&await c(_,j,k)}catch(N){console.error("Error updating payment split:",N),alert("Failed to update split percentage. Please try again.")}};return i.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg",children:[i.jsxs("div",{className:"p-6 border-b border-gray-200",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Payment Management"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage individual payments and track their status"})]}),i.jsx("div",{className:"space-y-3",children:e.map(_=>{const j=w(_.id),k=u.has(_.id);return i.jsxs("div",{className:"border border-gray-200 rounded-lg bg-white",children:[i.jsx(G6,{payment:_,totalPayments:e.length,isExpanded:k,onToggleExpansion:()=>v(_.id),onUpdatePayment:N=>o(_.id,N),onDeletePayment:()=>g(_)}),k&&i.jsx(tF,{payment:_,splits:j,brokers:r,clients:n,commissionSplits:s,dealAmounts:{origination_usd:a.origination_usd||0,site_usd:a.site_usd||0,deal_usd:a.deal_usd||0},deal:a,onSplitPercentageChange:p,onUpdatePayment:N=>o(_.id,N),onUpdatePaymentSplit:async(N,S)=>{c&&S.paid!==void 0&&await c(N,"paid",S.paid)}})]},_.id)})}),i.jsx(Uk,{isOpen:f,onClose:()=>m(!1),onConfirm:b,title:"Delete Payment",itemName:h?`Payment ${h.payment_sequence} of ${e.length}`:"",message:"This will permanently delete the payment and all associated commission splits. This action cannot be undone."})]})},nF=({statusSummary:e,hasOverdue:t,completionRate:r})=>i.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[i.jsxs("div",{className:"mb-3",children:[i.jsx("div",{className:"text-sm font-medium text-gray-600",children:"Payment Status"}),e.total>0&&i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["(",Math.round(r),"% complete)"]})]}),i.jsxs("div",{className:"flex flex-wrap gap-2 text-xs",children:[e.received>0&&i.jsx("div",{className:"px-2 py-1 bg-green-100 rounded whitespace-nowrap",children:i.jsxs("span",{className:"text-green-800 font-bold",children:[" Received ",e.received]})}),e.sent>0&&i.jsx("div",{className:"px-2 py-1 bg-blue-100 rounded whitespace-nowrap",children:i.jsxs("span",{className:"text-blue-800 font-bold",children:[" Sent ",e.sent]})}),e.pending>0&&i.jsx("div",{className:"px-2 py-1 bg-yellow-100 rounded whitespace-nowrap",children:i.jsxs("span",{className:"text-yellow-800 font-bold",children:[" Pending ",e.pending]})}),e.overdue>0&&i.jsx("div",{className:"px-2 py-1 bg-red-100 rounded whitespace-nowrap",children:i.jsxs("span",{className:"text-red-800 font-bold",children:[" Overdue ",e.overdue]})})]}),t&&i.jsxs("div",{className:"mt-3 p-2 bg-red-50 border border-red-200 rounded text-xs text-red-700",children:[i.jsx("strong",{children:"Action needed:"})," ",e.overdue," payment",e.overdue!==1?"s":"",e.overdue===1?" is":" are"," overdue and require",e.overdue===1?"s":""," attention."]}),e.total>0&&i.jsx("div",{className:"mt-3",children:i.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:i.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:`${r}%`}})})})]}),sF=({deal:e,commissionSplits:t=[],onEditClick:r,className:n=""})=>{const{baseAmounts:s}=Qg(e,t),{gci:a,houseUsd:o,agci:l,originationPercent:c,sitePercent:u,dealPercent:d,originationUSD:f,siteUSD:m,dealUSD:h,totalDealUSD:y}=s,v=e.fee||0,w=e.referral_fee_percent||0,g=e.referral_fee_usd||w/100*v,b=E=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(E),p=v>0?o/v*100:0,_=v>0?g/v*100:0,j=v>0?o/v*100:0,k=v>0?f/v*100:0,N=v>0?m/v*100:0,S=v>0?h/v*100:0,C=_>0||j>0||k>0||N>0||S>0;return!e.fee||e.fee===0?i.jsxs("div",{className:`bg-white rounded-lg border p-4 ${n}`,children:[i.jsx("div",{className:"text-sm text-gray-500",children:"Commission breakdown will appear when commission fee is set"}),r&&i.jsx("button",{onClick:r,className:"mt-2 text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Set Commission Details "})]}):i.jsxs("div",{className:`bg-white rounded-lg border p-4 ${n}`,children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4",children:[i.jsxs("div",{className:"flex items-center flex-wrap gap-x-4 gap-y-2 text-sm",children:[i.jsxs("span",{className:"font-medium text-gray-900",children:["Total Commission: ",i.jsx("span",{className:"text-green-600",children:b(v)})]}),g>0&&i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"text-gray-400",children:""}),i.jsxs("span",{className:"text-gray-600",children:["Referral: ",i.jsx("span",{className:"text-orange-600",children:b(g)})]})]}),o>0&&i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"text-gray-400",children:""}),i.jsxs("span",{className:"text-gray-600",children:["House: ",i.jsx("span",{className:"text-gray-600",children:b(o)})]})]}),i.jsx("span",{className:"text-gray-400",children:""}),i.jsxs("span",{className:"text-gray-600",children:["AGCI: ",i.jsx("span",{className:"text-blue-600 font-medium",children:b(l)})]})]}),r&&i.jsx("button",{onClick:r,className:"mt-2 sm:mt-0 px-3 py-1 text-sm bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-md transition-colors",children:"Edit Commission"})]}),C&&i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex h-8 bg-gray-200 rounded-lg overflow-hidden",children:[_>0&&i.jsx("div",{className:"bg-orange-500 flex items-center justify-center relative group",style:{width:`${_}%`},title:`Referral: ${w}% of total - ${b(g)}`,children:_>15&&i.jsxs("span",{className:"text-white text-xs font-medium",children:[w.toFixed(1),"%"]})}),j>0&&i.jsx("div",{className:"bg-gray-500 flex items-center justify-center relative group",style:{width:`${j}%`},title:`House: ${p.toFixed(1)}% of total - ${b(o)}`,children:j>15&&i.jsxs("span",{className:"text-white text-xs font-medium",children:[p.toFixed(1),"%"]})}),k>0&&i.jsx("div",{className:"bg-blue-500 flex items-center justify-center relative group",style:{width:`${k}%`},title:`Origination: ${c}% of AGCI - ${b(f)}`,children:k>15&&i.jsxs("span",{className:"text-white text-xs font-medium",children:[c,"%"]})}),N>0&&i.jsx("div",{className:"bg-green-500 flex items-center justify-center relative group",style:{width:`${N}%`},title:`Site: ${u}% of AGCI - ${b(m)}`,children:N>15&&i.jsxs("span",{className:"text-white text-xs font-medium",children:[u,"%"]})}),S>0&&i.jsx("div",{className:"bg-purple-500 flex items-center justify-center relative group",style:{width:`${S}%`},title:`Deal: ${d}% of AGCI - ${b(h)}`,children:S>15&&i.jsxs("span",{className:"text-white text-xs font-medium",children:[d,"%"]})})]}),i.jsxs("div",{className:"flex flex-wrap items-center gap-x-6 gap-y-2",children:[g>0&&i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded mr-2"}),i.jsxs("span",{className:"text-sm text-gray-900",children:[i.jsx("span",{className:"font-medium",children:"Referral"})," ",b(g)]})]}),o>0&&i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"w-3 h-3 bg-gray-500 rounded mr-2"}),i.jsxs("span",{className:"text-sm text-gray-900",children:[i.jsx("span",{className:"font-medium",children:"House"})," ",b(o)]})]}),c>0&&i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded mr-2"}),i.jsxs("span",{className:"text-sm text-gray-900",children:[i.jsx("span",{className:"font-medium",children:"Origination"})," ",b(f)]})]}),u>0&&i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"w-3 h-3 bg-green-500 rounded mr-2"}),i.jsxs("span",{className:"text-sm text-gray-900",children:[i.jsx("span",{className:"font-medium",children:"Site"})," ",b(m)]})]}),d>0&&i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded mr-2"}),i.jsxs("span",{className:"text-sm text-gray-900",children:[i.jsx("span",{className:"font-medium",children:"Deal"})," ",b(h)]})]})]}),y!==l&&l>0&&i.jsx("div",{className:"text-xs text-amber-600 bg-amber-50 p-2 rounded",children:" Commission percentages don't total to 100% of AGCI"})]}),!C&&i.jsxs("div",{className:"text-center py-4",children:[i.jsx("div",{className:"text-sm text-gray-500 mb-2",children:"Commission breakdown percentages not configured"}),r&&i.jsx("button",{onClick:r,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Configure Commission Splits "})]})]})},aF=e=>{const t=o=>{if(o.payment_received)return"received";if(o.invoice_sent&&!o.payment_received){if(o.payment_date_estimated){const l=new Date(o.payment_date_estimated),c=new Date;if(c.setHours(0,0,0,0),l<c)return"overdue"}return"sent"}if(o.payment_date_estimated&&!o.invoice_sent){const l=new Date(o.payment_date_estimated),c=new Date;if(c.setHours(0,0,0,0),l<c)return"overdue"}return"pending"},r=e.reduce((o,l)=>{const c=t(l);return o[c]=(o[c]||0)+1,o.total++,o},{pending:0,sent:0,overdue:0,received:0,total:0}),n=r.overdue>0,s=r.overdue>0||r.sent>0,a=r.total>0?r.received/r.total*100:0;return{getPaymentStatus:t,statusSummary:r,hasOverdue:n,hasActionItems:s,completionRate:a}},to=new Map,iF=3*60*1e3,oF=({deal:e,onDealUpdate:t})=>{const[r,n]=x.useState([]),[s,a]=x.useState([]),[o,l]=x.useState([]),[c,u]=x.useState([]),[d,f]=x.useState([]),[m,h]=x.useState(!0),[y,v]=x.useState(null),[w,g]=x.useState(!1),{calculatedPaymentAmount:b,totalCalculatedPayments:p,paymentCommissionBreakdown:_,canGeneratePayments:j,validationMessages:k}=zk(e,r,o),N=x.useCallback(async()=>{if(!e.id)return;const R=to.get(e.id),P=Date.now();if(R&&P-R.timestamp<iF){console.log(" Using cached payment data for deal:",e.id),n(R.payments),a(R.paymentSplits),l(R.commissionSplits),u(R.brokers),f(R.clients),h(!1);return}try{h(!0),v(null);const[D,z,W,I]=await Promise.all([$.from("payment").select("*").eq("deal_id",e.id).order("payment_sequence",{ascending:!0}),$.from("commission_split").select("*").eq("deal_id",e.id),$.from("broker").select("id, name").order("name"),$.from("client").select("*").order("client_name")]);if(D.error)throw D.error;if(z.error)throw z.error;if(W.error)throw W.error;if(I.error)throw I.error;const ne=D.data||[],re=z.data||[],Q=W.data||[],U=I.data||[];let J=[];const X=ne.map(ue=>ue.id);if(X.length>0){const{data:ue,error:pe}=await $.from("payment_split").select("*").in("payment_id",X);if(pe)throw pe;J=ue||[]}if(to.set(e.id,{payments:ne,paymentSplits:J,commissionSplits:re,brokers:Q,clients:U,timestamp:Date.now()}),to.size>50){const ue=to.keys().next().value;ue!==void 0&&to.delete(ue)}n(ne),a(J),l(re),u(Q),f(U)}catch(D){console.error("Error fetching payment data:",D),v(D instanceof Error?D.message:"Failed to load payment data")}finally{h(!1)}},[e.id]),S=async()=>{if(e.id)try{g(!0),v(null);const{data:R,error:P}=await $.rpc("generate_payments_for_deal",{deal_uuid:e.id});if(P)throw P;await N()}catch(R){console.error("Error generating payments:",R),v(R instanceof Error?R.message:"Failed to generate payments")}finally{g(!1)}},C=async(R,P)=>{try{const{error:D}=await $.from("payment").update(P).eq("id",R);if(D)throw D;n(z=>z.map(W=>W.id===R?{...W,...P}:W))}catch(D){console.error("Error updating payment:",D),v(D instanceof Error?D.message:"Failed to update payment")}},E=async R=>{try{const{error:P}=await $.from("payment_split").delete().eq("payment_id",R);if(P)throw P;const{error:D}=await $.from("payment").delete().eq("id",R);if(D)throw D;n(z=>z.filter(W=>W.id!==R)),a(z=>z.filter(W=>W.payment_id!==R))}catch(P){console.error("Error deleting payment:",P),v(P instanceof Error?P.message:"Failed to delete payment")}};if(x.useEffect(()=>{N()},[N]),m)return i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsx("div",{className:"text-gray-500",children:"Loading payment data..."})});const T=r.length>0;r.reduce((R,P)=>R+(P.payment_amount||0),0);const L=e.fee||0,{statusSummary:O,hasOverdue:A,hasActionItems:M,completionRate:B}=aF(r),F=R=>R.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2});return i.jsxs("div",{className:"space-y-6",children:[y&&i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:i.jsx("div",{className:"text-red-700",children:y})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[i.jsx("div",{className:"text-sm font-medium text-blue-600",children:"Total Commission"}),i.jsxs("div",{className:"text-2xl font-bold text-blue-900",children:["$",F(L)]})]}),i.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[i.jsx("div",{className:"text-sm font-medium text-green-600",children:"Calculated Payments"}),i.jsxs("div",{className:"text-2xl font-bold text-green-900",children:["$",F(p)]}),i.jsxs("div",{className:"text-xs text-green-600 mt-1",children:[e.number_of_payments||1,"  $",F(b)]})]}),i.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[i.jsx("div",{className:"text-sm font-medium text-purple-600",children:"AGCI Available"}),i.jsxs("div",{className:"text-2xl font-bold text-purple-900",children:["$",F(e.agci||0)]}),i.jsx("div",{className:"text-xs text-purple-600 mt-1",children:"After house & referral fees"})]}),i.jsx(nF,{statusSummary:O,hasOverdue:A,completionRate:B})]}),i.jsx(sF,{deal:e,commissionSplits:o,className:"mb-6"}),i.jsx(K$,{deal:e,hasPayments:T,existingPayments:r,commissionSplits:o,onGeneratePayments:S,generatingPayments:w}),T?i.jsx("div",{className:"space-y-6",children:i.jsx(rF,{payments:r,paymentSplits:s,brokers:c,clients:d,commissionSplits:o,deal:e,onUpdatePayment:C,onDeletePayment:E,onUpdatePaymentSplit:async(R,P,D)=>{a(z=>z.map(W=>W.id===R?{...W,[P]:D!==null?D:P==="paid"?!1:0}:W))}})}):i.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:[i.jsx("div",{className:"text-gray-500 text-lg mb-2",children:"No payments generated yet"}),i.jsx("div",{className:"text-gray-400 text-sm",children:j?'Click "Generate Payments" above to create payment records':"Complete commission configuration to enable payment generation"}),k.length>0&&i.jsxs("div",{className:"mt-4 text-left max-w-md mx-auto",children:[i.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Required configuration:"}),i.jsx("ul",{className:"text-sm text-gray-500 space-y-1",children:k.map((R,P)=>i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"text-gray-400 mr-1",children:""}),R]},P))})]})]})]})};function lF(e){const[t,r]=x.useState([]),[n,s]=x.useState(!0),[a,o]=x.useState(null),l=async()=>{if(!e){r([]),s(!1);return}try{s(!0),o(null),console.log("Fetching activities for:",e);let u=$.from("activity").select(`
          *,
          activity_status!activity_status_id_fkey (
            name,
            color,
            is_closed
          ),
          activity_type!activity_activity_type_id_fkey (
            name,
            color
          ),
          activity_priority!activity_activity_priority_id_fkey (
            name,
            color
          ),
          activity_task_type!activity_activity_task_type_id_fkey (
            name,
            category
          ),
          owner:user!activity_owner_id_fkey (
            first_name,
            last_name,
            email
          ),
          updated_by_user:user!activity_updated_by_fkey (
            first_name,
            last_name,
            email
          ),
          contact!activity_contact_id_fkey (
            first_name,
            last_name,
            company
          )
        `);switch(e.type){case"deal":u=u.eq("deal_id",e.id);break;case"contact":u=u.eq("contact_id",e.id);break;case"client":u=u.eq("client_id",e.id);break;case"property":u=u.eq("property_id",e.id);break;case"site_submit":u=u.eq("site_submit_id",e.id);break;case"assignment":u=u.eq("assignment_id",e.id);break;default:u=u.eq("related_object_type",e.type).eq("related_object_id",e.id);break}const{data:d,error:f}=await u.order("activity_date",{ascending:!1});if(f)throw console.error("Error fetching activities:",f),f;console.log(`Found ${(d==null?void 0:d.length)||0} activities for ${e.type}:${e.id}`),r(d||[])}catch(u){console.error("Error in fetchActivities:",u),o(u instanceof Error?u.message:"Failed to fetch activities")}finally{s(!1)}},c=()=>{l()};return x.useEffect(()=>{l()},[e==null?void 0:e.id,e==null?void 0:e.type]),{activities:t,loading:n,error:a,refetch:c}}function cF({title:e,titleId:t,...r},n){return x.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?x.createElement("title",{id:t},e):null,x.createElement("path",{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm13.36-1.814a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z",clipRule:"evenodd"}))}const uF=x.forwardRef(cF),Eb=uF;function dF({title:e,titleId:t,...r},n){return x.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?x.createElement("title",{id:t},e):null,x.createElement("path",{d:"M1.5 8.67v8.58a3 3 0 0 0 3 3h15a3 3 0 0 0 3-3V8.67l-8.928 5.493a3 3 0 0 1-3.144 0L1.5 8.67Z"}),x.createElement("path",{d:"M22.5 6.908V6.75a3 3 0 0 0-3-3h-15a3 3 0 0 0-3 3v.158l9.714 5.978a1.5 1.5 0 0 0 1.572 0L22.5 6.908Z"}))}const fF=x.forwardRef(dF),mF=fF;function hF({title:e,titleId:t,...r},n){return x.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?x.createElement("title",{id:t},e):null,x.createElement("path",{fillRule:"evenodd",d:"M1.5 4.5a3 3 0 0 1 3-3h1.372c.86 0 1.61.586 1.819 1.42l1.105 4.423a1.875 1.875 0 0 1-.694 1.955l-1.293.97c-.135.101-.164.249-.126.352a11.285 11.285 0 0 0 6.697 6.697c.103.038.25.009.352-.126l.97-1.293a1.875 1.875 0 0 1 1.955-.694l4.423 1.105c.834.209 1.42.959 1.42 1.82V19.5a3 3 0 0 1-3 3h-2.25C8.552 22.5 1.5 15.448 1.5 6.75V4.5Z",clipRule:"evenodd"}))}const pF=x.forwardRef(hF),gF=pF;let xF=class{constructor(){this.lines=[],this.isHidden=!1,this.isSignature=!1,this.isQuoted=!1,this.isAnswer=!1}};var yF=xF;let bF=class{constructor(t,r,n,s,a){this._content=t,this._isHidden=r,this._isSignature=n,this._isQuoted=s,this._isAnswer=a}isHidden(){return this._isHidden}isSignature(){return this._isSignature}isQuoted(){return this._isQuoted}isAnswer(){return this._isAnswer}getContent(){return this._content}isEmpty(){return this.getContent().replace(/\n/g,"")===""}toString(){return this.getContent()}};var vF=bF;let wF=class{constructor(t=[]){this.fragments=t}getFragments(){return this.fragments}getVisibleText(){return this.filterText(t=>!t.isHidden())}getQuotedText(){return this.filterText(t=>t.isQuoted())}getAnswerText(){return this.filterText(t=>t.isAnswer())}filterText(t){return this.fragments.filter(t).join(`
`).replace(/~*$/,"")}};var _F=wF;const jF={},kF=Object.freeze(Object.defineProperty({__proto__:null,default:jF},Symbol.toStringTag,{value:"Module"})),NF=Hv(kF);let ro,Db,SF=class{constructor(){this.SafeRegExp=Db!==!1?(()=>{if(typeof ro=="function")return ro;try{return ro=NF,typeof ro=="function"?ro:RegExp}catch{return Db=!1,RegExp}})():RegExp,this.answerHeadersRegex=this.buildRe2([/^>*-*\s*(On\s.+\s.+\n?wrote:{0,1})\s{0,1}-*$/m,/^>*-*\s*(Le\s.+\s.+\n?crit\s?:{0,1})\s{0,1}-*$/m,/^>*-*\s*(El\s.+\s.+\n?escribi:{0,1})\s{0,1}-*$/m,/^>*-*\s*(Il\s.+\s.+\n?scritto:{0,1})\s{0,1}-*$/m,/^>*-*\s*(Em\s.+\s.+\n?escreveu:{0,1})\s{0,1}-*$/m,/^>*\s*(Am\s.+\s)\n?\n?schrieb.+\s?(\[|<).+(\]|>):$/m,/^>*\s*(Op\s[\s\S]+?\n?schreef[\s\S]+:)$/m,/^>*\s*((W\sdniu|Dnia)\s[\s\S]+?(pisze|napisa(\(a\))?):)$/mu,/^>*\s*(Den\s.+\s\n?skrev\s.+:)$/m,/^>*\s*(pe\s.+\s.+\n?kirjoitti:)$/m,/^>*\s*(Am\s.+\sum\s.+\s\n?schrieb\s.+:)$/m,/^>*([\s\S]+)$/m,/^>*(20[0-9]{2}\..+\s:)$/m,/^>*(20[0-9]{2}\/.+:)$/m,/^>*(.+\s<.+>\sschrieb:)$/m,/^>*(.+\son.*at.*wrote:)$/m,/^>*\s*(From\s?:.+\s?\n?\s*[\[|<].+[\]|>])/m,/^>*\s*(Von\s?:.+\s?\n?\s*[\[|<].+[\]|>])/m,/^>*\s*(De\s?:.+\s?\n?\s*(\[|<).+(\]|>))/m,/^>*\s*(Van\s?:.+\s?\n?\s*(\[|<).+(\]|>))/m,/^>*\s*(Da\s?:.+\s?\n?\s*(\[|<).+(\]|>))/m,/^>*(20[0-9]{2})-([0-9]{2}).([0-9]{2}).([0-9]{2}):([0-9]{2})\n?(.*)>:$/m,/^>*\s*([a-z]{3,4}\.\s[\s\S]+\sskrev\s[\s\S]+:)$/m,/^>*([0-9]{2}).([0-9]{2}).(20[0-9]{2})(.*)(([0-9]{2}).([0-9]{2}))(.*)\"( *)<(.*)>( *):$/m,/^>*[0-9]{2}:[0-9]{2}(.*)[0-9]{4}(.*)\"( *)<(.*)>( *):$/,/^>*(.*)[0-9]{4}(.*)from(.*)<(.*)>:$/,/^>*-{1,12} ?(O|o)riginal (M|m)essage ?-{1,12}$/i,/^>*-{1,12} ?(O|o)prindelig (B|b)esked ?-{1,12}$/i,/^>*-{1,12} ?(M|m)essage d\'origine ?-{1,12}$/i]),this.signatureRegex=this.buildRe2([/^\s*-{2,4}$/,/^\s*_{2,4}$/,/^-- $/,/^\+{2,4}$/,/^\={2,4}$/,/^________________________________$/,/^Sent from (?:\s*.+)$/,/^Get Outlook for (?:\s*.+).*/m,/^Cheers,?!?$/mi,/^Best wishes,?!?$/mi,/^\w{0,20}\s?(\sand\s)?Regards,?!??$/mi,/^Von (?:\s*.+) gesendet$/,/^Gesendet von (?:\s*.+) fr (?:\s*.+)$/,/^Sendt fra (?:\s*.+)$/,/^Envoy depuis (?:\s*.+)$/,/^Envoy de mon (?:\s*.+)$/,/^Envoy  partir de (?:\s*.+)$/,/^Tlcharger Outlook pour (?:\s*.+).*/m,/^Bien . vous,?!?$/mi,/^\w{0,20}\s?cordialement,?!?$/mi,/^Bonne (journ.e|soir.e)!?$/mi,/^Enviado desde (?:\s*.+)$/,/^-*\s*(In\sdata\s.+\s.+\n?scritto:{0,1})\s{0,1}-*$/m,/^Verzonden vanaf (?:\s*.+)$/,/^Verstuurd vanaf (?:\s*.+)$/])}buildRe2(t){return t.map(r=>new this.SafeRegExp(r))}};var CF=new SF,EF=yF,DF=vF,PF=_F,no=CF;const TF=/(>+)$/;let LF=class{constructor(){this.fragments=[]}stringReverse(t){let r="",n=t.length;for(;n>0;)r+=t.substring(n-1,n),n--;return r}stringRTrim(t,r){for(let n=t.length-1;n>=0;n--)if(r!=t.charAt(n)){t=t.substring(0,n+1);break}return t}stringLTrim(t){return t.replace(/^\s+/,"")}parse(t){t=t.replace(/\r\n/g,`
`),t=this.fixBrokenSignatures(t);let r=null;this.stringReverse(t).split(`
`).forEach(s=>{if(s=this.stringRTrim(s,`
`),this.isSignature(s)||(s=this.stringLTrim(s)),r){let o=r.lines[r.lines.length-1];this.isSignature(o)?(r.isSignature=!0,this.addFragment(r),r=null):s===""&&this.isAnswerHeader(o)&&(r.isAnswer=!0,this.addFragment(r),r=null)}let a=this.isQuote(s);(r===null||!this.isFragmentLine(r,s,a))&&(r!==null&&this.addFragment(r),r=new EF,r.isQuoted=a),r.lines.push(s)}),r!==null&&this.addFragment(r);let n=this.createEmail(this.fragments);return this.fragments=[],n}fixBrokenSignatures(t){let r=t;return no.answerHeadersRegex.forEach(n=>{let s=r.match(n);if(s){const[a,o]=s;r=r.replace(o,o.replace(/\n/g," "))}}),r}getAnswerHeadersRegex(){return no.answerHeadersRegex}setAnswerHeadersRegex(t){return no.answerHeadersRegex=t,this}createEmail(t){let r=[];return t.reverse().forEach(n=>{r.push(new DF(this.stringReverse(n.lines.join(`
`)).replace(/^\n/g,""),n.isHidden,n.isSignature,n.isQuoted,n.isAnswer))}),new PF(r)}isAnswerHeader(t){let r=!1;return no.answerHeadersRegex.forEach(n=>{n.test(this.stringReverse(t))&&(r=!0)}),r}isSignature(t){let r=this.stringReverse(t);return no.signatureRegex.some(n=>n.test(r))}isQuote(t){return TF.test(t)}isEmpty(t){return t.lines.join("")===""}isFragmentLine(t,r,n){return t.isQuoted===n||t.isQuoted&&(this.isAnswerHeader(r)||r==="")}addFragment(t){(t.isSignature||t.isAnswer||this.isEmpty(t))&&(t.isHidden=!0),this.fragments.push(t)}};var IF=LF,RF=IF;let MF=class{read(t){return new RF().parse(t)}parseReply(t){return this.read(t).getVisibleText()}parseReplied(t){return this.read(t).getQuotedText()}};var qk=MF;const Vk=pl(qk),OF=Wv({__proto__:null,default:Vk},[qk]);var Yk={exports:{}};(function(e){(function(t){function r(u){function d(){return ga<_0}function f(){return Oi[ga]}function m(){return ga}function h(Y){ga=Y}function y(){ga+=1}function v(){ga=0,_0=Oi.length}function w(Y,V){return{name:Y,tokens:V||"",semantic:V||"",children:[]}}function g(Y,V){var ee;return V===null?null:(ee=w(Y),ee.tokens=V.tokens,ee.semantic=V.semantic,ee.children.push(V),ee)}function b(Y,V){return V!==null&&(Y.tokens+=V.tokens,Y.semantic+=V.semantic),Y.children.push(V),Y}function p(Y){var V;return d()?(V=f(),Y(V)?(y(),w("token",V)):null):null}function _(){return null}function j(Y){return function(){return g("literal",p(function(ee){return ee===Y}))}}function k(){var Y=arguments;return function(){var ee,le,de,Ue;for(Ue=m(),le=w("and"),ee=0;ee<Y.length;ee+=1){if(de=Y[ee](),de===null)return h(Ue),null;b(le,de)}return le}}function N(){var Y=arguments;return function(){var ee,le,de;for(de=m(),ee=0;ee<Y.length;ee+=1){if(le=Y[ee](),le!==null)return le;h(de)}return null}}function S(Y){return function(){var ee,le;return le=m(),ee=Y(),ee!==null?ee:(h(le),w("opt"))}}function C(Y){return function(){var ee=Y();return ee!==null&&(ee.semantic=""),ee}}function E(Y){return function(){var ee=Y();return ee!==null&&ee.semantic.length>0&&(ee.semantic=" "),ee}}function T(Y,V){return function(){var le,de,Ue,yn,j0;for(yn=m(),le=w("star"),Ue=0,j0=V===void 0?0:V;(de=Y())!==null;)Ue=Ue+1,b(le,de);return Ue>=j0?le:(h(yn),null)}}function L(Y){return Y.replace(/([ \t]|\r\n)+/g," ").replace(/^\s*/,"").replace(/\s*$/,"")}function O(Y){return Y.charCodeAt(0)>=128}function A(){return g("cr",j("\r")())}function M(){return g("crlf",k(A,R)())}function B(){return g("dquote",j('"')())}function F(){return g("htab",j("	")())}function R(){return g("lf",j(`
`)())}function P(){return g("sp",j(" ")())}function D(){return g("vchar",p(function(V){var ee=V.charCodeAt(0),le=33<=ee&&ee<=126;return u.rfc6532&&(le=le||O(V)),le}))}function z(){return g("wsp",N(P,F)())}function W(){var Y=g("quoted-pair",N(k(j("\\"),N(D,z)),zn)());return Y===null?null:(Y.semantic=Y.semantic[1],Y)}function I(){return g("fws",N(VN,k(S(k(T(z),C(M))),T(z,1)))())}function ne(){return g("ctext",N(function(){return p(function(ee){var le=ee.charCodeAt(0),de=33<=le&&le<=39||42<=le&&le<=91||93<=le&&le<=126;return u.rfc6532&&(de=de||O(ee)),de})},Cs)())}function re(){return g("ccontent",N(ne,W,Q)())}function Q(){return g("comment",k(j("("),T(k(S(I),re)),S(I),j(")"))())}function U(){return g("cfws",N(k(T(k(S(I),Q),1),S(I)),I)())}function J(){return g("atext",p(function(V){var ee="a"<=V&&V<="z"||"A"<=V&&V<="Z"||"0"<=V&&V<="9"||["!","#","$","%","&","'","*","+","-","/","=","?","^","_","`","{","|","}","~"].indexOf(V)>=0;return u.rfc6532&&(ee=ee||O(V)),ee}))}function X(){return g("atom",k(E(S(U)),T(J,1),E(S(U)))())}function ue(){var Y,V;return Y=g("dot-atom-text",T(J,1)()),Y===null||(V=T(k(j("."),T(J,1)))(),V!==null&&b(Y,V)),Y}function pe(){return g("dot-atom",k(C(S(U)),ue,C(S(U)))())}function De(){return g("qtext",N(function(){return p(function(ee){var le=ee.charCodeAt(0),de=le===33||35<=le&&le<=91||93<=le&&le<=126;return u.rfc6532&&(de=de||O(ee)),de})},Lt)())}function Se(){return g("qcontent",N(De,W)())}function tt(){return g("quoted-string",k(C(S(U)),C(B),T(k(S(E(I)),Se)),S(C(I)),C(B),C(S(U)))())}function ye(){return g("word",N(X,tt)())}function ct(){return g("phrase",N(Dr,T(ye,1))())}function Be(){return g("address",N(Ie,Ne)())}function Ie(){return g("mailbox",N(fr,Pe)())}function fr(){return g("name-addr",k(S(gn),fe)())}function fe(){return g("angle-addr",N(k(C(S(U)),j("<"),Pe,j(">"),C(S(U))),YN)())}function Ne(){return g("group",k(gn,j(":"),S(zd),j(";"),C(S(U)))())}function gn(){return g("display-name",function(){var V=ct();return V!==null&&(V.semantic=L(V.semantic)),V}())}function Ri(){return g("mailbox-list",N(k(Ie,T(k(j(","),Ie))),QN)())}function pa(){return g("address-list",N(k(Be,T(k(j(u.addressListSeparator),Be))),JN)())}function zd(){return g("group-list",N(Ri,C(U),XN)())}function q(){return g("local-part",N(ZN,pe,tt)())}function te(){return g("dtext",N(function(){return p(function(ee){var le=ee.charCodeAt(0),de=33<=le&&le<=90||94<=le&&le<=126;return u.rfc6532&&(de=de||O(ee)),de})},t2)())}function he(){return g("domain-literal",k(C(S(U)),j("["),T(k(S(I),te)),S(I),j("]"),C(S(U)))())}function be(){return g("domain",function(){var V=N(e2,pe,he)();return u.rejectTLD&&V&&V.semantic&&V.semantic.indexOf(".")<0?null:(V&&(V.semantic=V.semantic.replace(/\s+/g,"")),V)}())}function Pe(){return g("addr-spec",k(q,j("@"),be)())}function Zt(){return g("from",N(Ri,pa)())}function xn(){return g("sender",N(Ie,Be)())}function Er(){return g("reply-to",pa())}function Gr(){return u.strict?null:g("obs-NO-WS-CTL",p(function(Y){var V=Y.charCodeAt(0);return 1<=V&&V<=8||V===11||V===12||14<=V&&V<=31||V===127}))}function Cs(){return u.strict?null:g("obs-ctext",Gr())}function Lt(){return u.strict?null:g("obs-qtext",Gr())}function zn(){return u.strict?null:g("obs-qp",k(j("\\"),N(j("\0"),Gr,R,A))())}function Dr(){return u.strict?null:g("obs-phrase",k(ye,T(N(ye,j("."),u.atInDisplayName?j("@"):_,u.commaInDisplayName?j(","):_,E(U))))())}function VN(){return u.strict?null:g("obs-FWS",T(k(C(S(M)),z),1)())}function YN(){return u.strict?null:g("obs-angle-addr",k(C(S(U)),j("<"),GN,Pe,j(">"),C(S(U)))())}function GN(){return u.strict?null:g("obs-route",k(KN,j(":"))())}function KN(){return u.strict?null:g("obs-domain-list",k(T(N(C(U),j(","))),j("@"),be,T(k(j(","),C(S(U)),S(k(j("@"),be)))))())}function QN(){return u.strict?null:g("obs-mbox-list",k(T(k(C(S(U)),j(","))),Ie,T(k(j(","),S(k(Ie,C(U))))))())}function JN(){return u.strict?null:g("obs-addr-list",k(T(k(C(S(U)),j(","))),Be,T(k(j(","),S(k(Be,C(U))))))())}function XN(){return u.strict?null:g("obs-group-list",k(T(k(C(S(U)),j(",")),1),C(S(U)))())}function ZN(){return u.strict?null:g("obs-local-part",k(ye,T(k(j("."),ye)))())}function e2(){return u.strict?null:g("obs-domain",k(X,T(k(j("."),X)))())}function t2(){return u.strict?null:g("obs-dtext",N(Gr,W)())}function Mi(Y,V){var ee,le,de;if(V==null)return null;for(le=[V];le.length>0;){if(de=le.pop(),de.name===Y)return de;for(ee=de.children.length-1;ee>=0;ee-=1)le.push(de.children[ee])}return null}function r2(Y,V){var ee,le,de,Ue;if(V==null)return null;for(le=[V],Ue=[];le.length>0;)for(de=le.pop(),de.name===Y&&Ue.push(de),ee=de.children.length-1;ee>=0;ee-=1)le.push(de.children[ee]);return Ue}function Wd(Y,V){var ee,le,de,Ue,yn;if(V==null)return null;for(le=[V],Ue=[],yn={},ee=0;ee<Y.length;ee+=1)yn[Y[ee]]=!0;for(;le.length>0;)if(de=le.pop(),de.name in yn)Ue.push(de);else for(ee=de.children.length-1;ee>=0;ee-=1)le.push(de.children[ee]);return Ue}function v0(Y){var V,ee,le,de,Ue;if(Y===null)return null;for(V=[],ee=Wd(["group","mailbox"],Y),le=0;le<ee.length;le+=1)de=ee[le],de.name==="group"?V.push(n2(de)):de.name==="mailbox"&&V.push(w0(de));return Ue={ast:Y,addresses:V},u.simple&&(Ue=s2(Ue)),u.oneResult?i2(Ue):u.simple?Ue&&Ue.addresses:Ue}function n2(Y){var V,ee=Mi("display-name",Y),le=[],de=Wd(["mailbox"],Y);for(V=0;V<de.length;V+=1)le.push(w0(de[V]));return{node:Y,parts:{name:ee},type:Y.name,name:Es(ee),addresses:le}}function w0(Y){var V=Mi("display-name",Y),ee=Mi("addr-spec",Y),le=r2("cfws",Y),de=Wd(["comment"],Y),Ue=Mi("local-part",ee),yn=Mi("domain",ee);return{node:Y,parts:{name:V,address:ee,local:Ue,domain:yn,comments:le},type:Y.name,name:Es(V),address:Es(ee),local:Es(Ue),domain:Es(yn),comments:a2(de),groupName:Es(Y.groupName)}}function Es(Y){return Y!=null?Y.semantic:null}function s2(Y){var V;if(Y&&Y.addresses)for(V=0;V<Y.addresses.length;V+=1)delete Y.addresses[V].node;return Y}function a2(Y){var V="";if(Y)for(var ee=0;ee<Y.length;ee+=1)V+=Es(Y[ee]);return V}function i2(Y){return!Y||!u.partial&&Y.addresses.length>1?null:Y.addresses&&Y.addresses[0]}var Oi,ga,_0,Al,Hd;if(u=c(u,{}),u===null)return null;if(Oi=u.input,Hd={address:Be,"address-list":pa,"angle-addr":fe,from:Zt,group:Ne,mailbox:Ie,"mailbox-list":Ri,"reply-to":Er,sender:xn}[u.startAt]||pa,!u.strict){if(v(),u.strict=!0,Al=Hd(Oi),u.partial||!d())return v0(Al);u.strict=!1}return v(),Al=Hd(Oi),!u.partial&&d()?null:v0(Al)}function n(u){return r(c(u,{oneResult:!0,rfc6532:!0,simple:!0,startAt:"address-list"}))}function s(u){return r(c(u,{rfc6532:!0,simple:!0,startAt:"address-list"}))}function a(u){return r(c(u,{rfc6532:!0,simple:!0,startAt:"from"}))}function o(u){return r(c(u,{oneResult:!0,rfc6532:!0,simple:!0,startAt:"sender"}))}function l(u){return r(c(u,{rfc6532:!0,simple:!0,startAt:"reply-to"}))}function c(u,d){function f(w){return Object.prototype.toString.call(w)==="[object String]"}function m(w){return w===Object(w)}function h(w){return w==null}var y,v;if(f(u))u={input:u};else if(!m(u))return null;if(!f(u.input)||!d)return null;y={oneResult:!1,partial:!1,rejectTLD:!1,rfc6532:!1,simple:!1,startAt:"address-list",strict:!1,atInDisplayName:!1,commaInDisplayName:!1,addressListSeparator:","};for(v in y)h(u[v])&&(u[v]=h(d[v])?y[v]:d[v]);return u}r.parseOneAddress=n,r.parseAddressList=s,r.parseFrom=a,r.parseSender=o,r.parseReplyTo=l,e.exports=r})()})(Yk);var Pb=Yk.exports;const Gk=Vk||OF;function AF(e,t){if(!e)return null;try{const r=new Gk().read(e),n=$F(e),s=r.getFragments().map(d=>({content:d.getContent(),isQuoted:d.isQuoted(),isSignature:d.isSignature(),isHidden:d.isHidden()})),a=s.filter(d=>!d.isQuoted&&!d.isSignature&&!d.isHidden),o=s.filter(d=>d.isQuoted&&!d.isHidden),l=s.filter(d=>d.isSignature),c=BF(e,n);return{headers:{...n,subject:n.subject||t||""},content:{visibleText:a.map(d=>d.content).join(`

`).trim(),signature:l.map(d=>d.content).join(`

`).trim(),fragments:s,emailThread:c},metadata:{isReply:r.getFragments().some(d=>d.isQuoted()),isForward:e.toLowerCase().includes("forwarded message")||e.toLowerCase().includes("fwd:")||e.toLowerCase().includes("forward:"),hasQuotedText:o.length>0,hasSignature:l.length>0}}}catch(r){return console.error("Error parsing email:",r),FF(e,t)}}function $F(e){const t={to:[],from:"",cc:[],bcc:[],date:"",replyTo:void 0},r=e.split(`
`).slice(0,30),n={from:/^(from|From|FROM):\s*(.+)$/,to:/^(to|To|TO):\s*(.+)$/,cc:/^(cc|Cc|CC):\s*(.+)$/,bcc:/^(bcc|Bcc|BCC):\s*(.+)$/,date:/^(date|Date|DATE|sent|Sent):\s*(.+)$/,replyTo:/^(reply-to|Reply-To|REPLY-TO):\s*(.+)$/};for(const s of r){const a=s.trim();if(a)for(const[o,l]of Object.entries(n)){const c=a.match(l);if(c){const u=c[2].trim();if(o==="to"||o==="cc"||o==="bcc"){const d=Pb.parseAddressList(u);d?t[o]=d.map(f=>f.name?`${f.name} <${f.address}>`:f.address):t[o]=u.split(/[,;]/).map(f=>f.trim()).filter(Boolean)}else if(o==="from"||o==="replyTo"){const d=Pb.parseOneAddress(u);d&&o==="from"?t.from=d.name?`${d.name} <${d.address}>`:d.address:d&&o==="replyTo"?t.replyTo=d.name?`${d.name} <${d.address}>`:d.address:(o==="from"&&(t.from=u),o==="replyTo"&&(t.replyTo=u))}else t[o]=u;break}}}return t}function FF(e,t){return{headers:{to:[],from:"",cc:[],bcc:[],subject:t||"",date:""},content:{visibleText:e.trim(),signature:"",fragments:[{content:e.trim(),isQuoted:!1,isSignature:!1,isHidden:!1}],emailThread:[{id:"fallback-email-0",headers:{from:"Unknown Sender",to:[],date:"",subject:t||"No Subject"},content:e.trim(),type:"current",level:0}]},metadata:{isReply:!1,isForward:!1,hasQuotedText:!1,hasSignature:!1}}}function Kc(e){return e?e.split(/\n\s*\n/).map(t=>t.replace(/\n/g," ").trim()).filter(t=>t.length>0):[]}function BF(e,t){const r=[];let n=0;const s=new Gk().read(e),a=s.getVisibleText().trim();a&&r.push({id:`email-${n++}`,headers:{from:t.from||"Unknown Sender",to:t.to||[],date:t.date||"",subject:t.subject||""},content:a,type:"current",level:0});const o=s.getFragments();let l="";return o.forEach(c=>{c.isQuoted()&&!c.isSignature()&&!c.isHidden()&&(l+=c.getContent()+`
`)}),l.trim()&&UF(l).forEach((u,d)=>{r.push({id:`email-${n++}`,headers:{from:u.from||"Unknown Sender",to:u.to||[],date:u.date||"",subject:u.subject||t.subject||""},content:u.content,signature:u.signature,type:"quoted",level:d+1})}),r}function UF(e){const t=[];return e.split(/(?=.*(?:wrote:|From:|said:))/i).forEach(n=>{const s=n.trim();if(!s||s.length<20)return;const a={from:"",to:[],date:"",subject:""},o=s.split(`
`);let l=0;for(let m=0;m<Math.min(o.length,10);m++){const h=o[m].trim(),y=h.match(/^From:\s*(.+)$/i)||h.match(/^(.+?)\s+wrote:/i)||h.match(/^(.+?)\s+said:/i);y&&(a.from=y[1].trim(),l=Math.max(l,m+1));const v=h.match(/^(?:Date|Sent|On):\s*(.+)$/i)||h.match(/^On\s+(.+?),\s*.+?\s+wrote:/i);v&&(a.date=v[1].trim(),l=Math.max(l,m+1));const w=h.match(/^To:\s*(.+)$/i);w&&(a.to=w[1].split(/[,;]/).map(b=>b.trim()),l=Math.max(l,m+1));const g=h.match(/^Subject:\s*(.+)$/i);g&&(a.subject=g[1].trim(),l=Math.max(l,m+1))}const c=o.slice(l).join(`
`).replace(/^>+\s*/gm,"").replace(/^\s*$/gm,"").trim(),u=c.match(/^(--\s*$|_{2,}$|-{2,}$)/m);let d=c,f="";if(u){const m=u.index||0;d=c.substring(0,m).trim(),f=c.substring(m).trim()}d&&(a.from||a.date)&&t.push({from:a.from,to:a.to,date:a.date,subject:a.subject,content:d,signature:f||void 0})}),t}const zF=({activity:e})=>{var l;const[t,r]=x.useState({}),n=AF(e.description||"",e.subject);if(!n||!((l=n.content)!=null&&l.emailThread))return i.jsx(WF,{activity:e});const s=n.headers.subject||e.subject||"No Subject",a=n.headers.date||(e.activity_date?kr(new Date(e.activity_date),"MMM d, yyyy h:mm a"):"")||(e.created_at?kr(new Date(e.created_at),"MMM d, yyyy h:mm a"):""),o=c=>{r(u=>({...u,[c]:!u[c]}))};return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"bg-white border rounded-lg shadow-sm",children:[i.jsx("div",{className:"px-4 py-3 border-b bg-gray-50",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(Ad,{className:"w-5 h-5 text-blue-600"}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-medium text-gray-900",children:s}),i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.metadata.isReply&&i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Nb,{className:"w-3 h-3"}),i.jsx("span",{children:"Reply"})]}),n.metadata.isForward&&i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(X$,{className:"w-3 h-3"}),i.jsx("span",{children:"Forward"})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(M6,{className:"w-3 h-3"}),i.jsx("span",{children:"Email"})]})]})]})]}),i.jsx("div",{className:"text-right text-sm text-gray-500",children:a})]})}),i.jsx("div",{className:"px-4 py-3 bg-white",children:i.jsxs("div",{className:"grid grid-cols-1 gap-2 text-sm",children:[n.headers.from&&i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"w-12 text-gray-500 font-medium",children:"From:"}),i.jsx("span",{className:"text-gray-900",children:n.headers.from})]}),n.headers.to.length>0&&i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"w-12 text-gray-500 font-medium",children:"To:"}),i.jsx("span",{className:"text-gray-900",children:n.headers.to.join(", ")})]}),n.headers.cc.length>0&&i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"w-12 text-gray-500 font-medium",children:"CC:"}),i.jsx("span",{className:"text-gray-900",children:n.headers.cc.join(", ")})]})]})})]}),n.content.emailThread.map((c,u)=>{var d;return i.jsxs("div",{className:"bg-white border rounded-lg shadow-sm",children:[i.jsx("div",{className:`px-4 py-3 ${c.type==="current"?"bg-white":"bg-gray-50"} ${u===0?"":"border-b"}`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("div",{className:"flex-1",children:i.jsxs("div",{className:"flex items-center gap-3",children:[c.type==="quoted"&&i.jsx(Nb,{className:"w-4 h-4 text-gray-500"}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"font-medium text-gray-900",children:c.headers.from||"Unknown Sender"}),c.type==="current"&&i.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:"Latest"})]}),c.headers.to.length>0&&i.jsxs("div",{className:"text-sm text-gray-600",children:["to ",c.headers.to.join(", ")]}),c.headers.date&&i.jsx("div",{className:"text-xs text-gray-500",children:c.headers.date})]})]})}),c.type==="quoted"&&i.jsx("button",{onClick:()=>o(c.id),className:"ml-4 p-1 hover:bg-gray-100 rounded",children:t[c.id]?i.jsx(h6,{className:"w-4 h-4 text-gray-500"}):i.jsx(Od,{className:"w-4 h-4 text-gray-500"})})]})}),(c.type==="current"||t[c.id])&&i.jsxs("div",{className:`px-4 py-4 ${c.type==="quoted"?"bg-gray-25 border-l-4 border-gray-200":""}`,children:[Kc(c.content).map((f,m)=>i.jsx("p",{className:`mb-3 last:mb-0 leading-relaxed ${c.type==="current"?"text-gray-700":"text-gray-600 text-sm"}`,children:f},m)),c.signature&&i.jsxs("div",{className:"mt-4 pt-3 border-t border-gray-200",children:[i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Signature"}),Kc(c.signature).map((f,m)=>i.jsx("p",{className:"text-gray-500 text-xs leading-relaxed",children:f},m))]})]}),c.type==="quoted"&&!t[c.id]&&i.jsxs("div",{className:"px-4 py-2 text-sm text-gray-500 bg-gray-50",children:[(d=Kc(c.content)[0])==null?void 0:d.substring(0,100),"..."]})]},c.id)}),i.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-xs text-gray-600",children:[e.sf_id&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Salesforce ID:"})," ",e.sf_id]}),e.created_at&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Logged:"})," ",kr(new Date(e.created_at),"MMM d, yyyy h:mm a")]}),e.owner&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Logged by:"})," ",e.owner.first_name&&e.owner.last_name?`${e.owner.first_name} ${e.owner.last_name}`:e.owner.name]}),e.contact&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Related Contact:"})," ",e.contact.first_name," ",e.contact.last_name]})]})})]})},WF=({activity:e})=>i.jsx("div",{className:"space-y-4",children:i.jsxs("div",{className:"bg-white border rounded-lg shadow-sm",children:[i.jsx("div",{className:"px-4 py-3 border-b bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(Ad,{className:"w-5 h-5 text-blue-600"}),i.jsx("h3",{className:"font-medium text-gray-900",children:e.subject||"Email Content"})]})}),i.jsx("div",{className:"px-4 py-4",children:e.description?Kc(e.description).map((t,r)=>i.jsx("p",{className:"text-gray-700 mb-3 last:mb-0 leading-relaxed",children:t},r)):i.jsx("p",{className:"text-gray-500 italic",children:"No email content available."})})]})}),HF=({activity:e,onActivityUpdate:t,onClose:r})=>{var m,h;const[n,s]=x.useState(!1),a=((m=e.activity_type)==null?void 0:m.name)||e.sf_task_subtype,o=a==="Task"||!a,l=a==="Call",c=["Email","ListEmail"].includes(a||""),u=((h=e.activity_status)==null?void 0:h.is_closed)||e.sf_is_closed||e.completed_call||e.sf_status&&["Completed","Complete","Closed"].includes(e.sf_status),d=()=>{(o||l)&&s(!n)},f=()=>{switch(a){case"Call":return i.jsx(ca,{className:"w-5 h-5 text-blue-600"});case"Email":case"ListEmail":return i.jsx(Ad,{className:"w-5 h-5 text-purple-600"});default:return i.jsx(ml,{className:"w-5 h-5 text-green-600"})}};return i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-4",children:[i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[f(),i.jsxs("div",{children:[i.jsx("h3",{className:"font-medium text-gray-900",children:e.subject||"Untitled Activity"}),i.jsxs("p",{className:"text-sm text-gray-600",children:[a,"  ",u?"Completed":"Open"]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[(o||l)&&i.jsx("button",{onClick:d,className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-white rounded-md transition-colors",title:n?"View mode":"Edit mode",children:n?i.jsx(C6,{className:"w-4 h-4"}):i.jsx($6,{className:"w-4 h-4"})}),i.jsx("button",{onClick:r,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-white rounded-md transition-colors",title:"Close",children:i.jsx(Wk,{className:"w-4 h-4"})})]})]}),n&&o?i.jsx(qF,{activity:e,onSave:y=>{t==null||t(y),s(!1)},onCancel:()=>s(!1)}):n&&l?i.jsx(VF,{activity:e,onSave:y=>{t==null||t(y),s(!1)},onCancel:()=>s(!1)}):c?i.jsx(zF,{activity:e}):i.jsx(YF,{activity:e})]})},qF=({activity:e,onSave:t,onCancel:r})=>{const[n,s]=x.useState(e.subject||""),[a,o]=x.useState(e.description||""),[l,c]=x.useState(e.activity_date?kr(new Date(e.activity_date),"yyyy-MM-dd"):""),u=()=>{const d={...e,subject:n,description:a,activity_date:l||null,updated_at:new Date().toISOString()};t(d)};return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject"}),i.jsx("input",{type:"text",value:n,onChange:d=>s(d.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"Activity subject..."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),i.jsx("textarea",{value:a,onChange:d=>o(d.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"Activity description..."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Due Date"}),i.jsx("input",{type:"date",value:l,onChange:d=>c(d.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{className:"flex gap-2 pt-2",children:[i.jsx("button",{onClick:u,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Save Changes"}),i.jsx("button",{onClick:r,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 focus:ring-2 focus:ring-gray-500 focus:ring-offset-2",children:"Cancel"})]})]})},VF=({activity:e,onSave:t,onCancel:r})=>{const[n,s]=x.useState(e.subject||""),[a,o]=x.useState(e.description||""),[l,c]=x.useState(e.contact?`${e.contact.first_name} ${e.contact.last_name}`.trim():""),[u,d]=x.useState([]),[f,m]=x.useState(!1),[h,y]=x.useState(e.contact_id||""),[v,w]=x.useState(e.is_prospecting_call||!1),[g,b]=x.useState(e.completed_call??!0),[p,_]=x.useState(e.meeting_held||!1),[j,k]=x.useState(e.is_property_prospecting_call||!1),[N,S]=x.useState(e.completed_property_call||!1),[C,E]=x.useState(!1);x.useEffect(()=>{const A=setTimeout(async()=>{if(l.length<2){d([]);return}try{const M=l.trim().split(/\s+/);let B=[];if(M.length===1)B=[`first_name.ilike.%${M[0]}%`,`last_name.ilike.%${M[0]}%`,`company.ilike.%${M[0]}%`];else{for(const W of M)B.push(`first_name.ilike.%${W}%`,`last_name.ilike.%${W}%`,`company.ilike.%${W}%`);B.push(`first_name.ilike.%${l}%`,`last_name.ilike.%${l}%`,`company.ilike.%${l}%`)}const{data:F,error:R}=await $.from("contact").select("id, first_name, last_name, company").or(B.join(",")).limit(50);if(R)throw R;if(!F){d([]);return}const P=l.toLowerCase().trim(),D=P.split(/\s+/),z=F.sort((W,I)=>{const ne=`${W.first_name||""} ${W.last_name||""}`.trim().toLowerCase(),re=`${I.first_name||""} ${I.last_name||""}`.trim().toLowerCase(),Q=(W.first_name||"").toLowerCase(),U=(W.last_name||"").toLowerCase(),J=(I.first_name||"").toLowerCase(),X=(I.last_name||"").toLowerCase();if(ne===P)return-1;if(re===P)return 1;if(D.length>=2){const ue=Q===D[0]&&U===D[1],pe=J===D[0]&&X===D[1];if(ue&&!pe)return-1;if(pe&&!ue)return 1;const De=Q.startsWith(D[0])&&U.startsWith(D[1]),Se=J.startsWith(D[0])&&X.startsWith(D[1]);if(De&&!Se)return-1;if(Se&&!De)return 1}return ne.startsWith(P)&&!re.startsWith(P)?-1:re.startsWith(P)&&!ne.startsWith(P)?1:Q===P&&J!==P?-1:J===P&&Q!==P?1:U===P&&X!==P?-1:X===P&&U!==P?1:Q.startsWith(P)&&!J.startsWith(P)?-1:J.startsWith(P)&&!Q.startsWith(P)?1:U.startsWith(P)&&!X.startsWith(P)?-1:X.startsWith(P)&&!U.startsWith(P)?1:ne.localeCompare(re)});d(z.slice(0,10))}catch(M){console.error("Error searching contacts:",M)}},300);return()=>clearTimeout(A)},[l]);const T=O=>{y(O.id),c(`${O.first_name||""} ${O.last_name||""}`.trim()),m(!1)},L=async()=>{E(!0);try{const O={subject:n,description:a||null,updated_at:new Date().toISOString(),contact_id:h||null,is_prospecting_call:v,completed_call:g,meeting_held:p,is_property_prospecting_call:j,completed_property_call:N},{error:A}=await $.from("activity").update(O).eq("id",e.id);if(A)throw A;const M={...e,...O};t(M)}catch(O){console.error("Error updating call:",O),alert("Failed to update call. Please try again.")}finally{E(!1)}};return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject *"}),i.jsx("input",{type:"text",value:n,onChange:O=>s(O.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"Call subject..."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Comments"}),i.jsx("textarea",{value:a,onChange:O=>o(O.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"Call notes or comments..."})]}),i.jsxs("div",{className:"relative",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Related Contact"}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",value:l,onChange:O=>{c(O.target.value),m(!0)},onFocus:()=>m(!0),className:"w-full px-3 py-2 pl-10 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"Search contacts..."}),i.jsx(Xg,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]}),f&&u.length>0&&i.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:u.map(O=>i.jsx("button",{type:"button",onClick:()=>T(O),className:"w-full px-3 py-2 text-left hover:bg-gray-50 focus:bg-gray-50 focus:outline-none",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-gray-900",children:`${O.first_name||""} ${O.last_name||""}`.trim()}),O.company&&i.jsx("div",{className:"text-sm text-gray-500",children:O.company})]}),h===O.id&&i.jsx(ml,{className:"w-4 h-4 text-blue-600"})]})},O.id))})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Call Details"}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:v,onChange:O=>w(O.target.checked),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Prospect Call"})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:j,onChange:O=>k(O.target.checked),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Property Prospect Call"})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:g,onChange:O=>b(O.target.checked),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Completed Call"})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:N,onChange:O=>S(O.target.checked),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Completed Property Call"})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p,onChange:O=>_(O.target.checked),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Meeting Held"})]})]})]}),i.jsxs("div",{className:"flex gap-2 pt-2",children:[i.jsx("button",{onClick:L,disabled:C,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:ring-2 focus:ring-green-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:C?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Updating..."]}):i.jsxs(i.Fragment,{children:[i.jsx(ca,{className:"w-4 h-4"}),"Update Call"]})}),i.jsx("button",{onClick:r,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 focus:ring-2 focus:ring-gray-500 focus:ring-offset-2",children:"Cancel"})]})]})},YF=({activity:e})=>{var t,r,n;return(t=e.activity_type)!=null&&t.name||e.sf_task_subtype,i.jsxs("div",{className:"space-y-4",children:[e.description&&i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(b6,{className:"w-4 h-4 text-gray-500"}),i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Description"})]}),i.jsx("div",{className:"bg-white p-3 rounded-md border text-sm text-gray-700 whitespace-pre-wrap",children:e.description})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.activity_date&&i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx(bo,{className:"w-4 h-4 text-gray-500 mt-0.5"}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Due Date"}),i.jsx("p",{className:"text-sm text-gray-600",children:kr(new Date(e.activity_date),"MMM d, yyyy")})]})]}),e.contact&&i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx(Vu,{className:"w-4 h-4 text-gray-500 mt-0.5"}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Contact"}),i.jsxs("p",{className:"text-sm text-gray-600",children:[e.contact.first_name," ",e.contact.last_name]}),e.contact.email&&i.jsx("p",{className:"text-sm text-gray-500",children:e.contact.email})]})]}),e.call_duration_seconds&&i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx(qu,{className:"w-4 h-4 text-gray-500 mt-0.5"}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Call Duration"}),i.jsxs("p",{className:"text-sm text-gray-600",children:[Math.floor(e.call_duration_seconds/60),"m ",e.call_duration_seconds%60,"s"]})]})]}),e.call_disposition&&i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx(ca,{className:"w-4 h-4 text-gray-500 mt-0.5"}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Call Outcome"}),i.jsx("p",{className:"text-sm text-gray-600",children:e.call_disposition})]})]}),e.owner&&i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx(Vu,{className:"w-4 h-4 text-gray-500 mt-0.5"}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Assigned To"}),i.jsx("p",{className:"text-sm text-gray-600",children:e.owner.first_name&&e.owner.last_name?`${e.owner.first_name} ${e.owner.last_name}`:e.owner.name})]})]}),(((r=e.activity_task_type)==null?void 0:r.name)||e.sf_task_type)&&i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx(ml,{className:"w-4 h-4 text-gray-500 mt-0.5"}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Task Type"}),i.jsx("p",{className:"text-sm text-gray-600",children:((n=e.activity_task_type)==null?void 0:n.name)||e.sf_task_type})]})]})]}),e.sf_id&&i.jsxs("div",{className:"pt-4 border-t border-gray-200",children:[i.jsxs("p",{className:"text-xs text-gray-500",children:["Salesforce ID: ",e.sf_id]}),e.created_at&&i.jsxs("p",{className:"text-xs text-gray-500",children:["Created: ",kr(new Date(e.created_at),"MMM d, yyyy h:mm a")]})]})]})},GF=(e,t)=>{var o,l;const r=((o=e.activity_status)==null?void 0:o.is_closed)||e.completed_call||e.sf_is_closed,n="w-5 h-5",s=((l=e.activity_type)==null?void 0:l.name)||e.sf_task_subtype,a=(()=>{switch(s){case"Call":return r?i.jsx(gF,{className:`${n} text-green-500`}):i.jsx(ca,{className:`${n} text-blue-500`});case"Email":case"ListEmail":return r?i.jsx(mF,{className:`${n} text-green-500`}):i.jsx(Ad,{className:`${n} text-blue-500`});case"Task":default:return r?i.jsx(Eb,{className:`${n} text-green-500`}):i.jsx(ml,{className:`${n} text-gray-400 hover:text-gray-600`})}})();return(s==="Task"||!s)&&t?i.jsx("button",{onClick:t,className:"flex-shrink-0 p-0.5 rounded-full hover:bg-gray-100 transition-colors group",title:r?"Mark as incomplete":"Mark as complete","aria-label":r?"Mark as incomplete":"Mark as complete",children:r?i.jsx(Eb,{className:`${n} text-green-500 group-hover:text-green-600`}):i.jsx(ml,{className:`${n} text-gray-400 group-hover:text-green-500 transition-colors`})}):a},KF=e=>{const t=e.activity_priority,r=(t==null?void 0:t.is_high_priority)||e.is_high_priority,n=(t==null?void 0:t.name)||(e.is_high_priority?e.sf_task_priority||"High Priority":null);return!r||!n?null:i.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",style:{backgroundColor:t!=null&&t.color?`${t.color}20`:"#FEF2F2"},children:[i.jsx(k6,{className:"w-3 h-3"}),n]})},QF=e=>{const t=e.activity_status,r=(t==null?void 0:t.name)||e.sf_status,n=(t==null?void 0:t.is_closed)||e.sf_is_closed;return r?i.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${n?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,style:{backgroundColor:t!=null&&t.color?`${t.color}20`:n?"#F0FDF4":"#F9FAFB",color:(t==null?void 0:t.color)||(n?"#166534":"#374151")},children:r}):null},JF=e=>{var o,l;const t=((o=e.activity_type)==null?void 0:o.name)||e.sf_task_subtype;if(t!=="Task"&&!t||((l=e.activity_status)==null?void 0:l.is_closed)||e.completed_call||e.sf_is_closed||!e.activity_date)return null;const n=new Date(e.activity_date),s=Wr(new Date),a=Wr(n);return fn(s,a)?i.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",title:`Overdue since ${kr(n,"MMM d, yyyy")}`,children:[i.jsx(qu,{className:"w-3 h-3"}),"Overdue"]}):null},XF=e=>{if(!e)return null;const t=Math.floor(e/60),r=e%60;return t>0?`${t}m ${r}s`:`${e}s`},ZF=({activity:e,onActivityUpdate:t})=>{var m,h,y;const[r,n]=x.useState(!1),[s,a]=x.useState(!1),o=e.activity_date?new Date(e.activity_date):null,l=e.created_at?new Date(e.created_at):null,c=o||l,u=((m=e.activity_type)==null?void 0:m.name)||e.sf_task_subtype,d=()=>{n(!r)},f=async()=>{var v;if(!s){a(!0);try{const w=((v=e.activity_status)==null?void 0:v.is_closed)||e.completed_call||e.sf_is_closed,{data:g}=await $.from("activity_status").select("*").in("name",["Open","Completed"]);if(!g||g.length===0)throw new Error("Could not find Open/Completed statuses");const b=g.find(S=>{var C;return((C=S.name)==null?void 0:C.toLowerCase())==="open"}),p=g.find(S=>{var C;return((C=S.name)==null?void 0:C.toLowerCase())==="completed"}),_=w?b==null?void 0:b.id:p==null?void 0:p.id;if(!_)throw new Error(`Could not find ${w?"Open":"Completed"} status`);const j={status_id:_,updated_at:new Date().toISOString()};w?j.completed_at=null:j.completed_at=new Date().toISOString();const{data:k,error:N}=await $.from("activity").update(j).eq("id",e.id).select(`
          *,
          activity_status!activity_status_id_fkey (
            name,
            color,
            is_closed
          ),
          activity_type!activity_activity_type_id_fkey (
            name,
            color
          ),
          activity_priority!activity_activity_priority_id_fkey (
            name,
            color
          ),
          activity_task_type!activity_activity_task_type_id_fkey (
            name,
            category
          ),
          owner:user!activity_owner_id_fkey (
            first_name,
            last_name,
            email
          ),
          contact!activity_contact_id_fkey (
            first_name,
            last_name,
            company
          )
        `).single();if(N)throw N;t==null||t(k)}catch(w){console.error("Error toggling activity completion:",w),alert("Failed to update task status. Please try again.")}finally{a(!1)}}};return i.jsxs("div",{className:"border-b border-gray-100 last:border-b-0 py-4 first:pt-0 last:pb-0",children:[i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"flex-shrink-0 mt-1",children:GF(e,f)}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[i.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[i.jsx("button",{onClick:d,className:"flex-shrink-0 p-0.5 hover:bg-gray-100 rounded transition-colors","aria-label":r?"Collapse activity":"Expand activity",children:r?i.jsx(Od,{className:"w-4 h-4 text-gray-500"}):i.jsx(Jg,{className:"w-4 h-4 text-gray-500"})}),i.jsx("button",{onClick:d,className:"text-sm font-medium text-gray-900 hover:text-blue-600 transition-colors truncate text-left",children:e.subject||"Untitled Activity"})]}),i.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[JF(e),KF(e),QF(e)]})]}),e.description&&!["Email","ListEmail","Call"].includes(u||"")&&i.jsx("p",{className:"text-sm text-gray-600 mb-2 line-clamp-2",children:e.description}),i.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.contact&&i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Vu,{className:"w-4 h-4"}),i.jsxs("span",{children:["Contact: ",e.contact.first_name," ",e.contact.last_name]})]}),(e.owner||e.updated_by_user)&&i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Vu,{className:"w-4 h-4 text-blue-500"}),i.jsx("span",{className:"font-medium",children:(()=>{if(u==="Call"&&e.updated_by_user){const v=e.updated_by_user;return`Updated by: ${v.first_name&&v.last_name?`${v.first_name} ${v.last_name}`:v.name||"Unknown User"}`}else if(e.owner){const v=e.owner;return`Assigned to: ${v.first_name&&v.last_name?`${v.first_name} ${v.last_name}`:v.name||"Unknown User"}`}return""})()})]}),e.call_duration_seconds&&i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(qu,{className:"w-4 h-4"}),i.jsx("span",{children:XF(e.call_duration_seconds)})]}),(((h=e.activity_task_type)==null?void 0:h.name)||e.sf_task_type)&&i.jsx("div",{className:"flex items-center gap-1",children:i.jsx("span",{className:"font-medium",children:((y=e.activity_task_type)==null?void 0:y.name)||e.sf_task_type})}),(u==="Task"||!u)&&e.activity_date&&i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(qu,{className:"w-4 h-4"}),i.jsxs("span",{className:`font-medium ${(()=>{var p;if(((p=e.activity_status)==null?void 0:p.is_closed)||e.completed_call||e.sf_is_closed)return"text-gray-500";const w=new Date(e.activity_date),g=Wr(new Date),b=Wr(w);return fn(g,b)?"text-red-600":"text-gray-500"})()}`,children:["Due ",kr(new Date(e.activity_date),"MMM d, yyyy")]})]})]}),c&&i.jsx("div",{className:"mt-2 text-xs text-gray-400",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("span",{children:[o&&kr(o,"MMM d, yyyy"),!o&&l&&`Created ${Vy(l,{addSuffix:!0})}`]}),o&&l&&o.getTime()!==l.getTime()&&i.jsxs("span",{children:["Created ",Vy(l,{addSuffix:!0})]})]})})]})]}),r&&i.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:i.jsx(HF,{activity:e,onActivityUpdate:t,onClose:()=>n(!1)})})]})},e7=({isOpen:e,onClose:t,onSave:r,parentObject:n,dealId:s})=>{const{user:a}=lg(),o=n||(s?{id:s,type:"deal",name:""}:null),[l,c]=x.useState({subject:"",owner_id:null,activity_date:new Date().toISOString().split("T")[0],activity_type_id:null,activity_task_type_id:null,activity_priority_id:null,status_id:null,related_object_type:(o==null?void 0:o.type)||"deal",related_object_id:(o==null?void 0:o.id)||null,description:""}),[u,d]=x.useState([]),[f,m]=x.useState([]),[h,y]=x.useState([]),[v,w]=x.useState([]),[g,b]=x.useState([]),[p,_]=x.useState([]),[j,k]=x.useState(""),[N,S]=x.useState(!1),[C,E]=x.useState(null),[T,L]=x.useState(!1),[O,A]=x.useState(!1),[M,B]=x.useState({});x.useEffect(()=>{(async()=>{if(e){L(!0);try{const[z,W,I,ne,re]=await Promise.all([$.from("user").select("id, first_name, last_name, email").order("first_name, last_name"),$.from("activity_type").select("*").eq("active",!0).order("name"),$.from("activity_task_type").select("*").eq("active",!0).order("name"),$.from("activity_priority").select("*").eq("active",!0).order("name"),$.from("activity_status").select("*").eq("active",!0).order("name")]);if(z.data){const Q=z.data.filter(U=>{const J=`${U.first_name||""} ${U.last_name||""}`.toLowerCase().trim();return!["automated process","chatter","insights","platform integration"].some(ue=>J.includes(ue))});if(d(Q),a!=null&&a.email){const U=Q.find(J=>{var X,ue;return((X=J.email)==null?void 0:X.toLowerCase())===((ue=a.email)==null?void 0:ue.toLowerCase())});U&&!l.owner_id&&c(J=>({...J,owner_id:U.id}))}else l.owner_id||c(U=>({...U,owner_id:"d4903827-c034-4acf-8765-2c1c65eac655"}))}if(W.data&&m(W.data),I.data&&y(I.data),ne.data&&w(ne.data),re.data&&b(re.data),W.data){const Q=W.data.find(U=>U.name==="Task");Q&&!l.activity_type_id&&c(U=>({...U,activity_type_id:Q.id}))}if(re.data&&re.data.length>0){const U=re.data.find(J=>{var X;return((X=J.name)==null?void 0:X.toLowerCase())==="open"})||re.data[0];c(J=>({...J,status_id:U.id}))}if(o){let Q=null,U="";switch(o.type){case"deal":Q=(await $.from("deal").select("id, deal_name").eq("id",o.id).single()).data,U="deal_name";break;case"contact":Q=(await $.from("contact").select("id, first_name, last_name, company").eq("id",o.id).single()).data;break;case"client":Q=(await $.from("client").select("id, client_name").eq("id",o.id).single()).data,U="client_name";break;case"property":Q=(await $.from("property").select("id, property_name").eq("id",o.id).single()).data,U="property_name";break;case"site_submit":Q=(await $.from("site_submit").select("id, site_submit_name").eq("id",o.id).single()).data,U="site_submit_name";break}if(Q){let J="";if(o.type==="contact"){const ue=Q;J=`${ue.first_name} ${ue.last_name}`,ue.company&&(J+=` (${ue.company})`)}else J=Q[U];const X={id:Q.id,label:J||o.name,type:o.type};E(X),k(X.label),c(ue=>({...ue,related_object_type:o.type,related_object_id:o.id}))}}}catch(z){console.error("Error loading form data:",z)}finally{L(!1)}}})()},[e]),x.useEffect(()=>{const D=async()=>{if(!l.related_object_type){_([]);return}try{let W,I;switch(l.related_object_type){case"contact":W=$.from("contact").select("id, first_name, last_name, company"),I="first_name";break;case"client":W=$.from("client").select("id, client_name"),I="client_name";break;case"deal":W=$.from("deal").select("id, deal_name"),I="deal_name";break;case"property":W=$.from("property").select("id, property_name"),I="property_name";break;case"site_submit":W=$.from("site_submit").select("id, site_submit_name"),I="site_submit_name";break;default:_([]);return}if(j&&j.length>0)switch(l.related_object_type){case"contact":W=W.or(`first_name.ilike.%${j}%,last_name.ilike.%${j}%,company.ilike.%${j}%`);break;case"client":W=W.ilike("client_name",`%${j}%`);break;case"deal":W=W.ilike("deal_name",`%${j}%`);break;case"property":W=W.ilike("property_name",`%${j}%`);break;case"site_submit":W=W.ilike("site_submit_name",`%${j}%`);break}const{data:ne,error:re}=await W.order(I).limit(20);if(re){console.error("Error loading related options:",re);return}if(ne){const Q=ne.map(U=>{let J;if(l.related_object_type==="contact"){const X=U;J=`${X.first_name} ${X.last_name}`,X.company&&(J+=` (${X.company})`)}else J=U[I];return{id:U.id,label:J,type:l.related_object_type}});_(Q)}}catch(W){console.error("Error loading related options:",W)}},z=setTimeout(()=>{l.related_object_type&&D()},300);return()=>clearTimeout(z)},[l.related_object_type,j]),x.useEffect(()=>{if(!e)c({subject:"",owner_id:null,activity_date:new Date().toISOString().split("T")[0],activity_type_id:null,activity_task_type_id:null,activity_priority_id:null,status_id:null,related_object_type:(o==null?void 0:o.type)||"deal",related_object_id:(o==null?void 0:o.id)||null,description:""}),B({}),k(""),E(null),S(!1);else if(e&&f.length>0){const D=f.find(z=>z.name==="Task");if(D&&!l.activity_type_id&&c(z=>({...z,activity_type_id:D.id})),a!=null&&a.email&&u.length>0&&!l.owner_id){const z=u.find(W=>{var I,ne;return((I=W.email)==null?void 0:I.toLowerCase())===((ne=a.email)==null?void 0:ne.toLowerCase())});z&&c(W=>({...W,owner_id:z.id}))}else!(a!=null&&a.email)&&!l.owner_id&&c(z=>({...z,owner_id:"d4903827-c034-4acf-8765-2c1c65eac655"}))}},[e,o,f,l.activity_type_id]);const F=(D,z)=>{c(W=>({...W,[D]:z})),M[D]&&B(W=>({...W,[D]:""}))};p.filter(D=>D.label.toLowerCase().includes(j.toLowerCase()));const R=()=>{var z;const D={};return(z=l.subject)!=null&&z.trim()||(D.subject="Subject is required"),l.activity_type_id||(D.activity_type_id="Task type is required"),l.status_id||(D.status_id="Status is required"),l.activity_date||(D.activity_date="Due date is required"),B(D),Object.keys(D).length===0},P=async()=>{if(R()){A(!0);try{const D={subject:l.subject,owner_id:l.owner_id,activity_date:l.activity_date,activity_type_id:l.activity_type_id,activity_task_type_id:l.activity_task_type_id,activity_priority_id:l.activity_priority_id,status_id:l.status_id,description:l.description||null,deal_id:(o==null?void 0:o.type)==="deal"?o.id:null};if(l.related_object_type&&l.related_object_id)switch(l.related_object_type){case"contact":D.contact_id=l.related_object_id;break;case"client":D.client_id=l.related_object_id;break;case"deal":D.deal_id=l.related_object_id;break;case"property":D.property_id=l.related_object_id;break;case"site_submit":D.site_submit_id=l.related_object_id;break;case"assignment":D.assignment_id=l.related_object_id;break}console.log("About to insert activity data:",JSON.stringify(D,null,2));const{data:z,error:W}=await $.from("activity").insert(D).select("*").single();if(W)throw W;r==null||r(z),t()}catch(D){console.error("Error saving task:",D),console.error("Full error details:",JSON.stringify(D,null,2)),console.error("Form data that was being saved:",l),console.error("Activity data that was being attempted to save:",JSON.stringify({subject:l.subject,owner_id:l.owner_id,activity_date:l.activity_date,activity_type_id:l.activity_type_id,activity_task_type_id:l.activity_task_type_id,activity_priority_id:l.activity_priority_id,status_id:l.status_id,description:l.description,deal_id:(o==null?void 0:o.type)==="deal"?o.id:null,related_object_type:l.related_object_type,related_object_id:l.related_object_id},null,2)),alert(`Error saving task: ${D instanceof Error?D.message:"Unknown error"}. Check console for details.`)}finally{A(!1)}}};return e?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[60]",onClick:t}),i.jsxs("div",{className:`fixed inset-0 lg:inset-y-0 lg:right-0 lg:left-auto w-full lg:w-[600px] bg-white shadow-xl transform transition-transform duration-300 z-[60] ${e?"translate-x-0":"translate-x-full"} flex flex-col`,children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 bg-white",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Add New Task"}),i.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:i.jsx("svg",{className:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:T?i.jsx("div",{className:"flex items-center justify-center h-32",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Task Details"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject *"}),i.jsx("input",{type:"text",value:l.subject,onChange:D=>F("subject",D.target.value),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${M.subject?"border-red-300":""}`,placeholder:"Enter task subject"}),M.subject&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:M.subject})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assigned To"}),i.jsxs("select",{value:l.owner_id||"",onChange:D=>F("owner_id",D.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",children:[i.jsx("option",{value:"",children:"Select user..."}),u.map(D=>i.jsxs("option",{value:D.id,children:[D.first_name," ",D.last_name]},D.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Due Date *"}),i.jsx("input",{type:"date",value:l.activity_date,onChange:D=>F("activity_date",D.target.value),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${M.activity_date?"border-red-300":""}`}),M.activity_date&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:M.activity_date})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Task Category"}),i.jsxs("select",{value:l.activity_task_type_id||"",onChange:D=>F("activity_task_type_id",D.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",children:[i.jsx("option",{value:"",children:"Select category..."}),h.map(D=>i.jsxs("option",{value:D.id,children:[D.name," ",D.category&&`(${D.category})`]},D.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),i.jsxs("select",{value:l.activity_priority_id||"",onChange:D=>F("activity_priority_id",D.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",children:[i.jsx("option",{value:"",children:"Select priority..."}),v.map(D=>i.jsx("option",{value:D.id,children:D.name},D.id))]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Additional Details"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),i.jsx("textarea",{rows:4,value:l.description,onChange:D=>F("description",D.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"Enter task description..."})]})]})]})}),i.jsx("div",{className:"border-t border-gray-200 p-4 bg-gray-50",children:i.jsxs("div",{className:"flex justify-end space-x-3",children:[i.jsx("button",{type:"button",onClick:t,disabled:O,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:"Cancel"}),i.jsx("button",{type:"button",onClick:P,disabled:O||T,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:O?"Creating...":"Create Task"})]})})]})]}):null},t7=({isOpen:e,onClose:t,onCallLogged:r,parentObject:n,existingActivity:s})=>{const{user:a}=lg(),[o,l]=x.useState({subject:(s==null?void 0:s.subject)||"",comments:(s==null?void 0:s.description)||"",contact_id:(s==null?void 0:s.contact_id)||"",related_object_id:(s==null?void 0:s.deal_id)||(s==null?void 0:s.client_id)||(s==null?void 0:s.property_id)||(s==null?void 0:s.site_submit_id)||(n==null?void 0:n.id)||"",related_object_type:s?s.deal_id?"deal":s.client_id?"client":s.property_id?"property":s.site_submit_id?"site_submit":s.contact_id?"contact":"":(n==null?void 0:n.type)||"",is_prospecting_call:(s==null?void 0:s.is_prospecting_call)||!1,completed_call:(s==null?void 0:s.completed_call)||!1,meeting_held:(s==null?void 0:s.meeting_held)||!1,is_property_prospecting_call:(s==null?void 0:s.is_property_prospecting_call)||!1,completed_property_call:(s==null?void 0:s.completed_property_call)||!1}),[c,u]=x.useState([]),[d,f]=x.useState(""),[m,h]=x.useState(!1),[y,v]=x.useState([]),[w,g]=x.useState(null),[b,p]=x.useState(!1),[_,j]=x.useState({}),[k,N]=x.useState(null);x.useEffect(()=>{const T=setTimeout(async()=>{if(d.length<2){u([]);return}try{const L=d.trim();let O=$.from("contact").select("id, first_name, last_name, company");const A=L.split(/\s+/).filter(R=>R.length>0);if(A.length>=2){const R=A[0],P=A.slice(1).join(" ");O=O.or(`and(first_name.ilike.%${R}%,last_name.ilike.%${P}%),first_name.ilike.%${L}%,last_name.ilike.%${L}%,company.ilike.%${L}%`)}else O=O.or(`first_name.ilike.%${L}%,last_name.ilike.%${L}%,company.ilike.%${L}%`);const{data:M,error:B}=await O.order("last_name").limit(20);if(B)throw B;const F=(M||[]).map(R=>({id:R.id,label:`${R.first_name||""} ${R.last_name||""}`.trim(),type:"contact",company:R.company||void 0}));u(F)}catch(L){console.error("Error searching contacts:",L),u([])}},300);return()=>clearTimeout(T)},[d]),x.useEffect(()=>{(async()=>{if(!(!(n!=null&&n.id)||!n.type))try{let T,L;switch(n.type){case"deal":T=$.from("deal").select("id, deal_name").eq("id",n.id).single(),L="deal_name";break;case"contact":T=$.from("contact").select("id, first_name, last_name, company").eq("id",n.id).single(),L="name";break;case"client":T=$.from("client").select("id, client_name").eq("id",n.id).single(),L="client_name";break;case"property":T=$.from("property").select("id, property_name").eq("id",n.id).single(),L="property_name";break;case"site_submit":T=$.from("site_submit").select("id, site_submit_name").eq("id",n.id).single(),L="site_submit_name";break;default:return}const{data:O,error:A}=await T;if(A||!O)return;let M;n.type==="contact"?M=`${O.first_name||""} ${O.last_name||""}`.trim():M=O[L];const B={id:O.id,label:M||n.name,type:n.type};N(B)}catch(T){console.error("Error fetching parent object data:",T)}})()},[n]),x.useEffect(()=>{if(e){if(l({subject:(s==null?void 0:s.subject)||"",comments:(s==null?void 0:s.description)||"",contact_id:(s==null?void 0:s.contact_id)||"",related_object_id:(s==null?void 0:s.deal_id)||(s==null?void 0:s.client_id)||(s==null?void 0:s.property_id)||(s==null?void 0:s.site_submit_id)||(n==null?void 0:n.id)||"",related_object_type:s?s.deal_id?"deal":s.client_id?"client":s.property_id?"property":s.site_submit_id?"site_submit":s.contact_id?"contact":"":(n==null?void 0:n.type)||"",is_prospecting_call:(s==null?void 0:s.is_prospecting_call)||!1,completed_call:(s==null?void 0:s.completed_call)||!1,meeting_held:(s==null?void 0:s.meeting_held)||!1,is_property_prospecting_call:(s==null?void 0:s.is_property_prospecting_call)||!1,completed_property_call:(s==null?void 0:s.completed_property_call)||!1}),(async()=>{try{const{data:T,error:L}=await $.from("user").select("id, first_name, last_name, email").order("last_name");if(L)throw L;if(T){const O=T.filter(A=>{const M=`${A.first_name||""} ${A.last_name||""}`.toLowerCase().trim();return!["automated process","chatter","insights","platform integration"].some(F=>M.includes(F))});if(v(O),a!=null&&a.email){const A=O.find(M=>{var B,F;return((B=M.email)==null?void 0:B.toLowerCase())===((F=a.email)==null?void 0:F.toLowerCase())});A&&g(A.id)}else g("d4903827-c034-4acf-8765-2c1c65eac655")}}catch(T){console.error("Error loading users:",T)}})(),s!=null&&s.contact){const T=`${s.contact.first_name||""} ${s.contact.last_name||""}`.trim();f(T)}else f("");j({})}},[e,n,s]);const S=async E=>{E.preventDefault();const T={};if(o.subject.trim()||(T.subject="Subject is required"),Object.keys(T).length>0){j(T);return}p(!0);try{if(s){const L={subject:o.subject,description:o.comments||null,updated_at:new Date().toISOString(),contact_id:o.contact_id||null,is_prospecting_call:o.is_prospecting_call,completed_call:o.completed_call,meeting_held:o.meeting_held,is_property_prospecting_call:o.is_property_prospecting_call,completed_property_call:o.completed_property_call},{error:O}=await $.from("activity").update(L).eq("id",s.id);if(O)throw O}else{const{data:L,error:O}=await $.from("activity_type").select("id").eq("name","Call").single();if(O||!L)throw new Error("Could not find Call activity type");const{data:A,error:M}=await $.from("activity_status").select("id").eq("name","Completed").single();if(M||!A)throw new Error("Could not find Completed status");const B={subject:o.subject,description:o.comments||null,activity_type_id:L.id,status_id:A.id,activity_date:new Date().toISOString(),completed_at:new Date().toISOString(),contact_id:o.contact_id||null,owner_id:w,updated_by:w,is_prospecting_call:o.is_prospecting_call,completed_call:o.completed_call,meeting_held:o.meeting_held,is_property_prospecting_call:o.is_property_prospecting_call,completed_property_call:o.completed_property_call};switch(o.related_object_type){case"deal":B.deal_id=o.related_object_id;break;case"contact":B.contact_id||(B.contact_id=o.related_object_id);break;case"client":B.client_id=o.related_object_id;break;case"property":B.property_id=o.related_object_id;break;case"site_submit":B.site_submit_id=o.related_object_id;break;case"assignment":B.assignment_id=o.related_object_id;break;default:B.related_object_type=o.related_object_type,B.related_object_id=o.related_object_id;break}const{error:F}=await $.from("activity").insert([B]);if(F)throw F}r==null||r(),t()}catch(L){console.error("Error logging call:",L),j({general:"Failed to log call. Please try again."})}finally{p(!1)}},C=E=>{l(T=>({...T,contact_id:E.id})),f(E.label),h(!1)};return e?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[60]",onClick:t}),i.jsxs("div",{className:`fixed inset-0 lg:inset-y-0 lg:right-0 lg:left-auto w-full lg:w-[600px] bg-white shadow-xl transform transition-transform duration-300 z-[60] ${e?"translate-x-0":"translate-x-full"} flex flex-col`,children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 bg-white",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ca,{className:"w-5 h-5 text-green-600"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s?"Edit Call":"Log Call"})]}),i.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close modal",children:i.jsx(Wk,{className:"w-5 h-5"})})]}),i.jsx("div",{className:"flex-1 overflow-y-auto",children:i.jsxs("form",{id:"log-call-form",onSubmit:S,className:"p-4 space-y-6",children:[_.general&&i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:i.jsx("p",{className:"text-sm text-red-600",children:_.general})}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"subject",className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject *"}),i.jsx("input",{type:"text",id:"subject",value:o.subject,onChange:E=>l(T=>({...T,subject:E.target.value})),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${_.subject?"border-red-300":"border-gray-300"}`,placeholder:"Enter call subject"}),_.subject&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:_.subject})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"comments",className:"block text-sm font-medium text-gray-700 mb-1",children:"Comments"}),i.jsx("textarea",{id:"comments",value:o.comments,onChange:E=>l(T=>({...T,comments:E.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter call notes or comments"})]}),i.jsxs("div",{className:"relative",children:[i.jsx("label",{htmlFor:"contact",className:"block text-sm font-medium text-gray-700 mb-1",children:"Related Contact"}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",value:d,onChange:E=>{f(E.target.value),h(!0)},onFocus:()=>h(!0),className:"w-full px-3 py-2 pl-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Search contacts..."}),i.jsx(Xg,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]}),m&&c.length>0&&i.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:c.map(E=>i.jsx("button",{type:"button",onClick:()=>C(E),className:"w-full px-3 py-2 text-left hover:bg-gray-50 focus:bg-gray-50 focus:outline-none",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-gray-900",children:E.label}),E.company&&i.jsx("div",{className:"text-sm text-gray-500",children:E.company})]}),o.contact_id===E.id&&i.jsx(o6,{className:"w-4 h-4 text-blue-600"})]})},E.id))})]}),k&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Related To"}),i.jsxs("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded-md",children:[i.jsx("div",{className:"font-medium text-gray-900",children:k.label}),i.jsx("div",{className:"text-sm text-gray-500 capitalize",children:k.type})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Call Details"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:o.is_prospecting_call,onChange:E=>l(T=>({...T,is_prospecting_call:E.target.checked})),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Prospecting Call"})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:o.is_property_prospecting_call,onChange:E=>l(T=>({...T,is_property_prospecting_call:E.target.checked})),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Property Prospecting Call"})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:o.completed_call,onChange:E=>l(T=>({...T,completed_call:E.target.checked})),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Completed Call"})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:o.completed_property_call,onChange:E=>l(T=>({...T,completed_property_call:E.target.checked})),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Completed Property Call"})]}),i.jsxs("label",{className:"flex items-center md:col-span-2",children:[i.jsx("input",{type:"checkbox",checked:o.meeting_held,onChange:E=>l(T=>({...T,meeting_held:E.target.checked})),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Meeting Held"})]})]})]})]})}),i.jsxs("div",{className:"flex justify-end gap-3 p-4 border-t border-gray-200 bg-white",children:[i.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),i.jsx("button",{type:"submit",form:"log-call-form",disabled:b,className:"px-4 py-2 text-sm font-medium text-white bg-green-600 border border-transparent rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:b?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),s?"Updating Call...":"Logging Call..."]}):i.jsxs(i.Fragment,{children:[i.jsx(ca,{className:"w-4 h-4"}),s?"Update Call":"Log Call"]})})]})]})]}):null},tm=({title:e,help:t,children:r})=>i.jsxs("section",{className:"bg-white rounded-md border p-4 mb-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:e}),t&&i.jsx("span",{className:"text-gray-500 text-xs border rounded-full w-4 h-4 inline-flex items-center justify-center",title:t,"aria-label":t,children:"i"})]}),r]}),Il=({config:e})=>{const{parentObject:t,title:r="Activities",showSummary:n=!0,allowAdd:s=!0}=e,{activities:a,loading:o,error:l,refetch:c}=lF(t),[u,d]=x.useState(""),[f,m]=x.useState("all"),[h,y]=x.useState("all"),[v,w]=x.useState(!1),[g,b]=x.useState(!1),p=a.filter(j=>{var k,N,S,C;if(u){const E=u.toLowerCase(),T=(k=j.subject)==null?void 0:k.toLowerCase().includes(E),L=(N=j.description)==null?void 0:N.toLowerCase().includes(E),O=j.contact&&`${j.contact.first_name} ${j.contact.last_name}`.toLowerCase().includes(E);if(!T&&!L&&!O)return!1}if(f!=="all"&&((S=j.activity_type)==null?void 0:S.name)!==f)return!1;if(h!=="all"){const E=((C=j.activity_status)==null?void 0:C.is_closed)||j.sf_is_closed||j.completed_call||j.sf_status&&["Completed","Complete","Closed"].includes(j.sf_status);if(h==="completed"&&!E||h==="open"&&!E)return!1}return!0}),_=[...new Set(a.map(j=>{var k;return(k=j.activity_type)==null?void 0:k.name}).filter(Boolean))];return l?i.jsx(tm,{title:r,children:i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:i.jsx("div",{className:"flex",children:i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error Loading Activities"}),i.jsx("div",{className:"mt-2 text-sm text-red-700",children:i.jsx("p",{children:l})}),i.jsx("div",{className:"mt-4",children:i.jsx("button",{onClick:c,className:"bg-red-100 px-3 py-2 rounded text-sm font-medium text-red-800 hover:bg-red-200",children:"Try Again"})})]})})})}):i.jsxs("div",{className:"space-y-4",children:[n&&i.jsxs(tm,{title:"Activity Summary",help:`Overview of all activities related to this ${t.type}`,children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[i.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(bo,{className:"w-8 h-8 text-blue-600"}),i.jsxs("div",{className:"ml-3",children:[i.jsx("p",{className:"text-sm font-medium text-blue-600",children:"Total Activities"}),i.jsx("p",{className:"text-2xl font-semibold text-blue-900",children:a.length})]})]})}),i.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(bo,{className:"w-8 h-8 text-green-600"}),i.jsxs("div",{className:"ml-3",children:[i.jsx("p",{className:"text-sm font-medium text-green-600",children:"Completed"}),i.jsx("p",{className:"text-2xl font-semibold text-green-900",children:a.filter(j=>{var k;return((k=j.activity_status)==null?void 0:k.is_closed)||j.sf_is_closed||j.completed_call||j.sf_status&&["Completed","Complete","Closed"].includes(j.sf_status)}).length})]})]})}),i.jsx("div",{className:"bg-orange-50 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(bo,{className:"w-8 h-8 text-orange-600"}),i.jsxs("div",{className:"ml-3",children:[i.jsx("p",{className:"text-sm font-medium text-orange-600",children:"Open"}),i.jsx("p",{className:"text-2xl font-semibold text-orange-900",children:a.filter(j=>{var k;return!((k=j.activity_status)!=null&&k.is_closed||j.sf_is_closed||j.completed_call||j.sf_status&&["Completed","Complete","Closed"].includes(j.sf_status))}).length})]})]})})]}),s&&i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{className:"inline-flex items-center gap-2 px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",onClick:()=>w(!0),children:[i.jsx(Sb,{className:"w-4 h-4"}),"Add Activity"]}),i.jsxs("button",{className:"inline-flex items-center gap-2 px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",onClick:()=>b(!0),children:[i.jsx(ca,{className:"w-4 h-4"}),"Log Call"]})]})]}),i.jsxs(tm,{title:`Activity Timeline (${p.length})`,help:`Chronological list of all activities for this ${t.type}`,children:[i.jsxs("div",{className:"mb-4 space-y-3",children:[i.jsxs("div",{className:"relative",children:[i.jsx(Xg,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),i.jsx("input",{type:"text",placeholder:"Search activities...",value:u,onChange:j=>d(j.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(P6,{className:"w-4 h-4 text-gray-400"}),i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Type:"}),i.jsxs("select",{value:f,onChange:j=>m(j.target.value),className:"border border-gray-300 rounded text-sm px-2 py-1 focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"all",children:"All Types"}),_.map(j=>i.jsx("option",{value:j,children:j},j))]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Status:"}),i.jsxs("select",{value:h,onChange:j=>y(j.target.value),className:"border border-gray-300 rounded text-sm px-2 py-1 focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"all",children:"All Status"}),i.jsx("option",{value:"open",children:"Open"}),i.jsx("option",{value:"completed",children:"Completed"})]})]})]})]}),o?i.jsxs("div",{className:"flex items-center justify-center py-8",children:[i.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),i.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"Loading activities..."})]}):p.length===0?i.jsx("div",{className:"text-center py-8",children:a.length===0?i.jsxs("div",{children:[i.jsx(bo,{className:"mx-auto h-12 w-12 text-gray-400"}),i.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No activities"}),i.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:["No activities have been recorded for this ",t.type," yet."]}),s&&i.jsx("div",{className:"mt-6",children:i.jsxs("button",{className:"inline-flex items-center gap-2 px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",onClick:()=>w(!0),children:[i.jsx(Sb,{className:"w-4 h-4"}),"Add First Activity"]})})]}):i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-500",children:"No activities match your current filters."}),i.jsx("button",{onClick:()=>{d(""),m("all"),y("all")},className:"mt-2 text-sm text-blue-600 hover:text-blue-800",children:"Clear filters"})]})}):i.jsx("div",{className:"space-y-0",children:p.map(j=>i.jsx(ZF,{activity:j,onActivityUpdate:k=>{console.log("Activity updated:",k),c()}},j.id))})]}),s&&i.jsx(e7,{isOpen:v,onClose:()=>w(!1),onSave:j=>{console.log("New activity created:",j),c(),w(!1)},parentObject:t}),s&&i.jsx(t7,{isOpen:g,onClose:()=>b(!1),onCallLogged:()=>{console.log("Call logged successfully"),c(),b(!1)},parentObject:t})]})},r7=({dealId:e})=>{const r={parentObject:{id:e,type:"deal",name:""},title:"Activities",showSummary:!0,allowAdd:!0,allowEdit:!0};return i.jsx(Il,{config:r})},n7=({deal:e})=>{const[t,r]=x.useState(null),[n,s]=x.useState(null),[a,o]=x.useState(!0);x.useEffect(()=>{(async()=>{try{if(e.client_id){const{data:f}=await $.from("client").select("id, client_name").eq("id",e.client_id).single();f&&r(f)}if(e.stage_id){const{data:f}=await $.from("deal_stage").select("id, label").eq("id",e.stage_id).single();f&&s(f)}}catch(f){console.error("Error fetching header data:",f)}finally{o(!1)}})()},[e.client_id,e.stage_id]);const l=d=>d==null?"$0":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(d),c=d=>{if(!d)return"Not set";try{return new Date(d).toLocaleDateString("en-US",{month:"numeric",day:"numeric",year:"numeric"})}catch{return"Invalid date"}},u=()=>i.jsxs("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"}),i.jsx("circle",{cx:"4",cy:"4",r:"1",fill:"currentColor"}),i.jsx("circle",{cx:"13",cy:"7",r:"1",fill:"currentColor"}),i.jsx("circle",{cx:"21",cy:"7",r:"1",fill:"currentColor"})]});return a?i.jsx("div",{className:"bg-gradient-to-r from-slate-800 to-slate-700 border-b border-slate-600 text-white px-6 py-4",children:i.jsx("div",{className:"max-w-7xl mx-auto",children:i.jsx("div",{className:"flex items-center space-x-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("div",{className:"w-8 h-8 bg-slate-600 rounded-lg flex items-center justify-center",children:i.jsx(u,{})}),i.jsx("span",{className:"text-sm font-medium text-slate-300",children:"Loading..."})]})})})}):i.jsx("div",{className:"bg-gradient-to-r from-slate-800 to-slate-700 border-b border-slate-600 text-white px-6 py-4",children:i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[i.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-slate-600 rounded-lg",children:[i.jsx(u,{}),i.jsx("span",{className:"text-white text-sm font-medium",children:"Deal"})]}),i.jsx("h1",{className:"text-xl font-bold leading-tight",children:e.deal_name||"Unnamed Deal"})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-slate-300 font-medium mb-1",children:"Account Name"}),i.jsx("div",{className:"text-white",children:(t==null?void 0:t.client_name)||"No Client"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-slate-300 font-medium mb-1",children:"Stage"}),i.jsx("div",{className:"text-white font-semibold",children:(n==null?void 0:n.label)||"No Stage"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-slate-300 font-medium mb-1",children:"Probability"}),i.jsx("div",{className:"text-white font-semibold",children:e.probability!==null?`${e.probability}%`:"0%"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-slate-300 font-medium mb-1",children:"Target Close Date"}),i.jsx("div",{className:"text-white",children:c(e.target_close_date)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-slate-300 font-medium mb-1",children:"Deal Value"}),i.jsx("div",{className:"text-white font-bold text-base",children:l(e.deal_value)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-slate-300 font-medium mb-1",children:"Fee"}),i.jsx("div",{className:"text-emerald-400 font-bold text-base",children:l(e.fee)})]})]})]})})},Tb="kanban_recently_viewed",s7=10,a7=3;function Zg(){const[e,t]=x.useState({deals:[],properties:[],contacts:[],assignments:[],clients:[],site_submits:[]});x.useEffect(()=>{try{const l=localStorage.getItem(Tb);if(l){const c=JSON.parse(l);t(c)}}catch(l){console.error("Error loading recently viewed items:",l)}},[]);const r=x.useCallback(l=>{try{localStorage.setItem(Tb,JSON.stringify(l))}catch(c){console.error("Error saving recently viewed items:",c)}},[]),n=x.useCallback(l=>{const c={...l,viewedAt:new Date().toISOString()};t(u=>{const d=`${l.type}s`,m=(u[d]||[]).filter(v=>v.id!==l.id),h=[c,...m].slice(0,s7),y={...u,[d]:h};return r(y),y})},[r]),s=x.useCallback((l,c=a7)=>{const u=`${l}s`;return(e[u]||[]).slice(0,c)},[e]),a=x.useCallback(()=>{const l={deals:[],properties:[],contacts:[],assignments:[],clients:[],site_submits:[]};t(l),r(l)},[r]),o=x.useCallback(l=>{t(c=>{const u=`${l}s`,d={...c,[u]:[]};return r(d),d})},[r]);return{addRecentItem:n,getRecentItems:s,clearRecentItems:a,clearRecentItemsForType:o,recentItems:e}}function Rl(){const{addRecentItem:e}=Zg();return{trackView:x.useCallback((r,n,s,a)=>{r&&r!=="new"&&s&&e({id:r,type:n,name:s,subtitle:a})},[e])}}function Lb(){const{dealId:e}=Ni(),t=Vr(),[r,n]=x.useState(null),[s,a]=x.useState("overview"),[o,l]=x.useState(!1),{trackView:c}=Rl();console.log("DealDetailsPage - location:",t.pathname,"dealId from params:",e);const u=e||(t.pathname==="/deal/new"?"new":void 0),{contacts:d}=Fk(u&&u!=="new"?u:null);x.useEffect(()=>{const h=async()=>{var w;if(u==="new"){console.log("Creating new blank deal...");const g={id:null,deal_name:"",client_id:null,property_id:null,deal_stage_id:null,sf_broker:"",sf_address:"",sf_close_date:null,sf_contract_date:null,sf_list_date:null,deal_side:null,commission_rate:null,gross_commission:null,net_commission:null,house_percent:40,origination_percent:50,site_percent:25,deal_percent:25,number_of_payments:2,is_active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};console.log("Blank deal created:",g),n(g),l(!0);return}console.log("Fetching existing deal with ID:",u);const{data:y,error:v}=await $.from("deal").select("*").eq("id",u).single();v?console.error("Error fetching deal:",v):y&&(console.log("Existing deal loaded:",y),n(y),l(!1),c(y.id,"deal",y.deal_name||"Unnamed Deal",y.sf_address||((w=y.client)==null?void 0:w.client_name)||void 0))};console.log("DealDetailsPage useEffect - actualDealId:",u,"type:",typeof u),u?(console.log("DealDetailsPage useEffect triggered with actualDealId:",u),u==="new"&&a("overview"),h()):console.log("No actualDealId provided - this should not happen for deal routes")},[u]);const f=h=>{n(h),o&&h.id&&l(!1)},m=async h=>{const y={...r,...h};return n(y),o&&y.id&&l(!1),Promise.resolve()};return console.log("DealDetailsPage render - deal:",r,"dealId:",e,"actualDealId:",u,"isNewDeal:",o),r?i.jsxs(U$,{children:[i.jsxs(z$,{contactCount:d.length,notesCount:0,filesCount:0,activityCount:0,paymentsCount:0,children:[i.jsx(n7,{deal:r}),i.jsxs("div",{className:"p-4 max-w-4xl mx-auto",children:[i.jsx("div",{className:"border-b border-gray-200 mb-6",children:i.jsxs("nav",{className:"-mb-px flex space-x-8",children:[i.jsx("button",{onClick:()=>a("overview"),className:`py-2 px-1 border-b-2 font-medium text-sm ${s==="overview"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Details"}),i.jsx("button",{onClick:()=>a("commission"),className:`py-2 px-1 border-b-2 font-medium text-sm ${s==="commission"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Commission"}),i.jsx("button",{onClick:()=>a("payments"),className:`py-2 px-1 border-b-2 font-medium text-sm ${s==="payments"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Payments"}),i.jsx("button",{onClick:()=>a("activity"),className:`py-2 px-1 border-b-2 font-medium text-sm ${s==="activity"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Activity"})]})}),s==="overview"&&i.jsx($$,{deal:r,onSave:f}),s==="commission"&&i.jsx(i.Fragment,{children:o||!r.id?i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-4",children:i.jsx("div",{className:"flex",children:i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Save Deal First"}),i.jsx("div",{className:"mt-2 text-sm text-yellow-700",children:i.jsx("p",{children:"Please save the deal in the Details tab before managing commission details."})})]})})}):i.jsx(G$,{dealId:r.id,deal:r,onDealUpdate:m,onSwitchToPayments:()=>a("payments")})}),s==="payments"&&i.jsx(i.Fragment,{children:o||!r.id?i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-4",children:i.jsx("div",{className:"flex",children:i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Save Deal First"}),i.jsx("div",{className:"mt-2 text-sm text-yellow-700",children:i.jsx("p",{children:"Please save the deal in the Details tab before managing payments."})})]})})}):i.jsx(oF,{deal:r,onDealUpdate:m})}),s==="activity"&&i.jsx(i.Fragment,{children:o||!r.id?i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-4",children:i.jsx("div",{className:"flex",children:i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Save Deal First"}),i.jsx("div",{className:"mt-2 text-sm text-yellow-700",children:i.jsx("p",{children:"Please save the deal in the Details tab before viewing activities."})})]})})}):i.jsx(r7,{dealId:r.id})})]})]}),e&&e!=="new"&&i.jsx(W$,{dealId:e})]}):i.jsx("div",{className:"p-4",children:u==="new"?"Initializing new deal...":"Loading..."})}const Kk=e=>{const[t,r]=x.useState(null),[n,s]=x.useState(!0),[a,o]=x.useState(null),l=x.useCallback(async()=>{if(!e){r(null),s(!1);return}try{s(!0),o(null);const{data:f,error:m}=await $.from("property").select("*").eq("id",e).single();if(m)throw m;const[h,y,v]=await Promise.all([f.property_type_id?$.from("property_type").select("*").eq("id",f.property_type_id).single():Promise.resolve({data:null,error:null}),f.property_stage_id?$.from("property_stage").select("*").eq("id",f.property_stage_id).single():Promise.resolve({data:null,error:null}),f.property_record_type_id?$.from("property_record_type").select("*").eq("id",f.property_record_type_id).single():Promise.resolve({data:null,error:null})]),w={...f,property_type:h.data||void 0,property_stage:y.data||void 0,property_record_type:v.data||void 0};r(w)}catch(f){console.error("Error fetching property:",f),o(f instanceof Error?f.message:"Failed to fetch property")}finally{s(!1)}},[e]);x.useEffect(()=>{l()},[l]);const c=x.useCallback(async f=>{if(!e)throw new Error("No property ID provided");try{o(null);const m={...f,updated_at:new Date().toISOString()},{data:h,error:y}=await $.from("property").update(m).eq("id",e).select("*").single();if(y)throw y;r(h)}catch(m){throw console.error("Error updating property:",m),o(m instanceof Error?m.message:"Failed to update property"),m}},[e]),u=x.useCallback(async f=>{try{o(null);const{data:m,error:h}=await $.from("property").insert([{...f,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]).select().single();if(h)throw h;return m}catch(m){throw console.error("Error creating property:",m),o(m instanceof Error?m.message:"Failed to create property"),m}},[]),d=x.useCallback(async()=>{await l()},[l]);return{property:t,loading:n,error:a,updateProperty:c,createProperty:u,refreshProperty:d}},i7=e=>{const[t,r]=x.useState(e||{}),[n,s]=x.useState(e||{}),a=x.useCallback(d=>{r(d)},[]),o=x.useCallback((d,f)=>{r(m=>({...m,[d]:f}))},[]),l=x.useCallback(d=>{const f=d||{};r(f),s(f)},[]),c=(()=>{var j,k,N,S;const d={},f=[];(j=t.property_name)!=null&&j.trim()||(d.property_name="Property name is required"),(k=t.address)!=null&&k.trim()||(d.address="Address is required"),(N=t.city)!=null&&N.trim()||(d.city="City is required"),(S=t.state)!=null&&S.trim()||(d.state="State is required");const m=Number(t.asking_lease_price),h=Number(t.asking_purchase_price);m<0&&(d.asking_lease_price="Lease price cannot be negative"),h<0&&(d.asking_purchase_price="Purchase price cannot be negative");const y=Number(t.rent_psf),v=Number(t.nnn_psf);y<0&&(d.rent_psf="Rent PSF cannot be negative"),v<0&&(d.nnn_psf="NNN PSF cannot be negative");const w=Number(t.building_sqft),g=Number(t.available_sqft);w<0&&(d.building_sqft="Building square footage cannot be negative"),g<0&&(d.available_sqft="Available square footage cannot be negative"),g>0&&w>0&&g>w&&f.push("Available square footage exceeds building square footage"),Number(t.traffic_count)<0&&(d.traffic_count="Traffic count cannot be negative");const p=Number(t.latitude),_=Number(t.longitude);return p&&(p<-90||p>90)&&(d.latitude="Latitude must be between -90 and 90"),_&&(_<-180||_>180)&&(d.longitude="Longitude must be between -180 and 180"),t.property_type_id||f.push("Property type is not set"),t.property_stage_id||f.push("Property stage is not set"),t.contact_id||f.push("No contact assigned to this property"),m===0&&h===0&&f.push("No pricing information available"),{isValid:Object.keys(d).length===0,errors:d,warnings:f}})(),u=JSON.stringify(t)!==JSON.stringify(n);return{formData:t,setFormData:a,updateField:o,validation:c,resetForm:l,isDirty:u}},o7=({property:e,isEditing:t,onToggleEdit:r,onBack:n,onGetLocation:s,onCallContact:a})=>{var l;const o=()=>i.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})});return i.jsx("div",{className:"sticky top-0 z-10 bg-gradient-to-r from-slate-800 to-slate-700 border-b border-slate-600 text-white shadow-sm",children:i.jsxs("div",{className:"px-4 sm:px-6 py-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("button",{onClick:n,className:"flex items-center justify-center w-8 h-8 rounded-lg bg-slate-600 hover:bg-slate-500 transition-colors",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),i.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-slate-600 rounded-lg",children:[i.jsx(o,{}),i.jsx("span",{className:"text-white text-sm font-medium",children:"Property"})]})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[s&&i.jsx("button",{onClick:s,className:"flex items-center justify-center w-10 h-10 rounded-lg bg-slate-600 hover:bg-slate-500 transition-colors",title:"Get current location",children:i.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})}),a&&e.contact_id&&i.jsx("button",{onClick:a,className:"flex items-center justify-center w-10 h-10 rounded-lg bg-green-600 hover:bg-green-500 transition-colors",title:"Call contact",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})})]})]}),i.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:i.jsxs("div",{children:[i.jsx("h1",{className:"text-xl font-bold leading-tight mb-2",children:e.property_name||e.address||"Unnamed Property"}),e.address&&e.property_name&&i.jsx("p",{className:"text-slate-300 text-sm",children:e.address})]})}),i.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4 mt-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-slate-300 font-medium mb-1",children:"Type"}),i.jsx("div",{className:"text-white",children:((l=e.property_type)==null?void 0:l.label)||"Not set"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-slate-300 font-medium mb-1",children:"Building Size"}),i.jsx("div",{className:"text-white",children:e.building_sqft?`${e.building_sqft.toLocaleString()} SF`:"Not set"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-slate-300 font-medium mb-1",children:"Available Size"}),i.jsx("div",{className:"text-white",children:e.available_sqft?`${e.available_sqft.toLocaleString()} SF`:"Not set"})]})]})]})})},ta=({label:e,value:t,onChange:r,field:n,placeholder:s,disabled:a=!1,tabIndex:o})=>{const[l,c]=x.useState(!1),[u,d]=x.useState(""),[f,m]=x.useState([]),[h,y]=x.useState(!1),[v,w]=x.useState(-1),[g,b]=x.useState(!1),p=x.useRef(null),_=x.useRef(null),j=t||"",k=async M=>{if(M.trim().length<2){m([]);return}b(!0);try{const{data:B,error:F}=await $.from("property").select(n).not(n,"is",null).ilike(n,`%${M}%`);if(F)throw F;const R={};B==null||B.forEach(D=>{const z=D[n];z&&(R[z]=(R[z]||0)+1)});const P=Object.entries(R).map(([D,z])=>({value:D,count:z})).sort((D,z)=>z.count-D.count).slice(0,8);m(P)}catch(B){console.error("Error fetching suggestions:",B),m([])}finally{b(!1)}};x.useEffect(()=>{if(!l)return;const M=setTimeout(()=>{k(u)},300);return()=>clearTimeout(M)},[u,l,n]);const N=M=>{a||(c(!0),d(M!==void 0?M:t||""),y(!0),w(-1))},S=()=>{a||N()},C=M=>{r((M??u).trim()||null),c(!1),y(!1),m([]),w(-1)},E=()=>{c(!1),y(!1),m([]),d(""),w(-1)},T=M=>{d(M),C(M)},L=M=>{M.key==="Enter"?(M.preventDefault(),v>=0&&f[v]?C(f[v].value):C()):M.key==="Escape"?(M.preventDefault(),E()):M.key==="ArrowDown"?(M.preventDefault(),w(B=>B<f.length-1?B+1:B)):M.key==="ArrowUp"&&(M.preventDefault(),w(B=>B>0?B-1:-1))},O=M=>{const B=M.target.value;d(B),y(!0),w(-1)},A=()=>{setTimeout(()=>{var M;(M=_.current)!=null&&M.contains(document.activeElement)||C()},150)};return l?i.jsxs("div",{className:"relative",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),i.jsx("input",{ref:p,type:"text",value:u,onChange:O,onBlur:A,onKeyDown:L,placeholder:s,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base min-h-[44px]",tabIndex:o,autoFocus:!0}),h&&(f.length>0||g)&&i.jsxs("div",{ref:_,className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-48 overflow-y-auto",children:[g&&i.jsxs("div",{className:"px-3 py-2 text-sm text-gray-500 flex items-center gap-2",children:[i.jsx("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),"Loading suggestions..."]}),!g&&f.map((M,B)=>i.jsxs("button",{type:"button",onMouseDown:F=>{F.preventDefault(),T(M.value)},className:`w-full px-3 py-2 text-left hover:bg-blue-50 flex items-center justify-between ${B===v?"bg-blue-50 text-blue-900":"text-gray-900"}`,children:[i.jsx("span",{className:"truncate",children:M.value}),i.jsxs("span",{className:"text-xs text-gray-500 ml-2 flex-shrink-0",children:[M.count," properties"]})]},M.value)),!g&&f.length===0&&u.trim().length>=2&&i.jsxs("div",{className:"px-3 py-2 text-sm text-gray-500",children:["No matching ",e.toLowerCase()," found"]})]})]}):i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:e}),i.jsx("div",{onClick:()=>N(),onKeyDown:M=>{M.key==="Enter"||M.key===" "?(M.preventDefault(),N()):M.key.length===1&&!M.ctrlKey&&!M.metaKey&&!M.altKey&&(M.preventDefault(),N(M.key))},onFocus:S,tabIndex:o||0,className:`mt-1 px-3 py-2 rounded-md shadow-sm border text-base min-h-[44px] flex items-center transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${a?"bg-gray-100 cursor-not-allowed border-gray-200":"cursor-pointer hover:bg-blue-50 border-transparent hover:border-blue-200 bg-white"}`,title:a?"Not editable":"Click to edit - suggestions will appear as you type",role:"button","aria-label":`Click to edit ${e}`,children:i.jsx("span",{className:t?"text-gray-900":"text-gray-500",children:j})})]})},$e=({label:e,value:t,onChange:r,type:n="text",placeholder:s,disabled:a=!1,multiline:o=!1,rows:l=1,inputMode:c,tabIndex:u,required:d=!1,defaultText:f="Click to add"})=>{const[m,h]=x.useState(!1),[y,v]=x.useState(""),w=t!=null&&t!==""&&t!==0?t:"",g=!t||typeof t=="string"&&t.trim()==="",b=d&&g,p=()=>{a||(h(!0),v((t==null?void 0:t.toString())||""))},_=()=>{a||p()},j=()=>{if(n==="number"){const S=parseFloat(y);r(isNaN(S)?null:S)}else r(y.trim()||null);h(!1)},k=()=>{h(!1),v("")},N=S=>{S.key==="Enter"&&!o?(S.preventDefault(),S.stopPropagation(),j()):S.key==="Escape"&&(S.preventDefault(),S.stopPropagation(),k())};if(m){const S=o?"textarea":"input";return i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),i.jsx(S,{type:o?void 0:n,inputMode:c,value:y,onChange:C=>v(C.target.value),onBlur:j,onKeyDown:N,placeholder:s,rows:o?l:void 0,className:`w-full px-3 py-2 rounded-md shadow-sm text-base min-h-[44px] resize-none ${b?"border-red-300 bg-red-50 focus:ring-red-500 focus:border-red-500":"border-gray-300 bg-white focus:ring-blue-500 focus:border-blue-500"}`,tabIndex:u,autoFocus:!0})]})}return i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:e}),i.jsx("div",{onClick:p,onKeyDown:S=>{S.key==="Enter"||S.key===" "?(S.preventDefault(),p()):S.key.length===1&&!S.ctrlKey&&!S.metaKey&&!S.altKey&&(S.preventDefault(),h(!0),v(S.key))},onFocus:_,tabIndex:u||0,className:`mt-1 px-3 py-2 rounded-md shadow-sm border text-base min-h-[44px] flex items-start transition-colors focus:outline-none focus:ring-2 ${a?"bg-gray-100 cursor-not-allowed border-gray-200":b?"cursor-pointer bg-red-50 border-red-300 hover:bg-red-100 hover:border-red-400 focus:ring-red-500 focus:border-red-500":"cursor-pointer hover:bg-blue-50 border-transparent hover:border-blue-200 bg-white focus:ring-blue-500 focus:border-blue-500"}`,title:a?"Not editable":"Click to edit",role:"button","aria-label":`Click to edit ${e}`,children:i.jsx("span",{className:t?"text-gray-900":b?"text-red-600 font-medium":"text-gray-500",children:o?i.jsx("div",{className:"whitespace-pre-wrap",children:w||(g?f:"")}):w||(g?f:"")})})]})},l7=({property:e,onFieldUpdate:t,onGetCurrentLocation:r})=>{var _,j,k,N,S;const[n,s]=x.useState(!1),[a,o]=x.useState("idle"),[l,c]=x.useState(!1),[u,d]=x.useState(!1),[f,m]=x.useState(!1),h=()=>{const C=e.verified_latitude&&e.verified_longitude,E=e.latitude&&e.longitude;return C?{lat:e.verified_latitude,lng:e.verified_longitude,source:"verified"}:E?{lat:e.latitude,lng:e.longitude,source:"regular"}:null},y=()=>{const C=h();return C?`https://www.google.com/maps?q=${C.lat},${C.lng}`:null},v=async()=>{const C=y();if(C)try{await navigator.clipboard.writeText(C),o("copied"),setTimeout(()=>o("idle"),2e3)}catch(E){console.error("Failed to copy to clipboard:",E),window.open(C,"_blank")}},w=async()=>{if(r)try{s(!0);const C=await r();t("latitude",C.lat),t("longitude",C.lng)}catch(C){console.error("Error getting current location:",C)}finally{s(!1)}},g=()=>{c(!0),setTimeout(()=>c(!1),3e3)},b=()=>{d(!0),setTimeout(()=>d(!1),3e3)},p=()=>{m(!0),setTimeout(()=>m(!1),4e3)};return i.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6 mb-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Location"})]}),r&&i.jsxs("button",{onClick:w,disabled:n,className:"flex items-center gap-2 px-3 py-1.5 bg-blue-50 text-blue-700 rounded-md hover:bg-blue-100 transition-colors text-sm disabled:opacity-50",children:[n?i.jsx("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}):i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})}),"Use Current Location"]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6",children:[i.jsx("div",{className:"sm:col-span-2",children:i.jsx($e,{label:"Street Address*",value:e.address,onChange:C=>t("address",C),placeholder:"123 Main Street",tabIndex:1})}),i.jsx(ta,{label:"City*",value:e.city,onChange:C=>t("city",C),field:"city",placeholder:"San Francisco",tabIndex:2}),i.jsx(ta,{label:"State*",value:e.state,onChange:C=>t("state",C),field:"state",placeholder:"CA",tabIndex:3}),i.jsxs("div",{className:"relative",children:[i.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[i.jsx("span",{className:"block text-sm font-medium text-gray-700",children:"ZIP Code"}),i.jsx("button",{type:"button",onClick:g,className:"text-gray-400 hover:text-gray-600 transition-colors",title:"Click for more info",children:i.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),i.jsx($e,{label:"",value:e.zip,onChange:C=>t("zip",C),placeholder:"94105",tabIndex:4}),l&&i.jsx("div",{className:"absolute top-full left-0 mt-1 w-64 z-10",children:i.jsxs("div",{className:"bg-gray-900 text-white text-xs rounded-lg p-3 shadow-lg relative",children:[i.jsx("div",{className:"absolute bottom-full left-4 w-0 h-0 border-l-4 border-r-4 border-b-4 border-l-transparent border-r-transparent border-b-gray-900"}),i.jsx("div",{className:"font-medium text-blue-200 mb-1",children:" Future Auto-Fill"}),i.jsx("p",{children:"Will auto-populate in the future from Google geocoding services."}),i.jsx("button",{onClick:()=>c(!1),className:"absolute top-1 right-1 text-gray-400 hover:text-white w-4 h-4 flex items-center justify-center",children:""})]})})]}),i.jsxs("div",{className:"relative",children:[i.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[i.jsx("span",{className:"block text-sm font-medium text-gray-700",children:"County"}),i.jsx("button",{type:"button",onClick:b,className:"text-gray-400 hover:text-gray-600 transition-colors",title:"Click for more info",children:i.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),i.jsx(ta,{label:"",value:e.county,onChange:C=>t("county",C),field:"county",placeholder:"San Francisco County",tabIndex:5}),u&&i.jsx("div",{className:"absolute top-full left-0 mt-1 w-64 z-10",children:i.jsxs("div",{className:"bg-gray-900 text-white text-xs rounded-lg p-3 shadow-lg relative",children:[i.jsx("div",{className:"absolute bottom-full left-4 w-0 h-0 border-l-4 border-r-4 border-b-4 border-l-transparent border-r-transparent border-b-gray-900"}),i.jsx("div",{className:"font-medium text-blue-200 mb-1",children:" Future Auto-Fill"}),i.jsx("p",{children:"Will auto-populate in the future from Google geocoding services."}),i.jsx("button",{onClick:()=>d(!1),className:"absolute top-1 right-1 text-gray-400 hover:text-white w-4 h-4 flex items-center justify-center",children:""})]})})]})]}),i.jsxs("div",{className:"border-t border-gray-200 pt-4 mb-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"GPS Coordinates"}),i.jsxs("div",{className:"relative",children:[i.jsxs("button",{type:"button",onClick:p,className:"flex items-center gap-2 px-3 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 text-sm rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-gray-500",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),"Verify Location"]}),f&&i.jsx("div",{className:"absolute bottom-full right-0 mb-2 w-64 z-10",children:i.jsxs("div",{className:"bg-gray-900 text-white text-xs rounded-lg p-3 shadow-lg relative",children:[i.jsx("div",{className:"absolute top-full right-4 w-0 h-0 border-l-4 border-r-4 border-t-4 border-l-transparent border-r-transparent border-t-gray-900"}),i.jsx("div",{className:"font-medium text-yellow-200 mb-1",children:" Future Feature"}),i.jsx("p",{children:"This will take you to a map where you can move the pin to the correct location and recode the address coordinates."}),i.jsx("button",{onClick:()=>m(!1),className:"absolute top-1 right-1 text-gray-400 hover:text-white w-4 h-4 flex items-center justify-center",children:""})]})})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx($e,{label:"Latitude",value:e.latitude,onChange:C=>t("latitude",C),type:"number",placeholder:"37.7749",inputMode:"decimal",tabIndex:6}),i.jsx($e,{label:"Longitude",value:e.longitude,onChange:C=>t("longitude",C),type:"number",placeholder:"-122.4194",inputMode:"decimal",tabIndex:7}),i.jsx($e,{label:"Verified Latitude",value:e.verified_latitude,onChange:C=>t("verified_latitude",C),type:"number",placeholder:"37.7749",inputMode:"decimal",tabIndex:8}),i.jsx($e,{label:"Verified Longitude",value:e.verified_longitude,onChange:C=>t("verified_longitude",C),type:"number",placeholder:"-122.4194",inputMode:"decimal",tabIndex:9})]})]}),h()&&i.jsx("div",{className:"border-t border-gray-200 pt-4",children:i.jsxs("div",{className:"bg-gray-100 rounded-md p-6 text-center",children:[i.jsx("svg",{className:"w-12 h-12 text-gray-400 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),i.jsx("p",{className:"text-sm text-gray-600",children:"Map Preview"}),i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[(j=(_=h())==null?void 0:_.lat)==null?void 0:j.toFixed(6),", ",(N=(k=h())==null?void 0:k.lng)==null?void 0:N.toFixed(6),((S=h())==null?void 0:S.source)==="verified"&&i.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800",children:"Verified"})]}),i.jsxs("div",{className:"mt-3 flex gap-2 justify-center",children:[i.jsxs("button",{className:"flex items-center gap-1 px-3 py-1.5 text-xs text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-md transition-colors",onClick:()=>{const C=y();C&&window.open(C,"_blank")},children:[i.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),"Open in Maps"]}),i.jsx("button",{className:"flex items-center gap-1 px-3 py-1.5 text-xs text-gray-600 hover:text-gray-800 hover:bg-gray-50 rounded-md transition-colors",onClick:v,children:a==="copied"?i.jsxs(i.Fragment,{children:[i.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Copied!"]}):i.jsxs(i.Fragment,{children:[i.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copy Link"]})})]})]})})]})},ts=({label:e,value:t,onChange:r,placeholder:n="0",disabled:s=!1,tabIndex:a,helpText:o,showLarge:l=!1,colorScheme:c="gray"})=>{const[u,d]=x.useState(!1),[f,m]=x.useState(""),[h,y]=x.useState(!1),v=N=>N==null?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(N),w=t!=null?v(t):"Not set",g={green:"text-green-700",blue:"text-blue-700",purple:"text-purple-700",gray:"text-gray-900",orange:"text-orange-700"},b=N=>{s||h||(console.log(`[${e}] Starting edit, current value:`,t,"initialValue:",N),d(!0),y(!1),m(N!==void 0?N:(t==null?void 0:t.toString())||""))},p=()=>{s||b()},_=()=>{if(h)return;y(!0);const N=parseFloat(f.replace(/[^0-9.-]/g,""))||null;console.log(`[${e}] Saving value:`,f,"",N),r(N),d(!1),m(""),setTimeout(()=>y(!1),100)},j=()=>{d(!1),m("")},k=N=>{N.key==="Enter"?(N.preventDefault(),N.stopPropagation(),_()):N.key==="Escape"&&(N.preventDefault(),N.stopPropagation(),j())};return u?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),i.jsx("input",{type:"text",inputMode:"decimal",value:f,onChange:N=>m(N.target.value),onBlur:N=>{setTimeout(()=>{u&&!h&&_()},50)},onKeyDown:k,onFocus:N=>{setTimeout(()=>N.target.select(),0)},placeholder:n,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base min-h-[44px]",tabIndex:a,autoFocus:!0}),o&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:o})]}):i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),i.jsx("div",{onClick:()=>b(),onKeyDown:N=>{N.key==="Enter"||N.key===" "?(N.preventDefault(),b()):N.key.length===1&&!N.ctrlKey&&!N.metaKey&&!N.altKey&&(N.preventDefault(),b(N.key))},onFocus:p,tabIndex:a||0,className:`mt-1 px-3 py-2 rounded-md shadow-sm border ${l?"min-h-[48px]":"min-h-[44px]"} flex items-center transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${s?"bg-gray-100 cursor-not-allowed border-gray-200":"cursor-pointer hover:bg-blue-50 border-transparent hover:border-blue-200 bg-white"}`,title:s?"Not editable":"Click to edit",role:"button","aria-label":`Click to edit ${e}`,children:i.jsx("span",{className:`${t!==null?g[c]:"text-gray-500"} ${l?"text-lg font-semibold":"font-medium"}`,children:w})}),o&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:o})]})},Yu=({label:e,value:t,onChange:r,placeholder:n="0.00",disabled:s=!1,tabIndex:a,helpText:o})=>{const[l,c]=x.useState(!1),[u,d]=x.useState(""),f=b=>b==null?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(b),m=t!=null?`${f(t)} / SF`:"Not set",h=b=>{s||(c(!0),d(b!==void 0?b:(t==null?void 0:t.toString())||""))},y=()=>{s||h()},v=()=>{const b=parseFloat(u.replace(/[^0-9.-]/g,""))||null;r(b),c(!1)},w=()=>{c(!1),d("")},g=b=>{b.key==="Enter"?(b.preventDefault(),b.stopPropagation(),v()):b.key==="Escape"&&(b.preventDefault(),b.stopPropagation(),w())};return l?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),i.jsx("input",{type:"text",inputMode:"decimal",value:u,onChange:b=>d(b.target.value),onBlur:v,onKeyDown:g,onFocus:b=>{setTimeout(()=>b.target.select(),0)},placeholder:n,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base min-h-[44px]",tabIndex:a,autoFocus:!0}),o&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:o})]}):i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),i.jsx("div",{onClick:()=>h(),onKeyDown:b=>{b.key==="Enter"||b.key===" "?(b.preventDefault(),h()):b.key.length===1&&!b.ctrlKey&&!b.metaKey&&!b.altKey&&(b.preventDefault(),h(b.key))},onFocus:y,tabIndex:a||0,className:`mt-1 px-3 py-2 rounded-md shadow-sm border text-base min-h-[44px] flex items-center transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${s?"bg-gray-100 cursor-not-allowed border-gray-200":"cursor-pointer hover:bg-blue-50 border-transparent hover:border-blue-200 bg-white"}`,title:s?"Not editable":"Click to edit",role:"button","aria-label":`Click to edit ${e}`,children:i.jsx("span",{className:`${t!==null?"text-gray-900":"text-gray-500"} font-medium`,children:m})}),o&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:o})]})},c7=({property:e,onFieldUpdate:t})=>{var c,u;const r=((u=(c=e.property_record_type)==null?void 0:c.label)==null?void 0:u.toLowerCase())||"",n=r.includes("land"),s=r.includes("shopping")||r.includes("retail"),a=!n&&!s,o=!n,l=!n;return i.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6 mb-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Financial Information"})]}),a&&i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6",children:i.jsx(ts,{label:"Asking Lease Price",value:e.asking_lease_price,onChange:d=>t("asking_lease_price",d),helpText:"Annual lease amount",showLarge:!0,colorScheme:"green",tabIndex:10})}),o&&i.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Per Square Foot Rates"}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i.jsx(Yu,{label:"Rent PSF",value:e.rent_psf,onChange:d=>t("rent_psf",d),helpText:"Base rent per square foot",tabIndex:12}),i.jsx(Yu,{label:"NNN PSF",value:e.nnn_psf,onChange:d=>t("nnn_psf",d),helpText:"Triple net charges per square foot",tabIndex:13})]}),e.rent_psf&&e.nnn_psf&&e.available_sqft&&i.jsxs("div",{className:"mt-4 p-3 bg-blue-50 rounded-md",children:[i.jsx("div",{className:"text-sm font-medium text-blue-900 mb-1",children:"All-In Rent Calculation"}),i.jsxs("div",{className:"text-lg font-bold text-blue-700",children:["$",(e.rent_psf+e.nnn_psf).toFixed(2)," / SF"]}),i.jsxs("div",{className:"text-sm text-blue-600",children:["Total annual: $",((e.rent_psf+e.nnn_psf)*e.available_sqft).toLocaleString()]})]})]}),l&&i.jsxs("div",{className:"border-t border-gray-200 pt-4 mt-4",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Square Footage"}),s?i.jsx("div",{className:"grid grid-cols-1 gap-4",children:i.jsx($e,{label:"Available Sqft",value:e.available_sqft,onChange:d=>t("available_sqft",d),type:"number",placeholder:"0",tabIndex:14})}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i.jsx($e,{label:"Building Size",value:e.building_sqft,onChange:d=>t("building_sqft",d),type:"number",placeholder:"0",tabIndex:14}),i.jsx($e,{label:"Available Size",value:e.available_sqft,onChange:d=>t("available_sqft",d),type:"number",placeholder:"0",tabIndex:15})]}),e.building_sqft&&e.available_sqft&&i.jsx("div",{className:"mt-3 p-2 bg-gray-50 rounded-md",children:i.jsxs("div",{className:"text-sm text-gray-600",children:["Occupancy: ",((e.building_sqft-e.available_sqft)/e.building_sqft*100).toFixed(1),"% (",(e.building_sqft-e.available_sqft).toLocaleString()," SF occupied)"]})})]})]}),n&&i.jsxs("div",{className:"border-t border-gray-200 pt-4 mt-4",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Land Information"}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[i.jsx(ts,{label:"Asking Purchase Price",value:e.asking_purchase_price,onChange:d=>t("asking_purchase_price",d),showLarge:!0,colorScheme:"blue",tabIndex:16}),i.jsx(ts,{label:"Asking Ground Lease Price",value:e.asking_lease_price,onChange:d=>t("asking_lease_price",d),showLarge:!0,colorScheme:"green",tabIndex:17})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[i.jsx($e,{label:"NNN",value:e.nnn_psf,onChange:d=>t("nnn_psf",d),type:"number",placeholder:"0",tabIndex:18}),i.jsx($e,{label:"Acres",value:e.acres,onChange:d=>t("acres",d),type:"number",placeholder:"0",tabIndex:19})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i.jsx($e,{label:"Building Sqft",value:e.building_sqft,onChange:d=>t("building_sqft",d),type:"number",placeholder:"0",tabIndex:20}),i.jsx($e,{label:"Lease Expiration Date",value:e.lease_expiration_date,onChange:d=>t("lease_expiration_date",d),type:"text",placeholder:"MM/DD/YYYY",tabIndex:21})]})]})]})},Qk=({label:e,value:t,onChange:r,options:n,placeholder:s="Select...",disabled:a=!1,tabIndex:o,required:l=!1,defaultText:c="Not set"})=>{const[u,d]=x.useState(!1),f=n.find(p=>p.id===t),m=(f==null?void 0:f.label)||c,y=l&&!t,v=()=>{a||d(!0)},w=p=>{r(p||null),d(!1)},g=()=>{d(!1)},b=p=>{p.key==="Escape"&&(p.preventDefault(),p.stopPropagation(),g())};return u?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),i.jsxs("select",{value:t||"",onChange:p=>w(p.target.value),onBlur:g,onKeyDown:b,className:`w-full px-3 py-2 rounded-md shadow-sm text-base min-h-[44px] ${y?"border-red-300 bg-red-50 focus:ring-red-500 focus:border-red-500":"border-gray-300 bg-white focus:ring-blue-500 focus:border-blue-500"}`,tabIndex:o,autoFocus:!0,children:[i.jsx("option",{value:"",children:s}),n.map(p=>i.jsx("option",{value:p.id,children:p.label},p.id))]})]}):i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:e}),i.jsx("div",{onClick:v,onKeyDown:p=>{(p.key==="Enter"||p.key===" ")&&(p.preventDefault(),v())},onFocus:v,tabIndex:o||0,className:`mt-1 px-3 py-2 rounded-md shadow-sm border text-base min-h-[44px] flex items-center transition-colors focus:outline-none focus:ring-2 ${a?"bg-gray-100 cursor-not-allowed border-gray-200":y?"cursor-pointer bg-red-50 border-red-300 hover:bg-red-100 hover:border-red-400 focus:ring-red-500 focus:border-red-500":"cursor-pointer hover:bg-blue-50 border-transparent hover:border-blue-200 bg-white focus:ring-blue-500 focus:border-blue-500"}`,title:a?"Not editable":"Click to edit",role:"button","aria-label":`Click to edit ${e}`,children:i.jsx("span",{className:t?"text-gray-900":y?"text-red-600 font-medium":"text-gray-500",children:m})})]})},u7=async e=>{try{const{data:t,error:r}=await $.from("property").select("sf_id").eq("id",e).single();if(r||!(t!=null&&t.sf_id))return console.log("No sf_id found for property:",r==null?void 0:r.message),null;const{data:n,error:s}=await $.from("salesforce_Property__c").select("RecordTypeId").eq("Id",t.sf_id).single();return s?(console.log("RecordTypeId field not found:",s.message),null):(n==null?void 0:n.RecordTypeId)||null}catch(t){return console.log("Error checking for legacy record type:",t),null}},d7=({property:e,isEditing:t,onFieldUpdate:r,propertyRecordTypes:n=[]})=>{const[s,a]=x.useState(!0),[o,l]=x.useState(null);return x.useEffect(()=>{(async()=>{if(e.id&&!e.property_record_type_id){const u=await u7(e.id);console.log(" Legacy RecordTypeId found:",u),l(u)}})()},[e.id,e.property_record_type_id]),i.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6 mb-4",children:[i.jsxs("button",{onClick:()=>a(!s),className:"w-full flex items-center justify-between text-left",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Property Details"})]}),i.jsx("svg",{className:`w-5 h-5 text-gray-400 transform transition-transform ${s?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),s&&i.jsxs("div",{className:"mt-4 space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[i.jsxs("div",{children:[i.jsx(Qk,{label:"Property Record Type",value:e.property_record_type_id,onChange:c=>r("property_record_type_id",c),options:n.map(c=>({id:c.id,label:c.label})),placeholder:n.length===0?"No record types available":"Select record type...",disabled:n.length===0,tabIndex:20}),o&&!e.property_record_type_id&&i.jsxs("div",{className:"mt-1 text-sm text-blue-600 bg-blue-50 px-2 py-1 rounded border border-blue-200",children:["Salesforce RecordTypeId: ",o]})]}),i.jsx($e,{label:"Property Name",value:e.property_name,onChange:c=>r("property_name",c),placeholder:"Property name or identifier",tabIndex:21})]}),i.jsx($e,{label:"Property Description",value:e.description,onChange:c=>r("description",c),placeholder:"Brief description of the property...",multiline:!0,rows:3}),i.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Location Details"}),i.jsx(ta,{label:"Trade Area",value:e.trade_area,onChange:c=>r("trade_area",c),field:"trade_area",placeholder:"Downtown, Suburb, etc."})]})]})]})},f7=({property:e,onFieldUpdate:t})=>{const[r,n]=x.useState(!1);return i.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6 mb-4",children:[i.jsxs("button",{onClick:()=>n(!r),className:"w-full flex items-center justify-between text-left",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Market Analysis"})]}),i.jsx("svg",{className:`w-5 h-5 text-gray-400 transform transition-transform ${r?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),r&&i.jsxs("div",{className:"mt-4 space-y-6",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Traffic Data"}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx($e,{label:"Traffic Count",value:e.traffic_count,onChange:s=>t("traffic_count",s),type:"number",inputMode:"numeric",placeholder:"0"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Daily vehicle count"})]}),i.jsxs("div",{children:[i.jsx($e,{label:"Secondary Traffic Count",value:e.traffic_count_2nd,onChange:s=>t("traffic_count_2nd",s),type:"number",inputMode:"numeric",placeholder:"0"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Secondary road/access point"})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Total Traffic"}),i.jsx("div",{className:"w-full px-3 py-2 bg-gray-50 border border-gray-200 rounded-md text-base min-h-[44px] flex items-center",children:i.jsx("span",{className:"text-gray-900 font-medium",children:((e.traffic_count||0)+(e.traffic_count_2nd||0)).toLocaleString()})})]}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Calculated total (vehicles/day)"})]})]})]}),i.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Demographics"}),i.jsxs("div",{className:"space-y-4",children:[i.jsx($e,{label:"Demographic Information",value:e.demographics,onChange:s=>t("demographics",s),placeholder:"Population, income levels, age groups, household composition, etc.",multiline:!0,rows:4}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[i.jsx($e,{label:"1 Mile Population",value:e["1_mile_pop"],onChange:s=>t("1_mile_pop",s),type:"number",inputMode:"numeric",placeholder:"Enter population count"}),i.jsx($e,{label:"HH Income - Median 3 Mile",value:e.hh_income_median_3_mile,onChange:s=>t("hh_income_median_3_mile",s),type:"number",inputMode:"numeric",placeholder:"Enter median income"}),i.jsx($e,{label:"3 Mile Population",value:e["3_mile_pop"],onChange:s=>t("3_mile_pop",s),type:"number",inputMode:"numeric",placeholder:"Enter population count"})]})]})]})]})]})},m7=({property:e,isEditing:t,onFieldUpdate:r})=>{const n=[{key:"costar_link",label:"CoStar",description:"Commercial real estate database",icon:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),color:"blue"},{key:"reonomy_link",label:"Reonomy",description:"Property intelligence platform",icon:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),color:"purple"},{key:"tax_url",label:"Tax Records",description:"Property tax information",icon:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),color:"green"},{key:"map_link",label:"Map View",description:"Interactive map link",icon:i.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),color:"orange"}],s=(o,l)=>{const c={blue:l?"bg-blue-600 hover:bg-blue-700 text-white border-blue-600":"bg-blue-50 text-blue-600 border-blue-200 hover:bg-blue-100",purple:l?"bg-purple-600 hover:bg-purple-700 text-white border-purple-600":"bg-purple-50 text-purple-600 border-purple-200 hover:bg-purple-100",green:l?"bg-green-600 hover:bg-green-700 text-white border-green-600":"bg-green-50 text-green-600 border-green-200 hover:bg-green-100",orange:l?"bg-orange-600 hover:bg-orange-700 text-white border-orange-600":"bg-orange-50 text-orange-600 border-orange-200 hover:bg-orange-100"};return c[o]||c.blue},a=o=>{try{return new URL(o),!0}catch{return!1}};return i.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6 mb-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"External Links"})]}),t?i.jsx("div",{className:"space-y-4",children:n.map(o=>i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:o.label}),i.jsx("input",{type:"url",value:e[o.key]||"",onChange:l=>r(o.key,l.target.value),placeholder:`https://example.com/${o.label.toLowerCase()}-link`,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base min-h-[44px]"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:o.description})]},o.key))}):i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:n.map(o=>{const l=e[o.key],c=l&&l.trim()!=="",u=c&&a(l);return i.jsx("button",{onClick:()=>{c&&u&&window.open(l,"_blank","noopener,noreferrer")},disabled:!c||!u,className:`w-full p-3 border rounded-lg text-left transition-colors disabled:opacity-50 disabled:cursor-not-allowed ${s(o.color,c&&u)}`,children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"flex-shrink-0",children:o.icon}),i.jsxs("div",{className:"flex-grow min-w-0",children:[i.jsx("div",{className:"font-medium text-sm",children:o.label}),i.jsx("div",{className:`text-xs opacity-75 truncate ${c&&u?"text-current":"text-gray-500"}`,children:c?u?"Click to open":"Invalid URL":o.description})]}),c&&u&&i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})})]})},o.key)})}),t&&i.jsxs("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[i.jsx("div",{className:"text-sm font-medium text-blue-900 mb-2",children:"Quick Actions"}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx("button",{onClick:()=>{if(e.latitude&&e.longitude){const o=`https://www.google.com/maps?q=${e.latitude},${e.longitude}`;r("map_link",o)}},disabled:!e.latitude||!e.longitude,className:"px-3 py-1.5 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:"Generate Map Link"}),i.jsx("button",{onClick:()=>{if(e.address&&e.city&&e.state){const l=`https://www.costar.com/search?q=${encodeURIComponent(`${e.address} ${e.city} ${e.state}`)}`;r("costar_link",l)}},disabled:!e.address||!e.city||!e.state,className:"px-3 py-1.5 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:"Generate CoStar Search"})]}),i.jsx("p",{className:"text-xs text-blue-700 mt-2",children:"Quick generation requires property address and coordinates to be set."})]})]})},h7=({property:e,isEditing:t,onFieldUpdate:r})=>{const[n,s]=x.useState(e.property_notes||""),[a,o]=x.useState(null),[l,c]=x.useState(!1),u=x.useRef(null),d=x.useRef(),f=()=>{u.current&&(u.current.style.height="auto",u.current.style.height=u.current.scrollHeight+"px")};x.useEffect(()=>{f()},[n,t]);const m=y=>{s(y),t&&(d.current&&clearTimeout(d.current),d.current=setTimeout(async()=>{try{c(!0),await r("property_notes",y),o(new Date)}catch(v){console.error("Auto-save failed:",v)}finally{c(!1)}},1e3))};x.useEffect(()=>()=>{d.current&&clearTimeout(d.current)},[]);const h=y=>{const w=new Date().getTime()-y.getTime(),g=Math.floor(w/6e4);return g<1?"just now":g===1?"1 minute ago":g<60?`${g} minutes ago`:y.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})};return i.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Property Notes"})]}),t&&i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[l&&i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),i.jsx("span",{children:"Saving..."})]}),!l&&a&&i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("svg",{className:"w-4 h-4 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),i.jsxs("span",{children:["Saved ",h(a)]})]})]})]}),t?i.jsxs("div",{className:"space-y-3",children:[i.jsx("textarea",{ref:u,value:n,onChange:y=>m(y.target.value),placeholder:"Add notes about this property, market conditions, tenant information, lease details, or any other relevant information...",className:"w-full px-3 py-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base resize-none overflow-hidden min-h-[120px]",style:{maxHeight:"400px"}}),i.jsxs("div",{className:"flex justify-between items-center text-xs text-gray-500",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("span",{children:[n.length," characters"]}),i.jsxs("div",{className:"hidden sm:flex items-center gap-2",children:[i.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-100 border rounded text-xs",children:"Cmd+S"}),i.jsx("span",{children:"to save manually"})]})]}),i.jsx("div",{className:"text-right",children:"Auto-saves after 1 second"})]}),i.jsxs("div",{className:"border-t border-gray-200 pt-3",children:[i.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Quick Templates"}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx("button",{onClick:()=>{const y=`Property visit completed on [DATE]
- Condition: 
- Tenant activity: 
- Market comparison: 
- Next steps: `;m(n+(n?`

`:"")+y)},className:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs hover:bg-gray-200",children:"Site Visit"}),i.jsx("button",{onClick:()=>{const y=`Market analysis as of [DATE]
- Comparable properties: 
- Pricing trends: 
- Occupancy rates: 
- Notable developments: `;m(n+(n?`

`:"")+y)},className:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs hover:bg-gray-200",children:"Market Update"}),i.jsx("button",{onClick:()=>{const y=`Contact follow-up [DATE]
- Person contacted: 
- Response: 
- Action items: 
- Next contact date: `;m(n+(n?`

`:"")+y)},className:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs hover:bg-gray-200",children:"Follow-up"})]})]})]}):i.jsx("div",{children:n?i.jsx("div",{className:"prose prose-sm max-w-none",children:i.jsx("div",{className:"whitespace-pre-wrap text-gray-700 leading-relaxed",children:n})}):i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx("svg",{className:"w-12 h-12 mx-auto mb-3 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),i.jsx("p",{className:"text-sm",children:"No notes added yet"}),i.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Click Edit to add property notes"})]})}),t&&i.jsx("div",{className:"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded-md",children:i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsxs("svg",{className:"w-5 h-5 text-yellow-600 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 18.5a5.5 5.5 0 100-11 5.5 5.5 0 000 11z"}),i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 2a10 10 0 100 20 10 10 0 000-20z"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-medium text-yellow-800",children:"Voice-to-Text Coming Soon"}),i.jsx("div",{className:"text-xs text-yellow-700 mt-1",children:"Future enhancement will allow voice dictation for faster note-taking during property visits."})]})]})})]})},e0=({isOpen:e,onClose:t,onSave:r,onUpdate:n,siteSubmitId:s,propertyId:a,assignmentId:o,propertyUnitId:l})=>{const[c,u]=x.useState({site_submit_name:"",client_id:null,property_id:a||null,property_unit_id:l||null,assignment_id:null,submit_stage_id:null,date_submitted:new Date().toISOString().split("T")[0],loi_written:!1,loi_date:"",delivery_date:"",delivery_timeframe:"",notes:"",customer_comments:"",competitor_data:"",record_type_id:null,verified_latitude:null,verified_longitude:null,year_1_rent:null,ti:null}),[d,f]=x.useState([]),[m,h]=x.useState([]),[y,v]=x.useState(!1),[w,g]=x.useState(!1),[b,p]=x.useState({}),[_,j]=x.useState(""),[k,N]=x.useState(!1);x.useEffect(()=>{e&&(async()=>{var O,A,M;v(!0);try{const[B,F]=await Promise.all([$.from("client").select("*").order("client_name"),$.from("submit_stage").select("*").order("name")]);if(B.data&&f(B.data),F.data&&h(F.data),a){const{data:R}=await $.from("property").select("property_name").eq("id",a).single();R!=null&&R.property_name&&j(R.property_name)}if(o&&!s){const{data:R}=await $.from("assignment").select("client_id, deal_id").eq("id",o).single();R&&u(P=>({...P,client_id:R.client_id,assignment_id:o}))}if(s){const{data:R,error:P}=await $.from("site_submit").select("*").eq("id",s).single();P?console.error("Error loading site submit:",P):R&&(u({site_submit_name:R.site_submit_name||"",client_id:R.client_id,property_id:R.property_id,property_unit_id:R.property_unit_id,assignment_id:R.assignment_id,submit_stage_id:R.submit_stage_id,date_submitted:((O=R.date_submitted)==null?void 0:O.split("T")[0])||new Date().toISOString().split("T")[0],loi_written:R.loi_written||!1,loi_date:((A=R.loi_date)==null?void 0:A.split("T")[0])||"",delivery_date:((M=R.delivery_date)==null?void 0:M.split("T")[0])||"",delivery_timeframe:R.delivery_timeframe||"",notes:R.notes||"",customer_comments:R.customer_comments||"",competitor_data:R.competitor_data||"",record_type_id:R.record_type_id,verified_latitude:R.verified_latitude,verified_longitude:R.verified_longitude,year_1_rent:R.year_1_rent,ti:R.ti}),N(!0))}}catch(B){console.error("Error loading form data:",B)}finally{v(!1)}})()},[e,s,o]),x.useEffect(()=>{e||(u({site_submit_name:"",client_id:null,property_id:a||null,property_unit_id:l||null,assignment_id:o||null,submit_stage_id:null,date_submitted:new Date().toISOString().split("T")[0],loi_written:!1,loi_date:"",delivery_date:"",delivery_timeframe:"",notes:"",customer_comments:"",competitor_data:"",record_type_id:null,verified_latitude:null,verified_longitude:null,year_1_rent:null,ti:null}),p({}),N(!1),j(""))},[e,a,l]);const S=(L,O)=>{if(!L||!O)return"";const A=d.find(M=>M.id===L);return A?`${A.client_name} - ${O}`:""},C=(L,O)=>{if(u(A=>({...A,[L]:O})),b[L]&&p(A=>({...A,[L]:""})),L==="client_id"&&!k&&_){const A=S(O,_);A&&u(M=>({...M,site_submit_name:A}))}L==="property_id"&&!k&&c.client_id&&O&&$.from("property").select("property_name").eq("id",O).single().then(({data:A})=>{if(A!=null&&A.property_name){j(A.property_name);const M=S(c.client_id,A.property_name);M&&u(B=>({...B,site_submit_name:M}))}}),L==="site_submit_name"&&N(!0)},E=()=>{var O;const L={};return(O=c.site_submit_name)!=null&&O.trim()||(L.site_submit_name="Site submit name is required"),c.client_id||(L.client_id="Client selection is required"),!c.property_id&&!o&&(L.property_id="Property selection is required"),p(L),Object.keys(L).length===0},T=async()=>{if(E()){g(!0);try{if(s){const L={...c,date_submitted:c.date_submitted||null,loi_date:c.loi_date||null,delivery_date:c.delivery_date||null,updated_at:new Date().toISOString()},{data:O,error:A}=await $.from("site_submit").update(L).eq("id",s).select(`
            *,
            submit_stage!site_submit_submit_stage_id_fkey (
              name
            ),
            client!client_id (
              client_name
            )
          `).single();if(A)throw A;n==null||n(O)}else{const L={...c,date_submitted:c.date_submitted||null,loi_date:c.loi_date||null,delivery_date:c.delivery_date||null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};console.log("About to insert site submit data:",L),console.log("Form validation passed. FormData:",c);const{data:O,error:A}=await $.from("site_submit").insert(L).select(`
            *,
            submit_stage!site_submit_submit_stage_id_fkey (
              name
            ),
            client!client_id (
              client_name
            )
          `).single();if(A)throw A;r==null||r(O)}t()}catch(L){console.error("Error saving site submit:",L),console.error("Full error object:",JSON.stringify(L,null,2)),L instanceof Error&&console.error("Error message:",L.message),console.log("Attempted to save data:",s?"UPDATE":"CREATE"),console.log("Form data:",c),alert(`Error saving site submit: ${L instanceof Error?L.message:"Unknown error"}. Please check the console for details.`)}finally{g(!1)}}};return e?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[60]",onClick:t}),i.jsxs("div",{className:`fixed inset-0 lg:inset-y-0 lg:right-0 lg:left-auto w-full lg:w-[700px] bg-white shadow-xl transform transition-transform duration-300 z-[60] ${e?"translate-x-0":"translate-x-full"} flex flex-col`,children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 bg-white",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:s?"Edit Site Submit":"New Site Submit"}),i.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:i.jsx("svg",{className:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:y?i.jsx("div",{className:"flex items-center justify-center h-32",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Basic Information"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Site Submit Name *"}),i.jsx("input",{type:"text",value:c.site_submit_name,onChange:L=>C("site_submit_name",L.target.value),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${b.site_submit_name?"border-red-300":""}`,placeholder:"Enter site submit name"}),b.site_submit_name&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:b.site_submit_name})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client *"}),i.jsxs("select",{value:c.client_id||"",onChange:L=>C("client_id",L.target.value||null),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${b.client_id?"border-red-300":""}`,children:[i.jsx("option",{value:"",children:"Select a client..."}),d.map(L=>i.jsx("option",{value:L.id,children:L.client_name},L.id))]}),b.client_id&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:b.client_id})]}),i.jsx(Kg,{value:c.property_id,onChange:L=>C("property_id",L),label:"Property *"}),b.property_id&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:b.property_id}),c.property_id&&i.jsx(Gg,{propertyId:c.property_id,value:c.property_unit_id,onChange:L=>C("property_unit_id",L),label:"Property Unit (Optional)"})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Submission Details"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Submit Stage"}),i.jsxs("select",{value:c.submit_stage_id||"",onChange:L=>C("submit_stage_id",L.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",children:[i.jsx("option",{value:"",children:"Select stage..."}),m.map(L=>i.jsx("option",{value:L.id,children:L.name},L.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date Submitted"}),i.jsx("input",{type:"date",value:c.date_submitted,onChange:L=>C("date_submitted",L.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm"})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("input",{type:"checkbox",id:"loi_written",checked:c.loi_written,onChange:L=>C("loi_written",L.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),i.jsx("label",{htmlFor:"loi_written",className:"text-sm font-medium text-gray-700",children:"LOI Written"})]}),c.loi_written&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"LOI Date"}),i.jsx("input",{type:"date",value:c.loi_date,onChange:L=>C("loi_date",L.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Delivery Date"}),i.jsx("input",{type:"date",value:c.delivery_date,onChange:L=>C("delivery_date",L.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Delivery Timeframe"}),i.jsx("input",{type:"text",value:c.delivery_timeframe,onChange:L=>C("delivery_timeframe",L.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"e.g., 30-60 days, Q1 2024"})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Financial Information"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year 1 Rent ($)"}),i.jsx("input",{type:"number",step:"0.01",value:c.year_1_rent||"",onChange:L=>C("year_1_rent",L.target.value?parseFloat(L.target.value):null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"TI ($)"}),i.jsx("input",{type:"number",step:"0.01",value:c.ti||"",onChange:L=>C("ti",L.target.value?parseFloat(L.target.value):null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"0.00"})]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Location Verification"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Verified Latitude"}),i.jsx("input",{type:"number",step:"any",value:c.verified_latitude||"",onChange:L=>C("verified_latitude",L.target.value?parseFloat(L.target.value):null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"e.g., 40.7128"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Verified Longitude"}),i.jsx("input",{type:"number",step:"any",value:c.verified_longitude||"",onChange:L=>C("verified_longitude",L.target.value?parseFloat(L.target.value):null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"e.g., -74.0060"})]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Notes & Comments"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),i.jsx("textarea",{rows:3,value:c.notes,onChange:L=>C("notes",L.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"Internal notes..."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer Comments"}),i.jsx("textarea",{rows:3,value:c.customer_comments,onChange:L=>C("customer_comments",L.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"Customer feedback or requirements..."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Competitor Data"}),i.jsx("textarea",{rows:3,value:c.competitor_data,onChange:L=>C("competitor_data",L.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"Competitive landscape information..."})]})]})]})}),i.jsx("div",{className:"border-t border-gray-200 p-4 bg-gray-50",children:i.jsxs("div",{className:"flex justify-end space-x-3",children:[i.jsx("button",{type:"button",onClick:t,disabled:w,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:"Cancel"}),i.jsx("button",{type:"button",onClick:T,disabled:w||y,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:w?"Saving...":"Save Site Submit"})]})})]})]}):null},Jk=({isOpen:e,onClose:t,onSave:r,onUpdate:n,contactId:s,propertyId:a})=>{const[o,l]=x.useState({first_name:"",last_name:"",email:null,phone:null,mobile_phone:null,title:null,company:null,client_id:null,source_type:"Contact",mailing_street:null,mailing_city:null,mailing_state:null,mailing_zip:null,mailing_country:null,website:null,linked_in_profile_link:null,icsc_profile_link:null,linked_in_connection:!1,is_site_selector:!1,tenant_repped:!1,tenant_rep_contact_id:null,contact_tags:null}),[c,u]=x.useState([]),[d,f]=x.useState([]),[m,h]=x.useState(!1),[y,v]=x.useState(!1),[w,g]=x.useState({}),b=["Contact","Lead"],p=["AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"];x.useEffect(()=>{e&&(async()=>{h(!0);try{const[S,C]=await Promise.all([$.from("client").select("*").order("client_name"),$.from("contact").select("id, first_name, last_name, company").order("last_name, first_name")]);if(S.data&&u(S.data),C.data&&f(C.data),s){const{data:E,error:T}=await $.from("contact").select("*").eq("id",s).single();T?console.error("Error loading contact:",T):E&&l({first_name:E.first_name||"",last_name:E.last_name||"",email:E.email,phone:E.phone,mobile_phone:E.mobile_phone,title:E.title,company:E.company,client_id:E.client_id,source_type:E.source_type,mailing_street:E.mailing_street,mailing_city:E.mailing_city,mailing_state:E.mailing_state,mailing_zip:E.mailing_zip,mailing_country:E.mailing_country,website:E.website,linked_in_profile_link:E.linked_in_profile_link,icsc_profile_link:E.icsc_profile_link,linked_in_connection:E.linked_in_connection||!1,is_site_selector:E.is_site_selector||!1,tenant_repped:E.tenant_repped||!1,tenant_rep_contact_id:E.tenant_rep_contact_id,contact_tags:E.contact_tags})}}catch(S){console.error("Error loading form data:",S)}finally{h(!1)}})()},[e,s]),x.useEffect(()=>{e||(l({first_name:"",last_name:"",email:null,phone:null,mobile_phone:null,title:null,company:null,client_id:null,source_type:"Contact",mailing_street:null,mailing_city:null,mailing_state:null,mailing_zip:null,mailing_country:null,website:null,linked_in_profile_link:null,icsc_profile_link:null,linked_in_connection:!1,is_site_selector:!1,tenant_repped:!1,tenant_rep_contact_id:null,contact_tags:null}),g({}))},[e]);const _=(N,S)=>{l(C=>({...C,[N]:S})),w[N]&&g(C=>({...C,[N]:""}))},j=()=>{var S,C,E;const N={};return(S=o.first_name)!=null&&S.trim()||(N.first_name="First name is required"),(C=o.last_name)!=null&&C.trim()||(N.last_name="Last name is required"),(E=o.source_type)!=null&&E.trim()||(N.source_type="Source type is required"),o.email&&!/\S+@\S+\.\S+/.test(o.email)&&(N.email="Please enter a valid email address"),g(N),Object.keys(N).length===0},k=async()=>{if(j()){v(!0);try{if(s){const N={...o,updated_at:new Date().toISOString()},{data:S,error:C}=await $.from("contact").update(N).eq("id",s).select().single();if(C)throw C;n==null||n(S)}else{const N={...o,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{data:S,error:C}=await $.from("contact").insert(N).select().single();if(C)throw C;a&&S&&await $.from("property_contact").insert({property_id:a,contact_id:S.id}),r==null||r(S)}t()}catch(N){console.error("Error saving contact:",N),alert(`Error saving contact: ${N instanceof Error?N.message:"Unknown error"}. Please check the console for details.`)}finally{v(!1)}}};return e?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[60]",onClick:t}),i.jsxs("div",{className:`fixed inset-0 lg:inset-y-0 lg:right-0 lg:left-auto w-full lg:w-[800px] bg-white shadow-xl transform transition-transform duration-300 z-[60] ${e?"translate-x-0":"translate-x-full"} flex flex-col`,children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 bg-white",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:s?"Edit Contact":"New Contact"}),i.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:i.jsx("svg",{className:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:m?i.jsx("div",{className:"flex items-center justify-center h-32",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Basic Information"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name *"}),i.jsx("input",{type:"text",value:o.first_name,onChange:N=>_("first_name",N.target.value),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${w.first_name?"border-red-300":""}`,placeholder:"Enter first name"}),w.first_name&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:w.first_name})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name *"}),i.jsx("input",{type:"text",value:o.last_name,onChange:N=>_("last_name",N.target.value),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${w.last_name?"border-red-300":""}`,placeholder:"Enter last name"}),w.last_name&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:w.last_name})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),i.jsx("input",{type:"text",value:o.title||"",onChange:N=>_("title",N.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"Job title"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company"}),i.jsx("input",{type:"text",value:o.company||"",onChange:N=>_("company",N.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"Company name"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client"}),i.jsxs("select",{value:o.client_id||"",onChange:N=>_("client_id",N.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",children:[i.jsx("option",{value:"",children:"Select a client..."}),c.map(N=>i.jsx("option",{value:N.id,children:N.client_name},N.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Source Type *"}),i.jsxs("select",{value:o.source_type,onChange:N=>_("source_type",N.target.value),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${w.source_type?"border-red-300":""}`,children:[i.jsx("option",{value:"",children:"Select source..."}),b.map(N=>i.jsx("option",{value:N,children:N},N))]}),w.source_type&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:w.source_type})]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Contact Information"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),i.jsx("input",{type:"email",value:o.email||"",onChange:N=>_("email",N.target.value||null),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${w.email?"border-red-300":""}`,placeholder:"Enter email address"}),w.email&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:w.email})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),i.jsx("input",{type:"tel",value:o.phone||"",onChange:N=>_("phone",N.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"(555) 123-4567"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mobile Phone"}),i.jsx("input",{type:"tel",value:o.mobile_phone||"",onChange:N=>_("mobile_phone",N.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"(555) 123-4567"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Website"}),i.jsx("input",{type:"url",value:o.website||"",onChange:N=>_("website",N.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"https://example.com"})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Mailing Address"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Street Address"}),i.jsx("input",{type:"text",value:o.mailing_street||"",onChange:N=>_("mailing_street",N.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"123 Main St"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City"}),i.jsx("input",{type:"text",value:o.mailing_city||"",onChange:N=>_("mailing_city",N.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"City"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"State"}),i.jsxs("select",{value:o.mailing_state||"",onChange:N=>_("mailing_state",N.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",children:[i.jsx("option",{value:"",children:"Select state..."}),p.map(N=>i.jsx("option",{value:N,children:N},N))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ZIP Code"}),i.jsx("input",{type:"text",value:o.mailing_zip||"",onChange:N=>_("mailing_zip",N.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"12345"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Country"}),i.jsx("input",{type:"text",value:o.mailing_country||"",onChange:N=>_("mailing_country",N.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"United States"})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Professional Information"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"LinkedIn Profile"}),i.jsx("input",{type:"url",value:o.linked_in_profile_link||"",onChange:N=>_("linked_in_profile_link",N.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"https://linkedin.com/in/profile"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ICSC Profile Link"}),i.jsx("input",{type:"url",value:o.icsc_profile_link||"",onChange:N=>_("icsc_profile_link",N.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"https://icsc.com/profile"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tenant Rep Contact"}),i.jsxs("select",{value:o.tenant_rep_contact_id||"",onChange:N=>_("tenant_rep_contact_id",N.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",children:[i.jsx("option",{value:"",children:"Select contact..."}),d.map(N=>i.jsxs("option",{value:N.id,children:[N.first_name," ",N.last_name," ",N.company&&`(${N.company})`]},N.id))]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Professional Attributes"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("input",{type:"checkbox",id:"linked_in_connection",checked:o.linked_in_connection,onChange:N=>_("linked_in_connection",N.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),i.jsx("label",{htmlFor:"linked_in_connection",className:"text-sm text-gray-700",children:"LinkedIn Connection"})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("input",{type:"checkbox",id:"is_site_selector",checked:o.is_site_selector,onChange:N=>_("is_site_selector",N.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),i.jsx("label",{htmlFor:"is_site_selector",className:"text-sm text-gray-700",children:"Site Selector"})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("input",{type:"checkbox",id:"tenant_repped",checked:o.tenant_repped,onChange:N=>_("tenant_repped",N.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),i.jsx("label",{htmlFor:"tenant_repped",className:"text-sm text-gray-700",children:"Tenant Repped"})]})]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Tags & Tracking"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Tags"}),i.jsx("textarea",{rows:2,value:o.contact_tags||"",onChange:N=>_("contact_tags",N.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"Tags separated by commas (e.g., VIP, Decision Maker, Cold Lead)"})]}),s&&i.jsxs("div",{className:"bg-gray-50 p-3 rounded-md",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Record Information"}),i.jsxs("div",{className:"text-xs text-gray-500 space-y-1",children:[i.jsx("p",{children:"Created: "}),i.jsx("p",{children:"Last Updated: "})]})]})]})]})}),i.jsx("div",{className:"border-t border-gray-200 p-4 bg-gray-50",children:i.jsxs("div",{className:"flex justify-end space-x-3",children:[i.jsx("button",{type:"button",onClick:t,disabled:y,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:"Cancel"}),i.jsx("button",{type:"button",onClick:k,disabled:y||m,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:y?"Saving...":"Save Contact"})]})})]})]}):null},rm=({title:e,count:t,onAddNew:r,children:n,isExpanded:s=!0,onToggle:a,icon:o,isEmpty:l=!1})=>i.jsxs("div",{className:`bg-white border border-gray-200 rounded-lg mb-3 shadow-sm ${l?"opacity-60":""}`,children:[i.jsxs("div",{className:`flex items-center justify-between p-3 border-b border-gray-100 ${l?"bg-gray-50":"bg-gradient-to-r from-slate-50 to-gray-50"}`,children:[i.jsxs("button",{onClick:a,className:"flex items-center space-x-2 flex-1 text-left hover:bg-white/50 -mx-3 px-3 py-1 rounded-t-lg transition-colors",children:[i.jsx("svg",{className:`w-4 h-4 text-gray-400 transform transition-transform ${s?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),o&&i.jsx("div",{className:"w-4 h-4 flex items-center justify-center",children:i.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:o})})}),i.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:e}),i.jsx("span",{className:`inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium ${l?"bg-gray-200 text-gray-600":"bg-blue-100 text-blue-800"}`,children:t}),l&&i.jsx("span",{className:"text-xs text-gray-500 italic",children:"(Empty)"})]}),i.jsxs("button",{onClick:r,className:"flex items-center px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors ml-2",children:[i.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"New"]})]}),s&&i.jsx("div",{className:"max-h-48 overflow-y-auto",children:t===0?i.jsxs("div",{className:"p-4 text-center text-gray-500 text-sm",children:[i.jsx("div",{className:"w-12 h-12 mx-auto mb-2 bg-gray-100 rounded-full flex items-center justify-center",children:o&&i.jsx("svg",{className:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:o})})}),"No ",e.toLowerCase()," yet"]}):n})]}),p7=({contact:e,isExpanded:t=!1,onToggle:r,onEdit:n})=>{var o,l;const s=e.mobile_phone||e.phone,a=e.mobile_phone?"Mobile":"Phone";return i.jsxs("div",{className:"border-b border-gray-100 last:border-b-0",children:[i.jsxs("div",{className:"p-2 hover:bg-gray-50 cursor-pointer transition-colors flex items-center justify-between",onClick:r,children:[i.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[i.jsx("div",{className:"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center flex-shrink-0",children:i.jsxs("span",{className:"text-white font-medium text-xs",children:[((o=e.first_name)==null?void 0:o[0])||"?",((l=e.last_name)==null?void 0:l[0])||""]})}),i.jsx("div",{className:"flex-1 min-w-0",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsxs("span",{className:"text-sm font-medium text-gray-900 truncate",children:[e.first_name," ",e.last_name]}),s&&i.jsxs("span",{className:"text-xs text-gray-500 truncate",children:[a,": ",s]})]})})]}),i.jsx("svg",{className:`w-3 h-3 text-gray-400 transform transition-transform flex-shrink-0 ${t?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),t&&i.jsx("div",{className:"px-2 pb-2 bg-blue-25",children:i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded p-3 text-xs space-y-2",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("span",{className:"w-2 h-2 bg-blue-400 rounded-full"}),i.jsx("span",{className:"font-medium text-blue-900",children:"Contact Details"})]}),i.jsx("button",{onClick:c=>{c.stopPropagation(),n==null||n(e.id)},className:"text-blue-600 hover:text-blue-800 font-medium",children:"Edit"})]}),i.jsxs("div",{className:"space-y-1 ml-4",children:[e.title&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-blue-800",children:"Title:"})," ",i.jsx("span",{className:"text-blue-700",children:e.title})]}),e.company&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-blue-800",children:"Company:"})," ",i.jsx("span",{className:"text-blue-700",children:e.company})]}),e.email&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-blue-800",children:"Email:"})," ",i.jsx("span",{className:"text-blue-700",children:e.email})]}),e.phone&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-blue-800",children:"Phone:"})," ",i.jsx("span",{className:"text-blue-700",children:e.phone})]}),e.mobile_phone&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-blue-800",children:"Mobile:"})," ",i.jsx("span",{className:"text-blue-700",children:e.mobile_phone})]})]})]})})]})},g7=({siteSubmit:e,onClick:t})=>{var r,n;return i.jsx("div",{className:"p-2 hover:bg-green-50 cursor-pointer transition-colors border-b border-gray-100 last:border-b-0 group",onClick:()=>t==null?void 0:t(e.id),children:i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900 truncate group-hover:text-green-900",children:e.site_submit_name||e.sf_account||"Unnamed Submit"}),i.jsx("svg",{className:"w-3 h-3 text-gray-400 group-hover:text-green-600 opacity-0 group-hover:opacity-100 transition-opacity",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]}),i.jsxs("div",{className:"flex items-center justify-between mt-1",children:[i.jsx("p",{className:"text-xs text-green-600 font-medium",children:e.sf_submit_stage||"Site Submit"}),((r=e.property_unit)==null?void 0:r.property_unit_name)&&i.jsx("p",{className:"text-xs text-gray-600 font-medium",children:e.property_unit.property_unit_name}),i.jsx("p",{className:"text-xs text-gray-500 truncate ml-2",children:((n=e.client)==null?void 0:n.client_name)||"No client"})]})]})})})},x7=({deal:e,onClick:t})=>{var r,n;return i.jsx("div",{className:"p-2 hover:bg-blue-50 cursor-pointer transition-colors border-b border-gray-100 last:border-b-0 group",onClick:()=>t==null?void 0:t(e.id),children:i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900 truncate group-hover:text-blue-900",children:e.deal_name||"Unnamed Deal"}),i.jsx("svg",{className:"w-3 h-3 text-gray-400 group-hover:text-blue-600 opacity-0 group-hover:opacity-100 transition-opacity",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]}),i.jsxs("div",{className:"flex items-center justify-between mt-1",children:[i.jsx("p",{className:"text-xs text-blue-600 font-medium",children:((r=e.deal_stage)==null?void 0:r.label)||"No stage"}),i.jsx("p",{className:"text-xs text-gray-500 truncate ml-2",children:((n=e.client)==null?void 0:n.client_name)||"No client"})]})]})})})},y7=({propertyId:e,isMinimized:t=!1,onMinimize:r,onDealClick:n,onSiteSubmitModalChange:s,onContactModalChange:a})=>{const[o,l]=x.useState([]),[c,u]=x.useState([]),[d,f]=x.useState([]),[m,h]=x.useState(!1),[y,v]=x.useState(null),[w,g]=x.useState(!1),[b,p]=x.useState(null),[_,j]=x.useState(!1),[k,N]=x.useState(null),S=()=>({contacts:o.length>0,deals:c.length>0,siteSubmits:d.length>0}),[C,E]=x.useState(()=>{const M=localStorage.getItem(`expandedSidebarModules_${e}`);return M?JSON.parse(M):S()}),[T,L]=x.useState({});x.useEffect(()=>{if(!e)return;(async()=>{h(!0),v(null);try{const{data:B,error:F}=await $.from("property_contact").select(`
            *,
            contact!fk_property_contact_contact_id (*)
          `).eq("property_id",e);if(F)throw F;const R=[];B&&B.forEach(re=>{re.contact&&R.push({...re.contact,isPrimaryContact:!1})});const{data:P,error:D}=await $.from("property").select("contact_id").eq("id",e).single();if(!D&&(P!=null&&P.contact_id)){const re=R.findIndex(Q=>Q.id===P.contact_id);if(re>=0)R[re].isPrimaryContact=!0;else{const{data:Q}=await $.from("contact").select("*").eq("id",P.contact_id).single();Q&&R.unshift({...Q,isPrimaryContact:!0})}}l(R);const{data:z,error:W}=await $.from("deal").select(`
            *,
            deal_stage (
              label,
              sort_order
            ),
            client!client_id (
              client_name
            )
          `).eq("property_id",e).order("created_at",{ascending:!1});if(W)throw W;u(z||[]);const{data:I,error:ne}=await $.from("site_submit").select(`
            *,
            client!client_id (
              client_name
            ),
            property_unit (
              property_unit_name
            )
          `).eq("property_id",e).order("created_at",{ascending:!1});if(ne)throw ne;f(I||[])}catch(B){console.error("Error loading sidebar data:",B),v(B instanceof Error?B.message:"Failed to load data")}finally{h(!1)}})()},[e]),x.useEffect(()=>{m||E(M=>{const B=S(),F=localStorage.getItem(`expandedSidebarModules_${e}`);return F?JSON.parse(F):B})},[o.length,c.length,d.length,m,e]);const O=M=>{const B={...C,[M]:!C[M]};E(B),localStorage.setItem(`expandedSidebarModules_${e}`,JSON.stringify(B))},A=M=>{const B={...T,[M]:!T[M]};L(B),localStorage.setItem(`expandedContacts_${e}`,JSON.stringify(B))};return i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:`fixed right-0 top-0 h-full bg-white border-l border-gray-200 shadow-xl transition-all duration-300 ${t?"w-12":"w-[500px]"} z-40 ${t?"overflow-hidden":"overflow-y-auto"}`,style:{top:"180px",height:"calc(100vh - 180px)"},children:[i.jsxs("div",{className:`flex items-center ${t?"justify-center":"justify-between"} p-2 border-b border-gray-200 bg-gray-50`,children:[!t&&i.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Property Info"}),i.jsx("button",{onClick:r,className:`p-2 hover:bg-blue-100 hover:text-blue-600 rounded-md transition-colors group ${t?"text-gray-600":"text-gray-500"}`,title:t?"Expand sidebar":"Minimize sidebar",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t?i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7M4 12h16"}):i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 5l7 7-7 7M20 12H4"})})})]}),!t&&i.jsx("div",{className:"p-3",children:m?i.jsx("div",{className:"p-4 space-y-3",children:[...Array(3)].map((M,B)=>i.jsx("div",{className:"animate-pulse",children:i.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[i.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2"}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"h-3 bg-gray-200 rounded"}),i.jsx("div",{className:"h-3 bg-gray-200 rounded w-2/3"})]})]})},B))}):y?i.jsxs("div",{className:"p-4 text-center text-red-600",children:[i.jsx("p",{className:"font-medium",children:"Error loading data"}),i.jsx("p",{className:"text-sm",children:y})]}):i.jsxs(i.Fragment,{children:[i.jsx(rm,{title:"Associated Contacts",count:o.length,onAddNew:()=>{N(null),j(!0),a==null||a(!0)},isExpanded:C.contacts,onToggle:()=>O("contacts"),icon:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z",isEmpty:o.length===0,children:o.map(M=>i.jsx(p7,{contact:M,isExpanded:T[M.id],onToggle:()=>A(M.id),onEdit:B=>{N(B),j(!0),a==null||a(!0)}},M.id))}),i.jsx(rm,{title:"Deals",count:c.length,onAddNew:()=>console.log("Add new deal"),isExpanded:C.deals,onToggle:()=>O("deals"),icon:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1",isEmpty:c.length===0,children:c.map(M=>i.jsx(x7,{deal:M,onClick:n},M.id))}),i.jsx(rm,{title:"Site Submits",count:d.length,onAddNew:()=>{p(null),g(!0),s==null||s(!0)},isExpanded:C.siteSubmits,onToggle:()=>O("siteSubmits"),icon:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",isEmpty:d.length===0,children:d.map(M=>i.jsx(g7,{siteSubmit:M,onClick:B=>{p(B),g(!0),s==null||s(!0)}},M.id))})]})})]}),i.jsx(e0,{isOpen:w,onClose:()=>{g(!1),p(null),s==null||s(!1)},siteSubmitId:b,propertyId:e,onSave:M=>{f(B=>[M,...B]),g(!1),s==null||s(!1)},onUpdate:M=>{f(B=>B.map(F=>F.id===M.id?M:F)),g(!1),s==null||s(!1)}}),i.jsx(Jk,{isOpen:_,onClose:()=>{j(!1),N(null),a==null||a(!1)},contactId:k,propertyId:e,onSave:M=>{l(B=>[{...M,isPrimaryContact:!1},...B]),j(!1),a==null||a(!1)},onUpdate:M=>{l(B=>B.map(F=>F.id===M.id?{...M,isPrimaryContact:F.isPrimaryContact}:F)),j(!1),a==null||a(!1)}})]})},yc=({label:e,value:t,onChange:r,placeholder:n,required:s=!1,type:a="text",helpText:o})=>i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e," ",s&&i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:a,value:t||"",onChange:l=>r(l.target.value||null),placeholder:n,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm"}),o&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:o})]}),Ib=({label:e,value:t,onChange:r,helpText:n})=>{const[s,a]=x.useState("");x.useEffect(()=>{t==null?a(""):a(t.toFixed(2))},[t]);const o=l=>{const c=l.target.value;console.log(`[${e}] User typed:`,c),a(c);const u=c===""?null:parseFloat(c);console.log(`[${e}] Parsed value:`,u),console.log(`[${e}] Calling onChange with:`,u),r(u)};return i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),i.jsxs("div",{className:"relative",children:[i.jsx("span",{className:"absolute left-3 top-2 text-gray-500 text-sm",children:"$"}),i.jsx("input",{type:"number",step:"0.01",min:"0",value:s,onChange:o,placeholder:"0.00",className:"w-full pl-8 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),n&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:n})]})},so=({label:e,checked:t,onChange:r})=>i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:t,onChange:n=>r(n.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),i.jsx("label",{className:"ml-2 block text-sm text-gray-700",children:e})]}),b7=({propertyId:e,isEditing:t=!1,onUnitsChange:r,isExpanded:n=!1,onToggle:s})=>{const[a,o]=x.useState([]),[l,c]=x.useState(!1),[u,d]=x.useState(null);x.useEffect(()=>{if(!e)return;(async()=>{c(!0),d(null);try{const{data:w,error:g}=await $.from("property_unit").select("*").eq("property_id",e).order("property_unit_name");if(g)throw g;console.log("[loadUnits] Data from database:",w),w&&w.forEach((b,p)=>{console.log(`[loadUnits] Unit ${p+1}:`,{name:b.property_unit_name,rent:b.rent,nnn:b.nnn,rentType:typeof b.rent,nnnType:typeof b.nnn})}),o(w||[]),r==null||r(w||[])}catch(w){console.error("Error loading property units:",w),d(w instanceof Error?w.message:"Failed to load units")}finally{c(!1)}})()},[e,r]);const f=async()=>{const v={property_id:e,property_unit_name:`Unit ${a.length+1}`,sqft:null,rent:null,nnn:null,patio:!1,inline:!1,end_cap:!1,end_cap_drive_thru:!1,second_gen_restaurant:!1,lease_expiration_date:null,unit_notes:null};try{const{data:w,error:g}=await $.from("property_unit").insert([v]).select().single();if(g)throw g;const b=[...a,w];o(b),r==null||r(b)}catch(w){console.error("Error creating unit:",w),d(w instanceof Error?w.message:"Failed to create unit")}},m=async(v,w,g)=>{console.log(`[updateUnit] Updating unit ${v}, field: ${w}, value:`,g,typeof g);try{const b={[w]:g};console.log("[updateUnit] Sending to database:",b);const{error:p}=await $.from("property_unit").update(b).eq("id",v);if(p)throw p;const _=a.map(j=>j.id===v?{...j,[w]:g}:j);console.log("[updateUnit] Updated unit in array:",_.find(j=>j.id===v)),o(_),r==null||r(_)}catch(b){console.error("Error updating unit:",b),d(b instanceof Error?b.message:"Failed to update unit")}},h=async v=>{if(confirm("Are you sure you want to delete this unit?"))try{const{error:w}=await $.from("property_unit").delete().eq("id",v);if(w)throw w;const g=a.filter(b=>b.id!==v);o(g),r==null||r(g)}catch(w){console.error("Error deleting unit:",w),d(w instanceof Error?w.message:"Failed to delete unit")}};if(l)return i.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:i.jsxs("div",{className:"animate-pulse",children:[i.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/4 mb-4"}),i.jsx("div",{className:"space-y-3",children:[...Array(2)].map((v,w)=>i.jsx("div",{className:"h-24 bg-gray-200 rounded"},w))})]})});const y=()=>{if(l)return"Loading units...";if(a.length===0)return"No units yet";if(a.length===1){const p=a[0];let _=p.property_unit_name||"Unit";return p.sqft&&(_+=`  ${p.sqft.toLocaleString()} sqft`),p.rent&&(_+=`  $${p.rent.toFixed(2)} rent`),p.nnn&&(_+=`  $${p.nnn.toFixed(2)} NNN`),_}const v=a.reduce((p,_)=>p+(_.sqft||0),0),w=a.reduce((p,_)=>p+(_.rent||0),0),g=a.reduce((p,_)=>p+(_.nnn||0),0);let b=`${a.length} units`;return v>0&&(b+=`  ${v.toLocaleString()} total sqft`),w>0&&(b+=`  $${w.toLocaleString()} total rent`),g>0&&(b+=`  $${g.toLocaleString()} total NNN`),b};return i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[i.jsxs("button",{onClick:s,className:"w-full flex items-center justify-between p-6 hover:bg-gray-50 transition-colors",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("svg",{className:`w-5 h-5 text-gray-400 transform transition-transform ${n?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),i.jsxs("div",{className:"text-left",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Property Units"}),i.jsx("p",{className:"text-sm text-gray-500",children:y()})]})]}),i.jsx("div",{className:"flex items-center space-x-2",children:a.length>0&&i.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:a.length})})]}),n&&i.jsxs("div",{className:"px-6 pb-6 border-t border-gray-100",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4 pt-4",children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Manage individual units within this property"}),i.jsxs("button",{onClick:f,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Unit"]})]}),u&&i.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md",children:i.jsx("p",{className:"text-red-600 text-sm",children:u})}),a.length===0?i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:i.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),i.jsx("p",{className:"text-sm font-medium",children:"No units yet"}),i.jsx("p",{className:"text-xs mt-1",children:'Click "Add Unit" to start adding units to this property'})]}):i.jsx("div",{className:"space-y-4",children:a.map((v,w)=>{var g;return i.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Unit ",w+1]}),i.jsx("button",{onClick:()=>h(v.id),className:"p-1 text-red-600 hover:text-red-800 hover:bg-red-50 rounded",title:"Delete unit",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[i.jsx(yc,{label:"Unit Name",value:v.property_unit_name,onChange:b=>m(v.id,"property_unit_name",b),placeholder:"e.g., Suite 101",required:!0}),i.jsx(yc,{label:"Unit Notes",value:v.unit_notes,onChange:b=>m(v.id,"unit_notes",b),placeholder:"Any special notes about this unit"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[i.jsx(yc,{label:"Square Feet",value:((g=v.sqft)==null?void 0:g.toString())||null,onChange:b=>m(v.id,"sqft",b?Number(b):null),type:"number",placeholder:"0"}),i.jsx(Ib,{label:"Rent",value:v.rent,onChange:b=>m(v.id,"rent",b),helpText:"Base rent amount"}),i.jsx(Ib,{label:"NNN",value:v.nnn,onChange:b=>m(v.id,"nnn",b),helpText:"Net, Net, Net charges"}),i.jsx(yc,{label:"Lease Expiration",value:v.lease_expiration_date?new Date(v.lease_expiration_date).toISOString().split("T")[0]:null,onChange:b=>m(v.id,"lease_expiration_date",b?new Date(b).toISOString():null),type:"date"})]}),i.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[i.jsx("div",{className:"text-sm font-medium text-gray-700 mb-3",children:"Unit Features"}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4",children:[i.jsx(so,{label:"Patio",checked:v.patio||!1,onChange:b=>m(v.id,"patio",b)}),i.jsx(so,{label:"Inline",checked:v.inline||!1,onChange:b=>m(v.id,"inline",b)}),i.jsx(so,{label:"End Cap",checked:v.end_cap||!1,onChange:b=>m(v.id,"end_cap",b)}),i.jsx(so,{label:"End Cap Drive Thru",checked:v.end_cap_drive_thru||!1,onChange:b=>m(v.id,"end_cap_drive_thru",b)}),i.jsx(so,{label:"2nd Gen Restaurant",checked:v.second_gen_restaurant||!1,onChange:b=>m(v.id,"second_gen_restaurant",b)})]})]})]},v.id)})}),a.length>0&&i.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-md",children:i.jsx("p",{className:"text-blue-800 text-sm",children:" Units are automatically saved as you make changes. You can add, edit, or remove units at any time."})})]})]})},v7=({propertyId:e,mode:t="view",initialLocation:r,onSave:n,onBack:s=()=>window.history.back()})=>{const a=Jt(),[o,l]=x.useState(!1),[c,u]=x.useState([]),[d,f]=x.useState([]),[m,h]=x.useState([]),[y,v]=x.useState("idle"),[w,g]=x.useState(!1),[b,p]=x.useState(!1),[_,j]=x.useState(!1),[k,N]=x.useState(!1),{property:S,loading:C,error:E,updateProperty:T,createProperty:L,refreshProperty:O}=Kk(e),{formData:A,updateField:M,validation:B,isDirty:F,resetForm:R}=i7(S||void 0);x.useEffect(()=>{(async()=>{try{const[Q,U,J]=await Promise.all([$.from("property_type").select("*").eq("active",!0).order("sort_order"),$.from("property_stage").select("*").eq("active",!0).order("sort_order"),$.from("property_record_type").select("*").eq("active",!0).order("sort_order")]);Q.data&&u(Q.data),U.data&&f(U.data),J.data?h(J.data):(console.log("No property record types found in lookup table"),h([]))}catch(Q){console.error("Error loading dropdown data:",Q),h([])}})()},[]),x.useEffect(()=>{t==="create"&&r&&!A.latitude&&!A.longitude&&(M("latitude",r.lat),M("longitude",r.lng))},[t,r,A.latitude,A.longitude,M]),x.useEffect(()=>{S&&R(S)},[S,R]);const P=async()=>{},D=async(re,Q)=>{if(M(re,Q),e&&t!=="create")try{v("saving"),await T({[re]:Q}),v("saved"),setTimeout(()=>v("idle"),2e3)}catch(U){console.error("Auto-save failed:",U),v("error")}},z=()=>new Promise((re,Q)=>{if(!navigator.geolocation){Q(new Error("Geolocation is not supported by this browser"));return}navigator.geolocation.getCurrentPosition(U=>{re({lat:U.coords.latitude,lng:U.coords.longitude})},U=>{Q(new Error("Failed to get current location: "+U.message))},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5})}),W=()=>{console.log("Call contact for property:",e)},I=re=>{a(`/deal/${re}`)};if(C)return i.jsx("div",{className:"min-h-screen bg-gray-50",children:i.jsxs("div",{className:"animate-pulse",children:[i.jsx("div",{className:"bg-slate-800 h-32"}),i.jsxs("div",{className:"flex h-screen",children:[i.jsx("div",{className:"flex-1 p-4 space-y-4",children:i.jsxs("div",{className:"bg-white rounded-lg p-6 space-y-4",children:[i.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4"}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"h-4 bg-gray-200 rounded"}),i.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"})]})]})}),i.jsx("div",{className:"w-80 bg-white border-l border-gray-200 p-4",children:i.jsxs("div",{className:"animate-pulse space-y-4",children:[i.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"h-8 bg-gray-200 rounded"}),i.jsx("div",{className:"h-8 bg-gray-200 rounded"})]})]})})]})]})});if(E&&t!=="create")return i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsx("div",{className:"bg-white rounded-lg border border-red-200 p-6 max-w-md mx-4",children:i.jsxs("div",{className:"text-red-600 text-center",children:[i.jsx("svg",{className:"w-12 h-12 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.732 15.5c-.77.833.192 2.5 1.732 2.5z"})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Error Loading Property"}),i.jsx("p",{className:"text-sm text-gray-600 mb-4",children:E}),i.jsx("button",{onClick:s,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm",children:"Go Back"})]})})});const ne=t==="create"?A:S||A;return i.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[i.jsx(o7,{property:{...ne,property_type:c.find(re=>re.id===ne.property_type_id),property_stage:d.find(re=>re.id===ne.property_stage_id)},isEditing:o,onToggleEdit:P,onBack:s,onGetLocation:()=>z().then(re=>{D("latitude",re.lat),D("longitude",re.lng)}),onCallContact:W}),i.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[i.jsx("div",{className:`flex-1 overflow-y-auto transition-all duration-300 ease-in-out ${_?"lg:-translate-x-[350px]":k?"lg:-translate-x-[400px]":""}`,children:i.jsxs("div",{className:"max-w-4xl mx-auto p-4 pb-8",children:[o&&B.warnings.length>0&&i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Recommendations"}),i.jsx("ul",{className:"mt-1 text-xs text-yellow-700 list-disc list-inside",children:B.warnings.map((re,Q)=>i.jsx("li",{children:re},Q))})]})]})}),o&&y!=="idle"&&i.jsxs("div",{className:`p-2 rounded-md text-sm mb-4 ${y==="saving"?"bg-blue-50 text-blue-700":y==="saved"?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:[y==="saving"&&"Saving changes...",y==="saved"&&"Changes saved successfully",y==="error"&&"Error saving changes"]}),i.jsx(d7,{property:ne,isEditing:o,onFieldUpdate:D,propertyRecordTypes:m}),i.jsx(l7,{property:ne,onFieldUpdate:D,onGetCurrentLocation:z}),e&&i.jsx(b7,{propertyId:e,isEditing:o,isExpanded:b,onToggle:()=>p(!b),onUnitsChange:re=>{console.log("Units updated:",re)}}),i.jsx(c7,{property:{...ne,property_record_type:m.find(re=>re.id===ne.property_record_type_id)},onFieldUpdate:D}),i.jsx(f7,{property:ne,onFieldUpdate:D}),i.jsx(m7,{property:ne,isEditing:o,onFieldUpdate:D}),i.jsx(h7,{property:ne,isEditing:o,onFieldUpdate:D}),e&&i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 mb-6",children:[i.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Activities"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Track all activities and tasks related to this property"})]}),i.jsx("div",{className:"p-6",children:i.jsx(Il,{config:{parentObject:{id:e,type:"property",name:ne.property_name||"Property"},title:"Property Activities",showSummary:!0,allowAdd:!0}})})]}),o&&!B.isValid&&i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Please fix these errors:"}),i.jsx("ul",{className:"mt-1 text-xs text-red-700 list-disc list-inside",children:Object.entries(B.errors).map(([re,Q])=>i.jsxs("li",{children:[i.jsxs("strong",{children:[re,":"]})," ",Q]},re))})]})]})})]})}),e&&i.jsx(y7,{propertyId:e,isMinimized:w,onMinimize:()=>g(!w),onDealClick:I,onSiteSubmitModalChange:j,onContactModalChange:N})]})]})};function w7(){const{propertyId:e}=Ni(),t=Jt(),[r,n]=x.useState(null),[s,a]=x.useState(!0),[o,l]=x.useState(null),{trackView:c}=Rl(),u=e==="create";x.useEffect(()=>{(async()=>{if(!e||u){a(!1);return}try{a(!0);const{data:h,error:y}=await $.from("property").select("*").eq("id",e).single();if(y)throw y;n(h),c(h.id,"property",h.property_name||"Unnamed Property",`${h.address||""} ${h.city||""} ${h.state||""}`.trim()||void 0)}catch(h){console.error("Error fetching property:",h),l(h instanceof Error?h.message:"Failed to load property")}finally{a(!1)}})()},[e,u]);const d=()=>{t(-1)},f=m=>{n(m),u&&t(`/property/${m.id}`)};return s?i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),i.jsx("div",{className:"text-sm text-gray-600",children:"Loading property..."})]})}):o&&!u?i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsx("div",{className:"bg-white rounded-lg border border-red-200 p-6 max-w-md mx-4",children:i.jsxs("div",{className:"text-red-600 text-center",children:[i.jsx("svg",{className:"w-12 h-12 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.732 15.5c-.77.833.192 2.5 1.732 2.5z"})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Property Not Found"}),i.jsx("p",{className:"text-sm text-gray-600 mb-4",children:o}),i.jsx("button",{onClick:d,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm",children:"Go Back"})]})})}):i.jsx(v7,{propertyId:u?void 0:e,mode:u?"create":"view",onSave:f,onBack:d})}const _7=({contact:e,isNewContact:t,onSave:r,onDelete:n})=>{const[s,a]=x.useState({first_name:"",last_name:"",email:null,phone:null,mobile_phone:null,title:null,company:null,client_id:null,source_type:"Contact",mailing_street:null,mailing_city:null,mailing_state:null,mailing_zip:null,mailing_country:null,website:null,linked_in_profile_link:null,icsc_profile_link:null,linked_in_connection:!1,is_site_selector:!1,tenant_repped:!1,tenant_rep_contact_id:null,contact_tags:null}),[o,l]=x.useState([]),[c,u]=x.useState([]),[d,f]=x.useState(!1),[m,h]=x.useState({}),y=["Contact","Lead"],v=["AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"];x.useEffect(()=>{(async()=>{try{const[_,j]=await Promise.all([$.from("client").select("*").order("client_name"),$.from("contact").select("id, first_name, last_name, company").order("last_name, first_name")]);_.data&&l(_.data),j.data&&u(j.data),e&&!t&&a({first_name:e.first_name||"",last_name:e.last_name||"",email:e.email,phone:e.phone,mobile_phone:e.mobile_phone,title:e.title,company:e.company,client_id:e.client_id,source_type:e.source_type,mailing_street:e.mailing_street,mailing_city:e.mailing_city,mailing_state:e.mailing_state,mailing_zip:e.mailing_zip,mailing_country:e.mailing_country,website:e.website,linked_in_profile_link:e.linked_in_profile_link,icsc_profile_link:e.icsc_profile_link,linked_in_connection:e.linked_in_connection||!1,is_site_selector:e.is_site_selector||!1,tenant_repped:e.tenant_repped||!1,tenant_rep_contact_id:e.tenant_rep_contact_id,contact_tags:e.contact_tags})}catch(_){console.error("Error loading form data:",_)}})()},[e,t]);const w=(p,_)=>{a(j=>({...j,[p]:_})),m[p]&&h(j=>({...j,[p]:""}))},g=()=>{var _,j,k;const p={};return(_=s.first_name)!=null&&_.trim()||(p.first_name="First name is required"),(j=s.last_name)!=null&&j.trim()||(p.last_name="Last name is required"),(k=s.source_type)!=null&&k.trim()||(p.source_type="Source type is required"),s.email&&!/\S+@\S+\.\S+/.test(s.email)&&(p.email="Please enter a valid email address"),h(p),Object.keys(p).length===0},b=async()=>{if(g()){f(!0);try{if(e&&!t){const p={...s,updated_at:new Date().toISOString()},{data:_,error:j}=await $.from("contact").update(p).eq("id",e.id).select().single();if(j)throw j;r(_)}else{const p={...s,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{data:_,error:j}=await $.from("contact").insert(p).select().single();if(j)throw j;r(_)}}catch(p){console.error("Error saving contact:",p),alert(`Error saving contact: ${p instanceof Error?p.message:"Unknown error"}. Please check the console for details.`)}finally{f(!1)}}};return i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{className:"flex justify-end space-x-3",children:[!t&&n&&i.jsx("button",{onClick:n,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 border border-transparent rounded-md hover:bg-red-700",children:"Delete"}),i.jsx("button",{onClick:b,disabled:d,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 disabled:opacity-50",children:d?"Saving...":"Save Contact"})]}),i.jsxs("div",{className:"bg-white shadow rounded-lg p-6 space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Basic Information"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name *"}),i.jsx("input",{type:"text",value:s.first_name,onChange:p=>w("first_name",p.target.value),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${m.first_name?"border-red-300":""}`,placeholder:"Enter first name"}),m.first_name&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.first_name})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name *"}),i.jsx("input",{type:"text",value:s.last_name,onChange:p=>w("last_name",p.target.value),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${m.last_name?"border-red-300":""}`,placeholder:"Enter last name"}),m.last_name&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.last_name})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),i.jsx("input",{type:"text",value:s.title||"",onChange:p=>w("title",p.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"Job title"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company"}),i.jsx("input",{type:"text",value:s.company||"",onChange:p=>w("company",p.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"Company name"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client"}),i.jsxs("select",{value:s.client_id||"",onChange:p=>w("client_id",p.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",children:[i.jsx("option",{value:"",children:"Select a client..."}),o.map(p=>i.jsx("option",{value:p.id,children:p.client_name},p.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Source Type *"}),i.jsxs("select",{value:s.source_type,onChange:p=>w("source_type",p.target.value),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${m.source_type?"border-red-300":""}`,children:[i.jsx("option",{value:"",children:"Select source..."}),y.map(p=>i.jsx("option",{value:p,children:p},p))]}),m.source_type&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.source_type})]})]})]}),i.jsxs("div",{className:"bg-white shadow rounded-lg p-6 space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Contact Information"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),i.jsx("input",{type:"email",value:s.email||"",onChange:p=>w("email",p.target.value||null),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${m.email?"border-red-300":""}`,placeholder:"Enter email address"}),m.email&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.email})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),i.jsx("input",{type:"tel",value:s.phone||"",onChange:p=>w("phone",p.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"(555) 123-4567"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mobile Phone"}),i.jsx("input",{type:"tel",value:s.mobile_phone||"",onChange:p=>w("mobile_phone",p.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"(555) 123-4567"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Website"}),i.jsx("input",{type:"url",value:s.website||"",onChange:p=>w("website",p.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"https://example.com"})]})]}),i.jsxs("div",{className:"bg-white shadow rounded-lg p-6 space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Mailing Address"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Street Address"}),i.jsx("input",{type:"text",value:s.mailing_street||"",onChange:p=>w("mailing_street",p.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"123 Main St"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City"}),i.jsx("input",{type:"text",value:s.mailing_city||"",onChange:p=>w("mailing_city",p.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"City"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"State"}),i.jsxs("select",{value:s.mailing_state||"",onChange:p=>w("mailing_state",p.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",children:[i.jsx("option",{value:"",children:"Select state..."}),v.map(p=>i.jsx("option",{value:p,children:p},p))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ZIP Code"}),i.jsx("input",{type:"text",value:s.mailing_zip||"",onChange:p=>w("mailing_zip",p.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"12345"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Country"}),i.jsx("input",{type:"text",value:s.mailing_country||"",onChange:p=>w("mailing_country",p.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"United States"})]})]}),i.jsxs("div",{className:"bg-white shadow rounded-lg p-6 space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Professional Information"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"LinkedIn Profile"}),i.jsx("input",{type:"url",value:s.linked_in_profile_link||"",onChange:p=>w("linked_in_profile_link",p.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"https://linkedin.com/in/profile"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ICSC Profile Link"}),i.jsx("input",{type:"url",value:s.icsc_profile_link||"",onChange:p=>w("icsc_profile_link",p.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"https://icsc.com/profile"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tenant Rep Contact"}),i.jsxs("select",{value:s.tenant_rep_contact_id||"",onChange:p=>w("tenant_rep_contact_id",p.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",children:[i.jsx("option",{value:"",children:"Select contact..."}),c.map(p=>i.jsxs("option",{value:p.id,children:[p.first_name," ",p.last_name," ",p.company&&`(${p.company})`]},p.id))]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Professional Attributes"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("input",{type:"checkbox",id:"linked_in_connection",checked:s.linked_in_connection,onChange:p=>w("linked_in_connection",p.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),i.jsx("label",{htmlFor:"linked_in_connection",className:"text-sm text-gray-700",children:"LinkedIn Connection"})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("input",{type:"checkbox",id:"is_site_selector",checked:s.is_site_selector,onChange:p=>w("is_site_selector",p.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),i.jsx("label",{htmlFor:"is_site_selector",className:"text-sm text-gray-700",children:"Site Selector"})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("input",{type:"checkbox",id:"tenant_repped",checked:s.tenant_repped,onChange:p=>w("tenant_repped",p.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),i.jsx("label",{htmlFor:"tenant_repped",className:"text-sm text-gray-700",children:"Tenant Repped"})]})]})]})]}),i.jsxs("div",{className:"bg-white shadow rounded-lg p-6 space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Tags & Tracking"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Tags"}),i.jsx("textarea",{rows:2,value:s.contact_tags||"",onChange:p=>w("contact_tags",p.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"Tags separated by commas (e.g., VIP, Decision Maker, Cold Lead)"})]})]})]})};function j7(e,t){const r=t||{};return(e[e.length-1]===""?[...e,""]:e).join((r.padRight?" ":"")+","+(r.padLeft===!1?"":" ")).trim()}const k7=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,N7=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,S7={};function Rb(e,t){return((t||S7).jsx?N7:k7).test(e)}const C7=/[ \t\n\f\r]/g;function E7(e){return typeof e=="object"?e.type==="text"?Mb(e.value):!1:Mb(e)}function Mb(e){return e.replace(C7,"")===""}class Ml{constructor(t,r,n){this.normal=r,this.property=t,n&&(this.space=n)}}Ml.prototype.normal={};Ml.prototype.property={};Ml.prototype.space=void 0;function Xk(e,t){const r={},n={};for(const s of e)Object.assign(r,s.property),Object.assign(n,s.normal);return new Ml(r,n,t)}function zh(e){return e.toLowerCase()}class Xt{constructor(t,r){this.attribute=r,this.property=t}}Xt.prototype.attribute="";Xt.prototype.booleanish=!1;Xt.prototype.boolean=!1;Xt.prototype.commaOrSpaceSeparated=!1;Xt.prototype.commaSeparated=!1;Xt.prototype.defined=!1;Xt.prototype.mustUseProperty=!1;Xt.prototype.number=!1;Xt.prototype.overloadedBoolean=!1;Xt.prototype.property="";Xt.prototype.spaceSeparated=!1;Xt.prototype.space=void 0;let D7=0;const xe=ma(),ot=ma(),Wh=ma(),K=ma(),We=ma(),Ja=ma(),er=ma();function ma(){return 2**++D7}const Hh=Object.freeze(Object.defineProperty({__proto__:null,boolean:xe,booleanish:ot,commaOrSpaceSeparated:er,commaSeparated:Ja,number:K,overloadedBoolean:Wh,spaceSeparated:We},Symbol.toStringTag,{value:"Module"})),nm=Object.keys(Hh);class t0 extends Xt{constructor(t,r,n,s){let a=-1;if(super(t,r),Ob(this,"space",s),typeof n=="number")for(;++a<nm.length;){const o=nm[a];Ob(this,nm[a],(n&Hh[o])===Hh[o])}}}t0.prototype.defined=!0;function Ob(e,t,r){r&&(e[t]=r)}function Li(e){const t={},r={};for(const[n,s]of Object.entries(e.properties)){const a=new t0(n,e.transform(e.attributes||{},n),s,e.space);e.mustUseProperty&&e.mustUseProperty.includes(n)&&(a.mustUseProperty=!0),t[n]=a,r[zh(n)]=n,r[zh(a.attribute)]=n}return new Ml(t,r,e.space)}const Zk=Li({properties:{ariaActiveDescendant:null,ariaAtomic:ot,ariaAutoComplete:null,ariaBusy:ot,ariaChecked:ot,ariaColCount:K,ariaColIndex:K,ariaColSpan:K,ariaControls:We,ariaCurrent:null,ariaDescribedBy:We,ariaDetails:null,ariaDisabled:ot,ariaDropEffect:We,ariaErrorMessage:null,ariaExpanded:ot,ariaFlowTo:We,ariaGrabbed:ot,ariaHasPopup:null,ariaHidden:ot,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:We,ariaLevel:K,ariaLive:null,ariaModal:ot,ariaMultiLine:ot,ariaMultiSelectable:ot,ariaOrientation:null,ariaOwns:We,ariaPlaceholder:null,ariaPosInSet:K,ariaPressed:ot,ariaReadOnly:ot,ariaRelevant:null,ariaRequired:ot,ariaRoleDescription:We,ariaRowCount:K,ariaRowIndex:K,ariaRowSpan:K,ariaSelected:ot,ariaSetSize:K,ariaSort:null,ariaValueMax:K,ariaValueMin:K,ariaValueNow:K,ariaValueText:null,role:null},transform(e,t){return t==="role"?t:"aria-"+t.slice(4).toLowerCase()}});function eN(e,t){return t in e?e[t]:t}function tN(e,t){return eN(e,t.toLowerCase())}const P7=Li({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Ja,acceptCharset:We,accessKey:We,action:null,allow:null,allowFullScreen:xe,allowPaymentRequest:xe,allowUserMedia:xe,alt:null,as:null,async:xe,autoCapitalize:null,autoComplete:We,autoFocus:xe,autoPlay:xe,blocking:We,capture:null,charSet:null,checked:xe,cite:null,className:We,cols:K,colSpan:null,content:null,contentEditable:ot,controls:xe,controlsList:We,coords:K|Ja,crossOrigin:null,data:null,dateTime:null,decoding:null,default:xe,defer:xe,dir:null,dirName:null,disabled:xe,download:Wh,draggable:ot,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:xe,formTarget:null,headers:We,height:K,hidden:Wh,high:K,href:null,hrefLang:null,htmlFor:We,httpEquiv:We,id:null,imageSizes:null,imageSrcSet:null,inert:xe,inputMode:null,integrity:null,is:null,isMap:xe,itemId:null,itemProp:We,itemRef:We,itemScope:xe,itemType:We,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:xe,low:K,manifest:null,max:null,maxLength:K,media:null,method:null,min:null,minLength:K,multiple:xe,muted:xe,name:null,nonce:null,noModule:xe,noValidate:xe,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:xe,optimum:K,pattern:null,ping:We,placeholder:null,playsInline:xe,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:xe,referrerPolicy:null,rel:We,required:xe,reversed:xe,rows:K,rowSpan:K,sandbox:We,scope:null,scoped:xe,seamless:xe,selected:xe,shadowRootClonable:xe,shadowRootDelegatesFocus:xe,shadowRootMode:null,shape:null,size:K,sizes:null,slot:null,span:K,spellCheck:ot,src:null,srcDoc:null,srcLang:null,srcSet:null,start:K,step:null,style:null,tabIndex:K,target:null,title:null,translate:null,type:null,typeMustMatch:xe,useMap:null,value:ot,width:K,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:We,axis:null,background:null,bgColor:null,border:K,borderColor:null,bottomMargin:K,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:xe,declare:xe,event:null,face:null,frame:null,frameBorder:null,hSpace:K,leftMargin:K,link:null,longDesc:null,lowSrc:null,marginHeight:K,marginWidth:K,noResize:xe,noHref:xe,noShade:xe,noWrap:xe,object:null,profile:null,prompt:null,rev:null,rightMargin:K,rules:null,scheme:null,scrolling:ot,standby:null,summary:null,text:null,topMargin:K,valueType:null,version:null,vAlign:null,vLink:null,vSpace:K,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:xe,disableRemotePlayback:xe,prefix:null,property:null,results:K,security:null,unselectable:null},space:"html",transform:tN}),T7=Li({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:er,accentHeight:K,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:K,amplitude:K,arabicForm:null,ascent:K,attributeName:null,attributeType:null,azimuth:K,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:K,by:null,calcMode:null,capHeight:K,className:We,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:K,diffuseConstant:K,direction:null,display:null,dur:null,divisor:K,dominantBaseline:null,download:xe,dx:null,dy:null,edgeMode:null,editable:null,elevation:K,enableBackground:null,end:null,event:null,exponent:K,externalResourcesRequired:null,fill:null,fillOpacity:K,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Ja,g2:Ja,glyphName:Ja,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:K,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:K,horizOriginX:K,horizOriginY:K,id:null,ideographic:K,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:K,k:K,k1:K,k2:K,k3:K,k4:K,kernelMatrix:er,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:K,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:K,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:K,overlineThickness:K,paintOrder:null,panose1:null,path:null,pathLength:K,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:We,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:K,pointsAtY:K,pointsAtZ:K,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:er,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:er,rev:er,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:er,requiredFeatures:er,requiredFonts:er,requiredFormats:er,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:K,specularExponent:K,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:K,strikethroughThickness:K,string:null,stroke:null,strokeDashArray:er,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:K,strokeOpacity:K,strokeWidth:null,style:null,surfaceScale:K,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:er,tabIndex:K,tableValues:null,target:null,targetX:K,targetY:K,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:er,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:K,underlineThickness:K,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:K,values:null,vAlphabetic:K,vMathematical:K,vectorEffect:null,vHanging:K,vIdeographic:K,version:null,vertAdvY:K,vertOriginX:K,vertOriginY:K,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:K,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:eN}),rN=Li({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,t){return"xlink:"+t.slice(5).toLowerCase()}}),nN=Li({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:tN}),sN=Li({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,t){return"xml:"+t.slice(3).toLowerCase()}}),L7={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},I7=/[A-Z]/g,Ab=/-[a-z]/g,R7=/^data[-\w.:]+$/i;function M7(e,t){const r=zh(t);let n=t,s=Xt;if(r in e.normal)return e.property[e.normal[r]];if(r.length>4&&r.slice(0,4)==="data"&&R7.test(t)){if(t.charAt(4)==="-"){const a=t.slice(5).replace(Ab,A7);n="data"+a.charAt(0).toUpperCase()+a.slice(1)}else{const a=t.slice(4);if(!Ab.test(a)){let o=a.replace(I7,O7);o.charAt(0)!=="-"&&(o="-"+o),t="data"+o}}s=t0}return new s(n,t)}function O7(e){return"-"+e.toLowerCase()}function A7(e){return e.charAt(1).toUpperCase()}const $7=Xk([Zk,P7,rN,nN,sN],"html"),r0=Xk([Zk,T7,rN,nN,sN],"svg");function F7(e){return e.join(" ").trim()}var n0={},$b=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,B7=/\n/g,U7=/^\s*/,z7=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,W7=/^:\s*/,H7=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,q7=/^[;\s]*/,V7=/^\s+|\s+$/g,Y7=`
`,Fb="/",Bb="*",Us="",G7="comment",K7="declaration",Q7=function(e,t){if(typeof e!="string")throw new TypeError("First argument must be a string");if(!e)return[];t=t||{};var r=1,n=1;function s(y){var v=y.match(B7);v&&(r+=v.length);var w=y.lastIndexOf(Y7);n=~w?y.length-w:n+y.length}function a(){var y={line:r,column:n};return function(v){return v.position=new o(y),u(),v}}function o(y){this.start=y,this.end={line:r,column:n},this.source=t.source}o.prototype.content=e;function l(y){var v=new Error(t.source+":"+r+":"+n+": "+y);if(v.reason=y,v.filename=t.source,v.line=r,v.column=n,v.source=e,!t.silent)throw v}function c(y){var v=y.exec(e);if(v){var w=v[0];return s(w),e=e.slice(w.length),v}}function u(){c(U7)}function d(y){var v;for(y=y||[];v=f();)v!==!1&&y.push(v);return y}function f(){var y=a();if(!(Fb!=e.charAt(0)||Bb!=e.charAt(1))){for(var v=2;Us!=e.charAt(v)&&(Bb!=e.charAt(v)||Fb!=e.charAt(v+1));)++v;if(v+=2,Us===e.charAt(v-1))return l("End of comment missing");var w=e.slice(2,v-2);return n+=2,s(w),e=e.slice(v),n+=2,y({type:G7,comment:w})}}function m(){var y=a(),v=c(z7);if(v){if(f(),!c(W7))return l("property missing ':'");var w=c(H7),g=y({type:K7,property:Ub(v[0].replace($b,Us)),value:w?Ub(w[0].replace($b,Us)):Us});return c(q7),g}}function h(){var y=[];d(y);for(var v;v=m();)v!==!1&&(y.push(v),d(y));return y}return u(),h()};function Ub(e){return e?e.replace(V7,Us):Us}var J7=Dt&&Dt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n0,"__esModule",{value:!0});n0.default=Z7;var X7=J7(Q7);function Z7(e,t){var r=null;if(!e||typeof e!="string")return r;var n=(0,X7.default)(e),s=typeof t=="function";return n.forEach(function(a){if(a.type==="declaration"){var o=a.property,l=a.value;s?t(o,l,a):l&&(r=r||{},r[o]=l)}}),r}var $d={};Object.defineProperty($d,"__esModule",{value:!0});$d.camelCase=void 0;var eB=/^--[a-zA-Z0-9_-]+$/,tB=/-([a-z])/g,rB=/^[^-]+$/,nB=/^-(webkit|moz|ms|o|khtml)-/,sB=/^-(ms)-/,aB=function(e){return!e||rB.test(e)||eB.test(e)},iB=function(e,t){return t.toUpperCase()},zb=function(e,t){return"".concat(t,"-")},oB=function(e,t){return t===void 0&&(t={}),aB(e)?e:(e=e.toLowerCase(),t.reactCompat?e=e.replace(sB,zb):e=e.replace(nB,zb),e.replace(tB,iB))};$d.camelCase=oB;var lB=Dt&&Dt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},cB=lB(n0),uB=$d;function qh(e,t){var r={};return!e||typeof e!="string"||(0,cB.default)(e,function(n,s){n&&s&&(r[(0,uB.camelCase)(n,t)]=s)}),r}qh.default=qh;var dB=qh;const fB=pl(dB),aN=iN("end"),s0=iN("start");function iN(e){return t;function t(r){const n=r&&r.position&&r.position[e]||{};if(typeof n.line=="number"&&n.line>0&&typeof n.column=="number"&&n.column>0)return{line:n.line,column:n.column,offset:typeof n.offset=="number"&&n.offset>-1?n.offset:void 0}}}function mB(e){const t=s0(e),r=aN(e);if(t&&r)return{start:t,end:r}}function Mo(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?Wb(e.position):"start"in e||"end"in e?Wb(e):"line"in e||"column"in e?Vh(e):""}function Vh(e){return Hb(e&&e.line)+":"+Hb(e&&e.column)}function Wb(e){return Vh(e&&e.start)+"-"+Vh(e&&e.end)}function Hb(e){return e&&typeof e=="number"?e:1}class Tt extends Error{constructor(t,r,n){super(),typeof r=="string"&&(n=r,r=void 0);let s="",a={},o=!1;if(r&&("line"in r&&"column"in r?a={place:r}:"start"in r&&"end"in r?a={place:r}:"type"in r?a={ancestors:[r],place:r.position}:a={...r}),typeof t=="string"?s=t:!a.cause&&t&&(o=!0,s=t.message,a.cause=t),!a.ruleId&&!a.source&&typeof n=="string"){const c=n.indexOf(":");c===-1?a.ruleId=n:(a.source=n.slice(0,c),a.ruleId=n.slice(c+1))}if(!a.place&&a.ancestors&&a.ancestors){const c=a.ancestors[a.ancestors.length-1];c&&(a.place=c.position)}const l=a.place&&"start"in a.place?a.place.start:a.place;this.ancestors=a.ancestors||void 0,this.cause=a.cause||void 0,this.column=l?l.column:void 0,this.fatal=void 0,this.file="",this.message=s,this.line=l?l.line:void 0,this.name=Mo(a.place)||"1:1",this.place=a.place||void 0,this.reason=this.message,this.ruleId=a.ruleId||void 0,this.source=a.source||void 0,this.stack=o&&a.cause&&typeof a.cause.stack=="string"?a.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}Tt.prototype.file="";Tt.prototype.name="";Tt.prototype.reason="";Tt.prototype.message="";Tt.prototype.stack="";Tt.prototype.column=void 0;Tt.prototype.line=void 0;Tt.prototype.ancestors=void 0;Tt.prototype.cause=void 0;Tt.prototype.fatal=void 0;Tt.prototype.place=void 0;Tt.prototype.ruleId=void 0;Tt.prototype.source=void 0;const a0={}.hasOwnProperty,hB=new Map,pB=/[A-Z]/g,gB=new Set(["table","tbody","thead","tfoot","tr"]),xB=new Set(["td","th"]),oN="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function yB(e,t){if(!t||t.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const r=t.filePath||void 0;let n;if(t.development){if(typeof t.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");n=SB(r,t.jsxDEV)}else{if(typeof t.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof t.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");n=NB(r,t.jsx,t.jsxs)}const s={Fragment:t.Fragment,ancestors:[],components:t.components||{},create:n,elementAttributeNameCase:t.elementAttributeNameCase||"react",evaluater:t.createEvaluater?t.createEvaluater():void 0,filePath:r,ignoreInvalidStyle:t.ignoreInvalidStyle||!1,passKeys:t.passKeys!==!1,passNode:t.passNode||!1,schema:t.space==="svg"?r0:$7,stylePropertyNameCase:t.stylePropertyNameCase||"dom",tableCellAlignToStyle:t.tableCellAlignToStyle!==!1},a=lN(s,e,void 0);return a&&typeof a!="string"?a:s.create(e,s.Fragment,{children:a||void 0},void 0)}function lN(e,t,r){if(t.type==="element")return bB(e,t,r);if(t.type==="mdxFlowExpression"||t.type==="mdxTextExpression")return vB(e,t);if(t.type==="mdxJsxFlowElement"||t.type==="mdxJsxTextElement")return _B(e,t,r);if(t.type==="mdxjsEsm")return wB(e,t);if(t.type==="root")return jB(e,t,r);if(t.type==="text")return kB(e,t)}function bB(e,t,r){const n=e.schema;let s=n;t.tagName.toLowerCase()==="svg"&&n.space==="html"&&(s=r0,e.schema=s),e.ancestors.push(t);const a=uN(e,t.tagName,!1),o=CB(e,t);let l=o0(e,t);return gB.has(t.tagName)&&(l=l.filter(function(c){return typeof c=="string"?!E7(c):!0})),cN(e,o,a,t),i0(o,l),e.ancestors.pop(),e.schema=n,e.create(t,a,o,r)}function vB(e,t){if(t.data&&t.data.estree&&e.evaluater){const n=t.data.estree.body[0];return n.type,e.evaluater.evaluateExpression(n.expression)}hl(e,t.position)}function wB(e,t){if(t.data&&t.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(t.data.estree);hl(e,t.position)}function _B(e,t,r){const n=e.schema;let s=n;t.name==="svg"&&n.space==="html"&&(s=r0,e.schema=s),e.ancestors.push(t);const a=t.name===null?e.Fragment:uN(e,t.name,!0),o=EB(e,t),l=o0(e,t);return cN(e,o,a,t),i0(o,l),e.ancestors.pop(),e.schema=n,e.create(t,a,o,r)}function jB(e,t,r){const n={};return i0(n,o0(e,t)),e.create(t,e.Fragment,n,r)}function kB(e,t){return t.value}function cN(e,t,r,n){typeof r!="string"&&r!==e.Fragment&&e.passNode&&(t.node=n)}function i0(e,t){if(t.length>0){const r=t.length>1?t:t[0];r&&(e.children=r)}}function NB(e,t,r){return n;function n(s,a,o,l){const u=Array.isArray(o.children)?r:t;return l?u(a,o,l):u(a,o)}}function SB(e,t){return r;function r(n,s,a,o){const l=Array.isArray(a.children),c=s0(n);return t(s,a,o,l,{columnNumber:c?c.column-1:void 0,fileName:e,lineNumber:c?c.line:void 0},void 0)}}function CB(e,t){const r={};let n,s;for(s in t.properties)if(s!=="children"&&a0.call(t.properties,s)){const a=DB(e,s,t.properties[s]);if(a){const[o,l]=a;e.tableCellAlignToStyle&&o==="align"&&typeof l=="string"&&xB.has(t.tagName)?n=l:r[o]=l}}if(n){const a=r.style||(r.style={});a[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=n}return r}function EB(e,t){const r={};for(const n of t.attributes)if(n.type==="mdxJsxExpressionAttribute")if(n.data&&n.data.estree&&e.evaluater){const a=n.data.estree.body[0];a.type;const o=a.expression;o.type;const l=o.properties[0];l.type,Object.assign(r,e.evaluater.evaluateExpression(l.argument))}else hl(e,t.position);else{const s=n.name;let a;if(n.value&&typeof n.value=="object")if(n.value.data&&n.value.data.estree&&e.evaluater){const l=n.value.data.estree.body[0];l.type,a=e.evaluater.evaluateExpression(l.expression)}else hl(e,t.position);else a=n.value===null?!0:n.value;r[s]=a}return r}function o0(e,t){const r=[];let n=-1;const s=e.passKeys?new Map:hB;for(;++n<t.children.length;){const a=t.children[n];let o;if(e.passKeys){const c=a.type==="element"?a.tagName:a.type==="mdxJsxFlowElement"||a.type==="mdxJsxTextElement"?a.name:void 0;if(c){const u=s.get(c)||0;o=c+"-"+u,s.set(c,u+1)}}const l=lN(e,a,o);l!==void 0&&r.push(l)}return r}function DB(e,t,r){const n=M7(e.schema,t);if(!(r==null||typeof r=="number"&&Number.isNaN(r))){if(Array.isArray(r)&&(r=n.commaSeparated?j7(r):F7(r)),n.property==="style"){let s=typeof r=="object"?r:PB(e,String(r));return e.stylePropertyNameCase==="css"&&(s=TB(s)),["style",s]}return[e.elementAttributeNameCase==="react"&&n.space?L7[n.property]||n.property:n.attribute,r]}}function PB(e,t){try{return fB(t,{reactCompat:!0})}catch(r){if(e.ignoreInvalidStyle)return{};const n=r,s=new Tt("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:n,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw s.file=e.filePath||void 0,s.url=oN+"#cannot-parse-style-attribute",s}}function uN(e,t,r){let n;if(!r)n={type:"Literal",value:t};else if(t.includes(".")){const s=t.split(".");let a=-1,o;for(;++a<s.length;){const l=Rb(s[a])?{type:"Identifier",name:s[a]}:{type:"Literal",value:s[a]};o=o?{type:"MemberExpression",object:o,property:l,computed:!!(a&&l.type==="Literal"),optional:!1}:l}n=o}else n=Rb(t)&&!/^[a-z]/.test(t)?{type:"Identifier",name:t}:{type:"Literal",value:t};if(n.type==="Literal"){const s=n.value;return a0.call(e.components,s)?e.components[s]:s}if(e.evaluater)return e.evaluater.evaluateExpression(n);hl(e)}function hl(e,t){const r=new Tt("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:t,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw r.file=e.filePath||void 0,r.url=oN+"#cannot-handle-mdx-estrees-without-createevaluater",r}function TB(e){const t={};let r;for(r in e)a0.call(e,r)&&(t[LB(r)]=e[r]);return t}function LB(e){let t=e.replace(pB,IB);return t.slice(0,3)==="ms-"&&(t="-"+t),t}function IB(e){return"-"+e.toLowerCase()}const sm={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},RB={};function MB(e,t){const r=t||RB,n=typeof r.includeImageAlt=="boolean"?r.includeImageAlt:!0,s=typeof r.includeHtml=="boolean"?r.includeHtml:!0;return dN(e,n,s)}function dN(e,t,r){if(OB(e)){if("value"in e)return e.type==="html"&&!r?"":e.value;if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return qb(e.children,t,r)}return Array.isArray(e)?qb(e,t,r):""}function qb(e,t,r){const n=[];let s=-1;for(;++s<e.length;)n[s]=dN(e[s],t,r);return n.join("")}function OB(e){return!!(e&&typeof e=="object")}const Vb=document.createElement("i");function l0(e){const t="&"+e+";";Vb.innerHTML=t;const r=Vb.textContent;return r.charCodeAt(r.length-1)===59&&e!=="semi"||r===t?!1:r}function hn(e,t,r,n){const s=e.length;let a=0,o;if(t<0?t=-t>s?0:s+t:t=t>s?s:t,r=r>0?r:0,n.length<1e4)o=Array.from(n),o.unshift(t,r),e.splice(...o);else for(r&&e.splice(t,r);a<n.length;)o=n.slice(a,a+1e4),o.unshift(t,0),e.splice(...o),a+=1e4,t+=1e4}function br(e,t){return e.length>0?(hn(e,e.length,0,t),e):t}const Yb={}.hasOwnProperty;function AB(e){const t={};let r=-1;for(;++r<e.length;)$B(t,e[r]);return t}function $B(e,t){let r;for(r in t){const s=(Yb.call(e,r)?e[r]:void 0)||(e[r]={}),a=t[r];let o;if(a)for(o in a){Yb.call(s,o)||(s[o]=[]);const l=a[o];FB(s[o],Array.isArray(l)?l:l?[l]:[])}}}function FB(e,t){let r=-1;const n=[];for(;++r<t.length;)(t[r].add==="after"?e:n).push(t[r]);hn(e,0,0,n)}function fN(e,t){const r=Number.parseInt(e,t);return r<9||r===11||r>13&&r<32||r>126&&r<160||r>55295&&r<57344||r>64975&&r<65008||(r&65535)===65535||(r&65535)===65534||r>1114111?"":String.fromCodePoint(r)}function Xa(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const sn=Ns(/[A-Za-z]/),sr=Ns(/[\dA-Za-z]/),BB=Ns(/[#-'*+\--9=?A-Z^-~]/);function Yh(e){return e!==null&&(e<32||e===127)}const Gh=Ns(/\d/),UB=Ns(/[\dA-Fa-f]/),zB=Ns(/[!-/:-@[-`{-~]/);function me(e){return e!==null&&e<-2}function Qt(e){return e!==null&&(e<0||e===32)}function Te(e){return e===-2||e===-1||e===32}const WB=Ns(/\p{P}|\p{S}/u),HB=Ns(/\s/);function Ns(e){return t;function t(r){return r!==null&&r>-1&&e.test(String.fromCharCode(r))}}function Ii(e){const t=[];let r=-1,n=0,s=0;for(;++r<e.length;){const a=e.charCodeAt(r);let o="";if(a===37&&sr(e.charCodeAt(r+1))&&sr(e.charCodeAt(r+2)))s=2;else if(a<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(a))||(o=String.fromCharCode(a));else if(a>55295&&a<57344){const l=e.charCodeAt(r+1);a<56320&&l>56319&&l<57344?(o=String.fromCharCode(a,l),s=1):o=""}else o=String.fromCharCode(a);o&&(t.push(e.slice(n,r),encodeURIComponent(o)),n=r+s+1,o=""),s&&(r+=s,s=0)}return t.join("")+e.slice(n)}function qe(e,t,r,n){const s=n?n-1:Number.POSITIVE_INFINITY;let a=0;return o;function o(c){return Te(c)?(e.enter(r),l(c)):t(c)}function l(c){return Te(c)&&a++<s?(e.consume(c),l):(e.exit(r),t(c))}}const qB={tokenize:VB};function VB(e){const t=e.attempt(this.parser.constructs.contentInitial,n,s);let r;return t;function n(l){if(l===null){e.consume(l);return}return e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),qe(e,t,"linePrefix")}function s(l){return e.enter("paragraph"),a(l)}function a(l){const c=e.enter("chunkText",{contentType:"text",previous:r});return r&&(r.next=c),r=c,o(l)}function o(l){if(l===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(l);return}return me(l)?(e.consume(l),e.exit("chunkText"),a):(e.consume(l),o)}}const YB={tokenize:GB},Gb={tokenize:KB};function GB(e){const t=this,r=[];let n=0,s,a,o;return l;function l(p){if(n<r.length){const _=r[n];return t.containerState=_[1],e.attempt(_[0].continuation,c,u)(p)}return u(p)}function c(p){if(n++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,s&&b();const _=t.events.length;let j=_,k;for(;j--;)if(t.events[j][0]==="exit"&&t.events[j][1].type==="chunkFlow"){k=t.events[j][1].end;break}g(n);let N=_;for(;N<t.events.length;)t.events[N][1].end={...k},N++;return hn(t.events,j+1,0,t.events.slice(_)),t.events.length=N,u(p)}return l(p)}function u(p){if(n===r.length){if(!s)return m(p);if(s.currentConstruct&&s.currentConstruct.concrete)return y(p);t.interrupt=!!(s.currentConstruct&&!s._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(Gb,d,f)(p)}function d(p){return s&&b(),g(n),m(p)}function f(p){return t.parser.lazy[t.now().line]=n!==r.length,o=t.now().offset,y(p)}function m(p){return t.containerState={},e.attempt(Gb,h,y)(p)}function h(p){return n++,r.push([t.currentConstruct,t.containerState]),m(p)}function y(p){if(p===null){s&&b(),g(0),e.consume(p);return}return s=s||t.parser.flow(t.now()),e.enter("chunkFlow",{_tokenizer:s,contentType:"flow",previous:a}),v(p)}function v(p){if(p===null){w(e.exit("chunkFlow"),!0),g(0),e.consume(p);return}return me(p)?(e.consume(p),w(e.exit("chunkFlow")),n=0,t.interrupt=void 0,l):(e.consume(p),v)}function w(p,_){const j=t.sliceStream(p);if(_&&j.push(null),p.previous=a,a&&(a.next=p),a=p,s.defineSkip(p.start),s.write(j),t.parser.lazy[p.start.line]){let k=s.events.length;for(;k--;)if(s.events[k][1].start.offset<o&&(!s.events[k][1].end||s.events[k][1].end.offset>o))return;const N=t.events.length;let S=N,C,E;for(;S--;)if(t.events[S][0]==="exit"&&t.events[S][1].type==="chunkFlow"){if(C){E=t.events[S][1].end;break}C=!0}for(g(n),k=N;k<t.events.length;)t.events[k][1].end={...E},k++;hn(t.events,S+1,0,t.events.slice(N)),t.events.length=k}}function g(p){let _=r.length;for(;_-- >p;){const j=r[_];t.containerState=j[1],j[0].exit.call(t,e)}r.length=p}function b(){s.write([null]),a=void 0,s=void 0,t.containerState._closeFlow=void 0}}function KB(e,t,r){return qe(e,e.attempt(this.parser.constructs.document,t,r),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Kb(e){if(e===null||Qt(e)||HB(e))return 1;if(WB(e))return 2}function c0(e,t,r){const n=[];let s=-1;for(;++s<e.length;){const a=e[s].resolveAll;a&&!n.includes(a)&&(t=a(t,r),n.push(a))}return t}const Kh={name:"attention",resolveAll:QB,tokenize:JB};function QB(e,t){let r=-1,n,s,a,o,l,c,u,d;for(;++r<e.length;)if(e[r][0]==="enter"&&e[r][1].type==="attentionSequence"&&e[r][1]._close){for(n=r;n--;)if(e[n][0]==="exit"&&e[n][1].type==="attentionSequence"&&e[n][1]._open&&t.sliceSerialize(e[n][1]).charCodeAt(0)===t.sliceSerialize(e[r][1]).charCodeAt(0)){if((e[n][1]._close||e[r][1]._open)&&(e[r][1].end.offset-e[r][1].start.offset)%3&&!((e[n][1].end.offset-e[n][1].start.offset+e[r][1].end.offset-e[r][1].start.offset)%3))continue;c=e[n][1].end.offset-e[n][1].start.offset>1&&e[r][1].end.offset-e[r][1].start.offset>1?2:1;const f={...e[n][1].end},m={...e[r][1].start};Qb(f,-c),Qb(m,c),o={type:c>1?"strongSequence":"emphasisSequence",start:f,end:{...e[n][1].end}},l={type:c>1?"strongSequence":"emphasisSequence",start:{...e[r][1].start},end:m},a={type:c>1?"strongText":"emphasisText",start:{...e[n][1].end},end:{...e[r][1].start}},s={type:c>1?"strong":"emphasis",start:{...o.start},end:{...l.end}},e[n][1].end={...o.start},e[r][1].start={...l.end},u=[],e[n][1].end.offset-e[n][1].start.offset&&(u=br(u,[["enter",e[n][1],t],["exit",e[n][1],t]])),u=br(u,[["enter",s,t],["enter",o,t],["exit",o,t],["enter",a,t]]),u=br(u,c0(t.parser.constructs.insideSpan.null,e.slice(n+1,r),t)),u=br(u,[["exit",a,t],["enter",l,t],["exit",l,t],["exit",s,t]]),e[r][1].end.offset-e[r][1].start.offset?(d=2,u=br(u,[["enter",e[r][1],t],["exit",e[r][1],t]])):d=0,hn(e,n-1,r-n+3,u),r=n+u.length-d-2;break}}for(r=-1;++r<e.length;)e[r][1].type==="attentionSequence"&&(e[r][1].type="data");return e}function JB(e,t){const r=this.parser.constructs.attentionMarkers.null,n=this.previous,s=Kb(n);let a;return o;function o(c){return a=c,e.enter("attentionSequence"),l(c)}function l(c){if(c===a)return e.consume(c),l;const u=e.exit("attentionSequence"),d=Kb(c),f=!d||d===2&&s||r.includes(c),m=!s||s===2&&d||r.includes(n);return u._open=!!(a===42?f:f&&(s||!m)),u._close=!!(a===42?m:m&&(d||!f)),t(c)}}function Qb(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const XB={name:"autolink",tokenize:ZB};function ZB(e,t,r){let n=0;return s;function s(h){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(h),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),a}function a(h){return sn(h)?(e.consume(h),o):h===64?r(h):u(h)}function o(h){return h===43||h===45||h===46||sr(h)?(n=1,l(h)):u(h)}function l(h){return h===58?(e.consume(h),n=0,c):(h===43||h===45||h===46||sr(h))&&n++<32?(e.consume(h),l):(n=0,u(h))}function c(h){return h===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(h),e.exit("autolinkMarker"),e.exit("autolink"),t):h===null||h===32||h===60||Yh(h)?r(h):(e.consume(h),c)}function u(h){return h===64?(e.consume(h),d):BB(h)?(e.consume(h),u):r(h)}function d(h){return sr(h)?f(h):r(h)}function f(h){return h===46?(e.consume(h),n=0,d):h===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(h),e.exit("autolinkMarker"),e.exit("autolink"),t):m(h)}function m(h){if((h===45||sr(h))&&n++<63){const y=h===45?m:f;return e.consume(h),y}return r(h)}}const Fd={partial:!0,tokenize:e8};function e8(e,t,r){return n;function n(a){return Te(a)?qe(e,s,"linePrefix")(a):s(a)}function s(a){return a===null||me(a)?t(a):r(a)}}const mN={continuation:{tokenize:r8},exit:n8,name:"blockQuote",tokenize:t8};function t8(e,t,r){const n=this;return s;function s(o){if(o===62){const l=n.containerState;return l.open||(e.enter("blockQuote",{_container:!0}),l.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(o),e.exit("blockQuoteMarker"),a}return r(o)}function a(o){return Te(o)?(e.enter("blockQuotePrefixWhitespace"),e.consume(o),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(o))}}function r8(e,t,r){const n=this;return s;function s(o){return Te(o)?qe(e,a,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o):a(o)}function a(o){return e.attempt(mN,t,r)(o)}}function n8(e){e.exit("blockQuote")}const hN={name:"characterEscape",tokenize:s8};function s8(e,t,r){return n;function n(a){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(a),e.exit("escapeMarker"),s}function s(a){return zB(a)?(e.enter("characterEscapeValue"),e.consume(a),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):r(a)}}const pN={name:"characterReference",tokenize:a8};function a8(e,t,r){const n=this;let s=0,a,o;return l;function l(f){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(f),e.exit("characterReferenceMarker"),c}function c(f){return f===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(f),e.exit("characterReferenceMarkerNumeric"),u):(e.enter("characterReferenceValue"),a=31,o=sr,d(f))}function u(f){return f===88||f===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(f),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),a=6,o=UB,d):(e.enter("characterReferenceValue"),a=7,o=Gh,d(f))}function d(f){if(f===59&&s){const m=e.exit("characterReferenceValue");return o===sr&&!l0(n.sliceSerialize(m))?r(f):(e.enter("characterReferenceMarker"),e.consume(f),e.exit("characterReferenceMarker"),e.exit("characterReference"),t)}return o(f)&&s++<a?(e.consume(f),d):r(f)}}const Jb={partial:!0,tokenize:o8},Xb={concrete:!0,name:"codeFenced",tokenize:i8};function i8(e,t,r){const n=this,s={partial:!0,tokenize:j};let a=0,o=0,l;return c;function c(k){return u(k)}function u(k){const N=n.events[n.events.length-1];return a=N&&N[1].type==="linePrefix"?N[2].sliceSerialize(N[1],!0).length:0,l=k,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),d(k)}function d(k){return k===l?(o++,e.consume(k),d):o<3?r(k):(e.exit("codeFencedFenceSequence"),Te(k)?qe(e,f,"whitespace")(k):f(k))}function f(k){return k===null||me(k)?(e.exit("codeFencedFence"),n.interrupt?t(k):e.check(Jb,v,_)(k)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),m(k))}function m(k){return k===null||me(k)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),f(k)):Te(k)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),qe(e,h,"whitespace")(k)):k===96&&k===l?r(k):(e.consume(k),m)}function h(k){return k===null||me(k)?f(k):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),y(k))}function y(k){return k===null||me(k)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),f(k)):k===96&&k===l?r(k):(e.consume(k),y)}function v(k){return e.attempt(s,_,w)(k)}function w(k){return e.enter("lineEnding"),e.consume(k),e.exit("lineEnding"),g}function g(k){return a>0&&Te(k)?qe(e,b,"linePrefix",a+1)(k):b(k)}function b(k){return k===null||me(k)?e.check(Jb,v,_)(k):(e.enter("codeFlowValue"),p(k))}function p(k){return k===null||me(k)?(e.exit("codeFlowValue"),b(k)):(e.consume(k),p)}function _(k){return e.exit("codeFenced"),t(k)}function j(k,N,S){let C=0;return E;function E(M){return k.enter("lineEnding"),k.consume(M),k.exit("lineEnding"),T}function T(M){return k.enter("codeFencedFence"),Te(M)?qe(k,L,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(M):L(M)}function L(M){return M===l?(k.enter("codeFencedFenceSequence"),O(M)):S(M)}function O(M){return M===l?(C++,k.consume(M),O):C>=o?(k.exit("codeFencedFenceSequence"),Te(M)?qe(k,A,"whitespace")(M):A(M)):S(M)}function A(M){return M===null||me(M)?(k.exit("codeFencedFence"),N(M)):S(M)}}}function o8(e,t,r){const n=this;return s;function s(o){return o===null?r(o):(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),a)}function a(o){return n.parser.lazy[n.now().line]?r(o):t(o)}}const am={name:"codeIndented",tokenize:c8},l8={partial:!0,tokenize:u8};function c8(e,t,r){const n=this;return s;function s(u){return e.enter("codeIndented"),qe(e,a,"linePrefix",4+1)(u)}function a(u){const d=n.events[n.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?o(u):r(u)}function o(u){return u===null?c(u):me(u)?e.attempt(l8,o,c)(u):(e.enter("codeFlowValue"),l(u))}function l(u){return u===null||me(u)?(e.exit("codeFlowValue"),o(u)):(e.consume(u),l)}function c(u){return e.exit("codeIndented"),t(u)}}function u8(e,t,r){const n=this;return s;function s(o){return n.parser.lazy[n.now().line]?r(o):me(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),s):qe(e,a,"linePrefix",4+1)(o)}function a(o){const l=n.events[n.events.length-1];return l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?t(o):me(o)?s(o):r(o)}}const d8={name:"codeText",previous:m8,resolve:f8,tokenize:h8};function f8(e){let t=e.length-4,r=3,n,s;if((e[r][1].type==="lineEnding"||e[r][1].type==="space")&&(e[t][1].type==="lineEnding"||e[t][1].type==="space")){for(n=r;++n<t;)if(e[n][1].type==="codeTextData"){e[r][1].type="codeTextPadding",e[t][1].type="codeTextPadding",r+=2,t-=2;break}}for(n=r-1,t++;++n<=t;)s===void 0?n!==t&&e[n][1].type!=="lineEnding"&&(s=n):(n===t||e[n][1].type==="lineEnding")&&(e[s][1].type="codeTextData",n!==s+2&&(e[s][1].end=e[n-1][1].end,e.splice(s+2,n-s-2),t-=n-s-2,n=s+2),s=void 0);return e}function m8(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function h8(e,t,r){let n=0,s,a;return o;function o(f){return e.enter("codeText"),e.enter("codeTextSequence"),l(f)}function l(f){return f===96?(e.consume(f),n++,l):(e.exit("codeTextSequence"),c(f))}function c(f){return f===null?r(f):f===32?(e.enter("space"),e.consume(f),e.exit("space"),c):f===96?(a=e.enter("codeTextSequence"),s=0,d(f)):me(f)?(e.enter("lineEnding"),e.consume(f),e.exit("lineEnding"),c):(e.enter("codeTextData"),u(f))}function u(f){return f===null||f===32||f===96||me(f)?(e.exit("codeTextData"),c(f)):(e.consume(f),u)}function d(f){return f===96?(e.consume(f),s++,d):s===n?(e.exit("codeTextSequence"),e.exit("codeText"),t(f)):(a.type="codeTextData",u(f))}}class p8{constructor(t){this.left=t?[...t]:[],this.right=[]}get(t){if(t<0||t>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+t+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return t<this.left.length?this.left[t]:this.right[this.right.length-t+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(t,r){const n=r??Number.POSITIVE_INFINITY;return n<this.left.length?this.left.slice(t,n):t>this.left.length?this.right.slice(this.right.length-n+this.left.length,this.right.length-t+this.left.length).reverse():this.left.slice(t).concat(this.right.slice(this.right.length-n+this.left.length).reverse())}splice(t,r,n){const s=r||0;this.setCursor(Math.trunc(t));const a=this.right.splice(this.right.length-s,Number.POSITIVE_INFINITY);return n&&ao(this.left,n),a.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(t){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(t)}pushMany(t){this.setCursor(Number.POSITIVE_INFINITY),ao(this.left,t)}unshift(t){this.setCursor(0),this.right.push(t)}unshiftMany(t){this.setCursor(0),ao(this.right,t.reverse())}setCursor(t){if(!(t===this.left.length||t>this.left.length&&this.right.length===0||t<0&&this.left.length===0))if(t<this.left.length){const r=this.left.splice(t,Number.POSITIVE_INFINITY);ao(this.right,r.reverse())}else{const r=this.right.splice(this.left.length+this.right.length-t,Number.POSITIVE_INFINITY);ao(this.left,r.reverse())}}}function ao(e,t){let r=0;if(t.length<1e4)e.push(...t);else for(;r<t.length;)e.push(...t.slice(r,r+1e4)),r+=1e4}function gN(e){const t={};let r=-1,n,s,a,o,l,c,u;const d=new p8(e);for(;++r<d.length;){for(;r in t;)r=t[r];if(n=d.get(r),r&&n[1].type==="chunkFlow"&&d.get(r-1)[1].type==="listItemPrefix"&&(c=n[1]._tokenizer.events,a=0,a<c.length&&c[a][1].type==="lineEndingBlank"&&(a+=2),a<c.length&&c[a][1].type==="content"))for(;++a<c.length&&c[a][1].type!=="content";)c[a][1].type==="chunkText"&&(c[a][1]._isInFirstContentOfListItem=!0,a++);if(n[0]==="enter")n[1].contentType&&(Object.assign(t,g8(d,r)),r=t[r],u=!0);else if(n[1]._container){for(a=r,s=void 0;a--;)if(o=d.get(a),o[1].type==="lineEnding"||o[1].type==="lineEndingBlank")o[0]==="enter"&&(s&&(d.get(s)[1].type="lineEndingBlank"),o[1].type="lineEnding",s=a);else if(!(o[1].type==="linePrefix"||o[1].type==="listItemIndent"))break;s&&(n[1].end={...d.get(s)[1].start},l=d.slice(s,r),l.unshift(n),d.splice(s,r-s+1,l))}}return hn(e,0,Number.POSITIVE_INFINITY,d.slice(0)),!u}function g8(e,t){const r=e.get(t)[1],n=e.get(t)[2];let s=t-1;const a=[];let o=r._tokenizer;o||(o=n.parser[r.contentType](r.start),r._contentTypeTextTrailing&&(o._contentTypeTextTrailing=!0));const l=o.events,c=[],u={};let d,f,m=-1,h=r,y=0,v=0;const w=[v];for(;h;){for(;e.get(++s)[1]!==h;);a.push(s),h._tokenizer||(d=n.sliceStream(h),h.next||d.push(null),f&&o.defineSkip(h.start),h._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=!0),o.write(d),h._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=void 0)),f=h,h=h.next}for(h=r;++m<l.length;)l[m][0]==="exit"&&l[m-1][0]==="enter"&&l[m][1].type===l[m-1][1].type&&l[m][1].start.line!==l[m][1].end.line&&(v=m+1,w.push(v),h._tokenizer=void 0,h.previous=void 0,h=h.next);for(o.events=[],h?(h._tokenizer=void 0,h.previous=void 0):w.pop(),m=w.length;m--;){const g=l.slice(w[m],w[m+1]),b=a.pop();c.push([b,b+g.length-1]),e.splice(b,2,g)}for(c.reverse(),m=-1;++m<c.length;)u[y+c[m][0]]=y+c[m][1],y+=c[m][1]-c[m][0]-1;return u}const x8={resolve:b8,tokenize:v8},y8={partial:!0,tokenize:w8};function b8(e){return gN(e),e}function v8(e,t){let r;return n;function n(l){return e.enter("content"),r=e.enter("chunkContent",{contentType:"content"}),s(l)}function s(l){return l===null?a(l):me(l)?e.check(y8,o,a)(l):(e.consume(l),s)}function a(l){return e.exit("chunkContent"),e.exit("content"),t(l)}function o(l){return e.consume(l),e.exit("chunkContent"),r.next=e.enter("chunkContent",{contentType:"content",previous:r}),r=r.next,s}}function w8(e,t,r){const n=this;return s;function s(o){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),qe(e,a,"linePrefix")}function a(o){if(o===null||me(o))return r(o);const l=n.events[n.events.length-1];return!n.parser.constructs.disable.null.includes("codeIndented")&&l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?t(o):e.interrupt(n.parser.constructs.flow,r,t)(o)}}function xN(e,t,r,n,s,a,o,l,c){const u=c||Number.POSITIVE_INFINITY;let d=0;return f;function f(g){return g===60?(e.enter(n),e.enter(s),e.enter(a),e.consume(g),e.exit(a),m):g===null||g===32||g===41||Yh(g)?r(g):(e.enter(n),e.enter(o),e.enter(l),e.enter("chunkString",{contentType:"string"}),v(g))}function m(g){return g===62?(e.enter(a),e.consume(g),e.exit(a),e.exit(s),e.exit(n),t):(e.enter(l),e.enter("chunkString",{contentType:"string"}),h(g))}function h(g){return g===62?(e.exit("chunkString"),e.exit(l),m(g)):g===null||g===60||me(g)?r(g):(e.consume(g),g===92?y:h)}function y(g){return g===60||g===62||g===92?(e.consume(g),h):h(g)}function v(g){return!d&&(g===null||g===41||Qt(g))?(e.exit("chunkString"),e.exit(l),e.exit(o),e.exit(n),t(g)):d<u&&g===40?(e.consume(g),d++,v):g===41?(e.consume(g),d--,v):g===null||g===32||g===40||Yh(g)?r(g):(e.consume(g),g===92?w:v)}function w(g){return g===40||g===41||g===92?(e.consume(g),v):v(g)}}function yN(e,t,r,n,s,a){const o=this;let l=0,c;return u;function u(h){return e.enter(n),e.enter(s),e.consume(h),e.exit(s),e.enter(a),d}function d(h){return l>999||h===null||h===91||h===93&&!c||h===94&&!l&&"_hiddenFootnoteSupport"in o.parser.constructs?r(h):h===93?(e.exit(a),e.enter(s),e.consume(h),e.exit(s),e.exit(n),t):me(h)?(e.enter("lineEnding"),e.consume(h),e.exit("lineEnding"),d):(e.enter("chunkString",{contentType:"string"}),f(h))}function f(h){return h===null||h===91||h===93||me(h)||l++>999?(e.exit("chunkString"),d(h)):(e.consume(h),c||(c=!Te(h)),h===92?m:f)}function m(h){return h===91||h===92||h===93?(e.consume(h),l++,f):f(h)}}function bN(e,t,r,n,s,a){let o;return l;function l(m){return m===34||m===39||m===40?(e.enter(n),e.enter(s),e.consume(m),e.exit(s),o=m===40?41:m,c):r(m)}function c(m){return m===o?(e.enter(s),e.consume(m),e.exit(s),e.exit(n),t):(e.enter(a),u(m))}function u(m){return m===o?(e.exit(a),c(o)):m===null?r(m):me(m)?(e.enter("lineEnding"),e.consume(m),e.exit("lineEnding"),qe(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),d(m))}function d(m){return m===o||m===null||me(m)?(e.exit("chunkString"),u(m)):(e.consume(m),m===92?f:d)}function f(m){return m===o||m===92?(e.consume(m),d):d(m)}}function Oo(e,t){let r;return n;function n(s){return me(s)?(e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),r=!0,n):Te(s)?qe(e,n,r?"linePrefix":"lineSuffix")(s):t(s)}}const _8={name:"definition",tokenize:k8},j8={partial:!0,tokenize:N8};function k8(e,t,r){const n=this;let s;return a;function a(h){return e.enter("definition"),o(h)}function o(h){return yN.call(n,e,l,r,"definitionLabel","definitionLabelMarker","definitionLabelString")(h)}function l(h){return s=Xa(n.sliceSerialize(n.events[n.events.length-1][1]).slice(1,-1)),h===58?(e.enter("definitionMarker"),e.consume(h),e.exit("definitionMarker"),c):r(h)}function c(h){return Qt(h)?Oo(e,u)(h):u(h)}function u(h){return xN(e,d,r,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(h)}function d(h){return e.attempt(j8,f,f)(h)}function f(h){return Te(h)?qe(e,m,"whitespace")(h):m(h)}function m(h){return h===null||me(h)?(e.exit("definition"),n.parser.defined.push(s),t(h)):r(h)}}function N8(e,t,r){return n;function n(l){return Qt(l)?Oo(e,s)(l):r(l)}function s(l){return bN(e,a,r,"definitionTitle","definitionTitleMarker","definitionTitleString")(l)}function a(l){return Te(l)?qe(e,o,"whitespace")(l):o(l)}function o(l){return l===null||me(l)?t(l):r(l)}}const S8={name:"hardBreakEscape",tokenize:C8};function C8(e,t,r){return n;function n(a){return e.enter("hardBreakEscape"),e.consume(a),s}function s(a){return me(a)?(e.exit("hardBreakEscape"),t(a)):r(a)}}const E8={name:"headingAtx",resolve:D8,tokenize:P8};function D8(e,t){let r=e.length-2,n=3,s,a;return e[n][1].type==="whitespace"&&(n+=2),r-2>n&&e[r][1].type==="whitespace"&&(r-=2),e[r][1].type==="atxHeadingSequence"&&(n===r-1||r-4>n&&e[r-2][1].type==="whitespace")&&(r-=n+1===r?2:4),r>n&&(s={type:"atxHeadingText",start:e[n][1].start,end:e[r][1].end},a={type:"chunkText",start:e[n][1].start,end:e[r][1].end,contentType:"text"},hn(e,n,r-n+1,[["enter",s,t],["enter",a,t],["exit",a,t],["exit",s,t]])),e}function P8(e,t,r){let n=0;return s;function s(d){return e.enter("atxHeading"),a(d)}function a(d){return e.enter("atxHeadingSequence"),o(d)}function o(d){return d===35&&n++<6?(e.consume(d),o):d===null||Qt(d)?(e.exit("atxHeadingSequence"),l(d)):r(d)}function l(d){return d===35?(e.enter("atxHeadingSequence"),c(d)):d===null||me(d)?(e.exit("atxHeading"),t(d)):Te(d)?qe(e,l,"whitespace")(d):(e.enter("atxHeadingText"),u(d))}function c(d){return d===35?(e.consume(d),c):(e.exit("atxHeadingSequence"),l(d))}function u(d){return d===null||d===35||Qt(d)?(e.exit("atxHeadingText"),l(d)):(e.consume(d),u)}}const T8=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],Zb=["pre","script","style","textarea"],L8={concrete:!0,name:"htmlFlow",resolveTo:M8,tokenize:O8},I8={partial:!0,tokenize:$8},R8={partial:!0,tokenize:A8};function M8(e){let t=e.length;for(;t--&&!(e[t][0]==="enter"&&e[t][1].type==="htmlFlow"););return t>1&&e[t-2][1].type==="linePrefix"&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e}function O8(e,t,r){const n=this;let s,a,o,l,c;return u;function u(I){return d(I)}function d(I){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(I),f}function f(I){return I===33?(e.consume(I),m):I===47?(e.consume(I),a=!0,v):I===63?(e.consume(I),s=3,n.interrupt?t:D):sn(I)?(e.consume(I),o=String.fromCharCode(I),w):r(I)}function m(I){return I===45?(e.consume(I),s=2,h):I===91?(e.consume(I),s=5,l=0,y):sn(I)?(e.consume(I),s=4,n.interrupt?t:D):r(I)}function h(I){return I===45?(e.consume(I),n.interrupt?t:D):r(I)}function y(I){const ne="CDATA[";return I===ne.charCodeAt(l++)?(e.consume(I),l===ne.length?n.interrupt?t:L:y):r(I)}function v(I){return sn(I)?(e.consume(I),o=String.fromCharCode(I),w):r(I)}function w(I){if(I===null||I===47||I===62||Qt(I)){const ne=I===47,re=o.toLowerCase();return!ne&&!a&&Zb.includes(re)?(s=1,n.interrupt?t(I):L(I)):T8.includes(o.toLowerCase())?(s=6,ne?(e.consume(I),g):n.interrupt?t(I):L(I)):(s=7,n.interrupt&&!n.parser.lazy[n.now().line]?r(I):a?b(I):p(I))}return I===45||sr(I)?(e.consume(I),o+=String.fromCharCode(I),w):r(I)}function g(I){return I===62?(e.consume(I),n.interrupt?t:L):r(I)}function b(I){return Te(I)?(e.consume(I),b):E(I)}function p(I){return I===47?(e.consume(I),E):I===58||I===95||sn(I)?(e.consume(I),_):Te(I)?(e.consume(I),p):E(I)}function _(I){return I===45||I===46||I===58||I===95||sr(I)?(e.consume(I),_):j(I)}function j(I){return I===61?(e.consume(I),k):Te(I)?(e.consume(I),j):p(I)}function k(I){return I===null||I===60||I===61||I===62||I===96?r(I):I===34||I===39?(e.consume(I),c=I,N):Te(I)?(e.consume(I),k):S(I)}function N(I){return I===c?(e.consume(I),c=null,C):I===null||me(I)?r(I):(e.consume(I),N)}function S(I){return I===null||I===34||I===39||I===47||I===60||I===61||I===62||I===96||Qt(I)?j(I):(e.consume(I),S)}function C(I){return I===47||I===62||Te(I)?p(I):r(I)}function E(I){return I===62?(e.consume(I),T):r(I)}function T(I){return I===null||me(I)?L(I):Te(I)?(e.consume(I),T):r(I)}function L(I){return I===45&&s===2?(e.consume(I),B):I===60&&s===1?(e.consume(I),F):I===62&&s===4?(e.consume(I),z):I===63&&s===3?(e.consume(I),D):I===93&&s===5?(e.consume(I),P):me(I)&&(s===6||s===7)?(e.exit("htmlFlowData"),e.check(I8,W,O)(I)):I===null||me(I)?(e.exit("htmlFlowData"),O(I)):(e.consume(I),L)}function O(I){return e.check(R8,A,W)(I)}function A(I){return e.enter("lineEnding"),e.consume(I),e.exit("lineEnding"),M}function M(I){return I===null||me(I)?O(I):(e.enter("htmlFlowData"),L(I))}function B(I){return I===45?(e.consume(I),D):L(I)}function F(I){return I===47?(e.consume(I),o="",R):L(I)}function R(I){if(I===62){const ne=o.toLowerCase();return Zb.includes(ne)?(e.consume(I),z):L(I)}return sn(I)&&o.length<8?(e.consume(I),o+=String.fromCharCode(I),R):L(I)}function P(I){return I===93?(e.consume(I),D):L(I)}function D(I){return I===62?(e.consume(I),z):I===45&&s===2?(e.consume(I),D):L(I)}function z(I){return I===null||me(I)?(e.exit("htmlFlowData"),W(I)):(e.consume(I),z)}function W(I){return e.exit("htmlFlow"),t(I)}}function A8(e,t,r){const n=this;return s;function s(o){return me(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),a):r(o)}function a(o){return n.parser.lazy[n.now().line]?r(o):t(o)}}function $8(e,t,r){return n;function n(s){return e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),e.attempt(Fd,t,r)}}const F8={name:"htmlText",tokenize:B8};function B8(e,t,r){const n=this;let s,a,o;return l;function l(D){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(D),c}function c(D){return D===33?(e.consume(D),u):D===47?(e.consume(D),j):D===63?(e.consume(D),p):sn(D)?(e.consume(D),S):r(D)}function u(D){return D===45?(e.consume(D),d):D===91?(e.consume(D),a=0,y):sn(D)?(e.consume(D),b):r(D)}function d(D){return D===45?(e.consume(D),h):r(D)}function f(D){return D===null?r(D):D===45?(e.consume(D),m):me(D)?(o=f,F(D)):(e.consume(D),f)}function m(D){return D===45?(e.consume(D),h):f(D)}function h(D){return D===62?B(D):D===45?m(D):f(D)}function y(D){const z="CDATA[";return D===z.charCodeAt(a++)?(e.consume(D),a===z.length?v:y):r(D)}function v(D){return D===null?r(D):D===93?(e.consume(D),w):me(D)?(o=v,F(D)):(e.consume(D),v)}function w(D){return D===93?(e.consume(D),g):v(D)}function g(D){return D===62?B(D):D===93?(e.consume(D),g):v(D)}function b(D){return D===null||D===62?B(D):me(D)?(o=b,F(D)):(e.consume(D),b)}function p(D){return D===null?r(D):D===63?(e.consume(D),_):me(D)?(o=p,F(D)):(e.consume(D),p)}function _(D){return D===62?B(D):p(D)}function j(D){return sn(D)?(e.consume(D),k):r(D)}function k(D){return D===45||sr(D)?(e.consume(D),k):N(D)}function N(D){return me(D)?(o=N,F(D)):Te(D)?(e.consume(D),N):B(D)}function S(D){return D===45||sr(D)?(e.consume(D),S):D===47||D===62||Qt(D)?C(D):r(D)}function C(D){return D===47?(e.consume(D),B):D===58||D===95||sn(D)?(e.consume(D),E):me(D)?(o=C,F(D)):Te(D)?(e.consume(D),C):B(D)}function E(D){return D===45||D===46||D===58||D===95||sr(D)?(e.consume(D),E):T(D)}function T(D){return D===61?(e.consume(D),L):me(D)?(o=T,F(D)):Te(D)?(e.consume(D),T):C(D)}function L(D){return D===null||D===60||D===61||D===62||D===96?r(D):D===34||D===39?(e.consume(D),s=D,O):me(D)?(o=L,F(D)):Te(D)?(e.consume(D),L):(e.consume(D),A)}function O(D){return D===s?(e.consume(D),s=void 0,M):D===null?r(D):me(D)?(o=O,F(D)):(e.consume(D),O)}function A(D){return D===null||D===34||D===39||D===60||D===61||D===96?r(D):D===47||D===62||Qt(D)?C(D):(e.consume(D),A)}function M(D){return D===47||D===62||Qt(D)?C(D):r(D)}function B(D){return D===62?(e.consume(D),e.exit("htmlTextData"),e.exit("htmlText"),t):r(D)}function F(D){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(D),e.exit("lineEnding"),R}function R(D){return Te(D)?qe(e,P,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(D):P(D)}function P(D){return e.enter("htmlTextData"),o(D)}}const u0={name:"labelEnd",resolveAll:H8,resolveTo:q8,tokenize:V8},U8={tokenize:Y8},z8={tokenize:G8},W8={tokenize:K8};function H8(e){let t=-1;const r=[];for(;++t<e.length;){const n=e[t][1];if(r.push(e[t]),n.type==="labelImage"||n.type==="labelLink"||n.type==="labelEnd"){const s=n.type==="labelImage"?4:2;n.type="data",t+=s}}return e.length!==r.length&&hn(e,0,e.length,r),e}function q8(e,t){let r=e.length,n=0,s,a,o,l;for(;r--;)if(s=e[r][1],a){if(s.type==="link"||s.type==="labelLink"&&s._inactive)break;e[r][0]==="enter"&&s.type==="labelLink"&&(s._inactive=!0)}else if(o){if(e[r][0]==="enter"&&(s.type==="labelImage"||s.type==="labelLink")&&!s._balanced&&(a=r,s.type!=="labelLink")){n=2;break}}else s.type==="labelEnd"&&(o=r);const c={type:e[a][1].type==="labelLink"?"link":"image",start:{...e[a][1].start},end:{...e[e.length-1][1].end}},u={type:"label",start:{...e[a][1].start},end:{...e[o][1].end}},d={type:"labelText",start:{...e[a+n+2][1].end},end:{...e[o-2][1].start}};return l=[["enter",c,t],["enter",u,t]],l=br(l,e.slice(a+1,a+n+3)),l=br(l,[["enter",d,t]]),l=br(l,c0(t.parser.constructs.insideSpan.null,e.slice(a+n+4,o-3),t)),l=br(l,[["exit",d,t],e[o-2],e[o-1],["exit",u,t]]),l=br(l,e.slice(o+1)),l=br(l,[["exit",c,t]]),hn(e,a,e.length,l),e}function V8(e,t,r){const n=this;let s=n.events.length,a,o;for(;s--;)if((n.events[s][1].type==="labelImage"||n.events[s][1].type==="labelLink")&&!n.events[s][1]._balanced){a=n.events[s][1];break}return l;function l(m){return a?a._inactive?f(m):(o=n.parser.defined.includes(Xa(n.sliceSerialize({start:a.end,end:n.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(m),e.exit("labelMarker"),e.exit("labelEnd"),c):r(m)}function c(m){return m===40?e.attempt(U8,d,o?d:f)(m):m===91?e.attempt(z8,d,o?u:f)(m):o?d(m):f(m)}function u(m){return e.attempt(W8,d,f)(m)}function d(m){return t(m)}function f(m){return a._balanced=!0,r(m)}}function Y8(e,t,r){return n;function n(f){return e.enter("resource"),e.enter("resourceMarker"),e.consume(f),e.exit("resourceMarker"),s}function s(f){return Qt(f)?Oo(e,a)(f):a(f)}function a(f){return f===41?d(f):xN(e,o,l,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(f)}function o(f){return Qt(f)?Oo(e,c)(f):d(f)}function l(f){return r(f)}function c(f){return f===34||f===39||f===40?bN(e,u,r,"resourceTitle","resourceTitleMarker","resourceTitleString")(f):d(f)}function u(f){return Qt(f)?Oo(e,d)(f):d(f)}function d(f){return f===41?(e.enter("resourceMarker"),e.consume(f),e.exit("resourceMarker"),e.exit("resource"),t):r(f)}}function G8(e,t,r){const n=this;return s;function s(l){return yN.call(n,e,a,o,"reference","referenceMarker","referenceString")(l)}function a(l){return n.parser.defined.includes(Xa(n.sliceSerialize(n.events[n.events.length-1][1]).slice(1,-1)))?t(l):r(l)}function o(l){return r(l)}}function K8(e,t,r){return n;function n(a){return e.enter("reference"),e.enter("referenceMarker"),e.consume(a),e.exit("referenceMarker"),s}function s(a){return a===93?(e.enter("referenceMarker"),e.consume(a),e.exit("referenceMarker"),e.exit("reference"),t):r(a)}}const Q8={name:"labelStartImage",resolveAll:u0.resolveAll,tokenize:J8};function J8(e,t,r){const n=this;return s;function s(l){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(l),e.exit("labelImageMarker"),a}function a(l){return l===91?(e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelImage"),o):r(l)}function o(l){return l===94&&"_hiddenFootnoteSupport"in n.parser.constructs?r(l):t(l)}}const X8={name:"labelStartLink",resolveAll:u0.resolveAll,tokenize:Z8};function Z8(e,t,r){const n=this;return s;function s(o){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(o),e.exit("labelMarker"),e.exit("labelLink"),a}function a(o){return o===94&&"_hiddenFootnoteSupport"in n.parser.constructs?r(o):t(o)}}const im={name:"lineEnding",tokenize:e9};function e9(e,t){return r;function r(n){return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),qe(e,t,"linePrefix")}}const Qc={name:"thematicBreak",tokenize:t9};function t9(e,t,r){let n=0,s;return a;function a(u){return e.enter("thematicBreak"),o(u)}function o(u){return s=u,l(u)}function l(u){return u===s?(e.enter("thematicBreakSequence"),c(u)):n>=3&&(u===null||me(u))?(e.exit("thematicBreak"),t(u)):r(u)}function c(u){return u===s?(e.consume(u),n++,c):(e.exit("thematicBreakSequence"),Te(u)?qe(e,l,"whitespace")(u):l(u))}}const zt={continuation:{tokenize:a9},exit:o9,name:"list",tokenize:s9},r9={partial:!0,tokenize:l9},n9={partial:!0,tokenize:i9};function s9(e,t,r){const n=this,s=n.events[n.events.length-1];let a=s&&s[1].type==="linePrefix"?s[2].sliceSerialize(s[1],!0).length:0,o=0;return l;function l(h){const y=n.containerState.type||(h===42||h===43||h===45?"listUnordered":"listOrdered");if(y==="listUnordered"?!n.containerState.marker||h===n.containerState.marker:Gh(h)){if(n.containerState.type||(n.containerState.type=y,e.enter(y,{_container:!0})),y==="listUnordered")return e.enter("listItemPrefix"),h===42||h===45?e.check(Qc,r,u)(h):u(h);if(!n.interrupt||h===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),c(h)}return r(h)}function c(h){return Gh(h)&&++o<10?(e.consume(h),c):(!n.interrupt||o<2)&&(n.containerState.marker?h===n.containerState.marker:h===41||h===46)?(e.exit("listItemValue"),u(h)):r(h)}function u(h){return e.enter("listItemMarker"),e.consume(h),e.exit("listItemMarker"),n.containerState.marker=n.containerState.marker||h,e.check(Fd,n.interrupt?r:d,e.attempt(r9,m,f))}function d(h){return n.containerState.initialBlankLine=!0,a++,m(h)}function f(h){return Te(h)?(e.enter("listItemPrefixWhitespace"),e.consume(h),e.exit("listItemPrefixWhitespace"),m):r(h)}function m(h){return n.containerState.size=a+n.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(h)}}function a9(e,t,r){const n=this;return n.containerState._closeFlow=void 0,e.check(Fd,s,a);function s(l){return n.containerState.furtherBlankLines=n.containerState.furtherBlankLines||n.containerState.initialBlankLine,qe(e,t,"listItemIndent",n.containerState.size+1)(l)}function a(l){return n.containerState.furtherBlankLines||!Te(l)?(n.containerState.furtherBlankLines=void 0,n.containerState.initialBlankLine=void 0,o(l)):(n.containerState.furtherBlankLines=void 0,n.containerState.initialBlankLine=void 0,e.attempt(n9,t,o)(l))}function o(l){return n.containerState._closeFlow=!0,n.interrupt=void 0,qe(e,e.attempt(zt,t,r),"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l)}}function i9(e,t,r){const n=this;return qe(e,s,"listItemIndent",n.containerState.size+1);function s(a){const o=n.events[n.events.length-1];return o&&o[1].type==="listItemIndent"&&o[2].sliceSerialize(o[1],!0).length===n.containerState.size?t(a):r(a)}}function o9(e){e.exit(this.containerState.type)}function l9(e,t,r){const n=this;return qe(e,s,"listItemPrefixWhitespace",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4+1);function s(a){const o=n.events[n.events.length-1];return!Te(a)&&o&&o[1].type==="listItemPrefixWhitespace"?t(a):r(a)}}const ev={name:"setextUnderline",resolveTo:c9,tokenize:u9};function c9(e,t){let r=e.length,n,s,a;for(;r--;)if(e[r][0]==="enter"){if(e[r][1].type==="content"){n=r;break}e[r][1].type==="paragraph"&&(s=r)}else e[r][1].type==="content"&&e.splice(r,1),!a&&e[r][1].type==="definition"&&(a=r);const o={type:"setextHeading",start:{...e[n][1].start},end:{...e[e.length-1][1].end}};return e[s][1].type="setextHeadingText",a?(e.splice(s,0,["enter",o,t]),e.splice(a+1,0,["exit",e[n][1],t]),e[n][1].end={...e[a][1].end}):e[n][1]=o,e.push(["exit",o,t]),e}function u9(e,t,r){const n=this;let s;return a;function a(u){let d=n.events.length,f;for(;d--;)if(n.events[d][1].type!=="lineEnding"&&n.events[d][1].type!=="linePrefix"&&n.events[d][1].type!=="content"){f=n.events[d][1].type==="paragraph";break}return!n.parser.lazy[n.now().line]&&(n.interrupt||f)?(e.enter("setextHeadingLine"),s=u,o(u)):r(u)}function o(u){return e.enter("setextHeadingLineSequence"),l(u)}function l(u){return u===s?(e.consume(u),l):(e.exit("setextHeadingLineSequence"),Te(u)?qe(e,c,"lineSuffix")(u):c(u))}function c(u){return u===null||me(u)?(e.exit("setextHeadingLine"),t(u)):r(u)}}const d9={tokenize:f9};function f9(e){const t=this,r=e.attempt(Fd,n,e.attempt(this.parser.constructs.flowInitial,s,qe(e,e.attempt(this.parser.constructs.flow,s,e.attempt(x8,s)),"linePrefix")));return r;function n(a){if(a===null){e.consume(a);return}return e.enter("lineEndingBlank"),e.consume(a),e.exit("lineEndingBlank"),t.currentConstruct=void 0,r}function s(a){if(a===null){e.consume(a);return}return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t.currentConstruct=void 0,r}}const m9={resolveAll:wN()},h9=vN("string"),p9=vN("text");function vN(e){return{resolveAll:wN(e==="text"?g9:void 0),tokenize:t};function t(r){const n=this,s=this.parser.constructs[e],a=r.attempt(s,o,l);return o;function o(d){return u(d)?a(d):l(d)}function l(d){if(d===null){r.consume(d);return}return r.enter("data"),r.consume(d),c}function c(d){return u(d)?(r.exit("data"),a(d)):(r.consume(d),c)}function u(d){if(d===null)return!0;const f=s[d];let m=-1;if(f)for(;++m<f.length;){const h=f[m];if(!h.previous||h.previous.call(n,n.previous))return!0}return!1}}}function wN(e){return t;function t(r,n){let s=-1,a;for(;++s<=r.length;)a===void 0?r[s]&&r[s][1].type==="data"&&(a=s,s++):(!r[s]||r[s][1].type!=="data")&&(s!==a+2&&(r[a][1].end=r[s-1][1].end,r.splice(a+2,s-a-2),s=a+2),a=void 0);return e?e(r,n):r}}function g9(e,t){let r=0;for(;++r<=e.length;)if((r===e.length||e[r][1].type==="lineEnding")&&e[r-1][1].type==="data"){const n=e[r-1][1],s=t.sliceStream(n);let a=s.length,o=-1,l=0,c;for(;a--;){const u=s[a];if(typeof u=="string"){for(o=u.length;u.charCodeAt(o-1)===32;)l++,o--;if(o)break;o=-1}else if(u===-2)c=!0,l++;else if(u!==-1){a++;break}}if(t._contentTypeTextTrailing&&r===e.length&&(l=0),l){const u={type:r===e.length||c||l<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:a?o:n.start._bufferIndex+o,_index:n.start._index+a,line:n.end.line,column:n.end.column-l,offset:n.end.offset-l},end:{...n.end}};n.end={...u.start},n.start.offset===n.end.offset?Object.assign(n,u):(e.splice(r,0,["enter",u,t],["exit",u,t]),r+=2)}r++}return e}const x9={42:zt,43:zt,45:zt,48:zt,49:zt,50:zt,51:zt,52:zt,53:zt,54:zt,55:zt,56:zt,57:zt,62:mN},y9={91:_8},b9={[-2]:am,[-1]:am,32:am},v9={35:E8,42:Qc,45:[ev,Qc],60:L8,61:ev,95:Qc,96:Xb,126:Xb},w9={38:pN,92:hN},_9={[-5]:im,[-4]:im,[-3]:im,33:Q8,38:pN,42:Kh,60:[XB,F8],91:X8,92:[S8,hN],93:u0,95:Kh,96:d8},j9={null:[Kh,m9]},k9={null:[42,95]},N9={null:[]},S9=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:k9,contentInitial:y9,disable:N9,document:x9,flow:v9,flowInitial:b9,insideSpan:j9,string:w9,text:_9},Symbol.toStringTag,{value:"Module"}));function C9(e,t,r){let n={_bufferIndex:-1,_index:0,line:r&&r.line||1,column:r&&r.column||1,offset:r&&r.offset||0};const s={},a=[];let o=[],l=[];const c={attempt:N(j),check:N(k),consume:b,enter:p,exit:_,interrupt:N(k,{interrupt:!0})},u={code:null,containerState:{},defineSkip:v,events:[],now:y,parser:e,previous:null,sliceSerialize:m,sliceStream:h,write:f};let d=t.tokenize.call(u,c);return t.resolveAll&&a.push(t),u;function f(T){return o=br(o,T),w(),o[o.length-1]!==null?[]:(S(t,0),u.events=c0(a,u.events,u),u.events)}function m(T,L){return D9(h(T),L)}function h(T){return E9(o,T)}function y(){const{_bufferIndex:T,_index:L,line:O,column:A,offset:M}=n;return{_bufferIndex:T,_index:L,line:O,column:A,offset:M}}function v(T){s[T.line]=T.column,E()}function w(){let T;for(;n._index<o.length;){const L=o[n._index];if(typeof L=="string")for(T=n._index,n._bufferIndex<0&&(n._bufferIndex=0);n._index===T&&n._bufferIndex<L.length;)g(L.charCodeAt(n._bufferIndex));else g(L)}}function g(T){d=d(T)}function b(T){me(T)?(n.line++,n.column=1,n.offset+=T===-3?2:1,E()):T!==-1&&(n.column++,n.offset++),n._bufferIndex<0?n._index++:(n._bufferIndex++,n._bufferIndex===o[n._index].length&&(n._bufferIndex=-1,n._index++)),u.previous=T}function p(T,L){const O=L||{};return O.type=T,O.start=y(),u.events.push(["enter",O,u]),l.push(O),O}function _(T){const L=l.pop();return L.end=y(),u.events.push(["exit",L,u]),L}function j(T,L){S(T,L.from)}function k(T,L){L.restore()}function N(T,L){return O;function O(A,M,B){let F,R,P,D;return Array.isArray(A)?W(A):"tokenize"in A?W([A]):z(A);function z(Q){return U;function U(J){const X=J!==null&&Q[J],ue=J!==null&&Q.null,pe=[...Array.isArray(X)?X:X?[X]:[],...Array.isArray(ue)?ue:ue?[ue]:[]];return W(pe)(J)}}function W(Q){return F=Q,R=0,Q.length===0?B:I(Q[R])}function I(Q){return U;function U(J){return D=C(),P=Q,Q.partial||(u.currentConstruct=Q),Q.name&&u.parser.constructs.disable.null.includes(Q.name)?re():Q.tokenize.call(L?Object.assign(Object.create(u),L):u,c,ne,re)(J)}}function ne(Q){return T(P,D),M}function re(Q){return D.restore(),++R<F.length?I(F[R]):B}}}function S(T,L){T.resolveAll&&!a.includes(T)&&a.push(T),T.resolve&&hn(u.events,L,u.events.length-L,T.resolve(u.events.slice(L),u)),T.resolveTo&&(u.events=T.resolveTo(u.events,u))}function C(){const T=y(),L=u.previous,O=u.currentConstruct,A=u.events.length,M=Array.from(l);return{from:A,restore:B};function B(){n=T,u.previous=L,u.currentConstruct=O,u.events.length=A,l=M,E()}}function E(){n.line in s&&n.column<2&&(n.column=s[n.line],n.offset+=s[n.line]-1)}}function E9(e,t){const r=t.start._index,n=t.start._bufferIndex,s=t.end._index,a=t.end._bufferIndex;let o;if(r===s)o=[e[r].slice(n,a)];else{if(o=e.slice(r,s),n>-1){const l=o[0];typeof l=="string"?o[0]=l.slice(n):o.shift()}a>0&&o.push(e[s].slice(0,a))}return o}function D9(e,t){let r=-1;const n=[];let s;for(;++r<e.length;){const a=e[r];let o;if(typeof a=="string")o=a;else switch(a){case-5:{o="\r";break}case-4:{o=`
`;break}case-3:{o=`\r
`;break}case-2:{o=t?" ":"	";break}case-1:{if(!t&&s)continue;o=" ";break}default:o=String.fromCharCode(a)}s=a===-2,n.push(o)}return n.join("")}function P9(e){const n={constructs:AB([S9,...(e||{}).extensions||[]]),content:s(qB),defined:[],document:s(YB),flow:s(d9),lazy:{},string:s(h9),text:s(p9)};return n;function s(a){return o;function o(l){return C9(n,a,l)}}}function T9(e){for(;!gN(e););return e}const tv=/[\0\t\n\r]/g;function L9(){let e=1,t="",r=!0,n;return s;function s(a,o,l){const c=[];let u,d,f,m,h;for(a=t+(typeof a=="string"?a.toString():new TextDecoder(o||void 0).decode(a)),f=0,t="",r&&(a.charCodeAt(0)===65279&&f++,r=void 0);f<a.length;){if(tv.lastIndex=f,u=tv.exec(a),m=u&&u.index!==void 0?u.index:a.length,h=a.charCodeAt(m),!u){t=a.slice(f);break}if(h===10&&f===m&&n)c.push(-3),n=void 0;else switch(n&&(c.push(-5),n=void 0),f<m&&(c.push(a.slice(f,m)),e+=m-f),h){case 0:{c.push(65533),e++;break}case 9:{for(d=Math.ceil(e/4)*4,c.push(-2);e++<d;)c.push(-1);break}case 10:{c.push(-4),e=1;break}default:n=!0,e=1}f=m+1}return l&&(n&&c.push(-5),t&&c.push(t),c.push(null)),c}}const I9=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function R9(e){return e.replace(I9,M9)}function M9(e,t,r){if(t)return t;if(r.charCodeAt(0)===35){const s=r.charCodeAt(1),a=s===120||s===88;return fN(r.slice(a?2:1),a?16:10)}return l0(r)||e}const _N={}.hasOwnProperty;function O9(e,t,r){return typeof t!="string"&&(r=t,t=void 0),A9(r)(T9(P9(r).document().write(L9()(e,t,!0))))}function A9(e){const t={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:a(fr),autolinkProtocol:C,autolinkEmail:C,atxHeading:a(ye),blockQuote:a(ue),characterEscape:C,characterReference:C,codeFenced:a(pe),codeFencedFenceInfo:o,codeFencedFenceMeta:o,codeIndented:a(pe,o),codeText:a(De,o),codeTextData:C,data:C,codeFlowValue:C,definition:a(Se),definitionDestinationString:o,definitionLabelString:o,definitionTitleString:o,emphasis:a(tt),hardBreakEscape:a(ct),hardBreakTrailing:a(ct),htmlFlow:a(Be,o),htmlFlowData:C,htmlText:a(Be,o),htmlTextData:C,image:a(Ie),label:o,link:a(fr),listItem:a(Ne),listItemValue:m,listOrdered:a(fe,f),listUnordered:a(fe),paragraph:a(gn),reference:I,referenceString:o,resourceDestinationString:o,resourceTitleString:o,setextHeading:a(ye),strong:a(Ri),thematicBreak:a(zd)},exit:{atxHeading:c(),atxHeadingSequence:j,autolink:c(),autolinkEmail:X,autolinkProtocol:J,blockQuote:c(),characterEscapeValue:E,characterReferenceMarkerHexadecimal:re,characterReferenceMarkerNumeric:re,characterReferenceValue:Q,characterReference:U,codeFenced:c(w),codeFencedFence:v,codeFencedFenceInfo:h,codeFencedFenceMeta:y,codeFlowValue:E,codeIndented:c(g),codeText:c(M),codeTextData:E,data:E,definition:c(),definitionDestinationString:_,definitionLabelString:b,definitionTitleString:p,emphasis:c(),hardBreakEscape:c(L),hardBreakTrailing:c(L),htmlFlow:c(O),htmlFlowData:E,htmlText:c(A),htmlTextData:E,image:c(F),label:P,labelText:R,lineEnding:T,link:c(B),listItem:c(),listOrdered:c(),listUnordered:c(),paragraph:c(),referenceString:ne,resourceDestinationString:D,resourceTitleString:z,resource:W,setextHeading:c(S),setextHeadingLineSequence:N,setextHeadingText:k,strong:c(),thematicBreak:c()}};jN(t,(e||{}).mdastExtensions||[]);const r={};return n;function n(q){let te={type:"root",children:[]};const he={stack:[te],tokenStack:[],config:t,enter:l,exit:u,buffer:o,resume:d,data:r},be=[];let Pe=-1;for(;++Pe<q.length;)if(q[Pe][1].type==="listOrdered"||q[Pe][1].type==="listUnordered")if(q[Pe][0]==="enter")be.push(Pe);else{const Zt=be.pop();Pe=s(q,Zt,Pe)}for(Pe=-1;++Pe<q.length;){const Zt=t[q[Pe][0]];_N.call(Zt,q[Pe][1].type)&&Zt[q[Pe][1].type].call(Object.assign({sliceSerialize:q[Pe][2].sliceSerialize},he),q[Pe][1])}if(he.tokenStack.length>0){const Zt=he.tokenStack[he.tokenStack.length-1];(Zt[1]||rv).call(he,void 0,Zt[0])}for(te.position={start:Vn(q.length>0?q[0][1].start:{line:1,column:1,offset:0}),end:Vn(q.length>0?q[q.length-2][1].end:{line:1,column:1,offset:0})},Pe=-1;++Pe<t.transforms.length;)te=t.transforms[Pe](te)||te;return te}function s(q,te,he){let be=te-1,Pe=-1,Zt=!1,xn,Er,Gr,Cs;for(;++be<=he;){const Lt=q[be];switch(Lt[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Lt[0]==="enter"?Pe++:Pe--,Cs=void 0;break}case"lineEndingBlank":{Lt[0]==="enter"&&(xn&&!Cs&&!Pe&&!Gr&&(Gr=be),Cs=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Cs=void 0}if(!Pe&&Lt[0]==="enter"&&Lt[1].type==="listItemPrefix"||Pe===-1&&Lt[0]==="exit"&&(Lt[1].type==="listUnordered"||Lt[1].type==="listOrdered")){if(xn){let zn=be;for(Er=void 0;zn--;){const Dr=q[zn];if(Dr[1].type==="lineEnding"||Dr[1].type==="lineEndingBlank"){if(Dr[0]==="exit")continue;Er&&(q[Er][1].type="lineEndingBlank",Zt=!0),Dr[1].type="lineEnding",Er=zn}else if(!(Dr[1].type==="linePrefix"||Dr[1].type==="blockQuotePrefix"||Dr[1].type==="blockQuotePrefixWhitespace"||Dr[1].type==="blockQuoteMarker"||Dr[1].type==="listItemIndent"))break}Gr&&(!Er||Gr<Er)&&(xn._spread=!0),xn.end=Object.assign({},Er?q[Er][1].start:Lt[1].end),q.splice(Er||be,0,["exit",xn,Lt[2]]),be++,he++}if(Lt[1].type==="listItemPrefix"){const zn={type:"listItem",_spread:!1,start:Object.assign({},Lt[1].start),end:void 0};xn=zn,q.splice(be,0,["enter",zn,Lt[2]]),be++,he++,Gr=void 0,Cs=!0}}}return q[te][1]._spread=Zt,he}function a(q,te){return he;function he(be){l.call(this,q(be),be),te&&te.call(this,be)}}function o(){this.stack.push({type:"fragment",children:[]})}function l(q,te,he){this.stack[this.stack.length-1].children.push(q),this.stack.push(q),this.tokenStack.push([te,he||void 0]),q.position={start:Vn(te.start),end:void 0}}function c(q){return te;function te(he){q&&q.call(this,he),u.call(this,he)}}function u(q,te){const he=this.stack.pop(),be=this.tokenStack.pop();if(be)be[0].type!==q.type&&(te?te.call(this,q,be[0]):(be[1]||rv).call(this,q,be[0]));else throw new Error("Cannot close `"+q.type+"` ("+Mo({start:q.start,end:q.end})+"): its not open");he.position.end=Vn(q.end)}function d(){return MB(this.stack.pop())}function f(){this.data.expectingFirstListItemValue=!0}function m(q){if(this.data.expectingFirstListItemValue){const te=this.stack[this.stack.length-2];te.start=Number.parseInt(this.sliceSerialize(q),10),this.data.expectingFirstListItemValue=void 0}}function h(){const q=this.resume(),te=this.stack[this.stack.length-1];te.lang=q}function y(){const q=this.resume(),te=this.stack[this.stack.length-1];te.meta=q}function v(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function w(){const q=this.resume(),te=this.stack[this.stack.length-1];te.value=q.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function g(){const q=this.resume(),te=this.stack[this.stack.length-1];te.value=q.replace(/(\r?\n|\r)$/g,"")}function b(q){const te=this.resume(),he=this.stack[this.stack.length-1];he.label=te,he.identifier=Xa(this.sliceSerialize(q)).toLowerCase()}function p(){const q=this.resume(),te=this.stack[this.stack.length-1];te.title=q}function _(){const q=this.resume(),te=this.stack[this.stack.length-1];te.url=q}function j(q){const te=this.stack[this.stack.length-1];if(!te.depth){const he=this.sliceSerialize(q).length;te.depth=he}}function k(){this.data.setextHeadingSlurpLineEnding=!0}function N(q){const te=this.stack[this.stack.length-1];te.depth=this.sliceSerialize(q).codePointAt(0)===61?1:2}function S(){this.data.setextHeadingSlurpLineEnding=void 0}function C(q){const he=this.stack[this.stack.length-1].children;let be=he[he.length-1];(!be||be.type!=="text")&&(be=pa(),be.position={start:Vn(q.start),end:void 0},he.push(be)),this.stack.push(be)}function E(q){const te=this.stack.pop();te.value+=this.sliceSerialize(q),te.position.end=Vn(q.end)}function T(q){const te=this.stack[this.stack.length-1];if(this.data.atHardBreak){const he=te.children[te.children.length-1];he.position.end=Vn(q.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&t.canContainEols.includes(te.type)&&(C.call(this,q),E.call(this,q))}function L(){this.data.atHardBreak=!0}function O(){const q=this.resume(),te=this.stack[this.stack.length-1];te.value=q}function A(){const q=this.resume(),te=this.stack[this.stack.length-1];te.value=q}function M(){const q=this.resume(),te=this.stack[this.stack.length-1];te.value=q}function B(){const q=this.stack[this.stack.length-1];if(this.data.inReference){const te=this.data.referenceType||"shortcut";q.type+="Reference",q.referenceType=te,delete q.url,delete q.title}else delete q.identifier,delete q.label;this.data.referenceType=void 0}function F(){const q=this.stack[this.stack.length-1];if(this.data.inReference){const te=this.data.referenceType||"shortcut";q.type+="Reference",q.referenceType=te,delete q.url,delete q.title}else delete q.identifier,delete q.label;this.data.referenceType=void 0}function R(q){const te=this.sliceSerialize(q),he=this.stack[this.stack.length-2];he.label=R9(te),he.identifier=Xa(te).toLowerCase()}function P(){const q=this.stack[this.stack.length-1],te=this.resume(),he=this.stack[this.stack.length-1];if(this.data.inReference=!0,he.type==="link"){const be=q.children;he.children=be}else he.alt=te}function D(){const q=this.resume(),te=this.stack[this.stack.length-1];te.url=q}function z(){const q=this.resume(),te=this.stack[this.stack.length-1];te.title=q}function W(){this.data.inReference=void 0}function I(){this.data.referenceType="collapsed"}function ne(q){const te=this.resume(),he=this.stack[this.stack.length-1];he.label=te,he.identifier=Xa(this.sliceSerialize(q)).toLowerCase(),this.data.referenceType="full"}function re(q){this.data.characterReferenceType=q.type}function Q(q){const te=this.sliceSerialize(q),he=this.data.characterReferenceType;let be;he?(be=fN(te,he==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):be=l0(te);const Pe=this.stack[this.stack.length-1];Pe.value+=be}function U(q){const te=this.stack.pop();te.position.end=Vn(q.end)}function J(q){E.call(this,q);const te=this.stack[this.stack.length-1];te.url=this.sliceSerialize(q)}function X(q){E.call(this,q);const te=this.stack[this.stack.length-1];te.url="mailto:"+this.sliceSerialize(q)}function ue(){return{type:"blockquote",children:[]}}function pe(){return{type:"code",lang:null,meta:null,value:""}}function De(){return{type:"inlineCode",value:""}}function Se(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function tt(){return{type:"emphasis",children:[]}}function ye(){return{type:"heading",depth:0,children:[]}}function ct(){return{type:"break"}}function Be(){return{type:"html",value:""}}function Ie(){return{type:"image",title:null,url:"",alt:null}}function fr(){return{type:"link",title:null,url:"",children:[]}}function fe(q){return{type:"list",ordered:q.type==="listOrdered",start:null,spread:q._spread,children:[]}}function Ne(q){return{type:"listItem",spread:q._spread,checked:null,children:[]}}function gn(){return{type:"paragraph",children:[]}}function Ri(){return{type:"strong",children:[]}}function pa(){return{type:"text",value:""}}function zd(){return{type:"thematicBreak"}}}function Vn(e){return{line:e.line,column:e.column,offset:e.offset}}function jN(e,t){let r=-1;for(;++r<t.length;){const n=t[r];Array.isArray(n)?jN(e,n):$9(e,n)}}function $9(e,t){let r;for(r in t)if(_N.call(t,r))switch(r){case"canContainEols":{const n=t[r];n&&e[r].push(...n);break}case"transforms":{const n=t[r];n&&e[r].push(...n);break}case"enter":case"exit":{const n=t[r];n&&Object.assign(e[r],n);break}}}function rv(e,t){throw e?new Error("Cannot close `"+e.type+"` ("+Mo({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+Mo({start:t.start,end:t.end})+") is open"):new Error("Cannot close document, a token (`"+t.type+"`, "+Mo({start:t.start,end:t.end})+") is still open")}function F9(e){const t=this;t.parser=r;function r(n){return O9(n,{...t.data("settings"),...e,extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]})}}function B9(e,t){const r={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(t),!0)};return e.patch(t,r),e.applyData(t,r)}function U9(e,t){const r={type:"element",tagName:"br",properties:{},children:[]};return e.patch(t,r),[e.applyData(t,r),{type:"text",value:`
`}]}function z9(e,t){const r=t.value?t.value+`
`:"",n={};t.lang&&(n.className=["language-"+t.lang]);let s={type:"element",tagName:"code",properties:n,children:[{type:"text",value:r}]};return t.meta&&(s.data={meta:t.meta}),e.patch(t,s),s=e.applyData(t,s),s={type:"element",tagName:"pre",properties:{},children:[s]},e.patch(t,s),s}function W9(e,t){const r={type:"element",tagName:"del",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function H9(e,t){const r={type:"element",tagName:"em",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function q9(e,t){const r=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",n=String(t.identifier).toUpperCase(),s=Ii(n.toLowerCase()),a=e.footnoteOrder.indexOf(n);let o,l=e.footnoteCounts.get(n);l===void 0?(l=0,e.footnoteOrder.push(n),o=e.footnoteOrder.length):o=a+1,l+=1,e.footnoteCounts.set(n,l);const c={type:"element",tagName:"a",properties:{href:"#"+r+"fn-"+s,id:r+"fnref-"+s+(l>1?"-"+l:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(o)}]};e.patch(t,c);const u={type:"element",tagName:"sup",properties:{},children:[c]};return e.patch(t,u),e.applyData(t,u)}function V9(e,t){const r={type:"element",tagName:"h"+t.depth,properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function Y9(e,t){if(e.options.allowDangerousHtml){const r={type:"raw",value:t.value};return e.patch(t,r),e.applyData(t,r)}}function kN(e,t){const r=t.referenceType;let n="]";if(r==="collapsed"?n+="[]":r==="full"&&(n+="["+(t.label||t.identifier)+"]"),t.type==="imageReference")return[{type:"text",value:"!["+t.alt+n}];const s=e.all(t),a=s[0];a&&a.type==="text"?a.value="["+a.value:s.unshift({type:"text",value:"["});const o=s[s.length-1];return o&&o.type==="text"?o.value+=n:s.push({type:"text",value:n}),s}function G9(e,t){const r=String(t.identifier).toUpperCase(),n=e.definitionById.get(r);if(!n)return kN(e,t);const s={src:Ii(n.url||""),alt:t.alt};n.title!==null&&n.title!==void 0&&(s.title=n.title);const a={type:"element",tagName:"img",properties:s,children:[]};return e.patch(t,a),e.applyData(t,a)}function K9(e,t){const r={src:Ii(t.url)};t.alt!==null&&t.alt!==void 0&&(r.alt=t.alt),t.title!==null&&t.title!==void 0&&(r.title=t.title);const n={type:"element",tagName:"img",properties:r,children:[]};return e.patch(t,n),e.applyData(t,n)}function Q9(e,t){const r={type:"text",value:t.value.replace(/\r?\n|\r/g," ")};e.patch(t,r);const n={type:"element",tagName:"code",properties:{},children:[r]};return e.patch(t,n),e.applyData(t,n)}function J9(e,t){const r=String(t.identifier).toUpperCase(),n=e.definitionById.get(r);if(!n)return kN(e,t);const s={href:Ii(n.url||"")};n.title!==null&&n.title!==void 0&&(s.title=n.title);const a={type:"element",tagName:"a",properties:s,children:e.all(t)};return e.patch(t,a),e.applyData(t,a)}function X9(e,t){const r={href:Ii(t.url)};t.title!==null&&t.title!==void 0&&(r.title=t.title);const n={type:"element",tagName:"a",properties:r,children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function Z9(e,t,r){const n=e.all(t),s=r?eU(r):NN(t),a={},o=[];if(typeof t.checked=="boolean"){const d=n[0];let f;d&&d.type==="element"&&d.tagName==="p"?f=d:(f={type:"element",tagName:"p",properties:{},children:[]},n.unshift(f)),f.children.length>0&&f.children.unshift({type:"text",value:" "}),f.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:t.checked,disabled:!0},children:[]}),a.className=["task-list-item"]}let l=-1;for(;++l<n.length;){const d=n[l];(s||l!==0||d.type!=="element"||d.tagName!=="p")&&o.push({type:"text",value:`
`}),d.type==="element"&&d.tagName==="p"&&!s?o.push(...d.children):o.push(d)}const c=n[n.length-1];c&&(s||c.type!=="element"||c.tagName!=="p")&&o.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:a,children:o};return e.patch(t,u),e.applyData(t,u)}function eU(e){let t=!1;if(e.type==="list"){t=e.spread||!1;const r=e.children;let n=-1;for(;!t&&++n<r.length;)t=NN(r[n])}return t}function NN(e){const t=e.spread;return t??e.children.length>1}function tU(e,t){const r={},n=e.all(t);let s=-1;for(typeof t.start=="number"&&t.start!==1&&(r.start=t.start);++s<n.length;){const o=n[s];if(o.type==="element"&&o.tagName==="li"&&o.properties&&Array.isArray(o.properties.className)&&o.properties.className.includes("task-list-item")){r.className=["contains-task-list"];break}}const a={type:"element",tagName:t.ordered?"ol":"ul",properties:r,children:e.wrap(n,!0)};return e.patch(t,a),e.applyData(t,a)}function rU(e,t){const r={type:"element",tagName:"p",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function nU(e,t){const r={type:"root",children:e.wrap(e.all(t))};return e.patch(t,r),e.applyData(t,r)}function sU(e,t){const r={type:"element",tagName:"strong",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function aU(e,t){const r=e.all(t),n=r.shift(),s=[];if(n){const o={type:"element",tagName:"thead",properties:{},children:e.wrap([n],!0)};e.patch(t.children[0],o),s.push(o)}if(r.length>0){const o={type:"element",tagName:"tbody",properties:{},children:e.wrap(r,!0)},l=s0(t.children[1]),c=aN(t.children[t.children.length-1]);l&&c&&(o.position={start:l,end:c}),s.push(o)}const a={type:"element",tagName:"table",properties:{},children:e.wrap(s,!0)};return e.patch(t,a),e.applyData(t,a)}function iU(e,t,r){const n=r?r.children:void 0,a=(n?n.indexOf(t):1)===0?"th":"td",o=r&&r.type==="table"?r.align:void 0,l=o?o.length:t.children.length;let c=-1;const u=[];for(;++c<l;){const f=t.children[c],m={},h=o?o[c]:void 0;h&&(m.align=h);let y={type:"element",tagName:a,properties:m,children:[]};f&&(y.children=e.all(f),e.patch(f,y),y=e.applyData(f,y)),u.push(y)}const d={type:"element",tagName:"tr",properties:{},children:e.wrap(u,!0)};return e.patch(t,d),e.applyData(t,d)}function oU(e,t){const r={type:"element",tagName:"td",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}const nv=9,sv=32;function lU(e){const t=String(e),r=/\r?\n|\r/g;let n=r.exec(t),s=0;const a=[];for(;n;)a.push(av(t.slice(s,n.index),s>0,!0),n[0]),s=n.index+n[0].length,n=r.exec(t);return a.push(av(t.slice(s),s>0,!1)),a.join("")}function av(e,t,r){let n=0,s=e.length;if(t){let a=e.codePointAt(n);for(;a===nv||a===sv;)n++,a=e.codePointAt(n)}if(r){let a=e.codePointAt(s-1);for(;a===nv||a===sv;)s--,a=e.codePointAt(s-1)}return s>n?e.slice(n,s):""}function cU(e,t){const r={type:"text",value:lU(String(t.value))};return e.patch(t,r),e.applyData(t,r)}function uU(e,t){const r={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(t,r),e.applyData(t,r)}const dU={blockquote:B9,break:U9,code:z9,delete:W9,emphasis:H9,footnoteReference:q9,heading:V9,html:Y9,imageReference:G9,image:K9,inlineCode:Q9,linkReference:J9,link:X9,listItem:Z9,list:tU,paragraph:rU,root:nU,strong:sU,table:aU,tableCell:oU,tableRow:iU,text:cU,thematicBreak:uU,toml:bc,yaml:bc,definition:bc,footnoteDefinition:bc};function bc(){}const SN=-1,Bd=0,Ao=1,Gu=2,d0=3,f0=4,m0=5,h0=6,CN=7,EN=8,iv=typeof self=="object"?self:globalThis,fU=(e,t)=>{const r=(s,a)=>(e.set(a,s),s),n=s=>{if(e.has(s))return e.get(s);const[a,o]=t[s];switch(a){case Bd:case SN:return r(o,s);case Ao:{const l=r([],s);for(const c of o)l.push(n(c));return l}case Gu:{const l=r({},s);for(const[c,u]of o)l[n(c)]=n(u);return l}case d0:return r(new Date(o),s);case f0:{const{source:l,flags:c}=o;return r(new RegExp(l,c),s)}case m0:{const l=r(new Map,s);for(const[c,u]of o)l.set(n(c),n(u));return l}case h0:{const l=r(new Set,s);for(const c of o)l.add(n(c));return l}case CN:{const{name:l,message:c}=o;return r(new iv[l](c),s)}case EN:return r(BigInt(o),s);case"BigInt":return r(Object(BigInt(o)),s);case"ArrayBuffer":return r(new Uint8Array(o).buffer,o);case"DataView":{const{buffer:l}=new Uint8Array(o);return r(new DataView(l),o)}}return r(new iv[a](o),s)};return n},ov=e=>fU(new Map,e)(0),ka="",{toString:mU}={},{keys:hU}=Object,io=e=>{const t=typeof e;if(t!=="object"||!e)return[Bd,t];const r=mU.call(e).slice(8,-1);switch(r){case"Array":return[Ao,ka];case"Object":return[Gu,ka];case"Date":return[d0,ka];case"RegExp":return[f0,ka];case"Map":return[m0,ka];case"Set":return[h0,ka];case"DataView":return[Ao,r]}return r.includes("Array")?[Ao,r]:r.includes("Error")?[CN,r]:[Gu,r]},vc=([e,t])=>e===Bd&&(t==="function"||t==="symbol"),pU=(e,t,r,n)=>{const s=(o,l)=>{const c=n.push(o)-1;return r.set(l,c),c},a=o=>{if(r.has(o))return r.get(o);let[l,c]=io(o);switch(l){case Bd:{let d=o;switch(c){case"bigint":l=EN,d=o.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+c);d=null;break;case"undefined":return s([SN],o)}return s([l,d],o)}case Ao:{if(c){let m=o;return c==="DataView"?m=new Uint8Array(o.buffer):c==="ArrayBuffer"&&(m=new Uint8Array(o)),s([c,[...m]],o)}const d=[],f=s([l,d],o);for(const m of o)d.push(a(m));return f}case Gu:{if(c)switch(c){case"BigInt":return s([c,o.toString()],o);case"Boolean":case"Number":case"String":return s([c,o.valueOf()],o)}if(t&&"toJSON"in o)return a(o.toJSON());const d=[],f=s([l,d],o);for(const m of hU(o))(e||!vc(io(o[m])))&&d.push([a(m),a(o[m])]);return f}case d0:return s([l,o.toISOString()],o);case f0:{const{source:d,flags:f}=o;return s([l,{source:d,flags:f}],o)}case m0:{const d=[],f=s([l,d],o);for(const[m,h]of o)(e||!(vc(io(m))||vc(io(h))))&&d.push([a(m),a(h)]);return f}case h0:{const d=[],f=s([l,d],o);for(const m of o)(e||!vc(io(m)))&&d.push(a(m));return f}}const{message:u}=o;return s([l,{name:c,message:u}],o)};return a},lv=(e,{json:t,lossy:r}={})=>{const n=[];return pU(!(t||r),!!t,new Map,n)(e),n},Ku=typeof structuredClone=="function"?(e,t)=>t&&("json"in t||"lossy"in t)?ov(lv(e,t)):structuredClone(e):(e,t)=>ov(lv(e,t));function gU(e,t){const r=[{type:"text",value:""}];return t>1&&r.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(t)}]}),r}function xU(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}function yU(e){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=e.options.footnoteBackContent||gU,n=e.options.footnoteBackLabel||xU,s=e.options.footnoteLabel||"Footnotes",a=e.options.footnoteLabelTagName||"h2",o=e.options.footnoteLabelProperties||{className:["sr-only"]},l=[];let c=-1;for(;++c<e.footnoteOrder.length;){const u=e.footnoteById.get(e.footnoteOrder[c]);if(!u)continue;const d=e.all(u),f=String(u.identifier).toUpperCase(),m=Ii(f.toLowerCase());let h=0;const y=[],v=e.footnoteCounts.get(f);for(;v!==void 0&&++h<=v;){y.length>0&&y.push({type:"text",value:" "});let b=typeof r=="string"?r:r(c,h);typeof b=="string"&&(b={type:"text",value:b}),y.push({type:"element",tagName:"a",properties:{href:"#"+t+"fnref-"+m+(h>1?"-"+h:""),dataFootnoteBackref:"",ariaLabel:typeof n=="string"?n:n(c,h),className:["data-footnote-backref"]},children:Array.isArray(b)?b:[b]})}const w=d[d.length-1];if(w&&w.type==="element"&&w.tagName==="p"){const b=w.children[w.children.length-1];b&&b.type==="text"?b.value+=" ":w.children.push({type:"text",value:" "}),w.children.push(...y)}else d.push(...y);const g={type:"element",tagName:"li",properties:{id:t+"fn-"+m},children:e.wrap(d,!0)};e.patch(u,g),l.push(g)}if(l.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:a,properties:{...Ku(o),id:"footnote-label"},children:[{type:"text",value:s}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(l,!0)},{type:"text",value:`
`}]}}const DN=function(e){if(e==null)return _U;if(typeof e=="function")return Ud(e);if(typeof e=="object")return Array.isArray(e)?bU(e):vU(e);if(typeof e=="string")return wU(e);throw new Error("Expected function, string, or object as test")};function bU(e){const t=[];let r=-1;for(;++r<e.length;)t[r]=DN(e[r]);return Ud(n);function n(...s){let a=-1;for(;++a<t.length;)if(t[a].apply(this,s))return!0;return!1}}function vU(e){const t=e;return Ud(r);function r(n){const s=n;let a;for(a in e)if(s[a]!==t[a])return!1;return!0}}function wU(e){return Ud(t);function t(r){return r&&r.type===e}}function Ud(e){return t;function t(r,n,s){return!!(jU(r)&&e.call(this,r,typeof n=="number"?n:void 0,s||void 0))}}function _U(){return!0}function jU(e){return e!==null&&typeof e=="object"&&"type"in e}const PN=[],kU=!0,cv=!1,NU="skip";function SU(e,t,r,n){let s;typeof t=="function"&&typeof r!="function"?(n=r,r=t):s=t;const a=DN(s),o=n?-1:1;l(e,void 0,[])();function l(c,u,d){const f=c&&typeof c=="object"?c:{};if(typeof f.type=="string"){const h=typeof f.tagName=="string"?f.tagName:typeof f.name=="string"?f.name:void 0;Object.defineProperty(m,"name",{value:"node ("+(c.type+(h?"<"+h+">":""))+")"})}return m;function m(){let h=PN,y,v,w;if((!t||a(c,u,d[d.length-1]||void 0))&&(h=CU(r(c,d)),h[0]===cv))return h;if("children"in c&&c.children){const g=c;if(g.children&&h[0]!==NU)for(v=(n?g.children.length:-1)+o,w=d.concat(g);v>-1&&v<g.children.length;){const b=g.children[v];if(y=l(b,v,w)(),y[0]===cv)return y;v=typeof y[1]=="number"?y[1]:v+o}}return h}}}function CU(e){return Array.isArray(e)?e:typeof e=="number"?[kU,e]:e==null?PN:[e]}function TN(e,t,r,n){let s,a,o;typeof t=="function"&&typeof r!="function"?(a=void 0,o=t,s=r):(a=t,o=r,s=n),SU(e,a,l,s);function l(c,u){const d=u[u.length-1],f=d?d.children.indexOf(c):void 0;return o(c,f,d)}}const Qh={}.hasOwnProperty,EU={};function DU(e,t){const r=t||EU,n=new Map,s=new Map,a=new Map,o={...dU,...r.handlers},l={all:u,applyData:TU,definitionById:n,footnoteById:s,footnoteCounts:a,footnoteOrder:[],handlers:o,one:c,options:r,patch:PU,wrap:IU};return TN(e,function(d){if(d.type==="definition"||d.type==="footnoteDefinition"){const f=d.type==="definition"?n:s,m=String(d.identifier).toUpperCase();f.has(m)||f.set(m,d)}}),l;function c(d,f){const m=d.type,h=l.handlers[m];if(Qh.call(l.handlers,m)&&h)return h(l,d,f);if(l.options.passThrough&&l.options.passThrough.includes(m)){if("children"in d){const{children:v,...w}=d,g=Ku(w);return g.children=l.all(d),g}return Ku(d)}return(l.options.unknownHandler||LU)(l,d,f)}function u(d){const f=[];if("children"in d){const m=d.children;let h=-1;for(;++h<m.length;){const y=l.one(m[h],d);if(y){if(h&&m[h-1].type==="break"&&(!Array.isArray(y)&&y.type==="text"&&(y.value=uv(y.value)),!Array.isArray(y)&&y.type==="element")){const v=y.children[0];v&&v.type==="text"&&(v.value=uv(v.value))}Array.isArray(y)?f.push(...y):f.push(y)}}}return f}}function PU(e,t){e.position&&(t.position=mB(e))}function TU(e,t){let r=t;if(e&&e.data){const n=e.data.hName,s=e.data.hChildren,a=e.data.hProperties;if(typeof n=="string")if(r.type==="element")r.tagName=n;else{const o="children"in r?r.children:[r];r={type:"element",tagName:n,properties:{},children:o}}r.type==="element"&&a&&Object.assign(r.properties,Ku(a)),"children"in r&&r.children&&s!==null&&s!==void 0&&(r.children=s)}return r}function LU(e,t){const r=t.data||{},n="value"in t&&!(Qh.call(r,"hProperties")||Qh.call(r,"hChildren"))?{type:"text",value:t.value}:{type:"element",tagName:"div",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function IU(e,t){const r=[];let n=-1;for(t&&r.push({type:"text",value:`
`});++n<e.length;)n&&r.push({type:"text",value:`
`}),r.push(e[n]);return t&&e.length>0&&r.push({type:"text",value:`
`}),r}function uv(e){let t=0,r=e.charCodeAt(t);for(;r===9||r===32;)t++,r=e.charCodeAt(t);return e.slice(t)}function dv(e,t){const r=DU(e,t),n=r.one(e,void 0),s=yU(r),a=Array.isArray(n)?{type:"root",children:n}:n||{type:"root",children:[]};return s&&a.children.push({type:"text",value:`
`},s),a}function RU(e,t){return e&&"run"in e?async function(r,n){const s=dv(r,{file:n,...t});await e.run(s,n)}:function(r,n){return dv(r,{file:n,...e||t})}}function fv(e){if(e)throw e}var Jc=Object.prototype.hasOwnProperty,LN=Object.prototype.toString,mv=Object.defineProperty,hv=Object.getOwnPropertyDescriptor,pv=function(t){return typeof Array.isArray=="function"?Array.isArray(t):LN.call(t)==="[object Array]"},gv=function(t){if(!t||LN.call(t)!=="[object Object]")return!1;var r=Jc.call(t,"constructor"),n=t.constructor&&t.constructor.prototype&&Jc.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!r&&!n)return!1;var s;for(s in t);return typeof s>"u"||Jc.call(t,s)},xv=function(t,r){mv&&r.name==="__proto__"?mv(t,r.name,{enumerable:!0,configurable:!0,value:r.newValue,writable:!0}):t[r.name]=r.newValue},yv=function(t,r){if(r==="__proto__")if(Jc.call(t,r)){if(hv)return hv(t,r).value}else return;return t[r]},MU=function e(){var t,r,n,s,a,o,l=arguments[0],c=1,u=arguments.length,d=!1;for(typeof l=="boolean"&&(d=l,l=arguments[1]||{},c=2),(l==null||typeof l!="object"&&typeof l!="function")&&(l={});c<u;++c)if(t=arguments[c],t!=null)for(r in t)n=yv(l,r),s=yv(t,r),l!==s&&(d&&s&&(gv(s)||(a=pv(s)))?(a?(a=!1,o=n&&pv(n)?n:[]):o=n&&gv(n)?n:{},xv(l,{name:r,newValue:e(d,o,s)})):typeof s<"u"&&xv(l,{name:r,newValue:s}));return l};const om=pl(MU);function Jh(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function OU(){const e=[],t={run:r,use:n};return t;function r(...s){let a=-1;const o=s.pop();if(typeof o!="function")throw new TypeError("Expected function as last argument, not "+o);l(null,...s);function l(c,...u){const d=e[++a];let f=-1;if(c){o(c);return}for(;++f<s.length;)(u[f]===null||u[f]===void 0)&&(u[f]=s[f]);s=u,d?AU(d,l)(...u):o(null,...u)}}function n(s){if(typeof s!="function")throw new TypeError("Expected `middelware` to be a function, not "+s);return e.push(s),t}}function AU(e,t){let r;return n;function n(...o){const l=e.length>o.length;let c;l&&o.push(s);try{c=e.apply(this,o)}catch(u){const d=u;if(l&&r)throw d;return s(d)}l||(c&&c.then&&typeof c.then=="function"?c.then(a,s):c instanceof Error?s(c):a(c))}function s(o,...l){r||(r=!0,t(o,...l))}function a(o){s(null,o)}}const Xr={basename:$U,dirname:FU,extname:BU,join:UU,sep:"/"};function $U(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');Ol(e);let r=0,n=-1,s=e.length,a;if(t===void 0||t.length===0||t.length>e.length){for(;s--;)if(e.codePointAt(s)===47){if(a){r=s+1;break}}else n<0&&(a=!0,n=s+1);return n<0?"":e.slice(r,n)}if(t===e)return"";let o=-1,l=t.length-1;for(;s--;)if(e.codePointAt(s)===47){if(a){r=s+1;break}}else o<0&&(a=!0,o=s+1),l>-1&&(e.codePointAt(s)===t.codePointAt(l--)?l<0&&(n=s):(l=-1,n=o));return r===n?n=o:n<0&&(n=e.length),e.slice(r,n)}function FU(e){if(Ol(e),e.length===0)return".";let t=-1,r=e.length,n;for(;--r;)if(e.codePointAt(r)===47){if(n){t=r;break}}else n||(n=!0);return t<0?e.codePointAt(0)===47?"/":".":t===1&&e.codePointAt(0)===47?"//":e.slice(0,t)}function BU(e){Ol(e);let t=e.length,r=-1,n=0,s=-1,a=0,o;for(;t--;){const l=e.codePointAt(t);if(l===47){if(o){n=t+1;break}continue}r<0&&(o=!0,r=t+1),l===46?s<0?s=t:a!==1&&(a=1):s>-1&&(a=-1)}return s<0||r<0||a===0||a===1&&s===r-1&&s===n+1?"":e.slice(s,r)}function UU(...e){let t=-1,r;for(;++t<e.length;)Ol(e[t]),e[t]&&(r=r===void 0?e[t]:r+"/"+e[t]);return r===void 0?".":zU(r)}function zU(e){Ol(e);const t=e.codePointAt(0)===47;let r=WU(e,!t);return r.length===0&&!t&&(r="."),r.length>0&&e.codePointAt(e.length-1)===47&&(r+="/"),t?"/"+r:r}function WU(e,t){let r="",n=0,s=-1,a=0,o=-1,l,c;for(;++o<=e.length;){if(o<e.length)l=e.codePointAt(o);else{if(l===47)break;l=47}if(l===47){if(!(s===o-1||a===1))if(s!==o-1&&a===2){if(r.length<2||n!==2||r.codePointAt(r.length-1)!==46||r.codePointAt(r.length-2)!==46){if(r.length>2){if(c=r.lastIndexOf("/"),c!==r.length-1){c<0?(r="",n=0):(r=r.slice(0,c),n=r.length-1-r.lastIndexOf("/")),s=o,a=0;continue}}else if(r.length>0){r="",n=0,s=o,a=0;continue}}t&&(r=r.length>0?r+"/..":"..",n=2)}else r.length>0?r+="/"+e.slice(s+1,o):r=e.slice(s+1,o),n=o-s-1;s=o,a=0}else l===46&&a>-1?a++:a=-1}return r}function Ol(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const HU={cwd:qU};function qU(){return"/"}function Xh(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function VU(e){if(typeof e=="string")e=new URL(e);else if(!Xh(e)){const t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if(e.protocol!=="file:"){const t=new TypeError("The URL must be of scheme file");throw t.code="ERR_INVALID_URL_SCHEME",t}return YU(e)}function YU(e){if(e.hostname!==""){const n=new TypeError('File URL host must be "localhost" or empty on darwin');throw n.code="ERR_INVALID_FILE_URL_HOST",n}const t=e.pathname;let r=-1;for(;++r<t.length;)if(t.codePointAt(r)===37&&t.codePointAt(r+1)===50){const n=t.codePointAt(r+2);if(n===70||n===102){const s=new TypeError("File URL path must not include encoded / characters");throw s.code="ERR_INVALID_FILE_URL_PATH",s}}return decodeURIComponent(t)}const lm=["history","path","basename","stem","extname","dirname"];class IN{constructor(t){let r;t?Xh(t)?r={path:t}:typeof t=="string"||GU(t)?r={value:t}:r=t:r={},this.cwd="cwd"in r?"":HU.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let n=-1;for(;++n<lm.length;){const a=lm[n];a in r&&r[a]!==void 0&&r[a]!==null&&(this[a]=a==="history"?[...r[a]]:r[a])}let s;for(s in r)lm.includes(s)||(this[s]=r[s])}get basename(){return typeof this.path=="string"?Xr.basename(this.path):void 0}set basename(t){um(t,"basename"),cm(t,"basename"),this.path=Xr.join(this.dirname||"",t)}get dirname(){return typeof this.path=="string"?Xr.dirname(this.path):void 0}set dirname(t){bv(this.basename,"dirname"),this.path=Xr.join(t||"",this.basename)}get extname(){return typeof this.path=="string"?Xr.extname(this.path):void 0}set extname(t){if(cm(t,"extname"),bv(this.dirname,"extname"),t){if(t.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(t.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Xr.join(this.dirname,this.stem+(t||""))}get path(){return this.history[this.history.length-1]}set path(t){Xh(t)&&(t=VU(t)),um(t,"path"),this.path!==t&&this.history.push(t)}get stem(){return typeof this.path=="string"?Xr.basename(this.path,this.extname):void 0}set stem(t){um(t,"stem"),cm(t,"stem"),this.path=Xr.join(this.dirname||"",t+(this.extname||""))}fail(t,r,n){const s=this.message(t,r,n);throw s.fatal=!0,s}info(t,r,n){const s=this.message(t,r,n);return s.fatal=void 0,s}message(t,r,n){const s=new Tt(t,r,n);return this.path&&(s.name=this.path+":"+s.name,s.file=this.path),s.fatal=!1,this.messages.push(s),s}toString(t){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(t||void 0).decode(this.value)}}function cm(e,t){if(e&&e.includes(Xr.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+Xr.sep+"`")}function um(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function bv(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}function GU(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const KU=function(e){const n=this.constructor.prototype,s=n[e],a=function(){return s.apply(a,arguments)};return Object.setPrototypeOf(a,n),a},QU={}.hasOwnProperty;class p0 extends KU{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=OU()}copy(){const t=new p0;let r=-1;for(;++r<this.attachers.length;){const n=this.attachers[r];t.use(...n)}return t.data(om(!0,{},this.namespace)),t}data(t,r){return typeof t=="string"?arguments.length===2?(mm("data",this.frozen),this.namespace[t]=r,this):QU.call(this.namespace,t)&&this.namespace[t]||void 0:t?(mm("data",this.frozen),this.namespace=t,this):this.namespace}freeze(){if(this.frozen)return this;const t=this;for(;++this.freezeIndex<this.attachers.length;){const[r,...n]=this.attachers[this.freezeIndex];if(n[0]===!1)continue;n[0]===!0&&(n[0]=void 0);const s=r.call(t,...n);typeof s=="function"&&this.transformers.use(s)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(t){this.freeze();const r=wc(t),n=this.parser||this.Parser;return dm("parse",n),n(String(r),r)}process(t,r){const n=this;return this.freeze(),dm("process",this.parser||this.Parser),fm("process",this.compiler||this.Compiler),r?s(void 0,r):new Promise(s);function s(a,o){const l=wc(t),c=n.parse(l);n.run(c,l,function(d,f,m){if(d||!f||!m)return u(d);const h=f,y=n.stringify(h,m);ZU(y)?m.value=y:m.result=y,u(d,m)});function u(d,f){d||!f?o(d):a?a(f):r(void 0,f)}}}processSync(t){let r=!1,n;return this.freeze(),dm("processSync",this.parser||this.Parser),fm("processSync",this.compiler||this.Compiler),this.process(t,s),wv("processSync","process",r),n;function s(a,o){r=!0,fv(a),n=o}}run(t,r,n){vv(t),this.freeze();const s=this.transformers;return!n&&typeof r=="function"&&(n=r,r=void 0),n?a(void 0,n):new Promise(a);function a(o,l){const c=wc(r);s.run(t,c,u);function u(d,f,m){const h=f||t;d?l(d):o?o(h):n(void 0,h,m)}}}runSync(t,r){let n=!1,s;return this.run(t,r,a),wv("runSync","run",n),s;function a(o,l){fv(o),s=l,n=!0}}stringify(t,r){this.freeze();const n=wc(r),s=this.compiler||this.Compiler;return fm("stringify",s),vv(t),s(t,n)}use(t,...r){const n=this.attachers,s=this.namespace;if(mm("use",this.frozen),t!=null)if(typeof t=="function")c(t,r);else if(typeof t=="object")Array.isArray(t)?l(t):o(t);else throw new TypeError("Expected usable value, not `"+t+"`");return this;function a(u){if(typeof u=="function")c(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[d,...f]=u;c(d,f)}else o(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function o(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");l(u.plugins),u.settings&&(s.settings=om(!0,s.settings,u.settings))}function l(u){let d=-1;if(u!=null)if(Array.isArray(u))for(;++d<u.length;){const f=u[d];a(f)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function c(u,d){let f=-1,m=-1;for(;++f<n.length;)if(n[f][0]===u){m=f;break}if(m===-1)n.push([u,...d]);else if(d.length>0){let[h,...y]=d;const v=n[m][1];Jh(v)&&Jh(h)&&(h=om(!0,v,h)),n[m]=[u,h,...y]}}}}const JU=new p0().freeze();function dm(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function fm(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function mm(e,t){if(t)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function vv(e){if(!Jh(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function wv(e,t,r){if(!r)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}function wc(e){return XU(e)?e:new IN(e)}function XU(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function ZU(e){return typeof e=="string"||ez(e)}function ez(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const tz="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",_v=[],jv={allowDangerousHtml:!0},rz=/^(https?|ircs?|mailto|xmpp)$/i,nz=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function sz(e){const t=az(e),r=iz(e);return oz(t.runSync(t.parse(r),r),e)}function az(e){const t=e.rehypePlugins||_v,r=e.remarkPlugins||_v,n=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...jv}:jv;return JU().use(F9).use(r).use(RU,n).use(t)}function iz(e){const t=e.children||"",r=new IN;return typeof t=="string"&&(r.value=t),r}function oz(e,t){const r=t.allowedElements,n=t.allowElement,s=t.components,a=t.disallowedElements,o=t.skipHtml,l=t.unwrapDisallowed,c=t.urlTransform||lz;for(const d of nz)Object.hasOwn(t,d.from)&&(""+d.from+(d.to?"use `"+d.to+"` instead":"remove it")+tz+d.id,void 0);return TN(e,u),yB(e,{Fragment:i.Fragment,components:s,ignoreInvalidStyle:!0,jsx:i.jsx,jsxs:i.jsxs,passKeys:!0,passNode:!0});function u(d,f,m){if(d.type==="raw"&&m&&typeof f=="number")return o?m.children.splice(f,1):m.children[f]={type:"text",value:d.value},f;if(d.type==="element"){let h;for(h in sm)if(Object.hasOwn(sm,h)&&Object.hasOwn(d.properties,h)){const y=d.properties[h],v=sm[h];(v===null||v.includes(d.tagName))&&(d.properties[h]=c(String(y||""),h,d))}}if(d.type==="element"){let h=r?!r.includes(d.tagName):a?a.includes(d.tagName):!1;if(!h&&n&&typeof f=="number"&&(h=!n(d,f,m)),h&&m&&typeof f=="number")return l&&d.children?m.children.splice(f,1,...d.children):m.children.splice(f,1),f}}}function lz(e){const t=e.indexOf(":"),r=e.indexOf("?"),n=e.indexOf("#"),s=e.indexOf("/");return t===-1||s!==-1&&t>s||r!==-1&&t>r||n!==-1&&t>n||rz.test(e.slice(0,t))?e:""}const g0=({content:e,className:t="",maxHeight:r="max-h-none"})=>{const s=(l=>l?l.replace(/\*\*(.*?)\*\*/g,"__BOLD_START__$1__BOLD_END__").replace(/\*(.*?)\*/g,"__ITALIC_START__$1__ITALIC_END__").replace(/####\s*(.*?)$/gm,"__H4_START__$1__H4_END__").replace(/###\s*(.*?)$/gm,"__H3_START__$1__H3_END__").replace(/##\s*(.*?)$/gm,"__H2_START__$1__H2_END__").replace(/#\s*(.*?)$/gm,"__H1_START__$1__H1_END__").replace(/<span[^>]*style="[^"]*font-weight:\s*(bold|600|700)[^"]*"[^>]*>(.*?)<\/span>/gi,"**$2**").replace(/<span[^>]*style="[^"]*text-decoration:\s*underline[^"]*"[^>]*>(.*?)<\/span>/gi,"__$1__").replace(/<span[^>]*style="[^"]*font-style:\s*italic[^"]*"[^>]*>(.*?)<\/span>/gi,"*$1*").replace(/<b[^>]*>(.*?)<\/b>/gi,"**$1**").replace(/<strong[^>]*>(.*?)<\/strong>/gi,"**$1**").replace(/<i[^>]*>(.*?)<\/i>/gi,"*$1*").replace(/<em[^>]*>(.*?)<\/em>/gi,"*$1*").replace(/<strike[^>]*>(.*?)<\/strike>/gi,"~~$1~~").replace(/<s[^>]*>(.*?)<\/s>/gi,"~~$1~~").replace(/<ul[^>]*>/gi,`
`).replace(/<\/ul>/gi,`
`).replace(/<ol[^>]*>/gi,`
`).replace(/<\/ol>/gi,`
`).replace(/<li[^>]*>(.*?)<\/li>/gi,`
 $1`).replace(/<\/p>\s*<p[^>]*>/gi,`

`).replace(/<p[^>]*>/gi,"").replace(/<\/p>/gi,`
`).replace(/<br\s*\/?>/gi,`
`).replace(/<\/?span[^>]*>/gi,"").replace(/<[^>]*>/gi,"").replace(/__BOLD_START__(.*?)__BOLD_END__/g,"**$1**").replace(/__ITALIC_START__(.*?)__ITALIC_END__/g,"*$1*").replace(/__H4_START__(.*?)__H4_END__/g,"#### $1").replace(/__H3_START__(.*?)__H3_END__/g,"### $1").replace(/__H2_START__(.*?)__H2_END__/g,"## $1").replace(/__H1_START__(.*?)__H1_END__/g,"# $1").replace(/\n{3,}/g,`

`).replace(/^\n+|\n+$/g,"").replace(/([^\n]) /g,`$1
 `).replace(/ /g,`
 `).replace(/^ /gm," ").replace(/^-\s+/gm," ").replace(/(\w)(\w)/g,`$1
 $2`).replace(/+/g,"").replace(/\n\n/g,`
`).replace(/__[A-Z]+_START__|__[A-Z]+_END__/g,"").replace(/H1_START|H1_END|H2_START|H2_END|H3_START|H3_END|H4_START|H4_END/g,"").replace(/BOLD_START|BOLD_END|ITALIC_START|ITALIC_END/g,"").replace(/&nbsp;/gi," ").replace(/&amp;/gi,"&").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/&quot;/gi,'"').replace(/&#39;/gi,"'").replace(/&#x27;/gi,"'").replace(/&____39/gi,"'").replace(/&____34/gi,'"').replace(/&____(\d+);?/gi,(u,d)=>d==="39"?"'":d==="34"?'"':d==="38"?"&":d==="60"?"<":d==="62"?">":u).replace(/&[_\s]*39[_\s]*/gi,"'").replace(/&[_\s]*34[_\s]*/gi,'"').trim():"")(e),o=(l=>/(\*\*.*?\*\*|\*.*?\*||^\d+\.\s|#{1,6}\s)/m.test(l)||l.includes(`
`))(s);return i.jsx("div",{className:`${t} ${r} overflow-y-auto`,children:o?i.jsx("div",{className:"prose prose-sm max-w-none prose-headings:text-gray-900 prose-p:text-gray-800 prose-strong:text-gray-900 prose-ul:text-gray-800 prose-li:text-gray-800",children:i.jsx(sz,{components:{h1:({children:l})=>i.jsx("h1",{className:"text-lg font-bold text-gray-900 mb-3 pb-1 border-b border-gray-200",children:l}),h2:({children:l})=>i.jsx("h2",{className:"text-base font-bold text-gray-900 mb-2 mt-4",children:l}),h3:({children:l})=>i.jsx("h3",{className:"text-sm font-bold text-blue-700 mb-2 mt-3",children:l}),h4:({children:l})=>i.jsx("h4",{className:"text-sm font-semibold text-blue-600 mb-1 mt-2",children:l}),p:({children:l})=>i.jsx("p",{className:"mb-2 last:mb-0 text-sm leading-relaxed text-gray-800",children:l}),ul:({children:l})=>i.jsx("ul",{className:"mb-3 ml-0 space-y-1 list-none",children:l}),ol:({children:l})=>i.jsx("ol",{className:"mb-3 ml-4 space-y-1 list-decimal",children:l}),li:({children:l})=>i.jsxs("li",{className:"text-sm leading-relaxed text-gray-800 flex items-start py-1",children:[i.jsx("span",{className:"text-blue-500 mr-2 font-bold text-base leading-none mt-0.5",children:""}),i.jsx("span",{className:"flex-1",children:l})]}),strong:({children:l})=>i.jsx("strong",{className:"font-bold text-gray-900 bg-blue-50 px-1 py-0.5 rounded",children:l}),em:({children:l})=>i.jsx("em",{className:"italic text-blue-700 font-medium",children:l}),del:({children:l})=>i.jsx("del",{className:"line-through text-gray-500 bg-red-50 px-1 rounded",children:l}),code:({children:l})=>i.jsx("code",{className:"bg-gray-100 px-1.5 py-0.5 rounded text-xs font-mono text-gray-700",children:l}),a:({href:l,children:c})=>i.jsx("a",{href:l,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:c})},children:s})}):i.jsx("div",{className:"text-sm text-gray-800 break-words",children:s.split(`
`).map((l,c)=>l.trim().startsWith("")?i.jsxs("div",{className:"flex items-start py-1",children:[i.jsx("span",{className:"text-blue-500 mr-2 font-bold text-base leading-none mt-0.5",children:""}),i.jsx("span",{className:"flex-1",children:l.trim().substring(1).trim()})]},c):l.trim()?i.jsx("div",{className:"mb-1",children:l},c):i.jsx("div",{className:"mb-2"},c))})})},hm=({title:e,count:t,onAddNew:r,children:n,isExpanded:s=!0,onToggle:a,icon:o,isEmpty:l=!1,showAddButton:c=!0})=>i.jsxs("div",{className:`bg-white border border-gray-200 rounded-lg mb-3 shadow-sm ${l?"opacity-60":""}`,children:[i.jsxs("div",{className:`flex items-center justify-between p-3 border-b border-gray-100 ${l?"bg-gray-50":"bg-gradient-to-r from-slate-50 to-gray-50"}`,children:[i.jsxs("button",{onClick:a,className:"flex items-center space-x-2 flex-1 text-left hover:bg-white/50 -mx-3 px-3 py-1 rounded-t-lg transition-colors",children:[i.jsx("svg",{className:`w-4 h-4 text-gray-400 transform transition-transform ${s?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),o&&i.jsx("div",{className:"w-4 h-4 flex items-center justify-center",children:i.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:o})})}),i.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:e}),i.jsx("span",{className:`inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium ${l?"bg-gray-200 text-gray-600":"bg-blue-100 text-blue-800"}`,children:t}),l&&i.jsx("span",{className:"text-xs text-gray-500 italic",children:"(Empty)"})]}),c&&r&&i.jsxs("button",{onClick:r,className:"flex items-center px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors ml-2",children:[i.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"New"]})]}),s&&i.jsx("div",{className:"max-h-64 overflow-y-auto",children:t===0?i.jsxs("div",{className:"p-4 text-center text-gray-500 text-sm",children:[i.jsx("div",{className:"w-12 h-12 mx-auto mb-2 bg-gray-100 rounded-full flex items-center justify-center",children:o&&i.jsx("svg",{className:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:o})})}),"No ",e.toLowerCase()," yet"]}):n})]}),cz=({note:e,onClick:t})=>i.jsx("div",{className:"p-3 hover:bg-blue-50 cursor-pointer transition-colors border-b border-gray-100 last:border-b-0 group",onClick:()=>t==null?void 0:t(e.id),children:i.jsx("div",{className:"flex items-start space-x-3",children:i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900 truncate group-hover:text-blue-900",children:e.title||"Untitled Note"}),i.jsx("svg",{className:"w-3 h-3 text-gray-400 group-hover:text-blue-600 opacity-0 group-hover:opacity-100 transition-opacity",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]}),i.jsx("div",{className:"text-xs text-gray-600 mb-2",children:e.created_at&&new Date(e.created_at).toLocaleDateString()}),e.body&&i.jsx("div",{className:"max-h-16 overflow-hidden",children:i.jsx(g0,{content:e.body,className:"text-xs text-gray-700",maxHeight:"max-h-16"})})]})})}),uz=({property:e,onClick:t})=>i.jsx("div",{className:"p-2 hover:bg-green-50 cursor-pointer transition-colors border-b border-gray-100 last:border-b-0 group",onClick:()=>t==null?void 0:t(e.id),children:i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900 truncate group-hover:text-green-900",children:e.property_name||e.address||"Unnamed Property"}),i.jsx("svg",{className:"w-3 h-3 text-gray-400 group-hover:text-green-600 opacity-0 group-hover:opacity-100 transition-opacity",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]}),i.jsxs("div",{className:"flex items-center justify-between mt-1",children:[i.jsxs("p",{className:"text-xs text-green-600 font-medium",children:[e.city,", ",e.state]}),e.zip_code&&i.jsx("p",{className:"text-xs text-gray-500 font-medium",children:e.zip_code})]})]})})}),dz=({deal:e,onClick:t})=>{var r,n;return i.jsx("div",{className:"p-2 hover:bg-purple-50 cursor-pointer transition-colors border-b border-gray-100 last:border-b-0 group",onClick:()=>t==null?void 0:t(e.id),children:i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900 truncate group-hover:text-purple-900",children:e.deal_name||"Unnamed Deal"}),i.jsx("svg",{className:"w-3 h-3 text-gray-400 group-hover:text-purple-600 opacity-0 group-hover:opacity-100 transition-opacity",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]}),i.jsxs("div",{className:"flex items-center justify-between mt-1",children:[i.jsx("p",{className:"text-xs text-purple-600 font-medium",children:((r=e.deal_stage)==null?void 0:r.label)||"No stage"}),i.jsx("p",{className:"text-xs text-gray-500 truncate ml-2",children:((n=e.client)==null?void 0:n.client_name)||"No client"})]})]})})})},fz=({contactId:e,isMinimized:t=!1,onMinimize:r,onPropertyClick:n,onDealClick:s})=>{const[a,o]=x.useState([]),[l,c]=x.useState([]),[u,d]=x.useState([]),[f,m]=x.useState(!1),[h,y]=x.useState(null),v=()=>({notes:a.length>0,properties:l.length>0,deals:u.length>0}),[w,g]=x.useState(()=>{const p=localStorage.getItem(`expandedContactSidebarModules_${e}`);return p?JSON.parse(p):v()});x.useEffect(()=>{if(!e)return;(async()=>{m(!0),y(null);try{const{data:_,error:j}=await $.from("note_object_link").select(`
            note_id,
            note!note_object_link_note_id_fkey (*)
          `).eq("object_type","contact").eq("object_id",e);if(j)throw j;const k=[];_&&_.forEach(L=>{L.note&&k.push(L.note)}),o(k);const{data:N,error:S}=await $.from("property_contact").select(`
            property_id,
            property!property_contact_property_id_fkey (*)
          `).eq("contact_id",e);if(S)throw S;const C=[];N&&N.forEach(L=>{L.property&&C.push(L.property)}),c(C);const{data:E,error:T}=await $.from("deal").select(`
            *,
            deal_stage (
              label,
              sort_order
            ),
            client!client_id (
              client_name
            )
          `).eq("contact_id",e).order("created_at",{ascending:!1});if(T)throw T;d(E||[])}catch(_){console.error("Error loading contact sidebar data:",_),y(_ instanceof Error?_.message:"Failed to load data")}finally{m(!1)}})()},[e]),x.useEffect(()=>{f||g(p=>{const _=v(),j=localStorage.getItem(`expandedContactSidebarModules_${e}`);return j?JSON.parse(j):_})},[a.length,l.length,u.length,f,e]);const b=p=>{const _={...w,[p]:!w[p]};g(_),localStorage.setItem(`expandedContactSidebarModules_${e}`,JSON.stringify(_))};return i.jsxs("div",{className:`fixed right-0 top-0 h-full bg-white border-l border-gray-200 shadow-xl transition-all duration-300 ${t?"w-12":"w-[500px]"} z-40 ${t?"overflow-hidden":"overflow-y-auto"}`,style:{top:"180px",height:"calc(100vh - 180px)"},children:[i.jsxs("div",{className:`flex items-center ${t?"justify-center":"justify-between"} p-2 border-b border-gray-200 bg-gray-50`,children:[!t&&i.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Contact Info"}),i.jsx("button",{onClick:r,className:`p-2 hover:bg-blue-100 hover:text-blue-600 rounded-md transition-colors group ${t?"text-gray-600":"text-gray-500"}`,title:t?"Expand sidebar":"Minimize sidebar",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t?i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7M4 12h16"}):i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 5l7 7-7 7M20 12H4"})})})]}),!t&&i.jsx("div",{className:"p-3",children:f?i.jsx("div",{className:"p-4 space-y-3",children:[...Array(3)].map((p,_)=>i.jsx("div",{className:"animate-pulse",children:i.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[i.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2"}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"h-3 bg-gray-200 rounded"}),i.jsx("div",{className:"h-3 bg-gray-200 rounded w-2/3"})]})]})},_))}):h?i.jsxs("div",{className:"p-4 text-center text-red-600",children:[i.jsx("p",{className:"font-medium",children:"Error loading data"}),i.jsx("p",{className:"text-sm",children:h})]}):i.jsxs(i.Fragment,{children:[i.jsx(hm,{title:"Associated Notes",count:a.length,onAddNew:()=>console.log("Add new note"),isExpanded:w.notes,onToggle:()=>b("notes"),icon:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z",isEmpty:a.length===0,showAddButton:!1,children:a.map(p=>i.jsx(cz,{note:p,onClick:()=>console.log("Navigate to note",p.id)},p.id))}),i.jsx(hm,{title:"Associated Properties",count:l.length,onAddNew:()=>console.log("Add new property association"),isExpanded:w.properties,onToggle:()=>b("properties"),icon:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4",isEmpty:l.length===0,showAddButton:!1,children:l.map(p=>i.jsx(uz,{property:p,onClick:n},p.id))}),i.jsx(hm,{title:"Associated Deals",count:u.length,onAddNew:()=>console.log("Add new deal"),isExpanded:w.deals,onToggle:()=>b("deals"),icon:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1",isEmpty:u.length===0,showAddButton:!1,children:u.map(p=>i.jsx(dz,{deal:p,onClick:s},p.id))})]})})]})},kv=()=>{const{contactId:e}=Ni(),t=Jt(),[r,n]=x.useState(null),[s,a]=x.useState("overview"),[o,l]=x.useState(!0),[c,u]=x.useState(null),[d,f]=x.useState(!1),{trackView:m}=Rl(),h=e==="new";x.useEffect(()=>{(async()=>{if(h){l(!1);return}if(!e){u("Contact ID not provided"),l(!1);return}try{l(!0);const{data:b,error:p}=await $.from("contact").select("*").eq("id",e).single();p?(console.error("Error fetching contact:",p),u(`Failed to load contact: ${p.message}`)):b?(n(b),m(b.id,"contact",`${b.first_name||""} ${b.last_name||""}`.trim()||"Unnamed Contact",b.company||b.email||void 0)):u("Contact not found")}catch(b){console.error("Unexpected error:",b),u("An unexpected error occurred")}finally{l(!1)}})()},[e,h]);const y=g=>{n(g),h&&g.id&&t(`/contact/${g.id}`,{replace:!0})},v=async()=>{if(!(!e||h)&&confirm("Are you sure you want to delete this contact? This action cannot be undone."))try{const{error:g}=await $.from("contact").delete().eq("id",e);if(g)throw g;alert("Contact deleted successfully!"),t("/master-pipeline")}catch(g){console.error("Error deleting contact:",g),alert(`Error deleting contact: ${g instanceof Error?g.message:"Unknown error"}`)}};if(o)return i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),i.jsx("div",{className:"text-sm text-gray-600",children:"Loading contact..."})]})});if(c&&!h)return i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsx("div",{className:"bg-white rounded-lg border border-red-200 p-6 max-w-md mx-4",children:i.jsxs("div",{className:"text-red-600 text-center",children:[i.jsx("svg",{className:"w-12 h-12 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.732 15.5c-.77.833.192 2.5 1.732 2.5z"})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Contact Not Found"}),i.jsx("p",{className:"text-sm text-gray-600 mb-4",children:c}),i.jsx("button",{onClick:()=>t(-1),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm",children:"Go Back"})]})})});const w=r?`${r.first_name||""} ${r.last_name||""}`.trim()||"Contact":"New Contact";return i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"min-h-screen bg-gray-50",children:[i.jsx("div",{className:"bg-white border-b border-gray-200",children:i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"flex justify-between items-center py-6 md:justify-start md:space-x-10",children:[i.jsxs("div",{className:"flex justify-start lg:w-0 lg:flex-1",children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:w}),(r==null?void 0:r.company)&&i.jsx("span",{className:"ml-3 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:r.company})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsxs("button",{onClick:()=>f(!d),className:"inline-flex items-center px-3 py-2 border border-blue-300 rounded-md shadow-sm text-sm font-medium text-blue-700 bg-blue-50 hover:bg-blue-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",title:d?"Show Contact Sidebar":"Hide Contact Sidebar",children:[i.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),d?"Show":"Hide"," Info"]}),i.jsx("button",{onClick:()=>t("/master-pipeline"),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Back to Pipeline"}),(r==null?void 0:r.source_type)&&i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${r.source_type==="Lead"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:r.source_type})]})]})})}),i.jsxs("div",{className:`max-w-4xl mx-auto py-8 px-4 sm:px-6 lg:px-8 transition-all duration-300 ${d?"mr-12":"mr-[500px]"}`,children:[i.jsx("div",{className:"border-b border-gray-200 mb-6",children:i.jsxs("nav",{className:"-mb-px flex space-x-8",children:[i.jsx("button",{onClick:()=>a("overview"),className:`py-2 px-1 border-b-2 font-medium text-sm ${s==="overview"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Details"}),i.jsx("button",{onClick:()=>a("activity"),className:`py-2 px-1 border-b-2 font-medium text-sm ${s==="activity"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Activity"})]})}),s==="overview"&&i.jsx(_7,{contact:r,isNewContact:h,onSave:y,onDelete:v}),s==="activity"&&i.jsx(i.Fragment,{children:h||!(r!=null&&r.id)?i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-4",children:i.jsx("div",{className:"flex",children:i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Save Contact First"}),i.jsx("div",{className:"mt-2 text-sm text-yellow-700",children:i.jsx("p",{children:"Please save the contact in the Details tab before viewing activities."})})]})})}):i.jsx(Il,{config:{parentObject:{id:r.id,type:"contact",name:w},title:"Contact Activities",showSummary:!0,allowAdd:!0}})})]})]}),e&&e!=="new"&&i.jsx(fz,{contactId:e,isMinimized:d,onMinimize:()=>f(!d),onPropertyClick:g=>t(`/property/${g}`),onDealClick:g=>t(`/deal/${g}`)})]})},mz=({client:e,isNewClient:t,onSave:r,onDelete:n})=>{const[s,a]=x.useState({client_name:"",type:null,phone:null,email:null,website:null,description:null,billing_street:null,billing_city:null,billing_state:null,billing_zip:null,billing_country:null,shipping_street:null,shipping_city:null,shipping_state:null,shipping_zip:null,shipping_country:null,industry:null,annual_revenue:null,number_of_employees:null,ownership:null,ticker_symbol:null,parent_account:null,account_source:null,rating:null,sic_code:null,naics_code:null,clean_status:null,customer_priority:null,upsell_opportunity:null,active:!0}),[o,l]=x.useState(!1),[c,u]=x.useState({}),[d,f]=x.useState(!1),m=["Tenant","Landlord","Prospect","Vendor","Partner","Competitor","Other"],h=["Retail","Restaurant","Healthcare","Professional Services","Financial Services","Technology","Real Estate","Manufacturing","Education","Government","Non-Profit","Other"],y=["Hot","Warm","Cold"];x.useEffect(()=>{e&&a({client_name:e.client_name||"",type:e.type,phone:e.phone,email:e.email,website:e.website,description:e.description,billing_street:e.billing_street,billing_city:e.billing_city,billing_state:e.billing_state,billing_zip:e.billing_zip,billing_country:e.billing_country,shipping_street:e.shipping_street,shipping_city:e.shipping_city,shipping_state:e.shipping_state,shipping_zip:e.shipping_zip,shipping_country:e.shipping_country,industry:e.industry,annual_revenue:e.annual_revenue,number_of_employees:e.number_of_employees,ownership:e.ownership,ticker_symbol:e.ticker_symbol,parent_account:e.parent_account,account_source:e.account_source,rating:e.rating,sic_code:e.sic_code,naics_code:e.naics_code,clean_status:e.clean_status,customer_priority:e.customer_priority,upsell_opportunity:e.upsell_opportunity,active:e.active??!0})},[e]);const v=(_,j)=>{a(k=>({...k,[_]:j})),c[_]&&u(k=>({...k,[_]:""}))},w=()=>{const _={};return s.client_name.trim()||(_.client_name="Client name is required"),s.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.email)&&(_.email="Please enter a valid email address"),s.website&&!/^https?:\/\/.+/.test(s.website)&&(_.website="Website must start with http:// or https://"),u(_),Object.keys(_).length===0},g=async()=>{if(w()){l(!0);try{if(t){const _={...s,client_name:s.client_name.trim()},{data:j,error:k}=await $.from("client").insert([_]).select().single();if(k)throw k;r(j)}else{const{data:_,error:j}=await $.from("client").update({...s,client_name:s.client_name.trim(),updated_at:new Date().toISOString()}).eq("id",e.id).select().single();if(j)throw j;r(_)}}catch(_){console.error("Error saving client:",_);const j=_ instanceof Error?_.message:"An unexpected error occurred";u({submit:`Failed to save client: ${j}`})}finally{l(!1)}}},b=async()=>{if(!(!(e!=null&&e.id)||!n)){l(!0);try{const{error:_}=await $.from("client").delete().eq("id",e.id);if(_)throw _;n()}catch(_){console.error("Error deleting client:",_);const j=_ instanceof Error?_.message:"An unexpected error occurred";u({submit:`Failed to delete client: ${j}`}),f(!1)}finally{l(!1)}}},p=()=>{a(_=>({..._,shipping_street:_.billing_street,shipping_city:_.billing_city,shipping_state:_.billing_state,shipping_zip:_.billing_zip,shipping_country:_.billing_country}))};return i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-6",children:"Basic Information"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Name *"}),i.jsx("input",{type:"text",value:s.client_name,onChange:_=>v("client_name",_.target.value),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${c.client_name?"border-red-300":""}`,placeholder:"Enter client name"}),c.client_name&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.client_name})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Type"}),i.jsxs("select",{value:s.type||"",onChange:_=>v("type",_.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",children:[i.jsx("option",{value:"",children:"Select type..."}),m.map(_=>i.jsx("option",{value:_,children:_},_))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),i.jsx("input",{type:"tel",value:s.phone||"",onChange:_=>v("phone",_.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"(555) 123-4567"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),i.jsx("input",{type:"email",value:s.email||"",onChange:_=>v("email",_.target.value||null),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${c.email?"border-red-300":""}`,placeholder:"client@company.com"}),c.email&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.email})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Website"}),i.jsx("input",{type:"url",value:s.website||"",onChange:_=>v("website",_.target.value||null),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${c.website?"border-red-300":""}`,placeholder:"https://www.company.com"}),c.website&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.website})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Industry"}),i.jsxs("select",{value:s.industry||"",onChange:_=>v("industry",_.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",children:[i.jsx("option",{value:"",children:"Select industry..."}),h.map(_=>i.jsx("option",{value:_,children:_},_))]})]})]}),i.jsxs("div",{className:"mt-6",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),i.jsx("textarea",{value:s.description||"",onChange:_=>v("description",_.target.value||null),rows:4,className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"Additional information about the client..."})]})]}),i.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-6",children:"Company Details"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Annual Revenue"}),i.jsx("input",{type:"number",value:s.annual_revenue||"",onChange:_=>v("annual_revenue",_.target.value?parseFloat(_.target.value):null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"1000000"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Employees"}),i.jsx("input",{type:"number",value:s.number_of_employees||"",onChange:_=>v("number_of_employees",_.target.value?parseInt(_.target.value):null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"50"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ownership"}),i.jsx("input",{type:"text",value:s.ownership||"",onChange:_=>v("ownership",_.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"Private, Public, etc."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ticker Symbol"}),i.jsx("input",{type:"text",value:s.ticker_symbol||"",onChange:_=>v("ticker_symbol",_.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"AAPL"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rating"}),i.jsxs("select",{value:s.rating||"",onChange:_=>v("rating",_.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",children:[i.jsx("option",{value:"",children:"Select rating..."}),y.map(_=>i.jsx("option",{value:_,children:_},_))]})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",id:"active",checked:s.active,onChange:_=>v("active",_.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),i.jsx("label",{htmlFor:"active",className:"ml-2 block text-sm text-gray-900",children:"Active Client"})]})]})]}),i.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-6",children:"Billing Address"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Street Address"}),i.jsx("input",{type:"text",value:s.billing_street||"",onChange:_=>v("billing_street",_.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"123 Main St"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City"}),i.jsx("input",{type:"text",value:s.billing_city||"",onChange:_=>v("billing_city",_.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"New York"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"State"}),i.jsx("input",{type:"text",value:s.billing_state||"",onChange:_=>v("billing_state",_.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"NY"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ZIP Code"}),i.jsx("input",{type:"text",value:s.billing_zip||"",onChange:_=>v("billing_zip",_.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"10001"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Country"}),i.jsx("input",{type:"text",value:s.billing_country||"",onChange:_=>v("billing_country",_.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"United States"})]})]})]}),i.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Shipping Address"}),i.jsx("button",{type:"button",onClick:p,className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:"Copy from Billing"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Street Address"}),i.jsx("input",{type:"text",value:s.shipping_street||"",onChange:_=>v("shipping_street",_.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"123 Main St"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City"}),i.jsx("input",{type:"text",value:s.shipping_city||"",onChange:_=>v("shipping_city",_.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"New York"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"State"}),i.jsx("input",{type:"text",value:s.shipping_state||"",onChange:_=>v("shipping_state",_.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"NY"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ZIP Code"}),i.jsx("input",{type:"text",value:s.shipping_zip||"",onChange:_=>v("shipping_zip",_.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"10001"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Country"}),i.jsx("input",{type:"text",value:s.shipping_country||"",onChange:_=>v("shipping_country",_.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"United States"})]})]})]}),c.submit&&i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:i.jsx("p",{className:"text-sm text-red-600",children:c.submit})}),i.jsxs("div",{className:"flex items-center justify-between pt-6 border-t border-gray-200",children:[i.jsx("div",{children:!t&&n&&i.jsx("button",{type:"button",onClick:()=>f(!0),disabled:o,className:"inline-flex items-center px-4 py-2 border border-red-300 rounded-md shadow-sm text-sm font-medium text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50",children:"Delete Client"})}),i.jsx("div",{className:"flex items-center space-x-3",children:i.jsx("button",{type:"button",onClick:g,disabled:o,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:o?"Saving...":t?"Create Client":"Save Changes"})})]}),d&&i.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:i.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:i.jsxs("div",{className:"mt-3 text-center",children:[i.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100",children:i.jsx("svg",{className:"h-6 w-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mt-4",children:"Delete Client"}),i.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Are you sure you want to delete this client? This action cannot be undone."}),i.jsxs("div",{className:"flex items-center justify-center mt-4 space-x-3",children:[i.jsx("button",{type:"button",onClick:()=>f(!1),disabled:o,className:"px-4 py-2 bg-white border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),i.jsx("button",{type:"button",onClick:b,disabled:o,className:"px-4 py-2 bg-red-600 border border-transparent rounded-md text-sm font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50",children:o?"Deleting...":"Delete"})]})]})})})]})},_c=({title:e,count:t,onAddNew:r,children:n,isExpanded:s=!0,onToggle:a,icon:o,isEmpty:l=!1,showAddButton:c=!0})=>i.jsxs("div",{className:`bg-white border border-gray-200 rounded-lg mb-3 shadow-sm ${l?"opacity-60":""}`,children:[i.jsxs("div",{className:`flex items-center justify-between p-3 border-b border-gray-100 ${l?"bg-gray-50":"bg-gradient-to-r from-slate-50 to-gray-50"}`,children:[i.jsxs("button",{onClick:a,className:"flex items-center space-x-2 flex-1 text-left hover:bg-white/50 -mx-3 px-3 py-1 rounded-t-lg transition-colors",children:[i.jsx("svg",{className:`w-4 h-4 text-gray-400 transform transition-transform ${s?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),o&&i.jsx("div",{className:"w-4 h-4 flex items-center justify-center",children:i.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:o})})}),i.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:e}),i.jsx("span",{className:`inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium ${l?"bg-gray-200 text-gray-600":"bg-blue-100 text-blue-800"}`,children:t}),l&&i.jsx("span",{className:"text-xs text-gray-500 italic",children:"(Empty)"})]}),c&&r&&i.jsxs("button",{onClick:r,className:"flex items-center px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors ml-2",children:[i.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"New"]})]}),s&&i.jsx("div",{className:"max-h-64 overflow-y-auto",children:t===0?i.jsxs("div",{className:"p-4 text-center text-gray-500 text-sm",children:[i.jsx("div",{className:"w-12 h-12 mx-auto mb-2 bg-gray-100 rounded-full flex items-center justify-center",children:o&&i.jsx("svg",{className:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:o})})}),"No ",e.toLowerCase()," yet"]}):n})]}),hz=({contact:e,isExpanded:t=!1,onToggle:r,onEdit:n,onClick:s})=>{var c,u;const a=e.mobile_phone||e.phone,o=e.mobile_phone?"Mobile":"Phone",l=e.source_type==="Lead";return i.jsxs("div",{className:"border-b border-gray-100 last:border-b-0",children:[i.jsxs("div",{className:"p-2 hover:bg-gray-50 cursor-pointer transition-colors flex items-center justify-between",onClick:()=>s==null?void 0:s(e.id),children:[i.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[i.jsx("div",{className:`w-6 h-6 ${l?"bg-orange-500":"bg-blue-500"} rounded-full flex items-center justify-center flex-shrink-0`,children:i.jsxs("span",{className:"text-white font-medium text-xs",children:[((c=e.first_name)==null?void 0:c[0])||"?",((u=e.last_name)==null?void 0:u[0])||""]})}),i.jsx("div",{className:"flex-1 min-w-0",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsxs("span",{className:"text-sm font-medium text-gray-900 truncate",children:[e.first_name," ",e.last_name,l&&i.jsx("span",{className:"text-orange-600 text-xs ml-1",children:"(Lead)"})]}),a&&i.jsxs("span",{className:"text-xs text-gray-500 truncate",children:[o,": ",a]})]})})]}),i.jsx("button",{onClick:d=>{d.stopPropagation(),r==null||r()},children:i.jsx("svg",{className:`w-3 h-3 text-gray-400 transform transition-transform flex-shrink-0 ${t?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),t&&i.jsx("div",{className:"px-2 pb-2 bg-blue-25",children:i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded p-3 text-xs space-y-2",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("span",{className:"w-2 h-2 bg-blue-400 rounded-full"}),i.jsx("span",{className:"font-medium text-blue-900",children:"Contact Details"})]}),i.jsx("button",{onClick:d=>{d.stopPropagation(),n==null||n(e.id)},className:"text-blue-600 hover:text-blue-800 font-medium",children:"Edit"})]}),i.jsxs("div",{className:"space-y-1 ml-4",children:[e.title&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-blue-800",children:"Title:"})," ",i.jsx("span",{className:"text-blue-700",children:e.title})]}),e.company&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-blue-800",children:"Company:"})," ",i.jsx("span",{className:"text-blue-700",children:e.company})]}),e.email&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-blue-800",children:"Email:"})," ",i.jsx("span",{className:"text-blue-700",children:e.email})]}),e.phone&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-blue-800",children:"Phone:"})," ",i.jsx("span",{className:"text-blue-700",children:e.phone})]}),e.mobile_phone&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-blue-800",children:"Mobile:"})," ",i.jsx("span",{className:"text-blue-700",children:e.mobile_phone})]})]})]})})]})},pz=({note:e,onClick:t})=>i.jsx("div",{className:"p-3 hover:bg-blue-50 cursor-pointer transition-colors border-b border-gray-100 last:border-b-0 group",onClick:()=>t==null?void 0:t(e.id),children:i.jsx("div",{className:"flex items-start space-x-3",children:i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900 truncate group-hover:text-blue-900",children:e.title||"Untitled Note"}),i.jsx("svg",{className:"w-3 h-3 text-gray-400 group-hover:text-blue-600 opacity-0 group-hover:opacity-100 transition-opacity",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]}),i.jsx("div",{className:"text-xs text-gray-600 mb-2",children:e.created_at&&new Date(e.created_at).toLocaleDateString()}),e.body&&i.jsx("div",{className:"max-h-16 overflow-hidden",children:i.jsx(g0,{content:e.body,className:"text-xs text-gray-700",maxHeight:"max-h-16"})})]})})}),gz=({deal:e,onClick:t})=>{var r,n,s;return i.jsx("div",{className:"p-2 hover:bg-purple-50 cursor-pointer transition-colors border-b border-gray-100 last:border-b-0 group",onClick:()=>t==null?void 0:t(e.id),children:i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900 truncate group-hover:text-purple-900",children:e.deal_name||"Unnamed Deal"}),i.jsx("svg",{className:"w-3 h-3 text-gray-400 group-hover:text-purple-600 opacity-0 group-hover:opacity-100 transition-opacity",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]}),i.jsxs("div",{className:"flex items-center justify-between mt-1",children:[i.jsx("p",{className:"text-xs text-purple-600 font-medium",children:((r=e.deal_stage)==null?void 0:r.label)||"No stage"}),i.jsx("p",{className:"text-xs text-gray-500 truncate ml-2",children:((n=e.property)==null?void 0:n.property_name)||((s=e.property)==null?void 0:s.address)||"No property"})]})]})})})},xz=({siteSubmit:e,onClick:t})=>{var r,n,s;return i.jsx("div",{className:"p-2 hover:bg-green-50 cursor-pointer transition-colors border-b border-gray-100 last:border-b-0 group",onClick:()=>t==null?void 0:t(e.id),children:i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900 truncate group-hover:text-green-900",children:e.site_submit_name||e.sf_account||"Unnamed Submit"}),i.jsx("svg",{className:"w-3 h-3 text-gray-400 group-hover:text-green-600 opacity-0 group-hover:opacity-100 transition-opacity",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]}),i.jsxs("div",{className:"flex items-center justify-between mt-1",children:[i.jsx("p",{className:"text-xs text-green-600 font-medium",children:e.sf_submit_stage||"Site Submit"}),((r=e.property_unit)==null?void 0:r.property_unit_name)&&i.jsx("p",{className:"text-xs text-gray-600 font-medium",children:e.property_unit.property_unit_name}),i.jsx("p",{className:"text-xs text-gray-500 truncate ml-2",children:((n=e.property)==null?void 0:n.property_name)||((s=e.property)==null?void 0:s.address)||"No property"})]})]})})})},yz=({clientId:e,isMinimized:t=!1,onMinimize:r,onContactClick:n,onDealClick:s,onContactModalChange:a,onSiteSubmitModalChange:o})=>{const[l,c]=x.useState([]),[u,d]=x.useState([]),[f,m]=x.useState([]),[h,y]=x.useState([]),[v,w]=x.useState(!1),[g,b]=x.useState(null),[p,_]=x.useState(!1),[j,k]=x.useState(null),[N,S]=x.useState(!1),[C,E]=x.useState(null),T=()=>({contacts:l.length>0,notes:u.length>0,deals:f.length>0,siteSubmits:h.length>0}),[L,O]=x.useState(()=>{const R=localStorage.getItem(`expandedClientSidebarModules_${e}`);return R?JSON.parse(R):T()}),[A,M]=x.useState({});x.useEffect(()=>{if(!e)return;(async()=>{w(!0),b(null);try{const{data:P,error:D}=await $.from("contact").select("*").eq("client_id",e).order("created_at",{ascending:!1});if(D)throw D;c(P||[]);const{data:z,error:W}=await $.from("note_object_link").select(`
            note_id,
            note!note_object_link_note_id_fkey (*)
          `).eq("object_type","client").eq("object_id",e);if(W)throw W;const I=[];z&&z.forEach(J=>{J.note&&I.push(J.note)}),d(I);const{data:ne,error:re}=await $.from("deal").select(`
            *,
            deal_stage (
              label,
              sort_order
            ),
            property!property_id (
              property_name,
              address
            )
          `).eq("client_id",e).order("created_at",{ascending:!1});if(re)throw re;m(ne||[]);const{data:Q,error:U}=await $.from("site_submit").select(`
            *,
            property!property_id (
              property_name,
              address
            ),
            property_unit (
              property_unit_name
            )
          `).eq("client_id",e).order("created_at",{ascending:!1});if(U)throw U;y(Q||[])}catch(P){console.error("Error loading client sidebar data:",P),b(P instanceof Error?P.message:"Failed to load data")}finally{w(!1)}})()},[e]),x.useEffect(()=>{v||O(R=>{const P=T(),D=localStorage.getItem(`expandedClientSidebarModules_${e}`);return D?JSON.parse(D):P})},[l.length,u.length,f.length,h.length,v,e]);const B=R=>{const P={...L,[R]:!L[R]};O(P),localStorage.setItem(`expandedClientSidebarModules_${e}`,JSON.stringify(P))},F=R=>{const P={...A,[R]:!A[R]};M(P),localStorage.setItem(`expandedClientContacts_${e}`,JSON.stringify(P))};return i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:`fixed right-0 top-0 h-full bg-white border-l border-gray-200 shadow-xl transition-all duration-300 ${t?"w-12":"w-[500px]"} z-40 ${t?"overflow-hidden":"overflow-y-auto"}`,style:{top:"180px",height:"calc(100vh - 180px)"},children:[i.jsxs("div",{className:`flex items-center ${t?"justify-center":"justify-between"} p-2 border-b border-gray-200 bg-gray-50`,children:[!t&&i.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Client Info"}),i.jsx("button",{onClick:r,className:`p-2 hover:bg-blue-100 hover:text-blue-600 rounded-md transition-colors group ${t?"text-gray-600":"text-gray-500"}`,title:t?"Expand sidebar":"Minimize sidebar",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t?i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7M4 12h16"}):i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 5l7 7-7 7M20 12H4"})})})]}),!t&&i.jsx("div",{className:"p-3",children:v?i.jsx("div",{className:"p-4 space-y-3",children:[...Array(4)].map((R,P)=>i.jsx("div",{className:"animate-pulse",children:i.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[i.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2"}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"h-3 bg-gray-200 rounded"}),i.jsx("div",{className:"h-3 bg-gray-200 rounded w-2/3"})]})]})},P))}):g?i.jsxs("div",{className:"p-4 text-center text-red-600",children:[i.jsx("p",{className:"font-medium",children:"Error loading data"}),i.jsx("p",{className:"text-sm",children:g})]}):i.jsxs(i.Fragment,{children:[i.jsx(_c,{title:"Associated Contacts",count:l.length,onAddNew:()=>{k(null),_(!0),a==null||a(!0)},isExpanded:L.contacts,onToggle:()=>B("contacts"),icon:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z",isEmpty:l.length===0,children:l.map(R=>i.jsx(hz,{contact:R,isExpanded:A[R.id],onToggle:()=>F(R.id),onEdit:P=>{k(P),_(!0),a==null||a(!0)},onClick:n},R.id))}),i.jsx(_c,{title:"Associated Notes",count:u.length,onAddNew:()=>console.log("Add new note"),isExpanded:L.notes,onToggle:()=>B("notes"),icon:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z",isEmpty:u.length===0,showAddButton:!1,children:u.map(R=>i.jsx(pz,{note:R,onClick:()=>console.log("Navigate to note",R.id)},R.id))}),i.jsx(_c,{title:"Deals",count:f.length,onAddNew:()=>console.log("Add new deal"),isExpanded:L.deals,onToggle:()=>B("deals"),icon:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1",isEmpty:f.length===0,showAddButton:!1,children:f.map(R=>i.jsx(gz,{deal:R,onClick:s},R.id))}),i.jsx(_c,{title:"Site Submits",count:h.length,onAddNew:()=>{E(null),S(!0),o==null||o(!0)},isExpanded:L.siteSubmits,onToggle:()=>B("siteSubmits"),icon:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",isEmpty:h.length===0,children:h.map(R=>i.jsx(xz,{siteSubmit:R,onClick:P=>{E(P),S(!0),o==null||o(!0)}},R.id))})]})})]}),i.jsx(Jk,{isOpen:p,onClose:()=>{_(!1),k(null),a==null||a(!1)},contactId:j,clientId:e,onSave:R=>{c(P=>[R,...P]),_(!1),a==null||a(!1)},onUpdate:R=>{c(P=>P.map(D=>D.id===R.id?R:D)),_(!1),a==null||a(!1)}}),i.jsx(e0,{isOpen:N,onClose:()=>{S(!1),E(null),o==null||o(!1)},siteSubmitId:C,clientId:e,onSave:R=>{y(P=>[R,...P]),S(!1),o==null||o(!1)},onUpdate:R=>{y(P=>P.map(D=>D.id===R.id?R:D)),S(!1),o==null||o(!1)}})]})},Nv=()=>{const{clientId:e}=Ni(),t=Jt(),[r,n]=x.useState(null),[s,a]=x.useState("overview"),[o,l]=x.useState(!0),[c,u]=x.useState(null),[d,f]=x.useState(!1),[m,h]=x.useState(!1),[y,v]=x.useState(!1),{trackView:w}=Rl(),g=e==="new";x.useEffect(()=>{(async()=>{if(g){l(!1);return}if(!e){u("Client ID not provided"),l(!1);return}try{l(!0);const{data:k,error:N}=await $.from("client").select("*").eq("id",e).single();N?(console.error("Error fetching client:",N),u(`Failed to load client: ${N.message}`)):k&&(n(k),w(k.id,"client",k.client_name||"Unnamed Client",k.type||void 0))}catch(k){console.error("Unexpected error fetching client:",k),u("An unexpected error occurred while loading the client")}finally{l(!1)}})()},[e,g,w]);const b=j=>{n(j),g&&j.id&&t(`/client/${j.id}`,{replace:!0})},p=()=>{t("/")};if(o)return i.jsx("div",{className:"flex items-center justify-center min-h-64",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});if(c)return i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error Loading Client"}),i.jsx("div",{className:"mt-2 text-sm text-red-700",children:c})]})]})});const _=[{id:"overview",name:"Overview"},{id:"activities",name:"Activities"},{id:"notes",name:"Notes"}];return i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:`max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 transition-all duration-300 ${d?"mr-12":"mr-[500px]"}`,children:[i.jsx("div",{className:"mb-8",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:g?"New Client":(r==null?void 0:r.client_name)||"Unnamed Client"}),(r==null?void 0:r.type)&&i.jsx("p",{className:"text-sm text-gray-500 mt-1",children:r.type})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsxs("button",{onClick:()=>f(!d),className:"inline-flex items-center px-3 py-2 border border-blue-300 rounded-md shadow-sm text-sm font-medium text-blue-700 bg-blue-50 hover:bg-blue-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",title:d?"Show Client Sidebar":"Hide Client Sidebar",children:[i.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),d?"Show":"Hide"," Info"]}),i.jsx("button",{onClick:()=>t("/"),className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Back to Dashboard"})]})]})}),i.jsx("div",{className:"border-b border-gray-200 mb-6",children:i.jsx("nav",{className:"-mb-px flex space-x-8",children:_.map(j=>i.jsx("button",{onClick:()=>a(j.id),className:`py-2 px-1 border-b-2 font-medium text-sm ${s===j.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:j.name},j.id))})}),i.jsxs("div",{className:"mt-6",children:[s==="overview"&&i.jsx(mz,{client:r,isNewClient:g,onSave:b,onDelete:g?void 0:p}),s==="activities"&&i.jsx(Il,{parentObject:r?{id:r.id,type:"client",name:r.client_name||"Unnamed Client"}:null}),s==="notes"&&i.jsxs("div",{className:"text-gray-600",children:[i.jsx("p",{className:"mb-4",children:"Notes are displayed in the sidebar. Use the sidebar to view and manage client notes."}),i.jsxs("button",{onClick:()=>f(!1),className:"inline-flex items-center px-4 py-2 border border-blue-300 rounded-md shadow-sm text-sm font-medium text-blue-700 bg-blue-50 hover:bg-blue-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),"Show Client Sidebar"]})]})]})]}),e&&e!=="new"&&i.jsx(yz,{clientId:e,isMinimized:d,onMinimize:()=>f(!d),onContactClick:j=>t(`/contact/${j}`),onDealClick:j=>t(`/deal/${j}`),onContactModalChange:h,onSiteSubmitModalChange:v})]})},bz=()=>{const{siteSubmitId:e}=Ni(),t=Jt(),r=e==="new",[n,s]=x.useState({site_submit_name:"",client_id:null,property_id:null,property_unit_id:null,assignment_id:null,submit_stage_id:null,date_submitted:new Date().toISOString().split("T")[0],loi_written:!1,loi_date:"",delivery_date:"",delivery_timeframe:"",notes:"",customer_comments:"",competitor_data:"",record_type_id:null,verified_latitude:null,verified_longitude:null,year_1_rent:null,ti:null}),[a,o]=x.useState([]),[l,c]=x.useState([]),[u,d]=x.useState(!1),[f,m]=x.useState(!1),[h,y]=x.useState({}),[v,w]=x.useState(""),[g,b]=x.useState(!1);x.useEffect(()=>{(async()=>{var C,E,T;d(!0);try{const[L,O]=await Promise.all([$.from("client").select("*").order("client_name"),$.from("submit_stage").select("*").order("name")]);if(L.data&&o(L.data),O.data&&c(O.data),e&&!r){const{data:A,error:M}=await $.from("site_submit").select("*").eq("id",e).single();M?console.error("Error loading site submit:",M):A&&(s({site_submit_name:A.site_submit_name||"",client_id:A.client_id,property_id:A.property_id,property_unit_id:A.property_unit_id,assignment_id:A.assignment_id,submit_stage_id:A.submit_stage_id,date_submitted:((C=A.date_submitted)==null?void 0:C.split("T")[0])||new Date().toISOString().split("T")[0],loi_written:A.loi_written||!1,loi_date:((E=A.loi_date)==null?void 0:E.split("T")[0])||"",delivery_date:((T=A.delivery_date)==null?void 0:T.split("T")[0])||"",delivery_timeframe:A.delivery_timeframe||"",notes:A.notes||"",customer_comments:A.customer_comments||"",competitor_data:A.competitor_data||"",record_type_id:A.record_type_id,verified_latitude:A.verified_latitude,verified_longitude:A.verified_longitude,year_1_rent:A.year_1_rent,ti:A.ti}),b(!0))}}catch(L){console.error("Error loading form data:",L)}finally{d(!1)}})()},[e,r]);const p=(S,C)=>{if(!S||!C)return"";const E=a.find(T=>T.id===S);return E?`${E.client_name} - ${C}`:""},_=(S,C)=>{if(s(E=>({...E,[S]:C})),h[S]&&y(E=>({...E,[S]:""})),S==="client_id"&&!g&&v){const E=p(C,v);E&&s(T=>({...T,site_submit_name:E}))}S==="property_id"&&!g&&n.client_id&&C&&$.from("property").select("property_name").eq("id",C).single().then(({data:E})=>{if(E!=null&&E.property_name){w(E.property_name);const T=p(n.client_id,E.property_name);T&&s(L=>({...L,site_submit_name:T}))}}),S==="site_submit_name"&&b(!0)},j=()=>{var C;const S={};return(C=n.site_submit_name)!=null&&C.trim()||(S.site_submit_name="Site submit name is required"),n.client_id||(S.client_id="Client selection is required"),n.property_id||(S.property_id="Property selection is required"),y(S),Object.keys(S).length===0},k=async()=>{if(j()){m(!0);try{if(e&&!r){const S={...n,date_submitted:n.date_submitted||null,loi_date:n.loi_date||null,delivery_date:n.delivery_date||null,updated_at:new Date().toISOString()},{data:C,error:E}=await $.from("site_submit").update(S).eq("id",e).select().single();if(E)throw E}else{const S={...n,date_submitted:n.date_submitted||null,loi_date:n.loi_date||null,delivery_date:n.delivery_date||null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{data:C,error:E}=await $.from("site_submit").insert(S).select().single();if(E)throw E;C&&t(`/site-submit/${C.id}`,{replace:!0})}alert("Site submit saved successfully!")}catch(S){console.error("Error saving site submit:",S),alert(`Error saving site submit: ${S instanceof Error?S.message:"Unknown error"}. Please check the console for details.`)}finally{m(!1)}}},N=async()=>{if(!(!e||r)&&confirm("Are you sure you want to delete this site submit? This action cannot be undone."))try{const{error:S}=await $.from("site_submit").delete().eq("id",e);if(S)throw S;alert("Site submit deleted successfully!"),t("/master-pipeline")}catch(S){console.error("Error deleting site submit:",S),alert(`Error deleting site submit: ${S instanceof Error?S.message:"Unknown error"}`)}};return i.jsx("div",{className:"min-h-screen bg-gray-50",children:i.jsxs("div",{className:"max-w-4xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[i.jsx("div",{className:"bg-white shadow rounded-lg mb-6",children:i.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:r?"New Site Submit":"Edit Site Submit"}),i.jsx("p",{className:"mt-1 text-sm text-gray-500",children:r?"Create a new site submit record":"Update site submit information"})]}),i.jsxs("div",{className:"flex space-x-3",children:[i.jsx("button",{onClick:()=>t("/master-pipeline"),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Back to Pipeline"}),!r&&i.jsx("button",{onClick:N,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 border border-transparent rounded-md hover:bg-red-700",children:"Delete"}),i.jsx("button",{onClick:k,disabled:f||u,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 disabled:opacity-50",children:f?"Saving...":"Save Site Submit"})]})]})})}),i.jsx("div",{className:"bg-white shadow rounded-lg",children:i.jsx("div",{className:"p-6 space-y-8",children:u?i.jsx("div",{className:"flex items-center justify-center h-32",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Basic Information"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Site Submit Name *"}),i.jsx("input",{type:"text",value:n.site_submit_name,onChange:S=>_("site_submit_name",S.target.value),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${h.site_submit_name?"border-red-300":""}`,placeholder:"Enter site submit name"}),h.site_submit_name&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:h.site_submit_name})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client *"}),i.jsxs("select",{value:n.client_id||"",onChange:S=>_("client_id",S.target.value||null),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${h.client_id?"border-red-300":""}`,children:[i.jsx("option",{value:"",children:"Select a client..."}),a.map(S=>i.jsx("option",{value:S.id,children:S.client_name},S.id))]}),h.client_id&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:h.client_id})]}),i.jsx(Kg,{value:n.property_id,onChange:S=>_("property_id",S),label:"Property *"}),h.property_id&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:h.property_id}),n.property_id&&i.jsx(Gg,{propertyId:n.property_id,value:n.property_unit_id,onChange:S=>_("property_unit_id",S),label:"Property Unit (Optional)"})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Submission Details"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Submit Stage"}),i.jsxs("select",{value:n.submit_stage_id||"",onChange:S=>_("submit_stage_id",S.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",children:[i.jsx("option",{value:"",children:"Select stage..."}),l.map(S=>i.jsx("option",{value:S.id,children:S.name},S.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date Submitted"}),i.jsx("input",{type:"date",value:n.date_submitted,onChange:S=>_("date_submitted",S.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm"})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("input",{type:"checkbox",id:"loi_written",checked:n.loi_written,onChange:S=>_("loi_written",S.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),i.jsx("label",{htmlFor:"loi_written",className:"text-sm font-medium text-gray-700",children:"LOI Written"})]}),n.loi_written&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"LOI Date"}),i.jsx("input",{type:"date",value:n.loi_date,onChange:S=>_("loi_date",S.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Delivery Date"}),i.jsx("input",{type:"date",value:n.delivery_date,onChange:S=>_("delivery_date",S.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Delivery Timeframe"}),i.jsx("input",{type:"text",value:n.delivery_timeframe,onChange:S=>_("delivery_timeframe",S.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"e.g., 30-60 days, Q1 2024"})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Financial Information"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year 1 Rent ($)"}),i.jsx("input",{type:"number",step:"0.01",value:n.year_1_rent||"",onChange:S=>_("year_1_rent",S.target.value?parseFloat(S.target.value):null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"TI ($)"}),i.jsx("input",{type:"number",step:"0.01",value:n.ti||"",onChange:S=>_("ti",S.target.value?parseFloat(S.target.value):null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"0.00"})]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Location Verification"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Verified Latitude"}),i.jsx("input",{type:"number",step:"any",value:n.verified_latitude||"",onChange:S=>_("verified_latitude",S.target.value?parseFloat(S.target.value):null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"e.g., 40.7128"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Verified Longitude"}),i.jsx("input",{type:"number",step:"any",value:n.verified_longitude||"",onChange:S=>_("verified_longitude",S.target.value?parseFloat(S.target.value):null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"e.g., -74.0060"})]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Notes & Comments"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),i.jsx("textarea",{rows:3,value:n.notes,onChange:S=>_("notes",S.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"Internal notes..."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer Comments"}),i.jsx("textarea",{rows:3,value:n.customer_comments,onChange:S=>_("customer_comments",S.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"Customer feedback or requirements..."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Competitor Data"}),i.jsx("textarea",{rows:3,value:n.competitor_data,onChange:S=>_("competitor_data",S.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"Competitive landscape information..."})]})]})]})})})]})})};function vz({assignment:e,onSave:t}){const[r,n]=x.useState(e),[s,a]=x.useState(!1),[o,l]=x.useState(null),[c,u]=x.useState({}),[d,f]=x.useState([]);x.useState([]),x.useState([]);const[m,h]=x.useState([]),[y,v]=x.useState(""),[w,g]=x.useState([]),[b,p]=x.useState(""),[_,j]=x.useState([]);x.useEffect(()=>{const E={...e};if(e.assignment_value&&e.commission){const T=(e.assignment_value||0)*((e.commission||0)/100);E.fee=Math.round(T*100)/100}n(E),u({}),g([]),j([]),e.client_id?$.from("client").select("client_name").eq("id",e.client_id).single().then(({data:T})=>{T&&v(T.client_name||"")}):v(""),e.deal_id?$.from("deal").select("deal_name").eq("id",e.deal_id).single().then(({data:T})=>{T&&p(T.deal_name||"")}):p("")},[e]),x.useEffect(()=>{(async()=>{const{data:T}=await $.from("assignment_priority").select("*").eq("active",!0).order("sort_order");T&&f(T);const{data:L}=await $.from("user").select("id, name").order("name");L&&h(L.map(O=>({id:O.id,label:O.name||"Unknown User"})))})()},[]),x.useEffect(()=>{const E=setTimeout(async()=>{if(y.trim().length>0){const{data:T}=await $.from("client").select("id, client_name").ilike("client_name",`%${y}%`).limit(5);T&&g(T.map(L=>({id:L.id,label:L.client_name||"Unnamed Client"})))}else g([])},300);return()=>clearTimeout(E)},[y]),x.useEffect(()=>{const E=setTimeout(async()=>{if(b.trim().length>0){const{data:T}=await $.from("deal").select("id, deal_name").ilike("deal_name",`%${b}%`).limit(5);T&&j(T.map(L=>({id:L.id,label:L.deal_name||"Unnamed Deal"})))}else j([])},300);return()=>clearTimeout(E)},[b]);const k=async(E,T)=>{let L={...r,[E]:T};if(E==="assignment_value"||E==="commission"){const O=E==="assignment_value"?T:L.assignment_value,A=E==="commission"?T:L.commission,M=(O||0)*((A||0)/100);L.fee=Math.round(M*100)/100}if(n(L),c[E]&&u(O=>{const A={...O};return delete A[E],A}),r.id&&r.id!=="new")try{const O={assignment_name:L.assignment_name,assignment_value:L.assignment_value,client_id:L.client_id,deal_id:L.deal_id,owner_id:L.owner_id,priority_id:L.priority_id,transaction_type_id:L.transaction_type_id,due_date:L.due_date,commission:L.commission,fee:L.fee,referral_fee:L.referral_fee,referral_payee_id:L.referral_payee_id,scoped:L.scoped,site_criteria:L.site_criteria,updated_at:new Date().toISOString()},{data:A,error:M}=await $.from("assignment").update(O).eq("id",r.id).select().single();if(M)throw M;A&&t(A)}catch(O){console.error("Error auto-saving assignment:",O),alert(`Auto-save failed: ${O instanceof Error?O.message:"Unknown error"}`)}},N=()=>{var T;const E={};return(T=r.assignment_name)!=null&&T.trim()||(E.assignment_name="Assignment name is required"),r.priority_id||(E.priority_id="Priority is required"),u(E),Object.keys(E).length===0},S=async()=>{if(!N())return;a(!0);const E=(r.assignment_value||0)*((r.commission||0)/100),T={assignment_name:r.assignment_name,assignment_value:r.assignment_value,client_id:r.client_id,deal_id:r.deal_id,owner_id:r.owner_id,priority_id:r.priority_id,transaction_type_id:r.transaction_type_id,due_date:r.due_date,commission:r.commission,fee:Math.round(E*100)/100,referral_fee:r.referral_fee,referral_payee_id:r.referral_payee_id,scoped:r.scoped,site_criteria:r.site_criteria,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};try{const{data:L,error:O}=await $.from("assignment").insert([T]).select().single();if(O)throw O;L&&t(L)}catch(L){console.error("Error creating assignment:",L),alert(`Error creating assignment: ${L instanceof Error?L.message:"Unknown error"}`)}finally{a(!1)}},C=E=>{if(!E)return null;try{return Fg(E)}catch{return null}};return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Assignment Details"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assignment Name *"}),i.jsx("input",{type:"text",value:r.assignment_name||"",onChange:E=>k("assignment_name",E.target.value),className:`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 ${c.assignment_name?"border-red-500":"border-gray-300"}`,placeholder:"Enter assignment name",tabIndex:1}),c.assignment_name&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.assignment_name})]}),i.jsx(Ys,{label:"Assignment Value",value:r.assignment_value,onChange:E=>k("assignment_value",E===""?null:parseFloat(E)),format:E=>Ro(E,2),editingField:o,setEditingField:l,fieldKey:"assignment_value",tabIndex:2}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority *"}),i.jsxs("select",{value:r.priority_id||"",onChange:E=>k("priority_id",E.target.value||null),className:`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 ${c.priority_id?"border-red-500":"border-gray-300"}`,tabIndex:3,children:[i.jsx("option",{value:"",children:"Select priority..."}),d.map(E=>i.jsx("option",{value:E.id,children:E.label},E.id))]}),c.priority_id&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.priority_id})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Owner"}),i.jsxs("select",{value:r.owner_id||"",onChange:E=>k("owner_id",E.target.value||null),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500",tabIndex:4,children:[i.jsx("option",{value:"",children:"Select owner..."}),m.map(E=>i.jsx("option",{value:E.id,children:E.label},E.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Due Date"}),i.jsx(Ok,{selected:C(r.due_date),onChange:E=>k("due_date",E?E.toISOString().split("T")[0]:null),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholderText:"Select due date",dateFormat:"yyyy-MM-dd",tabIndex:5})]})]})]}),i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Relationships"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client"}),i.jsx("input",{type:"text",value:y,onChange:E=>v(E.target.value),onFocus:E=>E.target.select(),placeholder:"Search clients...",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500",tabIndex:6}),w.filter(E=>E.label!==y).length>0&&i.jsx("ul",{className:"bg-white border border-gray-300 rounded mt-1 max-h-48 overflow-auto shadow-lg",children:w.filter(E=>E.label!==y).map(E=>i.jsx("li",{onClick:()=>{k("client_id",E.id),v(E.label),g([])},className:"px-3 py-2 hover:bg-gray-100 cursor-pointer text-sm",children:E.label},E.id))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Deal"}),i.jsx("input",{type:"text",value:b,onChange:E=>p(E.target.value),onFocus:E=>E.target.select(),placeholder:"Search deals...",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500",tabIndex:7}),_.filter(E=>E.label!==b).length>0&&i.jsx("ul",{className:"bg-white border border-gray-300 rounded mt-1 max-h-48 overflow-auto shadow-lg",children:_.filter(E=>E.label!==b).map(E=>i.jsx("li",{onClick:()=>{k("deal_id",E.id),p(E.label),j([])},className:"px-3 py-2 hover:bg-gray-100 cursor-pointer text-sm",children:E.label},E.id))})]})]})]}),i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Financial Details"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsx(Ys,{label:"Commission %",value:r.commission,onChange:E=>k("commission",E===""?null:parseFloat(E)),format:E=>Ih(E,2),editingField:o,setEditingField:l,fieldKey:"commission",tabIndex:8}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Calculated Fee"}),i.jsx("div",{className:"mt-1 p-2 bg-gray-100 rounded text-sm",children:Ro(r.fee,2)})]}),i.jsx(Ys,{label:"Referral Fee %",value:r.referral_fee,onChange:E=>k("referral_fee",E===""?null:parseFloat(E)),format:E=>Ih(E,2),editingField:o,setEditingField:l,fieldKey:"referral_fee",tabIndex:9}),i.jsx(Bk,{value:r.referral_payee_id,onChange:E=>k("referral_payee_id",E),label:"Referral Payee",tabIndex:10})]})]}),i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Additional Details"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",id:"scoped",checked:r.scoped||!1,onChange:E=>k("scoped",E.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded",tabIndex:11}),i.jsx("label",{htmlFor:"scoped",className:"ml-2 block text-sm text-gray-900",children:"Scoped Assignment"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Site Criteria"}),i.jsx("textarea",{value:r.site_criteria||"",onChange:E=>k("site_criteria",E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Enter site criteria...",tabIndex:12})]})]})]}),r.id==="new"&&i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{onClick:S,disabled:s,className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",tabIndex:13,children:s?"Creating...":"Create Assignment"})})]})}const wz=({assignment:e,isNewAssignment:t,onSave:r})=>i.jsx("div",{children:i.jsx(vz,{assignment:e,onSave:r})}),_z=({title:e,count:t,onAddNew:r,children:n,isExpanded:s=!0,onToggle:a,icon:o,isEmpty:l=!1})=>i.jsxs("div",{className:`bg-white border border-gray-200 rounded-lg mb-3 shadow-sm ${l?"opacity-60":""}`,children:[i.jsxs("div",{className:`flex items-center justify-between p-3 border-b border-gray-100 ${l?"bg-gray-50":"bg-gradient-to-r from-slate-50 to-gray-50"}`,children:[i.jsxs("button",{onClick:a,className:"flex items-center space-x-2 flex-1 text-left hover:bg-white/50 -mx-3 px-3 py-1 rounded-t-lg transition-colors",children:[i.jsx("svg",{className:`w-4 h-4 text-gray-400 transform transition-transform ${s?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),o&&i.jsx("div",{className:"w-4 h-4 flex items-center justify-center",children:i.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:o})})}),i.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:e}),i.jsx("span",{className:`inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium ${l?"bg-gray-200 text-gray-600":"bg-blue-100 text-blue-800"}`,children:t}),l&&i.jsx("span",{className:"text-xs text-gray-500 italic",children:"(Empty)"})]}),i.jsxs("button",{onClick:r,className:"flex items-center px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors ml-2",children:[i.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"New"]})]}),s&&i.jsx("div",{className:"max-h-[560px] overflow-y-auto",children:t===0?i.jsxs("div",{className:"p-4 text-center text-gray-500 text-sm",children:[i.jsx("div",{className:"w-12 h-12 mx-auto mb-2 bg-gray-100 rounded-full flex items-center justify-center",children:o&&i.jsx("svg",{className:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:o})})}),"No ",e.toLowerCase()," yet"]}):n})]}),jz=({siteSubmit:e,onClick:t})=>{var r,n;return i.jsx("div",{className:"p-2 hover:bg-green-50 cursor-pointer transition-colors border-b border-gray-100 last:border-b-0 group",onClick:()=>t==null?void 0:t(e.id),children:i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900 truncate group-hover:text-green-900",children:e.site_submit_name||e.sf_account||"Unnamed Submit"}),i.jsx("svg",{className:"w-3 h-3 text-gray-400 group-hover:text-green-600 opacity-0 group-hover:opacity-100 transition-opacity",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]}),i.jsxs("div",{className:"flex items-center justify-between mt-1",children:[i.jsx("p",{className:"text-xs text-green-600 font-medium",children:e.sf_submit_stage||"Site Submit"}),((r=e.property_unit)==null?void 0:r.property_unit_name)&&i.jsx("p",{className:"text-xs text-gray-600 font-medium",children:e.property_unit.property_unit_name}),i.jsx("p",{className:"text-xs text-gray-500 truncate ml-2",children:((n=e.client)==null?void 0:n.client_name)||"No client"})]})]})})})},kz=({assignmentId:e,isMinimized:t=!1,onMinimize:r,onSiteSubmitModalChange:n})=>{const[s,a]=x.useState([]),[o,l]=x.useState(!1),[c,u]=x.useState(null),[d,f]=x.useState(!1),[m,h]=x.useState(null),[y,v]=x.useState(()=>{const g=localStorage.getItem(`expandedSidebarModules_assignment_${e}`);return g?JSON.parse(g):{siteSubmits:!0}});x.useEffect(()=>{if(!e||e==="new"){a([]),l(!1);return}(async()=>{l(!0),u(null);try{const{data:b,error:p}=await $.from("site_submit").select(`
            *,
            client!client_id (
              client_name
            ),
            property_unit (
              property_unit_name
            )
          `).eq("assignment_id",e).order("created_at",{ascending:!1});if(p)throw p;a(b||[])}catch(b){console.error("Error loading assignment sidebar data:",b),u(b instanceof Error?b.message:"Failed to load data")}finally{l(!1)}})()},[e]),x.useEffect(()=>{o||v(g=>{const b={siteSubmits:s.length>0},p=localStorage.getItem(`expandedSidebarModules_assignment_${e}`);return p?JSON.parse(p):b})},[s.length,o,e]);const w=g=>{const b={...y,[g]:!y[g]};v(b),localStorage.setItem(`expandedSidebarModules_assignment_${e}`,JSON.stringify(b))};return i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:`fixed right-0 bg-white border-l border-gray-200 shadow-xl transition-all duration-300 ${t?"w-12":"w-[500px]"} z-40 ${t?"overflow-hidden":"overflow-visible"}`,style:{top:"180px",height:t?"60px":`${Math.min(120+s.length*52,120+10*52)}px`},children:[i.jsxs("div",{className:`flex items-center ${t?"justify-center":"justify-between"} p-2 border-b border-gray-200 bg-gray-50`,children:[!t&&i.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Assignment Info"}),i.jsx("button",{onClick:r,className:`p-2 hover:bg-blue-100 hover:text-blue-600 rounded-md transition-colors group ${t?"text-gray-600":"text-gray-500"}`,title:t?"Expand sidebar":"Minimize sidebar",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t?i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7M4 12h16"}):i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 5l7 7-7 7M20 12H4"})})})]}),!t&&i.jsx("div",{className:"p-3",children:o?i.jsx("div",{className:"p-4 space-y-3",children:i.jsx("div",{className:"animate-pulse",children:i.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[i.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2"}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"h-3 bg-gray-200 rounded"}),i.jsx("div",{className:"h-3 bg-gray-200 rounded w-2/3"})]})]})})}):c?i.jsxs("div",{className:"p-4 text-center text-red-600",children:[i.jsx("p",{className:"font-medium",children:"Error loading data"}),i.jsx("p",{className:"text-sm",children:c})]}):i.jsx(i.Fragment,{children:i.jsx(_z,{title:"Associated Site Submits",count:s.length,onAddNew:()=>{if(e==="new"){alert("Please save the assignment first before adding site submits.");return}h(null),f(!0),n==null||n(!0)},isExpanded:y.siteSubmits,onToggle:()=>w("siteSubmits"),icon:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",isEmpty:s.length===0,children:s.map(g=>i.jsx(jz,{siteSubmit:g,onClick:b=>{h(b),f(!0),n==null||n(!0)}},g.id))})})})]}),e!=="new"&&i.jsx(e0,{isOpen:d,onClose:()=>{f(!1),h(null),n==null||n(!1)},siteSubmitId:m,assignmentId:e,onSave:g=>{a(b=>[g,...b]),f(!1),n==null||n(!1)},onUpdate:g=>{a(b=>b.map(p=>p.id===g.id?g:p)),f(!1),n==null||n(!1)}})]})};function Sv(){const{assignmentId:e}=Ni(),t=Vr(),r=Jt(),[n,s]=x.useState(null),[a,o]=x.useState("details"),[l,c]=x.useState(!1),[u,d]=x.useState(!0),[f,m]=x.useState(null),[h,y]=x.useState(!1),[v,w]=x.useState(!1),{trackView:g}=Rl(),b=e||(t.pathname==="/assignment/new"?"new":void 0);x.useEffect(()=>{const j=async()=>{if(b==="new"){console.log("Creating new blank assignment...");const k={id:"new",assignment_name:"",assignment_value:null,client_id:null,deal_id:null,owner_id:null,priority_id:null,transaction_type_id:null,due_date:null,progress:null,commission:null,fee:null,referral_fee:null,referral_payee_id:null,scoped:null,site_criteria:null,sf_id:null,sf_account_id:null,sf_opportunity_id:null,sf_owner_id:null,sf_priority:null,sf_referral_payee:null,sf_scoped_formula:null,sf_transaction_type:null,sf_num_of_pursuing_ownership:null,sf_num_of_site_submits:null,sf_number_of_pursuing_ownership:null,sf_number_of_site_submits:null,created_at:null,updated_at:null,created_by_id:null,updated_by_id:null,sf_created_by_id:null,updated_by_sf_id:null};console.log("Blank assignment created:",k),s(k),c(!0),d(!1);return}if(!b){m("No assignment ID provided"),d(!1);return}try{console.log("Fetching existing assignment with ID:",b);const{data:k,error:N}=await $.from("assignment").select("*").eq("id",b).single();N?(console.error("Error fetching assignment:",N),m(`Failed to load assignment: ${N.message}`)):k?(console.log("Assignment loaded:",k),s(k),c(!1),g(k.id,"assignment",k.assignment_name||"Unnamed Assignment",k.client_id?"Client Assignment":void 0)):m("Assignment not found")}catch(k){console.error("Unexpected error:",k),m("An unexpected error occurred")}finally{d(!1)}};console.log("AssignmentDetailsPage useEffect - actualAssignmentId:",b,"type:",typeof b),b?(console.log("AssignmentDetailsPage useEffect triggered with actualAssignmentId:",b),b==="new"&&o("details"),j()):(console.log("No actualAssignmentId provided - this should not happen for assignment routes"),m("Invalid assignment route"),d(!1))},[b]);const p=j=>{s(j),l&&j.id&&j.id!=="new"&&(c(!1),r(`/assignment/${j.id}`,{replace:!0}))};if(u)return i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),i.jsx("div",{className:"text-sm text-gray-600",children:b==="new"?"Initializing new assignment...":"Loading assignment..."})]})});if(f)return i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsx("div",{className:"bg-white rounded-lg border border-red-200 p-6 max-w-md mx-4",children:i.jsxs("div",{className:"text-red-600 text-center",children:[i.jsx("svg",{className:"w-12 h-12 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.732 15.5c-.77.833.192 2.5 1.732 2.5z"})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Assignment Not Found"}),i.jsx("p",{className:"text-sm text-gray-600 mb-4",children:f}),i.jsx("button",{onClick:()=>r(-1),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm",children:"Go Back"})]})})});if(!n)return i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsx("div",{className:"text-center text-gray-600 py-8",children:i.jsx("p",{className:"text-sm",children:"Assignment not found"})})});const _=n.assignment_name||(l?"New Assignment":"Unnamed Assignment");return i.jsxs("div",{className:"min-h-screen bg-gray-100 flex flex-col",children:[i.jsx("div",{className:"bg-white border-b border-gray-200",children:i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"flex justify-between items-center py-6 md:justify-start md:space-x-10",children:[i.jsx("div",{className:"flex justify-start lg:w-0 lg:flex-1",children:i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:_})}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("button",{onClick:()=>r("/master-pipeline"),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Back to Pipeline"}),!l&&n.progress&&typeof n.progress=="string"&&!n.progress.includes("<")&&i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${n.progress==="Completed"?"bg-green-100 text-green-800":n.progress==="In Progress"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:n.progress})]})]})})}),i.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[i.jsx("div",{className:`flex-1 overflow-y-auto transition-all duration-300 ease-in-out ${v?"lg:-translate-x-[350px]":h?"":"lg:-translate-x-[100px]"}`,children:i.jsxs("div",{className:"max-w-4xl mx-auto p-4 pb-8",children:[i.jsx("div",{className:"border-b border-gray-200 mb-6",children:i.jsxs("nav",{className:"-mb-px flex space-x-8",children:[i.jsx("button",{onClick:()=>o("details"),className:`py-2 px-1 border-b-2 font-medium text-sm ${a==="details"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Details"}),i.jsx("button",{onClick:()=>o("activity"),className:`py-2 px-1 border-b-2 font-medium text-sm ${a==="activity"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Activity"})]})}),a==="details"&&i.jsx(wz,{assignment:n,isNewAssignment:l,onSave:p}),a==="activity"&&i.jsx(i.Fragment,{children:l||!n.id||n.id==="new"?i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-4",children:i.jsx("div",{className:"flex",children:i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Save Assignment First"}),i.jsx("div",{className:"mt-2 text-sm text-yellow-700",children:i.jsx("p",{children:"Please save the assignment in the Details tab before viewing activities."})})]})})}):i.jsx(Il,{config:{parentObject:{id:n.id,type:"assignment",name:_},title:"Assignment Activities",showSummary:!0,allowAdd:!0}})})]})}),i.jsx(kz,{assignmentId:b||"new",isMinimized:h,onMinimize:()=>y(!h),onSiteSubmitModalChange:w})]})]})}class Nz{constructor(){this.GOOGLE_GEOCODING_BASE_URL="https://maps.googleapis.com/maps/api/geocode/json",this.NOMINATIM_BASE_URL="https://nominatim.openstreetmap.org/search",this.USER_AGENT="PropertyKanbanApp/1.0",this.GOOGLE_RATE_LIMIT_MS=100,this.OSM_RATE_LIMIT_MS=1100,this.lastGoogleRequest=0,this.lastOsmRequest=0}async waitForRateLimit(t,r){const s=Date.now()-t;if(s<r){const a=r-s;console.log(` Rate limiting: waiting ${a}ms`),await new Promise(o=>setTimeout(o,a))}}async geocodeWithGoogle(t){const r="AIzaSyCS8UH-mxZHSYLtm-MUut42R84NRNfYQRQ";try{await this.waitForRateLimit(this.lastGoogleRequest,this.GOOGLE_RATE_LIMIT_MS),this.lastGoogleRequest=Date.now();const n=await fetch(`${this.GOOGLE_GEOCODING_BASE_URL}?`+new URLSearchParams({address:t,key:r,region:"us"}));if(!n.ok)throw new Error(`Google Geocoding API responded with status: ${n.status}`);const s=await n.json();if(console.log(" Google API Response Status:",s.status),s.status==="REQUEST_DENIED"){const d=`Google API error: ${s.error_message||"Request denied"}`;return console.error(" Google REQUEST_DENIED:",d),{error:d,code:"REQUEST_DENIED"}}if(s.status==="OVER_QUERY_LIMIT")return console.error(" Google QUOTA_EXCEEDED"),{error:"Google API quota exceeded",code:"QUOTA_EXCEEDED"};if(s.status!=="OK"||!s.results||s.results.length===0)return console.error(" Google NOT_FOUND or NO_RESULTS, status:",s.status),{error:`Address not found by Google (status: ${s.status})`,code:"NOT_FOUND"};const a=s.results[0],{geometry:o,formatted_address:l,address_components:c}=a,u={city:"",state:"",zip:"",county:""};return c.forEach(d=>{const f=d.types;f.includes("locality")?u.city=d.long_name:f.includes("administrative_area_level_1")?u.state=d.short_name:f.includes("postal_code")?u.zip=d.long_name:f.includes("administrative_area_level_2")&&(u.county=d.long_name)}),console.log(" Google Geocoding successful:",l),{latitude:o.location.lat,longitude:o.location.lng,formatted_address:l,city:u.city||void 0,state:u.state||void 0,zip:u.zip||void 0,county:u.county||void 0,provider:"google"}}catch(n){const s=n instanceof Error?n.message:"Google geocoding failed";return console.error(" Google Geocoding error:",s),{error:s,code:"GOOGLE_ERROR"}}}async geocodeWithOSM(t){try{await this.waitForRateLimit(this.lastOsmRequest,this.OSM_RATE_LIMIT_MS),this.lastOsmRequest=Date.now();const r=t.trim().replace(/\s+/g," ");if(!r)return{error:"Address is required"};const n=await fetch(`${this.NOMINATIM_BASE_URL}?`+new URLSearchParams({q:r,format:"json",limit:"1",addressdetails:"1",countrycodes:"us"}),{headers:{"User-Agent":this.USER_AGENT}});if(!n.ok)throw new Error(`OSM Geocoding API responded with status: ${n.status}`);const s=await n.json();if(!s||s.length===0)return{error:"Address not found by OSM",code:"NOT_FOUND"};const a=s[0],o=a.address||{};return console.log(" OSM Geocoding successful:",a.display_name),{latitude:parseFloat(a.lat),longitude:parseFloat(a.lon),formatted_address:a.display_name,city:o.city||o.town||o.village||o.hamlet,state:o.state,zip:o.postcode,county:o.county,provider:"openstreetmap"}}catch(r){return console.error("OSM Geocoding error:",r),{error:r instanceof Error?r.message:"OSM geocoding failed",code:"OSM_ERROR"}}}async geocodeAddress(t){try{console.log(" Starting geocoding for:",t),console.log(" Trying Google Geocoding API...");const r=await this.geocodeWithGoogle(t);if("latitude"in r)return console.log(" Google geocoding successful"),r;console.log(" Google failed, trying OpenStreetMap fallback...");const n=await this.geocodeWithOSM(t);return"latitude"in n?(console.log(" OSM fallback successful"),n):(console.error(" Both geocoding services failed"),{error:`Geocoding failed: Google (${r.error}), OSM (${n.error})`,code:"ALL_SERVICES_FAILED"})}catch(r){return console.error(" Geocoding error:",r),{error:r instanceof Error?r.message:"Geocoding failed",code:"GEOCODING_ERROR"}}}async batchGeocodeAddresses(t,r={}){const{onProgress:n,onSuccess:s,onError:a,maxRetries:o=2}=r,l=[],c=[];console.log(` Starting batch geocoding for ${t.length} addresses`);for(let u=0;u<t.length;u++){const d=t[u];let f=0,m=null;for(n==null||n(u,t.length,d);f<o;)try{console.log(` Geocoding (${u+1}/${t.length}): ${d} (attempt ${f+1})`);const h=await this.geocodeAddress(d);if("latitude"in h){l.push({address:d,result:h}),s==null||s(d,h),console.log(` Success for: ${d}`);break}else m=h,f++,h.code==="QUOTA_EXCEEDED"?(console.log(" Quota exceeded, waiting 60 seconds before retry..."),await new Promise(y=>setTimeout(y,6e4))):f<o&&await new Promise(y=>setTimeout(y,5e3))}catch(h){m={error:h instanceof Error?h.message:"Unknown error",code:"BATCH_ERROR"},f++,f<o&&await new Promise(y=>setTimeout(y,5e3))}f>=o&&m&&(c.push({address:d,error:m}),a==null||a(d,m),console.error(` Failed after ${o} attempts: ${d}`,m)),n&&n(u+1,t.length)}return console.log(` Batch geocoding complete: ${l.length} successful, ${c.length} failed`),{successful:l,failed:c}}async getPropertiesNeedingGeocoding(t=50,r){if(!r)return console.log(" No Supabase client provided - returning empty array"),[];try{console.log(` Getting properties needing geocoding (limit: ${t})...`);const{data:n,error:s}=await r.from("property").select("id, property_name, address, city, state, zip, latitude, longitude, verified_latitude, verified_longitude").is("latitude",null).is("longitude",null).is("verified_latitude",null).is("verified_longitude",null).not("address","is",null).neq("address","").limit(t);if(s)throw console.error(" Database error getting properties:",s),s;const a=(n||[]).map(o=>({id:o.id,address:o.address,city:o.city,state:o.state,zip:o.zip,property_name:o.property_name}));return console.log(` Found ${a.length} properties needing geocoding`),a}catch(n){return console.error(" Error getting properties needing geocoding:",n),[]}}async updatePropertyCoordinates(t,r,n,s=!1){if(!n)return console.log(" No Supabase client provided - skipping database update"),!1;try{const a=s?{verified_latitude:r.latitude,verified_longitude:r.longitude,updated_at:new Date().toISOString()}:{latitude:r.latitude,longitude:r.longitude,updated_at:new Date().toISOString()};r.city&&(a.city=r.city),r.state&&(a.state=r.state),r.zip&&(a.zip=r.zip),r.county&&(a.county=r.county);const{error:o}=await n.from("property").update(a).eq("id",t);return o?(console.error(" Database error updating property:",o),!1):(console.log(` Updated property ${t} coordinates`),!0)}catch(a){return console.error(" Error updating property coordinates:",a),!1}}async reverseGeocode(t,r){try{const n=await fetch("https://nominatim.openstreetmap.org/reverse?"+new URLSearchParams({lat:t.toString(),lon:r.toString(),format:"json",addressdetails:"1"}),{headers:{"User-Agent":this.USER_AGENT}});if(!n.ok)throw new Error(`Reverse geocoding API responded with status: ${n.status}`);const s=await n.json();if(!s)return{error:"Location not found",code:"NOT_FOUND"};const a=s.address||{};return{latitude:t,longitude:r,formatted_address:s.display_name,city:a.city||a.town||a.village||a.hamlet,state:a.state,zip:a.postcode,county:a.county}}catch(n){return console.error("Reverse geocoding error:",n),{error:n instanceof Error?n.message:"Reverse geocoding failed",code:"REVERSE_GEOCODING_ERROR"}}}buildAddressString(t,r,n,s){const a=[t];return r&&a.push(r),n&&a.push(n),s&&a.push(s),a.join(", ")}isValidCoordinates(t,r){return t>=-90&&t<=90&&r>=-180&&r<=180}async getCurrentLocation(){return new Promise(t=>{if(!navigator.geolocation){t({error:"Geolocation is not supported by this browser",code:"NOT_SUPPORTED"});return}navigator.geolocation.getCurrentPosition(r=>{t({lat:r.coords.latitude,lng:r.coords.longitude})},r=>{let n="Failed to get current location",s="LOCATION_ERROR";switch(r.code){case r.PERMISSION_DENIED:n="Location access denied by user",s="PERMISSION_DENIED";break;case r.POSITION_UNAVAILABLE:n="Location information unavailable",s="POSITION_UNAVAILABLE";break;case r.TIMEOUT:n="Location request timed out",s="TIMEOUT";break}t({error:n,code:s})},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5})})}}const an=new Nz;function Sz(){const[e,t]=x.useState(!1),[r,n]=x.useState(null),s=x.useCallback(()=>{n(null)},[]),a=x.useCallback(async l=>{t(!0),n(null);try{const c=an.buildAddressString(l.address||"",l.city,l.state,l.zip);if(!c.trim())throw new Error("No address provided for geocoding");console.log(" Geocoding address:",c);const u=await an.geocodeAddress(c);if("error"in u)return n(u.error),console.error("Geocoding failed:",u.error),l;const d=u,f={...l,latitude:d.latitude,longitude:d.longitude};return!l.city&&d.city&&(f.city=d.city),!l.state&&d.state&&(f.state=d.state),!l.zip&&d.zip&&(f.zip=d.zip),!l.county&&d.county&&(f.county=d.county),console.log(" Geocoding successful:",{address:c,coordinates:[d.latitude,d.longitude]}),f}catch(c){const u=c instanceof Error?c.message:"Geocoding failed";return n(u),console.error("Geocoding error:",c),l}finally{t(!1)}},[]),o=x.useCallback(async()=>{n(null);try{const l=await an.getCurrentLocation();return"error"in l?(n(l.error),null):l}catch(l){const c=l instanceof Error?l.message:"Failed to get current location";return n(c),null}},[]);return{isGeocoding:e,geocodeError:r,geocodeProperty:a,getCurrentLocation:o,clearError:s}}function Cz(){const[e,t]=x.useState([]),[r,n]=x.useState(!0),[s,a]=x.useState(null);return x.useEffect(()=>{(async()=>{try{n(!0),a(null);const{data:l,error:c}=await $.from("property_record_type").select("*").eq("active",!0).order("sort_order");if(c)throw c;t(l||[])}catch(l){const c=l instanceof Error?l.message:"Failed to fetch property record types";a(c),console.error("Error fetching property record types:",l)}finally{n(!1)}})()},[]),{propertyRecordTypes:e,isLoading:r,error:s}}const Ez=()=>{const e=Jt(),[t,r]=x.useState(!1),{isGeocoding:n,geocodeError:s,geocodeProperty:a,getCurrentLocation:o,clearError:l}=Sz(),{propertyRecordTypes:c,isLoading:u,error:d}=Cz(),{createProperty:f}=Kk(),[m,h]=x.useState({property_record_type_id:null,property_name:"",address:"",city:"",state:"",zip:"",trade_area:"",asking_lease_price:null,asking_purchase_price:null,rent_psf:null,nnn_psf:null,property_notes:"",acres:null,units:[]}),y=(U,J)=>{h(X=>({...X,[U]:J}))},v=()=>{const U={id:`temp_${Date.now()}`,property_unit_name:null,sqft:null,rent:null,nnn:null,patio:!1,inline:!1,end_cap:!1,end_cap_drive_thru:!1,second_gen_restaurant:!1,created_at:null,created_by_id:null,created_by_sf_id:null,deal_id:null,lease_expiration_date:null,property_id:null,sf_id:crypto.randomUUID(),site_submit_id:null,unit_notes:null,updated_at:null,updated_by_id:null,updated_by_sf_id:null};h(J=>({...J,units:[...J.units,U]}))},w=(U,J,X)=>{h(ue=>({...ue,units:ue.units.map(pe=>pe.id===U?{...pe,[J]:X}:pe)}))},g=U=>{h(J=>({...J,units:J.units.filter(X=>X.id!==U)}))},b=x.useMemo(()=>{var tt;const U=c.find(ye=>ye.id===m.property_record_type_id),J=((tt=U==null?void 0:U.label)==null?void 0:tt.toLowerCase())||"",X=J.includes("land"),ue=J.includes("shopping")||J.includes("retail");return{isLandType:X,isShoppingCenterType:ue,showLeaseFields:!X&&!ue,showPSFFields:!X,showPurchaseFields:X,selectedRecordType:U,recordTypeLabel:J}},[m.property_record_type_id,c]),{isLandType:p,isShoppingCenterType:_,showLeaseFields:j,showPSFFields:k,showPurchaseFields:N,selectedRecordType:S,recordTypeLabel:C}=b;x.useEffect(()=>{if(!m.property_record_type_id)return;const U={};p&&!k&&(m.rent_psf||m.nnn_psf)&&(U.rent_psf=null,U.nnn_psf=null),_&&m.asking_purchase_price&&(U.asking_purchase_price=null),j&&m.asking_purchase_price&&(U.asking_purchase_price=null),Object.keys(U).length>0&&h(J=>({...J,...U}))},[p,_,j,k,m.property_record_type_id]);const E=async U=>{if(U.preventDefault(),l(),!m.property_record_type_id){alert("Please select a property record type");return}if(!m.property_name.trim()||!m.address.trim()||!m.city.trim()||!m.state.trim()){alert("Please fill in all required fields (Property Record Type, Property Name, Address, City, State)");return}r(!0);try{console.log("Creating new property:",m);const J={property_record_type_id:m.property_record_type_id,property_name:m.property_name,address:m.address,city:m.city,state:m.state,zip:m.zip,trade_area:m.trade_area,asking_lease_price:m.asking_lease_price,asking_purchase_price:m.asking_purchase_price,rent_psf:m.rent_psf,nnn_psf:m.nnn_psf,property_notes:m.property_notes,acres:m.acres},X=await f(J);if(console.log(" Property created successfully:",X),_&&m.units.length>0){console.log("Creating property units:",m.units);const ue=m.units.filter(pe=>pe.property_unit_name&&pe.property_unit_name.trim()).map(pe=>{var De;return{property_id:X.id,property_unit_name:((De=pe.property_unit_name)==null?void 0:De.trim())||null,sqft:pe.sqft,rent:pe.rent,nnn:pe.nnn,patio:pe.patio,inline:pe.inline,end_cap:pe.end_cap,end_cap_drive_thru:pe.end_cap_drive_thru,second_gen_restaurant:pe.second_gen_restaurant,sf_id:crypto.randomUUID(),lease_expiration_date:pe.lease_expiration_date,unit_notes:pe.unit_notes,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),created_by_id:null,created_by_sf_id:null,deal_id:null,site_submit_id:null,updated_by_id:null,updated_by_sf_id:null}});if(ue.length>0){const{data:pe,error:De}=await $.from("property_unit").insert(ue).select();De?console.error("Error creating property units:",De):console.log(" Property units created successfully:",pe)}}a(X).then(ue=>{ue.latitude&&ue.longitude?console.log(" Property geocoded successfully:",{coordinates:[ue.latitude,ue.longitude]}):s&&console.warn(" Property created but geocoding failed:",s)}).catch(ue=>{console.warn(" Property created but geocoding failed:",ue)}),e(`/property/${X.id}`)}catch(J){console.error("Error creating property:",J),alert("Failed to create property. Please try again.")}finally{r(!1)}},T=()=>{e(-1)},[L,O]=x.useState(!1),[A,M]=x.useState(!1),[B,F]=x.useState({}),[R,P]=x.useState(!1),[D,z]=x.useState(!1),W=()=>{O(!0),setTimeout(()=>O(!1),4e3)},I=()=>{M(!0),setTimeout(()=>M(!1),4e3)},ne=U=>{F(J=>({...J,[U]:!0})),setTimeout(()=>{F(J=>({...J,[U]:!1}))},4e3)},re=()=>{P(!0),setTimeout(()=>{P(!1)},4e3)},Q=()=>{z(!0),setTimeout(()=>{z(!1)},4e3)};return i.jsx("div",{className:"min-h-screen bg-gray-50 py-6",children:i.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6",children:[i.jsx("div",{className:"mb-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Add New Property"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Enter essential property information to get started"})]}),i.jsxs("button",{onClick:T,className:"flex items-center gap-2 px-3 py-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-md transition-colors",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Cancel"]})]})}),d&&i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Unable to load property types"}),i.jsx("div",{className:"mt-2 text-sm text-red-700",children:i.jsx("p",{children:d})})]})]})}),s&&i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-4",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.728-.833-2.498 0L4.316 15.5C3.546 16.333 4.508 18 6.048 18z"})})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Geocoding Notice"}),i.jsxs("div",{className:"mt-2 text-sm text-yellow-700",children:[i.jsx("p",{children:s}),i.jsx("p",{className:"mt-1",children:"Don't worry - your property will still be created. You can manually enter coordinates later if needed."})]}),i.jsx("div",{className:"mt-3",children:i.jsx("button",{type:"button",onClick:l,className:"text-sm text-yellow-600 hover:text-yellow-500 underline",children:"Dismiss"})})]})]})}),i.jsxs("form",{onSubmit:E,className:"space-y-6",children:[i.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Property Type"}),i.jsx("span",{className:"text-red-500 text-sm",children:"*Required"})]}),i.jsx("div",{className:"max-w-md",children:i.jsx(Qk,{label:"Property Record Type*",value:m.property_record_type_id,onChange:U=>y("property_record_type_id",U),options:c.map(U=>({id:U.id,label:U.label})),placeholder:u?"Loading...":c.length===0?"No record types available":"Select property type...",disabled:u||c.length===0,tabIndex:1,required:!0,defaultText:"Select Property Type"})})]}),i.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Property Details"})]}),i.jsxs("div",{className:"relative",children:[i.jsx("button",{type:"button",onClick:I,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-gray-500",title:"Pin current location",children:i.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})}),A&&i.jsx("div",{className:"absolute top-full right-0 mt-2 w-72 z-10",children:i.jsxs("div",{className:"bg-gray-900 text-white text-xs rounded-lg p-3 shadow-lg relative",children:[i.jsx("div",{className:"absolute bottom-full right-4 w-0 h-0 border-l-4 border-r-4 border-b-4 border-l-transparent border-r-transparent border-b-gray-900"}),i.jsx("div",{className:"font-medium text-yellow-200 mb-1",children:" Future Feature"}),i.jsx("p",{children:"This will drop your current location geocode to create an address and geocode from where your computer or phone are located."}),i.jsx("button",{onClick:()=>M(!1),className:"absolute top-1 right-1 text-gray-400 hover:text-white w-4 h-4 flex items-center justify-center",children:""})]})})]})]}),i.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[i.jsx($e,{label:"Property Name*",value:m.property_name,onChange:U=>y("property_name",U),placeholder:"Downtown Office Building",tabIndex:2,required:!0,defaultText:"Enter Property Name"}),i.jsx($e,{label:"Street Address*",value:m.address,onChange:U=>y("address",U),placeholder:"123 Main Street",tabIndex:3}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[i.jsx(ta,{label:"City*",value:m.city,onChange:U=>y("city",U),field:"city",placeholder:"San Francisco",tabIndex:4}),i.jsx(ta,{label:"State*",value:m.state,onChange:U=>y("state",U),field:"state",placeholder:"CA",tabIndex:5}),i.jsx($e,{label:"ZIP Code",value:m.zip,onChange:U=>y("zip",U),placeholder:"94105",tabIndex:6})]}),i.jsxs("div",{className:"flex items-end gap-4 mt-4",children:[i.jsx("div",{className:"flex-1",children:i.jsx(ta,{label:"Trade Area",value:m.trade_area,onChange:U=>y("trade_area",U),field:"trade_area",placeholder:"Downtown, Suburb, etc.",tabIndex:7})}),i.jsxs("div",{className:"relative pb-1",children:[i.jsxs("button",{type:"button",onClick:W,className:"flex items-center gap-2 px-3 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 text-sm rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-gray-500",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),"Verify Location"]}),L&&i.jsx("div",{className:"absolute bottom-full right-0 mb-2 w-64 z-10",children:i.jsxs("div",{className:"bg-gray-900 text-white text-xs rounded-lg p-3 shadow-lg relative",children:[i.jsx("div",{className:"absolute top-full right-4 w-0 h-0 border-l-4 border-r-4 border-t-4 border-l-transparent border-r-transparent border-t-gray-900"}),i.jsx("div",{className:"font-medium text-yellow-200 mb-1",children:" Future Feature"}),i.jsx("p",{children:"This will take you to a map where you can move the pin to the correct location and recode the address coordinates."}),i.jsx("button",{onClick:()=>O(!1),className:"absolute top-1 right-1 text-gray-400 hover:text-white w-4 h-4 flex items-center justify-center",children:""})]})})]})]})]})]}),m.property_record_type_id&&i.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})}),i.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Financial Information",p&&" (Land)",_&&" (Retail/Shopping)",!p&&!_&&" (Building)"]}),i.jsx("span",{className:"text-sm text-gray-500 ml-2",children:"(Optional - can be added later)"})]}),p&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i.jsx(ts,{label:"Asking Purchase Price",value:m.asking_purchase_price,onChange:U=>y("asking_purchase_price",U),helpText:"Land purchase price",colorScheme:"blue",showLarge:!0,tabIndex:8}),i.jsx(ts,{label:"Asking Ground Lease Price",value:m.asking_lease_price,onChange:U=>y("asking_lease_price",U),helpText:"Annual ground lease amount",colorScheme:"green",showLarge:!0,tabIndex:9}),i.jsx($e,{label:"Acres",value:m.acres,onChange:U=>y("acres",U),type:"number",placeholder:"5.25",inputMode:"decimal",tabIndex:10})]}),i.jsxs("div",{className:"flex justify-end relative",children:[i.jsxs("button",{type:"button",onClick:Q,className:"flex items-center gap-2 px-4 py-2 bg-green-50 text-green-700 rounded-md hover:bg-green-100 transition-colors text-sm font-medium focus:outline-none focus:ring-2 focus:ring-green-500",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Create Submit"]}),D&&i.jsx("div",{className:"absolute bottom-full right-0 mb-2 w-64 z-10",children:i.jsxs("div",{className:"bg-gray-900 text-white text-xs rounded-lg p-3 shadow-lg relative",children:[i.jsx("div",{className:"absolute top-full right-4 w-0 h-0 border-l-4 border-r-4 border-t-4 border-l-transparent border-r-transparent border-t-gray-900"}),i.jsx("div",{className:"font-medium text-green-200 mb-1",children:" Future Feature"}),i.jsx("p",{children:"This will create a site submit for this land property to track development prospects and opportunities."}),i.jsx("button",{onClick:()=>z(!1),className:"absolute top-1 right-1 text-gray-400 hover:text-white w-4 h-4 flex items-center justify-center",children:""})]})})]})]}),j&&i.jsx("div",{className:"space-y-4",children:i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:i.jsx(ts,{label:"Asking Lease Price",value:m.asking_lease_price,onChange:U=>y("asking_lease_price",U),helpText:"Annual lease amount",colorScheme:"green",showLarge:!0,tabIndex:8})})}),k&&i.jsxs("div",{className:"border-t border-gray-200 pt-4 mt-4",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Per Square Foot Rates"}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i.jsx(Yu,{label:"Rent PSF",value:m.rent_psf,onChange:U=>y("rent_psf",U),helpText:"Base rent per square foot",tabIndex:9}),i.jsx(Yu,{label:"NNN PSF",value:m.nnn_psf,onChange:U=>y("nnn_psf",U),helpText:"Triple net charges per square foot",tabIndex:10})]})]}),i.jsx("div",{className:"mt-4 p-3 bg-gray-50 rounded-md",children:i.jsx("p",{className:"text-sm text-gray-600",children:" Additional financial fields like square footage, occupancy rates, and detailed lease terms can be added in the detailed property view after creation."})})]}),!m.property_record_type_id&&i.jsxs("section",{className:"bg-gray-50 rounded-lg border border-gray-200 p-6",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})}),i.jsx("h3",{className:"text-lg font-medium text-gray-500",children:"Financial Information"})]}),i.jsx("p",{className:"text-sm text-gray-500",children:"Select a property record type above to see relevant financial fields."})]}),_&&i.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Shopping Center Units"})]}),i.jsxs("button",{type:"button",onClick:v,className:"flex items-center gap-2 px-3 py-2 bg-blue-50 text-blue-700 rounded-md hover:bg-blue-100 transition-colors text-sm",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Unit"]})]}),m.units.length===0?i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx("div",{className:"mb-2",children:i.jsx("svg",{className:"w-12 h-12 text-gray-300 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),i.jsx("p",{className:"text-sm",children:"No units added yet."}),i.jsx("p",{className:"text-xs mt-1 text-gray-400",children:'Use the "Add Unit" button to start adding units to this shopping center.'}),i.jsxs("div",{className:"mt-4 relative inline-block",children:[i.jsxs("button",{type:"button",onClick:re,className:"flex items-center gap-2 px-4 py-2 bg-green-50 text-green-700 rounded-md hover:bg-green-100 transition-colors text-sm font-medium focus:outline-none focus:ring-2 focus:ring-green-500",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Create Submit"]}),R&&i.jsx("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-64 z-10",children:i.jsxs("div",{className:"bg-gray-900 text-white text-xs rounded-lg p-3 shadow-lg relative",children:[i.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-l-transparent border-r-transparent border-t-gray-900"}),i.jsx("div",{className:"font-medium text-green-200 mb-1",children:" Future Feature"}),i.jsx("p",{children:"This will create a site submit on the property level for tracking prospects when no specific units are defined."}),i.jsx("button",{onClick:()=>P(!1),className:"absolute top-1 right-1 text-gray-400 hover:text-white w-4 h-4 flex items-center justify-center",children:""})]})})]})]}):i.jsx("div",{className:"space-y-4",children:m.units.map((U,J)=>i.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsx("div",{className:"flex items-center gap-2",children:i.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Unit ",J+1]})}),i.jsx("button",{type:"button",onClick:()=>g(U.id),className:"text-red-500 hover:text-red-700 text-lg font-bold",title:"Delete unit",children:""})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsx("div",{className:"md:col-span-2",children:i.jsx($e,{label:"Unit Name",value:U.property_unit_name,onChange:X=>w(U.id,"property_unit_name",X),placeholder:"e.g., Suite A, Space 101, etc.",tabIndex:11})}),i.jsx("div",{children:i.jsx($e,{label:"Unit Notes",value:U.unit_notes,onChange:X=>w(U.id,"unit_notes",X),placeholder:"Optional notes",multiline:!0,rows:1,tabIndex:15})}),i.jsx("div",{children:i.jsx($e,{label:"Square Feet",value:U.sqft,onChange:X=>w(U.id,"sqft",X),type:"number",placeholder:"1,200",inputMode:"numeric",tabIndex:12})}),i.jsx("div",{children:i.jsx(ts,{label:"Rent",value:U.rent,onChange:X=>w(U.id,"rent",X),helpText:"Unit rent amount",tabIndex:13})}),i.jsx("div",{children:i.jsx(ts,{label:"NNN",value:U.nnn,onChange:X=>w(U.id,"nnn",X),helpText:"Net Net Net charges",tabIndex:14})}),i.jsx("div",{className:"md:col-span-3",children:i.jsx($e,{label:"Lease Expiration Date",value:U.lease_expiration_date?new Date(U.lease_expiration_date).toISOString().split("T")[0]:null,onChange:X=>w(U.id,"lease_expiration_date",X?new Date(X).toISOString():null),type:"date",placeholder:"YYYY-MM-DD",tabIndex:16})})]}),i.jsxs("div",{className:"mt-4 pt-3 border-t border-gray-200",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Unit Features"}),i.jsxs("div",{className:"relative",children:[i.jsxs("button",{type:"button",onClick:()=>ne(U.id),className:"flex items-center gap-2 px-3 py-1.5 bg-green-50 text-green-700 rounded-md hover:bg-green-100 transition-colors text-xs font-medium focus:outline-none focus:ring-2 focus:ring-green-500",children:[i.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Create Submit"]}),B[U.id]&&i.jsx("div",{className:"absolute bottom-full right-0 mb-2 w-64 z-10",children:i.jsxs("div",{className:"bg-gray-900 text-white text-xs rounded-lg p-3 shadow-lg relative",children:[i.jsx("div",{className:"absolute top-full right-4 w-0 h-0 border-l-4 border-r-4 border-t-4 border-l-transparent border-r-transparent border-t-gray-900"}),i.jsx("div",{className:"font-medium text-green-200 mb-1",children:" Future Feature"}),i.jsx("p",{children:"This will create a site submit on the unit for tracking tenant prospects and submissions."}),i.jsx("button",{onClick:()=>F(X=>({...X,[U.id]:!1})),className:"absolute top-1 right-1 text-gray-400 hover:text-white w-4 h-4 flex items-center justify-center",children:""})]})})]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:U.patio,onChange:X=>w(U.id,"patio",X.target.checked),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Patio"})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:U.inline,onChange:X=>w(U.id,"inline",X.target.checked),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Inline"})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:U.end_cap,onChange:X=>w(U.id,"end_cap",X.target.checked),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"End Cap"})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:U.end_cap_drive_thru,onChange:X=>w(U.id,"end_cap_drive_thru",X.target.checked),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"End Cap Drive-Thru"})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:U.second_gen_restaurant,onChange:X=>w(U.id,"second_gen_restaurant",X.target.checked),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"2nd Gen Restaurant"})]})]})]})]},U.id))}),i.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-md",children:i.jsx("p",{className:"text-sm text-blue-700",children:" Units can be added now or later in the detailed property view. Adding units helps track individual tenant spaces and their lease details."})})]}),i.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Initial Notes"})]}),i.jsx("textarea",{value:m.property_notes,onChange:U=>y("property_notes",U.target.value),placeholder:"Add any initial notes about this property, market conditions, or other relevant information...",className:"w-full px-3 py-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base resize-none min-h-[100px]",tabIndex:10}),i.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"You can add more detailed notes and use quick templates after the property is created."})]}),i.jsxs("div",{className:"flex items-center justify-between pt-6 border-t border-gray-200",children:[i.jsxs("div",{className:"text-sm text-gray-500",children:[i.jsx("span",{className:"text-red-500",children:"*"})," Required fields: Property Record Type, Property Name, Address, City, State"]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("button",{type:"button",onClick:T,className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:"Cancel"}),i.jsxs("button",{type:"submit",disabled:t||n,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[(t||n)&&i.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),n?"Adding Location...":t?"Creating Property...":"Create Property"]})]})]})]}),i.jsx("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-md",children:i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsxs("svg",{className:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-medium text-blue-800",children:"Automatic Location Detection"}),i.jsx("div",{className:"text-xs text-blue-700 mt-1",children:"The system automatically converts your address into GPS coordinates for mapping and location features. This happens in the background and won't delay property creation."}),n&&i.jsxs("div",{className:"mt-2 flex items-center gap-2 text-blue-600",children:[i.jsx("div",{className:"w-3 h-3 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),i.jsx("span",{className:"text-xs",children:"Detecting location..."})]})]})]})})]})})},x0=()=>{const[e,t]=x.useState(!1),[r,n]=x.useState(null),s=x.useCallback(async(o,l={})=>{const{limit:c=10,types:u=["deal","client","contact","property","site_submit","assignment"],includeInactive:d=!1}=l;if(!o.trim())return[];console.log(` Starting search for: "${o}" with options:`,l),t(!0),n(null);const f=[],m=o.trim().toLowerCase();try{if(u.includes("deal")){console.log(" Searching deals...");const{data:v,error:w}=await $.from("deal").select(`
            *,
            client!client_id (client_name),
            deal_stage (label, sort_order),
            property (property_name, address, city, state)
          `).or(`deal_name.ilike.%${m}%,sf_broker.ilike.%${m}%,sf_address.ilike.%${m}%`).limit(Math.ceil(c/u.length));if(w)throw w;v&&(console.log(` Found ${v.length} deals:`,v),v.forEach(g=>{var S,C,E,T,L,O,A,M;const b=g.deal_name||"Unnamed Deal",p=b.toLowerCase().includes(m),_=(S=g.sf_broker)==null?void 0:S.toLowerCase().includes(m),j=(C=g.sf_address)==null?void 0:C.toLowerCase().includes(m);let k=0;b.toLowerCase().startsWith(m)?k+=10:p&&(k+=5),_&&(k+=3),j&&(k+=2);const N=[(E=g.property)==null?void 0:E.address,(T=g.property)==null?void 0:T.city,(L=g.property)==null?void 0:L.state].filter(Boolean).join(", ");f.push({id:g.id,type:"deal",title:b,subtitle:((O=g.client)==null?void 0:O.client_name)||"No Client",description:((A=g.property)==null?void 0:A.property_name)||N,metadata:((M=g.deal_stage)==null?void 0:M.label)||"No Stage",url:`/deal/${g.id}`,score:k})}))}if(u.includes("client")){const{data:v,error:w}=await $.from("client").select("*").or(`client_name.ilike.%${m}%,description.ilike.%${m}%,sf_client_type.ilike.%${m}%`).limit(Math.ceil(c/u.length));if(w)throw w;v&&v.forEach(g=>{var j,k;const b=g.client_name,p=b.toLowerCase().includes(m);let _=0;b.toLowerCase().startsWith(m)?_+=10:p&&(_+=5),(j=g.description)!=null&&j.toLowerCase().includes(m)&&(_+=4),(k=g.sf_client_type)!=null&&k.toLowerCase().includes(m)&&(_+=3),f.push({id:g.id,type:"client",title:b,subtitle:"Client",description:g.sf_client_type||g.description||"",metadata:g.website||"",url:`/client/${g.id}`,score:_})})}if(u.includes("contact")){const{data:v,error:w}=await $.from("contact").select(`
            *,
            client!client_id (client_name)
          `).or(`first_name.ilike.%${m}%,last_name.ilike.%${m}%,company.ilike.%${m}%,email.ilike.%${m}%,title.ilike.%${m}%`).limit(Math.ceil(c/u.length));if(w)throw w;v&&v.forEach(g=>{var S,C,E,T;const b=g.first_name||"",p=g.last_name||"",_=`${b} ${p}`.trim(),j=_||"Unnamed Contact";let k=0;b.toLowerCase().startsWith(m)||p.toLowerCase().startsWith(m)?k+=10:_.toLowerCase().includes(m)&&(k+=7),(S=g.company)!=null&&S.toLowerCase().includes(m)&&(k+=5),(C=g.email)!=null&&C.toLowerCase().includes(m)&&(k+=4),(E=g.title)!=null&&E.toLowerCase().includes(m)&&(k+=3);const N=[g.email,g.phone,g.mobile_phone].filter(Boolean)[0]||"";f.push({id:g.id,type:"contact",title:j,subtitle:g.company||g.title||"Contact",description:N,metadata:((T=g.client)==null?void 0:T.client_name)||g.source_type||"",url:`/contact/${g.id}`,score:k})})}if(u.includes("property")){const{data:v,error:w}=await $.from("property").select(`
            *,
            property_type (label),
            property_stage (label)
          `).or(`property_name.ilike.%${m}%,address.ilike.%${m}%,city.ilike.%${m}%,state.ilike.%${m}%,trade_area.ilike.%${m}%`).limit(Math.ceil(c/u.length));if(w)throw w;v&&v.forEach(g=>{var k,N,S,C,E,T;const b=g.property_name||"Unnamed Property",p=b.toLowerCase().includes(m);let _=0;b.toLowerCase().startsWith(m)?_+=10:p&&(_+=7),(k=g.address)!=null&&k.toLowerCase().includes(m)&&(_+=6),(N=g.city)!=null&&N.toLowerCase().includes(m)&&(_+=5),(S=g.state)!=null&&S.toLowerCase().includes(m)&&(_+=4),(C=g.trade_area)!=null&&C.toLowerCase().includes(m)&&(_+=3);const j=[g.address,g.city,g.state].filter(Boolean).join(", ");f.push({id:g.id,type:"property",title:b,subtitle:j||"Property",description:((E=g.property_type)==null?void 0:E.label)||g.trade_area||"",metadata:((T=g.property_stage)==null?void 0:T.label)||"",url:`/property/${g.id}`,score:_})})}if(u.includes("site_submit")){console.log(" Searching site submits...");const{data:v,error:w}=await $.from("site_submit").select(`
            *,
            client!client_id (client_name),
            property (property_name, address, city, state),
            property_unit (property_unit_name)
          `).or(`site_submit_name.ilike.%${m}%,sf_account.ilike.%${m}%,notes.ilike.%${m}%`).limit(Math.ceil(c/u.length));if(w)throw w;v&&(console.log(` Found ${v.length} site submits:`,v),v.forEach(g=>{var k,N,S,C,E,T,L;const b=g.site_submit_name||"Unnamed Site Submit",p=b.toLowerCase().includes(m);let _=0;b.toLowerCase().startsWith(m)?_+=10:p&&(_+=7),(k=g.sf_account)!=null&&k.toLowerCase().includes(m)&&(_+=5),(N=g.notes)!=null&&N.toLowerCase().includes(m)&&(_+=3);const j=((S=g.property)==null?void 0:S.property_name)||[(C=g.property)==null?void 0:C.address,(E=g.property)==null?void 0:E.city,(T=g.property)==null?void 0:T.state].filter(Boolean).join(", ");f.push({id:g.id,type:"site_submit",title:b,subtitle:((L=g.client)==null?void 0:L.client_name)||"No Client",description:j,metadata:"Site Submit",url:`/site-submit/${g.id}`,score:_})}))}if(u.includes("assignment")){console.log(" Searching assignments...");const{data:v,error:w}=await $.from("assignment").select("*").or(`assignment_name.ilike.%${m}%,site_criteria.ilike.%${m}%`).limit(Math.ceil(c/u.length));if(w)throw w;v&&v.forEach(g=>{var j;const b=g.assignment_name||"Unnamed Assignment",p=b.toLowerCase().includes(m);let _=0;b.toLowerCase().startsWith(m)?_+=10:p&&(_+=7),(j=g.site_criteria)!=null&&j.toLowerCase().includes(m)&&(_+=5),f.push({id:g.id,type:"assignment",title:b,subtitle:"Assignment",description:g.progress||"",metadata:"",url:`/assignment/${g.id}`,score:_})})}const h={deal:1,property:2,client:3,contact:4,site_submit:5,assignment:6};f.sort((v,w)=>{const g=(w.score||0)-(v.score||0);if(g!==0)return g;const b=h[v.type]-h[w.type];return b!==0?b:v.title.localeCompare(w.title)});const y=f.slice(0,c);return console.log(` Search completed. Found ${f.length} total results, returning ${y.length}`),console.log("Final results:",y),y}catch(h){return console.error(" Search error:",h),n(h instanceof Error?h.message:"Search failed"),[]}finally{t(!1)}},[]),a=x.useCallback(async(o,l,c=10)=>s(o,{types:[l],limit:c}),[s]);return{search:s,searchByType:a,loading:e,error:r}},Dz=({isOpen:e,onClose:t,initialQuery:r=""})=>{const[n,s]=x.useState(r),[a,o]=x.useState(["deal","client","contact","property","site_submit"]),[l,c]=x.useState([]),[u,d]=x.useState(1),[f]=x.useState(20),{search:m,loading:h,error:y}=x0(),v=Jt();x.useEffect(()=>{s(r)},[r]),x.useEffect(()=>{e&&n.trim()&&w()},[e,n,a]);const w=async()=>{if(!n.trim()){c([]);return}const C=await m(n,{types:a,limit:100});c(C),d(1)},g=C=>{o(E=>E.includes(C)?E.filter(T=>T!==C):[...E,C])},b=C=>{C.url&&(v(C.url),t())},p=C=>{switch(C){case"deal":return i.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})});case"client":return i.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})});case"contact":return i.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})});case"property":return i.jsx("svg",{className:"w-4 h-4 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})});case"site_submit":return i.jsx("svg",{className:"w-4 h-4 text-teal-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});default:return null}},_=C=>{switch(C){case"deal":return"Deals";case"client":return"Clients";case"contact":return"Contacts";case"property":return"Properties";case"site_submit":return"Site Submits";default:return""}},j=Math.ceil(l.length/f),k=(u-1)*f,N=k+f,S=l.slice(k,N);return e?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50",onClick:t}),i.jsxs("div",{className:"fixed inset-4 lg:inset-20 bg-white rounded-lg shadow-xl z-50 flex flex-col",children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[i.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Advanced Search"}),i.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:i.jsx("svg",{className:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsxs("div",{className:"p-6 border-b border-gray-200",children:[i.jsx("div",{className:"mb-4",children:i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m21 21-6-6m2-5a7 7 0 1 1-14 0 7 7 0 0 1 14 0Z"})})}),i.jsx("input",{type:"text",value:n,onChange:C=>s(C.target.value),onKeyDown:C=>{C.key==="Enter"&&w()},className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-lg",placeholder:"Search across all your data...",autoFocus:!0})]})}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx("span",{className:"text-sm font-medium text-gray-700 mr-2",children:"Search in:"}),["deal","client","contact","property","site_submit"].map(C=>i.jsxs("button",{onClick:()=>g(C),className:`inline-flex items-center px-3 py-1.5 rounded-full text-sm font-medium transition-colors ${a.includes(C)?"bg-blue-100 text-blue-800 border border-blue-200":"bg-gray-100 text-gray-700 border border-gray-200 hover:bg-gray-200"}`,children:[i.jsx("span",{className:"mr-1.5",children:p(C)}),_(C)]},C))]})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[h&&i.jsxs("div",{className:"flex items-center justify-center h-32",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),i.jsx("span",{className:"ml-3 text-gray-600",children:"Searching..."})]}),y&&i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:i.jsxs("div",{className:"text-red-700",children:[i.jsx("strong",{children:"Search Error:"})," ",y]})}),!h&&!y&&l.length===0&&n.trim()&&i.jsxs("div",{className:"text-center py-12",children:[i.jsx("svg",{className:"w-12 h-12 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No results found"}),i.jsx("p",{className:"text-gray-500",children:"Try adjusting your search terms or selected categories."})]}),!h&&!y&&S.length>0&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"mb-4 text-sm text-gray-600",children:["Showing ",k+1,"-",Math.min(N,l.length)," of ",l.length," results"]}),i.jsx("div",{className:"space-y-3",children:S.map(C=>i.jsx("div",{onClick:()=>b(C),className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors",children:i.jsxs("div",{className:"flex items-start space-x-3",children:[i.jsx("div",{className:"flex-shrink-0 mt-1",children:p(C.type)}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center justify-between mb-1",children:[i.jsx("h4",{className:"text-lg font-medium text-gray-900 truncate",children:C.title}),i.jsx("span",{className:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:_(C.type).slice(0,-1)})]}),C.subtitle&&i.jsx("p",{className:"text-sm text-gray-600 mb-1",children:C.subtitle}),i.jsxs("div",{className:"flex items-center justify-between",children:[C.description&&i.jsx("p",{className:"text-sm text-gray-500 truncate",children:C.description}),C.metadata&&i.jsx("span",{className:"ml-2 text-sm text-gray-400 truncate",children:C.metadata})]})]})]})},`${C.type}-${C.id}`))}),j>1&&i.jsxs("div",{className:"mt-6 flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-gray-500",children:["Page ",u," of ",j]}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{onClick:()=>d(C=>Math.max(1,C-1)),disabled:u===1,className:"px-3 py-1.5 text-sm border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),i.jsx("button",{onClick:()=>d(C=>Math.min(j,C+1)),disabled:u===j,className:"px-3 py-1.5 text-sm border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]})]})]}):null},RN=({placeholder:e="Search deals, clients, contacts, properties, site submits, assignments...",className:t="",onSelect:r})=>{const[n,s]=x.useState(""),[a,o]=x.useState([]),[l,c]=x.useState(!1),[u,d]=x.useState(-1),[f,m]=x.useState(!1),{search:h,loading:y}=x0(),v=x.useRef(null),w=x.useRef(null),g=Jt();x.useEffect(()=>{(async()=>{try{console.log(" Testing database connectivity...");const{data:S,error:C}=await $.from("deal").select("id, deal_name").limit(1);C?console.error(" Database connection error:",C):console.log(" Database connected successfully, sample data:",S)}catch(S){console.error(" Database test failed:",S)}})()},[]),x.useEffect(()=>{if(console.log(` MasterSearchBox query changed: "${n}"`),!n.trim()){console.log(" Empty query, clearing results"),o([]),c(!1);return}console.log(` Setting up debounced search for: "${n}"`);const N=setTimeout(async()=>{console.log(` Executing search for: "${n}"`);try{const S=await h(n,{limit:10});console.log(` MasterSearchBox received ${S.length} results:`,S),o(S),c(S.length>0)}catch(S){console.error(" Search failed in MasterSearchBox:",S)}},300);return()=>{console.log(` Clearing timeout for: "${n}"`),clearTimeout(N)}},[n,h]),x.useEffect(()=>{const N=S=>{v.current&&!v.current.contains(S.target)&&(c(!1),d(-1))};return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[]);const b=N=>{s(N.target.value),d(-1)},p=N=>{var S;if(!(!l||a.length===0))switch(N.key){case"ArrowDown":N.preventDefault(),d(C=>C<a.length-1?C+1:C);break;case"ArrowUp":N.preventDefault(),d(C=>C>0?C-1:-1);break;case"Enter":N.preventDefault(),N.ctrlKey||N.metaKey?(m(!0),c(!1)):u>=0?_(a[u]):a.length>0&&_(a[0]);break;case"Escape":c(!1),d(-1),(S=w.current)==null||S.blur();break}},_=N=>{s(N.title),c(!1),d(-1),r?r(N):N.url&&g(N.url)},j=N=>{switch(N){case"deal":return i.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})});case"client":return i.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})});case"contact":return i.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})});case"property":return i.jsx("svg",{className:"w-4 h-4 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})});case"site_submit":return i.jsx("svg",{className:"w-4 h-4 text-teal-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});default:return i.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}},k=N=>{switch(N){case"deal":return"Deal";case"client":return"Client";case"contact":return"Contact";case"property":return"Property";case"site_submit":return"Site Submit";default:return""}};return i.jsxs("div",{ref:v,className:`relative ${t}`,children:[i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m21 21-6-6m2-5a7 7 0 1 1-14 0 7 7 0 0 1 14 0Z"})})}),i.jsx("input",{ref:w,type:"text",value:n,onChange:b,onKeyDown:p,onFocus:()=>{a.length>0&&c(!0)},className:"block w-full pl-9 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:e}),y&&i.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})})]}),l&&a.length>0&&i.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-md shadow-lg max-h-96 overflow-y-auto",children:[a.map((N,S)=>i.jsx("div",{className:`px-4 py-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 ${S===u?"bg-blue-50":""}`,onClick:()=>_(N),children:i.jsxs("div",{className:"flex items-start space-x-3",children:[i.jsx("div",{className:"flex-shrink-0 mt-0.5",children:j(N.type)}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:N.title}),i.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800",children:k(N.type)})]}),N.subtitle&&i.jsx("p",{className:"text-sm text-gray-600 truncate",children:N.subtitle}),i.jsxs("div",{className:"flex items-center justify-between mt-1",children:[N.description&&i.jsx("p",{className:"text-xs text-gray-500 truncate",children:N.description}),N.metadata&&i.jsx("span",{className:"ml-2 text-xs text-gray-400 truncate",children:N.metadata})]})]})]})},`${N.type}-${N.id}`)),i.jsxs("div",{className:"px-4 py-2 border-t border-gray-200 bg-gray-50",children:[i.jsx("button",{onClick:()=>{m(!0),c(!1)},className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:"View all results in advanced search"}),i.jsx("span",{className:"text-xs text-gray-500 ml-2",children:"(Ctrl+Enter)"})]})]}),l&&a.length===0&&n.trim()&&!y&&i.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-md shadow-lg",children:[i.jsxs("div",{className:"px-4 py-3 text-sm text-gray-500 text-center",children:['No results found for "',n,'"']}),i.jsx("div",{className:"px-4 py-2 border-t border-gray-200 bg-gray-50",children:i.jsx("button",{onClick:()=>{m(!0),c(!1)},className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:"Try advanced search"})})]}),i.jsx(Dz,{isOpen:f,onClose:()=>m(!1),initialQuery:n})]})},oo=({isOpen:e,onClose:t,title:r,searchType:n,onSelect:s})=>{const[a,o]=x.useState(""),[l,c]=x.useState([]),[u,d]=x.useState(!1),[f,m]=x.useState(-1),h=x.useRef(null);x.useEffect(()=>{e&&(setTimeout(()=>{var g;(g=h.current)==null||g.focus()},100),o(""),c([]),m(-1))},[e]),x.useEffect(()=>{const b=setTimeout(async()=>{if(!a.trim()){c([]);return}d(!0);try{const p=a.trim().toLowerCase();let _=[];if(n==="contact"){let j=$.from("contact").select("id, first_name, last_name, company, email, phone, mobile_phone, title");const k=p.split(/\s+/).filter(C=>C.length>0);if(k.length>=2){const C=k[0],E=k.slice(1).join(" ");j=j.or(`and(first_name.ilike.%${C}%,last_name.ilike.%${E}%),first_name.ilike.%${p}%,last_name.ilike.%${p}%,company.ilike.%${p}%,email.ilike.%${p}%`)}else j=j.or(`first_name.ilike.%${p}%,last_name.ilike.%${p}%,company.ilike.%${p}%,email.ilike.%${p}%`);const{data:N,error:S}=await j.order("last_name").limit(20);if(S)throw S;N&&(_=N.map(C=>{const E=C.first_name||"",T=C.last_name||"",O=`${E} ${T}`.trim()||"Unnamed Contact",A=[C.email,C.phone,C.mobile_phone].filter(Boolean)[0]||"";return{id:C.id,type:"contact",title:O,subtitle:C.company||C.title||"Contact",description:A,metadata:"",url:`/contact/${C.id}`}}))}else if(n==="deal"){const{data:j,error:k}=await $.from("deal").select(`
              *,
              client!client_id (client_name),
              deal_stage (label),
              property (property_name, address, city, state)
            `).or(`deal_name.ilike.%${p}%,sf_broker.ilike.%${p}%,sf_address.ilike.%${p}%`).limit(20);if(k)throw k;j&&(_=j.map(N=>{var E,T,L,O,A,M;const S=N.deal_name||"Unnamed Deal",C=[(E=N.property)==null?void 0:E.address,(T=N.property)==null?void 0:T.city,(L=N.property)==null?void 0:L.state].filter(Boolean).join(", ");return{id:N.id,type:"deal",title:S,subtitle:((O=N.client)==null?void 0:O.client_name)||"No Client",description:((A=N.property)==null?void 0:A.property_name)||C,metadata:((M=N.deal_stage)==null?void 0:M.label)||"No Stage",url:`/deal/${N.id}`}}))}else if(n==="property"){const{data:j,error:k}=await $.from("property").select(`
              *,
              property_type (label),
              property_stage (label)
            `).or(`property_name.ilike.%${p}%,address.ilike.%${p}%,city.ilike.%${p}%,state.ilike.%${p}%`).limit(20);if(k)throw k;j&&(_=j.map(N=>{var E,T;const S=N.property_name||"Unnamed Property",C=[N.address,N.city,N.state].filter(Boolean).join(", ");return{id:N.id,type:"property",title:S,subtitle:C||"Property",description:((E=N.property_type)==null?void 0:E.label)||"",metadata:((T=N.property_stage)==null?void 0:T.label)||"",url:`/property/${N.id}`}}))}else if(n==="assignment"){const{data:j,error:k}=await $.from("assignment").select("*").or(`assignment_name.ilike.%${p}%,site_criteria.ilike.%${p}%`).limit(20);if(k)throw k;j&&(_=j.map(N=>{const S=N.assignment_name||"Unnamed Assignment";return{id:N.id,type:"assignment",title:S,subtitle:"Assignment",description:N.site_criteria||N.progress||"",metadata:"",url:`/assignment/${N.id}`}}))}c(_),m(-1)}catch(p){console.error("Search error:",p),c([])}finally{d(!1)}},300);return()=>clearTimeout(b)},[a,n]);const y=g=>{if(l.length)switch(g.key){case"ArrowDown":g.preventDefault(),m(b=>b<l.length-1?b+1:b);break;case"ArrowUp":g.preventDefault(),m(b=>b>0?b-1:-1);break;case"Enter":g.preventDefault(),f>=0?v(l[f]):l.length>0&&v(l[0]);break;case"Escape":t();break}},v=g=>{s(g)},w=g=>{switch(g){case"deal":return i.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})});case"contact":return i.jsx("svg",{className:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})});case"property":return i.jsx("svg",{className:"w-5 h-5 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})});case"assignment":return i.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})});default:return i.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}};return e?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50",onClick:t}),i.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:i.jsx("div",{className:"flex min-h-full items-start justify-center p-4 text-center sm:p-0",children:i.jsxs("div",{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-2xl",children:[i.jsx("div",{className:"bg-white px-6 py-4 border-b border-gray-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:r}),i.jsxs("button",{onClick:t,className:"rounded-md bg-white text-gray-400 hover:text-gray-500 focus:outline-none",children:[i.jsx("span",{className:"sr-only",children:"Close"}),i.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})]})]})}),i.jsx("div",{className:"px-6 py-4",children:i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m21 21-6-6m2-5a7 7 0 1 1-14 0 7 7 0 0 1 14 0Z"})})}),i.jsx("input",{ref:h,type:"text",value:a,onChange:g=>o(g.target.value),onKeyDown:y,className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 text-lg",placeholder:`Search ${n}s...`}),u&&i.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:i.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-500"})})]})}),i.jsxs("div",{className:"px-6 pb-6",children:[a.trim()&&!u&&l.length===0&&i.jsxs("div",{className:"text-center py-8 text-gray-500",children:['No results found for "',a,'"']}),l.length>0&&i.jsx("div",{className:"max-h-96 overflow-y-auto",children:i.jsx("div",{className:"space-y-2",children:l.map((g,b)=>i.jsx("div",{className:`p-4 border border-gray-200 rounded-lg cursor-pointer transition-colors ${b===f?"bg-blue-50 border-blue-200":"hover:bg-gray-50"}`,onClick:()=>v(g),children:i.jsxs("div",{className:"flex items-start space-x-3",children:[i.jsx("div",{className:"flex-shrink-0 mt-0.5",children:w(g.type)}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("p",{className:"text-base font-medium text-gray-900 truncate",children:g.title}),i.jsx("span",{className:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 capitalize",children:g.type})]}),g.subtitle&&i.jsx("p",{className:"text-sm text-gray-600 truncate mt-1",children:g.subtitle}),i.jsxs("div",{className:"flex items-center justify-between mt-1",children:[g.description&&i.jsx("p",{className:"text-xs text-gray-500 truncate",children:g.description}),g.metadata&&i.jsx("span",{className:"ml-2 text-xs text-gray-400 truncate",children:g.metadata})]})]})]})},`${g.type}-${g.id}`))})})]}),i.jsx("div",{className:"bg-gray-50 px-6 py-3",children:i.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-500",children:[i.jsx("span",{children:l.length>0&&`${l.length} result${l.length===1?"":"s"} found`}),i.jsx("span",{children:"Press  to navigate, Enter to select, Esc to close"})]})})]})})})]}):null},lo=({title:e,items:t,recentItems:r,onRecentItemClick:n})=>{const[s,a]=x.useState(!1),[o,l]=x.useState(r||[]),c=x.useRef(null),{getRecentItems:u}=Zg();return x.useEffect(()=>{const d=f=>{c.current&&!c.current.contains(f.target)&&a(!1)};return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[]),x.useEffect(()=>{if(s&&e){const f={Properties:"property",Contacts:"contact",Deals:"deal",Assignments:"assignment",Clients:"client"}[e];if(f){const m=u(f);l(m)}}},[s,e,u]),i.jsxs("div",{className:"relative",ref:c,children:[i.jsxs("button",{onClick:()=>a(!s),className:"flex items-center px-4 py-2 rounded hover:bg-blue-100 transition-colors",children:[e,i.jsx("svg",{className:`w-4 h-4 ml-1 transition-transform ${s?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),s&&i.jsx("div",{className:"absolute left-0 mt-2 w-64 bg-white border border-gray-200 rounded-md shadow-lg z-50",children:i.jsxs("div",{className:"py-1",children:[o&&o.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"px-4 py-2 text-xs font-medium text-gray-500 uppercase tracking-wider border-b border-gray-100",children:"Recently Viewed"}),o.map((d,f)=>i.jsxs("button",{onClick:()=>{n==null||n(d),a(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-blue-50 transition-colors",children:[i.jsx("div",{className:"truncate font-medium",children:d.name}),d.subtitle&&i.jsx("div",{className:"text-xs text-gray-500 truncate",children:d.subtitle})]},`recent-${f}`)),i.jsx("div",{className:"border-b border-gray-100 my-1"})]}),t.map((d,f)=>i.jsx("button",{onClick:()=>{d.action(),a(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors font-medium",children:d.label},f))]})})]})};function Pz(){const e=Vr(),t=Jt(),{user:r,signOut:n}=lg(),{getRecentItems:s}=Zg(),[a,o]=x.useState(0);x.useEffect(()=>{o(g=>g+1)},[e.pathname]);const[l,c]=x.useState({properties:!1,contacts:!1,deals:!1,assignments:!1,clients:!1}),u=g=>`px-4 py-2 rounded hover:bg-blue-100 ${e.pathname===g?"bg-blue-200 font-semibold":""}`,d=async()=>{await n()},f=g=>{switch(g.type){case"deal":t(`/deal/${g.id}`);break;case"property":t(`/property/${g.id}`);break;case"contact":t(`/contact/${g.id}`);break;case"assignment":t(`/assignment/${g.id}`);break;case"client":t(`/client/${g.id}`);break;case"site_submit":t(`/site-submit/${g.id}`);break;default:console.warn("Unknown item type:",g.type)}},m=[{label:"Add New Property",action:()=>t("/property/new")},{label:"Search Properties",action:()=>c(g=>({...g,properties:!0}))}],h=[{label:"Add New Contact",action:()=>t("/contact/new")},{label:"Search Contacts",action:()=>c(g=>({...g,contacts:!0}))}],y=[{label:"Add New Deal",action:()=>t("/deal/new")},{label:"Search Deals",action:()=>c(g=>({...g,deals:!0}))}],v=[{label:"Add New Assignment",action:()=>t("/assignment/new")},{label:"Search Assignments",action:()=>c(g=>({...g,assignments:!0}))}],w=[{label:"Add New Client",action:()=>t("/client/new")},{label:"Search Clients",action:()=>c(g=>({...g,clients:!0}))}];return i.jsxs("nav",{className:"bg-white shadow p-4",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx(Ga,{to:"/master-pipeline",className:u("/master-pipeline"),children:"Master Pipeline"}),i.jsx(Ga,{to:"/notes-debug",className:u("/notes-debug"),children:"Notes"}),i.jsx(Ga,{to:"/mapping",className:u("/mapping"),children:" Map"}),i.jsx(lo,{title:"Properties",items:m,recentItems:s("property"),onRecentItemClick:f},`properties-${a}`),i.jsx(lo,{title:"Contacts",items:h,recentItems:s("contact"),onRecentItemClick:f},`contacts-${a}`),i.jsx(lo,{title:"Deals",items:y,recentItems:s("deal"),onRecentItemClick:f},`deals-${a}`),i.jsx(lo,{title:"Assignments",items:v,recentItems:s("assignment"),onRecentItemClick:f},`assignments-${a}`),i.jsx(lo,{title:"Clients",items:w,recentItems:s("client"),onRecentItemClick:f},`clients-${a}`)]}),i.jsx("div",{className:"flex-1 max-w-2xl mx-8",children:i.jsx(RN,{})}),r&&i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx("span",{className:"text-sm text-gray-600",children:r.email}),i.jsx("button",{onClick:d,className:"px-3 py-1 text-sm bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"Sign Out"})]})]}),l.properties&&i.jsx(oo,{isOpen:l.properties,onClose:()=>c(g=>({...g,properties:!1})),title:"Search Properties",searchType:"property",onSelect:g=>{t(g.url||"/"),c(b=>({...b,properties:!1}))}}),l.contacts&&i.jsx(oo,{isOpen:l.contacts,onClose:()=>c(g=>({...g,contacts:!1})),title:"Search Contacts",searchType:"contact",onSelect:g=>{t(g.url||"/"),c(b=>({...b,contacts:!1}))}}),l.deals&&i.jsx(oo,{isOpen:l.deals,onClose:()=>c(g=>({...g,deals:!1})),title:"Search Deals",searchType:"deal",onSelect:g=>{t(g.url||"/"),c(b=>({...b,deals:!1}))}}),l.assignments&&i.jsx(oo,{isOpen:l.assignments,onClose:()=>c(g=>({...g,assignments:!1})),title:"Search Assignments",searchType:"assignment",onSelect:g=>{t(g.url||"/"),c(b=>({...b,assignments:!1}))}}),l.clients&&i.jsx(oo,{isOpen:l.clients,onClose:()=>c(g=>({...g,clients:!1})),title:"Search Clients",searchType:"client",onSelect:g=>{t(g.url||"/"),c(b=>({...b,clients:!1}))}})]})}const Tz=()=>{const e=t=>{console.log("Selected search result:",t),alert(`Selected: ${t.title} (${t.type})`)};return i.jsx("div",{className:"min-h-screen bg-gray-100 p-8",children:i.jsxs("div",{className:"max-w-4xl mx-auto",children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Master Search Test Page"}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-8",children:[i.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Search Features"}),i.jsxs("ul",{className:"list-disc list-inside space-y-2 text-gray-700 mb-6",children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Real-time Search:"})," As you type, results appear instantly"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Multi-entity Search:"})," Searches across Deals, Clients, Contacts, Properties, and Site Submits"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Intelligent Ranking:"})," Results are ranked by relevance and type priority"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Keyboard Navigation:"})," Use arrow keys to navigate, Enter to select"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Advanced Search:"})," Press Ctrl+Enter or click the link for detailed search"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Quick Access:"})," Click any result to navigate to that item"]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium",children:"Try searching for:"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"font-medium text-green-600",children:"Deals:"}),i.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-1",children:[i.jsx("li",{children:"Deal names"}),i.jsx("li",{children:"Account names"}),i.jsx("li",{children:"Deal notes"})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"font-medium text-blue-600",children:"Clients:"}),i.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-1",children:[i.jsx("li",{children:"Client names"}),i.jsx("li",{children:"Account names"}),i.jsx("li",{children:"Client types"})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"font-medium text-purple-600",children:"Contacts:"}),i.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-1",children:[i.jsx("li",{children:"First/last names"}),i.jsx("li",{children:"Company names"}),i.jsx("li",{children:"Email addresses"}),i.jsx("li",{children:"Job titles"})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"font-medium text-orange-600",children:"Properties:"}),i.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-1",children:[i.jsx("li",{children:"Property names"}),i.jsx("li",{children:"Street addresses"}),i.jsx("li",{children:"Cities and states"}),i.jsx("li",{children:"Trade areas"})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"font-medium text-teal-600",children:"Site Submits:"}),i.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-1",children:[i.jsx("li",{children:"Submit names"}),i.jsx("li",{children:"Account names"}),i.jsx("li",{children:"Submit notes"})]})]})]})]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[i.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Test the Search"}),i.jsx(RN,{onSelect:e,placeholder:"Try searching for anything...",className:"w-full"}),i.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[i.jsx("h3",{className:"font-medium mb-2",children:"Keyboard shortcuts:"}),i.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[i.jsxs("li",{children:[i.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-200 rounded text-xs",children:"/"})," Navigate results"]}),i.jsxs("li",{children:[i.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-200 rounded text-xs",children:"Enter"})," Select result"]}),i.jsxs("li",{children:[i.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-200 rounded text-xs",children:"Ctrl+Enter"})," Open advanced search"]}),i.jsxs("li",{children:[i.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-200 rounded text-xs",children:"Esc"})," Close dropdown"]})]})]})]})]})})},Lz=()=>{const[e,t]=x.useState(""),[r,n]=x.useState([]),[s,a]=x.useState(!1),[o,l]=x.useState(null),c=async()=>{if(e.trim()){a(!0),l(null);try{console.log("Simple search for:",e);const{data:u,error:d}=await $.from("deal").select("id, deal_name, created_at").ilike("deal_name",`%${e}%`).limit(5);if(d)throw d;console.log("Simple search results:",u),n(u||[])}catch(u){console.error("Simple search error:",u),l(u instanceof Error?u.message:"Search failed")}finally{a(!1)}}};return i.jsxs("div",{className:"p-6 bg-white rounded-lg shadow",children:[i.jsx("h2",{className:"text-xl font-bold mb-4",children:"Simple Search Test"}),i.jsxs("div",{className:"flex space-x-4 mb-4",children:[i.jsx("input",{type:"text",value:e,onChange:u=>t(u.target.value),onKeyDown:u=>u.key==="Enter"&&c(),placeholder:"Search deals...",className:"flex-1 px-3 py-2 border rounded-md"}),i.jsx("button",{onClick:c,disabled:s,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:s?"Searching...":"Search"})]}),o&&i.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md mb-4",children:i.jsxs("p",{className:"text-red-700",children:["Error: ",o]})}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("h3",{className:"font-medium",children:["Results (",r.length,"):"]}),r.map(u=>i.jsxs("div",{className:"p-3 bg-gray-50 rounded border",children:[i.jsx("div",{className:"font-medium",children:u.deal_name||"Unnamed Deal"}),i.jsxs("div",{className:"text-sm text-gray-600",children:["ID: ",u.id]}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Created: ",u.created_at]})]},u.id)),r.length===0&&e&&!s&&i.jsx("div",{className:"text-gray-500",children:"No results found"})]})]})},Iz=()=>{const[e,t]=x.useState(""),[r,n]=x.useState({}),{search:s,loading:a,error:o}=x0();x.useEffect(()=>{(async()=>{var u,d,f,m,h;try{console.log("Testing database connections...");const[y,v,w,g,b]=await Promise.all([$.from("deal").select("id, deal_name").limit(3),$.from("client").select("id, client_name").limit(3),$.from("contact").select("id, first_name, last_name").limit(3),$.from("property").select("id, property_name").limit(3),$.from("site_submit").select("id, site_submit_name").limit(3)]);console.log("Database test results:",{deals:y,clients:v,contacts:w,properties:g,siteSubmits:b}),n({deals:{count:((u=y.data)==null?void 0:u.length)||0,error:y.error,sample:y.data},clients:{count:((d=v.data)==null?void 0:d.length)||0,error:v.error,sample:v.data},contacts:{count:((f=w.data)==null?void 0:f.length)||0,error:w.error,sample:w.data},properties:{count:((m=g.data)==null?void 0:m.length)||0,error:g.error,sample:g.data},siteSubmits:{count:((h=b.data)==null?void 0:h.length)||0,error:b.error,sample:b.data}})}catch(y){console.error("Database test failed:",y),n({error:y instanceof Error?y.message:"Unknown error"})}})()},[]);const l=async()=>{if(e.trim()){console.log(`Testing search for: "${e}"`);try{const c=await s(e,{limit:5});console.log("Search results:",c),alert(`Found ${c.length} results. Check console for details.`)}catch(c){console.error("Search test failed:",c),alert(`Search failed: ${c instanceof Error?c.message:"Unknown error"}`)}}};return i.jsx("div",{className:"min-h-screen bg-gray-100 p-8",children:i.jsxs("div",{className:"max-w-4xl mx-auto",children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Search Debug Page"}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Database Connection Test"}),i.jsx("div",{className:"space-y-4",children:Object.entries(r).map(([c,u])=>i.jsxs("div",{className:"border-l-4 border-blue-500 pl-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h3",{className:"font-medium capitalize",children:c}),i.jsx("span",{className:`px-2 py-1 rounded text-xs ${u!=null&&u.error?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:u!=null&&u.error?"Error":`${(u==null?void 0:u.count)||0} records`})]}),(u==null?void 0:u.error)&&i.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.error.message||JSON.stringify(u.error)}),(u==null?void 0:u.sample)&&u.sample.length>0&&i.jsxs("div",{className:"mt-2",children:[i.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Sample data:"}),i.jsx("pre",{className:"text-xs bg-gray-50 p-2 rounded overflow-x-auto",children:JSON.stringify(u.sample,null,2)})]})]},c))})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Manual Search Test"}),i.jsxs("div",{className:"flex space-x-4 mb-4",children:[i.jsx("input",{type:"text",value:e,onChange:c=>t(c.target.value),placeholder:"Enter search term...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),i.jsx("button",{onClick:l,disabled:a,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:a?"Searching...":"Test Search"})]}),o&&i.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:i.jsxs("p",{className:"text-red-700",children:["Search Error: ",o]})})]}),i.jsx(Lz,{}),i.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 mt-6",children:[i.jsx("h2",{className:"text-xl font-semibold mb-4 text-yellow-800",children:"Debug Instructions"}),i.jsxs("ul",{className:"space-y-2 text-yellow-700",children:[i.jsx("li",{children:"1. Open your browser's developer console (F12)"}),i.jsx("li",{children:"2. Check the database connection results above"}),i.jsx("li",{children:"3. Try the manual search test"}),i.jsx("li",{children:"4. Try the simple search test"}),i.jsx("li",{children:"5. Look for any error messages in the console"}),i.jsx("li",{children:"6. Check network tab for failed API requests"})]})]})]})})},Rz=({entityType:e,value:t,onChange:r,placeholder:n,className:s="text-xs border border-gray-300 rounded px-2 py-1"})=>{const[a,o]=x.useState(""),[l,c]=x.useState([]),[u,d]=x.useState(!1),f=x.useRef(null);x.useEffect(()=>{(async()=>{if(t){let g=$.from(e),b="";switch(e){case"client":b="client_name";break;case"deal":b="deal_name";break;case"contact":b="first_name, last_name, source_type";break;case"property":b="property_name, address";break;case"assignment":b="assignment_name";break;case"user":b="first_name, last_name, email";break}const{data:p}=await g.select(`id, ${b}`).eq("id",t).single();if(p){let _="";switch(e){case"client":_=p.client_name||"";break;case"deal":_=p.deal_name||"";break;case"contact":const j=`${p.first_name||""} ${p.last_name||""}`.trim(),k=p.source_type==="Lead"?" (Lead)":"";_=j+k;break;case"property":_=p.property_name||p.address||"";break;case"assignment":_=p.assignment_name||"";break;case"user":_=`${p.first_name||""} ${p.last_name||""}`.trim()||p.email||"";break}o(_)}}else o("")})()},[t,e]),x.useEffect(()=>{const g=setTimeout(async()=>{const b=a.trim();if(!b||!u)return c([]);let p=$.from(e),_="",j="";switch(e){case"client":_="client_name",j="client_name";break;case"deal":_="deal_name",j="deal_name";break;case"contact":_="first_name, last_name, source_type",j="first_name";break;case"property":_="property_name, address",j="property_name";break;case"assignment":_="assignment_name",j="assignment_name";break;case"user":_="first_name, last_name, email",j="first_name";break}const{data:k}=await p.select(`id, ${_}`).ilike(j,`%${b}%`).order(j,{ascending:!0}).limit(5);if(k){const N=k.map(S=>{let C="";switch(e){case"client":C=S.client_name||"Unnamed Client";break;case"deal":C=S.deal_name||"Unnamed Deal";break;case"contact":const E=`${S.first_name||""} ${S.last_name||""}`.trim()||"Unnamed Contact",T=S.source_type==="Lead"?" (Lead)":"";C=E+T;break;case"property":C=S.property_name||S.address||"Unnamed Property";break;case"assignment":C=S.assignment_name||"Unnamed Assignment";break;case"user":C=`${S.first_name||""} ${S.last_name||""}`.trim()||S.email||"Unnamed User";break}return{id:S.id,label:C}});c(N)}},150);return()=>clearTimeout(g)},[a,e,u]);const m=()=>{d(!0),f.current&&f.current.select()},h=()=>{setTimeout(()=>d(!1),200)},y=(w,g)=>{r(w,g),o(g),c([]),d(!1)},v=w=>{const g=w.target.value;o(g),d(!0),g===""&&r(null,"")};return i.jsxs("div",{className:"relative",children:[i.jsx("input",{ref:f,type:"text",value:a,onChange:v,onFocus:m,onBlur:h,placeholder:n||`Search ${e}...`,className:s,onClick:w=>w.stopPropagation()}),u&&l.length>0&&i.jsx("ul",{className:"absolute z-50 bg-white border border-gray-300 rounded mt-1 max-h-48 overflow-auto shadow-lg w-full",children:l.map(w=>i.jsx("li",{onClick:g=>{g.stopPropagation(),y(w.id,w.label)},className:"p-2 hover:bg-gray-100 cursor-pointer text-sm",children:w.label},w.id))})]})},Mz=({noteId:e,currentAssociations:t={},onAssociationChange:r})=>{const[n,s]=x.useState([]),[a,o]=x.useState(!1),[l,c]=x.useState(""),[u,d]=x.useState(!1);x.useEffect(()=>{if(t){const p=[];Object.entries(t).forEach(([_,j])=>{if(j){const k=_.replace("_id","");p.push({id:`temp_${k}_${j}`,note_id:e,object_type:k,object_id:j,[`${k}_id`]:j})}}),s(p)}f()},[e,t]);const f=async()=>{try{const{data:p,error:_}=await $.from("note_object_link").select("*").eq("note_id",e);if(_)throw _;s(p||[])}catch(p){console.error("Error loading associations:",p)}},m=async(p,_)=>{var j,k,N,S,C,E,T;d(!0);try{const L={note_id:e,sf_content_document_link_id:`manual_${Date.now()}_${p}_${_}`,object_type:p,object_id:_,[`${p}_id`]:_},{data:O,error:A}=await $.from("note_object_link").insert([L]).select().single();if(A)throw A;const M=[...n,O];if(s(M),o(!1),c(""),r){const B={client_id:((j=M.find(F=>F.object_type==="client"))==null?void 0:j.client_id)||null,deal_id:((k=M.find(F=>F.object_type==="deal"))==null?void 0:k.deal_id)||null,contact_id:((N=M.find(F=>F.object_type==="contact"))==null?void 0:N.contact_id)||null,property_id:((S=M.find(F=>F.object_type==="property"))==null?void 0:S.property_id)||null,assignment_id:((C=M.find(F=>F.object_type==="assignment"))==null?void 0:C.assignment_id)||null,site_submit_id:((E=M.find(F=>F.object_type==="site_submit"))==null?void 0:E.site_submit_id)||null,user_id:((T=M.find(F=>F.object_type==="user"))==null?void 0:T.user_id)||null};r(B)}}catch(L){console.error("Error adding association:",L)}finally{d(!1)}},h=async p=>{var _,j,k,N,S,C,E;d(!0);try{const{error:T}=await $.from("note_object_link").delete().eq("id",p);if(T)throw T;const L=n.filter(O=>O.id!==p);if(s(L),r){const O={client_id:((_=L.find(A=>A.object_type==="client"))==null?void 0:_.client_id)||null,deal_id:((j=L.find(A=>A.object_type==="deal"))==null?void 0:j.deal_id)||null,contact_id:((k=L.find(A=>A.object_type==="contact"))==null?void 0:k.contact_id)||null,property_id:((N=L.find(A=>A.object_type==="property"))==null?void 0:N.property_id)||null,assignment_id:((S=L.find(A=>A.object_type==="assignment"))==null?void 0:S.assignment_id)||null,site_submit_id:((C=L.find(A=>A.object_type==="site_submit"))==null?void 0:C.site_submit_id)||null,user_id:((E=L.find(A=>A.object_type==="user"))==null?void 0:E.user_id)||null};r(O)}}catch(T){console.error("Error removing association:",T)}finally{d(!1)}},[y,v]=x.useState({});x.useEffect(()=>{const p=async()=>{const _={};for(const j of n){const k=`${j.object_type}_${j.object_id}`;if(!y[k])try{if(!j.object_type||!["client","deal","contact","property","assignment","user"].includes(j.object_type)){_[k]=`${j.object_type||"Unknown"} (${j.object_id})`;continue}let N="";switch(j.object_type){case"client":N="client_name";break;case"deal":N="deal_name";break;case"contact":N="first_name, last_name, source_type";break;case"property":N="property_name, address";break;case"assignment":N="assignment_name";break;case"user":N="first_name, last_name, email";break}const{data:S}=await $.from(j.object_type).select(`id, ${N}`).eq("id",j.object_id).single();if(S){let C="";switch(j.object_type){case"client":C=S.client_name||"Unknown Client";break;case"deal":C=S.deal_name||"Unknown Deal";break;case"contact":const E=`${S.first_name||""} ${S.last_name||""}`.trim()||"Unknown Contact",T=S.source_type==="Lead"?" (Lead)":"";C=E+T;break;case"property":C=S.property_name||S.address||"Unknown Property";break;case"assignment":C=S.assignment_name||"Unknown Assignment";break;case"user":C=`${S.first_name||""} ${S.last_name||""}`.trim()||S.email||"Unknown User";break}_[k]=C}else _[k]=`Unknown ${j.object_type}`}catch(N){console.error(`Error loading ${j.object_type} name:`,N),_[k]=`Unknown ${j.object_type}`}}Object.keys(_).length>0&&v(j=>({...j,..._}))};n.length>0&&p()},[n]);const w=p=>{const _=`${p.object_type}_${p.object_id}`;return y[_]||`Loading ${p.object_type}...`},g=p=>{switch(p){case"client":return"";case"deal":return"";case"contact":return"";case"property":return"";case"assignment":return"";case"site_submit":return"";case"user":return"";default:return""}},b=p=>{switch(p){case"client":return"bg-blue-100 text-blue-800 border-blue-200";case"deal":return"bg-green-100 text-green-800 border-green-200";case"contact":return"bg-purple-100 text-purple-800 border-purple-200";case"property":return"bg-orange-100 text-orange-800 border-orange-200";case"assignment":return"bg-pink-100 text-pink-800 border-pink-200";case"site_submit":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"user":return"bg-gray-100 text-gray-800 border-gray-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};return i.jsxs("div",{className:"space-y-3",children:[n.length>0&&i.jsx("div",{className:"flex flex-wrap gap-2",children:n.map(p=>i.jsxs("div",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium border ${b(p.object_type)}`,children:[i.jsx("span",{children:g(p.object_type)}),i.jsx("span",{className:"max-w-24 truncate",children:w(p)}),i.jsx("button",{onClick:_=>{_.stopPropagation(),h(p.id)},className:"ml-1 hover:bg-black/10 rounded-full w-4 h-4 flex items-center justify-center",disabled:u,title:"Remove association",children:""})]},p.id))}),a?i.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2 border",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Add Association"}),i.jsx("button",{onClick:p=>{p.stopPropagation(),o(!1),c("")},className:"text-gray-400 hover:text-gray-600",children:""})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("select",{value:l,onChange:p=>c(p.target.value),className:"w-full text-xs border border-gray-300 rounded px-2 py-1",onClick:p=>p.stopPropagation(),children:[i.jsx("option",{value:"",children:"Select type..."}),i.jsx("option",{value:"client",children:"Client"}),i.jsx("option",{value:"deal",children:"Deal"}),i.jsx("option",{value:"contact",children:"Contact"}),i.jsx("option",{value:"property",children:"Property"}),i.jsx("option",{value:"assignment",children:"Assignment"}),i.jsx("option",{value:"user",children:"User"})]}),l&&i.jsx(Rz,{entityType:l,value:null,onChange:(p,_)=>{p&&m(l,p)},placeholder:`Search ${l}...`,className:"w-full text-xs border border-gray-300 rounded px-2 py-1"})]})]}):i.jsxs("button",{onClick:p=>{p.stopPropagation(),o(!0)},className:"inline-flex items-center gap-1 px-2 py-1 text-xs text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded border border-dashed border-blue-300 transition-colors",disabled:u,children:[i.jsx("span",{children:"+"}),i.jsx("span",{children:"Add Association"})]})]})},Oz=()=>{const[e,t]=x.useState([]),[r,n]=x.useState(!0),[s,a]=x.useState(null),[o,l]=x.useState("all"),[c,u]=x.useState(""),[d,f]=x.useState({}),[m,h]=x.useState({}),[y,v]=x.useState({}),[w,g]=x.useState(!1),[b,p]=x.useState(1),[_]=x.useState(25);x.useEffect(()=>{j()},[]);const j=async()=>{n(!0),a(null);try{let P=[],D=!0,z=0;const W=1e3;for(;D;){const{data:Se,error:tt}=await $.from("note").select("*").order("created_at",{ascending:!1}).range(z,z+W-1);if(tt)throw tt;if(Se&&Se.length>0){const ct=Se.map(Be=>Be.id);try{const Ie=[];for(let fe=0;fe<ct.length;fe+=100){const Ne=ct.slice(fe,fe+100);try{const{data:gn}=await $.from("note_object_link").select("*").in("note_id",Ne);gn&&Ie.push(...gn)}catch(gn){console.warn("Error fetching relationship batch:",gn)}}const fr=new Map;Ie&&Ie.forEach(fe=>{fr.has(fe.note_id)||fr.set(fe.note_id,{client_id:null,deal_id:null,contact_id:null,property_id:null,assignment_id:null,site_submit_id:null,user_id:null});const Ne=fr.get(fe.note_id);fe.client_id&&(Ne.client_id=fe.client_id),fe.deal_id&&(Ne.deal_id=fe.deal_id),fe.contact_id&&(Ne.contact_id=fe.contact_id),fe.property_id&&(Ne.property_id=fe.property_id),fe.assignment_id&&(Ne.assignment_id=fe.assignment_id),fe.site_submit_id&&(Ne.site_submit_id=fe.site_submit_id),fe.user_id&&(Ne.user_id=fe.user_id)}),Se.forEach(fe=>{const Ne=fr.get(fe.id);Ne?(fe.client_id=Ne.client_id,fe.deal_id=Ne.deal_id,fe.contact_id=Ne.contact_id,fe.property_id=Ne.property_id,fe.assignment_id=Ne.assignment_id,fe.site_submit_id=Ne.site_submit_id,fe.user_id=Ne.user_id):(fe.client_id=null,fe.deal_id=null,fe.contact_id=null,fe.property_id=null,fe.assignment_id=null,fe.site_submit_id=null,fe.user_id=null)}),P.push(...Se)}catch(Be){console.warn("Error getting batch relationships:",Be),Se.forEach(Ie=>{Ie.client_id=null,Ie.deal_id=null,Ie.contact_id=null,Ie.property_id=null,Ie.assignment_id=null,Ie.site_submit_id=null,Ie.user_id=null}),P.push(...Se)}}const ye=Se;ye&&ye.length>0?(z+=W,ye.length<W&&(D=!1)):D=!1}const I=P;if(!I)throw new Error("Failed to load notes");const{data:ne,error:re}=await $.from("client").select("id, client_name");if(re)throw re;const{data:Q,error:U}=await $.from("deal").select("id, deal_name");if(U)throw U;const{data:J,error:X}=await $.from("contact").select("id, first_name, last_name");if(X)throw X;const ue=(ne||[]).reduce((Se,tt)=>(Se[tt.id]=tt,Se),{}),pe=(Q||[]).reduce((Se,tt)=>(Se[tt.id]=tt,Se),{}),De=(J||[]).reduce((Se,tt)=>(Se[tt.id]=tt,Se),{});t(I||[]),f(ue),h(pe),v(De)}catch(P){console.error("Error loading notes:",P),a(P instanceof Error?P.message:"Failed to load notes")}finally{n(!1)}},k=P=>{if(!P)return"N/A";try{return new Date(P).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}catch{return"Invalid Date"}},N=P=>{if(!P)return"N/A";try{return new Date(P).toLocaleString()}catch{return"Invalid Date"}},S=(P,D)=>{var X,ue,pe,De,Se,tt;if(!D.trim())return!0;const z=D.trim(),W=ye=>{var Be,Ie;return[ye.title||"",ye.body||"",ye.sf_content_note_id||"",ye.client_id&&((Be=d[ye.client_id])==null?void 0:Be.client_name)||"",ye.deal_id&&((Ie=m[ye.deal_id])==null?void 0:Ie.deal_name)||"",ye.contact_id&&y[ye.contact_id]?`${y[ye.contact_id].first_name||""} ${y[ye.contact_id].last_name||""}`.trim():"",k(ye.created_at),k(ye.updated_at)].filter(Boolean).join(" ").toLowerCase()},I=z.match(/^(title|client|deal|contact|body|date):(.+)$/i);if(I){const[,ye,ct]=I,Be=ct.toLowerCase();switch(ye.toLowerCase()){case"title":return((X=P.title)==null?void 0:X.toLowerCase().includes(Be))||!1;case"client":return P.client_id&&((pe=(ue=d[P.client_id])==null?void 0:ue.client_name)==null?void 0:pe.toLowerCase().includes(Be))||!1;case"deal":return P.deal_id&&((Se=(De=m[P.deal_id])==null?void 0:De.deal_name)==null?void 0:Se.toLowerCase().includes(Be))||!1;case"contact":if(!P.contact_id||!y[P.contact_id])return!1;const Ie=y[P.contact_id];return`${Ie.first_name||""} ${Ie.last_name||""}`.toLowerCase().includes(Be);case"body":return((tt=P.body)==null?void 0:tt.toLowerCase().includes(Be))||!1;case"date":return`${k(P.created_at)} ${k(P.updated_at)}`.toLowerCase().includes(Be);default:return!1}}const ne=z.match(/^"(.+)"$/);if(ne){const ye=ne[1].toLowerCase();return W(P).includes(ye)}if(z.includes(" -")){const ye=z.split(" "),ct=ye.filter(Ne=>!Ne.startsWith("-")).map(Ne=>Ne.toLowerCase()),Be=ye.filter(Ne=>Ne.startsWith("-")).map(Ne=>Ne.substring(1).toLowerCase()),Ie=W(P),fr=ct.length===0||ct.every(Ne=>Ie.includes(Ne)),fe=Be.some(Ne=>Ie.includes(Ne));return fr&&!fe}const Q=z.toLowerCase().split(/\s+/).filter(ye=>ye.length>0);if(Q.length>1){const ye=W(P);return Q.every(ct=>ye.includes(ct))}const U=W(P),J=z.toLowerCase();return U.includes(J)?!0:J.length>3?U.split(/\s+/).some(ct=>{if(ct.includes(J)||ct.startsWith(J))return!0;if(J.length>=4){const Be=Math.floor(J.length/4);return C(ct,J)<=Be}return!1}):!1},C=(P,D)=>{const z=Array(D.length+1).fill(null).map(()=>Array(P.length+1).fill(null));for(let W=0;W<=P.length;W++)z[0][W]=W;for(let W=0;W<=D.length;W++)z[W][0]=W;for(let W=1;W<=D.length;W++)for(let I=1;I<=P.length;I++){const ne=P[I-1]===D[W-1]?0:1;z[W][I]=Math.min(z[W][I-1]+1,z[W-1][I]+1,z[W-1][I-1]+ne)}return z[D.length][P.length]},E=e.filter(P=>{if(o!=="all")switch(o){case"client":if(!P.client_id)return!1;break;case"deal":if(!P.deal_id)return!1;break;case"contact":if(!P.contact_id)return!1;break;case"property":if(!P.property_id)return!1;break;case"assignment":if(!P.assignment_id)return!1;break;case"site_submit":if(!P.site_submit_id)return!1;break;case"user":if(!P.user_id)return!1;break;case"unassigned":if(P.client_id||P.deal_id||P.contact_id||P.property_id||P.assignment_id||P.site_submit_id||P.user_id)return!1;break}return S(P,c)}),T=Math.ceil(E.length/_),L=(b-1)*_,O=L+_,A=E.slice(L,O),M=()=>{p(1)};H.useEffect(()=>{M()},[c,o]);const[B,F]=x.useState(new Set),R=P=>{const D=new Set(B);D.has(P)?D.delete(P):D.add(P),F(D)};return r?i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:i.jsx("div",{className:"flex items-center justify-center min-h-64",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}):s?i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error Loading Notes"}),i.jsx("div",{className:"mt-2 text-sm text-red-700",children:s})]})]})})}):i.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[i.jsxs("div",{className:"mb-8",children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Notes"}),i.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Total notes: ",e.length," | Filtered: ",E.length," | Showing ",L+1,"-",Math.min(O,E.length)," of ",E.length]}),i.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Advanced search: field filters, phrase matching, multi-word, exclusions, and fuzzy search"})]}),i.jsx("div",{className:"mb-6 space-y-4",children:i.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Filter by type:"}),i.jsxs("select",{value:o,onChange:P=>l(P.target.value),className:"rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[i.jsxs("option",{value:"all",children:["All Notes (",e.length,")"]}),i.jsxs("option",{value:"client",children:["Client Notes (",e.filter(P=>P.client_id).length,")"]}),i.jsxs("option",{value:"deal",children:["Deal Notes (",e.filter(P=>P.deal_id).length,")"]}),i.jsxs("option",{value:"contact",children:["Contact Notes (",e.filter(P=>P.contact_id).length,")"]}),i.jsxs("option",{value:"property",children:["Property Notes (",e.filter(P=>P.property_id).length,")"]}),i.jsxs("option",{value:"assignment",children:["Assignment Notes (",e.filter(P=>P.assignment_id).length,")"]}),i.jsxs("option",{value:"site_submit",children:["Site Submit Notes (",e.filter(P=>P.site_submit_id).length,")"]}),i.jsxs("option",{value:"user",children:["User Notes (",e.filter(P=>P.user_id).length,")"]}),i.jsxs("option",{value:"unassigned",children:["Unassigned (",e.filter(P=>!P.client_id&&!P.deal_id&&!P.contact_id&&!P.property_id&&!P.assignment_id&&!P.site_submit_id&&!P.user_id).length,")"]})]})]}),i.jsxs("div",{className:"flex-1 max-w-lg",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Powerful Search:"}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",value:c,onChange:P=>u(P.target.value),placeholder:'Try: "huey magoo", client:huey, meeting -call, title:site, date:2024',className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 pl-10"}),i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),c&&i.jsx("button",{onClick:()=>u(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:i.jsx("svg",{className:"h-4 w-4 text-gray-400 hover:text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsx("div",{className:"mt-1 text-xs text-gray-600",children:i.jsxs("details",{className:"cursor-pointer",children:[i.jsx("summary",{className:"hover:text-blue-600",children:"Search Help "}),i.jsxs("div",{className:"mt-1 space-y-1 text-xs bg-gray-50 p-2 rounded border",children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Field search:"})," ",i.jsx("code",{children:"client:huey"}),", ",i.jsx("code",{children:"title:meeting"}),", ",i.jsx("code",{children:"body:lease"}),", ",i.jsx("code",{children:"date:2024"})]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Phrase search:"})," ",i.jsx("code",{children:'"exact phrase"'})]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Multiple words:"})," ",i.jsx("code",{children:"huey magoo lease"})," (all must match)"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Exclude terms:"})," ",i.jsx("code",{children:"meeting -call"}),' (has "meeting" but not "call")']}),i.jsxs("div",{children:[i.jsx("strong",{children:"Fuzzy matching:"})," ",i.jsx("code",{children:"hueymago"}),' finds "huey magoo"']})]})]})})]}),i.jsxs("div",{className:"flex items-end space-x-2",children:[i.jsx("button",{onClick:()=>g(!w),className:`px-4 py-2 rounded-md transition-colors ${w?"bg-green-600 text-white hover:bg-green-700":"bg-gray-600 text-white hover:bg-gray-700"}`,children:w?"Show Truncated":"Show All Full Content"}),i.jsx("button",{onClick:j,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Refresh"})]})]})}),T>1&&i.jsxs("div",{className:"mb-6 flex items-center justify-between border-t border-gray-200 bg-white px-4 py-3 sm:px-6 rounded-lg shadow-sm",children:[i.jsxs("div",{className:"flex flex-1 justify-between sm:hidden",children:[i.jsx("button",{onClick:()=>p(Math.max(1,b-1)),disabled:b===1,className:"relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),i.jsx("button",{onClick:()=>p(Math.min(T,b+1)),disabled:b===T,className:"relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]}),i.jsxs("div",{className:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between",children:[i.jsx("div",{children:i.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",i.jsx("span",{className:"font-medium",children:L+1})," to"," ",i.jsx("span",{className:"font-medium",children:Math.min(O,E.length)})," of"," ",i.jsx("span",{className:"font-medium",children:E.length})," results"]})}),i.jsx("div",{children:i.jsxs("nav",{className:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination",children:[i.jsxs("button",{onClick:()=>p(Math.max(1,b-1)),disabled:b===1,className:"relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0 disabled:opacity-50 disabled:cursor-not-allowed",children:[i.jsx("span",{className:"sr-only",children:"Previous"}),i.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:i.jsx("path",{fillRule:"evenodd",d:"M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z",clipRule:"evenodd"})})]}),Array.from({length:Math.min(T,7)},(P,D)=>{let z;return T<=7||b<=4?z=D+1:b>=T-3?z=T-6+D:z=b-3+D,i.jsx("button",{onClick:()=>p(z),className:`relative inline-flex items-center px-4 py-2 text-sm font-semibold ${b===z?"z-10 bg-blue-600 text-white focus:z-20 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0"}`,children:z},z)}),i.jsxs("button",{onClick:()=>p(Math.min(T,b+1)),disabled:b===T,className:"relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0 disabled:opacity-50 disabled:cursor-not-allowed",children:[i.jsx("span",{className:"sr-only",children:"Next"}),i.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:i.jsx("path",{fillRule:"evenodd",d:"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z",clipRule:"evenodd"})})]})]})})]})]}),i.jsx("div",{className:"space-y-4",children:A.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),i.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No notes found"}),i.jsx("p",{className:"mt-1 text-sm text-gray-500",children:o==="all"?"No notes exist in the database.":"No notes match the current filter."})]}):A.map(P=>{const D=B.has(P.id),z=[];if(P.client_id&&d[P.client_id]&&z.push({type:"Client",name:d[P.client_id].client_name||"Unnamed"}),P.deal_id&&m[P.deal_id]&&z.push({type:"Deal",name:m[P.deal_id].deal_name||"Unnamed"}),P.contact_id&&y[P.contact_id]){const W=y[P.contact_id],I=`${W.first_name||""} ${W.last_name||""}`.trim()||"Unnamed";z.push({type:"Contact",name:I})}return P.property_id&&z.push({type:"Property",name:P.property_id}),P.assignment_id&&z.push({type:"Assignment",name:P.assignment_id}),P.site_submit_id&&z.push({type:"Site Submit",name:P.site_submit_id}),i.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-md transition-shadow",children:[i.jsx("div",{className:"p-4 cursor-pointer",onClick:()=>R(P.id),children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("div",{className:"flex-1 min-w-0",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("h3",{className:"text-base font-medium text-gray-900 truncate flex-shrink-0 max-w-xs",children:P.title||"Untitled Note"}),i.jsx("div",{className:"flex-1 min-w-0",children:i.jsx(Mz,{noteId:P.id,currentAssociations:{client_id:P.client_id||void 0,deal_id:P.deal_id||void 0,contact_id:P.contact_id||void 0,property_id:P.property_id||void 0,assignment_id:P.assignment_id||void 0,site_submit_id:P.site_submit_id||void 0,user_id:P.user_id||void 0},onAssociationChange:W=>{t(I=>I.map(ne=>ne.id===P.id?{...ne,...W}:ne))}})}),i.jsx("span",{className:"text-sm text-gray-500 flex-shrink-0",children:k(P.created_at)}),P.body&&i.jsxs("span",{className:"text-sm text-gray-500 flex-shrink-0",children:["(",P.body.length," chars)"]})]})}),i.jsx("div",{className:"flex items-center ml-3",children:i.jsx("svg",{className:`h-5 w-5 text-gray-400 transition-transform duration-200 ${D?"transform rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})}),(D||w)&&i.jsxs("div",{className:"px-4 pb-4 border-t border-gray-100",children:[i.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4 mb-4 text-sm",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("p",{className:"text-gray-500",children:["Note ID: ",i.jsx("span",{className:"text-gray-900 font-mono text-xs",children:P.id})]}),P.sf_content_note_id&&i.jsxs("p",{className:"text-gray-500",children:["Salesforce ID: ",i.jsx("span",{className:"text-gray-900 font-mono text-xs",children:P.sf_content_note_id})]}),i.jsxs("p",{className:"text-gray-500",children:["Created: ",i.jsx("span",{className:"text-gray-900",children:N(P.created_at)})]}),P.updated_at&&P.updated_at!==P.created_at&&i.jsxs("p",{className:"text-gray-500",children:["Updated: ",i.jsx("span",{className:"text-gray-900",children:N(P.updated_at)})]})]}),i.jsxs("div",{className:"space-y-1",children:[P.content_size&&i.jsxs("p",{className:"text-gray-500",children:["Size: ",i.jsxs("span",{className:"text-gray-900",children:[Math.round(P.content_size/1024),"KB"]})]}),P.share_type&&i.jsxs("p",{className:"text-gray-500",children:["Share Type: ",i.jsx("span",{className:"text-gray-900",children:P.share_type})]}),P.visibility&&i.jsxs("p",{className:"text-gray-500",children:["Visibility: ",i.jsx("span",{className:"text-gray-900",children:P.visibility})]})]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-md p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Content:"}),P.body&&P.body.length>500&&i.jsxs("span",{className:"text-xs text-gray-500",children:[P.body.length.toLocaleString()," characters"]})]}),i.jsx(g0,{content:P.body||"No content available",className:"text-sm",maxHeight:"max-h-none"})]})]})]},P.id)})}),T>1&&i.jsx("div",{className:"mt-6 flex items-center justify-center",children:i.jsxs("nav",{className:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination",children:[i.jsx("button",{onClick:()=>p(Math.max(1,b-1)),disabled:b===1,className:"relative inline-flex items-center rounded-l-md px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),i.jsxs("span",{className:"relative inline-flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300",children:["Page ",b," of ",T]}),i.jsx("button",{onClick:()=>p(Math.min(T,b+1)),disabled:b===T,className:"relative inline-flex items-center rounded-r-md px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})})]})};function Az(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(d){try{u(n.next(d))}catch(f){o(f)}}function c(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?a(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})}function $z(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var pm,Cv;function Fz(){return Cv||(Cv=1,pm=function e(t,r){if(t===r)return!0;if(t&&r&&typeof t=="object"&&typeof r=="object"){if(t.constructor!==r.constructor)return!1;var n,s,a;if(Array.isArray(t)){if(n=t.length,n!=r.length)return!1;for(s=n;s--!==0;)if(!e(t[s],r[s]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if(a=Object.keys(t),n=a.length,n!==Object.keys(r).length)return!1;for(s=n;s--!==0;)if(!Object.prototype.hasOwnProperty.call(r,a[s]))return!1;for(s=n;s--!==0;){var o=a[s];if(!e(t[o],r[o]))return!1}return!0}return t!==t&&r!==r}),pm}var Bz=Fz(),Uz=$z(Bz);const Ev="__googleMapsScriptId";var Ua;(function(e){e[e.INITIALIZED=0]="INITIALIZED",e[e.LOADING=1]="LOADING",e[e.SUCCESS=2]="SUCCESS",e[e.FAILURE=3]="FAILURE"})(Ua||(Ua={}));class zs{constructor({apiKey:t,authReferrerPolicy:r,channel:n,client:s,id:a=Ev,language:o,libraries:l=[],mapIds:c,nonce:u,region:d,retries:f=3,url:m="https://maps.googleapis.com/maps/api/js",version:h}){if(this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=t,this.authReferrerPolicy=r,this.channel=n,this.client=s,this.id=a||Ev,this.language=o,this.libraries=l,this.mapIds=c,this.nonce=u,this.region=d,this.retries=f,this.url=m,this.version=h,zs.instance){if(!Uz(this.options,zs.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(zs.instance.options)}`);return zs.instance}zs.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?Ua.FAILURE:this.done?Ua.SUCCESS:this.loading?Ua.LOADING:Ua.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let t=this.url;return t+="?callback=__googleMapsCallback&loading=async",this.apiKey&&(t+=`&key=${this.apiKey}`),this.channel&&(t+=`&channel=${this.channel}`),this.client&&(t+=`&client=${this.client}`),this.libraries.length>0&&(t+=`&libraries=${this.libraries.join(",")}`),this.language&&(t+=`&language=${this.language}`),this.region&&(t+=`&region=${this.region}`),this.version&&(t+=`&v=${this.version}`),this.mapIds&&(t+=`&map_ids=${this.mapIds.join(",")}`),this.authReferrerPolicy&&(t+=`&auth_referrer_policy=${this.authReferrerPolicy}`),t}deleteScript(){const t=document.getElementById(this.id);t&&t.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((t,r)=>{this.loadCallback(n=>{n?r(n.error):t(window.google)})})}importLibrary(t){return this.execute(),google.maps.importLibrary(t)}loadCallback(t){this.callbacks.push(t),this.execute()}setScript(){var t,r;if(document.getElementById(this.id)){this.callback();return}const n={key:this.apiKey,channel:this.channel,client:this.client,libraries:this.libraries.length&&this.libraries,v:this.version,mapIds:this.mapIds,language:this.language,region:this.region,authReferrerPolicy:this.authReferrerPolicy};Object.keys(n).forEach(a=>!n[a]&&delete n[a]),!((r=(t=window==null?void 0:window.google)===null||t===void 0?void 0:t.maps)===null||r===void 0)&&r.importLibrary||(a=>{let o,l,c,u="The Google Maps JavaScript API",d="google",f="importLibrary",m="__ib__",h=document,y=window;y=y[d]||(y[d]={});const v=y.maps||(y.maps={}),w=new Set,g=new URLSearchParams,b=()=>o||(o=new Promise((p,_)=>Az(this,void 0,void 0,function*(){var j;yield l=h.createElement("script"),l.id=this.id,g.set("libraries",[...w]+"");for(c in a)g.set(c.replace(/[A-Z]/g,k=>"_"+k[0].toLowerCase()),a[c]);g.set("callback",d+".maps."+m),l.src=this.url+"?"+g,v[m]=p,l.onerror=()=>o=_(Error(u+" could not load.")),l.nonce=this.nonce||((j=h.querySelector("script[nonce]"))===null||j===void 0?void 0:j.nonce)||"",h.head.append(l)})));v[f]?console.warn(u+" only loads once. Ignoring:",a):v[f]=(p,..._)=>w.add(p)&&b().then(()=>v[f](p,..._))})(n);const s=this.libraries.map(a=>this.importLibrary(a));s.length||s.push(this.importLibrary("core")),Promise.all(s).then(()=>this.callback(),a=>{const o=new ErrorEvent("error",{error:a});this.loadErrorCallback(o)})}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(t){if(this.errors.push(t),this.errors.length<=this.retries){const r=this.errors.length*Math.pow(2,this.errors.length);console.error(`Failed to load Google Maps script, retrying in ${r} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},r)}else this.onerrorEvent=t,this.callback()}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(t=>{t(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),!this.loading)if(this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version){console.warn("Google Maps already loaded outside @googlemaps/js-api-loader. This may result in undesirable behavior as options and script parameters may not match."),this.callback();return}this.loading=!0,this.setScript()}}}const MN=({height:e="400px",width:t="100%",className:r="",onMapLoad:n})=>{const s=x.useRef(null),a=x.useRef(null),[o,l]=x.useState(!0),[c,u]=x.useState(null),[d,f]=x.useState(null),m={lat:33.749,lng:-84.388},h=async()=>new Promise(y=>{if(!navigator.geolocation){console.log(" Geolocation not supported, using Atlanta fallback"),y(null);return}console.log(" Requesting user location..."),navigator.geolocation.getCurrentPosition(v=>{const w={lat:v.coords.latitude,lng:v.coords.longitude};console.log(" User location obtained:",w),y(w)},v=>{console.log(" Geolocation failed, using Atlanta fallback:",v.message,v.code),y(null)},{enableHighAccuracy:!1,timeout:5e3,maximumAge:3e5}),setTimeout(()=>{console.log(" Geolocation timeout, proceeding with Atlanta fallback"),y(null)},6e3)});return x.useEffect(()=>{let y=!0;const v=async()=>{if(!(!s.current||!y))try{console.log(" Starting map initialization..."),l(!0),u(null),console.log(" Getting user location...");const w=await h();if(!y)return;f(w),console.log(" Location result:",w);const g=w||m,b="AIzaSyAqmJMkoV2EfpB3rJn-4qyG-dMYwpMrLRw";console.log(" API Key configured:",b?`${b.substring(0,10)}...`:"MISSING");const p=new zs({apiKey:b,version:"weekly",libraries:["places","geometry"]});console.log(" Loading Google Maps API...");const _=await p.load();if(!y)return;if(console.log(" Google Maps API loaded successfully"),!s.current)throw new Error("Map container element not found");console.log(" Creating map instance...");const j=new _.maps.Map(s.current,{center:g,zoom:w?12:10,mapTypeId:_.maps.MapTypeId.ROADMAP,mapTypeControl:!0,streetViewControl:!0,fullscreenControl:!0,zoomControl:!0,gestureHandling:"greedy"}),k=new _.maps.Marker({position:g,map:j,title:w?"Your Location":"Atlanta, GA",icon:{url:"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent(`
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z" fill="${w?"#22c55e":"#3b82f6"}"/>
              </svg>
            `),scaledSize:new _.maps.Size(24,24),anchor:new _.maps.Point(12,24)}}),N=new _.maps.InfoWindow({content:`
            <div style="padding: 8px;">
              <h3 style="margin: 0 0 4px 0; font-size: 14px; color: #1f2937;">
                ${w?" Your Current Location":" Atlanta, GA"}
              </h3>
              <p style="margin: 0; font-size: 12px; color: #6b7280;">
                ${w?"Detected via browser geolocation":"Default map center"}
              </p>
              <p style="margin: 4px 0 0 0; font-size: 11px; color: #9ca3af;">
                Lat: ${g.lat.toFixed(6)}, Lng: ${g.lng.toFixed(6)}
              </p>
            </div>
          `});if(k.addListener("click",()=>{N.open(j,k)}),!y)return;a.current=j,n&&n(j),console.log(" Google Maps initialized successfully"),l(!1)}catch(w){if(!y)return;console.error(" Error initializing Google Maps:",w),u(w instanceof Error?w.message:"Failed to load map"),l(!1)}};return s.current&&v(),()=>{y=!1}},[]),x.useEffect(()=>{a.current&&n&&n(a.current)},[n]),x.useEffect(()=>()=>{a.current&&(a.current=null)},[]),c?i.jsx("div",{className:`flex items-center justify-center bg-red-50 border border-red-200 rounded-lg ${r}`,style:{height:e,width:t},children:i.jsxs("div",{className:"text-center p-4",children:[i.jsx("div",{className:"text-red-500 mb-2",children:i.jsx("svg",{className:"w-8 h-8 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),i.jsx("h3",{className:"text-sm font-medium text-red-800 mb-1",children:"Map Load Error"}),i.jsx("p",{className:"text-xs text-red-600",children:c}),i.jsx("button",{onClick:()=>window.location.reload(),className:"mt-2 text-xs text-red-700 hover:text-red-900 underline",children:"Reload Page"})]})}):i.jsxs("div",{className:`relative bg-gray-100 rounded-lg overflow-hidden ${r}`,style:{height:e,width:t},children:[o&&i.jsx("div",{className:"absolute inset-0 bg-gray-100 flex items-center justify-center z-10",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Loading map..."}),d&&i.jsx("p",{className:"text-xs text-green-600 mt-1",children:" Location detected"})]})}),i.jsx("div",{ref:s,className:"w-full h-full",style:{minHeight:"200px"}}),!o&&!c&&i.jsx("div",{className:"absolute top-2 right-2 bg-white bg-opacity-90 rounded-md px-2 py-1 text-xs text-gray-600 shadow",children:d?" Your Location":" Atlanta, GA"})]})};function zz(){const[e,t]=x.useState(!1),[r,n]=x.useState(!1),[s,a]=x.useState({total:0,successful:0,failed:0,processed:0,results:{successful:[],failed:[]}}),[o,l]=x.useState([]),c=x.useRef(!1),u=x.useRef(!1),d=x.useRef([]),f=x.useCallback(p=>{const j=`[${new Date().toLocaleTimeString()}] ${p}`;console.log(` Batch Geocoding: ${p}`),l(k=>[...k.slice(-49),j])},[]),m=x.useCallback(p=>{a(_=>{var j,k;return{..._,...p,results:{successful:((j=p.results)==null?void 0:j.successful)??_.results.successful,failed:((k=p.results)==null?void 0:k.failed)??_.results.failed}}})},[]),h=x.useCallback(async()=>{try{return(await an.getPropertiesNeedingGeocoding(1e3,$)).length}catch(p){return console.error("Error getting properties count:",p),0}},[]),y=x.useCallback(async(p=100)=>{if(!e)try{t(!0),n(!1),c.current=!1,u.current=!1,f(` Starting batch geocoding (limit: ${p})`);const _=await an.getPropertiesNeedingGeocoding(p,$);if(_.length===0){f(" No properties need geocoding - all done!"),t(!1);return}d.current=_,m({total:_.length,processed:0,successful:0,failed:0,results:{successful:[],failed:[]}}),f(` Found ${_.length} properties needing geocoding`);for(let j=0;j<_.length;j++){if(c.current){f(" Batch processing stopped by user");break}for(;u.current&&!c.current;)await new Promise(S=>setTimeout(S,1e3));if(c.current)break;const k=_[j],N=j+1;m({processed:N,currentAddress:`${k.address}, ${k.city||""}, ${k.state||""}`.trim()}),f(` (${N}/${_.length}) Geocoding: ${k.property_name||k.address}`);try{const S=an.buildAddressString(k.address,k.city,k.state,k.zip),C=await an.geocodeAddress(S);if("latitude"in C)if(await an.updatePropertyCoordinates(k.id,C,$,!1)){const T={property:k,coordinates:{lat:C.latitude,lng:C.longitude}};a(L=>({...L,successful:L.successful+1,results:{...L.results,successful:[...L.results.successful,T]}})),f(` Success: ${k.property_name||k.address} -> ${C.latitude.toFixed(6)}, ${C.longitude.toFixed(6)} (${C.provider})`)}else f(` Geocoded but failed to update database: ${k.property_name||k.address}`);else{const E={property:k,error:C.error};a(T=>({...T,failed:T.failed+1,results:{...T.results,failed:[...T.results.failed,E]}})),f(` Failed: ${k.property_name||k.address} - ${C.error}`)}}catch(S){const C=S instanceof Error?S.message:"Unknown error",E={property:k,error:C};a(T=>({...T,failed:T.failed+1,results:{...T.results,failed:[...T.results.failed,E]}})),f(` Error: ${k.property_name||k.address} - ${C}`)}}m({currentAddress:void 0}),setTimeout(()=>{a(j=>(f(` Batch complete: ${j.successful} successful, ${j.failed} failed out of ${j.total} total`),j))},100)}catch(_){const j=_ instanceof Error?_.message:"Batch processing failed";f(` Batch error: ${j}`),console.error("Batch geocoding error:",_)}finally{t(!1),n(!1),c.current=!1,u.current=!1}},[e,f,m,s]),v=x.useCallback(()=>{!e||r||(n(!0),u.current=!0,f(" Batch processing paused"))},[e,r,f]),w=x.useCallback(()=>{!e||!r||(n(!1),u.current=!1,f(" Batch processing resumed"))},[e,r,f]),g=x.useCallback(()=>{e&&(c.current=!0,u.current=!1,f(" Stopping batch processing..."))},[e,f]),b=x.useCallback(()=>{e||(a({total:0,successful:0,failed:0,processed:0,results:{successful:[],failed:[]}}),l([]),f(" Results cleared"))},[e,f]);return{isRunning:e,isPaused:r,progress:s,logs:o,startBatch:y,pauseBatch:v,resumeBatch:w,stopBatch:g,clearResults:b,refreshPropertiesCount:h}}const ON=({className:e=""})=>{const t=e.includes("compact"),{isRunning:r,isPaused:n,progress:s,logs:a,startBatch:o,pauseBatch:l,resumeBatch:c,stopBatch:u,clearResults:d,refreshPropertiesCount:f}=zz(),[m,h]=x.useState(50),[y,v]=x.useState(0),[w,g]=x.useState(!1);x.useEffect(()=>{(async()=>{const N=await f();v(N)})()},[f]),x.useEffect(()=>{!r&&s.processed>0&&(async()=>{const N=await f();v(N)})()},[r,s.processed,f]);const b=async()=>{await o(m)},p=()=>s.total===0?0:Math.round(s.processed/s.total*100),_=()=>r&&!n?"bg-blue-500":n?"bg-yellow-500":s.processed>0&&!r?"bg-green-500":"bg-gray-400",j=()=>r&&!n?"Running...":n?"Paused":s.processed>0&&!r?"Complete":"Ready";return i.jsxs("div",{className:`bg-white ${t?"":"rounded-lg border shadow-sm"} ${e}`,children:[i.jsx("div",{className:`${t?"px-3 py-2":"px-4 py-3"} border-b border-gray-200`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("h3",{className:`${t?"text-sm":"text-lg"} font-semibold text-gray-900`,children:" Batch Geocoding"}),i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx("div",{className:`w-2 h-2 rounded-full ${_()}`}),i.jsx("span",{className:`${t?"text-xs":"text-sm"} text-gray-600`,children:j()})]})]}),i.jsxs("div",{className:`${t?"text-xs":"text-sm"} text-gray-500`,children:[y," need geocoding"]})]})}),i.jsx("div",{className:`${t?"px-3 py-2":"px-4 py-3"} bg-gray-50 border-b border-gray-200`,children:i.jsxs("div",{className:`flex items-center ${t?"flex-col space-y-2":"justify-between"}`,children:[i.jsxs("div",{className:`flex items-center ${t?"space-x-2":"space-x-4"}`,children:[i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx("label",{className:`${t?"text-xs":"text-sm"} font-medium text-gray-700`,children:"Batch:"}),i.jsxs("select",{value:m,onChange:k=>h(Number(k.target.value)),disabled:r,className:`px-1 py-1 border border-gray-300 rounded ${t?"text-xs":"text-sm"} disabled:opacity-50`,children:[i.jsx("option",{value:10,children:"10 properties"}),i.jsx("option",{value:25,children:"25 properties"}),i.jsx("option",{value:50,children:"50 properties"}),i.jsx("option",{value:100,children:"100 properties"}),i.jsx("option",{value:250,children:"250 properties"}),i.jsx("option",{value:500,children:"500 properties"})]})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[!r&&i.jsx("button",{onClick:b,disabled:y===0,className:`${t?"px-2 py-1 text-xs":"px-3 py-1 text-sm"} bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed`,children:" Start"}),r&&!n&&i.jsx("button",{onClick:l,className:`${t?"px-2 py-1 text-xs":"px-3 py-1 text-sm"} bg-yellow-600 text-white rounded hover:bg-yellow-700`,children:" Pause"}),r&&n&&i.jsx("button",{onClick:c,className:`${t?"px-2 py-1 text-xs":"px-3 py-1 text-sm"} bg-green-600 text-white rounded hover:bg-green-700`,children:" Resume"}),r&&i.jsx("button",{onClick:u,className:`${t?"px-2 py-1 text-xs":"px-3 py-1 text-sm"} bg-red-600 text-white rounded hover:bg-red-700`,children:" Stop"}),!r&&s.processed>0&&i.jsx("button",{onClick:d,className:`${t?"px-2 py-1 text-xs":"px-3 py-1 text-sm"} bg-gray-600 text-white rounded hover:bg-gray-700`,children:" Clear"})]})]}),i.jsx("button",{onClick:()=>g(!w),className:`${t?"px-2 py-1 text-xs":"px-3 py-1 text-sm"} bg-gray-100 text-gray-700 rounded hover:bg-gray-200 border`,children:w?" Hide":" Logs"})]})}),s.total>0&&i.jsx("div",{className:`${t?"px-3 py-2":"px-4 py-3"} border-b border-gray-200`,children:i.jsxs("div",{className:`${t?"space-y-1":"space-y-2"}`,children:[i.jsxs("div",{className:`flex items-center justify-between ${t?"text-xs":"text-sm"}`,children:[i.jsxs("span",{className:"text-gray-600",children:[s.processed,"/",s.total," (",p(),"%)"]}),i.jsxs("span",{className:"text-gray-500",children:["",s.successful," ",s.failed]})]}),i.jsx("div",{className:`w-full bg-gray-200 rounded-full ${t?"h-1":"h-2"}`,children:i.jsx("div",{className:`bg-blue-600 ${t?"h-1":"h-2"} rounded-full transition-all duration-300`,style:{width:`${p()}%`}})}),s.currentAddress&&i.jsxs("div",{className:`${t?"text-xs":"text-sm"} text-gray-600`,children:[i.jsx("span",{className:"font-medium",children:"Current:"})," ",t?s.currentAddress.substring(0,40)+"...":s.currentAddress]})]})}),s.processed>0&&!r&&i.jsx("div",{className:"px-4 py-3 bg-green-50 border-b border-gray-200",children:i.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-2xl font-bold text-green-600",children:s.successful}),i.jsx("div",{className:"text-sm text-gray-600",children:"Successful"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-2xl font-bold text-red-600",children:s.failed}),i.jsx("div",{className:"text-sm text-gray-600",children:"Failed"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-2xl font-bold text-blue-600",children:s.total}),i.jsx("div",{className:"text-sm text-gray-600",children:"Total Processed"})]})]})}),w&&i.jsxs("div",{className:`${t?"px-3 py-2":"px-4 py-3"} bg-gray-50 ${t?"max-h-40":"max-h-64"} overflow-y-auto`,children:[i.jsxs("div",{className:"space-y-1",children:[a.length===0&&i.jsx("div",{className:`${t?"text-xs":"text-sm"} text-gray-500 italic`,children:"No logs yet..."}),a.map((k,N)=>i.jsx("div",{className:"text-xs font-mono text-gray-700 border-l-2 border-gray-300 pl-2",children:k},N))]}),a.length>0&&i.jsxs("div",{className:`${t?"mt-1":"mt-2"} text-xs text-gray-500`,children:["Latest ",a.length," entries"]})]})]})};var Wz=Object.getOwnPropertyNames,Hz=Object.getOwnPropertySymbols,qz=Object.prototype.hasOwnProperty;function Dv(e,t){return function(n,s,a){return e(n,s,a)&&t(n,s,a)}}function jc(e){return function(r,n,s){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,s);var a=s.cache,o=a.get(r),l=a.get(n);if(o&&l)return o===n&&l===r;a.set(r,n),a.set(n,r);var c=e(r,n,s);return a.delete(r),a.delete(n),c}}function Vz(e){return e!=null?e[Symbol.toStringTag]:void 0}function Pv(e){return Wz(e).concat(Hz(e))}var Yz=Object.hasOwn||function(e,t){return qz.call(e,t)};function ha(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var Gz="__v",Kz="__o",Qz="_owner",Tv=Object.getOwnPropertyDescriptor,Lv=Object.keys;function Jz(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function Xz(e,t){return ha(e.getTime(),t.getTime())}function Zz(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function eW(e,t){return e===t}function Iv(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var s=new Array(n),a=e.entries(),o,l,c=0;(o=a.next())&&!o.done;){for(var u=t.entries(),d=!1,f=0;(l=u.next())&&!l.done;){if(s[f]){f++;continue}var m=o.value,h=l.value;if(r.equals(m[0],h[0],c,f,e,t,r)&&r.equals(m[1],h[1],m[0],h[0],e,t,r)){d=s[f]=!0;break}f++}if(!d)return!1;c++}return!0}var tW=ha;function rW(e,t,r){var n=Lv(e),s=n.length;if(Lv(t).length!==s)return!1;for(;s-- >0;)if(!AN(e,t,r,n[s]))return!1;return!0}function co(e,t,r){var n=Pv(e),s=n.length;if(Pv(t).length!==s)return!1;for(var a,o,l;s-- >0;)if(a=n[s],!AN(e,t,r,a)||(o=Tv(e,a),l=Tv(t,a),(o||l)&&(!o||!l||o.configurable!==l.configurable||o.enumerable!==l.enumerable||o.writable!==l.writable)))return!1;return!0}function nW(e,t){return ha(e.valueOf(),t.valueOf())}function sW(e,t){return e.source===t.source&&e.flags===t.flags}function Rv(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var s=new Array(n),a=e.values(),o,l;(o=a.next())&&!o.done;){for(var c=t.values(),u=!1,d=0;(l=c.next())&&!l.done;){if(!s[d]&&r.equals(o.value,l.value,o.value,l.value,e,t,r)){u=s[d]=!0;break}d++}if(!u)return!1}return!0}function aW(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function iW(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function AN(e,t,r,n){return(n===Qz||n===Kz||n===Gz)&&(e.$$typeof||t.$$typeof)?!0:Yz(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}var oW="[object Arguments]",lW="[object Boolean]",cW="[object Date]",uW="[object Error]",dW="[object Map]",fW="[object Number]",mW="[object Object]",hW="[object RegExp]",pW="[object Set]",gW="[object String]",xW="[object URL]",yW=Array.isArray,Mv=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,Ov=Object.assign,bW=Object.prototype.toString.call.bind(Object.prototype.toString);function vW(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areErrorsEqual,s=e.areFunctionsEqual,a=e.areMapsEqual,o=e.areNumbersEqual,l=e.areObjectsEqual,c=e.arePrimitiveWrappersEqual,u=e.areRegExpsEqual,d=e.areSetsEqual,f=e.areTypedArraysEqual,m=e.areUrlsEqual,h=e.unknownTagComparators;return function(v,w,g){if(v===w)return!0;if(v==null||w==null)return!1;var b=typeof v;if(b!==typeof w)return!1;if(b!=="object")return b==="number"?o(v,w,g):b==="function"?s(v,w,g):!1;var p=v.constructor;if(p!==w.constructor)return!1;if(p===Object)return l(v,w,g);if(yW(v))return t(v,w,g);if(Mv!=null&&Mv(v))return f(v,w,g);if(p===Date)return r(v,w,g);if(p===RegExp)return u(v,w,g);if(p===Map)return a(v,w,g);if(p===Set)return d(v,w,g);var _=bW(v);if(_===cW)return r(v,w,g);if(_===hW)return u(v,w,g);if(_===dW)return a(v,w,g);if(_===pW)return d(v,w,g);if(_===mW)return typeof v.then!="function"&&typeof w.then!="function"&&l(v,w,g);if(_===xW)return m(v,w,g);if(_===uW)return n(v,w,g);if(_===oW)return l(v,w,g);if(_===lW||_===fW||_===gW)return c(v,w,g);if(h){var j=h[_];if(!j){var k=Vz(v);k&&(j=h[k])}if(j)return j(v,w,g)}return!1}}function wW(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,s={areArraysEqual:n?co:Jz,areDatesEqual:Xz,areErrorsEqual:Zz,areFunctionsEqual:eW,areMapsEqual:n?Dv(Iv,co):Iv,areNumbersEqual:tW,areObjectsEqual:n?co:rW,arePrimitiveWrappersEqual:nW,areRegExpsEqual:sW,areSetsEqual:n?Dv(Rv,co):Rv,areTypedArraysEqual:n?co:aW,areUrlsEqual:iW,unknownTagComparators:void 0};if(r&&(s=Ov({},s,r(s))),t){var a=jc(s.areArraysEqual),o=jc(s.areMapsEqual),l=jc(s.areObjectsEqual),c=jc(s.areSetsEqual);s=Ov({},s,{areArraysEqual:a,areMapsEqual:o,areObjectsEqual:l,areSetsEqual:c})}return s}function _W(e){return function(t,r,n,s,a,o,l){return e(t,r,l)}}function jW(e){var t=e.circular,r=e.comparator,n=e.createState,s=e.equals,a=e.strict;if(n)return function(c,u){var d=n(),f=d.cache,m=f===void 0?t?new WeakMap:void 0:f,h=d.meta;return r(c,u,{cache:m,equals:s,meta:h,strict:a})};if(t)return function(c,u){return r(c,u,{cache:new WeakMap,equals:s,meta:void 0,strict:a})};var o={cache:void 0,equals:s,meta:void 0,strict:a};return function(c,u){return r(c,u,o)}}var Av=Ss();Ss({strict:!0});Ss({circular:!0});Ss({circular:!0,strict:!0});Ss({createInternalComparator:function(){return ha}});Ss({strict:!0,createInternalComparator:function(){return ha}});Ss({circular:!0,createInternalComparator:function(){return ha}});Ss({circular:!0,createInternalComparator:function(){return ha},strict:!0});function Ss(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,s=e.createState,a=e.strict,o=a===void 0?!1:a,l=wW(e),c=vW(l),u=n?n(c):_W(c);return jW({circular:r,comparator:c,createState:s,equals:u,strict:o})}const $v=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],gm=1,uo=8;class y0{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[r,n]=new Uint8Array(t,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");const s=n>>4;if(s!==gm)throw new Error(`Got v${s} data when expected v${gm}.`);const a=$v[n&15];if(!a)throw new Error("Unrecognized array type.");const[o]=new Uint16Array(t,2,1),[l]=new Uint32Array(t,4,1);return new y0(l,o,a,t)}constructor(t,r=64,n=Float64Array,s){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=n,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const a=$v.indexOf(this.ArrayType),o=t*2*this.ArrayType.BYTES_PER_ELEMENT,l=t*this.IndexArrayType.BYTES_PER_ELEMENT,c=(8-l%8)%8;if(a<0)throw new Error(`Unexpected typed array class: ${n}.`);s&&s instanceof ArrayBuffer?(this.data=s,this.ids=new this.IndexArrayType(this.data,uo,t),this.coords=new this.ArrayType(this.data,uo+l+c,t*2),this._pos=t*2,this._finished=!0):(this.data=new ArrayBuffer(uo+o+l+c),this.ids=new this.IndexArrayType(this.data,uo,t),this.coords=new this.ArrayType(this.data,uo+l+c,t*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(gm<<4)+a]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=t)}add(t,r){const n=this._pos>>1;return this.ids[n]=n,this.coords[this._pos++]=t,this.coords[this._pos++]=r,n}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return Zh(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,r,n,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:a,coords:o,nodeSize:l}=this,c=[0,a.length-1,0],u=[];for(;c.length;){const d=c.pop()||0,f=c.pop()||0,m=c.pop()||0;if(f-m<=l){for(let w=m;w<=f;w++){const g=o[2*w],b=o[2*w+1];g>=t&&g<=n&&b>=r&&b<=s&&u.push(a[w])}continue}const h=m+f>>1,y=o[2*h],v=o[2*h+1];y>=t&&y<=n&&v>=r&&v<=s&&u.push(a[h]),(d===0?t<=y:r<=v)&&(c.push(m),c.push(h-1),c.push(1-d)),(d===0?n>=y:s>=v)&&(c.push(h+1),c.push(f),c.push(1-d))}return u}within(t,r,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:s,coords:a,nodeSize:o}=this,l=[0,s.length-1,0],c=[],u=n*n;for(;l.length;){const d=l.pop()||0,f=l.pop()||0,m=l.pop()||0;if(f-m<=o){for(let w=m;w<=f;w++)Fv(a[2*w],a[2*w+1],t,r)<=u&&c.push(s[w]);continue}const h=m+f>>1,y=a[2*h],v=a[2*h+1];Fv(y,v,t,r)<=u&&c.push(s[h]),(d===0?t-n<=y:r-n<=v)&&(l.push(m),l.push(h-1),l.push(1-d)),(d===0?t+n>=y:r+n>=v)&&(l.push(h+1),l.push(f),l.push(1-d))}return c}}function Zh(e,t,r,n,s,a){if(s-n<=r)return;const o=n+s>>1;$N(e,t,o,n,s,a),Zh(e,t,r,n,o-1,1-a),Zh(e,t,r,o+1,s,1-a)}function $N(e,t,r,n,s,a){for(;s>n;){if(s-n>600){const u=s-n+1,d=r-n+1,f=Math.log(u),m=.5*Math.exp(2*f/3),h=.5*Math.sqrt(f*m*(u-m)/u)*(d-u/2<0?-1:1),y=Math.max(n,Math.floor(r-d*m/u+h)),v=Math.min(s,Math.floor(r+(u-d)*m/u+h));$N(e,t,r,y,v,a)}const o=t[2*r+a];let l=n,c=s;for(fo(e,t,n,r),t[2*s+a]>o&&fo(e,t,n,s);l<c;){for(fo(e,t,l,c),l++,c--;t[2*l+a]<o;)l++;for(;t[2*c+a]>o;)c--}t[2*n+a]===o?fo(e,t,n,c):(c++,fo(e,t,c,s)),c<=r&&(n=c+1),r<=c&&(s=c-1)}}function fo(e,t,r,n){xm(e,r,n),xm(t,2*r,2*n),xm(t,2*r+1,2*n+1)}function xm(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function Fv(e,t,r,n){const s=e-r,a=t-n;return s*s+a*a}const kW={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:e=>e},Bv=Math.fround||(e=>t=>(e[0]=+t,e[0]))(new Float32Array(1)),Is=2,Jn=3,ym=4,Gn=5,FN=6;class NW{constructor(t){this.options=Object.assign(Object.create(kW),t),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(t){const{log:r,minZoom:n,maxZoom:s}=this.options;r&&console.time("total time");const a=`prepare ${t.length} points`;r&&console.time(a),this.points=t;const o=[];for(let c=0;c<t.length;c++){const u=t[c];if(!u.geometry)continue;const[d,f]=u.geometry.coordinates,m=Bv(kc(d)),h=Bv(Nc(f));o.push(m,h,1/0,c,-1,1),this.options.reduce&&o.push(0)}let l=this.trees[s+1]=this._createTree(o);r&&console.timeEnd(a);for(let c=s;c>=n;c--){const u=+Date.now();l=this.trees[c]=this._createTree(this._cluster(l,c)),r&&console.log("z%d: %d clusters in %dms",c,l.numItems,+Date.now()-u)}return r&&console.timeEnd("total time"),this}getClusters(t,r){let n=((t[0]+180)%360+360)%360-180;const s=Math.max(-90,Math.min(90,t[1]));let a=t[2]===180?180:((t[2]+180)%360+360)%360-180;const o=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)n=-180,a=180;else if(n>a){const f=this.getClusters([n,s,180,o],r),m=this.getClusters([-180,s,a,o],r);return f.concat(m)}const l=this.trees[this._limitZoom(r)],c=l.range(kc(n),Nc(o),kc(a),Nc(s)),u=l.data,d=[];for(const f of c){const m=this.stride*f;d.push(u[m+Gn]>1?Uv(u,m,this.clusterProps):this.points[u[m+Jn]])}return d}getChildren(t){const r=this._getOriginId(t),n=this._getOriginZoom(t),s="No cluster with the specified id.",a=this.trees[n];if(!a)throw new Error(s);const o=a.data;if(r*this.stride>=o.length)throw new Error(s);const l=this.options.radius/(this.options.extent*Math.pow(2,n-1)),c=o[r*this.stride],u=o[r*this.stride+1],d=a.within(c,u,l),f=[];for(const m of d){const h=m*this.stride;o[h+ym]===t&&f.push(o[h+Gn]>1?Uv(o,h,this.clusterProps):this.points[o[h+Jn]])}if(f.length===0)throw new Error(s);return f}getLeaves(t,r,n){r=r||10,n=n||0;const s=[];return this._appendLeaves(s,t,r,n,0),s}getTile(t,r,n){const s=this.trees[this._limitZoom(t)],a=Math.pow(2,t),{extent:o,radius:l}=this.options,c=l/o,u=(n-c)/a,d=(n+1+c)/a,f={features:[]};return this._addTileFeatures(s.range((r-c)/a,u,(r+1+c)/a,d),s.data,r,n,a,f),r===0&&this._addTileFeatures(s.range(1-c/a,u,1,d),s.data,a,n,a,f),r===a-1&&this._addTileFeatures(s.range(0,u,c/a,d),s.data,-1,n,a,f),f.features.length?f:null}getClusterExpansionZoom(t){let r=this._getOriginZoom(t)-1;for(;r<=this.options.maxZoom;){const n=this.getChildren(t);if(r++,n.length!==1)break;t=n[0].properties.cluster_id}return r}_appendLeaves(t,r,n,s,a){const o=this.getChildren(r);for(const l of o){const c=l.properties;if(c&&c.cluster?a+c.point_count<=s?a+=c.point_count:a=this._appendLeaves(t,c.cluster_id,n,s,a):a<s?a++:t.push(l),t.length===n)break}return a}_createTree(t){const r=new y0(t.length/this.stride|0,this.options.nodeSize,Float32Array);for(let n=0;n<t.length;n+=this.stride)r.add(t[n],t[n+1]);return r.finish(),r.data=t,r}_addTileFeatures(t,r,n,s,a,o){for(const l of t){const c=l*this.stride,u=r[c+Gn]>1;let d,f,m;if(u)d=BN(r,c,this.clusterProps),f=r[c],m=r[c+1];else{const v=this.points[r[c+Jn]];d=v.properties;const[w,g]=v.geometry.coordinates;f=kc(w),m=Nc(g)}const h={type:1,geometry:[[Math.round(this.options.extent*(f*a-n)),Math.round(this.options.extent*(m*a-s))]],tags:d};let y;u||this.options.generateId?y=r[c+Jn]:y=this.points[r[c+Jn]].id,y!==void 0&&(h.id=y),o.features.push(h)}}_limitZoom(t){return Math.max(this.options.minZoom,Math.min(Math.floor(+t),this.options.maxZoom+1))}_cluster(t,r){const{radius:n,extent:s,reduce:a,minPoints:o}=this.options,l=n/(s*Math.pow(2,r)),c=t.data,u=[],d=this.stride;for(let f=0;f<c.length;f+=d){if(c[f+Is]<=r)continue;c[f+Is]=r;const m=c[f],h=c[f+1],y=t.within(c[f],c[f+1],l),v=c[f+Gn];let w=v;for(const g of y){const b=g*d;c[b+Is]>r&&(w+=c[b+Gn])}if(w>v&&w>=o){let g=m*v,b=h*v,p,_=-1;const j=((f/d|0)<<5)+(r+1)+this.points.length;for(const k of y){const N=k*d;if(c[N+Is]<=r)continue;c[N+Is]=r;const S=c[N+Gn];g+=c[N]*S,b+=c[N+1]*S,c[N+ym]=j,a&&(p||(p=this._map(c,f,!0),_=this.clusterProps.length,this.clusterProps.push(p)),a(p,this._map(c,N)))}c[f+ym]=j,u.push(g/w,b/w,1/0,j,-1,w),a&&u.push(_)}else{for(let g=0;g<d;g++)u.push(c[f+g]);if(w>1)for(const g of y){const b=g*d;if(!(c[b+Is]<=r)){c[b+Is]=r;for(let p=0;p<d;p++)u.push(c[b+p])}}}}return u}_getOriginId(t){return t-this.points.length>>5}_getOriginZoom(t){return(t-this.points.length)%32}_map(t,r,n){if(t[r+Gn]>1){const o=this.clusterProps[t[r+FN]];return n?Object.assign({},o):o}const s=this.points[t[r+Jn]].properties,a=this.options.map(s);return n&&a===s?Object.assign({},a):a}}function Uv(e,t,r){return{type:"Feature",id:e[t+Jn],properties:BN(e,t,r),geometry:{type:"Point",coordinates:[SW(e[t]),CW(e[t+1])]}}}function BN(e,t,r){const n=e[t+Gn],s=n>=1e4?`${Math.round(n/1e3)}k`:n>=1e3?`${Math.round(n/100)/10}k`:n,a=e[t+FN],o=a===-1?{}:Object.assign({},r[a]);return Object.assign(o,{cluster:!0,cluster_id:e[t+Jn],point_count:n,point_count_abbreviated:s})}function kc(e){return e/360+.5}function Nc(e){const t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function SW(e){return(e-.5)*360}function CW(e){const t=(180-e*360)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}function EW(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r}class Wt{static isAdvancedMarkerAvailable(t){return google.maps.marker&&t.getMapCapabilities().isAdvancedMarkersAvailable===!0}static isAdvancedMarker(t){return google.maps.marker&&t instanceof google.maps.marker.AdvancedMarkerElement}static setMap(t,r){this.isAdvancedMarker(t)?t.map=r:t.setMap(r)}static getPosition(t){if(this.isAdvancedMarker(t)){if(t.position){if(t.position instanceof google.maps.LatLng)return t.position;if(Number.isFinite(t.position.lat)&&Number.isFinite(t.position.lng))return new google.maps.LatLng(t.position.lat,t.position.lng)}return new google.maps.LatLng(null)}return t.getPosition()}static getVisible(t){return this.isAdvancedMarker(t)?!0:t.getVisible()}}class ep{constructor({markers:t,position:r}){this.markers=[],t&&(this.markers=t),r&&(r instanceof google.maps.LatLng?this._position=r:this._position=new google.maps.LatLng(r))}get bounds(){if(this.markers.length===0&&!this._position)return;const t=new google.maps.LatLngBounds(this._position,this._position);for(const r of this.markers)t.extend(Wt.getPosition(r));return t}get position(){return this._position||this.bounds.getCenter()}get count(){return this.markers.filter(t=>Wt.getVisible(t)).length}push(t){this.markers.push(t)}delete(){this.marker&&(Wt.setMap(this.marker,null),this.marker=void 0),this.markers.length=0}}function tp(e,t="assertion failed"){if(e==null)throw Error(t)}class DW{constructor({maxZoom:t=16}){this.maxZoom=t}noop({markers:t}){return PW(t)}}const PW=e=>e.map(r=>new ep({position:Wt.getPosition(r),markers:[r]}));class TW extends DW{constructor(t){var{maxZoom:r,radius:n=60}=t,s=EW(t,["maxZoom","radius"]);super({maxZoom:r}),this.markers=[],this.clusters=[],this.state={zoom:-1},this.superCluster=new NW(Object.assign({maxZoom:this.maxZoom,radius:n},s))}calculate(t){let r=!1,n=t.map.getZoom();tp(n),n=Math.round(n);const s={zoom:n};if(!Av(t.markers,this.markers)){r=!0,this.markers=[...t.markers];const a=this.markers.map(o=>{const l=Wt.getPosition(o);return{type:"Feature",geometry:{type:"Point",coordinates:[l.lng(),l.lat()]},properties:{marker:o}}});this.superCluster.load(a)}return r||(this.state.zoom<=this.maxZoom||s.zoom<=this.maxZoom)&&(r=!Av(this.state,s)),this.state=s,t.markers.length===0?(this.clusters=[],{clusters:this.clusters,changed:r}):(r&&(this.clusters=this.cluster(t)),{clusters:this.clusters,changed:r})}cluster({map:t}){const r=t.getZoom();return tp(r),this.superCluster.getClusters([-180,-90,180,90],Math.round(r)).map(n=>this.transformCluster(n))}transformCluster({geometry:{coordinates:[t,r]},properties:n}){if(n.cluster)return new ep({markers:this.superCluster.getLeaves(n.cluster_id,1/0).map(a=>a.properties.marker),position:{lat:r,lng:t}});const s=n.marker;return new ep({markers:[s],position:Wt.getPosition(s)})}}class LW{constructor(t,r){this.markers={sum:t.length};const n=r.map(a=>a.count),s=n.reduce((a,o)=>a+o,0);this.clusters={count:r.length,markers:{mean:s/r.length,sum:s,min:Math.min(...n),max:Math.max(...n)}}}}class IW{render({count:t,position:r},n,s){const o=`<svg fill="${t>Math.max(10,n.clusters.markers.mean)?"#ff0000":"#0000ff"}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240" width="50" height="50">
<circle cx="120" cy="120" opacity=".6" r="70" />
<circle cx="120" cy="120" opacity=".3" r="90" />
<circle cx="120" cy="120" opacity=".2" r="110" />
<text x="50%" y="50%" style="fill:#fff" text-anchor="middle" font-size="50" dominant-baseline="middle" font-family="roboto,arial,sans-serif">${t}</text>
</svg>`,l=`Cluster of ${t} markers`,c=Number(google.maps.Marker.MAX_ZINDEX)+t;if(Wt.isAdvancedMarkerAvailable(s)){const f=new DOMParser().parseFromString(o,"image/svg+xml").documentElement;f.setAttribute("transform","translate(0 25)");const m={map:s,position:r,zIndex:c,title:l,content:f};return new google.maps.marker.AdvancedMarkerElement(m)}const u={position:r,zIndex:c,title:l,icon:{url:`data:image/svg+xml;base64,${btoa(o)}`,anchor:new google.maps.Point(25,25)}};return new google.maps.Marker(u)}}function RW(e,t){for(let r in t.prototype)e.prototype[r]=t.prototype[r]}class b0{constructor(){RW(b0,google.maps.OverlayView)}}var Ws;(function(e){e.CLUSTERING_BEGIN="clusteringbegin",e.CLUSTERING_END="clusteringend",e.CLUSTER_CLICK="click",e.GMP_CLICK="gmp-click"})(Ws||(Ws={}));const MW=(e,t,r)=>{t.bounds&&r.fitBounds(t.bounds)};class UN extends b0{constructor({map:t,markers:r=[],algorithmOptions:n={},algorithm:s=new TW(n),renderer:a=new IW,onClusterClick:o=MW}){super(),this.map=null,this.idleListener=null,this.markers=[...r],this.clusters=[],this.algorithm=s,this.renderer=a,this.onClusterClick=o,t&&this.setMap(t)}addMarker(t,r){this.markers.includes(t)||(this.markers.push(t),r||this.render())}addMarkers(t,r){t.forEach(n=>{this.addMarker(n,!0)}),r||this.render()}removeMarker(t,r){const n=this.markers.indexOf(t);return n===-1?!1:(Wt.setMap(t,null),this.markers.splice(n,1),r||this.render(),!0)}removeMarkers(t,r){let n=!1;return t.forEach(s=>{n=this.removeMarker(s,!0)||n}),n&&!r&&this.render(),n}clearMarkers(t){this.markers.length=0,t||this.render()}render(){const t=this.getMap();if(t instanceof google.maps.Map&&t.getProjection()){google.maps.event.trigger(this,Ws.CLUSTERING_BEGIN,this);const{clusters:r,changed:n}=this.algorithm.calculate({markers:this.markers,map:t,mapCanvasProjection:this.getProjection()});if(n||n==null){const s=new Set;for(const o of r)o.markers.length==1&&s.add(o.markers[0]);const a=[];for(const o of this.clusters)o.marker!=null&&(o.markers.length==1?s.has(o.marker)||Wt.setMap(o.marker,null):a.push(o.marker));this.clusters=r,this.renderClusters(),requestAnimationFrame(()=>a.forEach(o=>Wt.setMap(o,null)))}google.maps.event.trigger(this,Ws.CLUSTERING_END,this)}}onAdd(){const t=this.getMap();tp(t),this.idleListener=t.addListener("idle",this.render.bind(this)),this.render()}onRemove(){this.idleListener&&google.maps.event.removeListener(this.idleListener),this.reset()}reset(){this.markers.forEach(t=>Wt.setMap(t,null)),this.clusters.forEach(t=>t.delete()),this.clusters=[]}renderClusters(){const t=new LW(this.markers,this.clusters),r=this.getMap();this.clusters.forEach(n=>{if(n.markers.length===1)n.marker=n.markers[0];else if(n.marker=this.renderer.render(n,t,r),n.markers.forEach(s=>Wt.setMap(s,null)),this.onClusterClick){const s=Wt.isAdvancedMarker(n.marker)?Ws.GMP_CLICK:Ws.CLUSTER_CLICK;n.marker.addListener(s,a=>{google.maps.event.trigger(this,Ws.CLUSTER_CLICK,n),this.onClusterClick(a,n,r)})}Wt.setMap(n.marker,r)})}}const zN=({map:e,isVisible:t,loadingConfig:r,onPropertiesLoaded:n})=>{const[s,a]=x.useState([]),[o,l]=x.useState([]),[c,u]=x.useState(null),[d,f]=x.useState(!1),[m,h]=x.useState(null),y=p=>p.verified_latitude&&p.verified_longitude?{lat:p.verified_latitude,lng:p.verified_longitude,verified:!0}:p.latitude&&p.longitude?{lat:p.latitude,lng:p.longitude,verified:!1}:null,v=async()=>{if(e){f(!0),h(null);try{console.log(` Fetching properties (mode: ${r.mode})...`);let p=$.from("property").select(`
          id,
          property_name,
          address,
          city,
          state,
          zip,
          latitude,
          longitude,
          verified_latitude,
          verified_longitude
        `).or("and(latitude.not.is.null,longitude.not.is.null),and(verified_latitude.not.is.null,verified_longitude.not.is.null)");switch(r.mode){case"static-1000":p=p.limit(1e3);break;case"static-2000":p=p.limit(2e3);break;case"static-all":console.log(" static-all: Using pagination to fetch all properties...");const N=[];let S=0;const C=1e3;let E=!0;for(;E;){console.log(` Fetching page starting at ${S}...`);const O=$.from("property").select(`
                id,
                property_name,
                address,
                city,
                state,
                zip,
                latitude,
                longitude,
                verified_latitude,
                verified_longitude
              `).or("and(latitude.not.is.null,longitude.not.is.null),and(verified_latitude.not.is.null,verified_longitude.not.is.null)").range(S,S+C-1).order("id"),{data:A,error:M}=await O;if(M)throw M;A&&A.length>0?(N.push(...A),console.log(` Fetched ${A.length} properties (total so far: ${N.length})`),A.length<C?E=!1:S+=C):E=!1}console.log(` Pagination complete: ${N.length} total properties fetched`);const T=N.filter(O=>y(O)!==null);console.log(` Found ${T.length} properties with coordinates (static-all via pagination)`),a(T),n==null||n(T.length),f(!1);return;case"bounds-based":const L=e.getBounds();if(L){const O=L.getNorthEast(),A=L.getSouthWest();p=p.gte("latitude",A.lat()).lte("latitude",O.lat()).gte("longitude",A.lng()).lte("longitude",O.lng()).limit(500),console.log(` Loading properties in bounds: ${A.lat().toFixed(4)},${A.lng().toFixed(4)} to ${O.lat().toFixed(4)},${O.lng().toFixed(4)}`)}break}const{data:_,error:j}=await p;if(j)throw j;const k=(_||[]).filter(N=>y(N)!==null);console.log(` Found ${k.length} properties with coordinates (${r.mode})`),a(k),n==null||n(k.length)}catch(p){console.error("Error fetching properties:",p),h(p instanceof Error?p.message:"Failed to fetch properties")}finally{f(!1)}}},w=()=>{if(!e||!s.length)return;console.log(" Creating markers for properties..."),o.forEach(_=>_.setMap(null));const p=s.map(_=>{const j=y(_);if(!j)return null;const k=`
        <div class="p-3 max-w-sm">
          <h3 class="font-semibold text-lg text-gray-900 mb-2">
            ${_.property_name||"Property"}
          </h3>
          <div class="space-y-1 text-sm text-gray-600">
            <div><strong>Address:</strong> ${_.address}</div>
            ${_.city?`<div><strong>City:</strong> ${_.city}</div>`:""}
            ${_.state?`<div><strong>State:</strong> ${_.state}</div>`:""}
            ${_.zip?`<div><strong>ZIP:</strong> ${_.zip}</div>`:""}
            <div><strong>Coordinates:</strong> ${j.lat.toFixed(6)}, ${j.lng.toFixed(6)}</div>
            <div class="text-xs ${j.verified?"text-green-600":"text-blue-600"}">
              ${j.verified?" Verified Location":" Geocoded Location"}
            </div>
          </div>
        </div>
      `,N=new google.maps.InfoWindow({content:k}),S=new google.maps.Marker({position:{lat:j.lat,lng:j.lng},map:null,title:_.property_name||_.address,icon:{url:j.verified?"https://maps.google.com/mapfiles/ms/icons/green-dot.png":"https://maps.google.com/mapfiles/ms/icons/blue-dot.png",scaledSize:new google.maps.Size(32,32),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(16,32)}});return S.addListener("click",()=>{N.open(e,S)}),S}).filter(_=>_!==null);console.log(` Created ${p.length} markers`),l(p)},g=()=>{if(!e||!o.length)return;c&&c.clearMarkers(),console.log(" Setting up marker clustering...");const p=new UN({map:e,markers:[],gridSize:60,maxZoom:15,averageCenter:!0,minimumClusterSize:2});u(p),console.log(" Clustering initialized")},b=()=>{c&&(t?(console.log(` Showing ${o.length} property markers`),c.addMarkers(o)):(console.log(" Hiding property markers"),c.clearMarkers()))};return x.useEffect(()=>{e&&v()},[e,r]),x.useEffect(()=>{if(!e||r.mode!=="bounds-based")return;const p=()=>{setTimeout(()=>{v()},500)},_=e.addListener("bounds_changed",p);return()=>{google.maps.event.removeListener(_)}},[e,r.mode]),x.useEffect(()=>{s.length>0&&w()},[s,e]),x.useEffect(()=>{o.length>0&&g()},[o,e]),x.useEffect(()=>{b()},[t,c,o]),x.useEffect(()=>()=>{c&&c.clearMarkers(),o.forEach(p=>p.setMap(null))},[]),m&&console.error("PropertyLayer Error:",m),d&&console.log(" Loading properties..."),null},zv={New:"https://maps.google.com/mapfiles/ms/icons/blue-dot.png","In Progress":"https://maps.google.com/mapfiles/ms/icons/orange-dot.png","Under Review":"https://maps.google.com/mapfiles/ms/icons/yellow-dot.png",Approved:"https://maps.google.com/mapfiles/ms/icons/green-dot.png",Rejected:"https://maps.google.com/mapfiles/ms/icons/red-dot.png","On Hold":"https://maps.google.com/mapfiles/ms/icons/purple-dot.png",Cancelled:"https://maps.google.com/mapfiles/ms/icons/ltblue-dot.png"},Sc="https://maps.google.com/mapfiles/ms/icons/blue-dot.png",WN=({map:e,isVisible:t,loadingConfig:r,onSiteSubmitsLoaded:n})=>{const[s,a]=x.useState([]),[o,l]=x.useState([]),[c,u]=x.useState(null),[d,f]=x.useState(!1),[m,h]=x.useState(null),y=_=>_.verified_latitude&&_.verified_longitude?{lat:_.verified_latitude,lng:_.verified_longitude,verified:!0}:_.sf_property_latitude&&_.sf_property_longitude?{lat:_.sf_property_latitude,lng:_.sf_property_longitude,verified:!1}:null,v=(_,j)=>{var k,N;return j?(k=_.submit_stage)!=null&&k.name&&zv[_.submit_stage.name]||Sc:(N=_.submit_stage)!=null&&N.name&&zv[_.submit_stage.name]||Sc},w=async()=>{if(e){f(!0),h(null);try{console.log(` Fetching site submits (mode: ${r.mode})...`),console.log(" Testing basic site_submit table access...");const{data:_,error:j,count:k}=await $.from("site_submit").select("id, site_submit_name, sf_property_latitude, sf_property_longitude",{count:"exact"}).limit(5);if(j)throw console.error(" Basic site_submit query failed:",j),new Error(`Basic query failed: ${j.message}`);console.log(" Basic site_submit query succeeded:",_),console.log(` Found ${(_==null?void 0:_.length)||0} site submit records in basic query (total count: ${k})`);const{data:N,error:S}=await $.from("site_submit").select("id, site_submit_name, sf_property_latitude, sf_property_longitude, verified_latitude, verified_longitude").or("and(sf_property_latitude.not.is.null,sf_property_longitude.not.is.null),and(verified_latitude.not.is.null,verified_longitude.not.is.null)").limit(10);if(S)throw console.error(" Coordinate query failed:",S),new Error(`Coordinate query failed: ${S.message}`);console.log(" Coordinate query succeeded:",N),console.log(` Found ${(N==null?void 0:N.length)||0} site submits with coordinates`);let C=$.from("site_submit").select(`
          id,
          site_submit_name,
          client_id,
          property_id,
          submit_stage_id,
          sf_property_latitude,
          sf_property_longitude,
          verified_latitude,
          verified_longitude,
          notes,
          year_1_rent,
          ti,
          client!site_submit_client_id_fkey (
            id,
            client_name
          ),
          submit_stage!site_submit_submit_stage_id_fkey (
            id,
            name
          ),
          property!site_submit_property_id_fkey (
            id,
            property_name,
            address
          )
        `).or("and(sf_property_latitude.not.is.null,sf_property_longitude.not.is.null),and(verified_latitude.not.is.null,verified_longitude.not.is.null)");switch(console.log(" Using correct foreign key syntax..."),r.mode){case"static-100":C=C.limit(100);break;case"static-500":C=C.limit(500);break;case"client-filtered":r.clientId&&(console.log(` Filtering by client: ${r.clientId}`),C=C.eq("client_id",r.clientId));break;case"static-all":console.log(" static-all: Using pagination to fetch all site submits...");const O=[];let A=0;const M=1e3;let B=!0;for(;B;){console.log(` Fetching page starting at ${A}...`);const R=$.from("site_submit").select(`
                id,
                site_submit_name,
                client_id,
                property_id,
                submit_stage_id,
                sf_property_latitude,
                sf_property_longitude,
                verified_latitude,
                verified_longitude,
                notes,
                year_1_rent,
                ti,
                client!site_submit_client_id_fkey (
                  id,
                  client_name
                ),
                submit_stage!site_submit_submit_stage_id_fkey (
                  id,
                  name
                ),
                property!site_submit_property_id_fkey (
                  id,
                  property_name,
                  address
                )
              `).or("and(sf_property_latitude.not.is.null,sf_property_longitude.not.is.null),and(verified_latitude.not.is.null,verified_longitude.not.is.null)").range(A,A+M-1).order("id"),{data:P,error:D}=await R;if(D)throw D;P&&P.length>0?(O.push(...P),console.log(` Fetched ${P.length} site submits (total so far: ${O.length})`),P.length<M?B=!1:A+=M):B=!1}console.log(` Pagination complete: ${O.length} total site submits fetched`);const F=O.filter(R=>y(R)!==null);console.log(` Found ${F.length} site submits with coordinates (static-all via pagination)`),a(F),n==null||n(F.length),f(!1);return}const{data:E,error:T}=await C.order("site_submit_name");if(T)throw T;const L=(E||[]).filter(O=>y(O)!==null);console.log(` Found ${L.length} site submits with coordinates (${r.mode})`),a(L),n==null||n(L.length)}catch(_){console.error(" Error fetching site submits:",_),console.error(" Error details:",JSON.stringify(_,null,2)),h(_ instanceof Error?_.message:"Failed to fetch site submits")}finally{f(!1)}}},g=()=>{if(!e||!s.length)return;console.log(" Creating markers for site submits..."),o.forEach(j=>j.setMap(null));const _=s.map(j=>{var T;const k=y(j);if(!k)return null;const N=v(j,k.verified),S=`
        <div class="p-3 max-w-sm">
          <h3 class="font-semibold text-lg text-gray-900 mb-2">
            ${j.site_submit_name||"Site Submit"}
          </h3>
          <div class="space-y-1 text-sm text-gray-600">
            ${j.client?`<div><strong>Client:</strong> ${j.client.client_name}</div>`:j.client_id?`<div><strong>Client ID:</strong> ${j.client_id}</div>`:""}
            ${j.submit_stage?`<div><strong>Stage:</strong> ${j.submit_stage.name}</div>`:j.submit_stage_id?`<div><strong>Stage ID:</strong> ${j.submit_stage_id}</div>`:""}
            ${j.property?`<div><strong>Property:</strong> ${j.property.property_name||"N/A"}</div>`:j.property_id?`<div><strong>Property ID:</strong> ${j.property_id}</div>`:""}
            <div><strong>Coordinates:</strong> ${k.lat.toFixed(6)}, ${k.lng.toFixed(6)}</div>
            ${j.year_1_rent?`<div><strong>Year 1 Rent:</strong> $${j.year_1_rent.toLocaleString()}</div>`:""}
            ${j.ti?`<div><strong>TI:</strong> $${j.ti.toLocaleString()}</div>`:""}
            <div class="text-xs ${k.verified?"text-green-600":"text-blue-600"}">
              ${k.verified?" Verified Location":" Property Location"}
            </div>
            ${j.notes?`<div class="mt-2 p-2 bg-gray-50 rounded text-xs"><strong>Notes:</strong> ${j.notes}</div>`:""}
          </div>
        </div>
      `,C=new google.maps.InfoWindow({content:S}),E=new google.maps.Marker({position:{lat:k.lat,lng:k.lng},map:null,title:j.site_submit_name||`Site Submit - ${(T=j.client)==null?void 0:T.client_name}`,icon:{url:N,scaledSize:new google.maps.Size(32,32),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(16,32)}});return E.addListener("click",()=>{C.open(e,E)}),E}).filter(j=>j!==null);console.log(` Created ${_.length} site submit markers`),l(_)},b=()=>{if(!e||!o.length)return;c&&c.clearMarkers(),console.log(" Setting up site submit marker clustering...");const _=new UN({map:e,markers:[],gridSize:60,maxZoom:15,averageCenter:!0,minimumClusterSize:2});u(_),console.log(" Site submit clustering initialized")},p=()=>{c&&(t?(console.log(` Showing ${o.length} site submit markers`),c.addMarkers(o)):(console.log(" Hiding site submit markers"),c.clearMarkers()))};return x.useEffect(()=>{e&&w()},[e,r]),x.useEffect(()=>{s.length>0&&g()},[s,e]),x.useEffect(()=>{o.length>0&&b()},[o,e]),x.useEffect(()=>{p()},[t,c,o]),x.useEffect(()=>()=>{c&&c.clearMarkers(),o.forEach(_=>_.setMap(null))},[]),m&&console.error("SiteSubmitLayer Error:",m),d&&console.log(" Loading site submits..."),null},OW=()=>{var M,B;const[e,t]=x.useState(null),[r,n]=x.useState("1600 Amphitheatre Parkway, Mountain View, CA"),[s,a]=x.useState(""),[o,l]=x.useState(!1),[c,u]=x.useState(!1),[d,f]=x.useState(!1),[m,h]=x.useState(!1),[y,v]=x.useState(0),[w,g]=x.useState({mode:"static-all"}),[b,p]=x.useState(!1),[_,j]=x.useState(0),[k,N]=x.useState({mode:"static-100"}),[S,C]=x.useState([]),[E,T]=x.useState(null),L=F=>{t(F),console.log("Map loaded successfully:",F)};x.useEffect(()=>{(async()=>{try{const{data:R,error:P}=await $.from("client").select("id, client_name").order("client_name");if(P)throw P;C(R||[])}catch(R){console.error("Error loading clients:",R)}})()},[]);const O=F=>{T(F),N({mode:F?"client-filtered":"static-100",clientId:F})},A=async()=>{if(r.trim()){l(!0),a("Testing geocoding...");try{console.log(" Testing enhanced geocoding service...");const F=await an.geocodeAddress(r);"latitude"in F?a(` Success (${F.provider}):
         ${F.latitude.toFixed(6)}, ${F.longitude.toFixed(6)}
         ${F.formatted_address}
         City: ${F.city||"N/A"}
         State: ${F.state||"N/A"}
         ZIP: ${F.zip||"N/A"}`):a(` Error: ${F.error} (${F.code})`)}catch(F){a(` Exception: ${F instanceof Error?F.message:"Unknown error"}`)}finally{l(!1)}}};return i.jsx("div",{className:"h-screen w-screen bg-gray-50 overflow-hidden",children:i.jsxs("div",{className:"h-full flex",children:[c&&i.jsxs("div",{className:"w-80 flex-shrink-0 bg-white border-r border-gray-200 flex flex-col shadow-lg",children:[i.jsx("div",{className:"flex-shrink-0 px-3 py-2 bg-white border-b border-gray-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h1",{className:"text-sm font-semibold text-gray-900",children:" Admin: Batch Geocoding"}),i.jsx("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-600 p-1",title:"Close panel",children:""})]})}),i.jsx("div",{className:"flex-1 overflow-y-auto",children:i.jsx(ON,{className:"compact"})})]}),i.jsxs("div",{className:"flex-1 flex flex-col",children:[i.jsx("div",{className:"flex-shrink-0 bg-white shadow-sm border-b border-gray-200 px-4 py-3",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Interactive Map"}),i.jsx("div",{className:"text-sm text-gray-500",children:"Google API + OSM Fallback"})]}),i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx("div",{className:"text-sm text-gray-600",children:"Centers on your location or Atlanta, GA"}),i.jsxs("button",{onClick:()=>h(!m),className:`px-3 py-1 text-sm rounded border flex items-center space-x-2 transition-colors ${m?"bg-green-100 hover:bg-green-200 text-green-700 border-green-300":"bg-gray-100 hover:bg-gray-200 text-gray-700 border-gray-300"}`,children:[i.jsx("span",{children:m?"":""}),i.jsxs("span",{children:["Properties (",y,")"]})]}),i.jsxs("button",{onClick:()=>p(!b),className:`px-3 py-1 text-sm rounded border flex items-center space-x-2 transition-colors ${b?"bg-blue-100 hover:bg-blue-200 text-blue-700 border-blue-300":"bg-gray-100 hover:bg-gray-200 text-gray-700 border-gray-300"}`,children:[i.jsx("span",{children:b?"":""}),i.jsxs("span",{children:["Site Submits (",_,")"]})]}),i.jsxs("div",{className:"relative",children:[i.jsxs("button",{onClick:()=>f(!d),className:"px-3 py-1 bg-gray-100 hover:bg-gray-200 text-gray-700 text-sm rounded border flex items-center space-x-1",children:[i.jsx("span",{children:" Admin"}),i.jsx("span",{className:`text-xs transition-transform ${d?"rotate-180":""}`,children:""})]}),d&&i.jsx("div",{className:"absolute right-0 mt-1 w-64 bg-white border border-gray-200 rounded-lg shadow-lg z-50",children:i.jsxs("div",{className:"py-1",children:[i.jsxs("button",{onClick:()=>{u(!0),f(!1)},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 flex items-center space-x-2",children:[i.jsx("span",{children:""}),i.jsx("span",{children:"Batch Geocoding"})]}),i.jsxs("div",{className:"border-t border-gray-200 px-4 py-2",children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Property Loading Mode:"}),i.jsxs("select",{value:w.mode,onChange:F=>g({mode:F.target.value}),className:"w-full text-xs border border-gray-300 rounded px-2 py-1",children:[i.jsx("option",{value:"static-1000",children:" Static: 1,000 properties"}),i.jsx("option",{value:"static-2000",children:" Static: 2,000 properties"}),i.jsx("option",{value:"static-all",children:" Static: All properties"})]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[" Fixed dataset - ",w.mode==="static-all"?"Complete":"Limited"," for performance"]})]}),i.jsxs("div",{className:"border-t border-gray-200 px-4 py-2",children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Site Submit Client Filter:"}),i.jsxs("select",{value:E||"",onChange:F=>O(F.target.value||null),className:"w-full text-xs border border-gray-300 rounded px-2 py-1",children:[i.jsx("option",{value:"",children:" All Clients (100 limit)"}),S.map(F=>i.jsxs("option",{value:F.id,children:[" ",F.client_name]},F.id))]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[" ",E?"Showing client-specific site submits":"Limited to 100 for performance"]})]}),i.jsxs("div",{className:"border-t border-gray-200 px-4 py-2",children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Site Submit Loading Mode:"}),i.jsxs("select",{value:k.mode,onChange:F=>N({mode:F.target.value,clientId:E}),className:"w-full text-xs border border-gray-300 rounded px-2 py-1",disabled:E!==null,children:[i.jsx("option",{value:"static-100",children:" Static: 100 site submits"}),i.jsx("option",{value:"static-500",children:" Static: 500 site submits"}),i.jsx("option",{value:"static-all",children:" Static: All site submits"})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:E?" Client filter overrides mode":" Stage-based marker colors"})]})]})})]})]})]})}),i.jsx("div",{className:"flex-shrink-0 bg-blue-50 border-b border-blue-200 px-4 py-2",children:i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("label",{className:"text-sm font-medium text-blue-900",children:" Test Geocoding:"}),i.jsx("input",{type:"text",value:r,onChange:F=>n(F.target.value),placeholder:"Enter address to geocode...",className:"px-3 py-1 border border-blue-300 rounded text-sm w-80",disabled:o}),i.jsx("button",{onClick:A,disabled:o||!r.trim(),className:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:o?"Testing...":"Test"})]}),s&&i.jsx("div",{className:"flex-1 text-xs font-mono bg-white rounded px-2 py-1 border max-w-md overflow-hidden",children:i.jsx("pre",{className:"whitespace-pre-wrap",children:s})})]})}),i.jsxs("div",{className:"flex-1 relative",children:[i.jsx(MN,{height:"100%",width:"100%",onMapLoad:L,className:""}),i.jsx(zN,{map:e,isVisible:m,loadingConfig:w,onPropertiesLoaded:v}),i.jsx(WN,{map:e,isVisible:b,loadingConfig:k,onSiteSubmitsLoaded:j}),e&&i.jsx("div",{className:"absolute bottom-4 left-4 bg-white bg-opacity-90 rounded-lg shadow-sm p-3 text-xs",children:i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Center:"}),i.jsxs("span",{className:"font-mono text-gray-900 ml-2",children:[(M=e.getCenter())==null?void 0:M.lat().toFixed(4),", ",(B=e.getCenter())==null?void 0:B.lng().toFixed(4)]})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Zoom:"}),i.jsx("span",{className:"font-mono text-gray-900 ml-2",children:e.getZoom()})]}),y>0&&i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Properties:"}),i.jsxs("span",{className:"font-mono text-gray-900 ml-2",children:[y," loaded (",w.mode,"), ",m?"visible":"hidden"]})]}),_>0&&i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Site Submits:"}),i.jsxs("span",{className:"font-mono text-gray-900 ml-2",children:[_," loaded (",E?"filtered":k.mode,"), ",b?"visible":"hidden"]})]})]})})]})]})]})})},AW=[{id:"properties",name:"Properties",type:"property",icon:"",description:"All properties in the system",defaultVisible:!1,isSystemLayer:!0},{id:"site_submits",name:"Site Submits",type:"site_submit",icon:"",description:"Site submission data with stage-based visualization",defaultVisible:!1,isSystemLayer:!0},{id:"activities",name:"Activities",type:"activity",icon:"",description:"Activity and task data",defaultVisible:!1,isSystemLayer:!0}],HN=x.createContext(void 0),qN=()=>{const e=x.useContext(HN);if(!e)throw new Error("useLayerManager must be used within a LayerManagerProvider");return e},$W=({children:e})=>{const[t]=x.useState(AW),[r,n]=x.useState({}),[s,a]=x.useState(!0),[o,l]=x.useState(null);x.useEffect(()=>{const y={};t.forEach(v=>{y[v.id]={isVisible:v.defaultVisible,isLoading:!1,count:0,hasError:!1}}),n(y)},[t]);const h={layers:t,layerState:r,toggleLayer:y=>{n(v=>{var w;return{...v,[y]:{...v[y],isVisible:!((w=v[y])!=null&&w.isVisible)}}})},setLayerCount:(y,v)=>{n(w=>({...w,[y]:{...w[y],count:v,lastUpdated:new Date}}))},setLayerLoading:(y,v)=>{n(w=>({...w,[y]:{...w[y],isLoading:v}}))},setLayerError:(y,v)=>{n(w=>({...w,[y]:{...w[y],hasError:v}}))},isPanelOpen:s,togglePanel:()=>{a(y=>!y)},createMode:o,setCreateMode:l};return i.jsx(HN.Provider,{value:h,children:e})},FW=({layerId:e,name:t,icon:r,description:n,count:s,isVisible:a,isLoading:o,hasError:l,onToggle:c,isSystemLayer:u})=>i.jsxs("div",{className:"border border-gray-200 rounded-lg mb-3 bg-white shadow-sm",children:[i.jsxs("div",{className:"p-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("span",{className:"text-lg",children:r}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-medium text-gray-900 text-sm",children:t}),n&&i.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:n})]})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("span",{className:`text-xs px-2 py-1 rounded-full font-medium ${a?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-600"}`,children:o?"...":s.toLocaleString()}),i.jsx("button",{onClick:c,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${a?"bg-blue-600":"bg-gray-200"}`,role:"switch","aria-checked":a,"aria-label":`Toggle ${t} layer`,children:i.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${a?"translate-x-6":"translate-x-1"}`})})]})]}),o&&i.jsxs("div",{className:"mt-2 flex items-center space-x-2 text-xs text-blue-600",children:[i.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-blue-600"}),i.jsx("span",{children:"Loading layer data..."})]}),l&&i.jsxs("div",{className:"mt-2 flex items-center space-x-2 text-xs text-red-600",children:[i.jsx("span",{children:""}),i.jsx("span",{children:"Failed to load layer"})]}),u&&i.jsx("div",{className:"mt-2",children:i.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800",children:" System Layer"})})]}),a&&i.jsx("div",{className:"border-t border-gray-100 px-3 py-2 bg-gray-50",children:i.jsx("div",{className:"text-xs text-gray-600",children:" Filter controls coming in Phase 2.3"})})]}),BW=()=>{const{layers:e,layerState:t,toggleLayer:r,isPanelOpen:n,togglePanel:s,createMode:a,setCreateMode:o}=qN();return n?i.jsx("div",{className:"fixed left-4 top-20 bottom-4 w-80 z-50 flex flex-col",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border border-gray-200 flex flex-col h-full",children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("span",{className:"text-lg",children:""}),i.jsx("h2",{className:"font-semibold text-gray-900",children:"Map Layers"})]}),i.jsx("button",{onClick:s,className:"p-1 hover:bg-gray-100 rounded transition-colors",title:"Collapse Panel",children:i.jsx("span",{className:"text-gray-400",children:""})})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[i.jsx("div",{className:"space-y-1",children:e.map(l=>{const c=t[l.id]||{isVisible:!1,isLoading:!1,count:0,hasError:!1};return i.jsx(FW,{layerId:l.id,name:l.name,icon:l.icon,description:l.description,count:c.count,isVisible:c.isVisible,isLoading:c.isLoading,hasError:c.hasError,onToggle:()=>r(l.id),isSystemLayer:l.isSystemLayer},l.id)})}),i.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200",children:[i.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Custom Layers"}),i.jsx("div",{className:"text-xs text-gray-500 p-3 bg-gray-50 rounded border-2 border-dashed border-gray-200",children:" Custom layer creation coming in Phase 2.4"})]})]}),i.jsxs("div",{className:"border-t border-gray-200 p-4",children:[i.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Create Mode"}),i.jsx("div",{className:"text-xs text-gray-500 p-2 bg-blue-50 rounded border border-blue-200",children:" Pin dropping for property/site submit creation coming in Phase 2.2b"})]})]})}):i.jsx("div",{className:"fixed left-4 top-20 z-50",children:i.jsx("button",{onClick:s,className:"bg-white border border-gray-300 rounded-lg p-2 shadow-lg hover:shadow-xl transition-shadow",title:"Open Layer Panel",children:i.jsx("span",{className:"text-lg",children:""})})})},UW=()=>{var _,j,k,N;const[e,t]=x.useState(null),[r,n]=x.useState("1600 Amphitheatre Parkway, Mountain View, CA"),[s,a]=x.useState(""),[o,l]=x.useState(!1),[c,u]=x.useState(!1),[d,f]=x.useState(!1),{layerState:m,setLayerCount:h,setLayerLoading:y,setLayerError:v}=qN(),w=S=>{t(S),console.log("Map loaded successfully:",S)},g=async()=>{if(r.trim()){l(!0),a("Testing geocoding...");try{console.log(" Testing enhanced geocoding service...");const S=await an.geocodeAddress(r);"latitude"in S?a(` Success (${S.provider}):
         ${S.latitude.toFixed(6)}, ${S.longitude.toFixed(6)}
         ${S.formatted_address}
         City: ${S.city||"N/A"}
         State: ${S.state||"N/A"}
         ZIP: ${S.zip||"N/A"}`):a(` Error: ${S.error} (${S.code})`)}catch(S){a(` Exception: ${S instanceof Error?S.message:"Unknown error"}`)}finally{l(!1)}}},b={mode:"static-all"},p={mode:"static-100"};return i.jsx("div",{className:"h-screen w-screen bg-gray-50 overflow-hidden",children:i.jsxs("div",{className:"h-full flex",children:[c&&i.jsxs("div",{className:"w-80 flex-shrink-0 bg-white border-r border-gray-200 flex flex-col shadow-lg",children:[i.jsx("div",{className:"flex-shrink-0 px-3 py-2 bg-white border-b border-gray-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h1",{className:"text-sm font-semibold text-gray-900",children:" Admin: Batch Geocoding"}),i.jsx("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-600 p-1",title:"Close panel",children:""})]})}),i.jsx("div",{className:"flex-1 overflow-y-auto",children:i.jsx(ON,{className:"compact"})})]}),i.jsxs("div",{className:"flex-1 flex flex-col",children:[i.jsx("div",{className:"flex-shrink-0 bg-white shadow-sm border-b border-gray-200 px-4 py-3",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Interactive Map"}),i.jsx("div",{className:"text-sm text-gray-500",children:"Modern Layer Management"})]}),i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx("div",{className:"text-sm text-gray-600",children:"Use layer panel to control map data"}),i.jsxs("div",{className:"relative",children:[i.jsxs("button",{onClick:()=>f(!d),className:"px-3 py-1 bg-gray-100 hover:bg-gray-200 text-gray-700 text-sm rounded border flex items-center space-x-1",children:[i.jsx("span",{children:" Admin"}),i.jsx("span",{className:`text-xs transition-transform ${d?"rotate-180":""}`,children:""})]}),d&&i.jsx("div",{className:"absolute right-0 mt-1 w-64 bg-white border border-gray-200 rounded-lg shadow-lg z-50",children:i.jsx("div",{className:"py-1",children:i.jsxs("button",{onClick:()=>{u(!0),f(!1)},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 flex items-center space-x-2",children:[i.jsx("span",{children:""}),i.jsx("span",{children:"Batch Geocoding"})]})})})]})]})]})}),i.jsx("div",{className:"flex-shrink-0 bg-blue-50 border-b border-blue-200 px-4 py-2",children:i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("label",{className:"text-sm font-medium text-blue-900",children:" Test Geocoding:"}),i.jsx("input",{type:"text",value:r,onChange:S=>n(S.target.value),placeholder:"Enter address to geocode...",className:"px-3 py-1 border border-blue-300 rounded text-sm w-80",disabled:o}),i.jsx("button",{onClick:g,disabled:o||!r.trim(),className:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:o?"Testing...":"Test"})]}),s&&i.jsx("div",{className:"flex-1 text-xs font-mono bg-white rounded px-2 py-1 border max-w-md overflow-hidden",children:i.jsx("pre",{className:"whitespace-pre-wrap",children:s})})]})}),i.jsxs("div",{className:"flex-1 relative",children:[i.jsx(MN,{height:"100%",width:"100%",onMapLoad:w,className:""}),i.jsx(zN,{map:e,isVisible:((_=m.properties)==null?void 0:_.isVisible)||!1,loadingConfig:b,onPropertiesLoaded:S=>{h("properties",S),y("properties",!1)}}),i.jsx(WN,{map:e,isVisible:((j=m.site_submits)==null?void 0:j.isVisible)||!1,loadingConfig:p,onSiteSubmitsLoaded:S=>{h("site_submits",S),y("site_submits",!1)}}),i.jsx(BW,{}),e&&i.jsx("div",{className:"absolute bottom-4 right-4 bg-white bg-opacity-90 rounded-lg shadow-sm p-3 text-xs",children:i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Center:"}),i.jsxs("span",{className:"font-mono text-gray-900 ml-2",children:[(k=e.getCenter())==null?void 0:k.lat().toFixed(4),", ",(N=e.getCenter())==null?void 0:N.lng().toFixed(4)]})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Zoom:"}),i.jsx("span",{className:"font-mono text-gray-900 ml-2",children:e.getZoom()})]}),i.jsx("div",{className:"text-xs text-gray-400 mt-2",children:" Modern Layer Management Active"})]})})]})]})]})})},zW=()=>i.jsx($W,{children:i.jsx(UW,{})});function WW(){return i.jsx(wP,{children:i.jsx(_P,{children:i.jsxs("div",{className:"min-h-screen bg-gray-100",children:[i.jsx(Pz,{}),i.jsxs(SE,{children:[i.jsx(ut,{path:"/",element:i.jsx(kE,{to:"/master-pipeline",replace:!0})}),i.jsx(ut,{path:"/master-pipeline",element:i.jsx(YI,{})}),i.jsx(ut,{path:"/deal/new",element:i.jsx(Lb,{})}),i.jsx(ut,{path:"/deal/:dealId",element:i.jsx(Lb,{})}),i.jsx(ut,{path:"/assignment/new",element:i.jsx(Sv,{})}),i.jsx(ut,{path:"/assignment/:assignmentId",element:i.jsx(Sv,{})}),i.jsx(ut,{path:"/property/new",element:i.jsx(Ez,{})}),i.jsx(ut,{path:"/property/:propertyId",element:i.jsx(w7,{})}),i.jsx(ut,{path:"/contact/new",element:i.jsx(kv,{})}),i.jsx(ut,{path:"/contact/:contactId",element:i.jsx(kv,{})}),i.jsx(ut,{path:"/client/new",element:i.jsx(Nv,{})}),i.jsx(ut,{path:"/client/:clientId",element:i.jsx(Nv,{})}),i.jsx(ut,{path:"/site-submit/:siteSubmitId",element:i.jsx(bz,{})}),i.jsx(ut,{path:"/search-test",element:i.jsx(Tz,{})}),i.jsx(ut,{path:"/search-debug",element:i.jsx(Iz,{})}),i.jsx(ut,{path:"/notes-debug",element:i.jsx(Oz,{})}),i.jsx(ut,{path:"/mapping",element:i.jsx(OW,{})}),i.jsx(ut,{path:"/mapping-new",element:i.jsx(zW,{})})]})]})})})}bm.createRoot(document.getElementById("root")).render(i.jsx(H.StrictMode,{children:i.jsx(QE,{children:i.jsx(WW,{})})}));
