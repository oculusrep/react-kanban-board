var Z_=Object.defineProperty;var e1=(e,t,r)=>t in e?Z_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Q=(e,t,r)=>(e1(e,typeof t!="symbol"?t+"":t,r),r);function gx(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var Qt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function tm(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function xx(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var s=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return e[n]}})}),r}var yx={exports:{}},jc={},vx={exports:{}},fe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zi=Symbol.for("react.element"),t1=Symbol.for("react.portal"),r1=Symbol.for("react.fragment"),n1=Symbol.for("react.strict_mode"),s1=Symbol.for("react.profiler"),a1=Symbol.for("react.provider"),i1=Symbol.for("react.context"),o1=Symbol.for("react.forward_ref"),l1=Symbol.for("react.suspense"),c1=Symbol.for("react.memo"),d1=Symbol.for("react.lazy"),ap=Symbol.iterator;function u1(e){return e===null||typeof e!="object"?null:(e=ap&&e[ap]||e["@@iterator"],typeof e=="function"?e:null)}var bx={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},wx=Object.assign,_x={};function ba(e,t,r){this.props=e,this.context=t,this.refs=_x,this.updater=r||bx}ba.prototype.isReactComponent={};ba.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ba.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function jx(){}jx.prototype=ba.prototype;function rm(e,t,r){this.props=e,this.context=t,this.refs=_x,this.updater=r||bx}var nm=rm.prototype=new jx;nm.constructor=rm;wx(nm,ba.prototype);nm.isPureReactComponent=!0;var ip=Array.isArray,Nx=Object.prototype.hasOwnProperty,sm={current:null},kx={key:!0,ref:!0,__self:!0,__source:!0};function Sx(e,t,r){var n,s={},a=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(a=""+t.key),t)Nx.call(t,n)&&!kx.hasOwnProperty(n)&&(s[n]=t[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];s.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:Zi,type:e,key:a,ref:o,props:s,_owner:sm.current}}function f1(e,t){return{$$typeof:Zi,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function am(e){return typeof e=="object"&&e!==null&&e.$$typeof===Zi}function m1(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var op=/\/+/g;function yd(e,t){return typeof e=="object"&&e!==null&&e.key!=null?m1(""+e.key):t.toString(36)}function sl(e,t,r,n,s){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Zi:case t1:o=!0}}if(o)return o=e,s=s(o),e=n===""?"."+yd(o,0):n,ip(s)?(r="",e!=null&&(r=e.replace(op,"$&/")+"/"),sl(s,t,r,"",function(d){return d})):s!=null&&(am(s)&&(s=f1(s,r+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(op,"$&/")+"/")+e)),t.push(s)),1;if(o=0,n=n===""?".":n+":",ip(e))for(var l=0;l<e.length;l++){a=e[l];var c=n+yd(a,l);o+=sl(a,t,r,c,s)}else if(c=u1(e),typeof c=="function")for(e=c.call(e),l=0;!(a=e.next()).done;)a=a.value,c=n+yd(a,l++),o+=sl(a,t,r,c,s);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function wo(e,t,r){if(e==null)return e;var n=[],s=0;return sl(e,n,"","",function(a){return t.call(r,a,s++)}),n}function h1(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var bt={current:null},al={transition:null},p1={ReactCurrentDispatcher:bt,ReactCurrentBatchConfig:al,ReactCurrentOwner:sm};function Cx(){throw Error("act(...) is not supported in production builds of React.")}fe.Children={map:wo,forEach:function(e,t,r){wo(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return wo(e,function(){t++}),t},toArray:function(e){return wo(e,function(t){return t})||[]},only:function(e){if(!am(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};fe.Component=ba;fe.Fragment=r1;fe.Profiler=s1;fe.PureComponent=rm;fe.StrictMode=n1;fe.Suspense=l1;fe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=p1;fe.act=Cx;fe.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=wx({},e.props),s=e.key,a=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,o=sm.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)Nx.call(t,c)&&!kx.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];n.children=l}return{$$typeof:Zi,type:e.type,key:s,ref:a,props:n,_owner:o}};fe.createContext=function(e){return e={$$typeof:i1,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:a1,_context:e},e.Consumer=e};fe.createElement=Sx;fe.createFactory=function(e){var t=Sx.bind(null,e);return t.type=e,t};fe.createRef=function(){return{current:null}};fe.forwardRef=function(e){return{$$typeof:o1,render:e}};fe.isValidElement=am;fe.lazy=function(e){return{$$typeof:d1,_payload:{_status:-1,_result:e},_init:h1}};fe.memo=function(e,t){return{$$typeof:c1,type:e,compare:t===void 0?null:t}};fe.startTransition=function(e){var t=al.transition;al.transition={};try{e()}finally{al.transition=t}};fe.unstable_act=Cx;fe.useCallback=function(e,t){return bt.current.useCallback(e,t)};fe.useContext=function(e){return bt.current.useContext(e)};fe.useDebugValue=function(){};fe.useDeferredValue=function(e){return bt.current.useDeferredValue(e)};fe.useEffect=function(e,t){return bt.current.useEffect(e,t)};fe.useId=function(){return bt.current.useId()};fe.useImperativeHandle=function(e,t,r){return bt.current.useImperativeHandle(e,t,r)};fe.useInsertionEffect=function(e,t){return bt.current.useInsertionEffect(e,t)};fe.useLayoutEffect=function(e,t){return bt.current.useLayoutEffect(e,t)};fe.useMemo=function(e,t){return bt.current.useMemo(e,t)};fe.useReducer=function(e,t,r){return bt.current.useReducer(e,t,r)};fe.useRef=function(e){return bt.current.useRef(e)};fe.useState=function(e){return bt.current.useState(e)};fe.useSyncExternalStore=function(e,t,r){return bt.current.useSyncExternalStore(e,t,r)};fe.useTransition=function(){return bt.current.useTransition()};fe.version="18.3.1";vx.exports=fe;var p=vx.exports;const O=tm(p),Dx=gx({__proto__:null,default:O},[p]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g1=p,x1=Symbol.for("react.element"),y1=Symbol.for("react.fragment"),v1=Object.prototype.hasOwnProperty,b1=g1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,w1={key:!0,ref:!0,__self:!0,__source:!0};function Ex(e,t,r){var n,s={},a=null,o=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)v1.call(t,n)&&!w1.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:x1,type:e,key:a,ref:o,props:s,_owner:b1.current}}jc.Fragment=y1;jc.jsx=Ex;jc.jsxs=Ex;yx.exports=jc;var i=yx.exports,Pu={},Px={exports:{}},$t={},Tx={exports:{}},Rx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(E,$){var B=E.length;E.push($);e:for(;0<B;){var H=B-1>>>1,J=E[H];if(0<s(J,$))E[H]=$,E[B]=J,B=H;else break e}}function r(E){return E.length===0?null:E[0]}function n(E){if(E.length===0)return null;var $=E[0],B=E.pop();if(B!==$){E[0]=B;e:for(var H=0,J=E.length,le=J>>>1;H<le;){var oe=2*(H+1)-1,se=E[oe],ae=oe+1,T=E[ae];if(0>s(se,B))ae<J&&0>s(T,se)?(E[H]=T,E[ae]=B,H=ae):(E[H]=se,E[oe]=B,H=oe);else if(ae<J&&0>s(T,B))E[H]=T,E[ae]=B,H=ae;else break e}}return $}function s(E,$){var B=E.sortIndex-$.sortIndex;return B!==0?B:E.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,m=null,f=3,h=!1,y=!1,w=!1,b=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(E){for(var $=r(d);$!==null;){if($.callback===null)n(d);else if($.startTime<=E)n(d),$.sortIndex=$.expirationTime,t(c,$);else break;$=r(d)}}function N(E){if(w=!1,v(E),!y)if(r(c)!==null)y=!0,F(_);else{var $=r(d);$!==null&&U(N,$.startTime-E)}}function _(E,$){y=!1,w&&(w=!1,g(k),k=-1),h=!0;var B=f;try{for(v($),m=r(c);m!==null&&(!(m.expirationTime>$)||E&&!R());){var H=m.callback;if(typeof H=="function"){m.callback=null,f=m.priorityLevel;var J=H(m.expirationTime<=$);$=e.unstable_now(),typeof J=="function"?m.callback=J:m===r(c)&&n(c),v($)}else n(c);m=r(c)}if(m!==null)var le=!0;else{var oe=r(d);oe!==null&&U(N,oe.startTime-$),le=!1}return le}finally{m=null,f=B,h=!1}}var C=!1,j=null,k=-1,S=5,D=-1;function R(){return!(e.unstable_now()-D<S)}function P(){if(j!==null){var E=e.unstable_now();D=E;var $=!0;try{$=j(!0,E)}finally{$?A():(C=!1,j=null)}}else C=!1}var A;if(typeof x=="function")A=function(){x(P)};else if(typeof MessageChannel<"u"){var I=new MessageChannel,L=I.port2;I.port1.onmessage=P,A=function(){L.postMessage(null)}}else A=function(){b(P,0)};function F(E){j=E,C||(C=!0,A())}function U(E,$){k=b(function(){E(e.unstable_now())},$)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(E){E.callback=null},e.unstable_continueExecution=function(){y||h||(y=!0,F(_))},e.unstable_forceFrameRate=function(E){0>E||125<E?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<E?Math.floor(1e3/E):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(E){switch(f){case 1:case 2:case 3:var $=3;break;default:$=f}var B=f;f=$;try{return E()}finally{f=B}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(E,$){switch(E){case 1:case 2:case 3:case 4:case 5:break;default:E=3}var B=f;f=E;try{return $()}finally{f=B}},e.unstable_scheduleCallback=function(E,$,B){var H=e.unstable_now();switch(typeof B=="object"&&B!==null?(B=B.delay,B=typeof B=="number"&&0<B?H+B:H):B=H,E){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=B+J,E={id:u++,callback:$,priorityLevel:E,startTime:B,expirationTime:J,sortIndex:-1},B>H?(E.sortIndex=B,t(d,E),r(c)===null&&E===r(d)&&(w?(g(k),k=-1):w=!0,U(N,B-H))):(E.sortIndex=J,t(c,E),y||h||(y=!0,F(_))),E},e.unstable_shouldYield=R,e.unstable_wrapCallback=function(E){var $=f;return function(){var B=f;f=$;try{return E.apply(this,arguments)}finally{f=B}}}})(Rx);Tx.exports=Rx;var _1=Tx.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var j1=p,At=_1;function V(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Lx=new Set,Ni={};function ys(e,t){ea(e,t),ea(e+"Capture",t)}function ea(e,t){for(Ni[e]=t,e=0;e<t.length;e++)Lx.add(t[e])}var Jr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Tu=Object.prototype.hasOwnProperty,N1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,lp={},cp={};function k1(e){return Tu.call(cp,e)?!0:Tu.call(lp,e)?!1:N1.test(e)?cp[e]=!0:(lp[e]=!0,!1)}function S1(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function C1(e,t,r,n){if(t===null||typeof t>"u"||S1(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function wt(e,t,r,n,s,a,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var at={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){at[e]=new wt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];at[t]=new wt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){at[e]=new wt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){at[e]=new wt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){at[e]=new wt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){at[e]=new wt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){at[e]=new wt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){at[e]=new wt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){at[e]=new wt(e,5,!1,e.toLowerCase(),null,!1,!1)});var im=/[\-:]([a-z])/g;function om(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(im,om);at[t]=new wt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(im,om);at[t]=new wt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(im,om);at[t]=new wt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){at[e]=new wt(e,1,!1,e.toLowerCase(),null,!1,!1)});at.xlinkHref=new wt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){at[e]=new wt(e,1,!1,e.toLowerCase(),null,!0,!0)});function lm(e,t,r,n){var s=at.hasOwnProperty(t)?at[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(C1(t,r,s,n)&&(r=null),n||s===null?k1(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var nn=j1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_o=Symbol.for("react.element"),Ls=Symbol.for("react.portal"),Is=Symbol.for("react.fragment"),cm=Symbol.for("react.strict_mode"),Ru=Symbol.for("react.profiler"),Ix=Symbol.for("react.provider"),Mx=Symbol.for("react.context"),dm=Symbol.for("react.forward_ref"),Lu=Symbol.for("react.suspense"),Iu=Symbol.for("react.suspense_list"),um=Symbol.for("react.memo"),dn=Symbol.for("react.lazy"),Ox=Symbol.for("react.offscreen"),dp=Symbol.iterator;function Ma(e){return e===null||typeof e!="object"?null:(e=dp&&e[dp]||e["@@iterator"],typeof e=="function"?e:null)}var Be=Object.assign,vd;function ni(e){if(vd===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);vd=t&&t[1]||""}return`
`+vd+e}var bd=!1;function wd(e,t){if(!e||bd)return"";bd=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var n=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){n=d}e.call(t.prototype)}else{try{throw Error()}catch(d){n=d}e()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),a=n.stack.split(`
`),o=s.length-1,l=a.length-1;1<=o&&0<=l&&s[o]!==a[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==a[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==a[l]){var c=`
`+s[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{bd=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?ni(e):""}function D1(e){switch(e.tag){case 5:return ni(e.type);case 16:return ni("Lazy");case 13:return ni("Suspense");case 19:return ni("SuspenseList");case 0:case 2:case 15:return e=wd(e.type,!1),e;case 11:return e=wd(e.type.render,!1),e;case 1:return e=wd(e.type,!0),e;default:return""}}function Mu(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Is:return"Fragment";case Ls:return"Portal";case Ru:return"Profiler";case cm:return"StrictMode";case Lu:return"Suspense";case Iu:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Mx:return(e.displayName||"Context")+".Consumer";case Ix:return(e._context.displayName||"Context")+".Provider";case dm:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case um:return t=e.displayName||null,t!==null?t:Mu(e.type)||"Memo";case dn:t=e._payload,e=e._init;try{return Mu(e(t))}catch{}}return null}function E1(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Mu(t);case 8:return t===cm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Pn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ax(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function P1(e){var t=Ax(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){n=""+o,a.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function jo(e){e._valueTracker||(e._valueTracker=P1(e))}function $x(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Ax(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Cl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ou(e,t){var r=t.checked;return Be({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function up(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Pn(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Fx(e,t){t=t.checked,t!=null&&lm(e,"checked",t,!1)}function Au(e,t){Fx(e,t);var r=Pn(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?$u(e,t.type,r):t.hasOwnProperty("defaultValue")&&$u(e,t.type,Pn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function fp(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function $u(e,t,r){(t!=="number"||Cl(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var si=Array.isArray;function Ys(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Pn(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Fu(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(V(91));return Be({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function mp(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(V(92));if(si(r)){if(1<r.length)throw Error(V(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Pn(r)}}function Bx(e,t){var r=Pn(t.value),n=Pn(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function hp(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Ux(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Bu(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Ux(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var No,Wx=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(No=No||document.createElement("div"),No.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=No.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ki(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var ci={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},T1=["Webkit","ms","Moz","O"];Object.keys(ci).forEach(function(e){T1.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ci[t]=ci[e]})});function Hx(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||ci.hasOwnProperty(e)&&ci[e]?(""+t).trim():t+"px"}function zx(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=Hx(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var R1=Be({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Uu(e,t){if(t){if(R1[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(V(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(V(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(V(61))}if(t.style!=null&&typeof t.style!="object")throw Error(V(62))}}function Wu(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Hu=null;function fm(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var zu=null,qs=null,Gs=null;function pp(e){if(e=ro(e)){if(typeof zu!="function")throw Error(V(280));var t=e.stateNode;t&&(t=Dc(t),zu(e.stateNode,e.type,t))}}function Vx(e){qs?Gs?Gs.push(e):Gs=[e]:qs=e}function Yx(){if(qs){var e=qs,t=Gs;if(Gs=qs=null,pp(e),t)for(e=0;e<t.length;e++)pp(t[e])}}function qx(e,t){return e(t)}function Gx(){}var _d=!1;function Kx(e,t,r){if(_d)return e(t,r);_d=!0;try{return qx(e,t,r)}finally{_d=!1,(qs!==null||Gs!==null)&&(Gx(),Yx())}}function Si(e,t){var r=e.stateNode;if(r===null)return null;var n=Dc(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(V(231,t,typeof r));return r}var Vu=!1;if(Jr)try{var Oa={};Object.defineProperty(Oa,"passive",{get:function(){Vu=!0}}),window.addEventListener("test",Oa,Oa),window.removeEventListener("test",Oa,Oa)}catch{Vu=!1}function L1(e,t,r,n,s,a,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(r,d)}catch(u){this.onError(u)}}var di=!1,Dl=null,El=!1,Yu=null,I1={onError:function(e){di=!0,Dl=e}};function M1(e,t,r,n,s,a,o,l,c){di=!1,Dl=null,L1.apply(I1,arguments)}function O1(e,t,r,n,s,a,o,l,c){if(M1.apply(this,arguments),di){if(di){var d=Dl;di=!1,Dl=null}else throw Error(V(198));El||(El=!0,Yu=d)}}function vs(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Qx(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function gp(e){if(vs(e)!==e)throw Error(V(188))}function A1(e){var t=e.alternate;if(!t){if(t=vs(e),t===null)throw Error(V(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return gp(s),e;if(a===n)return gp(s),t;a=a.sibling}throw Error(V(188))}if(r.return!==n.return)r=s,n=a;else{for(var o=!1,l=s.child;l;){if(l===r){o=!0,r=s,n=a;break}if(l===n){o=!0,n=s,r=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===r){o=!0,r=a,n=s;break}if(l===n){o=!0,n=a,r=s;break}l=l.sibling}if(!o)throw Error(V(189))}}if(r.alternate!==n)throw Error(V(190))}if(r.tag!==3)throw Error(V(188));return r.stateNode.current===r?e:t}function Jx(e){return e=A1(e),e!==null?Xx(e):null}function Xx(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Xx(e);if(t!==null)return t;e=e.sibling}return null}var Zx=At.unstable_scheduleCallback,xp=At.unstable_cancelCallback,$1=At.unstable_shouldYield,F1=At.unstable_requestPaint,He=At.unstable_now,B1=At.unstable_getCurrentPriorityLevel,mm=At.unstable_ImmediatePriority,ey=At.unstable_UserBlockingPriority,Pl=At.unstable_NormalPriority,U1=At.unstable_LowPriority,ty=At.unstable_IdlePriority,Nc=null,Dr=null;function W1(e){if(Dr&&typeof Dr.onCommitFiberRoot=="function")try{Dr.onCommitFiberRoot(Nc,e,void 0,(e.current.flags&128)===128)}catch{}}var or=Math.clz32?Math.clz32:V1,H1=Math.log,z1=Math.LN2;function V1(e){return e>>>=0,e===0?32:31-(H1(e)/z1|0)|0}var ko=64,So=4194304;function ai(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Tl(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,a=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~s;l!==0?n=ai(l):(a&=o,a!==0&&(n=ai(a)))}else o=r&~s,o!==0?n=ai(o):a!==0&&(n=ai(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,a=t&-t,s>=a||s===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-or(t),s=1<<r,n|=e[r],t&=~s;return n}function Y1(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function q1(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-or(a),l=1<<o,c=s[o];c===-1?(!(l&r)||l&n)&&(s[o]=Y1(l,t)):c<=t&&(e.expiredLanes|=l),a&=~l}}function qu(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function ry(){var e=ko;return ko<<=1,!(ko&4194240)&&(ko=64),e}function jd(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function eo(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-or(t),e[t]=r}function G1(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-or(r),a=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~a}}function hm(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-or(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var ke=0;function ny(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var sy,pm,ay,iy,oy,Gu=!1,Co=[],yn=null,vn=null,bn=null,Ci=new Map,Di=new Map,fn=[],K1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function yp(e,t){switch(e){case"focusin":case"focusout":yn=null;break;case"dragenter":case"dragleave":vn=null;break;case"mouseover":case"mouseout":bn=null;break;case"pointerover":case"pointerout":Ci.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Di.delete(t.pointerId)}}function Aa(e,t,r,n,s,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},t!==null&&(t=ro(t),t!==null&&pm(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function Q1(e,t,r,n,s){switch(t){case"focusin":return yn=Aa(yn,e,t,r,n,s),!0;case"dragenter":return vn=Aa(vn,e,t,r,n,s),!0;case"mouseover":return bn=Aa(bn,e,t,r,n,s),!0;case"pointerover":var a=s.pointerId;return Ci.set(a,Aa(Ci.get(a)||null,e,t,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,Di.set(a,Aa(Di.get(a)||null,e,t,r,n,s)),!0}return!1}function ly(e){var t=Xn(e.target);if(t!==null){var r=vs(t);if(r!==null){if(t=r.tag,t===13){if(t=Qx(r),t!==null){e.blockedOn=t,oy(e.priority,function(){ay(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function il(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Ku(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Hu=n,r.target.dispatchEvent(n),Hu=null}else return t=ro(r),t!==null&&pm(t),e.blockedOn=r,!1;t.shift()}return!0}function vp(e,t,r){il(e)&&r.delete(t)}function J1(){Gu=!1,yn!==null&&il(yn)&&(yn=null),vn!==null&&il(vn)&&(vn=null),bn!==null&&il(bn)&&(bn=null),Ci.forEach(vp),Di.forEach(vp)}function $a(e,t){e.blockedOn===t&&(e.blockedOn=null,Gu||(Gu=!0,At.unstable_scheduleCallback(At.unstable_NormalPriority,J1)))}function Ei(e){function t(s){return $a(s,e)}if(0<Co.length){$a(Co[0],e);for(var r=1;r<Co.length;r++){var n=Co[r];n.blockedOn===e&&(n.blockedOn=null)}}for(yn!==null&&$a(yn,e),vn!==null&&$a(vn,e),bn!==null&&$a(bn,e),Ci.forEach(t),Di.forEach(t),r=0;r<fn.length;r++)n=fn[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<fn.length&&(r=fn[0],r.blockedOn===null);)ly(r),r.blockedOn===null&&fn.shift()}var Ks=nn.ReactCurrentBatchConfig,Rl=!0;function X1(e,t,r,n){var s=ke,a=Ks.transition;Ks.transition=null;try{ke=1,gm(e,t,r,n)}finally{ke=s,Ks.transition=a}}function Z1(e,t,r,n){var s=ke,a=Ks.transition;Ks.transition=null;try{ke=4,gm(e,t,r,n)}finally{ke=s,Ks.transition=a}}function gm(e,t,r,n){if(Rl){var s=Ku(e,t,r,n);if(s===null)Ld(e,t,n,Ll,r),yp(e,n);else if(Q1(s,e,t,r,n))n.stopPropagation();else if(yp(e,n),t&4&&-1<K1.indexOf(e)){for(;s!==null;){var a=ro(s);if(a!==null&&sy(a),a=Ku(e,t,r,n),a===null&&Ld(e,t,n,Ll,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else Ld(e,t,n,null,r)}}var Ll=null;function Ku(e,t,r,n){if(Ll=null,e=fm(n),e=Xn(e),e!==null)if(t=vs(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Qx(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ll=e,null}function cy(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(B1()){case mm:return 1;case ey:return 4;case Pl:case U1:return 16;case ty:return 536870912;default:return 16}default:return 16}}var gn=null,xm=null,ol=null;function dy(){if(ol)return ol;var e,t=xm,r=t.length,n,s="value"in gn?gn.value:gn.textContent,a=s.length;for(e=0;e<r&&t[e]===s[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===s[a-n];n++);return ol=s.slice(e,1<n?1-n:void 0)}function ll(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Do(){return!0}function bp(){return!1}function Ft(e){function t(r,n,s,a,o){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Do:bp,this.isPropagationStopped=bp,this}return Be(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Do)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Do)},persist:function(){},isPersistent:Do}),t}var wa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ym=Ft(wa),to=Be({},wa,{view:0,detail:0}),ej=Ft(to),Nd,kd,Fa,kc=Be({},to,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vm,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Fa&&(Fa&&e.type==="mousemove"?(Nd=e.screenX-Fa.screenX,kd=e.screenY-Fa.screenY):kd=Nd=0,Fa=e),Nd)},movementY:function(e){return"movementY"in e?e.movementY:kd}}),wp=Ft(kc),tj=Be({},kc,{dataTransfer:0}),rj=Ft(tj),nj=Be({},to,{relatedTarget:0}),Sd=Ft(nj),sj=Be({},wa,{animationName:0,elapsedTime:0,pseudoElement:0}),aj=Ft(sj),ij=Be({},wa,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),oj=Ft(ij),lj=Be({},wa,{data:0}),_p=Ft(lj),cj={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dj={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},uj={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fj(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=uj[e])?!!t[e]:!1}function vm(){return fj}var mj=Be({},to,{key:function(e){if(e.key){var t=cj[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ll(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?dj[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vm,charCode:function(e){return e.type==="keypress"?ll(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ll(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),hj=Ft(mj),pj=Be({},kc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),jp=Ft(pj),gj=Be({},to,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vm}),xj=Ft(gj),yj=Be({},wa,{propertyName:0,elapsedTime:0,pseudoElement:0}),vj=Ft(yj),bj=Be({},kc,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),wj=Ft(bj),_j=[9,13,27,32],bm=Jr&&"CompositionEvent"in window,ui=null;Jr&&"documentMode"in document&&(ui=document.documentMode);var jj=Jr&&"TextEvent"in window&&!ui,uy=Jr&&(!bm||ui&&8<ui&&11>=ui),Np=String.fromCharCode(32),kp=!1;function fy(e,t){switch(e){case"keyup":return _j.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function my(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ms=!1;function Nj(e,t){switch(e){case"compositionend":return my(t);case"keypress":return t.which!==32?null:(kp=!0,Np);case"textInput":return e=t.data,e===Np&&kp?null:e;default:return null}}function kj(e,t){if(Ms)return e==="compositionend"||!bm&&fy(e,t)?(e=dy(),ol=xm=gn=null,Ms=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return uy&&t.locale!=="ko"?null:t.data;default:return null}}var Sj={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Sp(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Sj[e.type]:t==="textarea"}function hy(e,t,r,n){Vx(n),t=Il(t,"onChange"),0<t.length&&(r=new ym("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var fi=null,Pi=null;function Cj(e){ky(e,0)}function Sc(e){var t=$s(e);if($x(t))return e}function Dj(e,t){if(e==="change")return t}var py=!1;if(Jr){var Cd;if(Jr){var Dd="oninput"in document;if(!Dd){var Cp=document.createElement("div");Cp.setAttribute("oninput","return;"),Dd=typeof Cp.oninput=="function"}Cd=Dd}else Cd=!1;py=Cd&&(!document.documentMode||9<document.documentMode)}function Dp(){fi&&(fi.detachEvent("onpropertychange",gy),Pi=fi=null)}function gy(e){if(e.propertyName==="value"&&Sc(Pi)){var t=[];hy(t,Pi,e,fm(e)),Kx(Cj,t)}}function Ej(e,t,r){e==="focusin"?(Dp(),fi=t,Pi=r,fi.attachEvent("onpropertychange",gy)):e==="focusout"&&Dp()}function Pj(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Sc(Pi)}function Tj(e,t){if(e==="click")return Sc(t)}function Rj(e,t){if(e==="input"||e==="change")return Sc(t)}function Lj(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var dr=typeof Object.is=="function"?Object.is:Lj;function Ti(e,t){if(dr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Tu.call(t,s)||!dr(e[s],t[s]))return!1}return!0}function Ep(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Pp(e,t){var r=Ep(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Ep(r)}}function xy(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?xy(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function yy(){for(var e=window,t=Cl();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Cl(e.document)}return t}function wm(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Ij(e){var t=yy(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&xy(r.ownerDocument.documentElement,r)){if(n!==null&&wm(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!e.extend&&a>n&&(s=n,n=a,a=s),s=Pp(r,a);var o=Pp(r,n);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Mj=Jr&&"documentMode"in document&&11>=document.documentMode,Os=null,Qu=null,mi=null,Ju=!1;function Tp(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Ju||Os==null||Os!==Cl(n)||(n=Os,"selectionStart"in n&&wm(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),mi&&Ti(mi,n)||(mi=n,n=Il(Qu,"onSelect"),0<n.length&&(t=new ym("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Os)))}function Eo(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var As={animationend:Eo("Animation","AnimationEnd"),animationiteration:Eo("Animation","AnimationIteration"),animationstart:Eo("Animation","AnimationStart"),transitionend:Eo("Transition","TransitionEnd")},Ed={},vy={};Jr&&(vy=document.createElement("div").style,"AnimationEvent"in window||(delete As.animationend.animation,delete As.animationiteration.animation,delete As.animationstart.animation),"TransitionEvent"in window||delete As.transitionend.transition);function Cc(e){if(Ed[e])return Ed[e];if(!As[e])return e;var t=As[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in vy)return Ed[e]=t[r];return e}var by=Cc("animationend"),wy=Cc("animationiteration"),_y=Cc("animationstart"),jy=Cc("transitionend"),Ny=new Map,Rp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Mn(e,t){Ny.set(e,t),ys(t,[e])}for(var Pd=0;Pd<Rp.length;Pd++){var Td=Rp[Pd],Oj=Td.toLowerCase(),Aj=Td[0].toUpperCase()+Td.slice(1);Mn(Oj,"on"+Aj)}Mn(by,"onAnimationEnd");Mn(wy,"onAnimationIteration");Mn(_y,"onAnimationStart");Mn("dblclick","onDoubleClick");Mn("focusin","onFocus");Mn("focusout","onBlur");Mn(jy,"onTransitionEnd");ea("onMouseEnter",["mouseout","mouseover"]);ea("onMouseLeave",["mouseout","mouseover"]);ea("onPointerEnter",["pointerout","pointerover"]);ea("onPointerLeave",["pointerout","pointerover"]);ys("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ys("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ys("onBeforeInput",["compositionend","keypress","textInput","paste"]);ys("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ys("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ys("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ii="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$j=new Set("cancel close invalid load scroll toggle".split(" ").concat(ii));function Lp(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,O1(n,t,void 0,e),e.currentTarget=null}function ky(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==a&&s.isPropagationStopped())break e;Lp(s,l,d),a=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==a&&s.isPropagationStopped())break e;Lp(s,l,d),a=c}}}if(El)throw e=Yu,El=!1,Yu=null,e}function Pe(e,t){var r=t[rf];r===void 0&&(r=t[rf]=new Set);var n=e+"__bubble";r.has(n)||(Sy(t,e,2,!1),r.add(n))}function Rd(e,t,r){var n=0;t&&(n|=4),Sy(r,e,n,t)}var Po="_reactListening"+Math.random().toString(36).slice(2);function Ri(e){if(!e[Po]){e[Po]=!0,Lx.forEach(function(r){r!=="selectionchange"&&($j.has(r)||Rd(r,!1,e),Rd(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Po]||(t[Po]=!0,Rd("selectionchange",!1,t))}}function Sy(e,t,r,n){switch(cy(t)){case 1:var s=X1;break;case 4:s=Z1;break;default:s=gm}r=s.bind(null,t,r,e),s=void 0,!Vu||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function Ld(e,t,r,n,s){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=Xn(l),o===null)return;if(c=o.tag,c===5||c===6){n=a=o;continue e}l=l.parentNode}}n=n.return}Kx(function(){var d=a,u=fm(r),m=[];e:{var f=Ny.get(e);if(f!==void 0){var h=ym,y=e;switch(e){case"keypress":if(ll(r)===0)break e;case"keydown":case"keyup":h=hj;break;case"focusin":y="focus",h=Sd;break;case"focusout":y="blur",h=Sd;break;case"beforeblur":case"afterblur":h=Sd;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=wp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=rj;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=xj;break;case by:case wy:case _y:h=aj;break;case jy:h=vj;break;case"scroll":h=ej;break;case"wheel":h=wj;break;case"copy":case"cut":case"paste":h=oj;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=jp}var w=(t&4)!==0,b=!w&&e==="scroll",g=w?f!==null?f+"Capture":null:f;w=[];for(var x=d,v;x!==null;){v=x;var N=v.stateNode;if(v.tag===5&&N!==null&&(v=N,g!==null&&(N=Si(x,g),N!=null&&w.push(Li(x,N,v)))),b)break;x=x.return}0<w.length&&(f=new h(f,y,null,r,u),m.push({event:f,listeners:w}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",f&&r!==Hu&&(y=r.relatedTarget||r.fromElement)&&(Xn(y)||y[Xr]))break e;if((h||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,h?(y=r.relatedTarget||r.toElement,h=d,y=y?Xn(y):null,y!==null&&(b=vs(y),y!==b||y.tag!==5&&y.tag!==6)&&(y=null)):(h=null,y=d),h!==y)){if(w=wp,N="onMouseLeave",g="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(w=jp,N="onPointerLeave",g="onPointerEnter",x="pointer"),b=h==null?f:$s(h),v=y==null?f:$s(y),f=new w(N,x+"leave",h,r,u),f.target=b,f.relatedTarget=v,N=null,Xn(u)===d&&(w=new w(g,x+"enter",y,r,u),w.target=v,w.relatedTarget=b,N=w),b=N,h&&y)t:{for(w=h,g=y,x=0,v=w;v;v=_s(v))x++;for(v=0,N=g;N;N=_s(N))v++;for(;0<x-v;)w=_s(w),x--;for(;0<v-x;)g=_s(g),v--;for(;x--;){if(w===g||g!==null&&w===g.alternate)break t;w=_s(w),g=_s(g)}w=null}else w=null;h!==null&&Ip(m,f,h,w,!1),y!==null&&b!==null&&Ip(m,b,y,w,!0)}}e:{if(f=d?$s(d):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var _=Dj;else if(Sp(f))if(py)_=Rj;else{_=Pj;var C=Ej}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(_=Tj);if(_&&(_=_(e,d))){hy(m,_,r,u);break e}C&&C(e,f,d),e==="focusout"&&(C=f._wrapperState)&&C.controlled&&f.type==="number"&&$u(f,"number",f.value)}switch(C=d?$s(d):window,e){case"focusin":(Sp(C)||C.contentEditable==="true")&&(Os=C,Qu=d,mi=null);break;case"focusout":mi=Qu=Os=null;break;case"mousedown":Ju=!0;break;case"contextmenu":case"mouseup":case"dragend":Ju=!1,Tp(m,r,u);break;case"selectionchange":if(Mj)break;case"keydown":case"keyup":Tp(m,r,u)}var j;if(bm)e:{switch(e){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else Ms?fy(e,r)&&(k="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(k="onCompositionStart");k&&(uy&&r.locale!=="ko"&&(Ms||k!=="onCompositionStart"?k==="onCompositionEnd"&&Ms&&(j=dy()):(gn=u,xm="value"in gn?gn.value:gn.textContent,Ms=!0)),C=Il(d,k),0<C.length&&(k=new _p(k,e,null,r,u),m.push({event:k,listeners:C}),j?k.data=j:(j=my(r),j!==null&&(k.data=j)))),(j=jj?Nj(e,r):kj(e,r))&&(d=Il(d,"onBeforeInput"),0<d.length&&(u=new _p("onBeforeInput","beforeinput",null,r,u),m.push({event:u,listeners:d}),u.data=j))}ky(m,t)})}function Li(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Il(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=Si(e,r),a!=null&&n.unshift(Li(e,a,s)),a=Si(e,t),a!=null&&n.push(Li(e,a,s))),e=e.return}return n}function _s(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Ip(e,t,r,n,s){for(var a=t._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,d=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&d!==null&&(l=d,s?(c=Si(r,a),c!=null&&o.unshift(Li(r,c,l))):s||(c=Si(r,a),c!=null&&o.push(Li(r,c,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var Fj=/\r\n?/g,Bj=/\u0000|\uFFFD/g;function Mp(e){return(typeof e=="string"?e:""+e).replace(Fj,`
`).replace(Bj,"")}function To(e,t,r){if(t=Mp(t),Mp(e)!==t&&r)throw Error(V(425))}function Ml(){}var Xu=null,Zu=null;function ef(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var tf=typeof setTimeout=="function"?setTimeout:void 0,Uj=typeof clearTimeout=="function"?clearTimeout:void 0,Op=typeof Promise=="function"?Promise:void 0,Wj=typeof queueMicrotask=="function"?queueMicrotask:typeof Op<"u"?function(e){return Op.resolve(null).then(e).catch(Hj)}:tf;function Hj(e){setTimeout(function(){throw e})}function Id(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),Ei(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);Ei(t)}function wn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Ap(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var _a=Math.random().toString(36).slice(2),jr="__reactFiber$"+_a,Ii="__reactProps$"+_a,Xr="__reactContainer$"+_a,rf="__reactEvents$"+_a,zj="__reactListeners$"+_a,Vj="__reactHandles$"+_a;function Xn(e){var t=e[jr];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Xr]||r[jr]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Ap(e);e!==null;){if(r=e[jr])return r;e=Ap(e)}return t}e=r,r=e.parentNode}return null}function ro(e){return e=e[jr]||e[Xr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function $s(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(V(33))}function Dc(e){return e[Ii]||null}var nf=[],Fs=-1;function On(e){return{current:e}}function Te(e){0>Fs||(e.current=nf[Fs],nf[Fs]=null,Fs--)}function Ee(e,t){Fs++,nf[Fs]=e.current,e.current=t}var Tn={},ft=On(Tn),St=On(!1),ds=Tn;function ta(e,t){var r=e.type.contextTypes;if(!r)return Tn;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Ct(e){return e=e.childContextTypes,e!=null}function Ol(){Te(St),Te(ft)}function $p(e,t,r){if(ft.current!==Tn)throw Error(V(168));Ee(ft,t),Ee(St,r)}function Cy(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(V(108,E1(e)||"Unknown",s));return Be({},r,n)}function Al(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Tn,ds=ft.current,Ee(ft,e),Ee(St,St.current),!0}function Fp(e,t,r){var n=e.stateNode;if(!n)throw Error(V(169));r?(e=Cy(e,t,ds),n.__reactInternalMemoizedMergedChildContext=e,Te(St),Te(ft),Ee(ft,e)):Te(St),Ee(St,r)}var Fr=null,Ec=!1,Md=!1;function Dy(e){Fr===null?Fr=[e]:Fr.push(e)}function Yj(e){Ec=!0,Dy(e)}function An(){if(!Md&&Fr!==null){Md=!0;var e=0,t=ke;try{var r=Fr;for(ke=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Fr=null,Ec=!1}catch(s){throw Fr!==null&&(Fr=Fr.slice(e+1)),Zx(mm,An),s}finally{ke=t,Md=!1}}return null}var Bs=[],Us=0,$l=null,Fl=0,Ht=[],zt=0,us=null,Ur=1,Wr="";function Vn(e,t){Bs[Us++]=Fl,Bs[Us++]=$l,$l=e,Fl=t}function Ey(e,t,r){Ht[zt++]=Ur,Ht[zt++]=Wr,Ht[zt++]=us,us=e;var n=Ur;e=Wr;var s=32-or(n)-1;n&=~(1<<s),r+=1;var a=32-or(t)+s;if(30<a){var o=s-s%5;a=(n&(1<<o)-1).toString(32),n>>=o,s-=o,Ur=1<<32-or(t)+s|r<<s|n,Wr=a+e}else Ur=1<<a|r<<s|n,Wr=e}function _m(e){e.return!==null&&(Vn(e,1),Ey(e,1,0))}function jm(e){for(;e===$l;)$l=Bs[--Us],Bs[Us]=null,Fl=Bs[--Us],Bs[Us]=null;for(;e===us;)us=Ht[--zt],Ht[zt]=null,Wr=Ht[--zt],Ht[zt]=null,Ur=Ht[--zt],Ht[zt]=null}var Lt=null,Tt=null,Me=!1,ar=null;function Py(e,t){var r=Yt(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Bp(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Lt=e,Tt=wn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Lt=e,Tt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=us!==null?{id:Ur,overflow:Wr}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Yt(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Lt=e,Tt=null,!0):!1;default:return!1}}function sf(e){return(e.mode&1)!==0&&(e.flags&128)===0}function af(e){if(Me){var t=Tt;if(t){var r=t;if(!Bp(e,t)){if(sf(e))throw Error(V(418));t=wn(r.nextSibling);var n=Lt;t&&Bp(e,t)?Py(n,r):(e.flags=e.flags&-4097|2,Me=!1,Lt=e)}}else{if(sf(e))throw Error(V(418));e.flags=e.flags&-4097|2,Me=!1,Lt=e}}}function Up(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Lt=e}function Ro(e){if(e!==Lt)return!1;if(!Me)return Up(e),Me=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!ef(e.type,e.memoizedProps)),t&&(t=Tt)){if(sf(e))throw Ty(),Error(V(418));for(;t;)Py(e,t),t=wn(t.nextSibling)}if(Up(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(V(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Tt=wn(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Tt=null}}else Tt=Lt?wn(e.stateNode.nextSibling):null;return!0}function Ty(){for(var e=Tt;e;)e=wn(e.nextSibling)}function ra(){Tt=Lt=null,Me=!1}function Nm(e){ar===null?ar=[e]:ar.push(e)}var qj=nn.ReactCurrentBatchConfig;function Ba(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(V(309));var n=r.stateNode}if(!n)throw Error(V(147,e));var s=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(o){var l=s.refs;o===null?delete l[a]:l[a]=o},t._stringRef=a,t)}if(typeof e!="string")throw Error(V(284));if(!r._owner)throw Error(V(290,e))}return e}function Lo(e,t){throw e=Object.prototype.toString.call(t),Error(V(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Wp(e){var t=e._init;return t(e._payload)}function Ry(e){function t(g,x){if(e){var v=g.deletions;v===null?(g.deletions=[x],g.flags|=16):v.push(x)}}function r(g,x){if(!e)return null;for(;x!==null;)t(g,x),x=x.sibling;return null}function n(g,x){for(g=new Map;x!==null;)x.key!==null?g.set(x.key,x):g.set(x.index,x),x=x.sibling;return g}function s(g,x){return g=kn(g,x),g.index=0,g.sibling=null,g}function a(g,x,v){return g.index=v,e?(v=g.alternate,v!==null?(v=v.index,v<x?(g.flags|=2,x):v):(g.flags|=2,x)):(g.flags|=1048576,x)}function o(g){return e&&g.alternate===null&&(g.flags|=2),g}function l(g,x,v,N){return x===null||x.tag!==6?(x=Wd(v,g.mode,N),x.return=g,x):(x=s(x,v),x.return=g,x)}function c(g,x,v,N){var _=v.type;return _===Is?u(g,x,v.props.children,N,v.key):x!==null&&(x.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===dn&&Wp(_)===x.type)?(N=s(x,v.props),N.ref=Ba(g,x,v),N.return=g,N):(N=pl(v.type,v.key,v.props,null,g.mode,N),N.ref=Ba(g,x,v),N.return=g,N)}function d(g,x,v,N){return x===null||x.tag!==4||x.stateNode.containerInfo!==v.containerInfo||x.stateNode.implementation!==v.implementation?(x=Hd(v,g.mode,N),x.return=g,x):(x=s(x,v.children||[]),x.return=g,x)}function u(g,x,v,N,_){return x===null||x.tag!==7?(x=as(v,g.mode,N,_),x.return=g,x):(x=s(x,v),x.return=g,x)}function m(g,x,v){if(typeof x=="string"&&x!==""||typeof x=="number")return x=Wd(""+x,g.mode,v),x.return=g,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case _o:return v=pl(x.type,x.key,x.props,null,g.mode,v),v.ref=Ba(g,null,x),v.return=g,v;case Ls:return x=Hd(x,g.mode,v),x.return=g,x;case dn:var N=x._init;return m(g,N(x._payload),v)}if(si(x)||Ma(x))return x=as(x,g.mode,v,null),x.return=g,x;Lo(g,x)}return null}function f(g,x,v,N){var _=x!==null?x.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return _!==null?null:l(g,x,""+v,N);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case _o:return v.key===_?c(g,x,v,N):null;case Ls:return v.key===_?d(g,x,v,N):null;case dn:return _=v._init,f(g,x,_(v._payload),N)}if(si(v)||Ma(v))return _!==null?null:u(g,x,v,N,null);Lo(g,v)}return null}function h(g,x,v,N,_){if(typeof N=="string"&&N!==""||typeof N=="number")return g=g.get(v)||null,l(x,g,""+N,_);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case _o:return g=g.get(N.key===null?v:N.key)||null,c(x,g,N,_);case Ls:return g=g.get(N.key===null?v:N.key)||null,d(x,g,N,_);case dn:var C=N._init;return h(g,x,v,C(N._payload),_)}if(si(N)||Ma(N))return g=g.get(v)||null,u(x,g,N,_,null);Lo(x,N)}return null}function y(g,x,v,N){for(var _=null,C=null,j=x,k=x=0,S=null;j!==null&&k<v.length;k++){j.index>k?(S=j,j=null):S=j.sibling;var D=f(g,j,v[k],N);if(D===null){j===null&&(j=S);break}e&&j&&D.alternate===null&&t(g,j),x=a(D,x,k),C===null?_=D:C.sibling=D,C=D,j=S}if(k===v.length)return r(g,j),Me&&Vn(g,k),_;if(j===null){for(;k<v.length;k++)j=m(g,v[k],N),j!==null&&(x=a(j,x,k),C===null?_=j:C.sibling=j,C=j);return Me&&Vn(g,k),_}for(j=n(g,j);k<v.length;k++)S=h(j,g,k,v[k],N),S!==null&&(e&&S.alternate!==null&&j.delete(S.key===null?k:S.key),x=a(S,x,k),C===null?_=S:C.sibling=S,C=S);return e&&j.forEach(function(R){return t(g,R)}),Me&&Vn(g,k),_}function w(g,x,v,N){var _=Ma(v);if(typeof _!="function")throw Error(V(150));if(v=_.call(v),v==null)throw Error(V(151));for(var C=_=null,j=x,k=x=0,S=null,D=v.next();j!==null&&!D.done;k++,D=v.next()){j.index>k?(S=j,j=null):S=j.sibling;var R=f(g,j,D.value,N);if(R===null){j===null&&(j=S);break}e&&j&&R.alternate===null&&t(g,j),x=a(R,x,k),C===null?_=R:C.sibling=R,C=R,j=S}if(D.done)return r(g,j),Me&&Vn(g,k),_;if(j===null){for(;!D.done;k++,D=v.next())D=m(g,D.value,N),D!==null&&(x=a(D,x,k),C===null?_=D:C.sibling=D,C=D);return Me&&Vn(g,k),_}for(j=n(g,j);!D.done;k++,D=v.next())D=h(j,g,k,D.value,N),D!==null&&(e&&D.alternate!==null&&j.delete(D.key===null?k:D.key),x=a(D,x,k),C===null?_=D:C.sibling=D,C=D);return e&&j.forEach(function(P){return t(g,P)}),Me&&Vn(g,k),_}function b(g,x,v,N){if(typeof v=="object"&&v!==null&&v.type===Is&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case _o:e:{for(var _=v.key,C=x;C!==null;){if(C.key===_){if(_=v.type,_===Is){if(C.tag===7){r(g,C.sibling),x=s(C,v.props.children),x.return=g,g=x;break e}}else if(C.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===dn&&Wp(_)===C.type){r(g,C.sibling),x=s(C,v.props),x.ref=Ba(g,C,v),x.return=g,g=x;break e}r(g,C);break}else t(g,C);C=C.sibling}v.type===Is?(x=as(v.props.children,g.mode,N,v.key),x.return=g,g=x):(N=pl(v.type,v.key,v.props,null,g.mode,N),N.ref=Ba(g,x,v),N.return=g,g=N)}return o(g);case Ls:e:{for(C=v.key;x!==null;){if(x.key===C)if(x.tag===4&&x.stateNode.containerInfo===v.containerInfo&&x.stateNode.implementation===v.implementation){r(g,x.sibling),x=s(x,v.children||[]),x.return=g,g=x;break e}else{r(g,x);break}else t(g,x);x=x.sibling}x=Hd(v,g.mode,N),x.return=g,g=x}return o(g);case dn:return C=v._init,b(g,x,C(v._payload),N)}if(si(v))return y(g,x,v,N);if(Ma(v))return w(g,x,v,N);Lo(g,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,x!==null&&x.tag===6?(r(g,x.sibling),x=s(x,v),x.return=g,g=x):(r(g,x),x=Wd(v,g.mode,N),x.return=g,g=x),o(g)):r(g,x)}return b}var na=Ry(!0),Ly=Ry(!1),Bl=On(null),Ul=null,Ws=null,km=null;function Sm(){km=Ws=Ul=null}function Cm(e){var t=Bl.current;Te(Bl),e._currentValue=t}function of(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Qs(e,t){Ul=e,km=Ws=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(kt=!0),e.firstContext=null)}function Jt(e){var t=e._currentValue;if(km!==e)if(e={context:e,memoizedValue:t,next:null},Ws===null){if(Ul===null)throw Error(V(308));Ws=e,Ul.dependencies={lanes:0,firstContext:e}}else Ws=Ws.next=e;return t}var Zn=null;function Dm(e){Zn===null?Zn=[e]:Zn.push(e)}function Iy(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,Dm(t)):(r.next=s.next,s.next=r),t.interleaved=r,Zr(e,n)}function Zr(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var un=!1;function Em(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function My(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function zr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function _n(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,xe&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,Zr(e,r)}return s=n.interleaved,s===null?(t.next=t,Dm(n)):(t.next=s.next,s.next=t),n.interleaved=t,Zr(e,r)}function cl(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,hm(e,r)}}function Hp(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=o:a=a.next=o,r=r.next}while(r!==null);a===null?s=a=t:a=a.next=t}else s=a=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Wl(e,t,r,n){var s=e.updateQueue;un=!1;var a=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?a=d:o.next=d,o=c;var u=e.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==o&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(a!==null){var m=s.baseState;o=0,u=d=c=null,l=a;do{var f=l.lane,h=l.eventTime;if((n&f)===f){u!==null&&(u=u.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var y=e,w=l;switch(f=t,h=r,w.tag){case 1:if(y=w.payload,typeof y=="function"){m=y.call(h,m,f);break e}m=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=w.payload,f=typeof y=="function"?y.call(h,m,f):y,f==null)break e;m=Be({},m,f);break e;case 2:un=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,f=s.effects,f===null?s.effects=[l]:f.push(l))}else h={eventTime:h,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=h,c=m):u=u.next=h,o|=f;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;f=l,l=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(1);if(u===null&&(c=m),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=u,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else a===null&&(s.shared.lanes=0);ms|=o,e.lanes=o,e.memoizedState=m}}function zp(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(V(191,s));s.call(n)}}}var no={},Er=On(no),Mi=On(no),Oi=On(no);function es(e){if(e===no)throw Error(V(174));return e}function Pm(e,t){switch(Ee(Oi,t),Ee(Mi,e),Ee(Er,no),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Bu(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Bu(t,e)}Te(Er),Ee(Er,t)}function sa(){Te(Er),Te(Mi),Te(Oi)}function Oy(e){es(Oi.current);var t=es(Er.current),r=Bu(t,e.type);t!==r&&(Ee(Mi,e),Ee(Er,r))}function Tm(e){Mi.current===e&&(Te(Er),Te(Mi))}var Ae=On(0);function Hl(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Od=[];function Rm(){for(var e=0;e<Od.length;e++)Od[e]._workInProgressVersionPrimary=null;Od.length=0}var dl=nn.ReactCurrentDispatcher,Ad=nn.ReactCurrentBatchConfig,fs=0,Fe=null,Ke=null,Je=null,zl=!1,hi=!1,Ai=0,Gj=0;function lt(){throw Error(V(321))}function Lm(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!dr(e[r],t[r]))return!1;return!0}function Im(e,t,r,n,s,a){if(fs=a,Fe=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,dl.current=e===null||e.memoizedState===null?Xj:Zj,e=r(n,s),hi){a=0;do{if(hi=!1,Ai=0,25<=a)throw Error(V(301));a+=1,Je=Ke=null,t.updateQueue=null,dl.current=eN,e=r(n,s)}while(hi)}if(dl.current=Vl,t=Ke!==null&&Ke.next!==null,fs=0,Je=Ke=Fe=null,zl=!1,t)throw Error(V(300));return e}function Mm(){var e=Ai!==0;return Ai=0,e}function vr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Je===null?Fe.memoizedState=Je=e:Je=Je.next=e,Je}function Xt(){if(Ke===null){var e=Fe.alternate;e=e!==null?e.memoizedState:null}else e=Ke.next;var t=Je===null?Fe.memoizedState:Je.next;if(t!==null)Je=t,Ke=e;else{if(e===null)throw Error(V(310));Ke=e,e={memoizedState:Ke.memoizedState,baseState:Ke.baseState,baseQueue:Ke.baseQueue,queue:Ke.queue,next:null},Je===null?Fe.memoizedState=Je=e:Je=Je.next=e}return Je}function $i(e,t){return typeof t=="function"?t(e):t}function $d(e){var t=Xt(),r=t.queue;if(r===null)throw Error(V(311));r.lastRenderedReducer=e;var n=Ke,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var o=s.next;s.next=a.next,a.next=o}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var l=o=null,c=null,d=a;do{var u=d.lane;if((fs&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var m={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=m,o=n):c=c.next=m,Fe.lanes|=u,ms|=u}d=d.next}while(d!==null&&d!==a);c===null?o=n:c.next=l,dr(n,t.memoizedState)||(kt=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do a=s.lane,Fe.lanes|=a,ms|=a,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Fd(e){var t=Xt(),r=t.queue;if(r===null)throw Error(V(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,a=t.memoizedState;if(s!==null){r.pending=null;var o=s=s.next;do a=e(a,o.action),o=o.next;while(o!==s);dr(a,t.memoizedState)||(kt=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function Ay(){}function $y(e,t){var r=Fe,n=Xt(),s=t(),a=!dr(n.memoizedState,s);if(a&&(n.memoizedState=s,kt=!0),n=n.queue,Om(Uy.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||Je!==null&&Je.memoizedState.tag&1){if(r.flags|=2048,Fi(9,By.bind(null,r,n,s,t),void 0,null),Xe===null)throw Error(V(349));fs&30||Fy(r,t,s)}return s}function Fy(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Fe.updateQueue,t===null?(t={lastEffect:null,stores:null},Fe.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function By(e,t,r,n){t.value=r,t.getSnapshot=n,Wy(t)&&Hy(e)}function Uy(e,t,r){return r(function(){Wy(t)&&Hy(e)})}function Wy(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!dr(e,r)}catch{return!0}}function Hy(e){var t=Zr(e,1);t!==null&&lr(t,e,1,-1)}function Vp(e){var t=vr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$i,lastRenderedState:e},t.queue=e,e=e.dispatch=Jj.bind(null,Fe,e),[t.memoizedState,e]}function Fi(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Fe.updateQueue,t===null?(t={lastEffect:null,stores:null},Fe.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function zy(){return Xt().memoizedState}function ul(e,t,r,n){var s=vr();Fe.flags|=e,s.memoizedState=Fi(1|t,r,void 0,n===void 0?null:n)}function Pc(e,t,r,n){var s=Xt();n=n===void 0?null:n;var a=void 0;if(Ke!==null){var o=Ke.memoizedState;if(a=o.destroy,n!==null&&Lm(n,o.deps)){s.memoizedState=Fi(t,r,a,n);return}}Fe.flags|=e,s.memoizedState=Fi(1|t,r,a,n)}function Yp(e,t){return ul(8390656,8,e,t)}function Om(e,t){return Pc(2048,8,e,t)}function Vy(e,t){return Pc(4,2,e,t)}function Yy(e,t){return Pc(4,4,e,t)}function qy(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Gy(e,t,r){return r=r!=null?r.concat([e]):null,Pc(4,4,qy.bind(null,t,e),r)}function Am(){}function Ky(e,t){var r=Xt();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Lm(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Qy(e,t){var r=Xt();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Lm(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Jy(e,t,r){return fs&21?(dr(r,t)||(r=ry(),Fe.lanes|=r,ms|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,kt=!0),e.memoizedState=r)}function Kj(e,t){var r=ke;ke=r!==0&&4>r?r:4,e(!0);var n=Ad.transition;Ad.transition={};try{e(!1),t()}finally{ke=r,Ad.transition=n}}function Xy(){return Xt().memoizedState}function Qj(e,t,r){var n=Nn(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Zy(e))ev(t,r);else if(r=Iy(e,t,r,n),r!==null){var s=vt();lr(r,e,n,s),tv(r,t,n)}}function Jj(e,t,r){var n=Nn(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Zy(e))ev(t,s);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var o=t.lastRenderedState,l=a(o,r);if(s.hasEagerState=!0,s.eagerState=l,dr(l,o)){var c=t.interleaved;c===null?(s.next=s,Dm(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}r=Iy(e,t,s,n),r!==null&&(s=vt(),lr(r,e,n,s),tv(r,t,n))}}function Zy(e){var t=e.alternate;return e===Fe||t!==null&&t===Fe}function ev(e,t){hi=zl=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function tv(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,hm(e,r)}}var Vl={readContext:Jt,useCallback:lt,useContext:lt,useEffect:lt,useImperativeHandle:lt,useInsertionEffect:lt,useLayoutEffect:lt,useMemo:lt,useReducer:lt,useRef:lt,useState:lt,useDebugValue:lt,useDeferredValue:lt,useTransition:lt,useMutableSource:lt,useSyncExternalStore:lt,useId:lt,unstable_isNewReconciler:!1},Xj={readContext:Jt,useCallback:function(e,t){return vr().memoizedState=[e,t===void 0?null:t],e},useContext:Jt,useEffect:Yp,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,ul(4194308,4,qy.bind(null,t,e),r)},useLayoutEffect:function(e,t){return ul(4194308,4,e,t)},useInsertionEffect:function(e,t){return ul(4,2,e,t)},useMemo:function(e,t){var r=vr();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=vr();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Qj.bind(null,Fe,e),[n.memoizedState,e]},useRef:function(e){var t=vr();return e={current:e},t.memoizedState=e},useState:Vp,useDebugValue:Am,useDeferredValue:function(e){return vr().memoizedState=e},useTransition:function(){var e=Vp(!1),t=e[0];return e=Kj.bind(null,e[1]),vr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Fe,s=vr();if(Me){if(r===void 0)throw Error(V(407));r=r()}else{if(r=t(),Xe===null)throw Error(V(349));fs&30||Fy(n,t,r)}s.memoizedState=r;var a={value:r,getSnapshot:t};return s.queue=a,Yp(Uy.bind(null,n,a,e),[e]),n.flags|=2048,Fi(9,By.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=vr(),t=Xe.identifierPrefix;if(Me){var r=Wr,n=Ur;r=(n&~(1<<32-or(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Ai++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Gj++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Zj={readContext:Jt,useCallback:Ky,useContext:Jt,useEffect:Om,useImperativeHandle:Gy,useInsertionEffect:Vy,useLayoutEffect:Yy,useMemo:Qy,useReducer:$d,useRef:zy,useState:function(){return $d($i)},useDebugValue:Am,useDeferredValue:function(e){var t=Xt();return Jy(t,Ke.memoizedState,e)},useTransition:function(){var e=$d($i)[0],t=Xt().memoizedState;return[e,t]},useMutableSource:Ay,useSyncExternalStore:$y,useId:Xy,unstable_isNewReconciler:!1},eN={readContext:Jt,useCallback:Ky,useContext:Jt,useEffect:Om,useImperativeHandle:Gy,useInsertionEffect:Vy,useLayoutEffect:Yy,useMemo:Qy,useReducer:Fd,useRef:zy,useState:function(){return Fd($i)},useDebugValue:Am,useDeferredValue:function(e){var t=Xt();return Ke===null?t.memoizedState=e:Jy(t,Ke.memoizedState,e)},useTransition:function(){var e=Fd($i)[0],t=Xt().memoizedState;return[e,t]},useMutableSource:Ay,useSyncExternalStore:$y,useId:Xy,unstable_isNewReconciler:!1};function rr(e,t){if(e&&e.defaultProps){t=Be({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function lf(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Be({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Tc={isMounted:function(e){return(e=e._reactInternals)?vs(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=vt(),s=Nn(e),a=zr(n,s);a.payload=t,r!=null&&(a.callback=r),t=_n(e,a,s),t!==null&&(lr(t,e,s,n),cl(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=vt(),s=Nn(e),a=zr(n,s);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=_n(e,a,s),t!==null&&(lr(t,e,s,n),cl(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=vt(),n=Nn(e),s=zr(r,n);s.tag=2,t!=null&&(s.callback=t),t=_n(e,s,n),t!==null&&(lr(t,e,n,r),cl(t,e,n))}};function qp(e,t,r,n,s,a,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,o):t.prototype&&t.prototype.isPureReactComponent?!Ti(r,n)||!Ti(s,a):!0}function rv(e,t,r){var n=!1,s=Tn,a=t.contextType;return typeof a=="object"&&a!==null?a=Jt(a):(s=Ct(t)?ds:ft.current,n=t.contextTypes,a=(n=n!=null)?ta(e,s):Tn),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Tc,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=a),t}function Gp(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Tc.enqueueReplaceState(t,t.state,null)}function cf(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},Em(e);var a=t.contextType;typeof a=="object"&&a!==null?s.context=Jt(a):(a=Ct(t)?ds:ft.current,s.context=ta(e,a)),s.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(lf(e,t,a,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Tc.enqueueReplaceState(s,s.state,null),Wl(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function aa(e,t){try{var r="",n=t;do r+=D1(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:s,digest:null}}function Bd(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function df(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var tN=typeof WeakMap=="function"?WeakMap:Map;function nv(e,t,r){r=zr(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){ql||(ql=!0,bf=n),df(e,t)},r}function sv(e,t,r){r=zr(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){df(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){df(e,t),typeof n!="function"&&(jn===null?jn=new Set([this]):jn.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function Kp(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new tN;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=pN.bind(null,e,t,r),t.then(e,e))}function Qp(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Jp(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=zr(-1,1),t.tag=2,_n(r,t,1))),r.lanes|=1),e)}var rN=nn.ReactCurrentOwner,kt=!1;function gt(e,t,r,n){t.child=e===null?Ly(t,null,r,n):na(t,e.child,r,n)}function Xp(e,t,r,n,s){r=r.render;var a=t.ref;return Qs(t,s),n=Im(e,t,r,n,a,s),r=Mm(),e!==null&&!kt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,en(e,t,s)):(Me&&r&&_m(t),t.flags|=1,gt(e,t,n,s),t.child)}function Zp(e,t,r,n,s){if(e===null){var a=r.type;return typeof a=="function"&&!Vm(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,av(e,t,a,n,s)):(e=pl(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&s)){var o=a.memoizedProps;if(r=r.compare,r=r!==null?r:Ti,r(o,n)&&e.ref===t.ref)return en(e,t,s)}return t.flags|=1,e=kn(a,n),e.ref=t.ref,e.return=t,t.child=e}function av(e,t,r,n,s){if(e!==null){var a=e.memoizedProps;if(Ti(a,n)&&e.ref===t.ref)if(kt=!1,t.pendingProps=n=a,(e.lanes&s)!==0)e.flags&131072&&(kt=!0);else return t.lanes=e.lanes,en(e,t,s)}return uf(e,t,r,n,s)}function iv(e,t,r){var n=t.pendingProps,s=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ee(zs,Pt),Pt|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ee(zs,Pt),Pt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,Ee(zs,Pt),Pt|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,Ee(zs,Pt),Pt|=n;return gt(e,t,s,r),t.child}function ov(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function uf(e,t,r,n,s){var a=Ct(r)?ds:ft.current;return a=ta(t,a),Qs(t,s),r=Im(e,t,r,n,a,s),n=Mm(),e!==null&&!kt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,en(e,t,s)):(Me&&n&&_m(t),t.flags|=1,gt(e,t,r,s),t.child)}function eg(e,t,r,n,s){if(Ct(r)){var a=!0;Al(t)}else a=!1;if(Qs(t,s),t.stateNode===null)fl(e,t),rv(t,r,n),cf(t,r,n,s),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,d=r.contextType;typeof d=="object"&&d!==null?d=Jt(d):(d=Ct(r)?ds:ft.current,d=ta(t,d));var u=r.getDerivedStateFromProps,m=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==d)&&Gp(t,o,n,d),un=!1;var f=t.memoizedState;o.state=f,Wl(t,n,o,s),c=t.memoizedState,l!==n||f!==c||St.current||un?(typeof u=="function"&&(lf(t,r,u,n),c=t.memoizedState),(l=un||qp(t,r,l,n,f,c,d))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=d,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,My(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:rr(t.type,l),o.props=d,m=t.pendingProps,f=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=Jt(c):(c=Ct(r)?ds:ft.current,c=ta(t,c));var h=r.getDerivedStateFromProps;(u=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==m||f!==c)&&Gp(t,o,n,c),un=!1,f=t.memoizedState,o.state=f,Wl(t,n,o,s);var y=t.memoizedState;l!==m||f!==y||St.current||un?(typeof h=="function"&&(lf(t,r,h,n),y=t.memoizedState),(d=un||qp(t,r,d,n,f,y,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,y,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,y,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=y),o.props=n,o.state=y,o.context=c,n=d):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),n=!1)}return ff(e,t,r,n,a,s)}function ff(e,t,r,n,s,a){ov(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return s&&Fp(t,r,!1),en(e,t,a);n=t.stateNode,rN.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=na(t,e.child,null,a),t.child=na(t,null,l,a)):gt(e,t,l,a),t.memoizedState=n.state,s&&Fp(t,r,!0),t.child}function lv(e){var t=e.stateNode;t.pendingContext?$p(e,t.pendingContext,t.pendingContext!==t.context):t.context&&$p(e,t.context,!1),Pm(e,t.containerInfo)}function tg(e,t,r,n,s){return ra(),Nm(s),t.flags|=256,gt(e,t,r,n),t.child}var mf={dehydrated:null,treeContext:null,retryLane:0};function hf(e){return{baseLanes:e,cachePool:null,transitions:null}}function cv(e,t,r){var n=t.pendingProps,s=Ae.current,a=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Ee(Ae,s&1),e===null)return af(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,a?(n=t.mode,a=t.child,o={mode:"hidden",children:o},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=Ic(o,n,0,null),e=as(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=hf(r),t.memoizedState=mf,e):$m(t,o));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return nN(e,t,o,n,l,s,r);if(a){a=n.fallback,o=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=kn(s,c),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?a=kn(l,a):(a=as(a,o,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,o=e.child.memoizedState,o=o===null?hf(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=e.childLanes&~r,t.memoizedState=mf,n}return a=e.child,e=a.sibling,n=kn(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function $m(e,t){return t=Ic({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Io(e,t,r,n){return n!==null&&Nm(n),na(t,e.child,null,r),e=$m(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function nN(e,t,r,n,s,a,o){if(r)return t.flags&256?(t.flags&=-257,n=Bd(Error(V(422))),Io(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,s=t.mode,n=Ic({mode:"visible",children:n.children},s,0,null),a=as(a,s,o,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&na(t,e.child,null,o),t.child.memoizedState=hf(o),t.memoizedState=mf,a);if(!(t.mode&1))return Io(e,t,o,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,a=Error(V(419)),n=Bd(a,n,void 0),Io(e,t,o,n)}if(l=(o&e.childLanes)!==0,kt||l){if(n=Xe,n!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|o)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,Zr(e,s),lr(n,e,s,-1))}return zm(),n=Bd(Error(V(421))),Io(e,t,o,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=gN.bind(null,e),s._reactRetry=t,null):(e=a.treeContext,Tt=wn(s.nextSibling),Lt=t,Me=!0,ar=null,e!==null&&(Ht[zt++]=Ur,Ht[zt++]=Wr,Ht[zt++]=us,Ur=e.id,Wr=e.overflow,us=t),t=$m(t,n.children),t.flags|=4096,t)}function rg(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),of(e.return,t,r)}function Ud(e,t,r,n,s){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function dv(e,t,r){var n=t.pendingProps,s=n.revealOrder,a=n.tail;if(gt(e,t,n.children,r),n=Ae.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&rg(e,r,t);else if(e.tag===19)rg(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Ee(Ae,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&Hl(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),Ud(t,!1,s,r,a);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Hl(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}Ud(t,!0,r,null,a);break;case"together":Ud(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function fl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function en(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),ms|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(V(153));if(t.child!==null){for(e=t.child,r=kn(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=kn(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function sN(e,t,r){switch(t.tag){case 3:lv(t),ra();break;case 5:Oy(t);break;case 1:Ct(t.type)&&Al(t);break;case 4:Pm(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;Ee(Bl,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Ee(Ae,Ae.current&1),t.flags|=128,null):r&t.child.childLanes?cv(e,t,r):(Ee(Ae,Ae.current&1),e=en(e,t,r),e!==null?e.sibling:null);Ee(Ae,Ae.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return dv(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ee(Ae,Ae.current),n)break;return null;case 22:case 23:return t.lanes=0,iv(e,t,r)}return en(e,t,r)}var uv,pf,fv,mv;uv=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};pf=function(){};fv=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,es(Er.current);var a=null;switch(r){case"input":s=Ou(e,s),n=Ou(e,n),a=[];break;case"select":s=Be({},s,{value:void 0}),n=Be({},n,{value:void 0}),a=[];break;case"textarea":s=Fu(e,s),n=Fu(e,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Ml)}Uu(r,n);var o;r=null;for(d in s)if(!n.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Ni.hasOwnProperty(d)?a||(a=[]):(a=a||[]).push(d,null));for(d in n){var c=n[d];if(l=s!=null?s[d]:void 0,n.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(a||(a=[]),a.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(a=a||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Ni.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Pe("scroll",e),a||l===c||(a=[])):(a=a||[]).push(d,c))}r&&(a=a||[]).push("style",r);var d=a;(t.updateQueue=d)&&(t.flags|=4)}};mv=function(e,t,r,n){r!==n&&(t.flags|=4)};function Ua(e,t){if(!Me)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function ct(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function aN(e,t,r){var n=t.pendingProps;switch(jm(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ct(t),null;case 1:return Ct(t.type)&&Ol(),ct(t),null;case 3:return n=t.stateNode,sa(),Te(St),Te(ft),Rm(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Ro(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ar!==null&&(jf(ar),ar=null))),pf(e,t),ct(t),null;case 5:Tm(t);var s=es(Oi.current);if(r=t.type,e!==null&&t.stateNode!=null)fv(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(V(166));return ct(t),null}if(e=es(Er.current),Ro(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[jr]=t,n[Ii]=a,e=(t.mode&1)!==0,r){case"dialog":Pe("cancel",n),Pe("close",n);break;case"iframe":case"object":case"embed":Pe("load",n);break;case"video":case"audio":for(s=0;s<ii.length;s++)Pe(ii[s],n);break;case"source":Pe("error",n);break;case"img":case"image":case"link":Pe("error",n),Pe("load",n);break;case"details":Pe("toggle",n);break;case"input":up(n,a),Pe("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},Pe("invalid",n);break;case"textarea":mp(n,a),Pe("invalid",n)}Uu(r,a),s=null;for(var o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="children"?typeof l=="string"?n.textContent!==l&&(a.suppressHydrationWarning!==!0&&To(n.textContent,l,e),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&To(n.textContent,l,e),s=["children",""+l]):Ni.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Pe("scroll",n)}switch(r){case"input":jo(n),fp(n,a,!0);break;case"textarea":jo(n),hp(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=Ml)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Ux(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[jr]=t,e[Ii]=n,uv(e,t,!1,!1),t.stateNode=e;e:{switch(o=Wu(r,n),r){case"dialog":Pe("cancel",e),Pe("close",e),s=n;break;case"iframe":case"object":case"embed":Pe("load",e),s=n;break;case"video":case"audio":for(s=0;s<ii.length;s++)Pe(ii[s],e);s=n;break;case"source":Pe("error",e),s=n;break;case"img":case"image":case"link":Pe("error",e),Pe("load",e),s=n;break;case"details":Pe("toggle",e),s=n;break;case"input":up(e,n),s=Ou(e,n),Pe("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=Be({},n,{value:void 0}),Pe("invalid",e);break;case"textarea":mp(e,n),s=Fu(e,n),Pe("invalid",e);break;default:s=n}Uu(r,s),l=s;for(a in l)if(l.hasOwnProperty(a)){var c=l[a];a==="style"?zx(e,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Wx(e,c)):a==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&ki(e,c):typeof c=="number"&&ki(e,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Ni.hasOwnProperty(a)?c!=null&&a==="onScroll"&&Pe("scroll",e):c!=null&&lm(e,a,c,o))}switch(r){case"input":jo(e),fp(e,n,!1);break;case"textarea":jo(e),hp(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Pn(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?Ys(e,!!n.multiple,a,!1):n.defaultValue!=null&&Ys(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Ml)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ct(t),null;case 6:if(e&&t.stateNode!=null)mv(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(V(166));if(r=es(Oi.current),es(Er.current),Ro(t)){if(n=t.stateNode,r=t.memoizedProps,n[jr]=t,(a=n.nodeValue!==r)&&(e=Lt,e!==null))switch(e.tag){case 3:To(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&To(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[jr]=t,t.stateNode=n}return ct(t),null;case 13:if(Te(Ae),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Me&&Tt!==null&&t.mode&1&&!(t.flags&128))Ty(),ra(),t.flags|=98560,a=!1;else if(a=Ro(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(V(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(V(317));a[jr]=t}else ra(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ct(t),a=!1}else ar!==null&&(jf(ar),ar=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Ae.current&1?Qe===0&&(Qe=3):zm())),t.updateQueue!==null&&(t.flags|=4),ct(t),null);case 4:return sa(),pf(e,t),e===null&&Ri(t.stateNode.containerInfo),ct(t),null;case 10:return Cm(t.type._context),ct(t),null;case 17:return Ct(t.type)&&Ol(),ct(t),null;case 19:if(Te(Ae),a=t.memoizedState,a===null)return ct(t),null;if(n=(t.flags&128)!==0,o=a.rendering,o===null)if(n)Ua(a,!1);else{if(Qe!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Hl(e),o!==null){for(t.flags|=128,Ua(a,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,e=o.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Ee(Ae,Ae.current&1|2),t.child}e=e.sibling}a.tail!==null&&He()>ia&&(t.flags|=128,n=!0,Ua(a,!1),t.lanes=4194304)}else{if(!n)if(e=Hl(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Ua(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!Me)return ct(t),null}else 2*He()-a.renderingStartTime>ia&&r!==1073741824&&(t.flags|=128,n=!0,Ua(a,!1),t.lanes=4194304);a.isBackwards?(o.sibling=t.child,t.child=o):(r=a.last,r!==null?r.sibling=o:t.child=o,a.last=o)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=He(),t.sibling=null,r=Ae.current,Ee(Ae,n?r&1|2:r&1),t):(ct(t),null);case 22:case 23:return Hm(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Pt&1073741824&&(ct(t),t.subtreeFlags&6&&(t.flags|=8192)):ct(t),null;case 24:return null;case 25:return null}throw Error(V(156,t.tag))}function iN(e,t){switch(jm(t),t.tag){case 1:return Ct(t.type)&&Ol(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return sa(),Te(St),Te(ft),Rm(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Tm(t),null;case 13:if(Te(Ae),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(V(340));ra()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Te(Ae),null;case 4:return sa(),null;case 10:return Cm(t.type._context),null;case 22:case 23:return Hm(),null;case 24:return null;default:return null}}var Mo=!1,dt=!1,oN=typeof WeakSet=="function"?WeakSet:Set,X=null;function Hs(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Ue(e,t,n)}else r.current=null}function gf(e,t,r){try{r()}catch(n){Ue(e,t,n)}}var ng=!1;function lN(e,t){if(Xu=Rl,e=yy(),wm(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,d=0,u=0,m=e,f=null;t:for(;;){for(var h;m!==r||s!==0&&m.nodeType!==3||(l=o+s),m!==a||n!==0&&m.nodeType!==3||(c=o+n),m.nodeType===3&&(o+=m.nodeValue.length),(h=m.firstChild)!==null;)f=m,m=h;for(;;){if(m===e)break t;if(f===r&&++d===s&&(l=o),f===a&&++u===n&&(c=o),(h=m.nextSibling)!==null)break;m=f,f=m.parentNode}m=h}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Zu={focusedElem:e,selectionRange:r},Rl=!1,X=t;X!==null;)if(t=X,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,X=e;else for(;X!==null;){t=X;try{var y=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var w=y.memoizedProps,b=y.memoizedState,g=t.stateNode,x=g.getSnapshotBeforeUpdate(t.elementType===t.type?w:rr(t.type,w),b);g.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(V(163))}}catch(N){Ue(t,t.return,N)}if(e=t.sibling,e!==null){e.return=t.return,X=e;break}X=t.return}return y=ng,ng=!1,y}function pi(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var a=s.destroy;s.destroy=void 0,a!==void 0&&gf(t,r,a)}s=s.next}while(s!==n)}}function Rc(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function xf(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function hv(e){var t=e.alternate;t!==null&&(e.alternate=null,hv(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[jr],delete t[Ii],delete t[rf],delete t[zj],delete t[Vj])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function pv(e){return e.tag===5||e.tag===3||e.tag===4}function sg(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||pv(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function yf(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Ml));else if(n!==4&&(e=e.child,e!==null))for(yf(e,t,r),e=e.sibling;e!==null;)yf(e,t,r),e=e.sibling}function vf(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(vf(e,t,r),e=e.sibling;e!==null;)vf(e,t,r),e=e.sibling}var tt=null,nr=!1;function an(e,t,r){for(r=r.child;r!==null;)gv(e,t,r),r=r.sibling}function gv(e,t,r){if(Dr&&typeof Dr.onCommitFiberUnmount=="function")try{Dr.onCommitFiberUnmount(Nc,r)}catch{}switch(r.tag){case 5:dt||Hs(r,t);case 6:var n=tt,s=nr;tt=null,an(e,t,r),tt=n,nr=s,tt!==null&&(nr?(e=tt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):tt.removeChild(r.stateNode));break;case 18:tt!==null&&(nr?(e=tt,r=r.stateNode,e.nodeType===8?Id(e.parentNode,r):e.nodeType===1&&Id(e,r),Ei(e)):Id(tt,r.stateNode));break;case 4:n=tt,s=nr,tt=r.stateNode.containerInfo,nr=!0,an(e,t,r),tt=n,nr=s;break;case 0:case 11:case 14:case 15:if(!dt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&gf(r,t,o),s=s.next}while(s!==n)}an(e,t,r);break;case 1:if(!dt&&(Hs(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Ue(r,t,l)}an(e,t,r);break;case 21:an(e,t,r);break;case 22:r.mode&1?(dt=(n=dt)||r.memoizedState!==null,an(e,t,r),dt=n):an(e,t,r);break;default:an(e,t,r)}}function ag(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new oN),t.forEach(function(n){var s=xN.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function er(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:tt=l.stateNode,nr=!1;break e;case 3:tt=l.stateNode.containerInfo,nr=!0;break e;case 4:tt=l.stateNode.containerInfo,nr=!0;break e}l=l.return}if(tt===null)throw Error(V(160));gv(a,o,s),tt=null,nr=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){Ue(s,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)xv(t,e),t=t.sibling}function xv(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(er(t,e),yr(e),n&4){try{pi(3,e,e.return),Rc(3,e)}catch(w){Ue(e,e.return,w)}try{pi(5,e,e.return)}catch(w){Ue(e,e.return,w)}}break;case 1:er(t,e),yr(e),n&512&&r!==null&&Hs(r,r.return);break;case 5:if(er(t,e),yr(e),n&512&&r!==null&&Hs(r,r.return),e.flags&32){var s=e.stateNode;try{ki(s,"")}catch(w){Ue(e,e.return,w)}}if(n&4&&(s=e.stateNode,s!=null)){var a=e.memoizedProps,o=r!==null?r.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&Fx(s,a),Wu(l,o);var d=Wu(l,a);for(o=0;o<c.length;o+=2){var u=c[o],m=c[o+1];u==="style"?zx(s,m):u==="dangerouslySetInnerHTML"?Wx(s,m):u==="children"?ki(s,m):lm(s,u,m,d)}switch(l){case"input":Au(s,a);break;case"textarea":Bx(s,a);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var h=a.value;h!=null?Ys(s,!!a.multiple,h,!1):f!==!!a.multiple&&(a.defaultValue!=null?Ys(s,!!a.multiple,a.defaultValue,!0):Ys(s,!!a.multiple,a.multiple?[]:"",!1))}s[Ii]=a}catch(w){Ue(e,e.return,w)}}break;case 6:if(er(t,e),yr(e),n&4){if(e.stateNode===null)throw Error(V(162));s=e.stateNode,a=e.memoizedProps;try{s.nodeValue=a}catch(w){Ue(e,e.return,w)}}break;case 3:if(er(t,e),yr(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Ei(t.containerInfo)}catch(w){Ue(e,e.return,w)}break;case 4:er(t,e),yr(e);break;case 13:er(t,e),yr(e),s=e.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(Um=He())),n&4&&ag(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(dt=(d=dt)||u,er(t,e),dt=d):er(t,e),yr(e),n&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!u&&e.mode&1)for(X=e,u=e.child;u!==null;){for(m=X=u;X!==null;){switch(f=X,h=f.child,f.tag){case 0:case 11:case 14:case 15:pi(4,f,f.return);break;case 1:Hs(f,f.return);var y=f.stateNode;if(typeof y.componentWillUnmount=="function"){n=f,r=f.return;try{t=n,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(w){Ue(n,r,w)}}break;case 5:Hs(f,f.return);break;case 22:if(f.memoizedState!==null){og(m);continue}}h!==null?(h.return=f,X=h):og(m)}u=u.sibling}e:for(u=null,m=e;;){if(m.tag===5){if(u===null){u=m;try{s=m.stateNode,d?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=m.stateNode,c=m.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Hx("display",o))}catch(w){Ue(e,e.return,w)}}}else if(m.tag===6){if(u===null)try{m.stateNode.nodeValue=d?"":m.memoizedProps}catch(w){Ue(e,e.return,w)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===e)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===e)break e;for(;m.sibling===null;){if(m.return===null||m.return===e)break e;u===m&&(u=null),m=m.return}u===m&&(u=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:er(t,e),yr(e),n&4&&ag(e);break;case 21:break;default:er(t,e),yr(e)}}function yr(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(pv(r)){var n=r;break e}r=r.return}throw Error(V(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(ki(s,""),n.flags&=-33);var a=sg(e);vf(e,a,s);break;case 3:case 4:var o=n.stateNode.containerInfo,l=sg(e);yf(e,l,o);break;default:throw Error(V(161))}}catch(c){Ue(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function cN(e,t,r){X=e,yv(e)}function yv(e,t,r){for(var n=(e.mode&1)!==0;X!==null;){var s=X,a=s.child;if(s.tag===22&&n){var o=s.memoizedState!==null||Mo;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||dt;l=Mo;var d=dt;if(Mo=o,(dt=c)&&!d)for(X=s;X!==null;)o=X,c=o.child,o.tag===22&&o.memoizedState!==null?lg(s):c!==null?(c.return=o,X=c):lg(s);for(;a!==null;)X=a,yv(a),a=a.sibling;X=s,Mo=l,dt=d}ig(e)}else s.subtreeFlags&8772&&a!==null?(a.return=s,X=a):ig(e)}}function ig(e){for(;X!==null;){var t=X;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:dt||Rc(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!dt)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:rr(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&zp(t,a,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}zp(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var m=u.dehydrated;m!==null&&Ei(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(V(163))}dt||t.flags&512&&xf(t)}catch(f){Ue(t,t.return,f)}}if(t===e){X=null;break}if(r=t.sibling,r!==null){r.return=t.return,X=r;break}X=t.return}}function og(e){for(;X!==null;){var t=X;if(t===e){X=null;break}var r=t.sibling;if(r!==null){r.return=t.return,X=r;break}X=t.return}}function lg(e){for(;X!==null;){var t=X;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Rc(4,t)}catch(c){Ue(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(c){Ue(t,s,c)}}var a=t.return;try{xf(t)}catch(c){Ue(t,a,c)}break;case 5:var o=t.return;try{xf(t)}catch(c){Ue(t,o,c)}}}catch(c){Ue(t,t.return,c)}if(t===e){X=null;break}var l=t.sibling;if(l!==null){l.return=t.return,X=l;break}X=t.return}}var dN=Math.ceil,Yl=nn.ReactCurrentDispatcher,Fm=nn.ReactCurrentOwner,Gt=nn.ReactCurrentBatchConfig,xe=0,Xe=null,Ye=null,st=0,Pt=0,zs=On(0),Qe=0,Bi=null,ms=0,Lc=0,Bm=0,gi=null,jt=null,Um=0,ia=1/0,Ar=null,ql=!1,bf=null,jn=null,Oo=!1,xn=null,Gl=0,xi=0,wf=null,ml=-1,hl=0;function vt(){return xe&6?He():ml!==-1?ml:ml=He()}function Nn(e){return e.mode&1?xe&2&&st!==0?st&-st:qj.transition!==null?(hl===0&&(hl=ry()),hl):(e=ke,e!==0||(e=window.event,e=e===void 0?16:cy(e.type)),e):1}function lr(e,t,r,n){if(50<xi)throw xi=0,wf=null,Error(V(185));eo(e,r,n),(!(xe&2)||e!==Xe)&&(e===Xe&&(!(xe&2)&&(Lc|=r),Qe===4&&mn(e,st)),Dt(e,n),r===1&&xe===0&&!(t.mode&1)&&(ia=He()+500,Ec&&An()))}function Dt(e,t){var r=e.callbackNode;q1(e,t);var n=Tl(e,e===Xe?st:0);if(n===0)r!==null&&xp(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&xp(r),t===1)e.tag===0?Yj(cg.bind(null,e)):Dy(cg.bind(null,e)),Wj(function(){!(xe&6)&&An()}),r=null;else{switch(ny(n)){case 1:r=mm;break;case 4:r=ey;break;case 16:r=Pl;break;case 536870912:r=ty;break;default:r=Pl}r=Sv(r,vv.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function vv(e,t){if(ml=-1,hl=0,xe&6)throw Error(V(327));var r=e.callbackNode;if(Js()&&e.callbackNode!==r)return null;var n=Tl(e,e===Xe?st:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Kl(e,n);else{t=n;var s=xe;xe|=2;var a=wv();(Xe!==e||st!==t)&&(Ar=null,ia=He()+500,ss(e,t));do try{mN();break}catch(l){bv(e,l)}while(1);Sm(),Yl.current=a,xe=s,Ye!==null?t=0:(Xe=null,st=0,t=Qe)}if(t!==0){if(t===2&&(s=qu(e),s!==0&&(n=s,t=_f(e,s))),t===1)throw r=Bi,ss(e,0),mn(e,n),Dt(e,He()),r;if(t===6)mn(e,n);else{if(s=e.current.alternate,!(n&30)&&!uN(s)&&(t=Kl(e,n),t===2&&(a=qu(e),a!==0&&(n=a,t=_f(e,a))),t===1))throw r=Bi,ss(e,0),mn(e,n),Dt(e,He()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(V(345));case 2:Yn(e,jt,Ar);break;case 3:if(mn(e,n),(n&130023424)===n&&(t=Um+500-He(),10<t)){if(Tl(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){vt(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=tf(Yn.bind(null,e,jt,Ar),t);break}Yn(e,jt,Ar);break;case 4:if(mn(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var o=31-or(n);a=1<<o,o=t[o],o>s&&(s=o),n&=~a}if(n=s,n=He()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*dN(n/1960))-n,10<n){e.timeoutHandle=tf(Yn.bind(null,e,jt,Ar),n);break}Yn(e,jt,Ar);break;case 5:Yn(e,jt,Ar);break;default:throw Error(V(329))}}}return Dt(e,He()),e.callbackNode===r?vv.bind(null,e):null}function _f(e,t){var r=gi;return e.current.memoizedState.isDehydrated&&(ss(e,t).flags|=256),e=Kl(e,t),e!==2&&(t=jt,jt=r,t!==null&&jf(t)),e}function jf(e){jt===null?jt=e:jt.push.apply(jt,e)}function uN(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!dr(a(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function mn(e,t){for(t&=~Bm,t&=~Lc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-or(t),n=1<<r;e[r]=-1,t&=~n}}function cg(e){if(xe&6)throw Error(V(327));Js();var t=Tl(e,0);if(!(t&1))return Dt(e,He()),null;var r=Kl(e,t);if(e.tag!==0&&r===2){var n=qu(e);n!==0&&(t=n,r=_f(e,n))}if(r===1)throw r=Bi,ss(e,0),mn(e,t),Dt(e,He()),r;if(r===6)throw Error(V(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Yn(e,jt,Ar),Dt(e,He()),null}function Wm(e,t){var r=xe;xe|=1;try{return e(t)}finally{xe=r,xe===0&&(ia=He()+500,Ec&&An())}}function hs(e){xn!==null&&xn.tag===0&&!(xe&6)&&Js();var t=xe;xe|=1;var r=Gt.transition,n=ke;try{if(Gt.transition=null,ke=1,e)return e()}finally{ke=n,Gt.transition=r,xe=t,!(xe&6)&&An()}}function Hm(){Pt=zs.current,Te(zs)}function ss(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Uj(r)),Ye!==null)for(r=Ye.return;r!==null;){var n=r;switch(jm(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Ol();break;case 3:sa(),Te(St),Te(ft),Rm();break;case 5:Tm(n);break;case 4:sa();break;case 13:Te(Ae);break;case 19:Te(Ae);break;case 10:Cm(n.type._context);break;case 22:case 23:Hm()}r=r.return}if(Xe=e,Ye=e=kn(e.current,null),st=Pt=t,Qe=0,Bi=null,Bm=Lc=ms=0,jt=gi=null,Zn!==null){for(t=0;t<Zn.length;t++)if(r=Zn[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var o=a.next;a.next=s,n.next=o}r.pending=n}Zn=null}return e}function bv(e,t){do{var r=Ye;try{if(Sm(),dl.current=Vl,zl){for(var n=Fe.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}zl=!1}if(fs=0,Je=Ke=Fe=null,hi=!1,Ai=0,Fm.current=null,r===null||r.return===null){Qe=1,Bi=t,Ye=null;break}e:{var a=e,o=r.return,l=r,c=t;if(t=st,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,m=u.tag;if(!(u.mode&1)&&(m===0||m===11||m===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=Qp(o);if(h!==null){h.flags&=-257,Jp(h,o,l,a,t),h.mode&1&&Kp(a,d,t),t=h,c=d;var y=t.updateQueue;if(y===null){var w=new Set;w.add(c),t.updateQueue=w}else y.add(c);break e}else{if(!(t&1)){Kp(a,d,t),zm();break e}c=Error(V(426))}}else if(Me&&l.mode&1){var b=Qp(o);if(b!==null){!(b.flags&65536)&&(b.flags|=256),Jp(b,o,l,a,t),Nm(aa(c,l));break e}}a=c=aa(c,l),Qe!==4&&(Qe=2),gi===null?gi=[a]:gi.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var g=nv(a,c,t);Hp(a,g);break e;case 1:l=c;var x=a.type,v=a.stateNode;if(!(a.flags&128)&&(typeof x.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(jn===null||!jn.has(v)))){a.flags|=65536,t&=-t,a.lanes|=t;var N=sv(a,l,t);Hp(a,N);break e}}a=a.return}while(a!==null)}jv(r)}catch(_){t=_,Ye===r&&r!==null&&(Ye=r=r.return);continue}break}while(1)}function wv(){var e=Yl.current;return Yl.current=Vl,e===null?Vl:e}function zm(){(Qe===0||Qe===3||Qe===2)&&(Qe=4),Xe===null||!(ms&268435455)&&!(Lc&268435455)||mn(Xe,st)}function Kl(e,t){var r=xe;xe|=2;var n=wv();(Xe!==e||st!==t)&&(Ar=null,ss(e,t));do try{fN();break}catch(s){bv(e,s)}while(1);if(Sm(),xe=r,Yl.current=n,Ye!==null)throw Error(V(261));return Xe=null,st=0,Qe}function fN(){for(;Ye!==null;)_v(Ye)}function mN(){for(;Ye!==null&&!$1();)_v(Ye)}function _v(e){var t=kv(e.alternate,e,Pt);e.memoizedProps=e.pendingProps,t===null?jv(e):Ye=t,Fm.current=null}function jv(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=iN(r,t),r!==null){r.flags&=32767,Ye=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Qe=6,Ye=null;return}}else if(r=aN(r,t,Pt),r!==null){Ye=r;return}if(t=t.sibling,t!==null){Ye=t;return}Ye=t=e}while(t!==null);Qe===0&&(Qe=5)}function Yn(e,t,r){var n=ke,s=Gt.transition;try{Gt.transition=null,ke=1,hN(e,t,r,n)}finally{Gt.transition=s,ke=n}return null}function hN(e,t,r,n){do Js();while(xn!==null);if(xe&6)throw Error(V(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(V(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(G1(e,a),e===Xe&&(Ye=Xe=null,st=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Oo||(Oo=!0,Sv(Pl,function(){return Js(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=Gt.transition,Gt.transition=null;var o=ke;ke=1;var l=xe;xe|=4,Fm.current=null,lN(e,r),xv(r,e),Ij(Zu),Rl=!!Xu,Zu=Xu=null,e.current=r,cN(r),F1(),xe=l,ke=o,Gt.transition=a}else e.current=r;if(Oo&&(Oo=!1,xn=e,Gl=s),a=e.pendingLanes,a===0&&(jn=null),W1(r.stateNode),Dt(e,He()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(ql)throw ql=!1,e=bf,bf=null,e;return Gl&1&&e.tag!==0&&Js(),a=e.pendingLanes,a&1?e===wf?xi++:(xi=0,wf=e):xi=0,An(),null}function Js(){if(xn!==null){var e=ny(Gl),t=Gt.transition,r=ke;try{if(Gt.transition=null,ke=16>e?16:e,xn===null)var n=!1;else{if(e=xn,xn=null,Gl=0,xe&6)throw Error(V(331));var s=xe;for(xe|=4,X=e.current;X!==null;){var a=X,o=a.child;if(X.flags&16){var l=a.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(X=d;X!==null;){var u=X;switch(u.tag){case 0:case 11:case 15:pi(8,u,a)}var m=u.child;if(m!==null)m.return=u,X=m;else for(;X!==null;){u=X;var f=u.sibling,h=u.return;if(hv(u),u===d){X=null;break}if(f!==null){f.return=h,X=f;break}X=h}}}var y=a.alternate;if(y!==null){var w=y.child;if(w!==null){y.child=null;do{var b=w.sibling;w.sibling=null,w=b}while(w!==null)}}X=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,X=o;else e:for(;X!==null;){if(a=X,a.flags&2048)switch(a.tag){case 0:case 11:case 15:pi(9,a,a.return)}var g=a.sibling;if(g!==null){g.return=a.return,X=g;break e}X=a.return}}var x=e.current;for(X=x;X!==null;){o=X;var v=o.child;if(o.subtreeFlags&2064&&v!==null)v.return=o,X=v;else e:for(o=x;X!==null;){if(l=X,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Rc(9,l)}}catch(_){Ue(l,l.return,_)}if(l===o){X=null;break e}var N=l.sibling;if(N!==null){N.return=l.return,X=N;break e}X=l.return}}if(xe=s,An(),Dr&&typeof Dr.onPostCommitFiberRoot=="function")try{Dr.onPostCommitFiberRoot(Nc,e)}catch{}n=!0}return n}finally{ke=r,Gt.transition=t}}return!1}function dg(e,t,r){t=aa(r,t),t=nv(e,t,1),e=_n(e,t,1),t=vt(),e!==null&&(eo(e,1,t),Dt(e,t))}function Ue(e,t,r){if(e.tag===3)dg(e,e,r);else for(;t!==null;){if(t.tag===3){dg(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(jn===null||!jn.has(n))){e=aa(r,e),e=sv(t,e,1),t=_n(t,e,1),e=vt(),t!==null&&(eo(t,1,e),Dt(t,e));break}}t=t.return}}function pN(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=vt(),e.pingedLanes|=e.suspendedLanes&r,Xe===e&&(st&r)===r&&(Qe===4||Qe===3&&(st&130023424)===st&&500>He()-Um?ss(e,0):Bm|=r),Dt(e,t)}function Nv(e,t){t===0&&(e.mode&1?(t=So,So<<=1,!(So&130023424)&&(So=4194304)):t=1);var r=vt();e=Zr(e,t),e!==null&&(eo(e,t,r),Dt(e,r))}function gN(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Nv(e,r)}function xN(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(V(314))}n!==null&&n.delete(t),Nv(e,r)}var kv;kv=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||St.current)kt=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return kt=!1,sN(e,t,r);kt=!!(e.flags&131072)}else kt=!1,Me&&t.flags&1048576&&Ey(t,Fl,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;fl(e,t),e=t.pendingProps;var s=ta(t,ft.current);Qs(t,r),s=Im(null,t,n,e,s,r);var a=Mm();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ct(n)?(a=!0,Al(t)):a=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Em(t),s.updater=Tc,t.stateNode=s,s._reactInternals=t,cf(t,n,e,r),t=ff(null,t,n,!0,a,r)):(t.tag=0,Me&&a&&_m(t),gt(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(fl(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=vN(n),e=rr(n,e),s){case 0:t=uf(null,t,n,e,r);break e;case 1:t=eg(null,t,n,e,r);break e;case 11:t=Xp(null,t,n,e,r);break e;case 14:t=Zp(null,t,n,rr(n.type,e),r);break e}throw Error(V(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:rr(n,s),uf(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:rr(n,s),eg(e,t,n,s,r);case 3:e:{if(lv(t),e===null)throw Error(V(387));n=t.pendingProps,a=t.memoizedState,s=a.element,My(e,t),Wl(t,n,null,r);var o=t.memoizedState;if(n=o.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){s=aa(Error(V(423)),t),t=tg(e,t,n,r,s);break e}else if(n!==s){s=aa(Error(V(424)),t),t=tg(e,t,n,r,s);break e}else for(Tt=wn(t.stateNode.containerInfo.firstChild),Lt=t,Me=!0,ar=null,r=Ly(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ra(),n===s){t=en(e,t,r);break e}gt(e,t,n,r)}t=t.child}return t;case 5:return Oy(t),e===null&&af(t),n=t.type,s=t.pendingProps,a=e!==null?e.memoizedProps:null,o=s.children,ef(n,s)?o=null:a!==null&&ef(n,a)&&(t.flags|=32),ov(e,t),gt(e,t,o,r),t.child;case 6:return e===null&&af(t),null;case 13:return cv(e,t,r);case 4:return Pm(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=na(t,null,n,r):gt(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:rr(n,s),Xp(e,t,n,s,r);case 7:return gt(e,t,t.pendingProps,r),t.child;case 8:return gt(e,t,t.pendingProps.children,r),t.child;case 12:return gt(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,a=t.memoizedProps,o=s.value,Ee(Bl,n._currentValue),n._currentValue=o,a!==null)if(dr(a.value,o)){if(a.children===s.children&&!St.current){t=en(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var l=a.dependencies;if(l!==null){o=a.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(a.tag===1){c=zr(-1,r&-r),c.tag=2;var d=a.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}a.lanes|=r,c=a.alternate,c!==null&&(c.lanes|=r),of(a.return,r,t),l.lanes|=r;break}c=c.next}}else if(a.tag===10)o=a.type===t.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(V(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),of(o,r,t),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===t){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}gt(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Qs(t,r),s=Jt(s),n=n(s),t.flags|=1,gt(e,t,n,r),t.child;case 14:return n=t.type,s=rr(n,t.pendingProps),s=rr(n.type,s),Zp(e,t,n,s,r);case 15:return av(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:rr(n,s),fl(e,t),t.tag=1,Ct(n)?(e=!0,Al(t)):e=!1,Qs(t,r),rv(t,n,s),cf(t,n,s,r),ff(null,t,n,!0,e,r);case 19:return dv(e,t,r);case 22:return iv(e,t,r)}throw Error(V(156,t.tag))};function Sv(e,t){return Zx(e,t)}function yN(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Yt(e,t,r,n){return new yN(e,t,r,n)}function Vm(e){return e=e.prototype,!(!e||!e.isReactComponent)}function vN(e){if(typeof e=="function")return Vm(e)?1:0;if(e!=null){if(e=e.$$typeof,e===dm)return 11;if(e===um)return 14}return 2}function kn(e,t){var r=e.alternate;return r===null?(r=Yt(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function pl(e,t,r,n,s,a){var o=2;if(n=e,typeof e=="function")Vm(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Is:return as(r.children,s,a,t);case cm:o=8,s|=8;break;case Ru:return e=Yt(12,r,t,s|2),e.elementType=Ru,e.lanes=a,e;case Lu:return e=Yt(13,r,t,s),e.elementType=Lu,e.lanes=a,e;case Iu:return e=Yt(19,r,t,s),e.elementType=Iu,e.lanes=a,e;case Ox:return Ic(r,s,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Ix:o=10;break e;case Mx:o=9;break e;case dm:o=11;break e;case um:o=14;break e;case dn:o=16,n=null;break e}throw Error(V(130,e==null?e:typeof e,""))}return t=Yt(o,r,t,s),t.elementType=e,t.type=n,t.lanes=a,t}function as(e,t,r,n){return e=Yt(7,e,n,t),e.lanes=r,e}function Ic(e,t,r,n){return e=Yt(22,e,n,t),e.elementType=Ox,e.lanes=r,e.stateNode={isHidden:!1},e}function Wd(e,t,r){return e=Yt(6,e,null,t),e.lanes=r,e}function Hd(e,t,r){return t=Yt(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function bN(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=jd(0),this.expirationTimes=jd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=jd(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Ym(e,t,r,n,s,a,o,l,c){return e=new bN(e,t,r,l,c),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Yt(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Em(a),e}function wN(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ls,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Cv(e){if(!e)return Tn;e=e._reactInternals;e:{if(vs(e)!==e||e.tag!==1)throw Error(V(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ct(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(V(171))}if(e.tag===1){var r=e.type;if(Ct(r))return Cy(e,r,t)}return t}function Dv(e,t,r,n,s,a,o,l,c){return e=Ym(r,n,!0,e,s,a,o,l,c),e.context=Cv(null),r=e.current,n=vt(),s=Nn(r),a=zr(n,s),a.callback=t??null,_n(r,a,s),e.current.lanes=s,eo(e,s,n),Dt(e,n),e}function Mc(e,t,r,n){var s=t.current,a=vt(),o=Nn(s);return r=Cv(r),t.context===null?t.context=r:t.pendingContext=r,t=zr(a,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=_n(s,t,o),e!==null&&(lr(e,s,o,a),cl(e,s,o)),o}function Ql(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function ug(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function qm(e,t){ug(e,t),(e=e.alternate)&&ug(e,t)}function _N(){return null}var Ev=typeof reportError=="function"?reportError:function(e){console.error(e)};function Gm(e){this._internalRoot=e}Oc.prototype.render=Gm.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(V(409));Mc(e,t,null,null)};Oc.prototype.unmount=Gm.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;hs(function(){Mc(null,e,null,null)}),t[Xr]=null}};function Oc(e){this._internalRoot=e}Oc.prototype.unstable_scheduleHydration=function(e){if(e){var t=iy();e={blockedOn:null,target:e,priority:t};for(var r=0;r<fn.length&&t!==0&&t<fn[r].priority;r++);fn.splice(r,0,e),r===0&&ly(e)}};function Km(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Ac(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function fg(){}function jN(e,t,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var d=Ql(o);a.call(d)}}var o=Dv(t,n,e,0,null,!1,!1,"",fg);return e._reactRootContainer=o,e[Xr]=o.current,Ri(e.nodeType===8?e.parentNode:e),hs(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var d=Ql(c);l.call(d)}}var c=Ym(e,0,!1,null,null,!1,!1,"",fg);return e._reactRootContainer=c,e[Xr]=c.current,Ri(e.nodeType===8?e.parentNode:e),hs(function(){Mc(t,c,r,n)}),c}function $c(e,t,r,n,s){var a=r._reactRootContainer;if(a){var o=a;if(typeof s=="function"){var l=s;s=function(){var c=Ql(o);l.call(c)}}Mc(t,o,e,s)}else o=jN(r,t,e,s,n);return Ql(o)}sy=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ai(t.pendingLanes);r!==0&&(hm(t,r|1),Dt(t,He()),!(xe&6)&&(ia=He()+500,An()))}break;case 13:hs(function(){var n=Zr(e,1);if(n!==null){var s=vt();lr(n,e,1,s)}}),qm(e,1)}};pm=function(e){if(e.tag===13){var t=Zr(e,134217728);if(t!==null){var r=vt();lr(t,e,134217728,r)}qm(e,134217728)}};ay=function(e){if(e.tag===13){var t=Nn(e),r=Zr(e,t);if(r!==null){var n=vt();lr(r,e,t,n)}qm(e,t)}};iy=function(){return ke};oy=function(e,t){var r=ke;try{return ke=e,t()}finally{ke=r}};zu=function(e,t,r){switch(t){case"input":if(Au(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=Dc(n);if(!s)throw Error(V(90));$x(n),Au(n,s)}}}break;case"textarea":Bx(e,r);break;case"select":t=r.value,t!=null&&Ys(e,!!r.multiple,t,!1)}};qx=Wm;Gx=hs;var NN={usingClientEntryPoint:!1,Events:[ro,$s,Dc,Vx,Yx,Wm]},Wa={findFiberByHostInstance:Xn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},kN={bundleType:Wa.bundleType,version:Wa.version,rendererPackageName:Wa.rendererPackageName,rendererConfig:Wa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:nn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Jx(e),e===null?null:e.stateNode},findFiberByHostInstance:Wa.findFiberByHostInstance||_N,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ao=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ao.isDisabled&&Ao.supportsFiber)try{Nc=Ao.inject(kN),Dr=Ao}catch{}}$t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=NN;$t.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Km(t))throw Error(V(200));return wN(e,t,null,r)};$t.createRoot=function(e,t){if(!Km(e))throw Error(V(299));var r=!1,n="",s=Ev;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Ym(e,1,!1,null,null,r,!1,n,s),e[Xr]=t.current,Ri(e.nodeType===8?e.parentNode:e),new Gm(t)};$t.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(V(188)):(e=Object.keys(e).join(","),Error(V(268,e)));return e=Jx(t),e=e===null?null:e.stateNode,e};$t.flushSync=function(e){return hs(e)};$t.hydrate=function(e,t,r){if(!Ac(t))throw Error(V(200));return $c(null,e,t,!0,r)};$t.hydrateRoot=function(e,t,r){if(!Km(e))throw Error(V(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",o=Ev;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=Dv(t,null,e,1,r??null,s,!1,a,o),e[Xr]=t.current,Ri(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new Oc(t)};$t.render=function(e,t,r){if(!Ac(t))throw Error(V(200));return $c(null,e,t,!1,r)};$t.unmountComponentAtNode=function(e){if(!Ac(e))throw Error(V(40));return e._reactRootContainer?(hs(function(){$c(null,null,e,!1,function(){e._reactRootContainer=null,e[Xr]=null})}),!0):!1};$t.unstable_batchedUpdates=Wm;$t.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Ac(r))throw Error(V(200));if(e==null||e._reactInternals===void 0)throw Error(V(38));return $c(e,t,r,!1,n)};$t.version="18.3.1-next-f1338f8080-20240426";function Pv(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Pv)}catch(e){console.error(e)}}Pv(),Px.exports=$t;var so=Px.exports;const Tv=tm(so);var mg=so;Pu.createRoot=mg.createRoot,Pu.hydrateRoot=mg.hydrateRoot;const SN="modulepreload",CN=function(e){return"/"+e},hg={},ja=function(t,r,n){if(!r||r.length===0)return t();const s=document.getElementsByTagName("link");return Promise.all(r.map(a=>{if(a=CN(a),a in hg)return;hg[a]=!0;const o=a.endsWith(".css"),l=o?'[rel="stylesheet"]':"";if(!!n)for(let u=s.length-1;u>=0;u--){const m=s[u];if(m.href===a&&(!o||m.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${l}`))return;const d=document.createElement("link");if(d.rel=o?"stylesheet":SN,o||(d.as="script",d.crossOrigin=""),d.href=a,document.head.appendChild(d),o)return new Promise((u,m)=>{d.addEventListener("load",u),d.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${a}`)))})})).then(()=>t()).catch(a=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a})};var pg="popstate";function DN(e={}){function t(n,s){let{pathname:a,search:o,hash:l}=n.location;return Nf("",{pathname:a,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:Ui(s)}return PN(t,r,null,e)}function Oe(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function ur(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function EN(){return Math.random().toString(36).substring(2,10)}function gg(e,t){return{usr:e.state,key:e.key,idx:t}}function Nf(e,t,r=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?Na(t):t,state:r,key:t&&t.key||n||EN()}}function Ui({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Na(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function PN(e,t,r,n={}){let{window:s=document.defaultView,v5Compat:a=!1}=n,o=s.history,l="POP",c=null,d=u();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function u(){return(o.state||{idx:null}).idx}function m(){l="POP";let b=u(),g=b==null?null:b-d;d=b,c&&c({action:l,location:w.location,delta:g})}function f(b,g){l="PUSH";let x=Nf(w.location,b,g);r&&r(x,b),d=u()+1;let v=gg(x,d),N=w.createHref(x);try{o.pushState(v,"",N)}catch(_){if(_ instanceof DOMException&&_.name==="DataCloneError")throw _;s.location.assign(N)}a&&c&&c({action:l,location:w.location,delta:1})}function h(b,g){l="REPLACE";let x=Nf(w.location,b,g);r&&r(x,b),d=u();let v=gg(x,d),N=w.createHref(x);o.replaceState(v,"",N),a&&c&&c({action:l,location:w.location,delta:0})}function y(b){return TN(b)}let w={get action(){return l},get location(){return e(s,o)},listen(b){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(pg,m),c=b,()=>{s.removeEventListener(pg,m),c=null}},createHref(b){return t(s,b)},createURL:y,encodeLocation(b){let g=y(b);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:f,replace:h,go(b){return o.go(b)}};return w}function TN(e,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),Oe(r,"No window.location.(origin|href) available to create URL");let n=typeof e=="string"?e:Ui(e);return n=n.replace(/ $/,"%20"),!t&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function Rv(e,t,r="/"){return RN(e,t,r,!1)}function RN(e,t,r,n){let s=typeof t=="string"?Na(t):t,a=tn(s.pathname||"/",r);if(a==null)return null;let o=Lv(e);LN(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let d=zN(a);l=WN(o[c],d,n)}return l}function Lv(e,t=[],r=[],n="",s=!1){let a=(o,l,c=s,d)=>{let u={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};if(u.relativePath.startsWith("/")){if(!u.relativePath.startsWith(n)&&c)return;Oe(u.relativePath.startsWith(n),`Absolute route path "${u.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(n.length)}let m=Vr([n,u.relativePath]),f=r.concat(u);o.children&&o.children.length>0&&(Oe(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${m}".`),Lv(o.children,t,f,m,c)),!(o.path==null&&!o.index)&&t.push({path:m,score:BN(m,o.index),routesMeta:f})};return e.forEach((o,l)=>{var c;if(o.path===""||!((c=o.path)!=null&&c.includes("?")))a(o,l);else for(let d of Iv(o.path))a(o,l,!0,d)}),t}function Iv(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let o=Iv(n.join("/")),l=[];return l.push(...o.map(c=>c===""?a:[a,c].join("/"))),s&&l.push(...o),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function LN(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:UN(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var IN=/^:[\w-]+$/,MN=3,ON=2,AN=1,$N=10,FN=-2,xg=e=>e==="*";function BN(e,t){let r=e.split("/"),n=r.length;return r.some(xg)&&(n+=FN),t&&(n+=ON),r.filter(s=>!xg(s)).reduce((s,a)=>s+(IN.test(a)?MN:a===""?AN:$N),n)}function UN(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function WN(e,t,r=!1){let{routesMeta:n}=e,s={},a="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],d=l===n.length-1,u=a==="/"?t:t.slice(a.length)||"/",m=Jl({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},u),f=c.route;if(!m&&d&&r&&!n[n.length-1].route.index&&(m=Jl({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!m)return null;Object.assign(s,m.params),o.push({params:s,pathname:Vr([a,m.pathname]),pathnameBase:GN(Vr([a,m.pathnameBase])),route:f}),m.pathnameBase!=="/"&&(a=Vr([a,m.pathnameBase]))}return o}function Jl(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=HN(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let a=s[0],o=a.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:n.reduce((d,{paramName:u,isOptional:m},f)=>{if(u==="*"){let y=l[f]||"";o=a.slice(0,a.length-y.length).replace(/(.)\/+$/,"$1")}const h=l[f];return m&&!h?d[u]=void 0:d[u]=(h||"").replace(/%2F/g,"/"),d},{}),pathname:a,pathnameBase:o,pattern:e}}function HN(e,t=!1,r=!0){ur(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function zN(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return ur(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function tn(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function VN(e,t="/"){let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?Na(e):e;return{pathname:r?r.startsWith("/")?r:YN(r,t):t,search:KN(n),hash:QN(s)}}function YN(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function zd(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function qN(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Qm(e){let t=qN(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function Jm(e,t,r,n=!1){let s;typeof e=="string"?s=Na(e):(s={...e},Oe(!s.pathname||!s.pathname.includes("?"),zd("?","pathname","search",s)),Oe(!s.pathname||!s.pathname.includes("#"),zd("#","pathname","hash",s)),Oe(!s.search||!s.search.includes("#"),zd("#","search","hash",s)));let a=e===""||s.pathname==="",o=a?"/":s.pathname,l;if(o==null)l=r;else{let m=t.length-1;if(!n&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),m-=1;s.pathname=f.join("/")}l=m>=0?t[m]:"/"}let c=VN(s,l),d=o&&o!=="/"&&o.endsWith("/"),u=(a||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(d||u)&&(c.pathname+="/"),c}var Vr=e=>e.join("/").replace(/\/\/+/g,"/"),GN=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),KN=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,QN=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function JN(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var Mv=["POST","PUT","PATCH","DELETE"];new Set(Mv);var XN=["GET",...Mv];new Set(XN);var ka=p.createContext(null);ka.displayName="DataRouter";var Fc=p.createContext(null);Fc.displayName="DataRouterState";p.createContext(!1);var Ov=p.createContext({isTransitioning:!1});Ov.displayName="ViewTransition";var ZN=p.createContext(new Map);ZN.displayName="Fetchers";var ek=p.createContext(null);ek.displayName="Await";var mr=p.createContext(null);mr.displayName="Navigation";var ao=p.createContext(null);ao.displayName="Location";var hr=p.createContext({outlet:null,matches:[],isDataRoute:!1});hr.displayName="Route";var Xm=p.createContext(null);Xm.displayName="RouteError";function tk(e,{relative:t}={}){Oe(Sa(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=p.useContext(mr),{hash:s,pathname:a,search:o}=oo(e,{relative:t}),l=a;return r!=="/"&&(l=a==="/"?r:Vr([r,a])),n.createHref({pathname:l,search:o,hash:s})}function Sa(){return p.useContext(ao)!=null}function pr(){return Oe(Sa(),"useLocation() may be used only in the context of a <Router> component."),p.useContext(ao).location}var Av="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function $v(e){p.useContext(mr).static||p.useLayoutEffect(e)}function gr(){let{isDataRoute:e}=p.useContext(hr);return e?hk():rk()}function rk(){Oe(Sa(),"useNavigate() may be used only in the context of a <Router> component.");let e=p.useContext(ka),{basename:t,navigator:r}=p.useContext(mr),{matches:n}=p.useContext(hr),{pathname:s}=pr(),a=JSON.stringify(Qm(n)),o=p.useRef(!1);return $v(()=>{o.current=!0}),p.useCallback((c,d={})=>{if(ur(o.current,Av),!o.current)return;if(typeof c=="number"){r.go(c);return}let u=Jm(c,JSON.parse(a),s,d.relative==="path");e==null&&t!=="/"&&(u.pathname=u.pathname==="/"?t:Vr([t,u.pathname])),(d.replace?r.replace:r.push)(u,d.state,d)},[t,r,a,s,e])}p.createContext(null);function io(){let{matches:e}=p.useContext(hr),t=e[e.length-1];return t?t.params:{}}function oo(e,{relative:t}={}){let{matches:r}=p.useContext(hr),{pathname:n}=pr(),s=JSON.stringify(Qm(r));return p.useMemo(()=>Jm(e,JSON.parse(s),n,t==="path"),[e,s,n,t])}function nk(e,t){return Fv(e,t)}function Fv(e,t,r,n,s){var x;Oe(Sa(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=p.useContext(mr),{matches:o}=p.useContext(hr),l=o[o.length-1],c=l?l.params:{},d=l?l.pathname:"/",u=l?l.pathnameBase:"/",m=l&&l.route;{let v=m&&m.path||"";Bv(d,!m||v.endsWith("*")||v.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${v}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${v}"> to <Route path="${v==="/"?"*":`${v}/*`}">.`)}let f=pr(),h;if(t){let v=typeof t=="string"?Na(t):t;Oe(u==="/"||((x=v.pathname)==null?void 0:x.startsWith(u)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${u}" but pathname "${v.pathname}" was given in the \`location\` prop.`),h=v}else h=f;let y=h.pathname||"/",w=y;if(u!=="/"){let v=u.replace(/^\//,"").split("/");w="/"+y.replace(/^\//,"").split("/").slice(v.length).join("/")}let b=Rv(e,{pathname:w});ur(m||b!=null,`No routes matched location "${h.pathname}${h.search}${h.hash}" `),ur(b==null||b[b.length-1].route.element!==void 0||b[b.length-1].route.Component!==void 0||b[b.length-1].route.lazy!==void 0,`Matched leaf route at location "${h.pathname}${h.search}${h.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let g=lk(b&&b.map(v=>Object.assign({},v,{params:Object.assign({},c,v.params),pathname:Vr([u,a.encodeLocation?a.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?u:Vr([u,a.encodeLocation?a.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),o,r,n,s);return t&&g?p.createElement(ao.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...h},navigationType:"POP"}},g):g}function sk(){let e=mk(),t=JN(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:n},a={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=p.createElement(p.Fragment,null,p.createElement("p",null," Hey developer "),p.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",p.createElement("code",{style:a},"ErrorBoundary")," or"," ",p.createElement("code",{style:a},"errorElement")," prop on your route.")),p.createElement(p.Fragment,null,p.createElement("h2",null,"Unexpected Application Error!"),p.createElement("h3",{style:{fontStyle:"italic"}},t),r?p.createElement("pre",{style:s},r):null,o)}var ak=p.createElement(sk,null),ik=class extends p.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return this.state.error!==void 0?p.createElement(hr.Provider,{value:this.props.routeContext},p.createElement(Xm.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function ok({routeContext:e,match:t,children:r}){let n=p.useContext(ka);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),p.createElement(hr.Provider,{value:e},r)}function lk(e,t=[],r=null,n=null,s=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let a=e,o=r==null?void 0:r.errors;if(o!=null){let d=a.findIndex(u=>u.route.id&&(o==null?void 0:o[u.route.id])!==void 0);Oe(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,d+1))}let l=!1,c=-1;if(r)for(let d=0;d<a.length;d++){let u=a[d];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(c=d),u.route.id){let{loaderData:m,errors:f}=r,h=u.route.loader&&!m.hasOwnProperty(u.route.id)&&(!f||f[u.route.id]===void 0);if(u.route.lazy||h){l=!0,c>=0?a=a.slice(0,c+1):a=[a[0]];break}}}return a.reduceRight((d,u,m)=>{let f,h=!1,y=null,w=null;r&&(f=o&&u.route.id?o[u.route.id]:void 0,y=u.route.errorElement||ak,l&&(c<0&&m===0?(Bv("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,w=null):c===m&&(h=!0,w=u.route.hydrateFallbackElement||null)));let b=t.concat(a.slice(0,m+1)),g=()=>{let x;return f?x=y:h?x=w:u.route.Component?x=p.createElement(u.route.Component,null):u.route.element?x=u.route.element:x=d,p.createElement(ok,{match:u,routeContext:{outlet:d,matches:b,isDataRoute:r!=null},children:x})};return r&&(u.route.ErrorBoundary||u.route.errorElement||m===0)?p.createElement(ik,{location:r.location,revalidation:r.revalidation,component:y,error:f,children:g(),routeContext:{outlet:null,matches:b,isDataRoute:!0},unstable_onError:n}):g()},null)}function Zm(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ck(e){let t=p.useContext(ka);return Oe(t,Zm(e)),t}function dk(e){let t=p.useContext(Fc);return Oe(t,Zm(e)),t}function uk(e){let t=p.useContext(hr);return Oe(t,Zm(e)),t}function eh(e){let t=uk(e),r=t.matches[t.matches.length-1];return Oe(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function fk(){return eh("useRouteId")}function mk(){var n;let e=p.useContext(Xm),t=dk("useRouteError"),r=eh("useRouteError");return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function hk(){let{router:e}=ck("useNavigate"),t=eh("useNavigate"),r=p.useRef(!1);return $v(()=>{r.current=!0}),p.useCallback(async(s,a={})=>{ur(r.current,Av),r.current&&(typeof s=="number"?e.navigate(s):await e.navigate(s,{fromRouteId:t,...a}))},[e,t])}var yg={};function Bv(e,t,r){!t&&!yg[e]&&(yg[e]=!0,ur(!1,r))}p.memo(pk);function pk({routes:e,future:t,state:r,unstable_onError:n}){return Fv(e,void 0,r,n,t)}function gk({to:e,replace:t,state:r,relative:n}){Oe(Sa(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=p.useContext(mr);ur(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:a}=p.useContext(hr),{pathname:o}=pr(),l=gr(),c=Jm(e,Qm(a),o,n==="path"),d=JSON.stringify(c);return p.useEffect(()=>{l(JSON.parse(d),{replace:t,state:r,relative:n})},[l,d,n,t,r]),null}function Et(e){Oe(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function xk({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:s,static:a=!1}){Oe(!Sa(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),l=p.useMemo(()=>({basename:o,navigator:s,static:a,future:{}}),[o,s,a]);typeof r=="string"&&(r=Na(r));let{pathname:c="/",search:d="",hash:u="",state:m=null,key:f="default"}=r,h=p.useMemo(()=>{let y=tn(c,o);return y==null?null:{location:{pathname:y,search:d,hash:u,state:m,key:f},navigationType:n}},[o,c,d,u,m,f,n]);return ur(h!=null,`<Router basename="${o}"> is not able to match the URL "${c}${d}${u}" because it does not start with the basename, so the <Router> won't render anything.`),h==null?null:p.createElement(mr.Provider,{value:l},p.createElement(ao.Provider,{children:t,value:h}))}function yk({children:e,location:t}){return nk(kf(e),t)}function kf(e,t=[]){let r=[];return p.Children.forEach(e,(n,s)=>{if(!p.isValidElement(n))return;let a=[...t,s];if(n.type===p.Fragment){r.push.apply(r,kf(n.props.children,a));return}Oe(n.type===Et,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Oe(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=kf(n.props.children,a)),r.push(o)}),r}var gl="get",xl="application/x-www-form-urlencoded";function Bc(e){return e!=null&&typeof e.tagName=="string"}function vk(e){return Bc(e)&&e.tagName.toLowerCase()==="button"}function bk(e){return Bc(e)&&e.tagName.toLowerCase()==="form"}function wk(e){return Bc(e)&&e.tagName.toLowerCase()==="input"}function _k(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function jk(e,t){return e.button===0&&(!t||t==="_self")&&!_k(e)}var $o=null;function Nk(){if($o===null)try{new FormData(document.createElement("form"),0),$o=!1}catch{$o=!0}return $o}var kk=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Vd(e){return e!=null&&!kk.has(e)?(ur(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${xl}"`),null):e}function Sk(e,t){let r,n,s,a,o;if(bk(e)){let l=e.getAttribute("action");n=l?tn(l,t):null,r=e.getAttribute("method")||gl,s=Vd(e.getAttribute("enctype"))||xl,a=new FormData(e)}else if(vk(e)||wk(e)&&(e.type==="submit"||e.type==="image")){let l=e.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=e.getAttribute("formaction")||l.getAttribute("action");if(n=c?tn(c,t):null,r=e.getAttribute("formmethod")||l.getAttribute("method")||gl,s=Vd(e.getAttribute("formenctype"))||Vd(l.getAttribute("enctype"))||xl,a=new FormData(l,e),!Nk()){let{name:d,type:u,value:m}=e;if(u==="image"){let f=d?`${d}.`:"";a.append(`${f}x`,"0"),a.append(`${f}y`,"0")}else d&&a.append(d,m)}}else{if(Bc(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=gl,n=null,s=xl,o=e}return a&&s==="text/plain"&&(o=a,a=void 0),{action:n,method:r.toLowerCase(),encType:s,formData:a,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function th(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Ck(e,t,r){let n=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return n.pathname==="/"?n.pathname=`_root.${r}`:t&&tn(n.pathname,t)==="/"?n.pathname=`${t.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function Dk(e,t){if(e.id in t)return t[e.id];try{let r=await ja(()=>import(e.module),[]);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Ek(e){return e!=null&&typeof e.page=="string"}function Pk(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function Tk(e,t,r){let n=await Promise.all(e.map(async s=>{let a=t.routes[s.route.id];if(a){let o=await Dk(a,r);return o.links?o.links():[]}return[]}));return Mk(n.flat(1).filter(Pk).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function vg(e,t,r,n,s,a){let o=(c,d)=>r[d]?c.route.id!==r[d].route.id:!0,l=(c,d)=>{var u;return r[d].pathname!==c.pathname||((u=r[d].route.path)==null?void 0:u.endsWith("*"))&&r[d].params["*"]!==c.params["*"]};return a==="assets"?t.filter((c,d)=>o(c,d)||l(c,d)):a==="data"?t.filter((c,d)=>{var m;let u=n.routes[c.route.id];if(!u||!u.hasLoader)return!1;if(o(c,d)||l(c,d))return!0;if(c.route.shouldRevalidate){let f=c.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((m=r[0])==null?void 0:m.params)||{},nextUrl:new URL(e,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof f=="boolean")return f}return!0}):[]}function Rk(e,t,{includeHydrateFallback:r}={}){return Lk(e.map(n=>{let s=t.routes[n.route.id];if(!s)return[];let a=[s.module];return s.clientActionModule&&(a=a.concat(s.clientActionModule)),s.clientLoaderModule&&(a=a.concat(s.clientLoaderModule)),r&&s.hydrateFallbackModule&&(a=a.concat(s.hydrateFallbackModule)),s.imports&&(a=a.concat(s.imports)),a}).flat(1))}function Lk(e){return[...new Set(e)]}function Ik(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function Mk(e,t){let r=new Set,n=new Set(t);return e.reduce((s,a)=>{if(t&&!Ek(a)&&a.as==="script"&&a.href&&n.has(a.href))return s;let l=JSON.stringify(Ik(a));return r.has(l)||(r.add(l),s.push({key:l,link:a})),s},[])}function Uv(){let e=p.useContext(ka);return th(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function Ok(){let e=p.useContext(Fc);return th(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var rh=p.createContext(void 0);rh.displayName="FrameworkContext";function Wv(){let e=p.useContext(rh);return th(e,"You must render this element inside a <HydratedRouter> element"),e}function Ak(e,t){let r=p.useContext(rh),[n,s]=p.useState(!1),[a,o]=p.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:d,onMouseLeave:u,onTouchStart:m}=t,f=p.useRef(null);p.useEffect(()=>{if(e==="render"&&o(!0),e==="viewport"){let w=g=>{g.forEach(x=>{o(x.isIntersecting)})},b=new IntersectionObserver(w,{threshold:.5});return f.current&&b.observe(f.current),()=>{b.disconnect()}}},[e]),p.useEffect(()=>{if(n){let w=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(w)}}},[n]);let h=()=>{s(!0)},y=()=>{s(!1),o(!1)};return r?e!=="intent"?[a,f,{}]:[a,f,{onFocus:Ha(l,h),onBlur:Ha(c,y),onMouseEnter:Ha(d,h),onMouseLeave:Ha(u,y),onTouchStart:Ha(m,h)}]:[!1,f,{}]}function Ha(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function $k({page:e,...t}){let{router:r}=Uv(),n=p.useMemo(()=>Rv(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?p.createElement(Bk,{page:e,matches:n,...t}):null}function Fk(e){let{manifest:t,routeModules:r}=Wv(),[n,s]=p.useState([]);return p.useEffect(()=>{let a=!1;return Tk(e,t,r).then(o=>{a||s(o)}),()=>{a=!0}},[e,t,r]),n}function Bk({page:e,matches:t,...r}){let n=pr(),{manifest:s,routeModules:a}=Wv(),{basename:o}=Uv(),{loaderData:l,matches:c}=Ok(),d=p.useMemo(()=>vg(e,t,c,s,n,"data"),[e,t,c,s,n]),u=p.useMemo(()=>vg(e,t,c,s,n,"assets"),[e,t,c,s,n]),m=p.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let y=new Set,w=!1;if(t.forEach(g=>{var v;let x=s.routes[g.route.id];!x||!x.hasLoader||(!d.some(N=>N.route.id===g.route.id)&&g.route.id in l&&((v=a[g.route.id])!=null&&v.shouldRevalidate)||x.hasClientLoader?w=!0:y.add(g.route.id))}),y.size===0)return[];let b=Ck(e,o,"data");return w&&y.size>0&&b.searchParams.set("_routes",t.filter(g=>y.has(g.route.id)).map(g=>g.route.id).join(",")),[b.pathname+b.search]},[o,l,n,s,d,t,e,a]),f=p.useMemo(()=>Rk(u,s),[u,s]),h=Fk(u);return p.createElement(p.Fragment,null,m.map(y=>p.createElement("link",{key:y,rel:"prefetch",as:"fetch",href:y,...r})),f.map(y=>p.createElement("link",{key:y,rel:"modulepreload",href:y,...r})),h.map(({key:y,link:w})=>p.createElement("link",{key:y,nonce:r.nonce,...w})))}function Uk(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var Hv=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Hv&&(window.__reactRouterVersion="7.9.0")}catch{}function Wk({basename:e,children:t,window:r}){let n=p.useRef();n.current==null&&(n.current=DN({window:r,v5Compat:!0}));let s=n.current,[a,o]=p.useState({action:s.action,location:s.location}),l=p.useCallback(c=>{p.startTransition(()=>o(c))},[o]);return p.useLayoutEffect(()=>s.listen(l),[s,l]),p.createElement(xk,{basename:e,children:t,location:a.location,navigationType:a.action,navigator:s})}var zv=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Uc=p.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:s,reloadDocument:a,replace:o,state:l,target:c,to:d,preventScrollReset:u,viewTransition:m,...f},h){let{basename:y}=p.useContext(mr),w=typeof d=="string"&&zv.test(d),b,g=!1;if(typeof d=="string"&&w&&(b=d,Hv))try{let S=new URL(window.location.href),D=d.startsWith("//")?new URL(S.protocol+d):new URL(d),R=tn(D.pathname,y);D.origin===S.origin&&R!=null?d=R+D.search+D.hash:g=!0}catch{ur(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let x=tk(d,{relative:s}),[v,N,_]=Ak(n,f),C=Yk(d,{replace:o,state:l,target:c,preventScrollReset:u,relative:s,viewTransition:m});function j(S){t&&t(S),S.defaultPrevented||C(S)}let k=p.createElement("a",{...f,..._,href:b||x,onClick:g||a?t:j,ref:Uk(h,N),target:c,"data-discover":!w&&r==="render"?"true":void 0});return v&&!w?p.createElement(p.Fragment,null,k,p.createElement($k,{page:x})):k});Uc.displayName="Link";var Hk=p.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:s=!1,style:a,to:o,viewTransition:l,children:c,...d},u){let m=oo(o,{relative:d.relative}),f=pr(),h=p.useContext(Fc),{navigator:y,basename:w}=p.useContext(mr),b=h!=null&&Jk(m)&&l===!0,g=y.encodeLocation?y.encodeLocation(m).pathname:m.pathname,x=f.pathname,v=h&&h.navigation&&h.navigation.location?h.navigation.location.pathname:null;r||(x=x.toLowerCase(),v=v?v.toLowerCase():null,g=g.toLowerCase()),v&&w&&(v=tn(v,w)||v);const N=g!=="/"&&g.endsWith("/")?g.length-1:g.length;let _=x===g||!s&&x.startsWith(g)&&x.charAt(N)==="/",C=v!=null&&(v===g||!s&&v.startsWith(g)&&v.charAt(g.length)==="/"),j={isActive:_,isPending:C,isTransitioning:b},k=_?t:void 0,S;typeof n=="function"?S=n(j):S=[n,_?"active":null,C?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let D=typeof a=="function"?a(j):a;return p.createElement(Uc,{...d,"aria-current":k,className:S,ref:u,style:D,to:o,viewTransition:l},typeof c=="function"?c(j):c)});Hk.displayName="NavLink";var zk=p.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:s,state:a,method:o=gl,action:l,onSubmit:c,relative:d,preventScrollReset:u,viewTransition:m,...f},h)=>{let y=Kk(),w=Qk(l,{relative:d}),b=o.toLowerCase()==="get"?"get":"post",g=typeof l=="string"&&zv.test(l),x=v=>{if(c&&c(v),v.defaultPrevented)return;v.preventDefault();let N=v.nativeEvent.submitter,_=(N==null?void 0:N.getAttribute("formmethod"))||o;y(N||v.currentTarget,{fetcherKey:t,method:_,navigate:r,replace:s,state:a,relative:d,preventScrollReset:u,viewTransition:m})};return p.createElement("form",{ref:h,method:b,action:w,onSubmit:n?c:x,...f,"data-discover":!g&&e==="render"?"true":void 0})});zk.displayName="Form";function Vk(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Vv(e){let t=p.useContext(ka);return Oe(t,Vk(e)),t}function Yk(e,{target:t,replace:r,state:n,preventScrollReset:s,relative:a,viewTransition:o}={}){let l=gr(),c=pr(),d=oo(e,{relative:a});return p.useCallback(u=>{if(jk(u,t)){u.preventDefault();let m=r!==void 0?r:Ui(c)===Ui(d);l(e,{replace:m,state:n,preventScrollReset:s,relative:a,viewTransition:o})}},[c,l,d,r,n,t,e,s,a,o])}var qk=0,Gk=()=>`__${String(++qk)}__`;function Kk(){let{router:e}=Vv("useSubmit"),{basename:t}=p.useContext(mr),r=fk();return p.useCallback(async(n,s={})=>{let{action:a,method:o,encType:l,formData:c,body:d}=Sk(n,t);if(s.navigate===!1){let u=s.fetcherKey||Gk();await e.fetch(u,r,s.action||a,{preventScrollReset:s.preventScrollReset,formData:c,body:d,formMethod:s.method||o,formEncType:s.encType||l,flushSync:s.flushSync})}else await e.navigate(s.action||a,{preventScrollReset:s.preventScrollReset,formData:c,body:d,formMethod:s.method||o,formEncType:s.encType||l,replace:s.replace,state:s.state,fromRouteId:r,flushSync:s.flushSync,viewTransition:s.viewTransition})},[e,t,r])}function Qk(e,{relative:t}={}){let{basename:r}=p.useContext(mr),n=p.useContext(hr);Oe(n,"useFormAction must be used inside a RouteContext");let[s]=n.matches.slice(-1),a={...oo(e||".",{relative:t})},o=pr();if(e==null){a.search=o.search;let l=new URLSearchParams(a.search),c=l.getAll("index");if(c.some(u=>u==="")){l.delete("index"),c.filter(m=>m).forEach(m=>l.append("index",m));let u=l.toString();a.search=u?`?${u}`:""}}return(!e||e===".")&&s.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(a.pathname=a.pathname==="/"?r:Vr([r,a.pathname])),Ui(a)}function Jk(e,{relative:t}={}){let r=p.useContext(Ov);Oe(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=Vv("useViewTransitionState"),s=oo(e,{relative:t});if(!r.isTransitioning)return!1;let a=tn(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=tn(r.nextLocation.pathname,n)||r.nextLocation.pathname;return Jl(s.pathname,o)!=null||Jl(s.pathname,a)!=null}const Xk=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>ja(()=>Promise.resolve().then(()=>Ca),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class nh extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class Zk extends nh{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class bg extends nh{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class wg extends nh{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Sf;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Sf||(Sf={}));var e2=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(u){try{d(n.next(u))}catch(m){o(m)}}function c(u){try{d(n.throw(u))}catch(m){o(m)}}function d(u){u.done?a(u.value):s(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class t2{constructor(t,{headers:r={},customFetch:n,region:s=Sf.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=Xk(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return e2(this,void 0,void 0,function*(){try{const{headers:s,method:a,body:o}=r;let l={},{region:c}=r;c||(c=this.region);const d=new URL(`${this.url}/${t}`);c&&c!=="any"&&(l["x-region"]=c,d.searchParams.set("forceFunctionRegion",c));let u;o&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(l["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(l["Content-Type"]="application/json",u=JSON.stringify(o)));const m=yield this.fetch(d.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),s),body:u}).catch(w=>{throw new Zk(w)}),f=m.headers.get("x-relay-error");if(f&&f==="true")throw new bg(m);if(!m.ok)throw new wg(m);let h=((n=m.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),y;return h==="application/json"?y=yield m.json():h==="application/octet-stream"?y=yield m.blob():h==="text/event-stream"?y=m:h==="multipart/form-data"?y=yield m.formData():y=yield m.text(),{data:y,error:null,response:m}}catch(s){return{data:null,error:s,response:s instanceof wg||s instanceof bg?s.context:void 0}}})}}var Nt={},sh={},Wc={},lo={},Hc={},zc={},r2=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},oa=r2();const n2=oa.fetch,Yv=oa.fetch.bind(oa),qv=oa.Headers,s2=oa.Request,a2=oa.Response,Ca=Object.freeze(Object.defineProperty({__proto__:null,Headers:qv,Request:s2,Response:a2,default:Yv,fetch:n2},Symbol.toStringTag,{value:"Module"})),i2=xx(Ca);var Vc={};Object.defineProperty(Vc,"__esModule",{value:!0});let o2=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};Vc.default=o2;var Gv=Qt&&Qt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(zc,"__esModule",{value:!0});const l2=Gv(i2),c2=Gv(Vc);let d2=class{constructor(t){var r,n;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(r=t.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=l2.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=new Headers(this.headers),this.headers.set(t,r),this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{var o,l,c,d;let u=null,m=null,f=null,h=a.status,y=a.statusText;if(a.ok){if(this.method!=="HEAD"){const x=await a.text();x===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((o=this.headers.get("Accept"))===null||o===void 0)&&o.includes("application/vnd.pgrst.plan+text"))?m=x:m=JSON.parse(x))}const b=(l=this.headers.get("Prefer"))===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),g=(c=a.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");b&&g&&g.length>1&&(f=parseInt(g[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(m)&&(m.length>1?(u={code:"PGRST116",details:`Results contain ${m.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},m=null,f=null,h=406,y="Not Acceptable"):m.length===1?m=m[0]:m=null)}else{const b=await a.text();try{u=JSON.parse(b),Array.isArray(u)&&a.status===404&&(m=[],u=null,h=200,y="OK")}catch{a.status===404&&b===""?(h=204,y="No Content"):u={message:b}}if(u&&this.isMaybeSingle&&(!((d=u==null?void 0:u.details)===null||d===void 0)&&d.includes("0 rows"))&&(u=null,h=200,y="OK"),u&&this.shouldThrowOnError)throw new c2.default(u)}return{error:u,data:m,count:f,status:h,statusText:y}});return this.shouldThrowOnError||(s=s.catch(a=>{var o,l,c;return{error:{message:`${(o=a==null?void 0:a.name)!==null&&o!==void 0?o:"FetchError"}: ${a==null?void 0:a.message}`,details:`${(l=a==null?void 0:a.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=a==null?void 0:a.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),s.then(t,r)}returns(){return this}overrideTypes(){return this}};zc.default=d2;var u2=Qt&&Qt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Hc,"__esModule",{value:!0});const f2=u2(zc);let m2=class extends f2.default{select(t){let r=!1;const n=(t??"*").split("").map(s=>/\s/.test(s)&&!r?"":(s==='"'&&(r=!r),s)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:s,referencedTable:a=s}={}){const o=a?`${a}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:s=n}={}){const a=typeof s>"u"?"offset":`${s}.offset`,o=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(a,`${t}`),this.url.searchParams.set(o,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:s=!1,wal:a=!1,format:o="text"}={}){var l;const c=[t?"analyze":null,r?"verbose":null,n?"settings":null,s?"buffers":null,a?"wal":null].filter(Boolean).join("|"),d=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${o}; for="${d}"; options=${c};`),o==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};Hc.default=m2;var h2=Qt&&Qt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(lo,"__esModule",{value:!0});const p2=h2(Hc);let g2=class extends p2.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:s}={}){let a="";s==="plain"?a="pl":s==="phrase"?a="ph":s==="websearch"&&(a="w");const o=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${a}fts${o}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};lo.default=g2;var x2=Qt&&Qt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Wc,"__esModule",{value:!0});const za=x2(lo);let y2=class{constructor(t,{headers:r={},schema:n,fetch:s}){this.url=t,this.headers=new Headers(r),this.schema=n,this.fetch=s}select(t,{head:r=!1,count:n}={}){const s=r?"HEAD":"GET";let a=!1;const o=(t??"*").split("").map(l=>/\s/.test(l)&&!a?"":(l==='"'&&(a=!a),l)).join("");return this.url.searchParams.set("select",o),n&&this.headers.append("Prefer",`count=${n}`),new za.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:r,defaultToNull:n=!0}={}){var s;const a="POST";if(r&&this.headers.append("Prefer",`count=${r}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const o=t.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new za.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:s,defaultToNull:a=!0}={}){var o;const l="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),s&&this.headers.append("Prefer",`count=${s}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const c=t.reduce((d,u)=>d.concat(Object.keys(u)),[]);if(c.length>0){const d=[...new Set(c)].map(u=>`"${u}"`);this.url.searchParams.set("columns",d.join(","))}}return new za.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}update(t,{count:r}={}){var n;const s="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new za.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:t}={}){var r;const n="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new za.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};Wc.default=y2;var Kv=Qt&&Qt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(sh,"__esModule",{value:!0});const v2=Kv(Wc),b2=Kv(lo);let w2=class Qv{constructor(t,{headers:r={},schema:n,fetch:s}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=s}from(t){const r=new URL(`${this.url}/${t}`);return new v2.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Qv(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:s=!1,count:a}={}){var o;let l;const c=new URL(`${this.url}/rpc/${t}`);let d;n||s?(l=n?"HEAD":"GET",Object.entries(r).filter(([m,f])=>f!==void 0).map(([m,f])=>[m,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([m,f])=>{c.searchParams.append(m,f)})):(l="POST",d=r);const u=new Headers(this.headers);return a&&u.set("Prefer",`count=${a}`),new b2.default({method:l,url:c,headers:u,schema:this.schemaName,body:d,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};sh.default=w2;var Da=Qt&&Qt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Nt,"__esModule",{value:!0});Nt.PostgrestError=Nt.PostgrestBuilder=Nt.PostgrestTransformBuilder=Nt.PostgrestFilterBuilder=Nt.PostgrestQueryBuilder=Nt.PostgrestClient=void 0;const Jv=Da(sh);Nt.PostgrestClient=Jv.default;const Xv=Da(Wc);Nt.PostgrestQueryBuilder=Xv.default;const Zv=Da(lo);Nt.PostgrestFilterBuilder=Zv.default;const eb=Da(Hc);Nt.PostgrestTransformBuilder=eb.default;const tb=Da(zc);Nt.PostgrestBuilder=tb.default;const rb=Da(Vc);Nt.PostgrestError=rb.default;var _2=Nt.default={PostgrestClient:Jv.default,PostgrestQueryBuilder:Xv.default,PostgrestFilterBuilder:Zv.default,PostgrestTransformBuilder:eb.default,PostgrestBuilder:tb.default,PostgrestError:rb.default};const{PostgrestClient:j2,PostgrestQueryBuilder:IA,PostgrestFilterBuilder:MA,PostgrestTransformBuilder:OA,PostgrestBuilder:AA,PostgrestError:$A}=_2;class N2{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,s=parseInt(n.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const k2="2.15.5",S2=`realtime-js/${k2}`,C2="1.0.0",Cf=1e4,D2=1e3,E2=100;var yi;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(yi||(yi={}));var qe;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(qe||(qe={}));var sr;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(sr||(sr={}));var Df;(function(e){e.websocket="websocket"})(Df||(Df={}));var Jn;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Jn||(Jn={}));class P2{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const s=r.getUint8(1),a=r.getUint8(2);let o=this.HEADER_LENGTH+2;const l=n.decode(t.slice(o,o+s));o=o+s;const c=n.decode(t.slice(o,o+a));o=o+a;const d=JSON.parse(n.decode(t.slice(o,t.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class nb{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var De;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(De||(De={}));const _g=(e,t,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((a,o)=>(a[o]=T2(o,e,t,s),a),{})},T2=(e,t,r,n)=>{const s=t.find(l=>l.name===e),a=s==null?void 0:s.type,o=r[e];return a&&!n.includes(a)?sb(a,o):Ef(o)},sb=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return M2(t,r)}switch(e){case De.bool:return R2(t);case De.float4:case De.float8:case De.int2:case De.int4:case De.int8:case De.numeric:case De.oid:return L2(t);case De.json:case De.jsonb:return I2(t);case De.timestamp:return O2(t);case De.abstime:case De.date:case De.daterange:case De.int4range:case De.int8range:case De.money:case De.reltime:case De.text:case De.time:case De.timestamptz:case De.timetz:case De.tsrange:case De.tstzrange:return Ef(t);default:return Ef(t)}},Ef=e=>e,R2=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},L2=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},I2=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},M2=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let a;const o=e.slice(1,r);try{a=JSON.parse("["+o+"]")}catch{a=o?o.split(","):[]}return a.map(l=>sb(t,l))}return e},O2=e=>typeof e=="string"?e.replace(" ","T"):e,ab=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class Yd{constructor(t,r,n={},s=Cf){this.channel=t,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var jg;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(jg||(jg={}));class vi{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=vi.syncState(this.state,s,a,o),this.pendingDiffs.forEach(c=>{this.state=vi.syncDiff(this.state,c,a,o)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},s=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=vi.syncDiff(this.state,s,a,o),l())}),this.onJoin((s,a,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:a,newPresences:o})}),this.onLeave((s,a,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:a,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,s){const a=this.cloneDeep(t),o=this.transformState(r),l={},c={};return this.map(a,(d,u)=>{o[d]||(c[d]=u)}),this.map(o,(d,u)=>{const m=a[d];if(m){const f=u.map(b=>b.presence_ref),h=m.map(b=>b.presence_ref),y=u.filter(b=>h.indexOf(b.presence_ref)<0),w=m.filter(b=>f.indexOf(b.presence_ref)<0);y.length>0&&(l[d]=y),w.length>0&&(c[d]=w)}else l[d]=u}),this.syncDiff(a,{joins:l,leaves:c},n,s)}static syncDiff(t,r,n,s){const{joins:a,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(a,(l,c)=>{var d;const u=(d=t[l])!==null&&d!==void 0?d:[];if(t[l]=this.cloneDeep(c),u.length>0){const m=t[l].map(h=>h.presence_ref),f=u.filter(h=>m.indexOf(h.presence_ref)<0);t[l].unshift(...f)}n(l,u,c)}),this.map(o,(l,c)=>{let d=t[l];if(!d)return;const u=c.map(m=>m.presence_ref);d=d.filter(m=>u.indexOf(m.presence_ref)<0),t[l]=d,s(l,d,c),d.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const s=t[n];return"metas"in s?r[n]=s.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):r[n]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ng;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Ng||(Ng={}));var bi;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(bi||(bi={}));var $r;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})($r||($r={}));class ah{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=qe.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Yd(this,sr.join,this.params,this.timeout),this.rejoinTimer=new nb(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=qe.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=qe.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=qe.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=qe.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=qe.errored,this.rejoinTimer.scheduleTimeout())}),this._on(sr.reply,{},(s,a)=>{this._trigger(this._replyEventName(a),s)}),this.presence=new vi(this),this.broadcastEndpointURL=ab(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,s,a;if(this.socket.isConnected()||this.socket.connect(),this.state==qe.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,d=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(h=>h.filter))!==null&&s!==void 0?s:[],u=!!this.bindings[bi.PRESENCE]&&this.bindings[bi.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,m={},f={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:u}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(m.access_token=this.socket.accessTokenValue),this._onError(h=>t==null?void 0:t($r.CHANNEL_ERROR,h)),this._onClose(()=>t==null?void 0:t($r.CLOSED)),this.updateJoinPayload(Object.assign({config:f},m)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:h})=>{var y;if(this.socket.setAuth(),h===void 0){t==null||t($r.SUBSCRIBED);return}else{const w=this.bindings.postgres_changes,b=(y=w==null?void 0:w.length)!==null&&y!==void 0?y:0,g=[];for(let x=0;x<b;x++){const v=w[x],{filter:{event:N,schema:_,table:C,filter:j}}=v,k=h&&h[x];if(k&&k.event===N&&k.schema===_&&k.table===C&&k.filter===j)g.push(Object.assign(Object.assign({},v),{id:k.id}));else{this.unsubscribe(),this.state=qe.errored,t==null||t($r.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,t&&t($r.SUBSCRIBED);return}}).receive("error",h=>{this.state=qe.errored,t==null||t($r.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(h).join(", ")||"error")))}).receive("timeout",()=>{t==null||t($r.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===qe.joined&&t===bi.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async send(t,r={}){var n,s;if(!this._canPush()&&t.type==="broadcast"){const{event:a,payload:o}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=d.body)===null||s===void 0?void 0:s.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var o,l,c;const d=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&a("ok"),d.receive("ok",()=>a("ok")),d.receive("error",()=>a("error")),d.receive("timeout",()=>a("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=qe.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(sr.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new Yd(this,sr.leave,{},t),n.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=qe.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const s=new AbortController,a=setTimeout(()=>s.abort(),n),o=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(a),o}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Yd(this,t,r,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>E2){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var s,a;const o=t.toLocaleLowerCase(),{close:l,error:c,leave:d,join:u}=sr;if(n&&[l,c,d,u].indexOf(o)>=0&&n!==this._joinRef())return;let f=this._onMessage(o,r,n);if(r&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(h=>{var y,w,b;return((y=h.filter)===null||y===void 0?void 0:y.event)==="*"||((b=(w=h.filter)===null||w===void 0?void 0:w.event)===null||b===void 0?void 0:b.toLocaleLowerCase())===o}).map(h=>h.callback(f,n)):(a=this.bindings[o])===null||a===void 0||a.filter(h=>{var y,w,b,g,x,v;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in h){const N=h.id,_=(y=h.filter)===null||y===void 0?void 0:y.event;return N&&((w=r.ids)===null||w===void 0?void 0:w.includes(N))&&(_==="*"||(_==null?void 0:_.toLocaleLowerCase())===((b=r.data)===null||b===void 0?void 0:b.type.toLocaleLowerCase()))}else{const N=(x=(g=h==null?void 0:h.filter)===null||g===void 0?void 0:g.event)===null||x===void 0?void 0:x.toLocaleLowerCase();return N==="*"||N===((v=r==null?void 0:r.event)===null||v===void 0?void 0:v.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===o}).map(h=>{if(typeof f=="object"&&"ids"in f){const y=f.data,{schema:w,table:b,commit_timestamp:g,type:x,errors:v}=y;f=Object.assign(Object.assign({},{schema:w,table:b,commit_timestamp:g,eventType:x,new:{},old:{},errors:v}),this._getPayloadRecords(y))}h.callback(f,n)})}_isClosed(){return this.state===qe.closed}_isJoined(){return this.state===qe.joined}_isJoining(){return this.state===qe.joining}_isLeaving(){return this.state===qe.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const s=t.toLocaleLowerCase(),a={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(a):this.bindings[s]=[a],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var a;return!(((a=s.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===n&&ah.isEqual(s.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(sr.close,{},t)}_onError(t){this._on(sr.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=qe.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=_g(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=_g(t.columns,t.old_record)),r}}const qd=()=>{},Fo={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},A2=[1e3,2e3,5e3,1e4],$2=1e4,F2=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class B2{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Cf,this.transport=null,this.heartbeatIntervalMs=Fo.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=qd,this.ref=0,this.reconnectTimer=null,this.logger=qd,this.conn=null,this.sendBuffer=[],this.serializer=new P2,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>{let a;return s?a=s:typeof fetch>"u"?a=(...o)=>ja(()=>Promise.resolve().then(()=>Ca),void 0).then(({default:l})=>l(...o)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):a=fetch,(...o)=>a(...o)},!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Df.websocket}`,this.httpEndpoint=ab(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=N2.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:C2}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case yi.connecting:return Jn.Connecting;case yi.open:return Jn.Open;case yi.closing:return Jn.Closing;default:return Jn.Closed}}isConnected(){return this.connectionState()===Jn.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,s=this.getChannels().find(a=>a.topic===n);if(s)return s;{const a=new ah(`realtime:${t}`,r,this);return this.channels.push(a),a}}push(t){const{topic:r,event:n,payload:s,ref:a}=t,o=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${n} (${a})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(D2,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Fo.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:s,payload:a,ref:o}=r,l=o?`(${o})`:"",c=a.status||"";this.log("receive",`${c} ${n} ${s} ${l}`.trim(),a),this.channels.filter(d=>d._isMember(n)).forEach(d=>d._trigger(s,a,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(sr.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${n}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([F2],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const s={access_token:r,version:S2};r&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(sr.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(s){this.log("error",`error in ${t} callback`,s)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new nb(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Fo.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,s,a,o,l,c,d,u;if(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:Cf,this.heartbeatIntervalMs=(s=t==null?void 0:t.heartbeatIntervalMs)!==null&&s!==void 0?s:Fo.HEARTBEAT_INTERVAL,this.worker=(a=t==null?void 0:t.worker)!==null&&a!==void 0?a:!1,this.accessToken=(o=t==null?void 0:t.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=t==null?void 0:t.heartbeatCallback)!==null&&l!==void 0?l:qd,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t==null?void 0:t.reconnectAfterMs)!==null&&c!==void 0?c:m=>A2[m-1]||$2,this.encode=(d=t==null?void 0:t.encode)!==null&&d!==void 0?d:(m,f)=>f(JSON.stringify(m)),this.decode=(u=t==null?void 0:t.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class ih extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Ge(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class U2 extends ih{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Pf extends ih{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var W2=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(u){try{d(n.next(u))}catch(m){o(m)}}function c(u){try{d(n.throw(u))}catch(m){o(m)}}function d(u){u.done?a(u.value):s(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const ib=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>ja(()=>Promise.resolve().then(()=>Ca),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},H2=()=>W2(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield ja(()=>Promise.resolve().then(()=>Ca),void 0)).Response:Response}),Tf=e=>{if(Array.isArray(e))return e.map(r=>Tf(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));t[s]=Tf(n)}),t},z2=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var bs=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(u){try{d(n.next(u))}catch(m){o(m)}}function c(u){try{d(n.throw(u))}catch(m){o(m)}}function d(u){u.done?a(u.value):s(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const Gd=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),V2=(e,t,r)=>bs(void 0,void 0,void 0,function*(){const n=yield H2();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(s=>{const a=e.status||500,o=(s==null?void 0:s.statusCode)||a+"";t(new U2(Gd(s),a,o))}).catch(s=>{t(new Pf(Gd(s),s))}):t(new Pf(Gd(e),e))}),Y2=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?s:(z2(n)?(s.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),s.body=JSON.stringify(n)):s.body=n,t!=null&&t.duplex&&(s.duplex=t.duplex),Object.assign(Object.assign({},s),r))};function co(e,t,r,n,s,a){return bs(this,void 0,void 0,function*(){return new Promise((o,l)=>{e(r,Y2(t,n,s,a)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>V2(c,l,n))})})}function Xl(e,t,r,n){return bs(this,void 0,void 0,function*(){return co(e,"GET",t,r,n)})}function br(e,t,r,n,s){return bs(this,void 0,void 0,function*(){return co(e,"POST",t,n,s,r)})}function Rf(e,t,r,n,s){return bs(this,void 0,void 0,function*(){return co(e,"PUT",t,n,s,r)})}function q2(e,t,r,n){return bs(this,void 0,void 0,function*(){return co(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function ob(e,t,r,n,s){return bs(this,void 0,void 0,function*(){return co(e,"DELETE",t,n,s,r)})}var mt=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(u){try{d(n.next(u))}catch(m){o(m)}}function c(u){try{d(n.throw(u))}catch(m){o(m)}}function d(u){u.done?a(u.value):s(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const G2={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},kg={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class K2{constructor(t,r={},n,s){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=n,this.fetch=ib(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,n,s){return mt(this,void 0,void 0,function*(){try{let a;const o=Object.assign(Object.assign({},kg),s);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&n instanceof Blob?(a=new FormData,a.append("cacheControl",o.cacheControl),c&&a.append("metadata",this.encodeMetadata(c)),a.append("",n)):typeof FormData<"u"&&n instanceof FormData?(a=n,a.append("cacheControl",o.cacheControl),c&&a.append("metadata",this.encodeMetadata(c))):(a=n,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),s!=null&&s.headers&&(l=Object.assign(Object.assign({},l),s.headers));const d=this._removeEmptyFolders(r),u=this._getFinalPath(d),m=yield(t=="PUT"?Rf:br)(this.fetch,`${this.url}/object/${u}`,a,Object.assign({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:d,id:m.Id,fullPath:m.Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Ge(a))return{data:null,error:a};throw a}})}upload(t,r,n){return mt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,s){return mt(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(t),o=this._getFinalPath(a),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",r);try{let c;const d=Object.assign({upsert:kg.upsert},s),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",d.cacheControl)):(c=n,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const m=yield Rf(this.fetch,l.toString(),c,{headers:u});return{data:{path:a,fullPath:m.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(Ge(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return mt(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const s=Object.assign({},this.headers);r!=null&&r.upsert&&(s["x-upsert"]="true");const a=yield br(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),o=new URL(this.url+a.url),l=o.searchParams.get("token");if(!l)throw new ih("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:l},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ge(n))return{data:null,error:n};throw n}})}update(t,r,n){return mt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return mt(this,void 0,void 0,function*(){try{return{data:yield br(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ge(s))return{data:null,error:s};throw s}})}copy(t,r,n){return mt(this,void 0,void 0,function*(){try{return{data:{path:(yield br(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ge(s))return{data:null,error:s};throw s}})}createSignedUrl(t,r,n){return mt(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),a=yield br(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${o}`)},{data:a,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ge(s))return{data:null,error:s};throw s}})}createSignedUrls(t,r,n){return mt(this,void 0,void 0,function*(){try{const s=yield br(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${a}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ge(s))return{data:null,error:s};throw s}})}download(t,r){return mt(this,void 0,void 0,function*(){const s=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),o=a?`?${a}`:"";try{const l=this._getFinalPath(t);return{data:yield(yield Xl(this.fetch,`${this.url}/${s}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Ge(l))return{data:null,error:l};throw l}})}info(t){return mt(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield Xl(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Tf(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ge(n))return{data:null,error:n};throw n}})}exists(t){return mt(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield q2(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ge(n)&&n instanceof Pf){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),s=[],a=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";a!==""&&s.push(a);const l=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&s.push(c);let d=s.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${d}`)}}}remove(t){return mt(this,void 0,void 0,function*(){try{return{data:yield ob(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ge(r))return{data:null,error:r};throw r}})}list(t,r,n){return mt(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},G2),r),{prefix:t||""});return{data:yield br(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ge(s))return{data:null,error:s};throw s}})}listV2(t,r){return mt(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield br(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ge(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const Q2="2.12.1",J2={"X-Client-Info":`storage-js/${Q2}`};var js=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(u){try{d(n.next(u))}catch(m){o(m)}}function c(u){try{d(n.throw(u))}catch(m){o(m)}}function d(u){u.done?a(u.value):s(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class X2{constructor(t,r={},n,s){this.shouldThrowOnError=!1;const a=new URL(t);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href,this.headers=Object.assign(Object.assign({},J2),r),this.fetch=ib(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return js(this,void 0,void 0,function*(){try{return{data:yield Xl(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Ge(t))return{data:null,error:t};throw t}})}getBucket(t){return js(this,void 0,void 0,function*(){try{return{data:yield Xl(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ge(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return js(this,void 0,void 0,function*(){try{return{data:yield br(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ge(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return js(this,void 0,void 0,function*(){try{return{data:yield Rf(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ge(n))return{data:null,error:n};throw n}})}emptyBucket(t){return js(this,void 0,void 0,function*(){try{return{data:yield br(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ge(r))return{data:null,error:r};throw r}})}deleteBucket(t){return js(this,void 0,void 0,function*(){try{return{data:yield ob(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ge(r))return{data:null,error:r};throw r}})}}class Z2 extends X2{constructor(t,r={},n,s){super(t,r,n,s)}from(t){return new K2(this.url,this.headers,t,this.fetch)}}const eS="2.57.4";let oi="";typeof Deno<"u"?oi="deno":typeof document<"u"?oi="web":typeof navigator<"u"&&navigator.product==="ReactNative"?oi="react-native":oi="node";const tS={"X-Client-Info":`supabase-js-${oi}/${eS}`},rS={headers:tS},nS={schema:"public"},sS={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},aS={};var iS=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(u){try{d(n.next(u))}catch(m){o(m)}}function c(u){try{d(n.throw(u))}catch(m){o(m)}}function d(u){u.done?a(u.value):s(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const oS=e=>{let t;return e?t=e:typeof fetch>"u"?t=Yv:t=fetch,(...r)=>t(...r)},lS=()=>typeof Headers>"u"?qv:Headers,cS=(e,t,r)=>{const n=oS(r),s=lS();return(a,o)=>iS(void 0,void 0,void 0,function*(){var l;const c=(l=yield t())!==null&&l!==void 0?l:e;let d=new s(o==null?void 0:o.headers);return d.has("apikey")||d.set("apikey",e),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),n(a,Object.assign(Object.assign({},o),{headers:d}))})};var dS=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(u){try{d(n.next(u))}catch(m){o(m)}}function c(u){try{d(n.throw(u))}catch(m){o(m)}}function d(u){u.done?a(u.value):s(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};function uS(e){return e.endsWith("/")?e:e+"/"}function fS(e,t){var r,n;const{db:s,auth:a,realtime:o,global:l}=e,{db:c,auth:d,realtime:u,global:m}=t,f={db:Object.assign(Object.assign({},c),s),auth:Object.assign(Object.assign({},d),a),realtime:Object.assign(Object.assign({},u),o),storage:{},global:Object.assign(Object.assign(Object.assign({},m),l),{headers:Object.assign(Object.assign({},(r=m==null?void 0:m.headers)!==null&&r!==void 0?r:{}),(n=l==null?void 0:l.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>dS(this,void 0,void 0,function*(){return""})};return e.accessToken?f.accessToken=e.accessToken:delete f.accessToken,f}function mS(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(uS(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const lb="2.71.1",Es=30*1e3,Lf=3,Kd=Lf*Es,hS="http://localhost:9999",pS="supabase.auth.token",gS={"X-Client-Info":`gotrue-js/${lb}`},If="X-Supabase-Api-Version",cb={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},xS=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,yS=10*60*1e3;class oh extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function ie(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class vS extends oh{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function bS(e){return ie(e)&&e.name==="AuthApiError"}class db extends oh{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class $n extends oh{constructor(t,r,n,s){super(t,n,s),this.name=r,this.status=n}}class cn extends $n{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function wS(e){return ie(e)&&e.name==="AuthSessionMissingError"}class Bo extends $n{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Uo extends $n{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Wo extends $n{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function _S(e){return ie(e)&&e.name==="AuthImplicitGrantRedirectError"}class Sg extends $n{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Mf extends $n{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Qd(e){return ie(e)&&e.name==="AuthRetryableFetchError"}class Cg extends $n{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Of extends $n{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Zl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Dg=` 	
\r=`.split(""),jS=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Dg.length;t+=1)e[Dg[t].charCodeAt(0)]=-2;for(let t=0;t<Zl.length;t+=1)e[Zl[t].charCodeAt(0)]=t;return e})();function Eg(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Zl[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Zl[n]),t.queuedBits-=6}}function ub(e,t,r){const n=jS[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Pg(e){const t=[],r=o=>{t.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},a=o=>{SS(o,n,r)};for(let o=0;o<e.length;o+=1)ub(e.charCodeAt(o),s,a);return t.join("")}function NS(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function kS(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}NS(n,t)}}function SS(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function CS(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)ub(e.charCodeAt(s),r,n);return new Uint8Array(t)}function DS(e){const t=[];return kS(e,r=>t.push(r)),new Uint8Array(t)}function ES(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};return e.forEach(s=>Eg(s,r,n)),Eg(null,r,n),t.join("")}function PS(e){return Math.round(Date.now()/1e3)+e}function TS(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const tr=()=>typeof window<"u"&&typeof document<"u",Un={tested:!1,writable:!1},fb=()=>{if(!tr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Un.tested)return Un.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Un.tested=!0,Un.writable=!0}catch{Un.tested=!0,Un.writable=!1}return Un.writable};function RS(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,a)=>{t[a]=s})}catch{}return r.searchParams.forEach((n,s)=>{t[s]=n}),t}const mb=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>ja(()=>Promise.resolve().then(()=>Ca),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},LS=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Ps=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Wn=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},on=async(e,t)=>{await e.removeItem(t)};class Yc{constructor(){this.promise=new Yc.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Yc.promiseConstructor=Promise;function Jd(e){const t=e.split(".");if(t.length!==3)throw new Of("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!xS.test(t[n]))throw new Of("JWT not in base64url format");return{header:JSON.parse(Pg(t[0])),payload:JSON.parse(Pg(t[1])),signature:CS(t[2]),raw:{header:t[0],payload:t[1]}}}async function IS(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function MS(e,t){return new Promise((n,s)=>{(async()=>{for(let a=0;a<1/0;a++)try{const o=await e(a);if(!t(a,null,o)){n(o);return}}catch(o){if(!t(a,o)){s(o);return}}})()})}function OS(e){return("0"+e.toString(16)).substr(-2)}function AS(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let a=0;a<56;a++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(t),Array.from(t,OS).join("")}async function $S(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(a=>String.fromCharCode(a)).join("")}async function FS(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await $S(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ns(e,t,r=!1){const n=AS();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await Ps(e,`${t}-code-verifier`,s);const a=await FS(n);return[a,n===a?"plain":"s256"]}const BS=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function US(e){const t=e.headers.get(If);if(!t||!t.match(BS))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function WS(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function HS(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const zS=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ks(e){if(!zS.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Xd(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Tg(e){return JSON.parse(JSON.stringify(e))}var VS=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};const qn=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),YS=[502,503,504];async function Rg(e){var t;if(!LS(e))throw new Mf(qn(e),0);if(YS.includes(e.status))throw new Mf(qn(e),e.status);let r;try{r=await e.json()}catch(a){throw new db(qn(a),a)}let n;const s=US(e);if(s&&s.getTime()>=cb["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Cg(qn(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new cn}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((a,o)=>a&&typeof o=="string",!0))throw new Cg(qn(r),e.status,r.weak_password.reasons);throw new vS(qn(r),e.status||500,n)}const qS=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function ue(e,t,r,n){var s;const a=Object.assign({},n==null?void 0:n.headers);a[If]||(a[If]=cb["2024-01-01"].name),n!=null&&n.jwt&&(a.Authorization=`Bearer ${n.jwt}`);const o=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await GS(e,t,r+l,{headers:a,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function GS(e,t,r,n,s,a){const o=qS(t,n,s,a);let l;try{l=await e(r,Object.assign({},o))}catch(c){throw console.error(c),new Mf(qn(c),0)}if(l.ok||await Rg(l),n!=null&&n.noResolveJson)return l;try{return await l.json()}catch(c){await Rg(c)}}function Or(e){var t;let r=null;XS(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=PS(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function Lg(e){const t=Or(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function hn(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function KS(e){return{data:e,error:null}}function QS(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:a}=e,o=VS(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:a},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function JS(e){return e}function XS(e){return e.access_token&&e.refresh_token&&e.expires_in}const Zd=["global","local","others"];var ZS=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};class eC{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=mb(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=Zd[0]){if(Zd.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Zd.join(", ")}`);try{return await ue(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(ie(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await ue(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:hn})}catch(n){if(ie(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=ZS(t,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await ue(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:QS,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(ie(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await ue(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:hn})}catch(r){if(ie(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,s,a,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await ue(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(a=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:JS});if(u.error)throw u.error;const m=await u.json(),f=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,h=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return h.length>0&&(h.forEach(y=>{const w=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(y.split(";")[1].split("=")[1]);d[`${b}Page`]=w}),d.total=parseInt(f)),{data:Object.assign(Object.assign({},m),d),error:null}}catch(d){if(ie(d))return{data:{users:[]},error:d};throw d}}async getUserById(t){ks(t);try{return await ue(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:hn})}catch(r){if(ie(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){ks(t);try{return await ue(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:hn})}catch(n){if(ie(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){ks(t);try{return await ue(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:hn})}catch(n){if(ie(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){ks(t.userId);try{const{data:r,error:n}=await ue(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(ie(r))return{data:null,error:r};throw r}}async _deleteFactor(t){ks(t.userId),ks(t.id);try{return{data:await ue(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(ie(r))return{data:null,error:r};throw r}}}function Ig(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function tC(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Ss={debug:!!(globalThis&&fb()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class hb extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class rC extends hb{}async function nC(e,t,r){Ss.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Ss.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){Ss.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{Ss.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw Ss.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new rC(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Ss.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}tC();const sC={url:hS,storageKey:pS,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:gS,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Mg(e,t,r){return await r()}const Cs={};class Wi{constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Wi.nextInstanceID,Wi.nextInstanceID+=1,this.instanceID>0&&tr()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},sC),t);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new eC({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=mb(s.fetch),this.lock=s.lock||Mg,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:tr()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=nC:this.lock=Mg,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:fb()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Ig(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=Ig(this.memoryStorage)),tr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}get jwks(){var t,r;return(r=(t=Cs[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Cs[this.storageKey]=Object.assign(Object.assign({},Cs[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Cs[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Cs[this.storageKey]=Object.assign(Object.assign({},Cs[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${lb}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=RS(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),tr()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:a}=await this._getSessionFromURL(r,n);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),_S(a)){const c=(t=a.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:o,redirectType:l}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return ie(r)?{error:r}:{error:new db("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,s;try{const a=await ue(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.captchaToken}},xform:Or}),{data:o,error:l}=a;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(a){if(ie(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(t){var r,n,s;try{let a;if("email"in t){const{email:u,password:m,options:f}=t;let h=null,y=null;this.flowType==="pkce"&&([h,y]=await Ns(this.storage,this.storageKey)),a=await ue(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:u,password:m,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:h,code_challenge_method:y},xform:Or})}else if("phone"in t){const{phone:u,password:m,options:f}=t;a=await ue(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:m,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},channel:(s=f==null?void 0:f.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Or})}else throw new Uo("You must provide either an email or phone number and a password");const{data:o,error:l}=a;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(a){if(ie(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(t){try{let r;if("email"in t){const{email:a,password:o,options:l}=t;r=await ue(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Lg})}else if("phone"in t){const{phone:a,password:o,options:l}=t;r=await ue(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Lg})}else throw new Uo("You must provide either an email or phone number and a password");const{data:n,error:s}=r;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Bo}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(ie(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,s,a;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(a=t.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,s,a,o,l,c,d,u,m,f,h;let y,w;if("message"in t)y=t.message,w=t.signature;else{const{chain:b,wallet:g,statement:x,options:v}=t;let N;if(tr())if(typeof g=="object")N=g;else{const C=window;if("solana"in C&&typeof C.solana=="object"&&("signIn"in C.solana&&typeof C.solana.signIn=="function"||"signMessage"in C.solana&&typeof C.solana.signMessage=="function"))N=C.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(v!=null&&v.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");N=g}const _=new URL((r=v==null?void 0:v.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in N&&N.signIn){const C=await N.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},v==null?void 0:v.signInWithSolana),{version:"1",domain:_.host,uri:_.href}),x?{statement:x}:null));let j;if(Array.isArray(C)&&C[0]&&typeof C[0]=="object")j=C[0];else if(C&&typeof C=="object"&&"signedMessage"in C&&"signature"in C)j=C;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in j&&"signature"in j&&(typeof j.signedMessage=="string"||j.signedMessage instanceof Uint8Array)&&j.signature instanceof Uint8Array)y=typeof j.signedMessage=="string"?j.signedMessage:new TextDecoder().decode(j.signedMessage),w=j.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in N)||typeof N.signMessage!="function"||!("publicKey"in N)||typeof N!="object"||!N.publicKey||!("toBase58"in N.publicKey)||typeof N.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");y=[`${_.host} wants you to sign in with your Solana account:`,N.publicKey.toBase58(),...x?["",x,""]:[""],"Version: 1",`URI: ${_.href}`,`Issued At: ${(s=(n=v==null?void 0:v.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((a=v==null?void 0:v.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${v.signInWithSolana.notBefore}`]:[],...!((o=v==null?void 0:v.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${v.signInWithSolana.expirationTime}`]:[],...!((l=v==null?void 0:v.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${v.signInWithSolana.chainId}`]:[],...!((c=v==null?void 0:v.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${v.signInWithSolana.nonce}`]:[],...!((d=v==null?void 0:v.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${v.signInWithSolana.requestId}`]:[],...!((m=(u=v==null?void 0:v.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||m===void 0)&&m.length?["Resources",...v.signInWithSolana.resources.map(j=>`- ${j}`)]:[]].join(`
`);const C=await N.signMessage(new TextEncoder().encode(y),"utf8");if(!C||!(C instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=C}}try{const{data:b,error:g}=await ue(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:y,signature:ES(w)},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:Or});if(g)throw g;return!b||!b.session||!b.user?{data:{user:null,session:null},error:new Bo}:(b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),{data:Object.assign({},b),error:g})}catch(b){if(ie(b))return{data:{user:null,session:null},error:b};throw b}}async _exchangeCodeForSession(t){const r=await Wn(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:a,error:o}=await ue(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Or});if(await on(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new Bo}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:s??null}),error:o})}catch(a){if(ie(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(t){try{const{options:r,provider:n,token:s,access_token:a,nonce:o}=t,l=await ue(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:a,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Or}),{data:c,error:d}=l;return d?{data:{user:null,session:null},error:d}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new Bo}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:d})}catch(r){if(ie(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,s,a,o;try{if("email"in t){const{email:l,options:c}=t;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await Ns(this.storage,this.storageKey));const{error:m}=await ue(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:m}}if("phone"in t){const{phone:l,options:c}=t,{data:d,error:u}=await ue(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:u}}throw new Uo("You must provide either an email or phone number.")}catch(l){if(ie(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(t){var r,n;try{let s,a;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,a=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:l}=await ue(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:a}}),redirectTo:s,xform:Or});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,d=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(s){if(ie(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(t){var r,n,s;try{let a=null,o=null;return this.flowType==="pkce"&&([a,o]=await Ns(this.storage,this.storageKey)),await ue(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=t==null?void 0:t.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:o}),headers:this.headers,xform:KS})}catch(a){if(ie(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new cn;const{error:s}=await ue(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}})}catch(t){if(ie(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:s,options:a}=t,{error:o}=await ue(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in t){const{phone:n,type:s,options:a}=t,{data:o,error:l}=await ue(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new Uo("You must provide either an email or phone number and a type")}catch(r){if(ie(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Wn(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<Kd:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const o=await Wn(this.userStorage,this.storageKey+"-user");o!=null&&o.user?t.user=o.user:t.user=Xd()}if(this.storage.isServer&&t.user){let o=this.suppressGetSessionWarning;t=new Proxy(t,{get:(c,d,u)=>(!o&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,d,u))})}return{data:{session:t},error:null}}const{session:s,error:a}=await this._callRefreshToken(t.refresh_token);return a?{data:{session:null},error:a}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await ue(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:hn}):await this._useSession(async r=>{var n,s,a;const{data:o,error:l}=r;if(l)throw l;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new cn}:await ue(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0,xform:hn})})}catch(r){if(ie(r))return wS(r)&&(await this._removeSession(),await on(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:s,error:a}=n;if(a)throw a;if(!s.session)throw new cn;const o=s.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await Ns(this.storage,this.storageKey));const{data:d,error:u}=await ue(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:hn});if(u)throw u;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(n){if(ie(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new cn;const r=Date.now()/1e3;let n=r,s=!0,a=null;const{payload:o}=Jd(t.access_token);if(o.exp&&(n=o.exp,s=n<=r),s){const{session:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};a=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;a={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(r){if(ie(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:o,error:l}=r;if(l)throw l;t=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new cn;const{session:s,error:a}=await this._callRefreshToken(t.refresh_token);return a?{data:{user:null,session:null},error:a}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(ie(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!tr())throw new Wo("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Wo(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Sg("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Wo("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Sg("No code detected.");const{data:x,error:v}=await this._exchangeCodeForSession(t.code);if(v)throw v;const N=new URL(window.location.href);return N.searchParams.delete("code"),window.history.replaceState(window.history.state,"",N.toString()),{data:{session:x.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:a,refresh_token:o,expires_in:l,expires_at:c,token_type:d}=t;if(!a||!l||!o||!d)throw new Wo("No session defined in URL");const u=Math.round(Date.now()/1e3),m=parseInt(l);let f=u+m;c&&(f=parseInt(c));const h=f-u;h*1e3<=Es&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${m}s`);const y=f-m;u-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,f,u):u-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,f,u);const{data:w,error:b}=await this._getUser(a);if(b)throw b;const g={provider_token:n,provider_refresh_token:s,access_token:a,expires_in:m,expires_at:f,refresh_token:o,token_type:d,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:t.type},error:null}}catch(n){if(ie(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Wn(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:a}=r;if(a)return{error:a};const o=(n=s.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:l}=await this.admin.signOut(o,t);if(l&&!(bS(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return t!=="others"&&(await this._removeSession(),await on(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=TS(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,s;try{const{data:{session:a},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",t,"session",a)}catch(a){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",a),console.error(a)}})}async resetPasswordForEmail(t,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await Ns(this.storage,this.storageKey,!0));try{return await ue(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(a){if(ie(a))return{data:null,error:a};throw a}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(ie(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:s}=await this._useSession(async a=>{var o,l,c,d,u;const{data:m,error:f}=a;if(f)throw f;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await ue(this.fetch,"GET",h,{headers:this.headers,jwt:(u=(d=m.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(s)throw s;return tr()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(ie(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,s;const{data:a,error:o}=r;if(o)throw o;return await ue(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(ie(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await MS(async s=>(s>0&&await IS(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await ue(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Or})),(s,a)=>{const o=200*Math.pow(2,s);return a&&Qd(a)&&Date.now()+o-n<Es})}catch(n){if(this._debug(r,"error",n),ie(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),tr()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await Wn(this.storage,this.storageKey);if(s&&this.userStorage){let o=await Wn(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await Ps(this.userStorage,this.storageKey+"-user",o)),s.user=(t=o==null?void 0:o.user)!==null&&t!==void 0?t:Xd()}else if(s&&!s.user&&!s.user){const o=await Wn(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(s.user=o.user,await on(this.storage,this.storageKey+"-user"),await Ps(this.storage,this.storageKey,s)):s.user=Xd()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const a=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Kd;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${Kd}s`),a){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),Qd(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(s.access_token);!l&&(o!=null&&o.user)?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new cn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Yc;const{data:a,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!a.session)throw new cn;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const l={session:a.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(a){if(this._debug(s,"error",a),ie(a)){const o={session:null,error:a};return Qd(a)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(a),a}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,n=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const a=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,r)}catch(c){a.push(c)}});if(await Promise.all(o),a.length>0){for(let l=0;l<a.length;l+=1)console.error(a[l]);throw a[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Ps(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const a=Tg(s);await Ps(this.storage,this.storageKey,a)}else{const s=Tg(r);await Ps(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await on(this.storage,this.storageKey),await on(this.storage,this.storageKey+"-code-verifier"),await on(this.storage,this.storageKey+"-user"),this.userStorage&&await on(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&tr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Es);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-t)/Es);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Es}ms, refresh threshold is ${Lf} ticks`),s<=Lf&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof hb)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!tr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[a,o]=await Ns(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(l.toString())}if(n!=null&&n.queryParams){const a=new URLSearchParams(n.queryParams);s.push(a.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;return a?{data:null,error:a}:await ue(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(ie(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,s;const{data:a,error:o}=r;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:c,error:d}=await ue(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return d?{data:null,error:d}:(t.factorType==="totp"&&(!((s=c==null?void 0:c.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(r){if(ie(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;if(a)return{data:null,error:a};const{data:o,error:l}=await ue(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(r){if(ie(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;return a?{data:null,error:a}:await ue(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(ie(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],s=n.filter(o=>o.factor_type==="totp"&&o.status==="verified"),a=n.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:n,totp:s,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:s},error:a}=t;if(a)return{data:null,error:a};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Jd(s.access_token);let l=null;o.aal&&(l=o.aal);let c=l;((n=(r=s.user.factors)===null||r===void 0?void 0:r.filter(m=>m.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(c="aal2");const u=o.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(l=>l.kid===t);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(l=>l.kid===t),n&&this.jwks_cached_at+yS>s)return n;const{data:a,error:o}=await ue(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=s,n=a.keys.find(l=>l.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:h,error:y}=await this.getSession();if(y||!h.session)return{data:null,error:y};n=h.session.access_token}const{header:s,payload:a,signature:o,raw:{header:l,payload:c}}=Jd(n);r!=null&&r.allowExpired||WS(a.exp);const d=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!d){const{error:h}=await this.getUser(n);if(h)throw h;return{data:{claims:a,header:s,signature:o},error:null}}const u=HS(s.alg),m=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,m,o,DS(`${l}.${c}`)))throw new Of("Invalid JWT signature");return{data:{claims:a,header:s,signature:o},error:null}}catch(n){if(ie(n))return{data:null,error:n};throw n}}}Wi.nextInstanceID=0;const aC=Wi;class iC extends aC{constructor(t){super(t)}}var oC=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(u){try{d(n.next(u))}catch(m){o(m)}}function c(u){try{d(n.throw(u))}catch(m){o(m)}}function d(u){u.done?a(u.value):s(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class lC{constructor(t,r,n){var s,a,o;this.supabaseUrl=t,this.supabaseKey=r;const l=mS(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:nS,realtime:aS,auth:Object.assign(Object.assign({},sS),{storageKey:c}),global:rS},u=fS(n??{},d);this.storageKey=(s=u.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(a=u.global.headers)!==null&&a!==void 0?a:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(m,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=u.auth)!==null&&o!==void 0?o:{},this.headers,u.global.fetch),this.fetch=cS(r,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new j2(new URL("rest/v1",l).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new Z2(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new t2(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return oC(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:a,storageKey:o,flowType:l,lock:c,debug:d},u,m){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new iC({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),u),storageKey:o,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:a,flowType:l,lock:c,debug:d,fetch:m,hasCustomAuthorizationHeader:Object.keys(this.headers).some(h=>h.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new B2(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const cC=(e,t,r)=>new lC(e,t,r);function dC(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}dC()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const uC="https://rqbvcvwbziilnycqtmnc.supabase.co",fC="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJxYnZjdndiemlpbG55Y3F0bW5jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAyMzk5ODIsImV4cCI6MjA2NTgxNTk4Mn0.819LDXCnlu2dgCPw91oMbZIojeFom-UxqJn2hA5yjBM",M=cC(uC,fC),pb=p.createContext(void 0);function mC(){const e=p.useContext(pb);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e}function hC({children:e}){const[t,r]=p.useState(null),[n,s]=p.useState(null),[a,o]=p.useState(!0);p.useEffect(()=>{M.auth.getSession().then(({data:{session:f}})=>{s(f),r((f==null?void 0:f.user)??null),o(!1)});const{data:{subscription:m}}=M.auth.onAuthStateChange(async(f,h)=>{s(h),r((h==null?void 0:h.user)??null),o(!1)});return()=>m.unsubscribe()},[]);const u={user:t,session:n,loading:a,signIn:async(m,f)=>await M.auth.signInWithPassword({email:m,password:f}),signUp:async(m,f)=>await M.auth.signUp({email:m,password:f}),signOut:async()=>{await M.auth.signOut()}};return i.jsx(pb.Provider,{value:u,children:e})}function pC({children:e}){return i.jsx(i.Fragment,{children:e})}function pt(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var gC=(()=>typeof Symbol=="function"&&Symbol.observable||"@@observable")(),Og=gC,eu=()=>Math.random().toString(36).substring(7).split("").join("."),xC={INIT:`@@redux/INIT${eu()}`,REPLACE:`@@redux/REPLACE${eu()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${eu()}`},Ag=xC;function yC(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function gb(e,t,r){if(typeof e!="function")throw new Error(pt(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(pt(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(pt(1));return r(gb)(e,t)}let n=e,s=t,a=new Map,o=a,l=0,c=!1;function d(){o===a&&(o=new Map,a.forEach((b,g)=>{o.set(g,b)}))}function u(){if(c)throw new Error(pt(3));return s}function m(b){if(typeof b!="function")throw new Error(pt(4));if(c)throw new Error(pt(5));let g=!0;d();const x=l++;return o.set(x,b),function(){if(g){if(c)throw new Error(pt(6));g=!1,d(),o.delete(x),a=null}}}function f(b){if(!yC(b))throw new Error(pt(7));if(typeof b.type>"u")throw new Error(pt(8));if(typeof b.type!="string")throw new Error(pt(17));if(c)throw new Error(pt(9));try{c=!0,s=n(s,b)}finally{c=!1}return(a=o).forEach(x=>{x()}),b}function h(b){if(typeof b!="function")throw new Error(pt(10));n=b,f({type:Ag.REPLACE})}function y(){const b=m;return{subscribe(g){if(typeof g!="object"||g===null)throw new Error(pt(11));function x(){const N=g;N.next&&N.next(u())}return x(),{unsubscribe:b(x)}},[Og](){return this}}}return f({type:Ag.INIT}),{dispatch:f,subscribe:m,getState:u,replaceReducer:h,[Og]:y}}function $g(e,t){return function(...r){return t(e.apply(this,r))}}function Fg(e,t){if(typeof e=="function")return $g(e,t);if(typeof e!="object"||e===null)throw new Error(pt(16));const r={};for(const n in e){const s=e[n];typeof s=="function"&&(r[n]=$g(s,t))}return r}function xb(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function vC(...e){return t=>(r,n)=>{const s=t(r,n);let a=()=>{throw new Error(pt(15))};const o={getState:s.getState,dispatch:(c,...d)=>a(c,...d)},l=e.map(c=>c(o));return a=xb(...l)(s.dispatch),{...s,dispatch:a}}}var bC={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uo=p;function wC(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var _C=typeof Object.is=="function"?Object.is:wC,jC=uo.useSyncExternalStore,NC=uo.useRef,kC=uo.useEffect,SC=uo.useMemo,CC=uo.useDebugValue;bC.useSyncExternalStoreWithSelector=function(e,t,r,n,s){var a=NC(null);if(a.current===null){var o={hasValue:!1,value:null};a.current=o}else o=a.current;a=SC(function(){function c(h){if(!d){if(d=!0,u=h,h=n(h),s!==void 0&&o.hasValue){var y=o.value;if(s(y,h))return m=y}return m=h}if(y=m,_C(u,h))return y;var w=n(h);return s!==void 0&&s(y,w)?(u=h,y):(u=h,m=w)}var d=!1,u,m,f=r===void 0?null:r;return[function(){return c(t())},f===null?void 0:function(){return c(f())}]},[t,r,n,s]);var l=jC(e,a[0],a[1]);return kC(function(){o.hasValue=!0,o.value=l},[l]),CC(l),l};var DC=p.version.startsWith("19"),EC=Symbol.for(DC?"react.transitional.element":"react.element"),PC=Symbol.for("react.portal"),TC=Symbol.for("react.fragment"),RC=Symbol.for("react.strict_mode"),LC=Symbol.for("react.profiler"),IC=Symbol.for("react.consumer"),MC=Symbol.for("react.context"),yb=Symbol.for("react.forward_ref"),OC=Symbol.for("react.suspense"),AC=Symbol.for("react.suspense_list"),lh=Symbol.for("react.memo"),$C=Symbol.for("react.lazy"),FC=yb,BC=lh;function UC(e){if(typeof e=="object"&&e!==null){const{$$typeof:t}=e;switch(t){case EC:switch(e=e.type,e){case TC:case LC:case RC:case OC:case AC:return e;default:switch(e=e&&e.$$typeof,e){case MC:case yb:case $C:case lh:return e;case IC:return e;default:return t}}case PC:return t}}}function WC(e){return UC(e)===lh}function HC(e,t,r,n,{areStatesEqual:s,areOwnPropsEqual:a,areStatePropsEqual:o}){let l=!1,c,d,u,m,f;function h(x,v){return c=x,d=v,u=e(c,d),m=t(n,d),f=r(u,m,d),l=!0,f}function y(){return u=e(c,d),t.dependsOnOwnProps&&(m=t(n,d)),f=r(u,m,d),f}function w(){return e.dependsOnOwnProps&&(u=e(c,d)),t.dependsOnOwnProps&&(m=t(n,d)),f=r(u,m,d),f}function b(){const x=e(c,d),v=!o(x,u);return u=x,v&&(f=r(u,m,d)),f}function g(x,v){const N=!a(v,d),_=!s(x,c,v,d);return c=x,d=v,N&&_?y():N?w():_?b():f}return function(v,N){return l?g(v,N):h(v,N)}}function zC(e,{initMapStateToProps:t,initMapDispatchToProps:r,initMergeProps:n,...s}){const a=t(e,s),o=r(e,s),l=n(e,s);return HC(a,o,l,e,s)}function VC(e,t){const r={};for(const n in e){const s=e[n];typeof s=="function"&&(r[n]=(...a)=>t(s(...a)))}return r}function Af(e){return function(r){const n=e(r);function s(){return n}return s.dependsOnOwnProps=!1,s}}function Bg(e){return e.dependsOnOwnProps?!!e.dependsOnOwnProps:e.length!==1}function vb(e,t){return function(n,{displayName:s}){const a=function(l,c){return a.dependsOnOwnProps?a.mapToProps(l,c):a.mapToProps(l,void 0)};return a.dependsOnOwnProps=!0,a.mapToProps=function(l,c){a.mapToProps=e,a.dependsOnOwnProps=Bg(e);let d=a(l,c);return typeof d=="function"&&(a.mapToProps=d,a.dependsOnOwnProps=Bg(d),d=a(l,c)),d},a}}function ch(e,t){return(r,n)=>{throw new Error(`Invalid value of type ${typeof e} for ${t} argument when connecting component ${n.wrappedComponentName}.`)}}function YC(e){return e&&typeof e=="object"?Af(t=>VC(e,t)):e?typeof e=="function"?vb(e):ch(e,"mapDispatchToProps"):Af(t=>({dispatch:t}))}function qC(e){return e?typeof e=="function"?vb(e):ch(e,"mapStateToProps"):Af(()=>({}))}function GC(e,t,r){return{...r,...e,...t}}function KC(e){return function(r,{displayName:n,areMergedPropsEqual:s}){let a=!1,o;return function(c,d,u){const m=e(c,d,u);return a?s(m,o)||(o=m):(a=!0,o=m),o}}}function QC(e){return e?typeof e=="function"?KC(e):ch(e,"mergeProps"):()=>GC}function JC(e){e()}function XC(){let e=null,t=null;return{clear(){e=null,t=null},notify(){JC(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const s=t={callback:r,next:null,prev:t};return s.prev?s.prev.next=s:e=s,function(){!n||e===null||(n=!1,s.next?s.next.prev=s.prev:t=s.prev,s.prev?s.prev.next=s.next:e=s.next)}}}}var Ug={notify(){},get:()=>[]};function bb(e,t){let r,n=Ug,s=0,a=!1;function o(w){u();const b=n.subscribe(w);let g=!1;return()=>{g||(g=!0,b(),m())}}function l(){n.notify()}function c(){y.onStateChange&&y.onStateChange()}function d(){return a}function u(){s++,r||(r=t?t.addNestedSub(c):e.subscribe(c),n=XC())}function m(){s--,r&&s===0&&(r(),r=void 0,n.clear(),n=Ug)}function f(){a||(a=!0,u())}function h(){a&&(a=!1,m())}const y={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:d,trySubscribe:f,tryUnsubscribe:h,getListeners:()=>n};return y}var ZC=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",eD=ZC(),tD=()=>typeof navigator<"u"&&navigator.product==="ReactNative",rD=tD(),nD=()=>eD||rD?p.useLayoutEffect:p.useEffect,ec=nD();function Wg(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function tu(e,t){if(Wg(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(!Object.prototype.hasOwnProperty.call(t,r[s])||!Wg(e[r[s]],t[r[s]]))return!1;return!0}var sD={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},aD={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},iD={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},wb={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},oD={[FC]:iD,[BC]:wb};function Hg(e){return WC(e)?wb:oD[e.$$typeof]||sD}var lD=Object.defineProperty,cD=Object.getOwnPropertyNames,zg=Object.getOwnPropertySymbols,dD=Object.getOwnPropertyDescriptor,uD=Object.getPrototypeOf,Vg=Object.prototype;function $f(e,t){if(typeof t!="string"){if(Vg){const a=uD(t);a&&a!==Vg&&$f(e,a)}let r=cD(t);zg&&(r=r.concat(zg(t)));const n=Hg(e),s=Hg(t);for(let a=0;a<r.length;++a){const o=r[a];if(!aD[o]&&!(s&&s[o])&&!(n&&n[o])){const l=dD(t,o);try{lD(e,o,l)}catch{}}}}return e}var ru=Symbol.for("react-redux-context"),nu=typeof globalThis<"u"?globalThis:{};function fD(){if(!p.createContext)return{};const e=nu[ru]??(nu[ru]=new Map);let t=e.get(p.createContext);return t||(t=p.createContext(null),e.set(p.createContext,t)),t}var _b=fD(),mD=[null,null];function hD(e,t,r){ec(()=>e(...t),r)}function pD(e,t,r,n,s,a){e.current=n,r.current=!1,s.current&&(s.current=null,a())}function gD(e,t,r,n,s,a,o,l,c,d,u){if(!e)return()=>{};let m=!1,f=null;const h=()=>{if(m||!l.current)return;const w=t.getState();let b,g;try{b=n(w,s.current)}catch(x){g=x,f=x}g||(f=null),b===a.current?o.current||d():(a.current=b,c.current=b,o.current=!0,u())};return r.onStateChange=h,r.trySubscribe(),h(),()=>{if(m=!0,r.tryUnsubscribe(),r.onStateChange=null,f)throw f}}function xD(e,t){return e===t}function yD(e,t,r,{pure:n,areStatesEqual:s=xD,areOwnPropsEqual:a=tu,areStatePropsEqual:o=tu,areMergedPropsEqual:l=tu,forwardRef:c=!1,context:d=_b}={}){const u=d,m=qC(e),f=YC(t),h=QC(r),y=!!e;return b=>{const g=b.displayName||b.name||"Component",x=`Connect(${g})`,v={shouldHandleStateChanges:y,displayName:x,wrappedComponentName:g,WrappedComponent:b,initMapStateToProps:m,initMapDispatchToProps:f,initMergeProps:h,areStatesEqual:s,areStatePropsEqual:o,areOwnPropsEqual:a,areMergedPropsEqual:l};function N(j){const[k,S,D]=p.useMemo(()=>{const{reactReduxForwardedRef:ye,...Se}=j;return[j.context,ye,Se]},[j]),R=p.useMemo(()=>{let ye=u;return k!=null&&k.Consumer,ye},[k,u]),P=p.useContext(R),A=!!j.store&&!!j.store.getState&&!!j.store.dispatch,I=!!P&&!!P.store,L=A?j.store:P.store,F=I?P.getServerState:L.getState,U=p.useMemo(()=>zC(L.dispatch,v),[L]),[E,$]=p.useMemo(()=>{if(!y)return mD;const ye=bb(L,A?void 0:P.subscription),Se=ye.notifyNestedSubs.bind(ye);return[ye,Se]},[L,A,P]),B=p.useMemo(()=>A?P:{...P,subscription:E},[A,P,E]),H=p.useRef(void 0),J=p.useRef(D),le=p.useRef(void 0),oe=p.useRef(!1),se=p.useRef(!1),ae=p.useRef(void 0);ec(()=>(se.current=!0,()=>{se.current=!1}),[]);const T=p.useMemo(()=>()=>le.current&&D===J.current?le.current:U(L.getState(),D),[L,D]),ee=p.useMemo(()=>Se=>E?gD(y,L,E,U,J,H,oe,se,le,$,Se):()=>{},[E]);hD(pD,[J,H,oe,D,le,$]);let q;try{q=p.useSyncExternalStore(ee,T,F?()=>U(F(),D):T)}catch(ye){throw ae.current&&(ye.message+=`
The error may be correlated with this previous error:
${ae.current.stack}

`),ye}ec(()=>{ae.current=void 0,le.current=void 0,H.current=q});const ce=p.useMemo(()=>p.createElement(b,{...q,ref:S}),[S,b,q]);return p.useMemo(()=>y?p.createElement(R.Provider,{value:B},ce):ce,[R,ce,B])}const C=p.memo(N);if(C.WrappedComponent=b,C.displayName=N.displayName=x,c){const k=p.forwardRef(function(D,R){return p.createElement(C,{...D,reactReduxForwardedRef:R})});return k.displayName=x,k.WrappedComponent=b,$f(k,b)}return $f(C,b)}}var jb=yD;function vD(e){const{children:t,context:r,serverState:n,store:s}=e,a=p.useMemo(()=>{const c=bb(s);return{store:s,subscription:c,getServerState:n?()=>n:void 0}},[s,n]),o=p.useMemo(()=>s.getState(),[s]);ec(()=>{const{subscription:c}=a;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==s.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[a,o]);const l=r||_b;return p.createElement(l.Provider,{value:a},t)}var bD=vD,wD=!0,su="Invariant failed";function _D(e,t){if(!e){if(wD)throw new Error(su);var r=typeof t=="function"?t():t,n=r?"".concat(su,": ").concat(r):su;throw new Error(n)}}var ir=function(t){var r=t.top,n=t.right,s=t.bottom,a=t.left,o=n-a,l=s-r,c={top:r,right:n,bottom:s,left:a,width:o,height:l,x:a,y:r,center:{x:(n+a)/2,y:(s+r)/2}};return c},dh=function(t,r){return{top:t.top-r.top,left:t.left-r.left,bottom:t.bottom+r.bottom,right:t.right+r.right}},Yg=function(t,r){return{top:t.top+r.top,left:t.left+r.left,bottom:t.bottom-r.bottom,right:t.right-r.right}},jD=function(t,r){return{top:t.top+r.y,left:t.left+r.x,bottom:t.bottom+r.y,right:t.right+r.x}},au={top:0,right:0,bottom:0,left:0},uh=function(t){var r=t.borderBox,n=t.margin,s=n===void 0?au:n,a=t.border,o=a===void 0?au:a,l=t.padding,c=l===void 0?au:l,d=ir(dh(r,s)),u=ir(Yg(r,o)),m=ir(Yg(u,c));return{marginBox:d,borderBox:ir(r),paddingBox:u,contentBox:m,margin:s,border:o,padding:c}},Bt=function(t){var r=t.slice(0,-2),n=t.slice(-2);if(n!=="px")return 0;var s=Number(r);return isNaN(s)&&_D(!1),s},ND=function(){return{x:window.pageXOffset,y:window.pageYOffset}},tc=function(t,r){var n=t.borderBox,s=t.border,a=t.margin,o=t.padding,l=jD(n,r);return uh({borderBox:l,border:s,margin:a,padding:o})},rc=function(t,r){return r===void 0&&(r=ND()),tc(t,r)},Nb=function(t,r){var n={top:Bt(r.marginTop),right:Bt(r.marginRight),bottom:Bt(r.marginBottom),left:Bt(r.marginLeft)},s={top:Bt(r.paddingTop),right:Bt(r.paddingRight),bottom:Bt(r.paddingBottom),left:Bt(r.paddingLeft)},a={top:Bt(r.borderTopWidth),right:Bt(r.borderRightWidth),bottom:Bt(r.borderBottomWidth),left:Bt(r.borderLeftWidth)};return uh({borderBox:t,margin:n,padding:s,border:a})},kb=function(t){var r=t.getBoundingClientRect(),n=window.getComputedStyle(t);return Nb(r,n)},kD=function(t){var r=[],n=null,s=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];r=l,!n&&(n=requestAnimationFrame(function(){n=null,t.apply(void 0,r)}))};return s.cancel=function(){n&&(cancelAnimationFrame(n),n=null)},s};const Hi=kD;function nc(){return nc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nc.apply(null,arguments)}function Sb(e,t){}Sb.bind(null,"warn");Sb.bind(null,"error");function Sn(){}function SD(e,t){return{...e,...t}}function qt(e,t,r){const n=t.map(s=>{const a=SD(r,s.options);return e.addEventListener(s.eventName,s.fn,a),function(){e.removeEventListener(s.eventName,s.fn,a)}});return function(){n.forEach(a=>{a()})}}const CD="Invariant failed";class sc extends Error{}sc.prototype.toString=function(){return this.message};function Y(e,t){throw new sc(CD)}class DD extends O.Component{constructor(...t){super(...t),this.callbacks=null,this.unbind=Sn,this.onWindowError=r=>{const n=this.getCallbacks();n.isDragging()&&n.tryAbort(),r.error instanceof sc&&r.preventDefault()},this.getCallbacks=()=>{if(!this.callbacks)throw new Error("Unable to find AppCallbacks in <ErrorBoundary/>");return this.callbacks},this.setCallbacks=r=>{this.callbacks=r}}componentDidMount(){this.unbind=qt(window,[{eventName:"error",fn:this.onWindowError}])}componentDidCatch(t){if(t instanceof sc){this.setState({});return}throw t}componentWillUnmount(){this.unbind()}render(){return this.props.children(this.setCallbacks)}}const ED=`
  Press space bar to start a drag.
  When dragging you can use the arrow keys to move the item around and escape to cancel.
  Some screen readers may require you to be in focus mode or to use your pass through key
`,ac=e=>e+1,PD=e=>`
  You have lifted an item in position ${ac(e.source.index)}
`,Cb=(e,t)=>{const r=e.droppableId===t.droppableId,n=ac(e.index),s=ac(t.index);return r?`
      You have moved the item from position ${n}
      to position ${s}
    `:`
    You have moved the item from position ${n}
    in list ${e.droppableId}
    to list ${t.droppableId}
    in position ${s}
  `},Db=(e,t,r)=>t.droppableId===r.droppableId?`
      The item ${e}
      has been combined with ${r.draggableId}`:`
      The item ${e}
      in list ${t.droppableId}
      has been combined with ${r.draggableId}
      in list ${r.droppableId}
    `,TD=e=>{const t=e.destination;if(t)return Cb(e.source,t);const r=e.combine;return r?Db(e.draggableId,e.source,r):"You are over an area that cannot be dropped on"},qg=e=>`
  The item has returned to its starting position
  of ${ac(e.index)}
`,RD=e=>{if(e.reason==="CANCEL")return`
      Movement cancelled.
      ${qg(e.source)}
    `;const t=e.destination,r=e.combine;return t?`
      You have dropped the item.
      ${Cb(e.source,t)}
    `:r?`
      You have dropped the item.
      ${Db(e.draggableId,e.source,r)}
    `:`
    The item has been dropped while not over a drop area.
    ${qg(e.source)}
  `},yl={dragHandleUsageInstructions:ED,onDragStart:PD,onDragUpdate:TD,onDragEnd:RD};function LD(e,t){return!!(e===t||Number.isNaN(e)&&Number.isNaN(t))}function Eb(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!LD(e[r],t[r]))return!1;return!0}function ge(e,t){const r=p.useState(()=>({inputs:t,result:e()}))[0],n=p.useRef(!0),s=p.useRef(r),o=n.current||!!(t&&s.current.inputs&&Eb(t,s.current.inputs))?s.current:{inputs:t,result:e()};return p.useEffect(()=>{n.current=!1,s.current=o},[o]),o.result}function re(e,t){return ge(()=>e,t)}const et={x:0,y:0},rt=(e,t)=>({x:e.x+t.x,y:e.y+t.y}),Rt=(e,t)=>({x:e.x-t.x,y:e.y-t.y}),Cn=(e,t)=>e.x===t.x&&e.y===t.y,Ea=e=>({x:e.x!==0?-e.x:0,y:e.y!==0?-e.y:0}),ps=(e,t,r=0)=>e==="x"?{x:t,y:r}:{x:r,y:t},zi=(e,t)=>Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2),Gg=(e,t)=>Math.min(...t.map(r=>zi(e,r))),Pb=e=>t=>({x:e(t.x),y:e(t.y)});var ID=(e,t)=>{const r=ir({top:Math.max(t.top,e.top),right:Math.min(t.right,e.right),bottom:Math.min(t.bottom,e.bottom),left:Math.max(t.left,e.left)});return r.width<=0||r.height<=0?null:r};const fo=(e,t)=>({top:e.top+t.y,left:e.left+t.x,bottom:e.bottom+t.y,right:e.right+t.x}),Kg=e=>[{x:e.left,y:e.top},{x:e.right,y:e.top},{x:e.left,y:e.bottom},{x:e.right,y:e.bottom}],MD={top:0,right:0,bottom:0,left:0},OD=(e,t)=>t?fo(e,t.scroll.diff.displacement):e,AD=(e,t,r)=>r&&r.increasedBy?{...e,[t.end]:e[t.end]+r.increasedBy[t.line]}:e,$D=(e,t)=>t&&t.shouldClipSubject?ID(t.pageMarginBox,e):ir(e);var la=({page:e,withPlaceholder:t,axis:r,frame:n})=>{const s=OD(e.marginBox,n),a=AD(s,r,t),o=$D(a,n);return{page:e,withPlaceholder:t,active:o}},fh=(e,t)=>{e.frame||Y();const r=e.frame,n=Rt(t,r.scroll.initial),s=Ea(n),a={...r,scroll:{initial:r.scroll.initial,current:t,diff:{value:n,displacement:s},max:r.scroll.max}},o=la({page:e.subject.page,withPlaceholder:e.subject.withPlaceholder,axis:e.axis,frame:a});return{...e,frame:a,subject:o}};function Ze(e,t=Eb){let r=null;function n(...s){if(r&&r.lastThis===this&&t(s,r.lastArgs))return r.lastResult;const a=e.apply(this,s);return r={lastResult:a,lastArgs:s,lastThis:this},a}return n.clear=function(){r=null},n}const Tb=Ze(e=>e.reduce((t,r)=>(t[r.descriptor.id]=r,t),{})),Rb=Ze(e=>e.reduce((t,r)=>(t[r.descriptor.id]=r,t),{})),qc=Ze(e=>Object.values(e)),FD=Ze(e=>Object.values(e));var Pa=Ze((e,t)=>FD(t).filter(n=>e===n.descriptor.droppableId).sort((n,s)=>n.descriptor.index-s.descriptor.index));function mh(e){return e.at&&e.at.type==="REORDER"?e.at.destination:null}function Gc(e){return e.at&&e.at.type==="COMBINE"?e.at.combine:null}var Kc=Ze((e,t)=>t.filter(r=>r.descriptor.id!==e.descriptor.id)),BD=({isMovingForward:e,draggable:t,destination:r,insideDestination:n,previousImpact:s})=>{if(!r.isCombineEnabled||!mh(s))return null;function o(h){const y={type:"COMBINE",combine:{draggableId:h,droppableId:r.descriptor.id}};return{...s,at:y}}const l=s.displaced.all,c=l.length?l[0]:null;if(e)return c?o(c):null;const d=Kc(t,n);if(!c){if(!d.length)return null;const h=d[d.length-1];return o(h.descriptor.id)}const u=d.findIndex(h=>h.descriptor.id===c);u===-1&&Y();const m=u-1;if(m<0)return null;const f=d[m];return o(f.descriptor.id)},Ta=(e,t)=>e.descriptor.droppableId===t.descriptor.id;const Lb={point:et,value:0},Vi={invisible:{},visible:{},all:[]},UD={displaced:Vi,displacedBy:Lb,at:null};var Kt=(e,t)=>r=>e<=r&&r<=t,Ib=e=>{const t=Kt(e.top,e.bottom),r=Kt(e.left,e.right);return n=>{if(t(n.top)&&t(n.bottom)&&r(n.left)&&r(n.right))return!0;const a=t(n.top)||t(n.bottom),o=r(n.left)||r(n.right);if(a&&o)return!0;const c=n.top<e.top&&n.bottom>e.bottom,d=n.left<e.left&&n.right>e.right;return c&&d?!0:c&&o||d&&a}},WD=e=>{const t=Kt(e.top,e.bottom),r=Kt(e.left,e.right);return n=>t(n.top)&&t(n.bottom)&&r(n.left)&&r(n.right)};const hh={direction:"vertical",line:"y",crossAxisLine:"x",start:"top",end:"bottom",size:"height",crossAxisStart:"left",crossAxisEnd:"right",crossAxisSize:"width"},Mb={direction:"horizontal",line:"x",crossAxisLine:"y",start:"left",end:"right",size:"width",crossAxisStart:"top",crossAxisEnd:"bottom",crossAxisSize:"height"};var HD=e=>t=>{const r=Kt(t.top,t.bottom),n=Kt(t.left,t.right);return s=>e===hh?r(s.top)&&r(s.bottom):n(s.left)&&n(s.right)};const zD=(e,t)=>{const r=t.frame?t.frame.scroll.diff.displacement:et;return fo(e,r)},VD=(e,t,r)=>t.subject.active?r(t.subject.active)(e):!1,YD=(e,t,r)=>r(t)(e),ph=({target:e,destination:t,viewport:r,withDroppableDisplacement:n,isVisibleThroughFrameFn:s})=>{const a=n?zD(e,t):e;return VD(a,t,s)&&YD(a,r,s)},qD=e=>ph({...e,isVisibleThroughFrameFn:Ib}),Ob=e=>ph({...e,isVisibleThroughFrameFn:WD}),GD=e=>ph({...e,isVisibleThroughFrameFn:HD(e.destination.axis)}),KD=(e,t,r)=>{if(typeof r=="boolean")return r;if(!t)return!0;const{invisible:n,visible:s}=t;if(n[e])return!1;const a=s[e];return a?a.shouldAnimate:!0};function QD(e,t){const r=e.page.marginBox,n={top:t.point.y,right:0,bottom:0,left:t.point.x};return ir(dh(r,n))}function Yi({afterDragging:e,destination:t,displacedBy:r,viewport:n,forceShouldAnimate:s,last:a}){return e.reduce(function(l,c){const d=QD(c,r),u=c.descriptor.id;if(l.all.push(u),!qD({target:d,destination:t,viewport:n,withDroppableDisplacement:!0}))return l.invisible[c.descriptor.id]=!0,l;const f=KD(u,a,s),h={draggableId:u,shouldAnimate:f};return l.visible[u]=h,l},{all:[],visible:{},invisible:{}})}function JD(e,t){if(!e.length)return 0;const r=e[e.length-1].descriptor.index;return t.inHomeList?r:r+1}function Qg({insideDestination:e,inHomeList:t,displacedBy:r,destination:n}){const s=JD(e,{inHomeList:t});return{displaced:Vi,displacedBy:r,at:{type:"REORDER",destination:{droppableId:n.descriptor.id,index:s}}}}function ic({draggable:e,insideDestination:t,destination:r,viewport:n,displacedBy:s,last:a,index:o,forceShouldAnimate:l}){const c=Ta(e,r);if(o==null)return Qg({insideDestination:t,inHomeList:c,displacedBy:s,destination:r});const d=t.find(y=>y.descriptor.index===o);if(!d)return Qg({insideDestination:t,inHomeList:c,displacedBy:s,destination:r});const u=Kc(e,t),m=t.indexOf(d),f=u.slice(m);return{displaced:Yi({afterDragging:f,destination:r,displacedBy:s,last:a,viewport:n.frame,forceShouldAnimate:l}),displacedBy:s,at:{type:"REORDER",destination:{droppableId:r.descriptor.id,index:o}}}}function Rn(e,t){return!!t.effected[e]}var XD=({isMovingForward:e,destination:t,draggables:r,combine:n,afterCritical:s})=>{if(!t.isCombineEnabled)return null;const a=n.draggableId,l=r[a].descriptor.index;return Rn(a,s)?e?l:l-1:e?l+1:l},ZD=({isMovingForward:e,isInHomeList:t,insideDestination:r,location:n})=>{if(!r.length)return null;const s=n.index,a=e?s+1:s-1,o=r[0].descriptor.index,l=r[r.length-1].descriptor.index,c=t?l:l+1;return a<o||a>c?null:a},eE=({isMovingForward:e,isInHomeList:t,draggable:r,draggables:n,destination:s,insideDestination:a,previousImpact:o,viewport:l,afterCritical:c})=>{const d=o.at;if(d||Y(),d.type==="REORDER"){const m=ZD({isMovingForward:e,isInHomeList:t,location:d.destination,insideDestination:a});return m==null?null:ic({draggable:r,insideDestination:a,destination:s,viewport:l,last:o.displaced,displacedBy:o.displacedBy,index:m})}const u=XD({isMovingForward:e,destination:s,displaced:o.displaced,draggables:n,combine:d.combine,afterCritical:c});return u==null?null:ic({draggable:r,insideDestination:a,destination:s,viewport:l,last:o.displaced,displacedBy:o.displacedBy,index:u})},tE=({displaced:e,afterCritical:t,combineWith:r,displacedBy:n})=>{const s=!!(e.visible[r]||e.invisible[r]);return Rn(r,t)?s?et:Ea(n.point):s?n.point:et},rE=({afterCritical:e,impact:t,draggables:r})=>{const n=Gc(t);n||Y();const s=n.draggableId,a=r[s].page.borderBox.center,o=tE({displaced:t.displaced,afterCritical:e,combineWith:s,displacedBy:t.displacedBy});return rt(a,o)};const Ab=(e,t)=>t.margin[e.start]+t.borderBox[e.size]/2,nE=(e,t)=>t.margin[e.end]+t.borderBox[e.size]/2,gh=(e,t,r)=>t[e.crossAxisStart]+r.margin[e.crossAxisStart]+r.borderBox[e.crossAxisSize]/2,Jg=({axis:e,moveRelativeTo:t,isMoving:r})=>ps(e.line,t.marginBox[e.end]+Ab(e,r),gh(e,t.marginBox,r)),Xg=({axis:e,moveRelativeTo:t,isMoving:r})=>ps(e.line,t.marginBox[e.start]-nE(e,r),gh(e,t.marginBox,r)),sE=({axis:e,moveInto:t,isMoving:r})=>ps(e.line,t.contentBox[e.start]+Ab(e,r),gh(e,t.contentBox,r));var aE=({impact:e,draggable:t,draggables:r,droppable:n,afterCritical:s})=>{const a=Pa(n.descriptor.id,r),o=t.page,l=n.axis;if(!a.length)return sE({axis:l,moveInto:n.page,isMoving:o});const{displaced:c,displacedBy:d}=e,u=c.all[0];if(u){const f=r[u];if(Rn(u,s))return Xg({axis:l,moveRelativeTo:f.page,isMoving:o});const h=tc(f.page,d.point);return Xg({axis:l,moveRelativeTo:h,isMoving:o})}const m=a[a.length-1];if(m.descriptor.id===t.descriptor.id)return o.borderBox.center;if(Rn(m.descriptor.id,s)){const f=tc(m.page,Ea(s.displacedBy.point));return Jg({axis:l,moveRelativeTo:f,isMoving:o})}return Jg({axis:l,moveRelativeTo:m.page,isMoving:o})},Ff=(e,t)=>{const r=e.frame;return r?rt(t,r.scroll.diff.displacement):t};const iE=({impact:e,draggable:t,droppable:r,draggables:n,afterCritical:s})=>{const a=t.page.borderBox.center,o=e.at;return!r||!o?a:o.type==="REORDER"?aE({impact:e,draggable:t,draggables:n,droppable:r,afterCritical:s}):rE({impact:e,draggables:n,afterCritical:s})};var Qc=e=>{const t=iE(e),r=e.droppable;return r?Ff(r,t):t},$b=(e,t)=>{const r=Rt(t,e.scroll.initial),n=Ea(r);return{frame:ir({top:t.y,bottom:t.y+e.frame.height,left:t.x,right:t.x+e.frame.width}),scroll:{initial:e.scroll.initial,max:e.scroll.max,current:t,diff:{value:r,displacement:n}}}};function Zg(e,t){return e.map(r=>t[r])}function oE(e,t){for(let r=0;r<t.length;r++){const n=t[r].visible[e];if(n)return n}return null}var lE=({impact:e,viewport:t,destination:r,draggables:n,maxScrollChange:s})=>{const a=$b(t,rt(t.scroll.current,s)),o=r.frame?fh(r,rt(r.frame.scroll.current,s)):r,l=e.displaced,c=Yi({afterDragging:Zg(l.all,n),destination:r,displacedBy:e.displacedBy,viewport:a.frame,last:l,forceShouldAnimate:!1}),d=Yi({afterDragging:Zg(l.all,n),destination:o,displacedBy:e.displacedBy,viewport:t.frame,last:l,forceShouldAnimate:!1}),u={},m={},f=[l,c,d];return l.all.forEach(y=>{const w=oE(y,f);if(w){m[y]=w;return}u[y]=!0}),{...e,displaced:{all:l.all,invisible:u,visible:m}}},cE=(e,t)=>rt(e.scroll.diff.displacement,t),xh=({pageBorderBoxCenter:e,draggable:t,viewport:r})=>{const n=cE(r,e),s=Rt(n,t.page.borderBox.center);return rt(t.client.borderBox.center,s)},Fb=({draggable:e,destination:t,newPageBorderBoxCenter:r,viewport:n,withDroppableDisplacement:s,onlyOnMainAxis:a=!1})=>{const o=Rt(r,e.page.borderBox.center),c={target:fo(e.page.borderBox,o),destination:t,withDroppableDisplacement:s,viewport:n};return a?GD(c):Ob(c)},dE=({isMovingForward:e,draggable:t,destination:r,draggables:n,previousImpact:s,viewport:a,previousPageBorderBoxCenter:o,previousClientSelection:l,afterCritical:c})=>{if(!r.isEnabled)return null;const d=Pa(r.descriptor.id,n),u=Ta(t,r),m=BD({isMovingForward:e,draggable:t,destination:r,insideDestination:d,previousImpact:s})||eE({isMovingForward:e,isInHomeList:u,draggable:t,draggables:n,destination:r,insideDestination:d,previousImpact:s,viewport:a,afterCritical:c});if(!m)return null;const f=Qc({impact:m,draggable:t,droppable:r,draggables:n,afterCritical:c});if(Fb({draggable:t,destination:r,newPageBorderBoxCenter:f,viewport:a.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0}))return{clientSelection:xh({pageBorderBoxCenter:f,draggable:t,viewport:a}),impact:m,scrollJumpRequest:null};const y=Rt(f,o),w=lE({impact:m,viewport:a,destination:r,draggables:n,maxScrollChange:y});return{clientSelection:l,impact:w,scrollJumpRequest:y}};const ht=e=>{const t=e.subject.active;return t||Y(),t};var uE=({isMovingForward:e,pageBorderBoxCenter:t,source:r,droppables:n,viewport:s})=>{const a=r.subject.active;if(!a)return null;const o=r.axis,l=Kt(a[o.start],a[o.end]),c=qc(n).filter(u=>u!==r).filter(u=>u.isEnabled).filter(u=>!!u.subject.active).filter(u=>Ib(s.frame)(ht(u))).filter(u=>{const m=ht(u);return e?a[o.crossAxisEnd]<m[o.crossAxisEnd]:m[o.crossAxisStart]<a[o.crossAxisStart]}).filter(u=>{const m=ht(u),f=Kt(m[o.start],m[o.end]);return l(m[o.start])||l(m[o.end])||f(a[o.start])||f(a[o.end])}).sort((u,m)=>{const f=ht(u)[o.crossAxisStart],h=ht(m)[o.crossAxisStart];return e?f-h:h-f}).filter((u,m,f)=>ht(u)[o.crossAxisStart]===ht(f[0])[o.crossAxisStart]);if(!c.length)return null;if(c.length===1)return c[0];const d=c.filter(u=>Kt(ht(u)[o.start],ht(u)[o.end])(t[o.line]));return d.length===1?d[0]:d.length>1?d.sort((u,m)=>ht(u)[o.start]-ht(m)[o.start])[0]:c.sort((u,m)=>{const f=Gg(t,Kg(ht(u))),h=Gg(t,Kg(ht(m)));return f!==h?f-h:ht(u)[o.start]-ht(m)[o.start]})[0]};const e0=(e,t)=>{const r=e.page.borderBox.center;return Rn(e.descriptor.id,t)?Rt(r,t.displacedBy.point):r},fE=(e,t)=>{const r=e.page.borderBox;return Rn(e.descriptor.id,t)?fo(r,Ea(t.displacedBy.point)):r};var mE=({pageBorderBoxCenter:e,viewport:t,destination:r,insideDestination:n,afterCritical:s})=>n.filter(o=>Ob({target:fE(o,s),destination:r,viewport:t.frame,withDroppableDisplacement:!0})).sort((o,l)=>{const c=zi(e,Ff(r,e0(o,s))),d=zi(e,Ff(r,e0(l,s)));return c<d?-1:d<c?1:o.descriptor.index-l.descriptor.index})[0]||null,mo=Ze(function(t,r){const n=r[t.line];return{value:n,point:ps(t.line,n)}});const hE=(e,t,r)=>{const n=e.axis;if(e.descriptor.mode==="virtual")return ps(n.line,t[n.line]);const s=e.subject.page.contentBox[n.size],c=Pa(e.descriptor.id,r).reduce((d,u)=>d+u.client.marginBox[n.size],0)+t[n.line]-s;return c<=0?null:ps(n.line,c)},Bb=(e,t)=>({...e,scroll:{...e.scroll,max:t}}),Ub=(e,t,r)=>{const n=e.frame;Ta(t,e)&&Y(),e.subject.withPlaceholder&&Y();const s=mo(e.axis,t.displaceBy).point,a=hE(e,s,r),o={placeholderSize:s,increasedBy:a,oldFrameMaxScroll:e.frame?e.frame.scroll.max:null};if(!n){const u=la({page:e.subject.page,withPlaceholder:o,axis:e.axis,frame:e.frame});return{...e,subject:u}}const l=a?rt(n.scroll.max,a):n.scroll.max,c=Bb(n,l),d=la({page:e.subject.page,withPlaceholder:o,axis:e.axis,frame:c});return{...e,subject:d,frame:c}},pE=e=>{const t=e.subject.withPlaceholder;t||Y();const r=e.frame;if(!r){const o=la({page:e.subject.page,axis:e.axis,frame:null,withPlaceholder:null});return{...e,subject:o}}const n=t.oldFrameMaxScroll;n||Y();const s=Bb(r,n),a=la({page:e.subject.page,axis:e.axis,frame:s,withPlaceholder:null});return{...e,subject:a,frame:s}};var gE=({previousPageBorderBoxCenter:e,moveRelativeTo:t,insideDestination:r,draggable:n,draggables:s,destination:a,viewport:o,afterCritical:l})=>{if(!t){if(r.length)return null;const m={displaced:Vi,displacedBy:Lb,at:{type:"REORDER",destination:{droppableId:a.descriptor.id,index:0}}},f=Qc({impact:m,draggable:n,droppable:a,draggables:s,afterCritical:l}),h=Ta(n,a)?a:Ub(a,n,s);return Fb({draggable:n,destination:h,newPageBorderBoxCenter:f,viewport:o.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0})?m:null}const c=e[a.axis.line]<=t.page.borderBox.center[a.axis.line],d=(()=>{const m=t.descriptor.index;return t.descriptor.id===n.descriptor.id||c?m:m+1})(),u=mo(a.axis,n.displaceBy);return ic({draggable:n,insideDestination:r,destination:a,viewport:o,displacedBy:u,last:Vi,index:d})},xE=({isMovingForward:e,previousPageBorderBoxCenter:t,draggable:r,isOver:n,draggables:s,droppables:a,viewport:o,afterCritical:l})=>{const c=uE({isMovingForward:e,pageBorderBoxCenter:t,source:n,droppables:a,viewport:o});if(!c)return null;const d=Pa(c.descriptor.id,s),u=mE({pageBorderBoxCenter:t,viewport:o,destination:c,insideDestination:d,afterCritical:l}),m=gE({previousPageBorderBoxCenter:t,destination:c,draggable:r,draggables:s,moveRelativeTo:u,insideDestination:d,viewport:o,afterCritical:l});if(!m)return null;const f=Qc({impact:m,draggable:r,droppable:c,draggables:s,afterCritical:l});return{clientSelection:xh({pageBorderBoxCenter:f,draggable:r,viewport:o}),impact:m,scrollJumpRequest:null}},It=e=>{const t=e.at;return t?t.type==="REORDER"?t.destination.droppableId:t.combine.droppableId:null};const yE=(e,t)=>{const r=It(e);return r?t[r]:null};var vE=({state:e,type:t})=>{const r=yE(e.impact,e.dimensions.droppables),n=!!r,s=e.dimensions.droppables[e.critical.droppable.id],a=r||s,o=a.axis.direction,l=o==="vertical"&&(t==="MOVE_UP"||t==="MOVE_DOWN")||o==="horizontal"&&(t==="MOVE_LEFT"||t==="MOVE_RIGHT");if(l&&!n)return null;const c=t==="MOVE_DOWN"||t==="MOVE_RIGHT",d=e.dimensions.draggables[e.critical.draggable.id],u=e.current.page.borderBoxCenter,{draggables:m,droppables:f}=e.dimensions;return l?dE({isMovingForward:c,previousPageBorderBoxCenter:u,draggable:d,destination:a,draggables:m,viewport:e.viewport,previousClientSelection:e.current.client.selection,previousImpact:e.impact,afterCritical:e.afterCritical}):xE({isMovingForward:c,previousPageBorderBoxCenter:u,draggable:d,isOver:a,draggables:m,droppables:f,viewport:e.viewport,afterCritical:e.afterCritical})};function Gn(e){return e.phase==="DRAGGING"||e.phase==="COLLECTING"}function Wb(e){const t=Kt(e.top,e.bottom),r=Kt(e.left,e.right);return function(s){return t(s.y)&&r(s.x)}}function bE(e,t){return e.left<t.right&&e.right>t.left&&e.top<t.bottom&&e.bottom>t.top}function wE({pageBorderBox:e,draggable:t,candidates:r}){const n=t.page.borderBox.center,s=r.map(a=>{const o=a.axis,l=ps(a.axis.line,e.center[o.line],a.page.borderBox.center[o.crossAxisLine]);return{id:a.descriptor.id,distance:zi(n,l)}}).sort((a,o)=>o.distance-a.distance);return s[0]?s[0].id:null}function _E({pageBorderBox:e,draggable:t,droppables:r}){const n=qc(r).filter(s=>{if(!s.isEnabled)return!1;const a=s.subject.active;if(!a||!bE(e,a))return!1;if(Wb(a)(e.center))return!0;const o=s.axis,l=a.center[o.crossAxisLine],c=e[o.crossAxisStart],d=e[o.crossAxisEnd],u=Kt(a[o.crossAxisStart],a[o.crossAxisEnd]),m=u(c),f=u(d);return!m&&!f?!0:m?c<l:d>l});return n.length?n.length===1?n[0].descriptor.id:wE({pageBorderBox:e,draggable:t,candidates:n}):null}const Hb=(e,t)=>ir(fo(e,t));var jE=(e,t)=>{const r=e.frame;return r?Hb(t,r.scroll.diff.value):t};function zb({displaced:e,id:t}){return!!(e.visible[t]||e.invisible[t])}function NE({draggable:e,closest:t,inHomeList:r}){return t?r&&t.descriptor.index>e.descriptor.index?t.descriptor.index-1:t.descriptor.index:null}var kE=({pageBorderBoxWithDroppableScroll:e,draggable:t,destination:r,insideDestination:n,last:s,viewport:a,afterCritical:o})=>{const l=r.axis,c=mo(r.axis,t.displaceBy),d=c.value,u=e[l.start],m=e[l.end],h=Kc(t,n).find(w=>{const b=w.descriptor.id,g=w.page.borderBox.center[l.line],x=Rn(b,o),v=zb({displaced:s,id:b});return x?v?m<=g:u<g-d:v?m<=g+d:u<g})||null,y=NE({draggable:t,closest:h,inHomeList:Ta(t,r)});return ic({draggable:t,insideDestination:n,destination:r,viewport:a,last:s,displacedBy:c,index:y})};const SE=4;var CE=({draggable:e,pageBorderBoxWithDroppableScroll:t,previousImpact:r,destination:n,insideDestination:s,afterCritical:a})=>{if(!n.isCombineEnabled)return null;const o=n.axis,l=mo(n.axis,e.displaceBy),c=l.value,d=t[o.start],u=t[o.end],f=Kc(e,s).find(y=>{const w=y.descriptor.id,b=y.page.borderBox,x=b[o.size]/SE,v=Rn(w,a),N=zb({displaced:r.displaced,id:w});return v?N?u>b[o.start]+x&&u<b[o.end]-x:d>b[o.start]-c+x&&d<b[o.end]-c-x:N?u>b[o.start]+c+x&&u<b[o.end]+c-x:d>b[o.start]+x&&d<b[o.end]-x});return f?{displacedBy:l,displaced:r.displaced,at:{type:"COMBINE",combine:{draggableId:f.descriptor.id,droppableId:n.descriptor.id}}}:null},Vb=({pageOffset:e,draggable:t,draggables:r,droppables:n,previousImpact:s,viewport:a,afterCritical:o})=>{const l=Hb(t.page.borderBox,e),c=_E({pageBorderBox:l,draggable:t,droppables:n});if(!c)return UD;const d=n[c],u=Pa(d.descriptor.id,r),m=jE(d,l);return CE({pageBorderBoxWithDroppableScroll:m,draggable:t,previousImpact:s,destination:d,insideDestination:u,afterCritical:o})||kE({pageBorderBoxWithDroppableScroll:m,draggable:t,destination:d,insideDestination:u,last:s.displaced,viewport:a,afterCritical:o})},yh=(e,t)=>({...e,[t.descriptor.id]:t});const DE=({previousImpact:e,impact:t,droppables:r})=>{const n=It(e),s=It(t);if(!n||n===s)return r;const a=r[n];if(!a.subject.withPlaceholder)return r;const o=pE(a);return yh(r,o)};var EE=({draggable:e,draggables:t,droppables:r,previousImpact:n,impact:s})=>{const a=DE({previousImpact:n,impact:s,droppables:r}),o=It(s);if(!o)return a;const l=r[o];if(Ta(e,l)||l.subject.withPlaceholder)return a;const c=Ub(l,e,t);return yh(a,c)},wi=({state:e,clientSelection:t,dimensions:r,viewport:n,impact:s,scrollJumpRequest:a})=>{const o=n||e.viewport,l=r||e.dimensions,c=t||e.current.client.selection,d=Rt(c,e.initial.client.selection),u={offset:d,selection:c,borderBoxCenter:rt(e.initial.client.borderBoxCenter,d)},m={selection:rt(u.selection,o.scroll.current),borderBoxCenter:rt(u.borderBoxCenter,o.scroll.current),offset:rt(u.offset,o.scroll.diff.value)},f={client:u,page:m};if(e.phase==="COLLECTING")return{...e,dimensions:l,viewport:o,current:f};const h=l.draggables[e.critical.draggable.id],y=s||Vb({pageOffset:m.offset,draggable:h,draggables:l.draggables,droppables:l.droppables,previousImpact:e.impact,viewport:o,afterCritical:e.afterCritical}),w=EE({draggable:h,impact:y,previousImpact:e.impact,draggables:l.draggables,droppables:l.droppables});return{...e,current:f,dimensions:{draggables:l.draggables,droppables:w},impact:y,viewport:o,scrollJumpRequest:a||null,forceShouldAnimate:a?!1:null}};function PE(e,t){return e.map(r=>t[r])}var Yb=({impact:e,viewport:t,draggables:r,destination:n,forceShouldAnimate:s})=>{const a=e.displaced,o=PE(a.all,r),l=Yi({afterDragging:o,destination:n,displacedBy:e.displacedBy,viewport:t.frame,forceShouldAnimate:s,last:a});return{...e,displaced:l}},qb=({impact:e,draggable:t,droppable:r,draggables:n,viewport:s,afterCritical:a})=>{const o=Qc({impact:e,draggable:t,draggables:n,droppable:r,afterCritical:a});return xh({pageBorderBoxCenter:o,draggable:t,viewport:s})},Gb=({state:e,dimensions:t,viewport:r})=>{e.movementMode!=="SNAP"&&Y();const n=e.impact,s=r||e.viewport,a=t||e.dimensions,{draggables:o,droppables:l}=a,c=o[e.critical.draggable.id],d=It(n);d||Y();const u=l[d],m=Yb({impact:n,viewport:s,destination:u,draggables:o}),f=qb({impact:m,draggable:c,droppable:u,draggables:o,viewport:s,afterCritical:e.afterCritical});return wi({impact:m,clientSelection:f,state:e,dimensions:a,viewport:s})},TE=e=>({index:e.index,droppableId:e.droppableId}),Kb=({draggable:e,home:t,draggables:r,viewport:n})=>{const s=mo(t.axis,e.displaceBy),a=Pa(t.descriptor.id,r),o=a.indexOf(e);o===-1&&Y();const l=a.slice(o+1),c=l.reduce((f,h)=>(f[h.descriptor.id]=!0,f),{}),d={inVirtualList:t.descriptor.mode==="virtual",displacedBy:s,effected:c};return{impact:{displaced:Yi({afterDragging:l,destination:t,displacedBy:s,last:null,viewport:n.frame,forceShouldAnimate:!1}),displacedBy:s,at:{type:"REORDER",destination:TE(e.descriptor)}},afterCritical:d}},RE=(e,t)=>({draggables:e.draggables,droppables:yh(e.droppables,t)}),LE=({draggable:e,offset:t,initialWindowScroll:r})=>{const n=tc(e.client,t),s=rc(n,r);return{...e,placeholder:{...e.placeholder,client:n},client:n,page:s}},IE=e=>{const t=e.frame;return t||Y(),t},ME=({additions:e,updatedDroppables:t,viewport:r})=>{const n=r.scroll.diff.value;return e.map(s=>{const a=s.descriptor.droppableId,o=t[a],c=IE(o).scroll.diff.value,d=rt(n,c);return LE({draggable:s,offset:d,initialWindowScroll:r.scroll.initial})})},OE=({state:e,published:t})=>{const r=t.modified.map(g=>{const x=e.dimensions.droppables[g.droppableId];return fh(x,g.scroll)}),n={...e.dimensions.droppables,...Tb(r)},s=Rb(ME({additions:t.additions,updatedDroppables:n,viewport:e.viewport})),a={...e.dimensions.draggables,...s};t.removals.forEach(g=>{delete a[g]});const o={droppables:n,draggables:a},l=It(e.impact),c=l?o.droppables[l]:null,d=o.draggables[e.critical.draggable.id],u=o.droppables[e.critical.droppable.id],{impact:m,afterCritical:f}=Kb({draggable:d,home:u,draggables:a,viewport:e.viewport}),h=c&&c.isCombineEnabled?e.impact:m,y=Vb({pageOffset:e.current.page.offset,draggable:o.draggables[e.critical.draggable.id],draggables:o.draggables,droppables:o.droppables,previousImpact:h,viewport:e.viewport,afterCritical:f}),w={...e,phase:"DRAGGING",impact:y,onLiftImpact:m,dimensions:o,afterCritical:f,forceShouldAnimate:!1};return e.phase==="COLLECTING"?w:{...w,phase:"DROP_PENDING",reason:e.reason,isWaiting:!1}};const Bf=e=>e.movementMode==="SNAP",iu=(e,t,r)=>{const n=RE(e.dimensions,t);return!Bf(e)||r?wi({state:e,dimensions:n}):Gb({state:e,dimensions:n})};function ou(e){return e.isDragging&&e.movementMode==="SNAP"?{...e,scrollJumpRequest:null}:e}const t0={phase:"IDLE",completed:null,shouldFlush:!1};var AE=(e=t0,t)=>{if(t.type==="FLUSH")return{...t0,shouldFlush:!0};if(t.type==="INITIAL_PUBLISH"){e.phase!=="IDLE"&&Y();const{critical:r,clientSelection:n,viewport:s,dimensions:a,movementMode:o}=t.payload,l=a.draggables[r.draggable.id],c=a.droppables[r.droppable.id],d={selection:n,borderBoxCenter:l.client.borderBox.center,offset:et},u={client:d,page:{selection:rt(d.selection,s.scroll.initial),borderBoxCenter:rt(d.selection,s.scroll.initial),offset:rt(d.selection,s.scroll.diff.value)}},m=qc(a.droppables).every(w=>!w.isFixedOnPage),{impact:f,afterCritical:h}=Kb({draggable:l,home:c,draggables:a.draggables,viewport:s});return{phase:"DRAGGING",isDragging:!0,critical:r,movementMode:o,dimensions:a,initial:u,current:u,isWindowScrollAllowed:m,impact:f,afterCritical:h,onLiftImpact:f,viewport:s,scrollJumpRequest:null,forceShouldAnimate:null}}if(t.type==="COLLECTION_STARTING")return e.phase==="COLLECTING"||e.phase==="DROP_PENDING"?e:(e.phase!=="DRAGGING"&&Y(),{...e,phase:"COLLECTING"});if(t.type==="PUBLISH_WHILE_DRAGGING")return e.phase==="COLLECTING"||e.phase==="DROP_PENDING"||Y(),OE({state:e,published:t.payload});if(t.type==="MOVE"){if(e.phase==="DROP_PENDING")return e;Gn(e)||Y();const{client:r}=t.payload;return Cn(r,e.current.client.selection)?e:wi({state:e,clientSelection:r,impact:Bf(e)?e.impact:null})}if(t.type==="UPDATE_DROPPABLE_SCROLL"){if(e.phase==="DROP_PENDING"||e.phase==="COLLECTING")return ou(e);Gn(e)||Y();const{id:r,newScroll:n}=t.payload,s=e.dimensions.droppables[r];if(!s)return e;const a=fh(s,n);return iu(e,a,!1)}if(t.type==="UPDATE_DROPPABLE_IS_ENABLED"){if(e.phase==="DROP_PENDING")return e;Gn(e)||Y();const{id:r,isEnabled:n}=t.payload,s=e.dimensions.droppables[r];s||Y(),s.isEnabled===n&&Y();const a={...s,isEnabled:n};return iu(e,a,!0)}if(t.type==="UPDATE_DROPPABLE_IS_COMBINE_ENABLED"){if(e.phase==="DROP_PENDING")return e;Gn(e)||Y();const{id:r,isCombineEnabled:n}=t.payload,s=e.dimensions.droppables[r];s||Y(),s.isCombineEnabled===n&&Y();const a={...s,isCombineEnabled:n};return iu(e,a,!0)}if(t.type==="MOVE_BY_WINDOW_SCROLL"){if(e.phase==="DROP_PENDING"||e.phase==="DROP_ANIMATING")return e;Gn(e)||Y(),e.isWindowScrollAllowed||Y();const r=t.payload.newScroll;if(Cn(e.viewport.scroll.current,r))return ou(e);const n=$b(e.viewport,r);return Bf(e)?Gb({state:e,viewport:n}):wi({state:e,viewport:n})}if(t.type==="UPDATE_VIEWPORT_MAX_SCROLL"){if(!Gn(e))return e;const r=t.payload.maxScroll;if(Cn(r,e.viewport.scroll.max))return e;const n={...e.viewport,scroll:{...e.viewport.scroll,max:r}};return{...e,viewport:n}}if(t.type==="MOVE_UP"||t.type==="MOVE_DOWN"||t.type==="MOVE_LEFT"||t.type==="MOVE_RIGHT"){if(e.phase==="COLLECTING"||e.phase==="DROP_PENDING")return e;e.phase!=="DRAGGING"&&Y();const r=vE({state:e,type:t.type});return r?wi({state:e,impact:r.impact,clientSelection:r.clientSelection,scrollJumpRequest:r.scrollJumpRequest}):e}if(t.type==="DROP_PENDING"){const r=t.payload.reason;return e.phase!=="COLLECTING"&&Y(),{...e,phase:"DROP_PENDING",isWaiting:!0,reason:r}}if(t.type==="DROP_ANIMATE"){const{completed:r,dropDuration:n,newHomeClientOffset:s}=t.payload;return e.phase==="DRAGGING"||e.phase==="DROP_PENDING"||Y(),{phase:"DROP_ANIMATING",completed:r,dropDuration:n,newHomeClientOffset:s,dimensions:e.dimensions}}if(t.type==="DROP_COMPLETE"){const{completed:r}=t.payload;return{phase:"IDLE",completed:r,shouldFlush:!1}}return e};function we(e,t){return e instanceof Object&&"type"in e&&e.type===t}const $E=e=>({type:"BEFORE_INITIAL_CAPTURE",payload:e}),FE=e=>({type:"LIFT",payload:e}),BE=e=>({type:"INITIAL_PUBLISH",payload:e}),UE=e=>({type:"PUBLISH_WHILE_DRAGGING",payload:e}),WE=()=>({type:"COLLECTION_STARTING",payload:null}),HE=e=>({type:"UPDATE_DROPPABLE_SCROLL",payload:e}),zE=e=>({type:"UPDATE_DROPPABLE_IS_ENABLED",payload:e}),VE=e=>({type:"UPDATE_DROPPABLE_IS_COMBINE_ENABLED",payload:e}),Qb=e=>({type:"MOVE",payload:e}),YE=e=>({type:"MOVE_BY_WINDOW_SCROLL",payload:e}),qE=e=>({type:"UPDATE_VIEWPORT_MAX_SCROLL",payload:e}),GE=()=>({type:"MOVE_UP",payload:null}),KE=()=>({type:"MOVE_DOWN",payload:null}),QE=()=>({type:"MOVE_RIGHT",payload:null}),JE=()=>({type:"MOVE_LEFT",payload:null}),vh=()=>({type:"FLUSH",payload:null}),XE=e=>({type:"DROP_ANIMATE",payload:e}),bh=e=>({type:"DROP_COMPLETE",payload:e}),Jb=e=>({type:"DROP",payload:e}),ZE=e=>({type:"DROP_PENDING",payload:e}),Xb=()=>({type:"DROP_ANIMATION_FINISHED",payload:null});var eP=e=>({getState:t,dispatch:r})=>n=>s=>{if(!we(s,"LIFT")){n(s);return}const{id:a,clientSelection:o,movementMode:l}=s.payload,c=t();c.phase==="DROP_ANIMATING"&&r(bh({completed:c.completed})),t().phase!=="IDLE"&&Y(),r(vh()),r($E({draggableId:a,movementMode:l}));const u={draggableId:a,scrollOptions:{shouldPublishImmediately:l==="SNAP"}},{critical:m,dimensions:f,viewport:h}=e.startPublishing(u);r(BE({critical:m,dimensions:f,clientSelection:o,movementMode:l,viewport:h}))},tP=e=>()=>t=>r=>{we(r,"INITIAL_PUBLISH")&&e.dragging(),we(r,"DROP_ANIMATE")&&e.dropping(r.payload.completed.result.reason),(we(r,"FLUSH")||we(r,"DROP_COMPLETE"))&&e.resting(),t(r)};const wh={outOfTheWay:"cubic-bezier(0.2, 0, 0, 1)",drop:"cubic-bezier(.2,1,.1,1)"},qi={opacity:{drop:0,combining:.7},scale:{drop:.75}},Zb={outOfTheWay:.2,minDropTime:.33,maxDropTime:.55},Hn=`${Zb.outOfTheWay}s ${wh.outOfTheWay}`,_i={fluid:`opacity ${Hn}`,snap:`transform ${Hn}, opacity ${Hn}`,drop:e=>{const t=`${e}s ${wh.drop}`;return`transform ${t}, opacity ${t}`},outOfTheWay:`transform ${Hn}`,placeholder:`height ${Hn}, width ${Hn}, margin ${Hn}`},r0=e=>Cn(e,et)?void 0:`translate(${e.x}px, ${e.y}px)`,Uf={moveTo:r0,drop:(e,t)=>{const r=r0(e);if(r)return t?`${r} scale(${qi.scale.drop})`:r}},{minDropTime:Wf,maxDropTime:ew}=Zb,rP=ew-Wf,n0=1500,nP=.6;var sP=({current:e,destination:t,reason:r})=>{const n=zi(e,t);if(n<=0)return Wf;if(n>=n0)return ew;const s=n/n0,a=Wf+rP*s,o=r==="CANCEL"?a*nP:a;return Number(o.toFixed(2))},aP=({impact:e,draggable:t,dimensions:r,viewport:n,afterCritical:s})=>{const{draggables:a,droppables:o}=r,l=It(e),c=l?o[l]:null,d=o[t.descriptor.droppableId],u=qb({impact:e,draggable:t,draggables:a,afterCritical:s,droppable:c||d,viewport:n});return Rt(u,t.client.borderBox.center)},iP=({draggables:e,reason:t,lastImpact:r,home:n,viewport:s,onLiftImpact:a})=>!r.at||t!=="DROP"?{impact:Yb({draggables:e,impact:a,destination:n,viewport:s,forceShouldAnimate:!0}),didDropInsideDroppable:!1}:r.at.type==="REORDER"?{impact:r,didDropInsideDroppable:!0}:{impact:{...r,displaced:Vi},didDropInsideDroppable:!0};const oP=({getState:e,dispatch:t})=>r=>n=>{if(!we(n,"DROP")){r(n);return}const s=e(),a=n.payload.reason;if(s.phase==="COLLECTING"){t(ZE({reason:a}));return}if(s.phase==="IDLE")return;s.phase==="DROP_PENDING"&&s.isWaiting&&Y(),s.phase==="DRAGGING"||s.phase==="DROP_PENDING"||Y();const l=s.critical,c=s.dimensions,d=c.draggables[s.critical.draggable.id],{impact:u,didDropInsideDroppable:m}=iP({reason:a,lastImpact:s.impact,afterCritical:s.afterCritical,onLiftImpact:s.onLiftImpact,home:s.dimensions.droppables[s.critical.droppable.id],viewport:s.viewport,draggables:s.dimensions.draggables}),f=m?mh(u):null,h=m?Gc(u):null,y={index:l.draggable.index,droppableId:l.droppable.id},w={draggableId:d.descriptor.id,type:d.descriptor.type,source:y,reason:a,mode:s.movementMode,destination:f,combine:h},b=aP({impact:u,draggable:d,dimensions:c,viewport:s.viewport,afterCritical:s.afterCritical}),g={critical:s.critical,afterCritical:s.afterCritical,result:w,impact:u};if(!(!Cn(s.current.client.offset,b)||!!w.combine)){t(bh({completed:g}));return}const v=sP({current:s.current.client.offset,destination:b,reason:a});t(XE({newHomeClientOffset:b,dropDuration:v,completed:g}))};var tw=()=>({x:window.pageXOffset,y:window.pageYOffset});function lP(e){return{eventName:"scroll",options:{passive:!0,capture:!1},fn:t=>{t.target!==window&&t.target!==window.document||e()}}}function cP({onWindowScroll:e}){function t(){e(tw())}const r=Hi(t),n=lP(r);let s=Sn;function a(){return s!==Sn}function o(){a()&&Y(),s=qt(window,[n])}function l(){a()||Y(),r.cancel(),s(),s=Sn}return{start:o,stop:l,isActive:a}}const dP=e=>we(e,"DROP_COMPLETE")||we(e,"DROP_ANIMATE")||we(e,"FLUSH"),uP=e=>{const t=cP({onWindowScroll:r=>{e.dispatch(YE({newScroll:r}))}});return r=>n=>{!t.isActive()&&we(n,"INITIAL_PUBLISH")&&t.start(),t.isActive()&&dP(n)&&t.stop(),r(n)}};var fP=e=>{let t=!1,r=!1;const n=setTimeout(()=>{r=!0}),s=a=>{t||r||(t=!0,e(a),clearTimeout(n))};return s.wasCalled=()=>t,s},mP=()=>{const e=[],t=s=>{const a=e.findIndex(l=>l.timerId===s);a===-1&&Y();const[o]=e.splice(a,1);o.callback()};return{add:s=>{const a=setTimeout(()=>t(a)),o={timerId:a,callback:s};e.push(o)},flush:()=>{if(!e.length)return;const s=[...e];e.length=0,s.forEach(a=>{clearTimeout(a.timerId),a.callback()})}}};const hP=(e,t)=>e==null&&t==null?!0:e==null||t==null?!1:e.droppableId===t.droppableId&&e.index===t.index,pP=(e,t)=>e==null&&t==null?!0:e==null||t==null?!1:e.draggableId===t.draggableId&&e.droppableId===t.droppableId,gP=(e,t)=>{if(e===t)return!0;const r=e.draggable.id===t.draggable.id&&e.draggable.droppableId===t.draggable.droppableId&&e.draggable.type===t.draggable.type&&e.draggable.index===t.draggable.index,n=e.droppable.id===t.droppable.id&&e.droppable.type===t.droppable.type;return r&&n},Va=(e,t)=>{t()},Ho=(e,t)=>({draggableId:e.draggable.id,type:e.droppable.type,source:{droppableId:e.droppable.id,index:e.draggable.index},mode:t});function lu(e,t,r,n){if(!e){r(n(t));return}const s=fP(r);e(t,{announce:s}),s.wasCalled()||r(n(t))}var xP=(e,t)=>{const r=mP();let n=null;const s=(m,f)=>{n&&Y(),Va("onBeforeCapture",()=>{const h=e().onBeforeCapture;h&&h({draggableId:m,mode:f})})},a=(m,f)=>{n&&Y(),Va("onBeforeDragStart",()=>{const h=e().onBeforeDragStart;h&&h(Ho(m,f))})},o=(m,f)=>{n&&Y();const h=Ho(m,f);n={mode:f,lastCritical:m,lastLocation:h.source,lastCombine:null},r.add(()=>{Va("onDragStart",()=>lu(e().onDragStart,h,t,yl.onDragStart))})},l=(m,f)=>{const h=mh(f),y=Gc(f);n||Y();const w=!gP(m,n.lastCritical);w&&(n.lastCritical=m);const b=!hP(n.lastLocation,h);b&&(n.lastLocation=h);const g=!pP(n.lastCombine,y);if(g&&(n.lastCombine=y),!w&&!b&&!g)return;const x={...Ho(m,n.mode),combine:y,destination:h};r.add(()=>{Va("onDragUpdate",()=>lu(e().onDragUpdate,x,t,yl.onDragUpdate))})},c=()=>{n||Y(),r.flush()},d=m=>{n||Y(),n=null,Va("onDragEnd",()=>lu(e().onDragEnd,m,t,yl.onDragEnd))};return{beforeCapture:s,beforeStart:a,start:o,update:l,flush:c,drop:d,abort:()=>{if(!n)return;const m={...Ho(n.lastCritical,n.mode),combine:null,destination:null,reason:"CANCEL"};d(m)}}},yP=(e,t)=>{const r=xP(e,t);return n=>s=>a=>{if(we(a,"BEFORE_INITIAL_CAPTURE")){r.beforeCapture(a.payload.draggableId,a.payload.movementMode);return}if(we(a,"INITIAL_PUBLISH")){const l=a.payload.critical;r.beforeStart(l,a.payload.movementMode),s(a),r.start(l,a.payload.movementMode);return}if(we(a,"DROP_COMPLETE")){const l=a.payload.completed.result;r.flush(),s(a),r.drop(l);return}if(s(a),we(a,"FLUSH")){r.abort();return}const o=n.getState();o.phase==="DRAGGING"&&r.update(o.critical,o.impact)}};const vP=e=>t=>r=>{if(!we(r,"DROP_ANIMATION_FINISHED")){t(r);return}const n=e.getState();n.phase!=="DROP_ANIMATING"&&Y(),e.dispatch(bh({completed:n.completed}))},bP=e=>{let t=null,r=null;function n(){r&&(cancelAnimationFrame(r),r=null),t&&(t(),t=null)}return s=>a=>{if((we(a,"FLUSH")||we(a,"DROP_COMPLETE")||we(a,"DROP_ANIMATION_FINISHED"))&&n(),s(a),!we(a,"DROP_ANIMATE"))return;const o={eventName:"scroll",options:{capture:!0,passive:!1,once:!0},fn:function(){e.getState().phase==="DROP_ANIMATING"&&e.dispatch(Xb())}};r=requestAnimationFrame(()=>{r=null,t=qt(window,[o])})}};var wP=e=>()=>t=>r=>{(we(r,"DROP_COMPLETE")||we(r,"FLUSH")||we(r,"DROP_ANIMATE"))&&e.stopPublishing(),t(r)},_P=e=>{let t=!1;return()=>r=>n=>{if(we(n,"INITIAL_PUBLISH")){t=!0,e.tryRecordFocus(n.payload.critical.draggable.id),r(n),e.tryRestoreFocusRecorded();return}if(r(n),!!t){if(we(n,"FLUSH")){t=!1,e.tryRestoreFocusRecorded();return}if(we(n,"DROP_COMPLETE")){t=!1;const s=n.payload.completed.result;s.combine&&e.tryShiftRecord(s.draggableId,s.combine.draggableId),e.tryRestoreFocusRecorded()}}}};const jP=e=>we(e,"DROP_COMPLETE")||we(e,"DROP_ANIMATE")||we(e,"FLUSH");var NP=e=>t=>r=>n=>{if(jP(n)){e.stop(),r(n);return}if(we(n,"INITIAL_PUBLISH")){r(n);const s=t.getState();s.phase!=="DRAGGING"&&Y(),e.start(s);return}r(n),e.scroll(t.getState())};const kP=e=>t=>r=>{if(t(r),!we(r,"PUBLISH_WHILE_DRAGGING"))return;const n=e.getState();n.phase==="DROP_PENDING"&&(n.isWaiting||e.dispatch(Jb({reason:n.reason})))},SP=xb;var CP=({dimensionMarshal:e,focusMarshal:t,styleMarshal:r,getResponders:n,announce:s,autoScroller:a})=>gb(AE,SP(vC(tP(r),wP(e),eP(e),oP,vP,bP,kP,NP(a),uP,_P(t),yP(n,s))));const cu=()=>({additions:{},removals:{},modified:{}});function DP({registry:e,callbacks:t}){let r=cu(),n=null;const s=()=>{n||(t.collectionStarting(),n=requestAnimationFrame(()=>{n=null;const{additions:c,removals:d,modified:u}=r,m=Object.keys(c).map(y=>e.draggable.getById(y).getDimension(et)).sort((y,w)=>y.descriptor.index-w.descriptor.index),f=Object.keys(u).map(y=>{const b=e.droppable.getById(y).callbacks.getScrollWhileDragging();return{droppableId:y,scroll:b}}),h={additions:m,removals:Object.keys(d),modified:f};r=cu(),t.publish(h)}))};return{add:c=>{const d=c.descriptor.id;r.additions[d]=c,r.modified[c.descriptor.droppableId]=!0,r.removals[d]&&delete r.removals[d],s()},remove:c=>{const d=c.descriptor;r.removals[d.id]=!0,r.modified[d.droppableId]=!0,r.additions[d.id]&&delete r.additions[d.id],s()},stop:()=>{n&&(cancelAnimationFrame(n),n=null,r=cu())}}}var rw=({scrollHeight:e,scrollWidth:t,height:r,width:n})=>{const s=Rt({x:t,y:e},{x:n,y:r});return{x:Math.max(0,s.x),y:Math.max(0,s.y)}},nw=()=>{const e=document.documentElement;return e||Y(),e},sw=()=>{const e=nw();return rw({scrollHeight:e.scrollHeight,scrollWidth:e.scrollWidth,width:e.clientWidth,height:e.clientHeight})},EP=()=>{const e=tw(),t=sw(),r=e.y,n=e.x,s=nw(),a=s.clientWidth,o=s.clientHeight,l=n+a,c=r+o;return{frame:ir({top:r,left:n,right:l,bottom:c}),scroll:{initial:e,current:e,max:t,diff:{value:et,displacement:et}}}},PP=({critical:e,scrollOptions:t,registry:r})=>{const n=EP(),s=n.scroll.current,a=e.droppable,o=r.droppable.getAllByType(a.type).map(u=>u.callbacks.getDimensionAndWatchScroll(s,t)),l=r.draggable.getAllByType(e.draggable.type).map(u=>u.getDimension(s));return{dimensions:{draggables:Rb(l),droppables:Tb(o)},critical:e,viewport:n}};function s0(e,t,r){return!(r.descriptor.id===t.id||r.descriptor.type!==t.type||e.droppable.getById(r.descriptor.droppableId).descriptor.mode!=="virtual")}var TP=(e,t)=>{let r=null;const n=DP({callbacks:{publish:t.publishWhileDragging,collectionStarting:t.collectionStarting},registry:e}),s=(f,h)=>{e.droppable.exists(f)||Y(),r&&t.updateDroppableIsEnabled({id:f,isEnabled:h})},a=(f,h)=>{r&&(e.droppable.exists(f)||Y(),t.updateDroppableIsCombineEnabled({id:f,isCombineEnabled:h}))},o=(f,h)=>{r&&(e.droppable.exists(f)||Y(),t.updateDroppableScroll({id:f,newScroll:h}))},l=(f,h)=>{r&&e.droppable.getById(f).callbacks.scroll(h)},c=()=>{if(!r)return;n.stop();const f=r.critical.droppable;e.droppable.getAllByType(f.type).forEach(h=>h.callbacks.dragStopped()),r.unsubscribe(),r=null},d=f=>{r||Y();const h=r.critical.draggable;f.type==="ADDITION"&&s0(e,h,f.value)&&n.add(f.value),f.type==="REMOVAL"&&s0(e,h,f.value)&&n.remove(f.value)};return{updateDroppableIsEnabled:s,updateDroppableIsCombineEnabled:a,scrollDroppable:l,updateDroppableScroll:o,startPublishing:f=>{r&&Y();const h=e.draggable.getById(f.draggableId),y=e.droppable.getById(h.descriptor.droppableId),w={draggable:h.descriptor,droppable:y.descriptor},b=e.subscribe(d);return r={critical:w,unsubscribe:b},PP({critical:w,registry:e,scrollOptions:f.scrollOptions})},stopPublishing:c}},aw=(e,t)=>e.phase==="IDLE"?!0:e.phase!=="DROP_ANIMATING"||e.completed.result.draggableId===t?!1:e.completed.result.reason==="DROP",RP=e=>{window.scrollBy(e.x,e.y)};const LP=Ze(e=>qc(e).filter(t=>!(!t.isEnabled||!t.frame))),IP=(e,t)=>LP(t).find(n=>(n.frame||Y(),Wb(n.frame.pageMarginBox)(e)))||null;var MP=({center:e,destination:t,droppables:r})=>{if(t){const s=r[t];return s.frame?s:null}return IP(e,r)};const Gi={startFromPercentage:.25,maxScrollAtPercentage:.05,maxPixelScroll:28,ease:e=>e**2,durationDampening:{stopDampeningAt:1200,accelerateAt:360},disabled:!1};var OP=(e,t,r=()=>Gi)=>{const n=r(),s=e[t.size]*n.startFromPercentage,a=e[t.size]*n.maxScrollAtPercentage;return{startScrollingFrom:s,maxScrollValueAt:a}},iw=({startOfRange:e,endOfRange:t,current:r})=>{const n=t-e;return n===0?0:(r-e)/n},_h=1,AP=(e,t,r=()=>Gi)=>{const n=r();if(e>t.startScrollingFrom)return 0;if(e<=t.maxScrollValueAt)return n.maxPixelScroll;if(e===t.startScrollingFrom)return _h;const a=1-iw({startOfRange:t.maxScrollValueAt,endOfRange:t.startScrollingFrom,current:e}),o=n.maxPixelScroll*n.ease(a);return Math.ceil(o)},$P=(e,t,r)=>{const n=r(),s=n.durationDampening.accelerateAt,a=n.durationDampening.stopDampeningAt,o=t,l=a,d=Date.now()-o;if(d>=a)return e;if(d<s)return _h;const u=iw({startOfRange:s,endOfRange:l,current:d}),m=e*n.ease(u);return Math.ceil(m)},a0=({distanceToEdge:e,thresholds:t,dragStartTime:r,shouldUseTimeDampening:n,getAutoScrollerOptions:s})=>{const a=AP(e,t,s);return a===0?0:n?Math.max($P(a,r,s),_h):a},i0=({container:e,distanceToEdges:t,dragStartTime:r,axis:n,shouldUseTimeDampening:s,getAutoScrollerOptions:a})=>{const o=OP(e,n,a);return t[n.end]<t[n.start]?a0({distanceToEdge:t[n.end],thresholds:o,dragStartTime:r,shouldUseTimeDampening:s,getAutoScrollerOptions:a}):-1*a0({distanceToEdge:t[n.start],thresholds:o,dragStartTime:r,shouldUseTimeDampening:s,getAutoScrollerOptions:a})},FP=({container:e,subject:t,proposedScroll:r})=>{const n=t.height>e.height,s=t.width>e.width;return!s&&!n?r:s&&n?null:{x:s?0:r.x,y:n?0:r.y}};const BP=Pb(e=>e===0?0:e);var ow=({dragStartTime:e,container:t,subject:r,center:n,shouldUseTimeDampening:s,getAutoScrollerOptions:a})=>{const o={top:n.y-t.top,right:t.right-n.x,bottom:t.bottom-n.y,left:n.x-t.left},l=i0({container:t,distanceToEdges:o,dragStartTime:e,axis:hh,shouldUseTimeDampening:s,getAutoScrollerOptions:a}),c=i0({container:t,distanceToEdges:o,dragStartTime:e,axis:Mb,shouldUseTimeDampening:s,getAutoScrollerOptions:a}),d=BP({x:c,y:l});if(Cn(d,et))return null;const u=FP({container:t,subject:r,proposedScroll:d});return u?Cn(u,et)?null:u:null};const UP=Pb(e=>e===0?0:e>0?1:-1),jh=(()=>{const e=(t,r)=>t<0?t:t>r?t-r:0;return({current:t,max:r,change:n})=>{const s=rt(t,n),a={x:e(s.x,r.x),y:e(s.y,r.y)};return Cn(a,et)?null:a}})(),lw=({max:e,current:t,change:r})=>{const n={x:Math.max(t.x,e.x),y:Math.max(t.y,e.y)},s=UP(r),a=jh({max:n,current:t,change:s});return!a||s.x!==0&&a.x===0||s.y!==0&&a.y===0},Nh=(e,t)=>lw({current:e.scroll.current,max:e.scroll.max,change:t}),WP=(e,t)=>{if(!Nh(e,t))return null;const r=e.scroll.max,n=e.scroll.current;return jh({current:n,max:r,change:t})},kh=(e,t)=>{const r=e.frame;return r?lw({current:r.scroll.current,max:r.scroll.max,change:t}):!1},HP=(e,t)=>{const r=e.frame;return!r||!kh(e,t)?null:jh({current:r.scroll.current,max:r.scroll.max,change:t})};var zP=({viewport:e,subject:t,center:r,dragStartTime:n,shouldUseTimeDampening:s,getAutoScrollerOptions:a})=>{const o=ow({dragStartTime:n,container:e.frame,subject:t,center:r,shouldUseTimeDampening:s,getAutoScrollerOptions:a});return o&&Nh(e,o)?o:null},VP=({droppable:e,subject:t,center:r,dragStartTime:n,shouldUseTimeDampening:s,getAutoScrollerOptions:a})=>{const o=e.frame;if(!o)return null;const l=ow({dragStartTime:n,container:o.pageMarginBox,subject:t,center:r,shouldUseTimeDampening:s,getAutoScrollerOptions:a});return l&&kh(e,l)?l:null},o0=({state:e,dragStartTime:t,shouldUseTimeDampening:r,scrollWindow:n,scrollDroppable:s,getAutoScrollerOptions:a})=>{const o=e.current.page.borderBoxCenter,c=e.dimensions.draggables[e.critical.draggable.id].page.marginBox;if(e.isWindowScrollAllowed){const m=e.viewport,f=zP({dragStartTime:t,viewport:m,subject:c,center:o,shouldUseTimeDampening:r,getAutoScrollerOptions:a});if(f){n(f);return}}const d=MP({center:o,destination:It(e.impact),droppables:e.dimensions.droppables});if(!d)return;const u=VP({dragStartTime:t,droppable:d,subject:c,center:o,shouldUseTimeDampening:r,getAutoScrollerOptions:a});u&&s(d.descriptor.id,u)},YP=({scrollWindow:e,scrollDroppable:t,getAutoScrollerOptions:r=()=>Gi})=>{const n=Hi(e),s=Hi(t);let a=null;const o=d=>{a||Y();const{shouldUseTimeDampening:u,dragStartTime:m}=a;o0({state:d,scrollWindow:n,scrollDroppable:s,dragStartTime:m,shouldUseTimeDampening:u,getAutoScrollerOptions:r})};return{start:d=>{a&&Y();const u=Date.now();let m=!1;const f=()=>{m=!0};o0({state:d,dragStartTime:0,shouldUseTimeDampening:!1,scrollWindow:f,scrollDroppable:f,getAutoScrollerOptions:r}),a={dragStartTime:u,shouldUseTimeDampening:m},m&&o(d)},stop:()=>{a&&(n.cancel(),s.cancel(),a=null)},scroll:o}},qP=({move:e,scrollDroppable:t,scrollWindow:r})=>{const n=(l,c)=>{const d=rt(l.current.client.selection,c);e({client:d})},s=(l,c)=>{if(!kh(l,c))return c;const d=HP(l,c);if(!d)return t(l.descriptor.id,c),null;const u=Rt(c,d);return t(l.descriptor.id,u),Rt(c,u)},a=(l,c,d)=>{if(!l||!Nh(c,d))return d;const u=WP(c,d);if(!u)return r(d),null;const m=Rt(d,u);return r(m),Rt(d,m)};return l=>{const c=l.scrollJumpRequest;if(!c)return;const d=It(l.impact);d||Y();const u=s(l.dimensions.droppables[d],c);if(!u)return;const m=l.viewport,f=a(l.isWindowScrollAllowed,m,u);f&&n(l,f)}},GP=({scrollDroppable:e,scrollWindow:t,move:r,getAutoScrollerOptions:n})=>{const s=YP({scrollWindow:t,scrollDroppable:e,getAutoScrollerOptions:n}),a=qP({move:r,scrollWindow:t,scrollDroppable:e});return{scroll:c=>{if(!(n().disabled||c.phase!=="DRAGGING")){if(c.movementMode==="FLUID"){s.scroll(c);return}c.scrollJumpRequest&&a(c)}},start:s.start,stop:s.stop}};const ca="data-rfd",da=(()=>{const e=`${ca}-drag-handle`;return{base:e,draggableId:`${e}-draggable-id`,contextId:`${e}-context-id`}})(),Hf=(()=>{const e=`${ca}-draggable`;return{base:e,contextId:`${e}-context-id`,id:`${e}-id`}})(),KP=(()=>{const e=`${ca}-droppable`;return{base:e,contextId:`${e}-context-id`,id:`${e}-id`}})(),l0={contextId:`${ca}-scroll-container-context-id`},QP=e=>t=>`[${t}="${e}"]`,Ya=(e,t)=>e.map(r=>{const n=r.styles[t];return n?`${r.selector} { ${n} }`:""}).join(" "),JP="pointer-events: none;";var XP=e=>{const t=QP(e),r=(()=>{const l=`
      cursor: -webkit-grab;
      cursor: grab;
    `;return{selector:t(da.contextId),styles:{always:`
          -webkit-touch-callout: none;
          -webkit-tap-highlight-color: rgba(0,0,0,0);
          touch-action: manipulation;
        `,resting:l,dragging:JP,dropAnimating:l}}})(),n=(()=>{const l=`
      transition: ${_i.outOfTheWay};
    `;return{selector:t(Hf.contextId),styles:{dragging:l,dropAnimating:l,userCancel:l}}})(),s={selector:t(KP.contextId),styles:{always:"overflow-anchor: none;"}},o=[n,r,s,{selector:"body",styles:{dragging:`
        cursor: grabbing;
        cursor: -webkit-grabbing;
        user-select: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        overflow-anchor: none;
      `}}];return{always:Ya(o,"always"),resting:Ya(o,"resting"),dragging:Ya(o,"dragging"),dropAnimating:Ya(o,"dropAnimating"),userCancel:Ya(o,"userCancel")}};const Mt=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?p.useLayoutEffect:p.useEffect,du=()=>{const e=document.querySelector("head");return e||Y(),e},c0=e=>{const t=document.createElement("style");return e&&t.setAttribute("nonce",e),t.type="text/css",t};function ZP(e,t){const r=ge(()=>XP(e),[e]),n=p.useRef(null),s=p.useRef(null),a=re(Ze(m=>{const f=s.current;f||Y(),f.textContent=m}),[]),o=re(m=>{const f=n.current;f||Y(),f.textContent=m},[]);Mt(()=>{!n.current&&!s.current||Y();const m=c0(t),f=c0(t);return n.current=m,s.current=f,m.setAttribute(`${ca}-always`,e),f.setAttribute(`${ca}-dynamic`,e),du().appendChild(m),du().appendChild(f),o(r.always),a(r.resting),()=>{const h=y=>{const w=y.current;w||Y(),du().removeChild(w),y.current=null};h(n),h(s)}},[t,o,a,r.always,r.resting,e]);const l=re(()=>a(r.dragging),[a,r.dragging]),c=re(m=>{if(m==="DROP"){a(r.dropAnimating);return}a(r.userCancel)},[a,r.dropAnimating,r.userCancel]),d=re(()=>{s.current&&a(r.resting)},[a,r.resting]);return ge(()=>({dragging:l,dropping:c,resting:d}),[l,c,d])}function cw(e,t){return Array.from(e.querySelectorAll(t))}var dw=e=>e&&e.ownerDocument&&e.ownerDocument.defaultView?e.ownerDocument.defaultView:window;function Jc(e){return e instanceof dw(e).HTMLElement}function e4(e,t){const r=`[${da.contextId}="${e}"]`,n=cw(document,r);if(!n.length)return null;const s=n.find(a=>a.getAttribute(da.draggableId)===t);return!s||!Jc(s)?null:s}function t4(e){const t=p.useRef({}),r=p.useRef(null),n=p.useRef(null),s=p.useRef(!1),a=re(function(f,h){const y={id:f,focus:h};return t.current[f]=y,function(){const b=t.current;b[f]!==y&&delete b[f]}},[]),o=re(function(f){const h=e4(e,f);h&&h!==document.activeElement&&h.focus()},[e]),l=re(function(f,h){r.current===f&&(r.current=h)},[]),c=re(function(){n.current||s.current&&(n.current=requestAnimationFrame(()=>{n.current=null;const f=r.current;f&&o(f)}))},[o]),d=re(function(f){r.current=null;const h=document.activeElement;h&&h.getAttribute(da.draggableId)===f&&(r.current=f)},[]);return Mt(()=>(s.current=!0,function(){s.current=!1;const f=n.current;f&&cancelAnimationFrame(f)}),[]),ge(()=>({register:a,tryRecordFocus:d,tryRestoreFocusRecorded:c,tryShiftRecord:l}),[a,d,c,l])}function r4(){const e={draggables:{},droppables:{}},t=[];function r(m){return t.push(m),function(){const h=t.indexOf(m);h!==-1&&t.splice(h,1)}}function n(m){t.length&&t.forEach(f=>f(m))}function s(m){return e.draggables[m]||null}function a(m){const f=s(m);return f||Y(),f}const o={register:m=>{e.draggables[m.descriptor.id]=m,n({type:"ADDITION",value:m})},update:(m,f)=>{const h=e.draggables[f.descriptor.id];h&&h.uniqueId===m.uniqueId&&(delete e.draggables[f.descriptor.id],e.draggables[m.descriptor.id]=m)},unregister:m=>{const f=m.descriptor.id,h=s(f);h&&m.uniqueId===h.uniqueId&&(delete e.draggables[f],e.droppables[m.descriptor.droppableId]&&n({type:"REMOVAL",value:m}))},getById:a,findById:s,exists:m=>!!s(m),getAllByType:m=>Object.values(e.draggables).filter(f=>f.descriptor.type===m)};function l(m){return e.droppables[m]||null}function c(m){const f=l(m);return f||Y(),f}const d={register:m=>{e.droppables[m.descriptor.id]=m},unregister:m=>{const f=l(m.descriptor.id);f&&m.uniqueId===f.uniqueId&&delete e.droppables[m.descriptor.id]},getById:c,findById:l,exists:m=>!!l(m),getAllByType:m=>Object.values(e.droppables).filter(f=>f.descriptor.type===m)};function u(){e.draggables={},e.droppables={},t.length=0}return{draggable:o,droppable:d,subscribe:r,clean:u}}function n4(){const e=ge(r4,[]);return p.useEffect(()=>function(){e.clean()},[e]),e}var Sh=O.createContext(null),oc=()=>{const e=document.body;return e||Y(),e};const s4={position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",overflow:"hidden",clip:"rect(0 0 0 0)","clip-path":"inset(100%)"},a4=e=>`rfd-announcement-${e}`;function i4(e){const t=ge(()=>a4(e),[e]),r=p.useRef(null);return p.useEffect(function(){const a=document.createElement("div");return r.current=a,a.id=t,a.setAttribute("aria-live","assertive"),a.setAttribute("aria-atomic","true"),nc(a.style,s4),oc().appendChild(a),function(){setTimeout(function(){const c=oc();c.contains(a)&&c.removeChild(a),a===r.current&&(r.current=null)})}},[t]),re(s=>{const a=r.current;if(a){a.textContent=s;return}},[])}const o4={separator:"::"};function Ch(e,t=o4){const r=O.useId();return ge(()=>`${e}${t.separator}${r}`,[t.separator,e,r])}function l4({contextId:e,uniqueId:t}){return`rfd-hidden-text-${e}-${t}`}function c4({contextId:e,text:t}){const r=Ch("hidden-text",{separator:"-"}),n=ge(()=>l4({contextId:e,uniqueId:r}),[r,e]);return p.useEffect(function(){const a=document.createElement("div");return a.id=n,a.textContent=t,a.style.display="none",oc().appendChild(a),function(){const l=oc();l.contains(a)&&l.removeChild(a)}},[n,t]),n}var Xc=O.createContext(null);function uw(e){const t=p.useRef(e);return p.useEffect(()=>{t.current=e}),t}function d4(){let e=null;function t(){return!!e}function r(o){return o===e}function n(o){e&&Y();const l={abandon:o};return e=l,l}function s(){e||Y(),e=null}function a(){e&&(e.abandon(),s())}return{isClaimed:t,isActive:r,claim:n,release:s,tryAbandon:a}}function Ki(e){return e.phase==="IDLE"||e.phase==="DROP_ANIMATING"?!1:e.isDragging}const u4=9,f4=13,Dh=27,fw=32,m4=33,h4=34,p4=35,g4=36,x4=37,y4=38,v4=39,b4=40,w4={[f4]:!0,[u4]:!0};var mw=e=>{w4[e.keyCode]&&e.preventDefault()};const Zc=(()=>{const e="visibilitychange";return typeof document>"u"?e:[e,`ms${e}`,`webkit${e}`,`moz${e}`,`o${e}`].find(n=>`on${n}`in document)||e})(),hw=0,d0=5;function _4(e,t){return Math.abs(t.x-e.x)>=d0||Math.abs(t.y-e.y)>=d0}const u0={type:"IDLE"};function j4({cancel:e,completed:t,getPhase:r,setPhase:n}){return[{eventName:"mousemove",fn:s=>{const{button:a,clientX:o,clientY:l}=s;if(a!==hw)return;const c={x:o,y:l},d=r();if(d.type==="DRAGGING"){s.preventDefault(),d.actions.move(c);return}d.type!=="PENDING"&&Y();const u=d.point;if(!_4(u,c))return;s.preventDefault();const m=d.actions.fluidLift(c);n({type:"DRAGGING",actions:m})}},{eventName:"mouseup",fn:s=>{const a=r();if(a.type!=="DRAGGING"){e();return}s.preventDefault(),a.actions.drop({shouldBlockNextClick:!0}),t()}},{eventName:"mousedown",fn:s=>{r().type==="DRAGGING"&&s.preventDefault(),e()}},{eventName:"keydown",fn:s=>{if(r().type==="PENDING"){e();return}if(s.keyCode===Dh){s.preventDefault(),e();return}mw(s)}},{eventName:"resize",fn:e},{eventName:"scroll",options:{passive:!0,capture:!1},fn:()=>{r().type==="PENDING"&&e()}},{eventName:"webkitmouseforcedown",fn:s=>{const a=r();if(a.type==="IDLE"&&Y(),a.actions.shouldRespectForcePress()){e();return}s.preventDefault()}},{eventName:Zc,fn:e}]}function N4(e){const t=p.useRef(u0),r=p.useRef(Sn),n=ge(()=>({eventName:"mousedown",fn:function(m){if(m.defaultPrevented||m.button!==hw||m.ctrlKey||m.metaKey||m.shiftKey||m.altKey)return;const f=e.findClosestDraggableId(m);if(!f)return;const h=e.tryGetLock(f,o,{sourceEvent:m});if(!h)return;m.preventDefault();const y={x:m.clientX,y:m.clientY};r.current(),d(h,y)}}),[e]),s=ge(()=>({eventName:"webkitmouseforcewillbegin",fn:u=>{if(u.defaultPrevented)return;const m=e.findClosestDraggableId(u);if(!m)return;const f=e.findOptionsForDraggable(m);f&&(f.shouldRespectForcePress||e.canGetLock(m)&&u.preventDefault())}}),[e]),a=re(function(){const m={passive:!1,capture:!0};r.current=qt(window,[s,n],m)},[s,n]),o=re(()=>{t.current.type!=="IDLE"&&(t.current=u0,r.current(),a())},[a]),l=re(()=>{const u=t.current;o(),u.type==="DRAGGING"&&u.actions.cancel({shouldBlockNextClick:!0}),u.type==="PENDING"&&u.actions.abort()},[o]),c=re(function(){const m={capture:!0,passive:!1},f=j4({cancel:l,completed:o,getPhase:()=>t.current,setPhase:h=>{t.current=h}});r.current=qt(window,f,m)},[l,o]),d=re(function(m,f){t.current.type!=="IDLE"&&Y(),t.current={type:"PENDING",point:f,actions:m},c()},[c]);Mt(function(){return a(),function(){r.current()}},[a])}function k4(){}const S4={[h4]:!0,[m4]:!0,[g4]:!0,[p4]:!0};function C4(e,t){function r(){t(),e.cancel()}function n(){t(),e.drop()}return[{eventName:"keydown",fn:s=>{if(s.keyCode===Dh){s.preventDefault(),r();return}if(s.keyCode===fw){s.preventDefault(),n();return}if(s.keyCode===b4){s.preventDefault(),e.moveDown();return}if(s.keyCode===y4){s.preventDefault(),e.moveUp();return}if(s.keyCode===v4){s.preventDefault(),e.moveRight();return}if(s.keyCode===x4){s.preventDefault(),e.moveLeft();return}if(S4[s.keyCode]){s.preventDefault();return}mw(s)}},{eventName:"mousedown",fn:r},{eventName:"mouseup",fn:r},{eventName:"click",fn:r},{eventName:"touchstart",fn:r},{eventName:"resize",fn:r},{eventName:"wheel",fn:r,options:{passive:!0}},{eventName:Zc,fn:r}]}function D4(e){const t=p.useRef(k4),r=ge(()=>({eventName:"keydown",fn:function(a){if(a.defaultPrevented||a.keyCode!==fw)return;const o=e.findClosestDraggableId(a);if(!o)return;const l=e.tryGetLock(o,u,{sourceEvent:a});if(!l)return;a.preventDefault();let c=!0;const d=l.snapLift();t.current();function u(){c||Y(),c=!1,t.current(),n()}t.current=qt(window,C4(d,u),{capture:!0,passive:!1})}}),[e]),n=re(function(){const a={passive:!1,capture:!0};t.current=qt(window,[r],a)},[r]);Mt(function(){return n(),function(){t.current()}},[n])}const uu={type:"IDLE"},E4=120,P4=.15;function T4({cancel:e,getPhase:t}){return[{eventName:"orientationchange",fn:e},{eventName:"resize",fn:e},{eventName:"contextmenu",fn:r=>{r.preventDefault()}},{eventName:"keydown",fn:r=>{if(t().type!=="DRAGGING"){e();return}r.keyCode===Dh&&r.preventDefault(),e()}},{eventName:Zc,fn:e}]}function R4({cancel:e,completed:t,getPhase:r}){return[{eventName:"touchmove",options:{capture:!1},fn:n=>{const s=r();if(s.type!=="DRAGGING"){e();return}s.hasMoved=!0;const{clientX:a,clientY:o}=n.touches[0],l={x:a,y:o};n.preventDefault(),s.actions.move(l)}},{eventName:"touchend",fn:n=>{const s=r();if(s.type!=="DRAGGING"){e();return}n.preventDefault(),s.actions.drop({shouldBlockNextClick:!0}),t()}},{eventName:"touchcancel",fn:n=>{if(r().type!=="DRAGGING"){e();return}n.preventDefault(),e()}},{eventName:"touchforcechange",fn:n=>{const s=r();s.type==="IDLE"&&Y();const a=n.touches[0];if(!a||!(a.force>=P4))return;const l=s.actions.shouldRespectForcePress();if(s.type==="PENDING"){l&&e();return}if(l){if(s.hasMoved){n.preventDefault();return}e();return}n.preventDefault()}},{eventName:Zc,fn:e}]}function L4(e){const t=p.useRef(uu),r=p.useRef(Sn),n=re(function(){return t.current},[]),s=re(function(h){t.current=h},[]),a=ge(()=>({eventName:"touchstart",fn:function(h){if(h.defaultPrevented)return;const y=e.findClosestDraggableId(h);if(!y)return;const w=e.tryGetLock(y,l,{sourceEvent:h});if(!w)return;const b=h.touches[0],{clientX:g,clientY:x}=b,v={x:g,y:x};r.current(),m(w,v)}}),[e]),o=re(function(){const h={capture:!0,passive:!1};r.current=qt(window,[a],h)},[a]),l=re(()=>{const f=t.current;f.type!=="IDLE"&&(f.type==="PENDING"&&clearTimeout(f.longPressTimerId),s(uu),r.current(),o())},[o,s]),c=re(()=>{const f=t.current;l(),f.type==="DRAGGING"&&f.actions.cancel({shouldBlockNextClick:!0}),f.type==="PENDING"&&f.actions.abort()},[l]),d=re(function(){const h={capture:!0,passive:!1},y={cancel:c,completed:l,getPhase:n},w=qt(window,R4(y),h),b=qt(window,T4(y),h);r.current=function(){w(),b()}},[c,n,l]),u=re(function(){const h=n();h.type!=="PENDING"&&Y();const y=h.actions.fluidLift(h.point);s({type:"DRAGGING",actions:y,hasMoved:!1})},[n,s]),m=re(function(h,y){n().type!=="IDLE"&&Y();const w=setTimeout(u,E4);s({type:"PENDING",point:y,actions:h,longPressTimerId:w}),d()},[d,n,s,u]);Mt(function(){return o(),function(){r.current();const y=n();y.type==="PENDING"&&(clearTimeout(y.longPressTimerId),s(uu))}},[n,o,s]),Mt(function(){return qt(window,[{eventName:"touchmove",fn:()=>{},options:{capture:!1,passive:!1}}])},[])}const I4=["input","button","textarea","select","option","optgroup","video","audio"];function pw(e,t){if(t==null)return!1;if(I4.includes(t.tagName.toLowerCase()))return!0;const n=t.getAttribute("contenteditable");return n==="true"||n===""?!0:t===e?!1:pw(e,t.parentElement)}function M4(e,t){const r=t.target;return Jc(r)?pw(e,r):!1}var O4=e=>ir(e.getBoundingClientRect()).center;function A4(e){return e instanceof dw(e).Element}const $4=(()=>{const e="matches";return typeof document>"u"?e:[e,"msMatchesSelector","webkitMatchesSelector"].find(n=>n in Element.prototype)||e})();function gw(e,t){return e==null?null:e[$4](t)?e:gw(e.parentElement,t)}function F4(e,t){return e.closest?e.closest(t):gw(e,t)}function B4(e){return`[${da.contextId}="${e}"]`}function U4(e,t){const r=t.target;if(!A4(r))return null;const n=B4(e),s=F4(r,n);return!s||!Jc(s)?null:s}function W4(e,t){const r=U4(e,t);return r?r.getAttribute(da.draggableId):null}function H4(e,t){const r=`[${Hf.contextId}="${e}"]`,s=cw(document,r).find(a=>a.getAttribute(Hf.id)===t);return!s||!Jc(s)?null:s}function z4(e){e.preventDefault()}function zo({expected:e,phase:t,isLockActive:r,shouldWarn:n}){return!(!r()||e!==t)}function xw({lockAPI:e,store:t,registry:r,draggableId:n}){if(e.isClaimed())return!1;const s=r.draggable.findById(n);return!(!s||!s.options.isEnabled||!aw(t.getState(),n))}function V4({lockAPI:e,contextId:t,store:r,registry:n,draggableId:s,forceSensorStop:a,sourceEvent:o}){if(!xw({lockAPI:e,store:r,registry:n,draggableId:s}))return null;const c=n.draggable.getById(s),d=H4(t,c.descriptor.id);if(!d||o&&!c.options.canDragInteractiveElements&&M4(d,o))return null;const u=e.claim(a||Sn);let m="PRE_DRAG";function f(){return c.options.shouldRespectForcePress}function h(){return e.isActive(u)}function y(_,C){zo({expected:_,phase:m,isLockActive:h,shouldWarn:!0})&&r.dispatch(C())}const w=y.bind(null,"DRAGGING");function b(_){function C(){e.release(),m="COMPLETED"}m!=="PRE_DRAG"&&(C(),Y()),r.dispatch(FE(_.liftActionArgs)),m="DRAGGING";function j(k,S={shouldBlockNextClick:!1}){if(_.cleanup(),S.shouldBlockNextClick){const D=qt(window,[{eventName:"click",fn:z4,options:{once:!0,passive:!1,capture:!0}}]);setTimeout(D)}C(),r.dispatch(Jb({reason:k}))}return{isActive:()=>zo({expected:"DRAGGING",phase:m,isLockActive:h,shouldWarn:!1}),shouldRespectForcePress:f,drop:k=>j("DROP",k),cancel:k=>j("CANCEL",k),..._.actions}}function g(_){const C=Hi(k=>{w(()=>Qb({client:k}))});return{...b({liftActionArgs:{id:s,clientSelection:_,movementMode:"FLUID"},cleanup:()=>C.cancel(),actions:{move:C}}),move:C}}function x(){const _={moveUp:()=>w(GE),moveRight:()=>w(QE),moveDown:()=>w(KE),moveLeft:()=>w(JE)};return b({liftActionArgs:{id:s,clientSelection:O4(d),movementMode:"SNAP"},cleanup:Sn,actions:_})}function v(){zo({expected:"PRE_DRAG",phase:m,isLockActive:h,shouldWarn:!0})&&e.release()}return{isActive:()=>zo({expected:"PRE_DRAG",phase:m,isLockActive:h,shouldWarn:!1}),shouldRespectForcePress:f,fluidLift:g,snapLift:x,abort:v}}const Y4=[N4,D4,L4];function q4({contextId:e,store:t,registry:r,customSensors:n,enableDefaultSensors:s}){const a=[...s?Y4:[],...n||[]],o=p.useState(()=>d4())[0],l=re(function(b,g){Ki(b)&&!Ki(g)&&o.tryAbandon()},[o]);Mt(function(){let b=t.getState();return t.subscribe(()=>{const x=t.getState();l(b,x),b=x})},[o,t,l]),Mt(()=>o.tryAbandon,[o.tryAbandon]);const c=re(w=>xw({lockAPI:o,registry:r,store:t,draggableId:w}),[o,r,t]),d=re((w,b,g)=>V4({lockAPI:o,registry:r,contextId:e,store:t,draggableId:w,forceSensorStop:b||null,sourceEvent:g&&g.sourceEvent?g.sourceEvent:null}),[e,o,r,t]),u=re(w=>W4(e,w),[e]),m=re(w=>{const b=r.draggable.findById(w);return b?b.options:null},[r.draggable]),f=re(function(){o.isClaimed()&&(o.tryAbandon(),t.getState().phase!=="IDLE"&&t.dispatch(vh()))},[o,t]),h=re(()=>o.isClaimed(),[o]),y=ge(()=>({canGetLock:c,tryGetLock:d,findClosestDraggableId:u,findOptionsForDraggable:m,tryReleaseLock:f,isLockClaimed:h}),[c,d,u,m,f,h]);for(let w=0;w<a.length;w++)a[w](y)}const G4=e=>({onBeforeCapture:t=>{const r=()=>{e.onBeforeCapture&&e.onBeforeCapture(t)};so.flushSync(r)},onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragEnd:e.onDragEnd,onDragUpdate:e.onDragUpdate}),K4=e=>({...Gi,...e.autoScrollerOptions,durationDampening:{...Gi.durationDampening,...e.autoScrollerOptions}});function qa(e){return e.current||Y(),e.current}function Q4(e){const{contextId:t,setCallbacks:r,sensors:n,nonce:s,dragHandleUsageInstructions:a}=e,o=p.useRef(null),l=uw(e),c=re(()=>G4(l.current),[l]),d=re(()=>K4(l.current),[l]),u=i4(t),m=c4({contextId:t,text:a}),f=ZP(t,s),h=re(D=>{qa(o).dispatch(D)},[]),y=ge(()=>Fg({publishWhileDragging:UE,updateDroppableScroll:HE,updateDroppableIsEnabled:zE,updateDroppableIsCombineEnabled:VE,collectionStarting:WE},h),[h]),w=n4(),b=ge(()=>TP(w,y),[w,y]),g=ge(()=>GP({scrollWindow:RP,scrollDroppable:b.scrollDroppable,getAutoScrollerOptions:d,...Fg({move:Qb},h)}),[b.scrollDroppable,h,d]),x=t4(t),v=ge(()=>CP({announce:u,autoScroller:g,dimensionMarshal:b,focusMarshal:x,getResponders:c,styleMarshal:f}),[u,g,b,x,c,f]);o.current=v;const N=re(()=>{const D=qa(o);D.getState().phase!=="IDLE"&&D.dispatch(vh())},[]),_=re(()=>{const D=qa(o).getState();return D.phase==="DROP_ANIMATING"?!0:D.phase==="IDLE"?!1:D.isDragging},[]),C=ge(()=>({isDragging:_,tryAbort:N}),[_,N]);r(C);const j=re(D=>aw(qa(o).getState(),D),[]),k=re(()=>Gn(qa(o).getState()),[]),S=ge(()=>({marshal:b,focus:x,contextId:t,canLift:j,isMovementAllowed:k,dragHandleUsageInstructionsId:m,registry:w}),[t,b,m,x,j,k,w]);return q4({contextId:t,store:v,registry:w,customSensors:n||null,enableDefaultSensors:e.enableDefaultSensors!==!1}),p.useEffect(()=>N,[N]),O.createElement(Xc.Provider,{value:S},O.createElement(bD,{context:Sh,store:v},e.children))}function J4(){return O.useId()}function X4(e){const t=J4(),r=e.dragHandleUsageInstructions||yl.dragHandleUsageInstructions;return O.createElement(DD,null,n=>O.createElement(Q4,{nonce:e.nonce,contextId:t,setCallbacks:n,dragHandleUsageInstructions:r,enableDefaultSensors:e.enableDefaultSensors,sensors:e.sensors,onBeforeCapture:e.onBeforeCapture,onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragUpdate:e.onDragUpdate,onDragEnd:e.onDragEnd,autoScrollerOptions:e.autoScrollerOptions},e.children))}const f0={dragging:5e3,dropAnimating:4500},Z4=(e,t)=>t?_i.drop(t.duration):e?_i.snap:_i.fluid,eT=(e,t)=>{if(e)return t?qi.opacity.drop:qi.opacity.combining},tT=e=>e.forceShouldAnimate!=null?e.forceShouldAnimate:e.mode==="SNAP";function rT(e){const r=e.dimension.client,{offset:n,combineWith:s,dropping:a}=e,o=!!s,l=tT(e),c=!!a,d=c?Uf.drop(n,o):Uf.moveTo(n);return{position:"fixed",top:r.marginBox.top,left:r.marginBox.left,boxSizing:"border-box",width:r.borderBox.width,height:r.borderBox.height,transition:Z4(l,a),transform:d,opacity:eT(o,c),zIndex:c?f0.dropAnimating:f0.dragging,pointerEvents:"none"}}function nT(e){return{transform:Uf.moveTo(e.offset),transition:e.shouldAnimateDisplacement?void 0:"none"}}function sT(e){return e.type==="DRAGGING"?rT(e):nT(e)}function aT(e,t,r=et){const n=window.getComputedStyle(t),s=t.getBoundingClientRect(),a=Nb(s,n),o=rc(a,r),l={client:a,tagName:t.tagName.toLowerCase(),display:n.display},c={x:a.marginBox.width,y:a.marginBox.height};return{descriptor:e,placeholder:l,displaceBy:c,client:a,page:o}}function iT(e){const t=Ch("draggable"),{descriptor:r,registry:n,getDraggableRef:s,canDragInteractiveElements:a,shouldRespectForcePress:o,isEnabled:l}=e,c=ge(()=>({canDragInteractiveElements:a,shouldRespectForcePress:o,isEnabled:l}),[a,l,o]),d=re(h=>{const y=s();return y||Y(),aT(r,y,h)},[r,s]),u=ge(()=>({uniqueId:t,descriptor:r,options:c,getDimension:d}),[r,d,c,t]),m=p.useRef(u),f=p.useRef(!0);Mt(()=>(n.draggable.register(m.current),()=>n.draggable.unregister(m.current)),[n.draggable]),Mt(()=>{if(f.current){f.current=!1;return}const h=m.current;m.current=u,n.draggable.update(u,h)},[u,n.draggable])}var Eh=O.createContext(null);function lc(e){const t=p.useContext(e);return t||Y(),t}function oT(e){e.preventDefault()}const lT=e=>{const t=p.useRef(null),r=re((C=null)=>{t.current=C},[]),n=re(()=>t.current,[]),{contextId:s,dragHandleUsageInstructionsId:a,registry:o}=lc(Xc),{type:l,droppableId:c}=lc(Eh),d=ge(()=>({id:e.draggableId,index:e.index,type:l,droppableId:c}),[e.draggableId,e.index,l,c]),{children:u,draggableId:m,isEnabled:f,shouldRespectForcePress:h,canDragInteractiveElements:y,isClone:w,mapped:b,dropAnimationFinished:g}=e;if(!w){const C=ge(()=>({descriptor:d,registry:o,getDraggableRef:n,canDragInteractiveElements:y,shouldRespectForcePress:h,isEnabled:f}),[d,o,n,y,h,f]);iT(C)}const x=ge(()=>f?{tabIndex:0,role:"button","aria-describedby":a,"data-rfd-drag-handle-draggable-id":m,"data-rfd-drag-handle-context-id":s,draggable:!1,onDragStart:oT}:null,[s,a,m,f]),v=re(C=>{b.type==="DRAGGING"&&b.dropping&&C.propertyName==="transform"&&so.flushSync(g)},[g,b]),N=ge(()=>{const C=sT(b),j=b.type==="DRAGGING"&&b.dropping?v:void 0;return{innerRef:r,draggableProps:{"data-rfd-draggable-context-id":s,"data-rfd-draggable-id":m,style:C,onTransitionEnd:j},dragHandleProps:x}},[s,x,m,b,v,r]),_=ge(()=>({draggableId:d.id,type:d.type,source:{index:d.index,droppableId:d.droppableId}}),[d.droppableId,d.id,d.index,d.type]);return O.createElement(O.Fragment,null,u(N,b.snapshot,_))};var yw=(e,t)=>e===t,vw=e=>{const{combine:t,destination:r}=e;return r?r.droppableId:t?t.droppableId:null};const cT=e=>e.combine?e.combine.draggableId:null,dT=e=>e.at&&e.at.type==="COMBINE"?e.at.combine.draggableId:null;function uT(){const e=Ze((s,a)=>({x:s,y:a})),t=Ze((s,a,o=null,l=null,c=null)=>({isDragging:!0,isClone:a,isDropAnimating:!!c,dropAnimation:c,mode:s,draggingOver:o,combineWith:l,combineTargetFor:null})),r=Ze((s,a,o,l,c=null,d=null,u=null)=>({mapped:{type:"DRAGGING",dropping:null,draggingOver:c,combineWith:d,mode:a,offset:s,dimension:o,forceShouldAnimate:u,snapshot:t(a,l,c,d,null)}}));return(s,a)=>{if(Ki(s)){if(s.critical.draggable.id!==a.draggableId)return null;const o=s.current.client.offset,l=s.dimensions.draggables[a.draggableId],c=It(s.impact),d=dT(s.impact),u=s.forceShouldAnimate;return r(e(o.x,o.y),s.movementMode,l,a.isClone,c,d,u)}if(s.phase==="DROP_ANIMATING"){const o=s.completed;if(o.result.draggableId!==a.draggableId)return null;const l=a.isClone,c=s.dimensions.draggables[a.draggableId],d=o.result,u=d.mode,m=vw(d),f=cT(d),y={duration:s.dropDuration,curve:wh.drop,moveTo:s.newHomeClientOffset,opacity:f?qi.opacity.drop:null,scale:f?qi.scale.drop:null};return{mapped:{type:"DRAGGING",offset:s.newHomeClientOffset,dimension:c,dropping:y,draggingOver:m,combineWith:f,mode:u,forceShouldAnimate:null,snapshot:t(u,l,m,f,y)}}}return null}}function bw(e=null){return{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,mode:null,draggingOver:null,combineTargetFor:e,combineWith:null}}const fT={mapped:{type:"SECONDARY",offset:et,combineTargetFor:null,shouldAnimateDisplacement:!0,snapshot:bw(null)}};function mT(){const e=Ze((o,l)=>({x:o,y:l})),t=Ze(bw),r=Ze((o,l=null,c)=>({mapped:{type:"SECONDARY",offset:o,combineTargetFor:l,shouldAnimateDisplacement:c,snapshot:t(l)}})),n=o=>o?r(et,o,!0):null,s=(o,l,c,d)=>{const u=c.displaced.visible[o],m=!!(d.inVirtualList&&d.effected[o]),f=Gc(c),h=f&&f.draggableId===o?l:null;if(!u){if(!m)return n(h);if(c.displaced.invisible[o])return null;const b=Ea(d.displacedBy.point),g=e(b.x,b.y);return r(g,h,!0)}if(m)return n(h);const y=c.displacedBy.point,w=e(y.x,y.y);return r(w,h,u.shouldAnimate)};return(o,l)=>{if(Ki(o))return o.critical.draggable.id===l.draggableId?null:s(l.draggableId,o.critical.draggable.id,o.impact,o.afterCritical);if(o.phase==="DROP_ANIMATING"){const c=o.completed;return c.result.draggableId===l.draggableId?null:s(l.draggableId,c.result.draggableId,c.impact,c.afterCritical)}return null}}const hT=()=>{const e=uT(),t=mT();return(n,s)=>e(n,s)||t(n,s)||fT},pT={dropAnimationFinished:Xb},gT=jb(hT,pT,null,{context:Sh,areStatePropsEqual:yw})(lT);function ww(e){return lc(Eh).isUsingCloneFor===e.draggableId&&!e.isClone?null:O.createElement(gT,e)}function xT(e){const t=typeof e.isDragDisabled=="boolean"?!e.isDragDisabled:!0,r=!!e.disableInteractiveElementBlocking,n=!!e.shouldRespectForcePress;return O.createElement(ww,nc({},e,{isClone:!1,isEnabled:t,canDragInteractiveElements:r,shouldRespectForcePress:n}))}const _w=e=>t=>e===t,yT=_w("scroll"),vT=_w("auto"),m0=(e,t)=>t(e.overflowX)||t(e.overflowY),bT=e=>{const t=window.getComputedStyle(e),r={overflowX:t.overflowX,overflowY:t.overflowY};return m0(r,yT)||m0(r,vT)},wT=()=>!1,jw=e=>e==null?null:e===document.body?wT()?e:null:e===document.documentElement?null:bT(e)?e:jw(e.parentElement);var zf=e=>({x:e.scrollLeft,y:e.scrollTop});const Nw=e=>e?window.getComputedStyle(e).position==="fixed"?!0:Nw(e.parentElement):!1;var _T=e=>{const t=jw(e),r=Nw(e);return{closestScrollable:t,isFixedOnPage:r}},jT=({descriptor:e,isEnabled:t,isCombineEnabled:r,isFixedOnPage:n,direction:s,client:a,page:o,closest:l})=>{const c=(()=>{if(!l)return null;const{scrollSize:f,client:h}=l,y=rw({scrollHeight:f.scrollHeight,scrollWidth:f.scrollWidth,height:h.paddingBox.height,width:h.paddingBox.width});return{pageMarginBox:l.page.marginBox,frameClient:h,scrollSize:f,shouldClipSubject:l.shouldClipSubject,scroll:{initial:l.scroll,current:l.scroll,max:y,diff:{value:et,displacement:et}}}})(),d=s==="vertical"?hh:Mb,u=la({page:o,withPlaceholder:null,axis:d,frame:c});return{descriptor:e,isCombineEnabled:r,isFixedOnPage:n,axis:d,isEnabled:t,client:a,page:o,frame:c,subject:u}};const NT=(e,t)=>{const r=kb(e);if(!t||e!==t)return r;const n=r.paddingBox.top-t.scrollTop,s=r.paddingBox.left-t.scrollLeft,a=n+t.scrollHeight,o=s+t.scrollWidth,c=dh({top:n,right:o,bottom:a,left:s},r.border);return uh({borderBox:c,margin:r.margin,border:r.border,padding:r.padding})};var kT=({ref:e,descriptor:t,env:r,windowScroll:n,direction:s,isDropDisabled:a,isCombineEnabled:o,shouldClipSubject:l})=>{const c=r.closestScrollable,d=NT(e,c),u=rc(d,n),m=(()=>{if(!c)return null;const h=kb(c),y={scrollHeight:c.scrollHeight,scrollWidth:c.scrollWidth};return{client:h,page:rc(h,n),scroll:zf(c),scrollSize:y,shouldClipSubject:l}})();return jT({descriptor:t,isEnabled:!a,isCombineEnabled:o,isFixedOnPage:r.isFixedOnPage,direction:s,client:d,page:u,closest:m})};const ST={passive:!1},CT={passive:!0};var h0=e=>e.shouldPublishImmediately?ST:CT;const Vo=e=>e&&e.env.closestScrollable||null;function DT(e){const t=p.useRef(null),r=lc(Xc),n=Ch("droppable"),{registry:s,marshal:a}=r,o=uw(e),l=ge(()=>({id:e.droppableId,type:e.type,mode:e.mode}),[e.droppableId,e.mode,e.type]),c=p.useRef(l),d=ge(()=>Ze((N,_)=>{t.current||Y();const C={x:N,y:_};a.updateDroppableScroll(l.id,C)}),[l.id,a]),u=re(()=>{const N=t.current;return!N||!N.env.closestScrollable?et:zf(N.env.closestScrollable)},[]),m=re(()=>{const N=u();d(N.x,N.y)},[u,d]),f=ge(()=>Hi(m),[m]),h=re(()=>{const N=t.current,_=Vo(N);if(N&&_||Y(),N.scrollOptions.shouldPublishImmediately){m();return}f()},[f,m]),y=re((N,_)=>{t.current&&Y();const C=o.current,j=C.getDroppableRef();j||Y();const k=_T(j),S={ref:j,descriptor:l,env:k,scrollOptions:_};t.current=S;const D=kT({ref:j,descriptor:l,env:k,windowScroll:N,direction:C.direction,isDropDisabled:C.isDropDisabled,isCombineEnabled:C.isCombineEnabled,shouldClipSubject:!C.ignoreContainerClipping}),R=k.closestScrollable;return R&&(R.setAttribute(l0.contextId,r.contextId),R.addEventListener("scroll",h,h0(S.scrollOptions))),D},[r.contextId,l,h,o]),w=re(()=>{const N=t.current,_=Vo(N);return N&&_||Y(),zf(_)},[]),b=re(()=>{const N=t.current;N||Y();const _=Vo(N);t.current=null,_&&(f.cancel(),_.removeAttribute(l0.contextId),_.removeEventListener("scroll",h,h0(N.scrollOptions)))},[h,f]),g=re(N=>{const _=t.current;_||Y();const C=Vo(_);C||Y(),C.scrollTop+=N.y,C.scrollLeft+=N.x},[]),x=ge(()=>({getDimensionAndWatchScroll:y,getScrollWhileDragging:w,dragStopped:b,scroll:g}),[b,y,w,g]),v=ge(()=>({uniqueId:n,descriptor:l,callbacks:x}),[x,l,n]);Mt(()=>(c.current=v.descriptor,s.droppable.register(v),()=>{t.current&&b(),s.droppable.unregister(v)}),[x,l,b,v,a,s.droppable]),Mt(()=>{t.current&&a.updateDroppableIsEnabled(c.current.id,!e.isDropDisabled)},[e.isDropDisabled,a]),Mt(()=>{t.current&&a.updateDroppableIsCombineEnabled(c.current.id,e.isCombineEnabled)},[e.isCombineEnabled,a])}function fu(){}const p0={width:0,height:0,margin:MD},ET=({isAnimatingOpenOnMount:e,placeholder:t,animate:r})=>e||r==="close"?p0:{height:t.client.borderBox.height,width:t.client.borderBox.width,margin:t.client.margin},PT=({isAnimatingOpenOnMount:e,placeholder:t,animate:r})=>{const n=ET({isAnimatingOpenOnMount:e,placeholder:t,animate:r});return{display:t.display,boxSizing:"border-box",width:n.width,height:n.height,marginTop:n.margin.top,marginRight:n.margin.right,marginBottom:n.margin.bottom,marginLeft:n.margin.left,flexShrink:"0",flexGrow:"0",pointerEvents:"none",transition:r!=="none"?_i.placeholder:null}},TT=e=>{const t=p.useRef(null),r=re(()=>{t.current&&(clearTimeout(t.current),t.current=null)},[]),{animate:n,onTransitionEnd:s,onClose:a,contextId:o}=e,[l,c]=p.useState(e.animate==="open");p.useEffect(()=>l?n!=="open"?(r(),c(!1),fu):t.current?fu:(t.current=setTimeout(()=>{t.current=null,c(!1)}),r):fu,[n,l,r]);const d=re(m=>{m.propertyName==="height"&&(s(),n==="close"&&a())},[n,a,s]),u=PT({isAnimatingOpenOnMount:l,animate:e.animate,placeholder:e.placeholder});return O.createElement(e.placeholder.tagName,{style:u,"data-rfd-placeholder-context-id":o,onTransitionEnd:d,ref:e.innerRef})};var RT=O.memo(TT);class LT extends O.PureComponent{constructor(...t){super(...t),this.state={isVisible:!!this.props.on,data:this.props.on,animate:this.props.shouldAnimate&&this.props.on?"open":"none"},this.onClose=()=>{this.state.animate==="close"&&this.setState({isVisible:!1})}}static getDerivedStateFromProps(t,r){return t.shouldAnimate?t.on?{isVisible:!0,data:t.on,animate:"open"}:r.isVisible?{isVisible:!0,data:r.data,animate:"close"}:{isVisible:!1,animate:"close",data:null}:{isVisible:!!t.on,data:t.on,animate:"none"}}render(){if(!this.state.isVisible)return null;const t={onClose:this.onClose,data:this.state.data,animate:this.state.animate};return this.props.children(t)}}const IT=e=>{const t=p.useContext(Xc);t||Y();const{contextId:r,isMovementAllowed:n}=t,s=p.useRef(null),a=p.useRef(null),{children:o,droppableId:l,type:c,mode:d,direction:u,ignoreContainerClipping:m,isDropDisabled:f,isCombineEnabled:h,snapshot:y,useClone:w,updateViewportMaxScroll:b,getContainerForClone:g}=e,x=re(()=>s.current,[]),v=re((R=null)=>{s.current=R},[]);re(()=>a.current,[]);const N=re((R=null)=>{a.current=R},[]),_=re(()=>{n()&&b({maxScroll:sw()})},[n,b]);DT({droppableId:l,type:c,mode:d,direction:u,isDropDisabled:f,isCombineEnabled:h,ignoreContainerClipping:m,getDroppableRef:x});const C=ge(()=>O.createElement(LT,{on:e.placeholder,shouldAnimate:e.shouldAnimatePlaceholder},({onClose:R,data:P,animate:A})=>O.createElement(RT,{placeholder:P,onClose:R,innerRef:N,animate:A,contextId:r,onTransitionEnd:_})),[r,_,e.placeholder,e.shouldAnimatePlaceholder,N]),j=ge(()=>({innerRef:v,placeholder:C,droppableProps:{"data-rfd-droppable-id":l,"data-rfd-droppable-context-id":r}}),[r,l,C,v]),k=w?w.dragging.draggableId:null,S=ge(()=>({droppableId:l,type:c,isUsingCloneFor:k}),[l,k,c]);function D(){if(!w)return null;const{dragging:R,render:P}=w,A=O.createElement(ww,{draggableId:R.draggableId,index:R.source.index,isClone:!0,isEnabled:!0,shouldRespectForcePress:!1,canDragInteractiveElements:!0},(I,L)=>P(I,L,R));return Tv.createPortal(A,g())}return O.createElement(Eh.Provider,{value:S},o(j,y),D())};function MT(){return document.body||Y(),document.body}const g0={mode:"standard",type:"DEFAULT",direction:"vertical",isDropDisabled:!1,isCombineEnabled:!1,ignoreContainerClipping:!1,renderClone:null,getContainerForClone:MT},kw=e=>{let t={...e},r;for(r in g0)e[r]===void 0&&(t={...t,[r]:g0[r]});return t},mu=(e,t)=>e===t.droppable.type,x0=(e,t)=>t.draggables[e.draggable.id],OT=()=>{const e={placeholder:null,shouldAnimatePlaceholder:!0,snapshot:{isDraggingOver:!1,draggingOverWith:null,draggingFromThisWith:null,isUsingPlaceholder:!1},useClone:null},t={...e,shouldAnimatePlaceholder:!1},r=Ze(a=>({draggableId:a.id,type:a.type,source:{index:a.index,droppableId:a.droppableId}})),n=Ze((a,o,l,c,d,u)=>{const m=d.descriptor.id;if(d.descriptor.droppableId===a){const y=u?{render:u,dragging:r(d.descriptor)}:null,w={isDraggingOver:l,draggingOverWith:l?m:null,draggingFromThisWith:m,isUsingPlaceholder:!0};return{placeholder:d.placeholder,shouldAnimatePlaceholder:!1,snapshot:w,useClone:y}}if(!o)return t;if(!c)return e;const h={isDraggingOver:l,draggingOverWith:m,draggingFromThisWith:null,isUsingPlaceholder:!0};return{placeholder:d.placeholder,shouldAnimatePlaceholder:!0,snapshot:h,useClone:null}});return(a,o)=>{const l=kw(o),c=l.droppableId,d=l.type,u=!l.isDropDisabled,m=l.renderClone;if(Ki(a)){const f=a.critical;if(!mu(d,f))return t;const h=x0(f,a.dimensions),y=It(a.impact)===c;return n(c,u,y,y,h,m)}if(a.phase==="DROP_ANIMATING"){const f=a.completed;if(!mu(d,f.critical))return t;const h=x0(f.critical,a.dimensions);return n(c,u,vw(f.result)===c,It(f.impact)===c,h,m)}if(a.phase==="IDLE"&&a.completed&&!a.shouldFlush){const f=a.completed;if(!mu(d,f.critical))return t;const h=It(f.impact)===c,y=!!(f.impact.at&&f.impact.at.type==="COMBINE"),w=f.critical.droppable.id===c;return h?y?e:t:w?e:t}return t}},AT={updateViewportMaxScroll:qE},$T=jb(OT,AT,(e,t,r)=>({...kw(r),...e,...t}),{context:Sh,areStatePropsEqual:yw})(IT);function FT(){const[e,t]=p.useState([]),[r,n]=p.useState([]),[s,a]=p.useState(!0);return p.useEffect(()=>{(async()=>{try{console.log(" Fetching kanban data (safe version)...");const{data:l,error:c}=await M.from("deal_stage").select("id, label, description, sort_order, active").eq("active",!0).order("sort_order",{ascending:!0});if(console.log(" Stages:",l),c)throw console.error(" Stage error:",c),c;const{data:d,error:u}=await M.from("deal").select("id, deal_name, fee, deal_value, closed_date, stage_id, kanban_position, client_id, created_at").order("kanban_position",{ascending:!0});if(console.log(" Deals:",(d==null?void 0:d.length)||0,"deals fetched"),u)throw console.error(" Deal error:",u),u;const{data:m,error:f}=await M.from("client").select("id, client_name");console.log(" Clients:",(m==null?void 0:m.length)||0,"clients fetched"),f&&console.warn(" Client error (non-fatal):",f);const h=new Map;m==null||m.forEach(v=>{h.set(v.id,v.client_name)});const y=d.map(v=>({id:v.id,deal_name:v.deal_name,fee:v.fee,deal_value:v.deal_value,closed_date:v.closed_date,stage_id:v.stage_id,kanban_position:v.kanban_position,client_name:v.client_id&&h.get(v.client_id)||null,created_at:v.created_at})),w=new Map;l.forEach(v=>{w.set(v.id,v.label)});const b=new Set(l.map(v=>v.id)),g=new Date;g.setFullYear(g.getFullYear()-2);const x=y.filter(v=>!v.stage_id||!b.has(v.stage_id)?!1:w.get(v.stage_id)==="Lost"?v.created_at?new Date(v.created_at)>=g:!1:!0);console.log(" Final cards:",x.length),console.log(" Final columns:",l.length),t(l||[]),n(x)}catch(l){console.error(" Error:",l)}finally{a(!1)}})()},[]),{columns:e,cards:r,loading:s}}function BT(){const{columns:e,cards:t,loading:r}=FT(),[n,s]=p.useState([]);p.useEffect(()=>{s(t)},[t]),p.useEffect(()=>{document.title="Master Pipeline"},[]);const a=async c=>{const{destination:d,draggableId:u}=c;if(!d)return;const m=d.droppableId,f=[...n],h=f.find(b=>b.id===u);if(!h)return;h.stage_id=m;const y=f.filter(b=>b.stage_id===m&&b.id!==u).sort((b,g)=>(b.kanban_position??0)-(g.kanban_position??0));y.splice(d.index,0,h),y.forEach((b,g)=>{b.kanban_position=g}),s(f);const w=y.map(b=>M.from("deal").update({stage_id:b.stage_id,kanban_position:b.kanban_position}).eq("id",b.id));await Promise.all(w)},o=(c,d=0)=>typeof c=="number"?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:d,maximumFractionDigits:d}).format(c):"--",l=new Date().getFullYear();return r?i.jsx("div",{className:"p-4",children:"Loading..."}):i.jsxs("div",{className:"p-4 overflow-x-auto bg-gray-100 min-h-screen",children:[i.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Master Pipeline"}),i.jsx("div",{className:"flex min-w-max gap-[2px]",children:i.jsx(X4,{onDragEnd:a,children:e.map((c,d)=>{let u=n.filter(y=>y.stage_id===c.id).sort((y,w)=>(y.kanban_position??0)-(w.kanban_position??0));c.label==="Closed Paid"&&(u=u.filter(y=>y.closed_date?new Date(y.closed_date).getFullYear()===l:!1));const m=u.reduce((y,w)=>y+(w.fee??0),0),f=d===e.length-1,h=d===0;return i.jsx($T,{droppableId:c.id,children:(y,w)=>i.jsxs("div",{ref:y.innerRef,...y.droppableProps,className:`relative min-w-[240px] max-w-[280px] bg-white shadow-sm flex flex-col ${w.isDraggingOver?"bg-blue-50":""}`,children:[i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:`chevron-header ${h?"first":""} ${f?"last":""} flex items-center justify-center`,children:i.jsxs("div",{className:"text-center font-semibold text-sm",children:[c.label," (",u.length,")"]})}),i.jsx("div",{className:"bg-white text-center py-2 border-b",children:i.jsx("div",{className:"text-green-600 text-lg font-bold",children:o(m)})})]}),i.jsxs("div",{className:"p-2 flex-1",children:[u.map((b,g)=>i.jsx(xT,{draggableId:b.id,index:g,children:(x,v)=>i.jsxs("div",{ref:x.innerRef,...x.draggableProps,...x.dragHandleProps,className:`bg-white p-2 rounded shadow mb-2 border text-sm ${v.isDragging?"bg-yellow-100":""}`,children:[i.jsx("div",{className:"font-semibold",children:i.jsx(Uc,{to:`/deal/${b.id}`,className:"text-blue-600 hover:underline",children:b.deal_name||"Untitled Deal"})}),i.jsx("div",{className:"text-gray-700",children:o(b.fee)}),i.jsx("div",{className:"text-gray-500 text-xs",children:b.client_name||"No Client"}),i.jsx("div",{className:"text-gray-800",children:o(b.deal_value)})]})},b.id)),y.placeholder]})]})},c.id)})})})]})}function ji(e,t=0){return e==null||isNaN(e)?"":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:t,maximumFractionDigits:t}).format(e)}function Vf(e,t=2){return typeof e!="number"||isNaN(e)?"":`${e.toFixed(t)}%`}function UT(e){return typeof e!="number"?"":Math.round(e)+"%"}function ts({label:e,value:t,onChange:r,format:n,editingField:s,setEditingField:a,fieldKey:o,tabIndex:l}){const c=s===o,d=p.useRef(null);p.useEffect(()=>{c&&d.current&&d.current.focus()},[c]);const u=()=>{a(null)},m=h=>{(h.key==="Enter"||h.key===" ")&&(h.preventDefault(),a(o))},f=()=>{a(o)};return i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:e}),c?i.jsx("input",{ref:d,type:"number",value:t??"",onChange:h=>r(h.target.value),onBlur:u,className:"mt-1 block w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",tabIndex:l}):i.jsx("div",{onClick:()=>a(o),onKeyDown:m,onFocus:f,className:"mt-1 p-2 bg-gray-100 rounded text-sm cursor-pointer",tabIndex:l,children:t==null||t===""?"":n(t)})]})}function Sw(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=Sw(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function nt(){for(var e,t,r=0,n="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=Sw(e))&&(n&&(n+=" "),n+=t);return n}const Cw=6048e5,WT=864e5,ed=6e4,td=36e5,HT=1e3,Yo=43200,y0=1440,v0=Symbol.for("constructDateFrom");function _e(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&v0 in e?e[v0](t):e instanceof Date?new e.constructor(t):new Date(t)}function Z(e,t){return _e(t||e,e)}function cr(e,t,r){const n=Z(e,r==null?void 0:r.in);return isNaN(t)?_e((r==null?void 0:r.in)||e,NaN):(t&&n.setDate(n.getDate()+t),n)}function fr(e,t,r){const n=Z(e,r==null?void 0:r.in);if(isNaN(t))return _e((r==null?void 0:r.in)||e,NaN);if(!t)return n;const s=n.getDate(),a=_e((r==null?void 0:r.in)||e,n.getTime());a.setMonth(n.getMonth()+t+1,0);const o=a.getDate();return s>=o?a:(n.setFullYear(a.getFullYear(),a.getMonth(),s),n)}function Dw(e,t,r){return _e((r==null?void 0:r.in)||e,+Z(e)+t)}function zT(e,t,r){return Dw(e,t*td,r)}let VT={};function Fn(){return VT}function rn(e,t){var l,c,d,u;const r=Fn(),n=(t==null?void 0:t.weekStartsOn)??((c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((u=(d=r.locale)==null?void 0:d.options)==null?void 0:u.weekStartsOn)??0,s=Z(e,t==null?void 0:t.in),a=s.getDay(),o=(a<n?7:0)+a-n;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function ua(e,t){return rn(e,{...t,weekStartsOn:1})}function Ew(e,t){const r=Z(e,t==null?void 0:t.in),n=r.getFullYear(),s=_e(r,0);s.setFullYear(n+1,0,4),s.setHours(0,0,0,0);const a=ua(s),o=_e(r,0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);const l=ua(o);return r.getTime()>=a.getTime()?n+1:r.getTime()>=l.getTime()?n:n-1}function fa(e){const t=Z(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function xr(e,...t){const r=_e.bind(null,e||t.find(n=>typeof n=="object"));return t.map(r)}function gs(e,t){const r=Z(e,t==null?void 0:t.in);return r.setHours(0,0,0,0),r}function ma(e,t,r){const[n,s]=xr(r==null?void 0:r.in,e,t),a=gs(n),o=gs(s),l=+a-fa(a),c=+o-fa(o);return Math.round((l-c)/WT)}function YT(e,t){const r=Ew(e,t),n=_e((t==null?void 0:t.in)||e,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),ua(n)}function Yf(e,t,r){const n=Z(e,r==null?void 0:r.in);return n.setTime(n.getTime()+t*ed),n}function Ph(e,t,r){return fr(e,t*3,r)}function qT(e,t,r){return Dw(e,t*1e3,r)}function cc(e,t,r){return cr(e,t*7,r)}function Yr(e,t,r){return fr(e,t*12,r)}function b0(e,t){let r,n=t==null?void 0:t.in;return e.forEach(s=>{!n&&typeof s=="object"&&(n=_e.bind(null,s));const a=Z(s,n);(!r||r<a||isNaN(+a))&&(r=a)}),_e(n,r||NaN)}function w0(e,t){let r,n=t==null?void 0:t.in;return e.forEach(s=>{!n&&typeof s=="object"&&(n=_e.bind(null,s));const a=Z(s,n);(!r||r>a||isNaN(+a))&&(r=a)}),_e(n,r||NaN)}function vl(e,t){const r=+Z(e)-+Z(t);return r<0?-1:r>0?1:r}function GT(e){return _e(e,Date.now())}function KT(e,t,r){const[n,s]=xr(r==null?void 0:r.in,e,t);return+gs(n)==+gs(s)}function qr(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function dc(e){return!(!qr(e)&&typeof e!="number"||isNaN(+Z(e)))}function Qi(e,t,r){const[n,s]=xr(r==null?void 0:r.in,e,t),a=n.getFullYear()-s.getFullYear(),o=n.getMonth()-s.getMonth();return a*12+o}function is(e,t){const r=Z(e,t==null?void 0:t.in);return Math.trunc(r.getMonth()/3)+1}function uc(e,t,r){const[n,s]=xr(r==null?void 0:r.in,e,t),a=n.getFullYear()-s.getFullYear(),o=is(n)-is(s);return a*4+o}function fc(e,t,r){const[n,s]=xr(r==null?void 0:r.in,e,t);return n.getFullYear()-s.getFullYear()}function QT(e,t,r){const[n,s]=xr(r==null?void 0:r.in,e,t),a=_0(n,s),o=Math.abs(ma(n,s));n.setDate(n.getDate()-a*o);const l=+(_0(n,s)===-a),c=a*(o-l);return c===0?0:c}function _0(e,t){const r=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return r<0?-1:r>0?1:r}function JT(e){return t=>{const n=(e?Math[e]:Math.trunc)(t);return n===0?0:n}}function XT(e,t){return+Z(e)-+Z(t)}function Th(e,t){const r=Z(e,t==null?void 0:t.in);return r.setHours(23,59,59,999),r}function Rh(e,t){const r=Z(e,t==null?void 0:t.in),n=r.getMonth();return r.setFullYear(r.getFullYear(),n+1,0),r.setHours(23,59,59,999),r}function ZT(e,t){const r=Z(e,t==null?void 0:t.in);return+Th(r,t)==+Rh(r,t)}function e5(e,t,r){const[n,s,a]=xr(r==null?void 0:r.in,e,e,t),o=vl(s,a),l=Math.abs(Qi(s,a));if(l<1)return 0;s.getMonth()===1&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-o*l);let c=vl(s,a)===-o;ZT(n)&&l===1&&vl(n,a)===1&&(c=!1);const d=o*(l-+c);return d===0?0:d}function t5(e,t,r){const n=XT(e,t)/1e3;return JT(r==null?void 0:r.roundingMethod)(n)}function qf(e,t){const r=Z(e,t==null?void 0:t.in),n=r.getMonth(),s=n-n%3;return r.setMonth(s,1),r.setHours(0,0,0,0),r}function Pw(e,t){const r=Z(e,t==null?void 0:t.in);return r.setDate(1),r.setHours(0,0,0,0),r}function Tw(e,t){const r=Z(e,t==null?void 0:t.in),n=r.getFullYear();return r.setFullYear(n+1,0,0),r.setHours(23,59,59,999),r}function rd(e,t){const r=Z(e,t==null?void 0:t.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}function r5(e,t){var l,c,d,u;const r=Fn(),n=(t==null?void 0:t.weekStartsOn)??((c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((u=(d=r.locale)==null?void 0:d.options)==null?void 0:u.weekStartsOn)??0,s=Z(e,t==null?void 0:t.in),a=s.getDay(),o=(a<n?-7:0)+6-(a-n);return s.setDate(s.getDate()+o),s.setHours(23,59,59,999),s}const n5={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},s5=(e,t,r)=>{let n;const s=n5[e];return typeof s=="string"?n=s:t===1?n=s.one:n=s.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function hu(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const a5={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},i5={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},o5={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},l5={date:hu({formats:a5,defaultWidth:"full"}),time:hu({formats:i5,defaultWidth:"full"}),dateTime:hu({formats:o5,defaultWidth:"full"})},c5={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},d5=(e,t,r,n)=>c5[e];function Ga(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let s;if(n==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,l=r!=null&&r.width?String(r.width):o;s=e.formattingValues[l]||e.formattingValues[o]}else{const o=e.defaultWidth,l=r!=null&&r.width?String(r.width):e.defaultWidth;s=e.values[l]||e.values[o]}const a=e.argumentCallback?e.argumentCallback(t):t;return s[a]}}const u5={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},f5={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},m5={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},h5={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},p5={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},g5={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},x5=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},y5={ordinalNumber:x5,era:Ga({values:u5,defaultWidth:"wide"}),quarter:Ga({values:f5,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Ga({values:m5,defaultWidth:"wide"}),day:Ga({values:h5,defaultWidth:"wide"}),dayPeriod:Ga({values:p5,defaultWidth:"wide",formattingValues:g5,defaultFormattingWidth:"wide"})};function Ka(e){return(t,r={})=>{const n=r.width,s=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],a=t.match(s);if(!a)return null;const o=a[0],l=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(l)?b5(l,m=>m.test(o)):v5(l,m=>m.test(o));let d;d=e.valueCallback?e.valueCallback(c):c,d=r.valueCallback?r.valueCallback(d):d;const u=t.slice(o.length);return{value:d,rest:u}}}function v5(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function b5(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function w5(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const s=n[0],a=t.match(e.parsePattern);if(!a)return null;let o=e.valueCallback?e.valueCallback(a[0]):a[0];o=r.valueCallback?r.valueCallback(o):o;const l=t.slice(s.length);return{value:o,rest:l}}}const _5=/^(\d+)(th|st|nd|rd)?/i,j5=/\d+/i,N5={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},k5={any:[/^b/i,/^(a|c)/i]},S5={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},C5={any:[/1/i,/2/i,/3/i,/4/i]},D5={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},E5={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},P5={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},T5={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},R5={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},L5={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},I5={ordinalNumber:w5({matchPattern:_5,parsePattern:j5,valueCallback:e=>parseInt(e,10)}),era:Ka({matchPatterns:N5,defaultMatchWidth:"wide",parsePatterns:k5,defaultParseWidth:"any"}),quarter:Ka({matchPatterns:S5,defaultMatchWidth:"wide",parsePatterns:C5,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Ka({matchPatterns:D5,defaultMatchWidth:"wide",parsePatterns:E5,defaultParseWidth:"any"}),day:Ka({matchPatterns:P5,defaultMatchWidth:"wide",parsePatterns:T5,defaultParseWidth:"any"}),dayPeriod:Ka({matchPatterns:R5,defaultMatchWidth:"any",parsePatterns:L5,defaultParseWidth:"any"})},Lh={code:"en-US",formatDistance:s5,formatLong:l5,formatRelative:d5,localize:y5,match:I5,options:{weekStartsOn:0,firstWeekContainsDate:1}};function M5(e,t){const r=Z(e,t==null?void 0:t.in);return ma(r,rd(r))+1}function Ih(e,t){const r=Z(e,t==null?void 0:t.in),n=+ua(r)-+YT(r);return Math.round(n/Cw)+1}function Mh(e,t){var u,m,f,h;const r=Z(e,t==null?void 0:t.in),n=r.getFullYear(),s=Fn(),a=(t==null?void 0:t.firstWeekContainsDate)??((m=(u=t==null?void 0:t.locale)==null?void 0:u.options)==null?void 0:m.firstWeekContainsDate)??s.firstWeekContainsDate??((h=(f=s.locale)==null?void 0:f.options)==null?void 0:h.firstWeekContainsDate)??1,o=_e((t==null?void 0:t.in)||e,0);o.setFullYear(n+1,0,a),o.setHours(0,0,0,0);const l=rn(o,t),c=_e((t==null?void 0:t.in)||e,0);c.setFullYear(n,0,a),c.setHours(0,0,0,0);const d=rn(c,t);return+r>=+l?n+1:+r>=+d?n:n-1}function O5(e,t){var l,c,d,u;const r=Fn(),n=(t==null?void 0:t.firstWeekContainsDate)??((c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??r.firstWeekContainsDate??((u=(d=r.locale)==null?void 0:d.options)==null?void 0:u.firstWeekContainsDate)??1,s=Mh(e,t),a=_e((t==null?void 0:t.in)||e,0);return a.setFullYear(s,0,n),a.setHours(0,0,0,0),rn(a,t)}function Rw(e,t){const r=Z(e,t==null?void 0:t.in),n=+rn(r,t)-+O5(r,t);return Math.round(n/Cw)+1}function je(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const ln={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return je(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):je(r+1,2)},d(e,t){return je(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return je(e.getHours()%12||12,t.length)},H(e,t){return je(e.getHours(),t.length)},m(e,t){return je(e.getMinutes(),t.length)},s(e,t){return je(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),s=Math.trunc(n*Math.pow(10,r-3));return je(s,t.length)}},Ds={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},j0={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),s=n>0?n:1-n;return r.ordinalNumber(s,{unit:"year"})}return ln.y(e,t)},Y:function(e,t,r,n){const s=Mh(e,n),a=s>0?s:1-s;if(t==="YY"){const o=a%100;return je(o,2)}return t==="Yo"?r.ordinalNumber(a,{unit:"year"}):je(a,t.length)},R:function(e,t){const r=Ew(e);return je(r,t.length)},u:function(e,t){const r=e.getFullYear();return je(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return je(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return je(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return ln.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return je(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const s=Rw(e,n);return t==="wo"?r.ordinalNumber(s,{unit:"week"}):je(s,t.length)},I:function(e,t,r){const n=Ih(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):je(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):ln.d(e,t)},D:function(e,t,r){const n=M5(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):je(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const s=e.getDay(),a=(s-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(a);case"ee":return je(a,2);case"eo":return r.ordinalNumber(a,{unit:"day"});case"eee":return r.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(s,{width:"short",context:"formatting"});case"eeee":default:return r.day(s,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const s=e.getDay(),a=(s-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(a);case"cc":return je(a,t.length);case"co":return r.ordinalNumber(a,{unit:"day"});case"ccc":return r.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(s,{width:"narrow",context:"standalone"});case"cccccc":return r.day(s,{width:"short",context:"standalone"});case"cccc":default:return r.day(s,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),s=n===0?7:n;switch(t){case"i":return String(s);case"ii":return je(s,t.length);case"io":return r.ordinalNumber(s,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const s=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let s;switch(n===12?s=Ds.noon:n===0?s=Ds.midnight:s=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let s;switch(n>=17?s=Ds.evening:n>=12?s=Ds.afternoon:n>=4?s=Ds.morning:s=Ds.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return ln.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):ln.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):je(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):je(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):ln.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):ln.s(e,t)},S:function(e,t){return ln.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return k0(n);case"XXXX":case"XX":return Kn(n);case"XXXXX":case"XXX":default:return Kn(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return k0(n);case"xxxx":case"xx":return Kn(n);case"xxxxx":case"xxx":default:return Kn(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+N0(n,":");case"OOOO":default:return"GMT"+Kn(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+N0(n,":");case"zzzz":default:return"GMT"+Kn(n,":")}},t:function(e,t,r){const n=Math.trunc(+e/1e3);return je(n,t.length)},T:function(e,t,r){return je(+e,t.length)}};function N0(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),s=Math.trunc(n/60),a=n%60;return a===0?r+String(s):r+String(s)+t+je(a,2)}function k0(e,t){return e%60===0?(e>0?"-":"+")+je(Math.abs(e)/60,2):Kn(e,t)}function Kn(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),s=je(Math.trunc(n/60),2),a=je(n%60,2);return r+s+t+a}const S0=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},Lw=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},A5=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],s=r[2];if(!s)return S0(e,t);let a;switch(n){case"P":a=t.dateTime({width:"short"});break;case"PP":a=t.dateTime({width:"medium"});break;case"PPP":a=t.dateTime({width:"long"});break;case"PPPP":default:a=t.dateTime({width:"full"});break}return a.replace("{{date}}",S0(n,t)).replace("{{time}}",Lw(s,t))},Gf={p:Lw,P:A5},$5=/^D+$/,F5=/^Y+$/,B5=["D","DD","YY","YYYY"];function Iw(e){return $5.test(e)}function Mw(e){return F5.test(e)}function Kf(e,t,r){const n=U5(e,t,r);if(console.warn(n),B5.includes(e))throw new RangeError(n)}function U5(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const W5=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,H5=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,z5=/^'([^]*?)'?$/,V5=/''/g,Y5=/[a-zA-Z]/;function Pr(e,t,r){var u,m,f,h,y,w,b,g;const n=Fn(),s=(r==null?void 0:r.locale)??n.locale??Lh,a=(r==null?void 0:r.firstWeekContainsDate)??((m=(u=r==null?void 0:r.locale)==null?void 0:u.options)==null?void 0:m.firstWeekContainsDate)??n.firstWeekContainsDate??((h=(f=n.locale)==null?void 0:f.options)==null?void 0:h.firstWeekContainsDate)??1,o=(r==null?void 0:r.weekStartsOn)??((w=(y=r==null?void 0:r.locale)==null?void 0:y.options)==null?void 0:w.weekStartsOn)??n.weekStartsOn??((g=(b=n.locale)==null?void 0:b.options)==null?void 0:g.weekStartsOn)??0,l=Z(e,r==null?void 0:r.in);if(!dc(l))throw new RangeError("Invalid time value");let c=t.match(H5).map(x=>{const v=x[0];if(v==="p"||v==="P"){const N=Gf[v];return N(x,s.formatLong)}return x}).join("").match(W5).map(x=>{if(x==="''")return{isToken:!1,value:"'"};const v=x[0];if(v==="'")return{isToken:!1,value:q5(x)};if(j0[v])return{isToken:!0,value:x};if(v.match(Y5))throw new RangeError("Format string contains an unescaped latin alphabet character `"+v+"`");return{isToken:!1,value:x}});s.localize.preprocessor&&(c=s.localize.preprocessor(l,c));const d={firstWeekContainsDate:a,weekStartsOn:o,locale:s};return c.map(x=>{if(!x.isToken)return x.value;const v=x.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&Mw(v)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&Iw(v))&&Kf(v,t,String(e));const N=j0[v[0]];return N(l,v,s.localize,d)}).join("")}function q5(e){const t=e.match(z5);return t?t[1].replace(V5,"'"):e}function G5(e,t,r){const n=Fn(),s=(r==null?void 0:r.locale)??n.locale??Lh,a=2520,o=vl(e,t);if(isNaN(o))throw new RangeError("Invalid time value");const l=Object.assign({},r,{addSuffix:r==null?void 0:r.addSuffix,comparison:o}),[c,d]=xr(r==null?void 0:r.in,...o>0?[t,e]:[e,t]),u=t5(d,c),m=(fa(d)-fa(c))/1e3,f=Math.round((u-m)/60);let h;if(f<2)return r!=null&&r.includeSeconds?u<5?s.formatDistance("lessThanXSeconds",5,l):u<10?s.formatDistance("lessThanXSeconds",10,l):u<20?s.formatDistance("lessThanXSeconds",20,l):u<40?s.formatDistance("halfAMinute",0,l):u<60?s.formatDistance("lessThanXMinutes",1,l):s.formatDistance("xMinutes",1,l):f===0?s.formatDistance("lessThanXMinutes",1,l):s.formatDistance("xMinutes",f,l);if(f<45)return s.formatDistance("xMinutes",f,l);if(f<90)return s.formatDistance("aboutXHours",1,l);if(f<y0){const y=Math.round(f/60);return s.formatDistance("aboutXHours",y,l)}else{if(f<a)return s.formatDistance("xDays",1,l);if(f<Yo){const y=Math.round(f/y0);return s.formatDistance("xDays",y,l)}else if(f<Yo*2)return h=Math.round(f/Yo),s.formatDistance("aboutXMonths",h,l)}if(h=e5(d,c),h<12){const y=Math.round(f/Yo);return s.formatDistance("xMonths",y,l)}else{const y=h%12,w=Math.trunc(h/12);return y<3?s.formatDistance("aboutXYears",w,l):y<9?s.formatDistance("overXYears",w,l):s.formatDistance("almostXYears",w+1,l)}}function C0(e,t){return G5(e,GT(e),t)}function D0(e,t){return Z(e,t==null?void 0:t.in).getDate()}function K5(e,t){return Z(e,t==null?void 0:t.in).getDay()}function Q5(e,t){const r=Z(e,t==null?void 0:t.in),n=r.getFullYear(),s=r.getMonth(),a=_e(r,0);return a.setFullYear(n,s+1,0),a.setHours(0,0,0,0),a.getDate()}function J5(){return Object.assign({},Fn())}function Gr(e,t){return Z(e,t==null?void 0:t.in).getHours()}function X5(e,t){const r=Z(e,t==null?void 0:t.in).getDay();return r===0?7:r}function Kr(e,t){return Z(e,t==null?void 0:t.in).getMinutes()}function ut(e,t){return Z(e,t==null?void 0:t.in).getMonth()}function Dn(e){return Z(e).getSeconds()}function Qf(e){return+Z(e)}function de(e,t){return Z(e,t==null?void 0:t.in).getFullYear()}function Ln(e,t){return+Z(e)>+Z(t)}function Sr(e,t){return+Z(e)<+Z(t)}function Z5(e,t){return+Z(e)==+Z(t)}function e3(e,t){const r=t3(t)?new t(0):_e(t,0);return r.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),r.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),r}function t3(e){var t;return typeof e=="function"&&((t=e.prototype)==null?void 0:t.constructor)===e}const r3=10;class Ow{constructor(){Q(this,"subPriority",0)}validate(t,r){return!0}}class n3 extends Ow{constructor(t,r,n,s,a){super(),this.value=t,this.validateValue=r,this.setValue=n,this.priority=s,a&&(this.subPriority=a)}validate(t,r){return this.validateValue(t,this.value,r)}set(t,r,n){return this.setValue(t,r,this.value,n)}}class s3 extends Ow{constructor(r,n){super();Q(this,"priority",r3);Q(this,"subPriority",-1);this.context=r||(s=>_e(n,s))}set(r,n){return n.timestampIsSet?r:_e(r,e3(r,this.context))}}class ve{run(t,r,n,s){const a=this.parse(t,r,n,s);return a?{setter:new n3(a.value,this.validate,this.set,this.priority,this.subPriority),rest:a.rest}:null}validate(t,r,n){return!0}}class a3 extends ve{constructor(){super(...arguments);Q(this,"priority",140);Q(this,"incompatibleTokens",["R","u","t","T"])}parse(r,n,s){switch(n){case"G":case"GG":case"GGG":return s.era(r,{width:"abbreviated"})||s.era(r,{width:"narrow"});case"GGGGG":return s.era(r,{width:"narrow"});case"GGGG":default:return s.era(r,{width:"wide"})||s.era(r,{width:"abbreviated"})||s.era(r,{width:"narrow"})}}set(r,n,s){return n.era=s,r.setFullYear(s,0,1),r.setHours(0,0,0,0),r}}const ze={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},Nr={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function Ve(e,t){return e&&{value:t(e.value),rest:e.rest}}function $e(e,t){const r=t.match(e);return r?{value:parseInt(r[0],10),rest:t.slice(r[0].length)}:null}function kr(e,t){const r=t.match(e);if(!r)return null;if(r[0]==="Z")return{value:0,rest:t.slice(1)};const n=r[1]==="+"?1:-1,s=r[2]?parseInt(r[2],10):0,a=r[3]?parseInt(r[3],10):0,o=r[5]?parseInt(r[5],10):0;return{value:n*(s*td+a*ed+o*HT),rest:t.slice(r[0].length)}}function Aw(e){return $e(ze.anyDigitsSigned,e)}function We(e,t){switch(e){case 1:return $e(ze.singleDigit,t);case 2:return $e(ze.twoDigits,t);case 3:return $e(ze.threeDigits,t);case 4:return $e(ze.fourDigits,t);default:return $e(new RegExp("^\\d{1,"+e+"}"),t)}}function mc(e,t){switch(e){case 1:return $e(ze.singleDigitSigned,t);case 2:return $e(ze.twoDigitsSigned,t);case 3:return $e(ze.threeDigitsSigned,t);case 4:return $e(ze.fourDigitsSigned,t);default:return $e(new RegExp("^-?\\d{1,"+e+"}"),t)}}function Oh(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function $w(e,t){const r=t>0,n=r?t:1-t;let s;if(n<=50)s=e||100;else{const a=n+50,o=Math.trunc(a/100)*100,l=e>=a%100;s=e+o-(l?100:0)}return r?s:1-s}function Fw(e){return e%400===0||e%4===0&&e%100!==0}class i3 extends ve{constructor(){super(...arguments);Q(this,"priority",130);Q(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(r,n,s){const a=o=>({year:o,isTwoDigitYear:n==="yy"});switch(n){case"y":return Ve(We(4,r),a);case"yo":return Ve(s.ordinalNumber(r,{unit:"year"}),a);default:return Ve(We(n.length,r),a)}}validate(r,n){return n.isTwoDigitYear||n.year>0}set(r,n,s){const a=r.getFullYear();if(s.isTwoDigitYear){const l=$w(s.year,a);return r.setFullYear(l,0,1),r.setHours(0,0,0,0),r}const o=!("era"in n)||n.era===1?s.year:1-s.year;return r.setFullYear(o,0,1),r.setHours(0,0,0,0),r}}class o3 extends ve{constructor(){super(...arguments);Q(this,"priority",130);Q(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(r,n,s){const a=o=>({year:o,isTwoDigitYear:n==="YY"});switch(n){case"Y":return Ve(We(4,r),a);case"Yo":return Ve(s.ordinalNumber(r,{unit:"year"}),a);default:return Ve(We(n.length,r),a)}}validate(r,n){return n.isTwoDigitYear||n.year>0}set(r,n,s,a){const o=Mh(r,a);if(s.isTwoDigitYear){const c=$w(s.year,o);return r.setFullYear(c,0,a.firstWeekContainsDate),r.setHours(0,0,0,0),rn(r,a)}const l=!("era"in n)||n.era===1?s.year:1-s.year;return r.setFullYear(l,0,a.firstWeekContainsDate),r.setHours(0,0,0,0),rn(r,a)}}class l3 extends ve{constructor(){super(...arguments);Q(this,"priority",130);Q(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(r,n){return mc(n==="R"?4:n.length,r)}set(r,n,s){const a=_e(r,0);return a.setFullYear(s,0,4),a.setHours(0,0,0,0),ua(a)}}class c3 extends ve{constructor(){super(...arguments);Q(this,"priority",130);Q(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(r,n){return mc(n==="u"?4:n.length,r)}set(r,n,s){return r.setFullYear(s,0,1),r.setHours(0,0,0,0),r}}class d3 extends ve{constructor(){super(...arguments);Q(this,"priority",120);Q(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(r,n,s){switch(n){case"Q":case"QQ":return We(n.length,r);case"Qo":return s.ordinalNumber(r,{unit:"quarter"});case"QQQ":return s.quarter(r,{width:"abbreviated",context:"formatting"})||s.quarter(r,{width:"narrow",context:"formatting"});case"QQQQQ":return s.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return s.quarter(r,{width:"wide",context:"formatting"})||s.quarter(r,{width:"abbreviated",context:"formatting"})||s.quarter(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=1&&n<=4}set(r,n,s){return r.setMonth((s-1)*3,1),r.setHours(0,0,0,0),r}}class u3 extends ve{constructor(){super(...arguments);Q(this,"priority",120);Q(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(r,n,s){switch(n){case"q":case"qq":return We(n.length,r);case"qo":return s.ordinalNumber(r,{unit:"quarter"});case"qqq":return s.quarter(r,{width:"abbreviated",context:"standalone"})||s.quarter(r,{width:"narrow",context:"standalone"});case"qqqqq":return s.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return s.quarter(r,{width:"wide",context:"standalone"})||s.quarter(r,{width:"abbreviated",context:"standalone"})||s.quarter(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=1&&n<=4}set(r,n,s){return r.setMonth((s-1)*3,1),r.setHours(0,0,0,0),r}}class f3 extends ve{constructor(){super(...arguments);Q(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]);Q(this,"priority",110)}parse(r,n,s){const a=o=>o-1;switch(n){case"M":return Ve($e(ze.month,r),a);case"MM":return Ve(We(2,r),a);case"Mo":return Ve(s.ordinalNumber(r,{unit:"month"}),a);case"MMM":return s.month(r,{width:"abbreviated",context:"formatting"})||s.month(r,{width:"narrow",context:"formatting"});case"MMMMM":return s.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return s.month(r,{width:"wide",context:"formatting"})||s.month(r,{width:"abbreviated",context:"formatting"})||s.month(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=11}set(r,n,s){return r.setMonth(s,1),r.setHours(0,0,0,0),r}}class m3 extends ve{constructor(){super(...arguments);Q(this,"priority",110);Q(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(r,n,s){const a=o=>o-1;switch(n){case"L":return Ve($e(ze.month,r),a);case"LL":return Ve(We(2,r),a);case"Lo":return Ve(s.ordinalNumber(r,{unit:"month"}),a);case"LLL":return s.month(r,{width:"abbreviated",context:"standalone"})||s.month(r,{width:"narrow",context:"standalone"});case"LLLLL":return s.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return s.month(r,{width:"wide",context:"standalone"})||s.month(r,{width:"abbreviated",context:"standalone"})||s.month(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=0&&n<=11}set(r,n,s){return r.setMonth(s,1),r.setHours(0,0,0,0),r}}function h3(e,t,r){const n=Z(e,r==null?void 0:r.in),s=Rw(n,r)-t;return n.setDate(n.getDate()-s*7),Z(n,r==null?void 0:r.in)}class p3 extends ve{constructor(){super(...arguments);Q(this,"priority",100);Q(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(r,n,s){switch(n){case"w":return $e(ze.week,r);case"wo":return s.ordinalNumber(r,{unit:"week"});default:return We(n.length,r)}}validate(r,n){return n>=1&&n<=53}set(r,n,s,a){return rn(h3(r,s,a),a)}}function g3(e,t,r){const n=Z(e,r==null?void 0:r.in),s=Ih(n,r)-t;return n.setDate(n.getDate()-s*7),n}class x3 extends ve{constructor(){super(...arguments);Q(this,"priority",100);Q(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(r,n,s){switch(n){case"I":return $e(ze.week,r);case"Io":return s.ordinalNumber(r,{unit:"week"});default:return We(n.length,r)}}validate(r,n){return n>=1&&n<=53}set(r,n,s){return ua(g3(r,s))}}const y3=[31,28,31,30,31,30,31,31,30,31,30,31],v3=[31,29,31,30,31,30,31,31,30,31,30,31];class b3 extends ve{constructor(){super(...arguments);Q(this,"priority",90);Q(this,"subPriority",1);Q(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(r,n,s){switch(n){case"d":return $e(ze.date,r);case"do":return s.ordinalNumber(r,{unit:"date"});default:return We(n.length,r)}}validate(r,n){const s=r.getFullYear(),a=Fw(s),o=r.getMonth();return a?n>=1&&n<=v3[o]:n>=1&&n<=y3[o]}set(r,n,s){return r.setDate(s),r.setHours(0,0,0,0),r}}class w3 extends ve{constructor(){super(...arguments);Q(this,"priority",90);Q(this,"subpriority",1);Q(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(r,n,s){switch(n){case"D":case"DD":return $e(ze.dayOfYear,r);case"Do":return s.ordinalNumber(r,{unit:"date"});default:return We(n.length,r)}}validate(r,n){const s=r.getFullYear();return Fw(s)?n>=1&&n<=366:n>=1&&n<=365}set(r,n,s){return r.setMonth(0,s),r.setHours(0,0,0,0),r}}function Ah(e,t,r){var m,f,h,y;const n=Fn(),s=(r==null?void 0:r.weekStartsOn)??((f=(m=r==null?void 0:r.locale)==null?void 0:m.options)==null?void 0:f.weekStartsOn)??n.weekStartsOn??((y=(h=n.locale)==null?void 0:h.options)==null?void 0:y.weekStartsOn)??0,a=Z(e,r==null?void 0:r.in),o=a.getDay(),c=(t%7+7)%7,d=7-s,u=t<0||t>6?t-(o+d)%7:(c+d)%7-(o+d)%7;return cr(a,u,r)}class _3 extends ve{constructor(){super(...arguments);Q(this,"priority",90);Q(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(r,n,s){switch(n){case"E":case"EE":case"EEE":return s.day(r,{width:"abbreviated",context:"formatting"})||s.day(r,{width:"short",context:"formatting"})||s.day(r,{width:"narrow",context:"formatting"});case"EEEEE":return s.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return s.day(r,{width:"short",context:"formatting"})||s.day(r,{width:"narrow",context:"formatting"});case"EEEE":default:return s.day(r,{width:"wide",context:"formatting"})||s.day(r,{width:"abbreviated",context:"formatting"})||s.day(r,{width:"short",context:"formatting"})||s.day(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=6}set(r,n,s,a){return r=Ah(r,s,a),r.setHours(0,0,0,0),r}}class j3 extends ve{constructor(){super(...arguments);Q(this,"priority",90);Q(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(r,n,s,a){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+a.weekStartsOn+6)%7+c};switch(n){case"e":case"ee":return Ve(We(n.length,r),o);case"eo":return Ve(s.ordinalNumber(r,{unit:"day"}),o);case"eee":return s.day(r,{width:"abbreviated",context:"formatting"})||s.day(r,{width:"short",context:"formatting"})||s.day(r,{width:"narrow",context:"formatting"});case"eeeee":return s.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return s.day(r,{width:"short",context:"formatting"})||s.day(r,{width:"narrow",context:"formatting"});case"eeee":default:return s.day(r,{width:"wide",context:"formatting"})||s.day(r,{width:"abbreviated",context:"formatting"})||s.day(r,{width:"short",context:"formatting"})||s.day(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=6}set(r,n,s,a){return r=Ah(r,s,a),r.setHours(0,0,0,0),r}}class N3 extends ve{constructor(){super(...arguments);Q(this,"priority",90);Q(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(r,n,s,a){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+a.weekStartsOn+6)%7+c};switch(n){case"c":case"cc":return Ve(We(n.length,r),o);case"co":return Ve(s.ordinalNumber(r,{unit:"day"}),o);case"ccc":return s.day(r,{width:"abbreviated",context:"standalone"})||s.day(r,{width:"short",context:"standalone"})||s.day(r,{width:"narrow",context:"standalone"});case"ccccc":return s.day(r,{width:"narrow",context:"standalone"});case"cccccc":return s.day(r,{width:"short",context:"standalone"})||s.day(r,{width:"narrow",context:"standalone"});case"cccc":default:return s.day(r,{width:"wide",context:"standalone"})||s.day(r,{width:"abbreviated",context:"standalone"})||s.day(r,{width:"short",context:"standalone"})||s.day(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=0&&n<=6}set(r,n,s,a){return r=Ah(r,s,a),r.setHours(0,0,0,0),r}}function k3(e,t,r){const n=Z(e,r==null?void 0:r.in),s=X5(n,r),a=t-s;return cr(n,a,r)}class S3 extends ve{constructor(){super(...arguments);Q(this,"priority",90);Q(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(r,n,s){const a=o=>o===0?7:o;switch(n){case"i":case"ii":return We(n.length,r);case"io":return s.ordinalNumber(r,{unit:"day"});case"iii":return Ve(s.day(r,{width:"abbreviated",context:"formatting"})||s.day(r,{width:"short",context:"formatting"})||s.day(r,{width:"narrow",context:"formatting"}),a);case"iiiii":return Ve(s.day(r,{width:"narrow",context:"formatting"}),a);case"iiiiii":return Ve(s.day(r,{width:"short",context:"formatting"})||s.day(r,{width:"narrow",context:"formatting"}),a);case"iiii":default:return Ve(s.day(r,{width:"wide",context:"formatting"})||s.day(r,{width:"abbreviated",context:"formatting"})||s.day(r,{width:"short",context:"formatting"})||s.day(r,{width:"narrow",context:"formatting"}),a)}}validate(r,n){return n>=1&&n<=7}set(r,n,s){return r=k3(r,s),r.setHours(0,0,0,0),r}}class C3 extends ve{constructor(){super(...arguments);Q(this,"priority",80);Q(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(r,n,s){switch(n){case"a":case"aa":case"aaa":return s.dayPeriod(r,{width:"abbreviated",context:"formatting"})||s.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaaa":return s.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return s.dayPeriod(r,{width:"wide",context:"formatting"})||s.dayPeriod(r,{width:"abbreviated",context:"formatting"})||s.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,s){return r.setHours(Oh(s),0,0,0),r}}class D3 extends ve{constructor(){super(...arguments);Q(this,"priority",80);Q(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(r,n,s){switch(n){case"b":case"bb":case"bbb":return s.dayPeriod(r,{width:"abbreviated",context:"formatting"})||s.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbbb":return s.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return s.dayPeriod(r,{width:"wide",context:"formatting"})||s.dayPeriod(r,{width:"abbreviated",context:"formatting"})||s.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,s){return r.setHours(Oh(s),0,0,0),r}}class E3 extends ve{constructor(){super(...arguments);Q(this,"priority",80);Q(this,"incompatibleTokens",["a","b","t","T"])}parse(r,n,s){switch(n){case"B":case"BB":case"BBB":return s.dayPeriod(r,{width:"abbreviated",context:"formatting"})||s.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBBB":return s.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return s.dayPeriod(r,{width:"wide",context:"formatting"})||s.dayPeriod(r,{width:"abbreviated",context:"formatting"})||s.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,s){return r.setHours(Oh(s),0,0,0),r}}class P3 extends ve{constructor(){super(...arguments);Q(this,"priority",70);Q(this,"incompatibleTokens",["H","K","k","t","T"])}parse(r,n,s){switch(n){case"h":return $e(ze.hour12h,r);case"ho":return s.ordinalNumber(r,{unit:"hour"});default:return We(n.length,r)}}validate(r,n){return n>=1&&n<=12}set(r,n,s){const a=r.getHours()>=12;return a&&s<12?r.setHours(s+12,0,0,0):!a&&s===12?r.setHours(0,0,0,0):r.setHours(s,0,0,0),r}}class T3 extends ve{constructor(){super(...arguments);Q(this,"priority",70);Q(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(r,n,s){switch(n){case"H":return $e(ze.hour23h,r);case"Ho":return s.ordinalNumber(r,{unit:"hour"});default:return We(n.length,r)}}validate(r,n){return n>=0&&n<=23}set(r,n,s){return r.setHours(s,0,0,0),r}}class R3 extends ve{constructor(){super(...arguments);Q(this,"priority",70);Q(this,"incompatibleTokens",["h","H","k","t","T"])}parse(r,n,s){switch(n){case"K":return $e(ze.hour11h,r);case"Ko":return s.ordinalNumber(r,{unit:"hour"});default:return We(n.length,r)}}validate(r,n){return n>=0&&n<=11}set(r,n,s){return r.getHours()>=12&&s<12?r.setHours(s+12,0,0,0):r.setHours(s,0,0,0),r}}class L3 extends ve{constructor(){super(...arguments);Q(this,"priority",70);Q(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(r,n,s){switch(n){case"k":return $e(ze.hour24h,r);case"ko":return s.ordinalNumber(r,{unit:"hour"});default:return We(n.length,r)}}validate(r,n){return n>=1&&n<=24}set(r,n,s){const a=s<=24?s%24:s;return r.setHours(a,0,0,0),r}}class I3 extends ve{constructor(){super(...arguments);Q(this,"priority",60);Q(this,"incompatibleTokens",["t","T"])}parse(r,n,s){switch(n){case"m":return $e(ze.minute,r);case"mo":return s.ordinalNumber(r,{unit:"minute"});default:return We(n.length,r)}}validate(r,n){return n>=0&&n<=59}set(r,n,s){return r.setMinutes(s,0,0),r}}class M3 extends ve{constructor(){super(...arguments);Q(this,"priority",50);Q(this,"incompatibleTokens",["t","T"])}parse(r,n,s){switch(n){case"s":return $e(ze.second,r);case"so":return s.ordinalNumber(r,{unit:"second"});default:return We(n.length,r)}}validate(r,n){return n>=0&&n<=59}set(r,n,s){return r.setSeconds(s,0),r}}class O3 extends ve{constructor(){super(...arguments);Q(this,"priority",30);Q(this,"incompatibleTokens",["t","T"])}parse(r,n){const s=a=>Math.trunc(a*Math.pow(10,-n.length+3));return Ve(We(n.length,r),s)}set(r,n,s){return r.setMilliseconds(s),r}}class A3 extends ve{constructor(){super(...arguments);Q(this,"priority",10);Q(this,"incompatibleTokens",["t","T","x"])}parse(r,n){switch(n){case"X":return kr(Nr.basicOptionalMinutes,r);case"XX":return kr(Nr.basic,r);case"XXXX":return kr(Nr.basicOptionalSeconds,r);case"XXXXX":return kr(Nr.extendedOptionalSeconds,r);case"XXX":default:return kr(Nr.extended,r)}}set(r,n,s){return n.timestampIsSet?r:_e(r,r.getTime()-fa(r)-s)}}class $3 extends ve{constructor(){super(...arguments);Q(this,"priority",10);Q(this,"incompatibleTokens",["t","T","X"])}parse(r,n){switch(n){case"x":return kr(Nr.basicOptionalMinutes,r);case"xx":return kr(Nr.basic,r);case"xxxx":return kr(Nr.basicOptionalSeconds,r);case"xxxxx":return kr(Nr.extendedOptionalSeconds,r);case"xxx":default:return kr(Nr.extended,r)}}set(r,n,s){return n.timestampIsSet?r:_e(r,r.getTime()-fa(r)-s)}}class F3 extends ve{constructor(){super(...arguments);Q(this,"priority",40);Q(this,"incompatibleTokens","*")}parse(r){return Aw(r)}set(r,n,s){return[_e(r,s*1e3),{timestampIsSet:!0}]}}class B3 extends ve{constructor(){super(...arguments);Q(this,"priority",20);Q(this,"incompatibleTokens","*")}parse(r){return Aw(r)}set(r,n,s){return[_e(r,s),{timestampIsSet:!0}]}}const U3={G:new a3,y:new i3,Y:new o3,R:new l3,u:new c3,Q:new d3,q:new u3,M:new f3,L:new m3,w:new p3,I:new x3,d:new b3,D:new w3,E:new _3,e:new j3,c:new N3,i:new S3,a:new C3,b:new D3,B:new E3,h:new P3,H:new T3,K:new R3,k:new L3,m:new I3,s:new M3,S:new O3,X:new A3,x:new $3,t:new F3,T:new B3},W3=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,H3=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,z3=/^'([^]*?)'?$/,V3=/''/g,Y3=/\S/,q3=/[a-zA-Z]/;function G3(e,t,r,n){var b,g,x,v,N,_,C,j;const s=()=>_e((n==null?void 0:n.in)||r,NaN),a=J5(),o=(n==null?void 0:n.locale)??a.locale??Lh,l=(n==null?void 0:n.firstWeekContainsDate)??((g=(b=n==null?void 0:n.locale)==null?void 0:b.options)==null?void 0:g.firstWeekContainsDate)??a.firstWeekContainsDate??((v=(x=a.locale)==null?void 0:x.options)==null?void 0:v.firstWeekContainsDate)??1,c=(n==null?void 0:n.weekStartsOn)??((_=(N=n==null?void 0:n.locale)==null?void 0:N.options)==null?void 0:_.weekStartsOn)??a.weekStartsOn??((j=(C=a.locale)==null?void 0:C.options)==null?void 0:j.weekStartsOn)??0;if(!t)return e?s():Z(r,n==null?void 0:n.in);const d={firstWeekContainsDate:l,weekStartsOn:c,locale:o},u=[new s3(n==null?void 0:n.in,r)],m=t.match(H3).map(k=>{const S=k[0];if(S in Gf){const D=Gf[S];return D(k,o.formatLong)}return k}).join("").match(W3),f=[];for(let k of m){!(n!=null&&n.useAdditionalWeekYearTokens)&&Mw(k)&&Kf(k,t,e),!(n!=null&&n.useAdditionalDayOfYearTokens)&&Iw(k)&&Kf(k,t,e);const S=k[0],D=U3[S];if(D){const{incompatibleTokens:R}=D;if(Array.isArray(R)){const A=f.find(I=>R.includes(I.token)||I.token===S);if(A)throw new RangeError(`The format string mustn't contain \`${A.fullToken}\` and \`${k}\` at the same time`)}else if(D.incompatibleTokens==="*"&&f.length>0)throw new RangeError(`The format string mustn't contain \`${k}\` and any other token at the same time`);f.push({token:S,fullToken:k});const P=D.run(e,k,o.match,d);if(!P)return s();u.push(P.setter),e=P.rest}else{if(S.match(q3))throw new RangeError("Format string contains an unescaped latin alphabet character `"+S+"`");if(k==="''"?k="'":S==="'"&&(k=K3(k)),e.indexOf(k)===0)e=e.slice(k.length);else return s()}}if(e.length>0&&Y3.test(e))return s();const h=u.map(k=>k.priority).sort((k,S)=>S-k).filter((k,S,D)=>D.indexOf(k)===S).map(k=>u.filter(S=>S.priority===k).sort((S,D)=>D.subPriority-S.subPriority)).map(k=>k[0]);let y=Z(r,n==null?void 0:n.in);if(isNaN(+y))return s();const w={};for(const k of h){if(!k.validate(y,d))return s();const S=k.set(y,w,d);Array.isArray(S)?(y=S[0],Object.assign(w,S[1])):y=S}return y}function K3(e){return e.match(z3)[1].replace(V3,"'")}function Q3(e,t,r){const[n,s]=xr(r==null?void 0:r.in,e,t);return n.getFullYear()===s.getFullYear()&&n.getMonth()===s.getMonth()}function J3(e,t,r){const[n,s]=xr(r==null?void 0:r.in,e,t);return+qf(n)==+qf(s)}function X3(e,t,r){const[n,s]=xr(r==null?void 0:r.in,e,t);return n.getFullYear()===s.getFullYear()}function Ji(e,t,r){const n=+Z(e,r==null?void 0:r.in),[s,a]=[+Z(t.start,r==null?void 0:r.in),+Z(t.end,r==null?void 0:r.in)].sort((o,l)=>o-l);return n>=s&&n<=a}function Z3(e,t,r){return cr(e,-t,r)}function $h(e,t){const r=()=>_e(t==null?void 0:t.in,NaN),n=(t==null?void 0:t.additionalDigits)??2,s=nR(e);let a;if(s.date){const d=sR(s.date,n);a=aR(d.restDateString,d.year)}if(!a||isNaN(+a))return r();const o=+a;let l=0,c;if(s.time&&(l=iR(s.time),isNaN(l)))return r();if(s.timezone){if(c=oR(s.timezone),isNaN(c))return r()}else{const d=new Date(o+l),u=Z(0,t==null?void 0:t.in);return u.setFullYear(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()),u.setHours(d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds()),u}return Z(o+l+c,t==null?void 0:t.in)}const qo={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},eR=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,tR=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,rR=/^([+-])(\d{2})(?::?(\d{2}))?$/;function nR(e){const t={},r=e.split(qo.dateTimeDelimiter);let n;if(r.length>2)return t;if(/:/.test(r[0])?n=r[0]:(t.date=r[0],n=r[1],qo.timeZoneDelimiter.test(t.date)&&(t.date=e.split(qo.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){const s=qo.timezone.exec(n);s?(t.time=n.replace(s[1],""),t.timezone=s[1]):t.time=n}return t}function sR(e,t){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(r);if(!n)return{year:NaN,restDateString:""};const s=n[1]?parseInt(n[1]):null,a=n[2]?parseInt(n[2]):null;return{year:a===null?s:a*100,restDateString:e.slice((n[1]||n[2]).length)}}function aR(e,t){if(t===null)return new Date(NaN);const r=e.match(eR);if(!r)return new Date(NaN);const n=!!r[4],s=Qa(r[1]),a=Qa(r[2])-1,o=Qa(r[3]),l=Qa(r[4]),c=Qa(r[5])-1;if(n)return fR(t,l,c)?lR(t,l,c):new Date(NaN);{const d=new Date(0);return!dR(t,a,o)||!uR(t,s)?new Date(NaN):(d.setUTCFullYear(t,a,Math.max(s,o)),d)}}function Qa(e){return e?parseInt(e):1}function iR(e){const t=e.match(tR);if(!t)return NaN;const r=pu(t[1]),n=pu(t[2]),s=pu(t[3]);return mR(r,n,s)?r*td+n*ed+s*1e3:NaN}function pu(e){return e&&parseFloat(e.replace(",","."))||0}function oR(e){if(e==="Z")return 0;const t=e.match(rR);if(!t)return 0;const r=t[1]==="+"?-1:1,n=parseInt(t[2]),s=t[3]&&parseInt(t[3])||0;return hR(n,s)?r*(n*td+s*ed):NaN}function lR(e,t,r){const n=new Date(0);n.setUTCFullYear(e,0,4);const s=n.getUTCDay()||7,a=(t-1)*7+r+1-s;return n.setUTCDate(n.getUTCDate()+a),n}const cR=[31,null,31,30,31,30,31,31,30,31,30,31];function Bw(e){return e%400===0||e%4===0&&e%100!==0}function dR(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(cR[t]||(Bw(e)?29:28))}function uR(e,t){return t>=1&&t<=(Bw(e)?366:365)}function fR(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function mR(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function hR(e,t){return t>=0&&t<=59}function Wt(e,t,r){const n=Z(e,r==null?void 0:r.in),s=n.getFullYear(),a=n.getDate(),o=_e((r==null?void 0:r.in)||e,0);o.setFullYear(s,t,15),o.setHours(0,0,0,0);const l=Q5(o);return n.setMonth(t,Math.min(a,l)),n}function bl(e,t,r){const n=Z(e,r==null?void 0:r.in);return n.setHours(t),n}function wl(e,t,r){const n=Z(e,r==null?void 0:r.in);return n.setMinutes(t),n}function Ts(e,t,r){const n=Z(e,r==null?void 0:r.in),s=Math.trunc(n.getMonth()/3)+1,a=t-s;return Wt(n,n.getMonth()+a*3)}function _l(e,t,r){const n=Z(e,r==null?void 0:r.in);return n.setSeconds(t),n}function wr(e,t,r){const n=Z(e,r==null?void 0:r.in);return isNaN(+n)?_e((r==null?void 0:r.in)||e,NaN):(n.setFullYear(t),n)}function os(e,t,r){return fr(e,-t,r)}function Uw(e,t,r){return Ph(e,-t,r)}function E0(e,t,r){return cc(e,-t,r)}function ha(e,t,r){return Yr(e,-t,r)}function nd(){return typeof window<"u"}function Ra(e){return Ww(e)?(e.nodeName||"").toLowerCase():"#document"}function Ot(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Lr(e){var t;return(t=(Ww(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function Ww(e){return nd()?e instanceof Node||e instanceof Ot(e).Node:!1}function yt(e){return nd()?e instanceof Element||e instanceof Ot(e).Element:!1}function Rr(e){return nd()?e instanceof HTMLElement||e instanceof Ot(e).HTMLElement:!1}function P0(e){return!nd()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Ot(e).ShadowRoot}const pR=new Set(["inline","contents"]);function ho(e){const{overflow:t,overflowX:r,overflowY:n,display:s}=Zt(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!pR.has(s)}const gR=new Set(["table","td","th"]);function xR(e){return gR.has(Ra(e))}const yR=[":popover-open",":modal"];function sd(e){return yR.some(t=>{try{return e.matches(t)}catch{return!1}})}const vR=["transform","translate","scale","rotate","perspective"],bR=["transform","translate","scale","rotate","perspective","filter"],wR=["paint","layout","strict","content"];function Fh(e){const t=Bh(),r=yt(e)?Zt(e):e;return vR.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||bR.some(n=>(r.willChange||"").includes(n))||wR.some(n=>(r.contain||"").includes(n))}function _R(e){let t=In(e);for(;Rr(t)&&!pa(t);){if(Fh(t))return t;if(sd(t))return null;t=In(t)}return null}function Bh(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const jR=new Set(["html","body","#document"]);function pa(e){return jR.has(Ra(e))}function Zt(e){return Ot(e).getComputedStyle(e)}function ad(e){return yt(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function In(e){if(Ra(e)==="html")return e;const t=e.assignedSlot||e.parentNode||P0(e)&&e.host||Lr(e);return P0(t)?t.host:t}function Hw(e){const t=In(e);return pa(t)?e.ownerDocument?e.ownerDocument.body:e.body:Rr(t)&&ho(t)?t:Hw(t)}function Xi(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const s=Hw(e),a=s===((n=e.ownerDocument)==null?void 0:n.body),o=Ot(s);if(a){const l=Jf(o);return t.concat(o,o.visualViewport||[],ho(s)?s:[],l&&r?Xi(l):[])}return t.concat(s,Xi(s,[],r))}function Jf(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}const ga=Math.min,ls=Math.max,hc=Math.round,Go=Math.floor,Tr=e=>({x:e,y:e}),NR={left:"right",right:"left",bottom:"top",top:"bottom"},kR={start:"end",end:"start"};function SR(e,t,r){return ls(e,ga(t,r))}function id(e,t){return typeof e=="function"?e(t):e}function xa(e){return e.split("-")[0]}function po(e){return e.split("-")[1]}function CR(e){return e==="x"?"y":"x"}function Uh(e){return e==="y"?"height":"width"}const DR=new Set(["top","bottom"]);function rs(e){return DR.has(xa(e))?"y":"x"}function Wh(e){return CR(rs(e))}function ER(e,t,r){r===void 0&&(r=!1);const n=po(e),s=Wh(e),a=Uh(s);let o=s==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[a]>t.floating[a]&&(o=pc(o)),[o,pc(o)]}function PR(e){const t=pc(e);return[Xf(e),t,Xf(t)]}function Xf(e){return e.replace(/start|end/g,t=>kR[t])}const T0=["left","right"],R0=["right","left"],TR=["top","bottom"],RR=["bottom","top"];function LR(e,t,r){switch(e){case"top":case"bottom":return r?t?R0:T0:t?T0:R0;case"left":case"right":return t?TR:RR;default:return[]}}function IR(e,t,r,n){const s=po(e);let a=LR(xa(e),r==="start",n);return s&&(a=a.map(o=>o+"-"+s),t&&(a=a.concat(a.map(Xf)))),a}function pc(e){return e.replace(/left|right|bottom|top/g,t=>NR[t])}function MR(e){return{top:0,right:0,bottom:0,left:0,...e}}function zw(e){return typeof e!="number"?MR(e):{top:e,right:e,bottom:e,left:e}}function gc(e){const{x:t,y:r,width:n,height:s}=e;return{width:n,height:s,top:r,left:t,right:t+n,bottom:r+s,x:t,y:r}}var OR=typeof document<"u",AR=function(){},xc=OR?p.useLayoutEffect:AR;const $R={...Dx},FR=$R.useInsertionEffect,BR=FR||(e=>e());function UR(e){const t=p.useRef(()=>{});return BR(()=>{t.current=e}),p.useCallback(function(){for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return t.current==null?void 0:t.current(...n)},[])}function L0(e,t,r){let{reference:n,floating:s}=e;const a=rs(t),o=Wh(t),l=Uh(o),c=xa(t),d=a==="y",u=n.x+n.width/2-s.width/2,m=n.y+n.height/2-s.height/2,f=n[l]/2-s[l]/2;let h;switch(c){case"top":h={x:u,y:n.y-s.height};break;case"bottom":h={x:u,y:n.y+n.height};break;case"right":h={x:n.x+n.width,y:m};break;case"left":h={x:n.x-s.width,y:m};break;default:h={x:n.x,y:n.y}}switch(po(t)){case"start":h[o]-=f*(r&&d?-1:1);break;case"end":h[o]+=f*(r&&d?-1:1);break}return h}const WR=async(e,t,r)=>{const{placement:n="bottom",strategy:s="absolute",middleware:a=[],platform:o}=r,l=a.filter(Boolean),c=await(o.isRTL==null?void 0:o.isRTL(t));let d=await o.getElementRects({reference:e,floating:t,strategy:s}),{x:u,y:m}=L0(d,n,c),f=n,h={},y=0;for(let w=0;w<l.length;w++){const{name:b,fn:g}=l[w],{x,y:v,data:N,reset:_}=await g({x:u,y:m,initialPlacement:n,placement:f,strategy:s,middlewareData:h,rects:d,platform:o,elements:{reference:e,floating:t}});u=x??u,m=v??m,h={...h,[b]:{...h[b],...N}},_&&y<=50&&(y++,typeof _=="object"&&(_.placement&&(f=_.placement),_.rects&&(d=_.rects===!0?await o.getElementRects({reference:e,floating:t,strategy:s}):_.rects),{x:u,y:m}=L0(d,f,c)),w=-1)}return{x:u,y:m,placement:f,strategy:s,middlewareData:h}};async function HR(e,t){var r;t===void 0&&(t={});const{x:n,y:s,platform:a,rects:o,elements:l,strategy:c}=e,{boundary:d="clippingAncestors",rootBoundary:u="viewport",elementContext:m="floating",altBoundary:f=!1,padding:h=0}=id(t,e),y=zw(h),b=l[f?m==="floating"?"reference":"floating":m],g=gc(await a.getClippingRect({element:(r=await(a.isElement==null?void 0:a.isElement(b)))==null||r?b:b.contextElement||await(a.getDocumentElement==null?void 0:a.getDocumentElement(l.floating)),boundary:d,rootBoundary:u,strategy:c})),x=m==="floating"?{x:n,y:s,width:o.floating.width,height:o.floating.height}:o.reference,v=await(a.getOffsetParent==null?void 0:a.getOffsetParent(l.floating)),N=await(a.isElement==null?void 0:a.isElement(v))?await(a.getScale==null?void 0:a.getScale(v))||{x:1,y:1}:{x:1,y:1},_=gc(a.convertOffsetParentRelativeRectToViewportRelativeRect?await a.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:x,offsetParent:v,strategy:c}):x);return{top:(g.top-_.top+y.top)/N.y,bottom:(_.bottom-g.bottom+y.bottom)/N.y,left:(g.left-_.left+y.left)/N.x,right:(_.right-g.right+y.right)/N.x}}const zR=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:s,rects:a,platform:o,elements:l,middlewareData:c}=t,{element:d,padding:u=0}=id(e,t)||{};if(d==null)return{};const m=zw(u),f={x:r,y:n},h=Wh(s),y=Uh(h),w=await o.getDimensions(d),b=h==="y",g=b?"top":"left",x=b?"bottom":"right",v=b?"clientHeight":"clientWidth",N=a.reference[y]+a.reference[h]-f[h]-a.floating[y],_=f[h]-a.reference[h],C=await(o.getOffsetParent==null?void 0:o.getOffsetParent(d));let j=C?C[v]:0;(!j||!await(o.isElement==null?void 0:o.isElement(C)))&&(j=l.floating[v]||a.floating[y]);const k=N/2-_/2,S=j/2-w[y]/2-1,D=ga(m[g],S),R=ga(m[x],S),P=D,A=j-w[y]-R,I=j/2-w[y]/2+k,L=SR(P,I,A),F=!c.arrow&&po(s)!=null&&I!==L&&a.reference[y]/2-(I<P?D:R)-w[y]/2<0,U=F?I<P?I-P:I-A:0;return{[h]:f[h]+U,data:{[h]:L,centerOffset:I-L-U,...F&&{alignmentOffset:U}},reset:F}}}),VR=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:s,middlewareData:a,rects:o,initialPlacement:l,platform:c,elements:d}=t,{mainAxis:u=!0,crossAxis:m=!0,fallbackPlacements:f,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:y="none",flipAlignment:w=!0,...b}=id(e,t);if((r=a.arrow)!=null&&r.alignmentOffset)return{};const g=xa(s),x=rs(l),v=xa(l)===l,N=await(c.isRTL==null?void 0:c.isRTL(d.floating)),_=f||(v||!w?[pc(l)]:PR(l)),C=y!=="none";!f&&C&&_.push(...IR(l,w,y,N));const j=[l,..._],k=await HR(t,b),S=[];let D=((n=a.flip)==null?void 0:n.overflows)||[];if(u&&S.push(k[g]),m){const I=ER(s,o,N);S.push(k[I[0]],k[I[1]])}if(D=[...D,{placement:s,overflows:S}],!S.every(I=>I<=0)){var R,P;const I=(((R=a.flip)==null?void 0:R.index)||0)+1,L=j[I];if(L&&(!(m==="alignment"?x!==rs(L):!1)||D.every(E=>rs(E.placement)===x?E.overflows[0]>0:!0)))return{data:{index:I,overflows:D},reset:{placement:L}};let F=(P=D.filter(U=>U.overflows[0]<=0).sort((U,E)=>U.overflows[1]-E.overflows[1])[0])==null?void 0:P.placement;if(!F)switch(h){case"bestFit":{var A;const U=(A=D.filter(E=>{if(C){const $=rs(E.placement);return $===x||$==="y"}return!0}).map(E=>[E.placement,E.overflows.filter($=>$>0).reduce(($,B)=>$+B,0)]).sort((E,$)=>E[1]-$[1])[0])==null?void 0:A[0];U&&(F=U);break}case"initialPlacement":F=l;break}if(s!==F)return{reset:{placement:F}}}return{}}}},YR=new Set(["left","top"]);async function qR(e,t){const{placement:r,platform:n,elements:s}=e,a=await(n.isRTL==null?void 0:n.isRTL(s.floating)),o=xa(r),l=po(r),c=rs(r)==="y",d=YR.has(o)?-1:1,u=a&&c?-1:1,m=id(t,e);let{mainAxis:f,crossAxis:h,alignmentAxis:y}=typeof m=="number"?{mainAxis:m,crossAxis:0,alignmentAxis:null}:{mainAxis:m.mainAxis||0,crossAxis:m.crossAxis||0,alignmentAxis:m.alignmentAxis};return l&&typeof y=="number"&&(h=l==="end"?y*-1:y),c?{x:h*u,y:f*d}:{x:f*d,y:h*u}}const GR=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:s,y:a,placement:o,middlewareData:l}=t,c=await qR(t,e);return o===((r=l.offset)==null?void 0:r.placement)&&(n=l.arrow)!=null&&n.alignmentOffset?{}:{x:s+c.x,y:a+c.y,data:{...c,placement:o}}}}};function Vw(e){const t=Zt(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const s=Rr(e),a=s?e.offsetWidth:r,o=s?e.offsetHeight:n,l=hc(r)!==a||hc(n)!==o;return l&&(r=a,n=o),{width:r,height:n,$:l}}function Hh(e){return yt(e)?e:e.contextElement}function Xs(e){const t=Hh(e);if(!Rr(t))return Tr(1);const r=t.getBoundingClientRect(),{width:n,height:s,$:a}=Vw(t);let o=(a?hc(r.width):r.width)/n,l=(a?hc(r.height):r.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!l||!Number.isFinite(l))&&(l=1),{x:o,y:l}}const KR=Tr(0);function Yw(e){const t=Ot(e);return!Bh()||!t.visualViewport?KR:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function QR(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==Ot(e)?!1:t}function xs(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const s=e.getBoundingClientRect(),a=Hh(e);let o=Tr(1);t&&(n?yt(n)&&(o=Xs(n)):o=Xs(e));const l=QR(a,r,n)?Yw(a):Tr(0);let c=(s.left+l.x)/o.x,d=(s.top+l.y)/o.y,u=s.width/o.x,m=s.height/o.y;if(a){const f=Ot(a),h=n&&yt(n)?Ot(n):n;let y=f,w=Jf(y);for(;w&&n&&h!==y;){const b=Xs(w),g=w.getBoundingClientRect(),x=Zt(w),v=g.left+(w.clientLeft+parseFloat(x.paddingLeft))*b.x,N=g.top+(w.clientTop+parseFloat(x.paddingTop))*b.y;c*=b.x,d*=b.y,u*=b.x,m*=b.y,c+=v,d+=N,y=Ot(w),w=Jf(y)}}return gc({width:u,height:m,x:c,y:d})}function od(e,t){const r=ad(e).scrollLeft;return t?t.left+r:xs(Lr(e)).left+r}function qw(e,t){const r=e.getBoundingClientRect(),n=r.left+t.scrollLeft-od(e,r),s=r.top+t.scrollTop;return{x:n,y:s}}function JR(e){let{elements:t,rect:r,offsetParent:n,strategy:s}=e;const a=s==="fixed",o=Lr(n),l=t?sd(t.floating):!1;if(n===o||l&&a)return r;let c={scrollLeft:0,scrollTop:0},d=Tr(1);const u=Tr(0),m=Rr(n);if((m||!m&&!a)&&((Ra(n)!=="body"||ho(o))&&(c=ad(n)),Rr(n))){const h=xs(n);d=Xs(n),u.x=h.x+n.clientLeft,u.y=h.y+n.clientTop}const f=o&&!m&&!a?qw(o,c):Tr(0);return{width:r.width*d.x,height:r.height*d.y,x:r.x*d.x-c.scrollLeft*d.x+u.x+f.x,y:r.y*d.y-c.scrollTop*d.y+u.y+f.y}}function XR(e){return Array.from(e.getClientRects())}function ZR(e){const t=Lr(e),r=ad(e),n=e.ownerDocument.body,s=ls(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),a=ls(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let o=-r.scrollLeft+od(e);const l=-r.scrollTop;return Zt(n).direction==="rtl"&&(o+=ls(t.clientWidth,n.clientWidth)-s),{width:s,height:a,x:o,y:l}}const I0=25;function eL(e,t){const r=Ot(e),n=Lr(e),s=r.visualViewport;let a=n.clientWidth,o=n.clientHeight,l=0,c=0;if(s){a=s.width,o=s.height;const u=Bh();(!u||u&&t==="fixed")&&(l=s.offsetLeft,c=s.offsetTop)}const d=od(n);if(d<=0){const u=n.ownerDocument,m=u.body,f=getComputedStyle(m),h=u.compatMode==="CSS1Compat"&&parseFloat(f.marginLeft)+parseFloat(f.marginRight)||0,y=Math.abs(n.clientWidth-m.clientWidth-h);y<=I0&&(a-=y)}else d<=I0&&(a+=d);return{width:a,height:o,x:l,y:c}}const tL=new Set(["absolute","fixed"]);function rL(e,t){const r=xs(e,!0,t==="fixed"),n=r.top+e.clientTop,s=r.left+e.clientLeft,a=Rr(e)?Xs(e):Tr(1),o=e.clientWidth*a.x,l=e.clientHeight*a.y,c=s*a.x,d=n*a.y;return{width:o,height:l,x:c,y:d}}function M0(e,t,r){let n;if(t==="viewport")n=eL(e,r);else if(t==="document")n=ZR(Lr(e));else if(yt(t))n=rL(t,r);else{const s=Yw(e);n={x:t.x-s.x,y:t.y-s.y,width:t.width,height:t.height}}return gc(n)}function Gw(e,t){const r=In(e);return r===t||!yt(r)||pa(r)?!1:Zt(r).position==="fixed"||Gw(r,t)}function nL(e,t){const r=t.get(e);if(r)return r;let n=Xi(e,[],!1).filter(l=>yt(l)&&Ra(l)!=="body"),s=null;const a=Zt(e).position==="fixed";let o=a?In(e):e;for(;yt(o)&&!pa(o);){const l=Zt(o),c=Fh(o);!c&&l.position==="fixed"&&(s=null),(a?!c&&!s:!c&&l.position==="static"&&!!s&&tL.has(s.position)||ho(o)&&!c&&Gw(e,o))?n=n.filter(u=>u!==o):s=l,o=In(o)}return t.set(e,n),n}function sL(e){let{element:t,boundary:r,rootBoundary:n,strategy:s}=e;const o=[...r==="clippingAncestors"?sd(t)?[]:nL(t,this._c):[].concat(r),n],l=o[0],c=o.reduce((d,u)=>{const m=M0(t,u,s);return d.top=ls(m.top,d.top),d.right=ga(m.right,d.right),d.bottom=ga(m.bottom,d.bottom),d.left=ls(m.left,d.left),d},M0(t,l,s));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function aL(e){const{width:t,height:r}=Vw(e);return{width:t,height:r}}function iL(e,t,r){const n=Rr(t),s=Lr(t),a=r==="fixed",o=xs(e,!0,a,t);let l={scrollLeft:0,scrollTop:0};const c=Tr(0);function d(){c.x=od(s)}if(n||!n&&!a)if((Ra(t)!=="body"||ho(s))&&(l=ad(t)),n){const h=xs(t,!0,a,t);c.x=h.x+t.clientLeft,c.y=h.y+t.clientTop}else s&&d();a&&!n&&s&&d();const u=s&&!n&&!a?qw(s,l):Tr(0),m=o.left+l.scrollLeft-c.x-u.x,f=o.top+l.scrollTop-c.y-u.y;return{x:m,y:f,width:o.width,height:o.height}}function gu(e){return Zt(e).position==="static"}function O0(e,t){if(!Rr(e)||Zt(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return Lr(e)===r&&(r=r.ownerDocument.body),r}function Kw(e,t){const r=Ot(e);if(sd(e))return r;if(!Rr(e)){let s=In(e);for(;s&&!pa(s);){if(yt(s)&&!gu(s))return s;s=In(s)}return r}let n=O0(e,t);for(;n&&xR(n)&&gu(n);)n=O0(n,t);return n&&pa(n)&&gu(n)&&!Fh(n)?r:n||_R(e)||r}const oL=async function(e){const t=this.getOffsetParent||Kw,r=this.getDimensions,n=await r(e.floating);return{reference:iL(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function lL(e){return Zt(e).direction==="rtl"}const cL={convertOffsetParentRelativeRectToViewportRelativeRect:JR,getDocumentElement:Lr,getClippingRect:sL,getOffsetParent:Kw,getElementRects:oL,getClientRects:XR,getDimensions:aL,getScale:Xs,isElement:yt,isRTL:lL};function Qw(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function dL(e,t){let r=null,n;const s=Lr(e);function a(){var l;clearTimeout(n),(l=r)==null||l.disconnect(),r=null}function o(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),a();const d=e.getBoundingClientRect(),{left:u,top:m,width:f,height:h}=d;if(l||t(),!f||!h)return;const y=Go(m),w=Go(s.clientWidth-(u+f)),b=Go(s.clientHeight-(m+h)),g=Go(u),v={rootMargin:-y+"px "+-w+"px "+-b+"px "+-g+"px",threshold:ls(0,ga(1,c))||1};let N=!0;function _(C){const j=C[0].intersectionRatio;if(j!==c){if(!N)return o();j?o(!1,j):n=setTimeout(()=>{o(!1,1e-7)},1e3)}j===1&&!Qw(d,e.getBoundingClientRect())&&o(),N=!1}try{r=new IntersectionObserver(_,{...v,root:s.ownerDocument})}catch{r=new IntersectionObserver(_,v)}r.observe(e)}return o(!0),a}function uL(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:a=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=n,d=Hh(e),u=s||a?[...d?Xi(d):[],...Xi(t)]:[];u.forEach(g=>{s&&g.addEventListener("scroll",r,{passive:!0}),a&&g.addEventListener("resize",r)});const m=d&&l?dL(d,r):null;let f=-1,h=null;o&&(h=new ResizeObserver(g=>{let[x]=g;x&&x.target===d&&h&&(h.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var v;(v=h)==null||v.observe(t)})),r()}),d&&!c&&h.observe(d),h.observe(t));let y,w=c?xs(e):null;c&&b();function b(){const g=xs(e);w&&!Qw(w,g)&&r(),w=g,y=requestAnimationFrame(b)}return r(),()=>{var g;u.forEach(x=>{s&&x.removeEventListener("scroll",r),a&&x.removeEventListener("resize",r)}),m==null||m(),(g=h)==null||g.disconnect(),h=null,c&&cancelAnimationFrame(y)}}const fL=GR,mL=VR,A0=zR,hL=(e,t,r)=>{const n=new Map,s={platform:cL,...r},a={...s.platform,_c:n};return WR(e,t,{...s,platform:a})};var pL=typeof document<"u",gL=function(){},jl=pL?p.useLayoutEffect:gL;function yc(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,s;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!yc(e[n],t[n]))return!1;return!0}if(s=Object.keys(e),r=s.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,s[n]))return!1;for(n=r;n--!==0;){const a=s[n];if(!(a==="_owner"&&e.$$typeof)&&!yc(e[a],t[a]))return!1}return!0}return e!==e&&t!==t}function Jw(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function $0(e,t){const r=Jw(e);return Math.round(t*r)/r}function xu(e){const t=p.useRef(e);return jl(()=>{t.current=e}),t}function xL(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:s,elements:{reference:a,floating:o}={},transform:l=!0,whileElementsMounted:c,open:d}=e,[u,m]=p.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[f,h]=p.useState(n);yc(f,n)||h(n);const[y,w]=p.useState(null),[b,g]=p.useState(null),x=p.useCallback(E=>{E!==C.current&&(C.current=E,w(E))},[]),v=p.useCallback(E=>{E!==j.current&&(j.current=E,g(E))},[]),N=a||y,_=o||b,C=p.useRef(null),j=p.useRef(null),k=p.useRef(u),S=c!=null,D=xu(c),R=xu(s),P=xu(d),A=p.useCallback(()=>{if(!C.current||!j.current)return;const E={placement:t,strategy:r,middleware:f};R.current&&(E.platform=R.current),hL(C.current,j.current,E).then($=>{const B={...$,isPositioned:P.current!==!1};I.current&&!yc(k.current,B)&&(k.current=B,so.flushSync(()=>{m(B)}))})},[f,t,r,R,P]);jl(()=>{d===!1&&k.current.isPositioned&&(k.current.isPositioned=!1,m(E=>({...E,isPositioned:!1})))},[d]);const I=p.useRef(!1);jl(()=>(I.current=!0,()=>{I.current=!1}),[]),jl(()=>{if(N&&(C.current=N),_&&(j.current=_),N&&_){if(D.current)return D.current(N,_,A);A()}},[N,_,A,D,S]);const L=p.useMemo(()=>({reference:C,floating:j,setReference:x,setFloating:v}),[x,v]),F=p.useMemo(()=>({reference:N,floating:_}),[N,_]),U=p.useMemo(()=>{const E={position:r,left:0,top:0};if(!F.floating)return E;const $=$0(F.floating,u.x),B=$0(F.floating,u.y);return l?{...E,transform:"translate("+$+"px, "+B+"px)",...Jw(F.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:$,top:B}},[r,l,F.floating,u.x,u.y]);return p.useMemo(()=>({...u,update:A,refs:L,elements:F,floatingStyles:U}),[u,A,L,F,U])}const yL=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:s}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?A0({element:n.current,padding:s}).fn(r):{}:n?A0({element:n,padding:s}).fn(r):{}}}},vL=(e,t)=>({...fL(e),options:[e,t]}),bL=(e,t)=>({...mL(e),options:[e,t]}),wL=(e,t)=>({...yL(e),options:[e,t]}),_L={...Dx};let F0=!1,jL=0;const B0=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+jL++;function NL(){const[e,t]=p.useState(()=>F0?B0():void 0);return xc(()=>{e==null&&t(B0())},[]),p.useEffect(()=>{F0=!0},[]),e}const kL=_L.useId,Xw=kL||NL,SL=p.forwardRef(function(t,r){const{context:{placement:n,elements:{floating:s},middlewareData:{arrow:a,shift:o}},width:l=14,height:c=7,tipRadius:d=0,strokeWidth:u=0,staticOffset:m,stroke:f,d:h,style:{transform:y,...w}={},...b}=t,g=Xw(),[x,v]=p.useState(!1);if(xc(()=>{if(!s)return;Zt(s).direction==="rtl"&&v(!0)},[s]),!s)return null;const[N,_]=n.split("-"),C=N==="top"||N==="bottom";let j=m;(C&&o!=null&&o.x||!C&&o!=null&&o.y)&&(j=null);const k=u*2,S=k/2,D=l/2*(d/-8+1),R=c/2*d/4,P=!!h,A=j&&_==="end"?"bottom":"top";let I=j&&_==="end"?"right":"left";j&&x&&(I=_==="end"?"left":"right");const L=(a==null?void 0:a.x)!=null?j||a.x:"",F=(a==null?void 0:a.y)!=null?j||a.y:"",U=h||"M0,0"+(" H"+l)+(" L"+(l-D)+","+(c-R))+(" Q"+l/2+","+c+" "+D+","+(c-R))+" Z",E={top:P?"rotate(180deg)":"",left:P?"rotate(90deg)":"rotate(-90deg)",bottom:P?"":"rotate(180deg)",right:P?"rotate(-90deg)":"rotate(90deg)"}[N];return i.jsxs("svg",{...b,"aria-hidden":!0,ref:r,width:P?l:l+k,height:l,viewBox:"0 0 "+l+" "+(c>l?c:l),style:{position:"absolute",pointerEvents:"none",[I]:L,[A]:F,[N]:C||P?"100%":"calc(100% - "+k/2+"px)",transform:[E,y].filter($=>!!$).join(" "),...w},children:[k>0&&i.jsx("path",{clipPath:"url(#"+g+")",fill:"none",stroke:f,strokeWidth:k+(h?0:1),d:U}),i.jsx("path",{stroke:k&&!h?b.fill:"none",d:U}),i.jsx("clipPath",{id:g,children:i.jsx("rect",{x:-S,y:S*(P?-1:1),width:l+k,height:l})})]})});function CL(){const e=new Map;return{emit(t,r){var n;(n=e.get(t))==null||n.forEach(s=>s(r))},on(t,r){e.has(t)||e.set(t,new Set),e.get(t).add(r)},off(t,r){var n;(n=e.get(t))==null||n.delete(r)}}}const DL=p.createContext(null),EL=p.createContext(null),PL=()=>{var e;return((e=p.useContext(DL))==null?void 0:e.id)||null},TL=()=>p.useContext(EL);function RL(e){const{open:t=!1,onOpenChange:r,elements:n}=e,s=Xw(),a=p.useRef({}),[o]=p.useState(()=>CL()),l=PL()!=null,[c,d]=p.useState(n.reference),u=UR((h,y,w)=>{a.current.openEvent=h?y:void 0,o.emit("openchange",{open:h,event:y,reason:w,nested:l}),r==null||r(h,y,w)}),m=p.useMemo(()=>({setPositionReference:d}),[]),f=p.useMemo(()=>({reference:c||n.reference||null,floating:n.floating||null,domReference:n.reference}),[c,n.reference,n.floating]);return p.useMemo(()=>({dataRef:a,open:t,onOpenChange:u,elements:f,events:o,floatingId:s,refs:m}),[t,u,f,o,s,m])}function LL(e){e===void 0&&(e={});const{nodeId:t}=e,r=RL({...e,elements:{reference:null,floating:null,...e.elements}}),n=e.rootContext||r,s=n.elements,[a,o]=p.useState(null),[l,c]=p.useState(null),u=(s==null?void 0:s.domReference)||a,m=p.useRef(null),f=TL();xc(()=>{u&&(m.current=u)},[u]);const h=xL({...e,elements:{...s,...l&&{reference:l}}}),y=p.useCallback(v=>{const N=yt(v)?{getBoundingClientRect:()=>v.getBoundingClientRect(),getClientRects:()=>v.getClientRects(),contextElement:v}:v;c(N),h.refs.setReference(N)},[h.refs]),w=p.useCallback(v=>{(yt(v)||v===null)&&(m.current=v,o(v)),(yt(h.refs.reference.current)||h.refs.reference.current===null||v!==null&&!yt(v))&&h.refs.setReference(v)},[h.refs]),b=p.useMemo(()=>({...h.refs,setReference:w,setPositionReference:y,domReference:m}),[h.refs,w,y]),g=p.useMemo(()=>({...h.elements,domReference:u}),[h.elements,u]),x=p.useMemo(()=>({...h,...n,refs:b,elements:g,nodeId:t}),[h,b,g,t,n]);return xc(()=>{n.dataRef.current.floatingContext=x;const v=f==null?void 0:f.nodesRef.current.find(N=>N.id===t);v&&(v.context=x)}),p.useMemo(()=>({...h,context:x,refs:b,elements:g}),[h,b,g,x])}/*!
  react-datepicker v8.7.0
  https://github.com/Hacker0x01/react-datepicker
  Released under the MIT License.
*/var Zf=function(t,r){return Zf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(n[a]=s[a])},Zf(t,r)};function it(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Zf(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var he=function(){return he=Object.assign||function(r){for(var n,s=1,a=arguments.length;s<a;s++){n=arguments[s];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])}return r},he.apply(this,arguments)};function Cr(e,t,r){if(r||arguments.length===2)for(var n=0,s=t.length,a;n<s;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}var IL=function(e){var t=e.showTimeSelectOnly,r=t===void 0?!1:t,n=e.showTime,s=n===void 0?!1:n,a=e.className,o=e.children,l=r?"Choose Time":"Choose Date".concat(s?" and Time":"");return O.createElement("div",{className:a,role:"dialog","aria-label":l,"aria-modal":"true"},o)},ML=function(e,t){var r=p.useRef(null),n=p.useRef(e);n.current=e;var s=p.useCallback(function(a){var o,l=a.composed&&a.composedPath&&a.composedPath().find(function(c){return c instanceof Node})||a.target;r.current&&!r.current.contains(l)&&(t&&l instanceof HTMLElement&&l.classList.contains(t)||(o=n.current)===null||o===void 0||o.call(n,a))},[t]);return p.useEffect(function(){return document.addEventListener("mousedown",s),function(){document.removeEventListener("mousedown",s)}},[s]),r},ld=function(e){var t=e.children,r=e.onClickOutside,n=e.className,s=e.containerRef,a=e.style,o=e.ignoreClass,l=ML(r,o);return O.createElement("div",{className:n,style:a,ref:function(c){l.current=c,s&&(s.current=c)}},t)},K;(function(e){e.ArrowUp="ArrowUp",e.ArrowDown="ArrowDown",e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.PageUp="PageUp",e.PageDown="PageDown",e.Home="Home",e.End="End",e.Enter="Enter",e.Space=" ",e.Tab="Tab",e.Escape="Escape",e.Backspace="Backspace",e.X="x"})(K||(K={}));function Zw(){var e=typeof window<"u"?window:globalThis;return e}var go=12;function be(e){if(e==null)return new Date;var t=typeof e=="string"?$h(e):Z(e);return cd(t)?t:new Date}function yu(e,t,r,n,s){s===void 0&&(s=be());for(var a=ya(r)||ya(zh()),o=Array.isArray(t)?t:[t],l=0,c=o;l<c.length;l++){var d=c[l],u=G3(e,d,s,{locale:a,useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0});if(cd(u)&&(!n||e===Re(u,d,r)))return u}return null}function cd(e,t){return dc(e)&&!Sr(e,new Date("1/1/1800"))}function Re(e,t,r){if(r==="en")return Pr(e,t,{useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0});var n=r?ya(r):void 0;return r&&!n&&console.warn('A locale object was not found for the provided string ["'.concat(r,'"].')),n=n||ya(zh()),Pr(e,t,{locale:n,useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0})}function Ut(e,t){var r=t.dateFormat,n=t.locale,s=Array.isArray(r)&&r.length>0?r[0]:r;return e&&Re(e,s,n)||""}var e_=" - ";function OL(e,t,r){if(!e&&!t)return"";var n=e?Ut(e,r):"",s=t?Ut(t,r):"",a=r.rangeSeparator||e_;return"".concat(n).concat(a).concat(s)}function AL(e,t){if(!(e!=null&&e.length))return"";var r=e[0]?Ut(e[0],t):"";if(e.length===1)return r;if(e.length===2&&e[1]){var n=Ut(e[1],t);return"".concat(r,", ").concat(n)}var s=e.length-1;return"".concat(r," (+").concat(s,")")}function vu(e,t){var r=t.hour,n=r===void 0?0:r,s=t.minute,a=s===void 0?0:s,o=t.second,l=o===void 0?0:o;return bl(wl(_l(e,l),a),n)}function $L(e){return Ih(e)}function FL(e,t){return Re(e,"ddd",t)}function Nl(e){return gs(e)}function En(e,t,r){var n=ya(t||zh());return rn(e,{locale:n,weekStartsOn:r})}function Qr(e){return Pw(e)}function li(e){return rd(e)}function U0(e){return qf(e)}function W0(){return gs(be())}function H0(e){return Th(e)}function BL(e){return r5(e)}function UL(e){return Rh(e)}function _r(e,t){return e&&t?X3(e,t):!e&&!t}function xt(e,t){return e&&t?Q3(e,t):!e&&!t}function vc(e,t){return e&&t?J3(e,t):!e&&!t}function me(e,t){return e&&t?KT(e,t):!e&&!t}function ns(e,t){return e&&t?Z5(e,t):!e&&!t}function Qn(e,t,r){var n,s=gs(t),a=Th(r);try{n=Ji(e,{start:s,end:a})}catch{n=!1}return n}function zh(){var e=Zw();return e.__localeId__}function ya(e){if(typeof e=="string"){var t=Zw();return t.__localeData__?t.__localeData__[e]:void 0}else return e}function WL(e,t,r){return t(Re(e,"EEEE",r))}function HL(e,t){return Re(e,"EEEEEE",t)}function zL(e,t){return Re(e,"EEE",t)}function Vh(e,t){return Re(Wt(be(),e),"LLLL",t)}function t_(e,t){return Re(Wt(be(),e),"LLL",t)}function VL(e,t){return Re(Ts(be(),e),"QQQ",t)}function Vt(e,t){var r=t===void 0?{}:t,n=r.minDate,s=r.maxDate,a=r.excludeDates,o=r.excludeDateIntervals,l=r.includeDates,c=r.includeDateIntervals,d=r.filterDate;return xo(e,{minDate:n,maxDate:s})||a&&a.some(function(u){return u instanceof Date?me(e,u):me(e,u.date)})||o&&o.some(function(u){var m=u.start,f=u.end;return Ji(e,{start:m,end:f})})||l&&!l.some(function(u){return me(e,u)})||c&&!c.some(function(u){var m=u.start,f=u.end;return Ji(e,{start:m,end:f})})||d&&!d(be(e))||!1}function Yh(e,t){var r=t===void 0?{}:t,n=r.excludeDates,s=r.excludeDateIntervals;return s&&s.length>0?s.some(function(a){var o=a.start,l=a.end;return Ji(e,{start:o,end:l})}):n&&n.some(function(a){var o;return a instanceof Date?me(e,a):me(e,(o=a.date)!==null&&o!==void 0?o:new Date)})||!1}function r_(e,t){var r=t===void 0?{}:t,n=r.minDate,s=r.maxDate,a=r.excludeDates,o=r.includeDates,l=r.filterDate;return xo(e,{minDate:n?Pw(n):void 0,maxDate:s?Rh(s):void 0})||(a==null?void 0:a.some(function(c){return xt(e,c instanceof Date?c:c.date)}))||o&&!o.some(function(c){return xt(e,c)})||l&&!l(be(e))||!1}function Ko(e,t,r,n){var s=de(e),a=ut(e),o=de(t),l=ut(t),c=de(n);return s===o&&s===c?a<=r&&r<=l:s<o?c===s&&a<=r||c===o&&l>=r||c<o&&c>s:!1}function YL(e,t){var r=t===void 0?{}:t,n=r.minDate,s=r.maxDate,a=r.excludeDates,o=r.includeDates;return xo(e,{minDate:n,maxDate:s})||a&&a.some(function(l){return xt(l instanceof Date?l:l.date,e)})||o&&!o.some(function(l){return xt(l,e)})||!1}function Qo(e,t){var r=t===void 0?{}:t,n=r.minDate,s=r.maxDate,a=r.excludeDates,o=r.includeDates,l=r.filterDate;return xo(e,{minDate:n,maxDate:s})||(a==null?void 0:a.some(function(c){return vc(e,c instanceof Date?c:c.date)}))||o&&!o.some(function(c){return vc(e,c)})||l&&!l(be(e))||!1}function Jo(e,t,r){if(!t||!r||!dc(t)||!dc(r))return!1;var n=de(t),s=de(r);return n<=e&&s>=e}function kl(e,t){var r=t===void 0?{}:t,n=r.minDate,s=r.maxDate,a=r.excludeDates,o=r.includeDates,l=r.filterDate,c=new Date(e,0,1);return xo(c,{minDate:n?rd(n):void 0,maxDate:s?Tw(s):void 0})||(a==null?void 0:a.some(function(d){return _r(c,d instanceof Date?d:d.date)}))||o&&!o.some(function(d){return _r(c,d)})||l&&!l(be(c))||!1}function Xo(e,t,r,n){var s=de(e),a=is(e),o=de(t),l=is(t),c=de(n);return s===o&&s===c?a<=r&&r<=l:s<o?c===s&&a<=r||c===o&&l>=r||c<o&&c>s:!1}function xo(e,t){var r,n=t===void 0?{}:t,s=n.minDate,a=n.maxDate;return(r=s&&ma(e,s)<0||a&&ma(e,a)>0)!==null&&r!==void 0?r:!1}function z0(e,t){return t.some(function(r){return Gr(r)===Gr(e)&&Kr(r)===Kr(e)&&Dn(r)===Dn(e)})}function V0(e,t){var r=t===void 0?{}:t,n=r.excludeTimes,s=r.includeTimes,a=r.filterTime;return n&&z0(e,n)||s&&!z0(e,s)||a&&!a(e)||!1}function Y0(e,t){var r=t.minTime,n=t.maxTime;if(!r||!n)throw new Error("Both minTime and maxTime props required");var s=be();s=bl(s,Gr(e)),s=wl(s,Kr(e)),s=_l(s,Dn(e));var a=be();a=bl(a,Gr(r)),a=wl(a,Kr(r)),a=_l(a,Dn(r));var o=be();o=bl(o,Gr(n)),o=wl(o,Kr(n)),o=_l(o,Dn(n));var l;try{l=!Ji(s,{start:a,end:o})}catch{l=!1}return l}function q0(e,t){var r=t===void 0?{}:t,n=r.minDate,s=r.includeDates,a=os(e,1);return n&&Qi(n,a)>0||s&&s.every(function(o){return Qi(o,a)>0})||!1}function G0(e,t){var r=t===void 0?{}:t,n=r.maxDate,s=r.includeDates,a=fr(e,1);return n&&Qi(a,n)>0||s&&s.every(function(o){return Qi(a,o)>0})||!1}function qL(e,t){var r=t===void 0?{}:t,n=r.minDate,s=r.includeDates,a=rd(e),o=Uw(a,1);return n&&uc(n,o)>0||s&&s.every(function(l){return uc(l,o)>0})||!1}function GL(e,t){var r=t===void 0?{}:t,n=r.maxDate,s=r.includeDates,a=Tw(e),o=Ph(a,1);return n&&uc(o,n)>0||s&&s.every(function(l){return uc(o,l)>0})||!1}function K0(e,t){var r=t===void 0?{}:t,n=r.minDate,s=r.includeDates,a=ha(e,1);return n&&fc(n,a)>0||s&&s.every(function(o){return fc(o,a)>0})||!1}function KL(e,t){var r=t===void 0?{}:t,n=r.minDate,s=r.yearItemNumber,a=s===void 0?go:s,o=li(ha(e,a)),l=Hr(o,a).endPeriod,c=n&&de(n);return c&&c>l||!1}function Q0(e,t){var r=t===void 0?{}:t,n=r.maxDate,s=r.includeDates,a=Yr(e,1);return n&&fc(a,n)>0||s&&s.every(function(o){return fc(a,o)>0})||!1}function QL(e,t){var r=t===void 0?{}:t,n=r.maxDate,s=r.yearItemNumber,a=s===void 0?go:s,o=Yr(e,a),l=Hr(o,a).startPeriod,c=n&&de(n);return c&&c<l||!1}function n_(e){var t=e.minDate,r=e.includeDates;if(r&&t){var n=r.filter(function(s){return ma(s,t)>=0});return w0(n)}else return r?w0(r):t}function s_(e){var t=e.maxDate,r=e.includeDates;if(r&&t){var n=r.filter(function(s){return ma(s,t)<=0});return b0(n)}else return r?b0(r):t}function J0(e,t){var r;e===void 0&&(e=[]),t===void 0&&(t="react-datepicker__day--highlighted");for(var n=new Map,s=0,a=e.length;s<a;s++){var o=e[s];if(qr(o)){var l=Re(o,"MM.dd.yyyy"),c=n.get(l)||[];c.includes(t)||(c.push(t),n.set(l,c))}else if(typeof o=="object"){var d=Object.keys(o),u=(r=d[0])!==null&&r!==void 0?r:"",m=o[u];if(typeof u=="string"&&Array.isArray(m))for(var f=0,h=m.length;f<h;f++){var y=m[f];if(y){var l=Re(y,"MM.dd.yyyy"),c=n.get(l)||[];c.includes(u)||(c.push(u),n.set(l,c))}}}}return n}function JL(e,t){return e.length!==t.length?!1:e.every(function(r,n){return r===t[n]})}function XL(e,t){e===void 0&&(e=[]),t===void 0&&(t="react-datepicker__day--holidays");var r=new Map;return e.forEach(function(n){var s=n.date,a=n.holidayName;if(qr(s)){var o=Re(s,"MM.dd.yyyy"),l=r.get(o)||{className:"",holidayNames:[]};if(!("className"in l&&l.className===t&&JL(l.holidayNames,[a]))){l.className=t;var c=l.holidayNames;l.holidayNames=c?Cr(Cr([],c,!0),[a],!1):[a],r.set(o,l)}}}),r}function ZL(e,t,r,n,s){for(var a=s.length,o=[],l=0;l<a;l++){var c=e,d=s[l];d&&(c=zT(c,Gr(d)),c=Yf(c,Kr(d)),c=qT(c,Dn(d)));var u=Yf(e,(r+1)*n);Ln(c,t)&&Sr(c,u)&&d!=null&&o.push(d)}return o}function X0(e){return e<10?"0".concat(e):"".concat(e)}function Hr(e,t){t===void 0&&(t=go);var r=Math.ceil(de(e)/t)*t,n=r-(t-1);return{startPeriod:n,endPeriod:r}}function eI(e){var t=new Date(e.getFullYear(),e.getMonth(),e.getDate()),r=new Date(e.getFullYear(),e.getMonth(),e.getDate(),24);return Math.round((+r-+t)/36e5)}function Z0(e){var t=e.getSeconds(),r=e.getMilliseconds();return Z(e.getTime()-t*1e3-r)}function tI(e,t){return Z0(e).getTime()===Z0(t).getTime()}function ex(e){if(!qr(e))throw new Error("Invalid date");var t=new Date(e);return t.setHours(0,0,0,0),t}function bu(e,t){if(!qr(e)||!qr(t))throw new Error("Invalid date received");var r=ex(e),n=ex(t);return Sr(r,n)}function a_(e){return e.key===K.Space}var rI=function(e){it(t,e);function t(r){var n=e.call(this,r)||this;return n.inputRef=O.createRef(),n.onTimeChange=function(s){var a,o;n.setState({time:s});var l=n.props.date,c=l instanceof Date&&!isNaN(+l),d=c?l:new Date;if(s!=null&&s.includes(":")){var u=s.split(":"),m=u[0],f=u[1];d.setHours(Number(m)),d.setMinutes(Number(f))}(o=(a=n.props).onChange)===null||o===void 0||o.call(a,d)},n.renderTimeInput=function(){var s=n.state.time,a=n.props,o=a.date,l=a.timeString,c=a.customTimeInput;return c?p.cloneElement(c,{date:o,value:s,onChange:n.onTimeChange}):O.createElement("input",{type:"time",className:"react-datepicker-time__input",placeholder:"Time",name:"time-input",ref:n.inputRef,onClick:function(){var d;(d=n.inputRef.current)===null||d===void 0||d.focus()},required:!0,value:s,onChange:function(d){n.onTimeChange(d.target.value||l)}})},n.state={time:n.props.timeString},n}return t.getDerivedStateFromProps=function(r,n){return r.timeString!==n.time?{time:r.timeString}:null},t.prototype.render=function(){return O.createElement("div",{className:"react-datepicker__input-time-container"},O.createElement("div",{className:"react-datepicker-time__caption"},this.props.timeInputLabel),O.createElement("div",{className:"react-datepicker-time__input-container"},O.createElement("div",{className:"react-datepicker-time__input"},this.renderTimeInput())))},t}(p.Component),nI=function(e){it(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.dayEl=p.createRef(),r.handleClick=function(n){!r.isDisabled()&&r.props.onClick&&r.props.onClick(n)},r.handleMouseEnter=function(n){!r.isDisabled()&&r.props.onMouseEnter&&r.props.onMouseEnter(n)},r.handleOnKeyDown=function(n){var s,a,o=n.key;o===K.Space&&(n.preventDefault(),n.key=K.Enter),(a=(s=r.props).handleOnKeyDown)===null||a===void 0||a.call(s,n)},r.isSameDay=function(n){return me(r.props.day,n)},r.isKeyboardSelected=function(){var n;if(r.props.disabledKeyboardNavigation)return!1;var s=r.props.selectsMultiple?(n=r.props.selectedDates)===null||n===void 0?void 0:n.some(function(o){return r.isSameDayOrWeek(o)}):r.isSameDayOrWeek(r.props.selected),a=r.props.preSelection&&r.isDisabled(r.props.preSelection);return!s&&r.isSameDayOrWeek(r.props.preSelection)&&!a},r.isDisabled=function(n){return n===void 0&&(n=r.props.day),Vt(n,{minDate:r.props.minDate,maxDate:r.props.maxDate,excludeDates:r.props.excludeDates,excludeDateIntervals:r.props.excludeDateIntervals,includeDateIntervals:r.props.includeDateIntervals,includeDates:r.props.includeDates,filterDate:r.props.filterDate})},r.isExcluded=function(){return Yh(r.props.day,{excludeDates:r.props.excludeDates,excludeDateIntervals:r.props.excludeDateIntervals})},r.isStartOfWeek=function(){return me(r.props.day,En(r.props.day,r.props.locale,r.props.calendarStartDay))},r.isSameWeek=function(n){return r.props.showWeekPicker&&me(n,En(r.props.day,r.props.locale,r.props.calendarStartDay))},r.isSameDayOrWeek=function(n){return r.isSameDay(n)||r.isSameWeek(n)},r.getHighLightedClass=function(){var n=r.props,s=n.day,a=n.highlightDates;if(!a)return!1;var o=Re(s,"MM.dd.yyyy");return a.get(o)},r.getHolidaysClass=function(){var n,s=r.props,a=s.day,o=s.holidays;if(!o)return[void 0];var l=Re(a,"MM.dd.yyyy");return o.has(l)?[(n=o.get(l))===null||n===void 0?void 0:n.className]:[void 0]},r.isInRange=function(){var n=r.props,s=n.day,a=n.startDate,o=n.endDate;return!a||!o?!1:Qn(s,a,o)},r.isInSelectingRange=function(){var n,s=r.props,a=s.day,o=s.selectsStart,l=s.selectsEnd,c=s.selectsRange,d=s.selectsDisabledDaysInRange,u=s.startDate,m=s.swapRange,f=s.endDate,h=(n=r.props.selectingDate)!==null&&n!==void 0?n:r.props.preSelection;if(!(o||l||c)||!h||!d&&r.isDisabled())return!1;if(o&&f&&(Sr(h,f)||ns(h,f)))return Qn(a,h,f);if(l&&u&&(Ln(h,u)||ns(h,u)))return Qn(a,u,h);if(c&&u&&!f){if(ns(h,u)||Ln(h,u))return Qn(a,u,h);if(m&&Sr(h,u))return Qn(a,h,u)}return!1},r.isSelectingRangeStart=function(){var n;if(!r.isInSelectingRange())return!1;var s=r.props,a=s.day,o=s.startDate,l=s.selectsStart,c=s.swapRange,d=s.selectsRange,u=(n=r.props.selectingDate)!==null&&n!==void 0?n:r.props.preSelection;return l?me(a,u):d&&c&&o&&u?me(a,Sr(u,o)?u:o):me(a,o)},r.isSelectingRangeEnd=function(){var n;if(!r.isInSelectingRange())return!1;var s=r.props,a=s.day,o=s.endDate,l=s.selectsEnd,c=s.selectsRange,d=s.swapRange,u=s.startDate,m=(n=r.props.selectingDate)!==null&&n!==void 0?n:r.props.preSelection;return l?me(a,m):c&&d&&u&&m?me(a,Sr(m,u)?u:m):c?me(a,m):me(a,o)},r.isRangeStart=function(){var n=r.props,s=n.day,a=n.startDate,o=n.endDate;return!a||!o?!1:me(a,s)},r.isRangeEnd=function(){var n=r.props,s=n.day,a=n.startDate,o=n.endDate;return!a||!o?!1:me(o,s)},r.isWeekend=function(){var n=K5(r.props.day);return n===0||n===6},r.isAfterMonth=function(){return r.props.month!==void 0&&(r.props.month+1)%12===ut(r.props.day)},r.isBeforeMonth=function(){return r.props.month!==void 0&&(ut(r.props.day)+1)%12===r.props.month},r.isCurrentDay=function(){return r.isSameDay(be())},r.isSelected=function(){var n;return r.props.selectsMultiple?(n=r.props.selectedDates)===null||n===void 0?void 0:n.some(function(s){return r.isSameDayOrWeek(s)}):r.isSameDayOrWeek(r.props.selected)},r.getClassNames=function(n){var s=r.props.dayClassName?r.props.dayClassName(n):void 0;return nt("react-datepicker__day",s,"react-datepicker__day--"+FL(r.props.day),{"react-datepicker__day--disabled":r.isDisabled(),"react-datepicker__day--excluded":r.isExcluded(),"react-datepicker__day--selected":r.isSelected(),"react-datepicker__day--keyboard-selected":r.isKeyboardSelected(),"react-datepicker__day--range-start":r.isRangeStart(),"react-datepicker__day--range-end":r.isRangeEnd(),"react-datepicker__day--in-range":r.isInRange(),"react-datepicker__day--in-selecting-range":r.isInSelectingRange(),"react-datepicker__day--selecting-range-start":r.isSelectingRangeStart(),"react-datepicker__day--selecting-range-end":r.isSelectingRangeEnd(),"react-datepicker__day--today":r.isCurrentDay(),"react-datepicker__day--weekend":r.isWeekend(),"react-datepicker__day--outside-month":r.isAfterMonth()||r.isBeforeMonth()},r.getHighLightedClass(),r.getHolidaysClass())},r.getAriaLabel=function(){var n=r.props,s=n.day,a=n.ariaLabelPrefixWhenEnabled,o=a===void 0?"Choose":a,l=n.ariaLabelPrefixWhenDisabled,c=l===void 0?"Not available":l,d=r.isDisabled()||r.isExcluded()?c:o;return"".concat(d," ").concat(Re(s,"PPPP",r.props.locale))},r.getTitle=function(){var n=r.props,s=n.day,a=n.holidays,o=a===void 0?new Map:a,l=n.excludeDates,c=Re(s,"MM.dd.yyyy"),d=[];return o.has(c)&&d.push.apply(d,o.get(c).holidayNames),r.isExcluded()&&d.push(l==null?void 0:l.filter(function(u){return u instanceof Date?me(u,s):me(u==null?void 0:u.date,s)}).map(function(u){if(!(u instanceof Date))return u==null?void 0:u.message})),d.join(", ")},r.getTabIndex=function(){var n=r.props.selected,s=r.props.preSelection,a=!(r.props.showWeekPicker&&(r.props.showWeekNumber||!r.isStartOfWeek()))&&(r.isKeyboardSelected()||r.isSameDay(n)&&me(s,n))?0:-1;return a},r.handleFocusDay=function(){var n;r.shouldFocusDay()&&((n=r.dayEl.current)===null||n===void 0||n.focus({preventScroll:!0}))},r.renderDayContents=function(){return r.props.monthShowsDuplicateDaysEnd&&r.isAfterMonth()||r.props.monthShowsDuplicateDaysStart&&r.isBeforeMonth()?null:r.props.renderDayContents?r.props.renderDayContents(D0(r.props.day),r.props.day):D0(r.props.day)},r.render=function(){return O.createElement("div",{ref:r.dayEl,className:r.getClassNames(r.props.day),onKeyDown:r.handleOnKeyDown,onClick:r.handleClick,onMouseEnter:r.props.usePointerEvent?void 0:r.handleMouseEnter,onPointerEnter:r.props.usePointerEvent?r.handleMouseEnter:void 0,tabIndex:r.getTabIndex(),"aria-label":r.getAriaLabel(),role:"gridcell",title:r.getTitle(),"aria-disabled":r.isDisabled(),"aria-current":r.isCurrentDay()?"date":void 0,"aria-selected":r.isSelected()||r.isInRange()},r.renderDayContents(),r.getTitle()!==""&&O.createElement("span",{className:"overlay"},r.getTitle()))},r}return t.prototype.componentDidMount=function(){this.handleFocusDay()},t.prototype.componentDidUpdate=function(){this.handleFocusDay()},t.prototype.shouldFocusDay=function(){var r=!1;return this.getTabIndex()===0&&this.isSameDay(this.props.preSelection)&&((!document.activeElement||document.activeElement===document.body)&&(r=!0),this.props.inline&&!this.props.shouldFocusDayInline&&(r=!1),this.isDayActiveElement()&&(r=!0),this.isDuplicateDay()&&(r=!1)),r},t.prototype.isDayActiveElement=function(){var r,n,s;return((n=(r=this.props.containerRef)===null||r===void 0?void 0:r.current)===null||n===void 0?void 0:n.contains(document.activeElement))&&((s=document.activeElement)===null||s===void 0?void 0:s.classList.contains("react-datepicker__day"))},t.prototype.isDuplicateDay=function(){return this.props.monthShowsDuplicateDaysEnd&&this.isAfterMonth()||this.props.monthShowsDuplicateDaysStart&&this.isBeforeMonth()},t}(p.Component),sI=function(e){it(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.weekNumberEl=p.createRef(),r.handleClick=function(n){r.props.onClick&&r.props.onClick(n)},r.handleOnKeyDown=function(n){var s,a,o=n.key;o===K.Space&&(n.preventDefault(),n.key=K.Enter),(a=(s=r.props).handleOnKeyDown)===null||a===void 0||a.call(s,n)},r.isKeyboardSelected=function(){return!r.props.disabledKeyboardNavigation&&!me(r.props.date,r.props.selected)&&me(r.props.date,r.props.preSelection)},r.getTabIndex=function(){return r.props.showWeekPicker&&r.props.showWeekNumber&&(r.isKeyboardSelected()||me(r.props.date,r.props.selected)&&me(r.props.preSelection,r.props.selected))?0:-1},r.handleFocusWeekNumber=function(n){var s=!1;r.getTabIndex()===0&&!(n!=null&&n.isInputFocused)&&me(r.props.date,r.props.preSelection)&&((!document.activeElement||document.activeElement===document.body)&&(s=!0),r.props.inline&&!r.props.shouldFocusDayInline&&(s=!1),r.props.containerRef&&r.props.containerRef.current&&r.props.containerRef.current.contains(document.activeElement)&&document.activeElement&&document.activeElement.classList.contains("react-datepicker__week-number")&&(s=!0)),s&&r.weekNumberEl.current&&r.weekNumberEl.current.focus({preventScroll:!0})},r}return Object.defineProperty(t,"defaultProps",{get:function(){return{ariaLabelPrefix:"week "}},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){this.handleFocusWeekNumber()},t.prototype.componentDidUpdate=function(r){this.handleFocusWeekNumber(r)},t.prototype.render=function(){var r=this.props,n=r.weekNumber,s=r.isWeekDisabled,a=r.ariaLabelPrefix,o=a===void 0?t.defaultProps.ariaLabelPrefix:a,l=r.onClick,c={"react-datepicker__week-number":!0,"react-datepicker__week-number--clickable":!!l&&!s,"react-datepicker__week-number--selected":!!l&&me(this.props.date,this.props.selected)};return O.createElement("div",{ref:this.weekNumberEl,className:nt(c),"aria-label":"".concat(o," ").concat(this.props.weekNumber),onClick:this.handleClick,onKeyDown:this.handleOnKeyDown,tabIndex:this.getTabIndex(),role:"gridcell"},n)},t}(p.Component),aI=function(e){it(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.isDisabled=function(n){return Vt(n,{minDate:r.props.minDate,maxDate:r.props.maxDate,excludeDates:r.props.excludeDates,excludeDateIntervals:r.props.excludeDateIntervals,includeDateIntervals:r.props.includeDateIntervals,includeDates:r.props.includeDates,filterDate:r.props.filterDate})},r.handleDayClick=function(n,s){r.props.onDayClick&&r.props.onDayClick(n,s)},r.handleDayMouseEnter=function(n){r.props.onDayMouseEnter&&r.props.onDayMouseEnter(n)},r.handleWeekClick=function(n,s,a){for(var o,l,c,d=new Date(n),u=0;u<7;u++){var m=new Date(n);m.setDate(m.getDate()+u);var f=!r.isDisabled(m);if(f){d=m;break}}typeof r.props.onWeekSelect=="function"&&r.props.onWeekSelect(d,s,a),r.props.showWeekPicker&&r.handleDayClick(d,a),((o=r.props.shouldCloseOnSelect)!==null&&o!==void 0?o:t.defaultProps.shouldCloseOnSelect)&&((c=(l=r.props).setOpen)===null||c===void 0||c.call(l,!1))},r.formatWeekNumber=function(n){return r.props.formatWeekNumber?r.props.formatWeekNumber(n):$L(n)},r.isWeekDisabled=function(){for(var n=r.startOfWeek(),s=cr(n,6),a=new Date(n);a<=s;){if(!r.isDisabled(a))return!1;a=cr(a,1)}return!0},r.renderDays=function(){var n=r.startOfWeek(),s=[],a=r.formatWeekNumber(n);if(r.props.showWeekNumber){var o=r.props.onWeekSelect||r.props.showWeekPicker?r.handleWeekClick.bind(r,n,a):void 0;s.push(O.createElement(sI,he({key:"W"},t.defaultProps,r.props,{weekNumber:a,isWeekDisabled:r.isWeekDisabled(),date:n,onClick:o})))}return s.concat([0,1,2,3,4,5,6].map(function(l){var c=cr(n,l);return O.createElement(nI,he({},t.defaultProps,r.props,{ariaLabelPrefixWhenEnabled:r.props.chooseDayAriaLabelPrefix,ariaLabelPrefixWhenDisabled:r.props.disabledDayAriaLabelPrefix,key:c.valueOf(),day:c,onClick:r.handleDayClick.bind(r,c),onMouseEnter:r.handleDayMouseEnter.bind(r,c)}))}))},r.startOfWeek=function(){return En(r.props.day,r.props.locale,r.props.calendarStartDay)},r.isKeyboardSelected=function(){return!r.props.disabledKeyboardNavigation&&!me(r.startOfWeek(),r.props.selected)&&me(r.startOfWeek(),r.props.preSelection)},r}return Object.defineProperty(t,"defaultProps",{get:function(){return{shouldCloseOnSelect:!0}},enumerable:!1,configurable:!0}),t.prototype.render=function(){var r={"react-datepicker__week":!0,"react-datepicker__week--selected":me(this.startOfWeek(),this.props.selected),"react-datepicker__week--keyboard-selected":this.isKeyboardSelected()},n=this.props.weekClassName?this.props.weekClassName(this.startOfWeek()):void 0;return O.createElement("div",{className:nt(r,n),role:"row"},this.renderDays())},t}(p.Component),Ja,iI=6,Zs={TWO_COLUMNS:"two_columns",THREE_COLUMNS:"three_columns",FOUR_COLUMNS:"four_columns"},wu=(Ja={},Ja[Zs.TWO_COLUMNS]={grid:[[0,1],[2,3],[4,5],[6,7],[8,9],[10,11]],verticalNavigationOffset:2},Ja[Zs.THREE_COLUMNS]={grid:[[0,1,2],[3,4,5],[6,7,8],[9,10,11]],verticalNavigationOffset:3},Ja[Zs.FOUR_COLUMNS]={grid:[[0,1,2,3],[4,5,6,7],[8,9,10,11]],verticalNavigationOffset:4},Ja),Zo=1;function tx(e,t){return e?Zs.FOUR_COLUMNS:t?Zs.TWO_COLUMNS:Zs.THREE_COLUMNS}var oI=function(e){it(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.MONTH_REFS=Cr([],Array(12),!0).map(function(){return p.createRef()}),r.QUARTER_REFS=Cr([],Array(4),!0).map(function(){return p.createRef()}),r.isDisabled=function(n){return Vt(n,{minDate:r.props.minDate,maxDate:r.props.maxDate,excludeDates:r.props.excludeDates,excludeDateIntervals:r.props.excludeDateIntervals,includeDateIntervals:r.props.includeDateIntervals,includeDates:r.props.includeDates,filterDate:r.props.filterDate})},r.isExcluded=function(n){return Yh(n,{excludeDates:r.props.excludeDates,excludeDateIntervals:r.props.excludeDateIntervals})},r.handleDayClick=function(n,s){var a,o;(o=(a=r.props).onDayClick)===null||o===void 0||o.call(a,n,s,r.props.orderInDisplay)},r.handleDayMouseEnter=function(n){var s,a;(a=(s=r.props).onDayMouseEnter)===null||a===void 0||a.call(s,n)},r.handleMouseLeave=function(){var n,s;(s=(n=r.props).onMouseLeave)===null||s===void 0||s.call(n)},r.isRangeStartMonth=function(n){var s=r.props,a=s.day,o=s.startDate,l=s.endDate;return!o||!l?!1:xt(Wt(a,n),o)},r.isRangeStartQuarter=function(n){var s=r.props,a=s.day,o=s.startDate,l=s.endDate;return!o||!l?!1:vc(Ts(a,n),o)},r.isRangeEndMonth=function(n){var s=r.props,a=s.day,o=s.startDate,l=s.endDate;return!o||!l?!1:xt(Wt(a,n),l)},r.isRangeEndQuarter=function(n){var s=r.props,a=s.day,o=s.startDate,l=s.endDate;return!o||!l?!1:vc(Ts(a,n),l)},r.isInSelectingRangeMonth=function(n){var s,a=r.props,o=a.day,l=a.selectsStart,c=a.selectsEnd,d=a.selectsRange,u=a.startDate,m=a.endDate,f=(s=r.props.selectingDate)!==null&&s!==void 0?s:r.props.preSelection;return!(l||c||d)||!f?!1:l&&m?Ko(f,m,n,o):c&&u||d&&u&&!m?Ko(u,f,n,o):!1},r.isSelectingMonthRangeStart=function(n){var s;if(!r.isInSelectingRangeMonth(n))return!1;var a=r.props,o=a.day,l=a.startDate,c=a.selectsStart,d=Wt(o,n),u=(s=r.props.selectingDate)!==null&&s!==void 0?s:r.props.preSelection;return c?xt(d,u):xt(d,l)},r.isSelectingMonthRangeEnd=function(n){var s;if(!r.isInSelectingRangeMonth(n))return!1;var a=r.props,o=a.day,l=a.endDate,c=a.selectsEnd,d=a.selectsRange,u=Wt(o,n),m=(s=r.props.selectingDate)!==null&&s!==void 0?s:r.props.preSelection;return c||d?xt(u,m):xt(u,l)},r.isInSelectingRangeQuarter=function(n){var s,a=r.props,o=a.day,l=a.selectsStart,c=a.selectsEnd,d=a.selectsRange,u=a.startDate,m=a.endDate,f=(s=r.props.selectingDate)!==null&&s!==void 0?s:r.props.preSelection;return!(l||c||d)||!f?!1:l&&m?Xo(f,m,n,o):c&&u||d&&u&&!m?Xo(u,f,n,o):!1},r.isWeekInMonth=function(n){var s=r.props.day,a=cr(n,6);return xt(n,s)||xt(a,s)},r.isCurrentMonth=function(n,s){return de(n)===de(be())&&s===ut(be())},r.isCurrentQuarter=function(n,s){return de(n)===de(be())&&s===is(be())},r.isSelectedMonth=function(n,s,a){return ut(a)===s&&de(n)===de(a)},r.isSelectMonthInList=function(n,s,a){return a.some(function(o){return r.isSelectedMonth(n,s,o)})},r.isSelectedQuarter=function(n,s,a){return is(n)===s&&de(n)===de(a)},r.isMonthSelected=function(){var n=r.props,s=n.day,a=n.selected,o=n.selectedDates,l=n.selectsMultiple,c=ut(s);return l?o==null?void 0:o.some(function(d){return r.isSelectedMonth(s,c,d)}):!!a&&r.isSelectedMonth(s,c,a)},r.renderWeeks=function(){for(var n=[],s=r.props.fixedHeight,a=0,o=!1,l=En(Qr(r.props.day),r.props.locale,r.props.calendarStartDay),c=function(y){return r.props.showWeekPicker?En(y,r.props.locale,r.props.calendarStartDay):r.props.preSelection},d=function(y){return r.props.showWeekPicker?En(y,r.props.locale,r.props.calendarStartDay):r.props.selected},u=r.props.selected?d(r.props.selected):void 0,m=r.props.preSelection?c(r.props.preSelection):void 0;n.push(O.createElement(aI,he({},r.props,{ariaLabelPrefix:r.props.weekAriaLabelPrefix,key:a,day:l,month:ut(r.props.day),onDayClick:r.handleDayClick,onDayMouseEnter:r.handleDayMouseEnter,selected:u,preSelection:m,showWeekNumber:r.props.showWeekNumbers}))),!o;){a++,l=cc(l,1);var f=s&&a>=iI,h=!s&&!r.isWeekInMonth(l);if(f||h)if(r.props.peekNextMonth)o=!0;else break}return n},r.onMonthClick=function(n,s){var a=r.isMonthDisabledForLabelDate(s),o=a.isDisabled,l=a.labelDate;o||r.handleDayClick(Qr(l),n)},r.onMonthMouseEnter=function(n){var s=r.isMonthDisabledForLabelDate(n),a=s.isDisabled,o=s.labelDate;a||r.handleDayMouseEnter(Qr(o))},r.handleMonthNavigation=function(n,s){var a,o,l,c;(o=(a=r.props).setPreSelection)===null||o===void 0||o.call(a,s),(c=(l=r.MONTH_REFS[n])===null||l===void 0?void 0:l.current)===null||c===void 0||c.focus()},r.handleKeyboardNavigation=function(n,s,a){var o,l=r.props,c=l.selected,d=l.preSelection,u=l.setPreSelection,m=l.minDate,f=l.maxDate,h=l.showFourColumnMonthYearPicker,y=l.showTwoColumnMonthYearPicker;if(d){var w=tx(h,y),b=r.getVerticalOffset(w),g=(o=wu[w])===null||o===void 0?void 0:o.grid,x=function(j,k,S){var D,R,P=k,A=S;switch(j){case K.ArrowRight:P=fr(k,Zo),A=S===11?0:S+Zo;break;case K.ArrowLeft:P=os(k,Zo),A=S===0?11:S-Zo;break;case K.ArrowUp:P=os(k,b),A=!((D=g==null?void 0:g[0])===null||D===void 0)&&D.includes(S)?S+12-b:S-b;break;case K.ArrowDown:P=fr(k,b),A=!((R=g==null?void 0:g[g.length-1])===null||R===void 0)&&R.includes(S)?S-12+b:S+b;break}return{newCalculatedDate:P,newCalculatedMonth:A}},v=function(j,k,S){for(var D=40,R=j,P=!1,A=0,I=x(R,k,S),L=I.newCalculatedDate,F=I.newCalculatedMonth;!P;){if(A>=D){L=k,F=S;break}if(m&&L<m){R=K.ArrowRight;var U=x(R,L,F);L=U.newCalculatedDate,F=U.newCalculatedMonth}if(f&&L>f){R=K.ArrowLeft;var U=x(R,L,F);L=U.newCalculatedDate,F=U.newCalculatedMonth}if(YL(L,r.props)){var U=x(R,L,F);L=U.newCalculatedDate,F=U.newCalculatedMonth}else P=!0;A++}return{newCalculatedDate:L,newCalculatedMonth:F}};if(s===K.Enter){r.isMonthDisabled(a)||(r.onMonthClick(n,a),u==null||u(c));return}var N=v(s,d,a),_=N.newCalculatedDate,C=N.newCalculatedMonth;switch(s){case K.ArrowRight:case K.ArrowLeft:case K.ArrowUp:case K.ArrowDown:r.handleMonthNavigation(C,_);break}}},r.getVerticalOffset=function(n){var s,a;return(a=(s=wu[n])===null||s===void 0?void 0:s.verticalNavigationOffset)!==null&&a!==void 0?a:0},r.onMonthKeyDown=function(n,s){var a=r.props,o=a.disabledKeyboardNavigation,l=a.handleOnMonthKeyDown,c=n.key;c!==K.Tab&&n.preventDefault(),o||r.handleKeyboardNavigation(n,c,s),l&&l(n)},r.onQuarterClick=function(n,s){var a=Ts(r.props.day,s);Qo(a,r.props)||r.handleDayClick(U0(a),n)},r.onQuarterMouseEnter=function(n){var s=Ts(r.props.day,n);Qo(s,r.props)||r.handleDayMouseEnter(U0(s))},r.handleQuarterNavigation=function(n,s){var a,o,l,c;r.isDisabled(s)||r.isExcluded(s)||((o=(a=r.props).setPreSelection)===null||o===void 0||o.call(a,s),(c=(l=r.QUARTER_REFS[n-1])===null||l===void 0?void 0:l.current)===null||c===void 0||c.focus())},r.onQuarterKeyDown=function(n,s){var a,o,l=n.key;if(!r.props.disabledKeyboardNavigation)switch(l){case K.Enter:r.onQuarterClick(n,s),(o=(a=r.props).setPreSelection)===null||o===void 0||o.call(a,r.props.selected);break;case K.ArrowRight:if(!r.props.preSelection)break;r.handleQuarterNavigation(s===4?1:s+1,Ph(r.props.preSelection,1));break;case K.ArrowLeft:if(!r.props.preSelection)break;r.handleQuarterNavigation(s===1?4:s-1,Uw(r.props.preSelection,1));break}},r.isMonthDisabledForLabelDate=function(n){var s,a=r.props,o=a.day,l=a.minDate,c=a.maxDate,d=a.excludeDates,u=a.includeDates,m=Wt(o,n);return{isDisabled:(s=(l||c||d||u)&&r_(m,r.props))!==null&&s!==void 0?s:!1,labelDate:m}},r.isMonthDisabled=function(n){var s=r.isMonthDisabledForLabelDate(n).isDisabled;return s},r.getMonthClassNames=function(n){var s=r.props,a=s.day,o=s.startDate,l=s.endDate,c=s.preSelection,d=s.monthClassName,u=d?d(Wt(a,n)):void 0,m=r.getSelection();return nt("react-datepicker__month-text","react-datepicker__month-".concat(n),u,{"react-datepicker__month-text--disabled":r.isMonthDisabled(n),"react-datepicker__month-text--selected":m?r.isSelectMonthInList(a,n,m):void 0,"react-datepicker__month-text--keyboard-selected":!r.props.disabledKeyboardNavigation&&c&&r.isSelectedMonth(a,n,c)&&!r.isMonthSelected()&&!r.isMonthDisabled(n),"react-datepicker__month-text--in-selecting-range":r.isInSelectingRangeMonth(n),"react-datepicker__month-text--in-range":o&&l?Ko(o,l,n,a):void 0,"react-datepicker__month-text--range-start":r.isRangeStartMonth(n),"react-datepicker__month-text--range-end":r.isRangeEndMonth(n),"react-datepicker__month-text--selecting-range-start":r.isSelectingMonthRangeStart(n),"react-datepicker__month-text--selecting-range-end":r.isSelectingMonthRangeEnd(n),"react-datepicker__month-text--today":r.isCurrentMonth(a,n)})},r.getTabIndex=function(n){if(r.props.preSelection==null)return"-1";var s=ut(r.props.preSelection),a=r.isMonthDisabledForLabelDate(s).isDisabled,o=n===s&&!(a||r.props.disabledKeyboardNavigation)?"0":"-1";return o},r.getQuarterTabIndex=function(n){if(r.props.preSelection==null)return"-1";var s=is(r.props.preSelection),a=Qo(r.props.day,r.props),o=n===s&&!(a||r.props.disabledKeyboardNavigation)?"0":"-1";return o},r.getAriaLabel=function(n){var s=r.props,a=s.chooseDayAriaLabelPrefix,o=a===void 0?"Choose":a,l=s.disabledDayAriaLabelPrefix,c=l===void 0?"Not available":l,d=s.day,u=s.locale,m=Wt(d,n),f=r.isDisabled(m)||r.isExcluded(m)?c:o;return"".concat(f," ").concat(Re(m,"MMMM yyyy",u))},r.getQuarterClassNames=function(n){var s=r.props,a=s.day,o=s.startDate,l=s.endDate,c=s.selected,d=s.minDate,u=s.maxDate,m=s.excludeDates,f=s.includeDates,h=s.filterDate,y=s.preSelection,w=s.disabledKeyboardNavigation,b=(d||u||m||f||h)&&Qo(Ts(a,n),r.props);return nt("react-datepicker__quarter-text","react-datepicker__quarter-".concat(n),{"react-datepicker__quarter-text--disabled":b,"react-datepicker__quarter-text--selected":c?r.isSelectedQuarter(a,n,c):void 0,"react-datepicker__quarter-text--keyboard-selected":!w&&y&&r.isSelectedQuarter(a,n,y)&&!b,"react-datepicker__quarter-text--in-selecting-range":r.isInSelectingRangeQuarter(n),"react-datepicker__quarter-text--in-range":o&&l?Xo(o,l,n,a):void 0,"react-datepicker__quarter-text--range-start":r.isRangeStartQuarter(n),"react-datepicker__quarter-text--range-end":r.isRangeEndQuarter(n),"react-datepicker__quarter-text--today":r.isCurrentQuarter(a,n)})},r.getMonthContent=function(n){var s=r.props,a=s.showFullMonthYearPicker,o=s.renderMonthContent,l=s.locale,c=s.day,d=t_(n,l),u=Vh(n,l);return o?o(n,d,u,c):a?u:d},r.getQuarterContent=function(n){var s,a=r.props,o=a.renderQuarterContent,l=a.locale,c=VL(n,l);return(s=o==null?void 0:o(n,c))!==null&&s!==void 0?s:c},r.renderMonths=function(){var n,s=r.props,a=s.showTwoColumnMonthYearPicker,o=s.showFourColumnMonthYearPicker,l=s.day,c=s.selected,d=(n=wu[tx(o,a)])===null||n===void 0?void 0:n.grid;return d==null?void 0:d.map(function(u,m){return O.createElement("div",{className:"react-datepicker__month-wrapper",key:m},u.map(function(f,h){return O.createElement("div",{ref:r.MONTH_REFS[f],key:h,onClick:function(y){r.onMonthClick(y,f)},onKeyDown:function(y){a_(y)&&(y.preventDefault(),y.key=K.Enter),r.onMonthKeyDown(y,f)},onMouseEnter:r.props.usePointerEvent?void 0:function(){return r.onMonthMouseEnter(f)},onPointerEnter:r.props.usePointerEvent?function(){return r.onMonthMouseEnter(f)}:void 0,tabIndex:Number(r.getTabIndex(f)),className:r.getMonthClassNames(f),"aria-disabled":r.isMonthDisabled(f),role:"option","aria-label":r.getAriaLabel(f),"aria-current":r.isCurrentMonth(l,f)?"date":void 0,"aria-selected":c?r.isSelectedMonth(l,f,c):void 0},r.getMonthContent(f))}))})},r.renderQuarters=function(){var n=r.props,s=n.day,a=n.selected,o=[1,2,3,4];return O.createElement("div",{className:"react-datepicker__quarter-wrapper"},o.map(function(l,c){return O.createElement("div",{key:c,ref:r.QUARTER_REFS[c],role:"option",onClick:function(d){r.onQuarterClick(d,l)},onKeyDown:function(d){r.onQuarterKeyDown(d,l)},onMouseEnter:r.props.usePointerEvent?void 0:function(){return r.onQuarterMouseEnter(l)},onPointerEnter:r.props.usePointerEvent?function(){return r.onQuarterMouseEnter(l)}:void 0,className:r.getQuarterClassNames(l),"aria-selected":a?r.isSelectedQuarter(s,l,a):void 0,tabIndex:Number(r.getQuarterTabIndex(l)),"aria-current":r.isCurrentQuarter(s,l)?"date":void 0},r.getQuarterContent(l))}))},r.getClassNames=function(){var n=r.props,s=n.selectingDate,a=n.selectsStart,o=n.selectsEnd,l=n.showMonthYearPicker,c=n.showQuarterYearPicker,d=n.showWeekPicker;return nt("react-datepicker__month",{"react-datepicker__month--selecting-range":s&&(a||o)},{"react-datepicker__monthPicker":l},{"react-datepicker__quarterPicker":c},{"react-datepicker__weekPicker":d})},r}return t.prototype.getSelection=function(){var r=this.props,n=r.selected,s=r.selectedDates,a=r.selectsMultiple;if(a)return s;if(n)return[n]},t.prototype.render=function(){var r=this.props,n=r.showMonthYearPicker,s=r.showQuarterYearPicker,a=r.day,o=r.ariaLabelPrefix,l=o===void 0?"Month ":o,c=l?l.trim()+" ":"",d=n||s;return d?O.createElement("div",{className:this.getClassNames(),onMouseLeave:this.props.usePointerEvent?void 0:this.handleMouseLeave,onPointerLeave:this.props.usePointerEvent?this.handleMouseLeave:void 0,"aria-label":"".concat(c).concat(Re(a,"MMMM, yyyy",this.props.locale)),role:"listbox"},n?this.renderMonths():this.renderQuarters()):O.createElement("div",{role:"table"},this.props.dayNamesHeader&&O.createElement("div",{role:"rowgroup"},this.props.dayNamesHeader),O.createElement("div",{className:this.getClassNames(),onMouseLeave:this.props.usePointerEvent?void 0:this.handleMouseLeave,onPointerLeave:this.props.usePointerEvent?this.handleMouseLeave:void 0,"aria-label":"".concat(c).concat(Re(a,"MMMM, yyyy",this.props.locale)),role:"rowgroup"},this.renderWeeks()))},t}(p.Component),lI=function(e){it(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.monthOptionButtonsRef={},r.isSelectedMonth=function(n){return r.props.month===n},r.handleOptionKeyDown=function(n,s){var a;switch(s.key){case"Enter":s.preventDefault(),r.onChange(n);break;case"Escape":s.preventDefault(),r.props.onCancel();break;case"ArrowUp":case"ArrowDown":{s.preventDefault();var o=(n+(s.key==="ArrowUp"?-1:1)+r.props.monthNames.length)%r.props.monthNames.length;(a=r.monthOptionButtonsRef[o])===null||a===void 0||a.focus();break}}},r.renderOptions=function(){return r.monthOptionButtonsRef={},r.props.monthNames.map(function(n,s){return O.createElement("div",{ref:function(a){r.monthOptionButtonsRef[s]=a,r.isSelectedMonth(s)&&(a==null||a.focus())},role:"button",tabIndex:0,className:r.isSelectedMonth(s)?"react-datepicker__month-option react-datepicker__month-option--selected_month":"react-datepicker__month-option",key:n,onClick:r.onChange.bind(r,s),onKeyDown:r.handleOptionKeyDown.bind(r,s),"aria-selected":r.isSelectedMonth(s)?"true":void 0},r.isSelectedMonth(s)?O.createElement("span",{className:"react-datepicker__month-option--selected"},""):"",n)})},r.onChange=function(n){return r.props.onChange(n)},r.handleClickOutside=function(){return r.props.onCancel()},r}return t.prototype.render=function(){return O.createElement(ld,{className:"react-datepicker__month-dropdown",onClickOutside:this.handleClickOutside},this.renderOptions())},t}(p.Component),cI=function(e){it(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.state={dropdownVisible:!1},r.renderSelectOptions=function(n){return n.map(function(s,a){return O.createElement("option",{key:s,value:a},s)})},r.renderSelectMode=function(n){return O.createElement("select",{value:r.props.month,className:"react-datepicker__month-select",onChange:function(s){return r.onChange(parseInt(s.target.value))}},r.renderSelectOptions(n))},r.renderReadView=function(n,s){return O.createElement("button",{key:"read",type:"button",style:{visibility:n?"visible":"hidden"},className:"react-datepicker__month-read-view",onClick:r.toggleDropdown},O.createElement("span",{className:"react-datepicker__month-read-view--down-arrow"}),O.createElement("span",{className:"react-datepicker__month-read-view--selected-month"},s[r.props.month]))},r.renderDropdown=function(n){return O.createElement(lI,he({key:"dropdown"},r.props,{monthNames:n,onChange:r.onChange,onCancel:r.toggleDropdown}))},r.renderScrollMode=function(n){var s=r.state.dropdownVisible,a=[r.renderReadView(!s,n)];return s&&a.unshift(r.renderDropdown(n)),a},r.onChange=function(n){r.toggleDropdown(),n!==r.props.month&&r.props.onChange(n)},r.toggleDropdown=function(){return r.setState({dropdownVisible:!r.state.dropdownVisible})},r}return t.prototype.render=function(){var r=this,n=[0,1,2,3,4,5,6,7,8,9,10,11].map(this.props.useShortMonthInDropdown?function(a){return t_(a,r.props.locale)}:function(a){return Vh(a,r.props.locale)}),s;switch(this.props.dropdownMode){case"scroll":s=this.renderScrollMode(n);break;case"select":s=this.renderSelectMode(n);break}return O.createElement("div",{className:"react-datepicker__month-dropdown-container react-datepicker__month-dropdown-container--".concat(this.props.dropdownMode)},s)},t}(p.Component);function dI(e,t){for(var r=[],n=Qr(e),s=Qr(t);!Ln(n,s);)r.push(be(n)),n=fr(n,1);return r}var uI=function(e){it(t,e);function t(r){var n=e.call(this,r)||this;return n.renderOptions=function(){return n.state.monthYearsList.map(function(s){var a=Qf(s),o=_r(n.props.date,s)&&xt(n.props.date,s);return O.createElement("div",{className:o?"react-datepicker__month-year-option--selected_month-year":"react-datepicker__month-year-option",key:a,onClick:n.onChange.bind(n,a),"aria-selected":o?"true":void 0},o?O.createElement("span",{className:"react-datepicker__month-year-option--selected"},""):"",Re(s,n.props.dateFormat,n.props.locale))})},n.onChange=function(s){return n.props.onChange(s)},n.handleClickOutside=function(){n.props.onCancel()},n.state={monthYearsList:dI(n.props.minDate,n.props.maxDate)},n}return t.prototype.render=function(){var r=nt({"react-datepicker__month-year-dropdown":!0,"react-datepicker__month-year-dropdown--scrollable":this.props.scrollableMonthYearDropdown});return O.createElement(ld,{className:r,onClickOutside:this.handleClickOutside},this.renderOptions())},t}(p.Component),fI=function(e){it(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.state={dropdownVisible:!1},r.renderSelectOptions=function(){for(var n=Qr(r.props.minDate),s=Qr(r.props.maxDate),a=[];!Ln(n,s);){var o=Qf(n);a.push(O.createElement("option",{key:o,value:o},Re(n,r.props.dateFormat,r.props.locale))),n=fr(n,1)}return a},r.onSelectChange=function(n){r.onChange(parseInt(n.target.value))},r.renderSelectMode=function(){return O.createElement("select",{value:Qf(Qr(r.props.date)),className:"react-datepicker__month-year-select",onChange:r.onSelectChange},r.renderSelectOptions())},r.renderReadView=function(n){var s=Re(r.props.date,r.props.dateFormat,r.props.locale);return O.createElement("div",{key:"read",style:{visibility:n?"visible":"hidden"},className:"react-datepicker__month-year-read-view",onClick:r.toggleDropdown},O.createElement("span",{className:"react-datepicker__month-year-read-view--down-arrow"}),O.createElement("span",{className:"react-datepicker__month-year-read-view--selected-month-year"},s))},r.renderDropdown=function(){return O.createElement(uI,he({key:"dropdown"},r.props,{onChange:r.onChange,onCancel:r.toggleDropdown}))},r.renderScrollMode=function(){var n=r.state.dropdownVisible,s=[r.renderReadView(!n)];return n&&s.unshift(r.renderDropdown()),s},r.onChange=function(n){r.toggleDropdown();var s=be(n);_r(r.props.date,s)&&xt(r.props.date,s)||r.props.onChange(s)},r.toggleDropdown=function(){return r.setState({dropdownVisible:!r.state.dropdownVisible})},r}return t.prototype.render=function(){var r;switch(this.props.dropdownMode){case"scroll":r=this.renderScrollMode();break;case"select":r=this.renderSelectMode();break}return O.createElement("div",{className:"react-datepicker__month-year-dropdown-container react-datepicker__month-year-dropdown-container--".concat(this.props.dropdownMode)},r)},t}(p.Component),mI=function(e){it(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.state={height:null},r.scrollToTheSelectedTime=function(){requestAnimationFrame(function(){var n,s,a;r.list&&(r.list.scrollTop=(a=r.centerLi&&t.calcCenterPosition(r.props.monthRef?r.props.monthRef.clientHeight-((s=(n=r.header)===null||n===void 0?void 0:n.clientHeight)!==null&&s!==void 0?s:0):r.list.clientHeight,r.centerLi))!==null&&a!==void 0?a:0)})},r.handleClick=function(n){var s,a;(r.props.minTime||r.props.maxTime)&&Y0(n,r.props)||(r.props.excludeTimes||r.props.includeTimes||r.props.filterTime)&&V0(n,r.props)||(a=(s=r.props).onChange)===null||a===void 0||a.call(s,n)},r.isSelectedTime=function(n){return r.props.selected&&tI(r.props.selected,n)},r.isDisabledTime=function(n){return(r.props.minTime||r.props.maxTime)&&Y0(n,r.props)||(r.props.excludeTimes||r.props.includeTimes||r.props.filterTime)&&V0(n,r.props)},r.liClasses=function(n){var s,a=["react-datepicker__time-list-item",r.props.timeClassName?r.props.timeClassName(n):void 0];return r.isSelectedTime(n)&&a.push("react-datepicker__time-list-item--selected"),r.isDisabledTime(n)&&a.push("react-datepicker__time-list-item--disabled"),r.props.injectTimes&&(Gr(n)*3600+Kr(n)*60+Dn(n))%(((s=r.props.intervals)!==null&&s!==void 0?s:t.defaultProps.intervals)*60)!==0&&a.push("react-datepicker__time-list-item--injected"),a.join(" ")},r.handleOnKeyDown=function(n,s){var a,o;n.key===K.Space&&(n.preventDefault(),n.key=K.Enter),(n.key===K.ArrowUp||n.key===K.ArrowLeft)&&n.target instanceof HTMLElement&&n.target.previousSibling&&(n.preventDefault(),n.target.previousSibling instanceof HTMLElement&&n.target.previousSibling.focus()),(n.key===K.ArrowDown||n.key===K.ArrowRight)&&n.target instanceof HTMLElement&&n.target.nextSibling&&(n.preventDefault(),n.target.nextSibling instanceof HTMLElement&&n.target.nextSibling.focus()),n.key===K.Enter&&r.handleClick(s),(o=(a=r.props).handleOnKeyDown)===null||o===void 0||o.call(a,n)},r.renderTimes=function(){for(var n,s=[],a=typeof r.props.format=="string"?r.props.format:"p",o=(n=r.props.intervals)!==null&&n!==void 0?n:t.defaultProps.intervals,l=r.props.selected||r.props.openToDate||be(),c=Nl(l),d=r.props.injectTimes&&r.props.injectTimes.sort(function(b,g){return b.getTime()-g.getTime()}),u=60*eI(l),m=u/o,f=0;f<m;f++){var h=Yf(c,f*o);if(s.push(h),d){var y=ZL(c,h,f,o,d);s=s.concat(y)}}var w=s.reduce(function(b,g){return g.getTime()<=l.getTime()?g:b},s[0]);return s.map(function(b){return O.createElement("li",{key:b.valueOf(),onClick:r.handleClick.bind(r,b),className:r.liClasses(b),ref:function(g){b===w&&(r.centerLi=g)},onKeyDown:function(g){r.handleOnKeyDown(g,b)},tabIndex:b===w?0:-1,role:"option","aria-selected":r.isSelectedTime(b)?"true":void 0,"aria-disabled":r.isDisabledTime(b)?"true":void 0},Re(b,a,r.props.locale))})},r.renderTimeCaption=function(){return r.props.showTimeCaption===!1?O.createElement(O.Fragment,null):O.createElement("div",{className:"react-datepicker__header react-datepicker__header--time ".concat(r.props.showTimeSelectOnly?"react-datepicker__header--time--only":""),ref:function(n){r.header=n}},O.createElement("div",{className:"react-datepicker-time__header"},r.props.timeCaption))},r}return Object.defineProperty(t,"defaultProps",{get:function(){return{intervals:30,todayButton:null,timeCaption:"Time",showTimeCaption:!0}},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){this.scrollToTheSelectedTime(),this.observeDatePickerHeightChanges()},t.prototype.componentWillUnmount=function(){var r;(r=this.resizeObserver)===null||r===void 0||r.disconnect()},t.prototype.observeDatePickerHeightChanges=function(){var r=this,n=this.props.monthRef;this.updateContainerHeight(),n&&(this.resizeObserver=new ResizeObserver(function(){r.updateContainerHeight()}),this.resizeObserver.observe(n))},t.prototype.updateContainerHeight=function(){this.props.monthRef&&this.header&&this.setState({height:this.props.monthRef.clientHeight-this.header.clientHeight})},t.prototype.render=function(){var r=this,n,s=this.state.height;return O.createElement("div",{className:"react-datepicker__time-container ".concat(((n=this.props.todayButton)!==null&&n!==void 0?n:t.defaultProps.todayButton)?"react-datepicker__time-container--with-today-button":"")},this.renderTimeCaption(),O.createElement("div",{className:"react-datepicker__time"},O.createElement("div",{className:"react-datepicker__time-box"},O.createElement("ul",{className:"react-datepicker__time-list",ref:function(a){r.list=a},style:s?{height:s}:{},role:"listbox","aria-label":this.props.timeCaption},this.renderTimes()))))},t.calcCenterPosition=function(r,n){return n.offsetTop-(r/2-n.clientHeight/2)},t}(p.Component),rx=3,hI=function(e){it(t,e);function t(r){var n=e.call(this,r)||this;return n.YEAR_REFS=Cr([],Array(n.props.yearItemNumber),!0).map(function(){return p.createRef()}),n.isDisabled=function(s){return Vt(s,{minDate:n.props.minDate,maxDate:n.props.maxDate,excludeDates:n.props.excludeDates,includeDates:n.props.includeDates,filterDate:n.props.filterDate})},n.isExcluded=function(s){return Yh(s,{excludeDates:n.props.excludeDates})},n.selectingDate=function(){var s;return(s=n.props.selectingDate)!==null&&s!==void 0?s:n.props.preSelection},n.updateFocusOnPaginate=function(s){var a=function(){var o,l;(l=(o=n.YEAR_REFS[s])===null||o===void 0?void 0:o.current)===null||l===void 0||l.focus()};window.requestAnimationFrame(a)},n.handleYearClick=function(s,a){n.props.onDayClick&&n.props.onDayClick(s,a)},n.handleYearNavigation=function(s,a){var o,l,c,d,u=n.props,m=u.date,f=u.yearItemNumber;if(!(m===void 0||f===void 0)){var h=Hr(m,f).startPeriod;n.isDisabled(a)||n.isExcluded(a)||((l=(o=n.props).setPreSelection)===null||l===void 0||l.call(o,a),s-h<0?n.updateFocusOnPaginate(f-(h-s)):s-h>=f?n.updateFocusOnPaginate(Math.abs(f-(s-h))):(d=(c=n.YEAR_REFS[s-h])===null||c===void 0?void 0:c.current)===null||d===void 0||d.focus())}},n.isSameDay=function(s,a){return me(s,a)},n.isCurrentYear=function(s){return s===de(be())},n.isRangeStart=function(s){return n.props.startDate&&n.props.endDate&&_r(wr(be(),s),n.props.startDate)},n.isRangeEnd=function(s){return n.props.startDate&&n.props.endDate&&_r(wr(be(),s),n.props.endDate)},n.isInRange=function(s){return Jo(s,n.props.startDate,n.props.endDate)},n.isInSelectingRange=function(s){var a=n.props,o=a.selectsStart,l=a.selectsEnd,c=a.selectsRange,d=a.startDate,u=a.endDate;return!(o||l||c)||!n.selectingDate()?!1:o&&u?Jo(s,n.selectingDate(),u):l&&d||c&&d&&!u?Jo(s,d,n.selectingDate()):!1},n.isSelectingRangeStart=function(s){var a;if(!n.isInSelectingRange(s))return!1;var o=n.props,l=o.startDate,c=o.selectsStart,d=wr(be(),s);return c?_r(d,(a=n.selectingDate())!==null&&a!==void 0?a:null):_r(d,l??null)},n.isSelectingRangeEnd=function(s){var a;if(!n.isInSelectingRange(s))return!1;var o=n.props,l=o.endDate,c=o.selectsEnd,d=o.selectsRange,u=wr(be(),s);return c||d?_r(u,(a=n.selectingDate())!==null&&a!==void 0?a:null):_r(u,l??null)},n.isKeyboardSelected=function(s){if(!(n.props.disabledKeyboardNavigation||n.props.date===void 0||n.props.preSelection==null)){var a=n.props,o=a.minDate,l=a.maxDate,c=a.excludeDates,d=a.includeDates,u=a.filterDate,m=a.selected,f=li(wr(n.props.date,s)),h=(o||l||c||d||u)&&kl(s,n.props),y=!!m&&me(f,li(m)),w=me(f,li(n.props.preSelection));return!n.props.inline&&!y&&w&&!h}},n.isSelectedYear=function(s){var a=n.props,o=a.selectsMultiple,l=a.selected,c=a.selectedDates;return o?c==null?void 0:c.some(function(d){return s===de(d)}):!!l&&s===de(l)},n.onYearClick=function(s,a){var o=n.props.date;o!==void 0&&n.handleYearClick(li(wr(o,a)),s)},n.onYearKeyDown=function(s,a){var o,l,c=s.key,d=n.props,u=d.date,m=d.yearItemNumber,f=d.handleOnKeyDown;if(c!==K.Tab&&s.preventDefault(),!n.props.disabledKeyboardNavigation)switch(c){case K.Enter:if(n.props.selected==null)break;n.onYearClick(s,a),(l=(o=n.props).setPreSelection)===null||l===void 0||l.call(o,n.props.selected);break;case K.ArrowRight:if(n.props.preSelection==null)break;n.handleYearNavigation(a+1,Yr(n.props.preSelection,1));break;case K.ArrowLeft:if(n.props.preSelection==null)break;n.handleYearNavigation(a-1,ha(n.props.preSelection,1));break;case K.ArrowUp:{if(u===void 0||m===void 0||n.props.preSelection==null)break;var h=Hr(u,m).startPeriod,y=rx,w=a-y;if(w<h){var b=m%y;a>=h&&a<h+b?y=b:y+=b,w=a-y}n.handleYearNavigation(w,ha(n.props.preSelection,y));break}case K.ArrowDown:{if(u===void 0||m===void 0||n.props.preSelection==null)break;var g=Hr(u,m).endPeriod,y=rx,w=a+y;if(w>g){var b=m%y;a<=g&&a>g-b?y=b:y+=b,w=a+y}n.handleYearNavigation(w,Yr(n.props.preSelection,y));break}}f&&f(s)},n.getYearClassNames=function(s){var a=n.props,o=a.date,l=a.minDate,c=a.maxDate,d=a.excludeDates,u=a.includeDates,m=a.filterDate,f=a.yearClassName;return nt("react-datepicker__year-text","react-datepicker__year-".concat(s),o?f==null?void 0:f(wr(o,s)):void 0,{"react-datepicker__year-text--selected":n.isSelectedYear(s),"react-datepicker__year-text--disabled":(l||c||d||u||m)&&kl(s,n.props),"react-datepicker__year-text--keyboard-selected":n.isKeyboardSelected(s),"react-datepicker__year-text--range-start":n.isRangeStart(s),"react-datepicker__year-text--range-end":n.isRangeEnd(s),"react-datepicker__year-text--in-range":n.isInRange(s),"react-datepicker__year-text--in-selecting-range":n.isInSelectingRange(s),"react-datepicker__year-text--selecting-range-start":n.isSelectingRangeStart(s),"react-datepicker__year-text--selecting-range-end":n.isSelectingRangeEnd(s),"react-datepicker__year-text--today":n.isCurrentYear(s)})},n.getYearTabIndex=function(s){if(n.props.disabledKeyboardNavigation||n.props.preSelection==null)return"-1";var a=de(n.props.preSelection),o=kl(s,n.props);return s===a&&!o?"0":"-1"},n.getYearContent=function(s){return n.props.renderYearContent?n.props.renderYearContent(s):s},n}return t.prototype.render=function(){var r=this,n=[],s=this.props,a=s.date,o=s.yearItemNumber,l=s.onYearMouseEnter,c=s.onYearMouseLeave;if(a===void 0)return null;for(var d=Hr(a,o),u=d.startPeriod,m=d.endPeriod,f=function(w){n.push(O.createElement("div",{ref:h.YEAR_REFS[w-u],onClick:function(b){r.onYearClick(b,w)},onKeyDown:function(b){a_(b)&&(b.preventDefault(),b.key=K.Enter),r.onYearKeyDown(b,w)},tabIndex:Number(h.getYearTabIndex(w)),className:h.getYearClassNames(w),onMouseEnter:h.props.usePointerEvent?void 0:function(b){return l(b,w)},onPointerEnter:h.props.usePointerEvent?function(b){return l(b,w)}:void 0,onMouseLeave:h.props.usePointerEvent?void 0:function(b){return c(b,w)},onPointerLeave:h.props.usePointerEvent?function(b){return c(b,w)}:void 0,key:w,"aria-current":h.isCurrentYear(w)?"date":void 0},h.getYearContent(w)))},h=this,y=u;y<=m;y++)f(y);return O.createElement("div",{className:"react-datepicker__year"},O.createElement("div",{className:"react-datepicker__year-wrapper",onMouseLeave:this.props.usePointerEvent?void 0:this.props.clearSelectingDate,onPointerLeave:this.props.usePointerEvent?this.props.clearSelectingDate:void 0},n))},t}(p.Component);function pI(e,t,r,n){for(var s=[],a=0;a<2*t+1;a++){var o=e+t-a,l=!0;r&&(l=de(r)<=o),n&&l&&(l=de(n)>=o),l&&s.push(o)}return s}var gI=function(e){it(t,e);function t(r){var n=e.call(this,r)||this;n.yearOptionButtonsRef={},n.handleOptionKeyDown=function(l,c){var d;switch(c.key){case"Enter":c.preventDefault(),n.onChange(l);break;case"Escape":c.preventDefault(),n.props.onCancel();break;case"ArrowUp":case"ArrowDown":{c.preventDefault();var u=l+(c.key==="ArrowUp"?1:-1);n.yearOptionButtonsRef[u]&&((d=n.yearOptionButtonsRef[u])===null||d===void 0||d.focus());break}}},n.renderOptions=function(){n.yearOptionButtonsRef={};var l=n.props.year,c=n.state.yearsList.map(function(m){return O.createElement("div",{ref:function(f){n.yearOptionButtonsRef[m]=f,m===l&&(f==null||f.focus())},role:"button",tabIndex:0,className:l===m?"react-datepicker__year-option react-datepicker__year-option--selected_year":"react-datepicker__year-option",key:m,onClick:n.onChange.bind(n,m),onKeyDown:n.handleOptionKeyDown.bind(n,m),"aria-selected":l===m?"true":void 0},l===m?O.createElement("span",{className:"react-datepicker__year-option--selected"},""):"",m)}),d=n.props.minDate?de(n.props.minDate):null,u=n.props.maxDate?de(n.props.maxDate):null;return(!u||!n.state.yearsList.find(function(m){return m===u}))&&c.unshift(O.createElement("div",{className:"react-datepicker__year-option",key:"upcoming",onClick:n.incrementYears},O.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-upcoming"}))),(!d||!n.state.yearsList.find(function(m){return m===d}))&&c.push(O.createElement("div",{className:"react-datepicker__year-option",key:"previous",onClick:n.decrementYears},O.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-previous"}))),c},n.onChange=function(l){n.props.onChange(l)},n.handleClickOutside=function(){n.props.onCancel()},n.shiftYears=function(l){var c=n.state.yearsList.map(function(d){return d+l});n.setState({yearsList:c})},n.incrementYears=function(){return n.shiftYears(1)},n.decrementYears=function(){return n.shiftYears(-1)};var s=r.yearDropdownItemNumber,a=r.scrollableYearDropdown,o=s||(a?10:5);return n.state={yearsList:pI(n.props.year,o,n.props.minDate,n.props.maxDate)},n.dropdownRef=p.createRef(),n}return t.prototype.componentDidMount=function(){var r=this.dropdownRef.current;if(r){var n=r.children?Array.from(r.children):null,s=n?n.find(function(a){return a.ariaSelected}):null;r.scrollTop=s&&s instanceof HTMLElement?s.offsetTop+(s.clientHeight-r.clientHeight)/2:(r.scrollHeight-r.clientHeight)/2}},t.prototype.render=function(){var r=nt({"react-datepicker__year-dropdown":!0,"react-datepicker__year-dropdown--scrollable":this.props.scrollableYearDropdown});return O.createElement(ld,{className:r,containerRef:this.dropdownRef,onClickOutside:this.handleClickOutside},this.renderOptions())},t}(p.Component),xI=function(e){it(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.state={dropdownVisible:!1},r.renderSelectOptions=function(){for(var n=r.props.minDate?de(r.props.minDate):1900,s=r.props.maxDate?de(r.props.maxDate):2100,a=[],o=n;o<=s;o++)a.push(O.createElement("option",{key:o,value:o},o));return a},r.onSelectChange=function(n){r.onChange(parseInt(n.target.value))},r.renderSelectMode=function(){return O.createElement("select",{value:r.props.year,className:"react-datepicker__year-select",onChange:r.onSelectChange},r.renderSelectOptions())},r.renderReadView=function(n){return O.createElement("button",{key:"read",type:"button",style:{visibility:n?"visible":"hidden"},className:"react-datepicker__year-read-view",onClick:r.toggleDropdown},O.createElement("span",{className:"react-datepicker__year-read-view--down-arrow"}),O.createElement("span",{className:"react-datepicker__year-read-view--selected-year"},r.props.year))},r.renderDropdown=function(){return O.createElement(gI,he({key:"dropdown"},r.props,{onChange:r.onChange,onCancel:r.toggleDropdown}))},r.renderScrollMode=function(){var n=r.state.dropdownVisible,s=[r.renderReadView(!n)];return n&&s.unshift(r.renderDropdown()),s},r.onChange=function(n){r.toggleDropdown(),n!==r.props.year&&r.props.onChange(n)},r.toggleDropdown=function(n){r.setState({dropdownVisible:!r.state.dropdownVisible},function(){r.props.adjustDateOnChange&&r.handleYearChange(r.props.date,n)})},r.handleYearChange=function(n,s){var a;(a=r.onSelect)===null||a===void 0||a.call(r,n,s),r.setOpen()},r.onSelect=function(n,s){var a,o;(o=(a=r.props).onSelect)===null||o===void 0||o.call(a,n,s)},r.setOpen=function(){var n,s;(s=(n=r.props).setOpen)===null||s===void 0||s.call(n,!0)},r}return t.prototype.render=function(){var r;switch(this.props.dropdownMode){case"scroll":r=this.renderScrollMode();break;case"select":r=this.renderSelectMode();break}return O.createElement("div",{className:"react-datepicker__year-dropdown-container react-datepicker__year-dropdown-container--".concat(this.props.dropdownMode)},r)},t}(p.Component),yI=["react-datepicker__year-select","react-datepicker__month-select","react-datepicker__month-year-select"],i_="react-datepicker-ignore-onclickoutside",vI=function(e){var t=(e.className||"").split(/\s+/);return yI.some(function(r){return t.indexOf(r)>=0})},bI=function(e){it(t,e);function t(r){var n=e.call(this,r)||this;return n.monthContainer=void 0,n.handleClickOutside=function(s){n.props.onClickOutside(s)},n.setClickOutsideRef=function(){return n.containerRef.current},n.handleDropdownFocus=function(s){var a,o;vI(s.target)&&((o=(a=n.props).onDropdownFocus)===null||o===void 0||o.call(a,s))},n.getDateInView=function(){var s=n.props,a=s.preSelection,o=s.selected,l=s.openToDate,c=n_(n.props),d=s_(n.props),u=be(),m=l||o||a;return m||(c&&Sr(u,c)?c:d&&Ln(u,d)?d:u)},n.increaseMonth=function(){n.setState(function(s){var a=s.date;return{date:fr(a,1)}},function(){return n.handleMonthChange(n.state.date)})},n.decreaseMonth=function(){n.setState(function(s){var a=s.date;return{date:os(a,1)}},function(){return n.handleMonthChange(n.state.date)})},n.handleDayClick=function(s,a,o){n.props.onSelect(s,a,o),n.props.setPreSelection&&n.props.setPreSelection(s)},n.handleDayMouseEnter=function(s){n.setState({selectingDate:s}),n.props.onDayMouseEnter&&n.props.onDayMouseEnter(s)},n.handleMonthMouseLeave=function(){n.setState({selectingDate:void 0}),n.props.onMonthMouseLeave&&n.props.onMonthMouseLeave()},n.handleYearMouseEnter=function(s,a){n.setState({selectingDate:wr(be(),a)}),n.props.onYearMouseEnter&&n.props.onYearMouseEnter(s,a)},n.handleYearMouseLeave=function(s,a){n.props.onYearMouseLeave&&n.props.onYearMouseLeave(s,a)},n.handleYearChange=function(s){var a,o,l,c;(o=(a=n.props).onYearChange)===null||o===void 0||o.call(a,s),n.setState({isRenderAriaLiveMessage:!0}),n.props.adjustDateOnChange&&(n.props.onSelect(s),(c=(l=n.props).setOpen)===null||c===void 0||c.call(l,!0)),n.props.setPreSelection&&n.props.setPreSelection(s)},n.getEnabledPreSelectionDateForMonth=function(s){if(!Vt(s,n.props))return s;for(var a=Qr(s),o=UL(s),l=QT(o,a),c=null,d=0;d<=l;d++){var u=cr(a,d);if(!Vt(u,n.props)){c=u;break}}return c},n.handleMonthChange=function(s){var a,o,l,c=(a=n.getEnabledPreSelectionDateForMonth(s))!==null&&a!==void 0?a:s;n.handleCustomMonthChange(c),n.props.adjustDateOnChange&&(n.props.onSelect(c),(l=(o=n.props).setOpen)===null||l===void 0||l.call(o,!0)),n.props.setPreSelection&&n.props.setPreSelection(c)},n.handleCustomMonthChange=function(s){var a,o;(o=(a=n.props).onMonthChange)===null||o===void 0||o.call(a,s),n.setState({isRenderAriaLiveMessage:!0})},n.handleMonthYearChange=function(s){n.handleYearChange(s),n.handleMonthChange(s)},n.changeYear=function(s){n.setState(function(a){var o=a.date;return{date:wr(o,Number(s))}},function(){return n.handleYearChange(n.state.date)})},n.changeMonth=function(s){n.setState(function(a){var o=a.date;return{date:Wt(o,Number(s))}},function(){return n.handleMonthChange(n.state.date)})},n.changeMonthYear=function(s){n.setState(function(a){var o=a.date;return{date:wr(Wt(o,ut(s)),de(s))}},function(){return n.handleMonthYearChange(n.state.date)})},n.header=function(s){s===void 0&&(s=n.state.date);var a=En(s,n.props.locale,n.props.calendarStartDay),o=[];return n.props.showWeekNumbers&&o.push(O.createElement("div",{key:"W",className:"react-datepicker__day-name",role:"columnheader"},O.createElement("span",{className:"react-datepicker__sr-only"},"Week number"),O.createElement("span",{"aria-hidden":"true"},n.props.weekLabel||"#"))),o.concat([0,1,2,3,4,5,6].map(function(l){var c=cr(a,l),d=n.formatWeekday(c,n.props.locale),u=n.props.weekDayClassName?n.props.weekDayClassName(c):void 0;return O.createElement("div",{key:l,role:"columnheader",className:nt("react-datepicker__day-name",u)},O.createElement("span",{className:"react-datepicker__sr-only"},Re(c,"EEEE",n.props.locale)),O.createElement("span",{"aria-hidden":"true"},d))}))},n.formatWeekday=function(s,a){return n.props.formatWeekDay?WL(s,n.props.formatWeekDay,a):n.props.useWeekdaysShort?zL(s,a):HL(s,a)},n.decreaseYear=function(){n.setState(function(s){var a,o=s.date;return{date:ha(o,n.props.showYearPicker?(a=n.props.yearItemNumber)!==null&&a!==void 0?a:t.defaultProps.yearItemNumber:1)}},function(){return n.handleYearChange(n.state.date)})},n.clearSelectingDate=function(){n.setState({selectingDate:void 0})},n.renderPreviousButton=function(){var s,a,o;if(!n.props.renderCustomHeader){var l=(s=n.props.monthsShown)!==null&&s!==void 0?s:t.defaultProps.monthsShown,c=n.props.showPreviousMonths?l-1:0,d=(a=n.props.monthSelectedIn)!==null&&a!==void 0?a:c,u=os(n.state.date,d),m;switch(!0){case n.props.showMonthYearPicker:m=K0(n.state.date,n.props);break;case n.props.showYearPicker:m=KL(n.state.date,n.props);break;case n.props.showQuarterYearPicker:m=qL(n.state.date,n.props);break;default:m=q0(u,n.props);break}if(!(!((o=n.props.forceShowMonthNavigation)!==null&&o!==void 0?o:t.defaultProps.forceShowMonthNavigation)&&!n.props.showDisabledMonthNavigation&&m||n.props.showTimeSelectOnly)){var f=["react-datepicker__navigation-icon","react-datepicker__navigation-icon--previous"],h=["react-datepicker__navigation","react-datepicker__navigation--previous"],y=n.decreaseMonth;(n.props.showMonthYearPicker||n.props.showQuarterYearPicker||n.props.showYearPicker)&&(y=n.decreaseYear),m&&n.props.showDisabledMonthNavigation&&(h.push("react-datepicker__navigation--previous--disabled"),y=void 0);var w=n.props.showMonthYearPicker||n.props.showQuarterYearPicker||n.props.showYearPicker,b=n.props,g=b.previousMonthButtonLabel,x=g===void 0?t.defaultProps.previousMonthButtonLabel:g,v=b.previousYearButtonLabel,N=v===void 0?t.defaultProps.previousYearButtonLabel:v,_=n.props,C=_.previousMonthAriaLabel,j=C===void 0?typeof x=="string"?x:"Previous Month":C,k=_.previousYearAriaLabel,S=k===void 0?typeof N=="string"?N:"Previous Year":k;return O.createElement("button",{type:"button",className:h.join(" "),onClick:y,onKeyDown:n.props.handleOnKeyDown,"aria-label":w?S:j},O.createElement("span",{className:f.join(" ")},w?N:x))}}},n.increaseYear=function(){n.setState(function(s){var a,o=s.date;return{date:Yr(o,n.props.showYearPicker?(a=n.props.yearItemNumber)!==null&&a!==void 0?a:t.defaultProps.yearItemNumber:1)}},function(){return n.handleYearChange(n.state.date)})},n.renderNextButton=function(){var s;if(!n.props.renderCustomHeader){var a;switch(!0){case n.props.showMonthYearPicker:a=Q0(n.state.date,n.props);break;case n.props.showYearPicker:a=QL(n.state.date,n.props);break;case n.props.showQuarterYearPicker:a=GL(n.state.date,n.props);break;default:a=G0(n.state.date,n.props);break}if(!(!((s=n.props.forceShowMonthNavigation)!==null&&s!==void 0?s:t.defaultProps.forceShowMonthNavigation)&&!n.props.showDisabledMonthNavigation&&a||n.props.showTimeSelectOnly)){var o=["react-datepicker__navigation","react-datepicker__navigation--next"],l=["react-datepicker__navigation-icon","react-datepicker__navigation-icon--next"];n.props.showTimeSelect&&o.push("react-datepicker__navigation--next--with-time"),n.props.todayButton&&o.push("react-datepicker__navigation--next--with-today-button");var c=n.increaseMonth;(n.props.showMonthYearPicker||n.props.showQuarterYearPicker||n.props.showYearPicker)&&(c=n.increaseYear),a&&n.props.showDisabledMonthNavigation&&(o.push("react-datepicker__navigation--next--disabled"),c=void 0);var d=n.props.showMonthYearPicker||n.props.showQuarterYearPicker||n.props.showYearPicker,u=n.props,m=u.nextMonthButtonLabel,f=m===void 0?t.defaultProps.nextMonthButtonLabel:m,h=u.nextYearButtonLabel,y=h===void 0?t.defaultProps.nextYearButtonLabel:h,w=n.props,b=w.nextMonthAriaLabel,g=b===void 0?typeof f=="string"?f:"Next Month":b,x=w.nextYearAriaLabel,v=x===void 0?typeof y=="string"?y:"Next Year":x;return O.createElement("button",{type:"button",className:o.join(" "),onClick:c,onKeyDown:n.props.handleOnKeyDown,"aria-label":d?v:g},O.createElement("span",{className:l.join(" ")},d?y:f))}}},n.renderCurrentMonth=function(s){s===void 0&&(s=n.state.date);var a=["react-datepicker__current-month"];return n.props.showYearDropdown&&a.push("react-datepicker__current-month--hasYearDropdown"),n.props.showMonthDropdown&&a.push("react-datepicker__current-month--hasMonthDropdown"),n.props.showMonthYearDropdown&&a.push("react-datepicker__current-month--hasMonthYearDropdown"),O.createElement("h2",{className:a.join(" ")},Re(s,n.props.dateFormat,n.props.locale))},n.renderYearDropdown=function(s){if(s===void 0&&(s=!1),!(!n.props.showYearDropdown||s))return O.createElement(xI,he({},t.defaultProps,n.props,{date:n.state.date,onChange:n.changeYear,year:de(n.state.date)}))},n.renderMonthDropdown=function(s){if(s===void 0&&(s=!1),!(!n.props.showMonthDropdown||s))return O.createElement(cI,he({},t.defaultProps,n.props,{month:ut(n.state.date),onChange:n.changeMonth}))},n.renderMonthYearDropdown=function(s){if(s===void 0&&(s=!1),!(!n.props.showMonthYearDropdown||s))return O.createElement(fI,he({},t.defaultProps,n.props,{date:n.state.date,onChange:n.changeMonthYear}))},n.handleTodayButtonClick=function(s){n.props.onSelect(W0(),s),n.props.setPreSelection&&n.props.setPreSelection(W0())},n.renderTodayButton=function(){if(!(!n.props.todayButton||n.props.showTimeSelectOnly))return O.createElement("div",{className:"react-datepicker__today-button",onClick:n.handleTodayButtonClick},n.props.todayButton)},n.renderDayNamesHeader=function(s){return O.createElement("div",{className:"react-datepicker__day-names",role:"row"},n.header(s))},n.renderDefaultHeader=function(s){var a=s.monthDate,o=s.i;return O.createElement("div",{className:"react-datepicker__header ".concat(n.props.showTimeSelect?"react-datepicker__header--has-time-select":"")},n.renderCurrentMonth(a),O.createElement("div",{className:"react-datepicker__header__dropdown react-datepicker__header__dropdown--".concat(n.props.dropdownMode),onFocus:n.handleDropdownFocus},n.renderMonthDropdown(o!==0),n.renderMonthYearDropdown(o!==0),n.renderYearDropdown(o!==0)))},n.renderCustomHeader=function(s){var a,o,l=s.monthDate,c=s.i;if(n.props.showTimeSelect&&!n.state.monthContainer||n.props.showTimeSelectOnly)return null;var d=n.props,u=d.showYearPicker,m=d.yearItemNumber,f;if(u){var h=Hr(l,m),y=h.startPeriod,w=h.endPeriod;f={startYear:y,endYear:w}}var b=q0(n.state.date,n.props),g=G0(n.state.date,n.props),x=K0(n.state.date,n.props),v=Q0(n.state.date,n.props);return O.createElement("div",{className:"react-datepicker__header react-datepicker__header--custom",onFocus:n.props.onDropdownFocus},(o=(a=n.props).renderCustomHeader)===null||o===void 0?void 0:o.call(a,he(he(he({},n.state),u&&{visibleYearsRange:f}),{customHeaderCount:c,monthDate:l,changeMonth:n.changeMonth,changeYear:n.changeYear,decreaseMonth:n.decreaseMonth,increaseMonth:n.increaseMonth,decreaseYear:n.decreaseYear,increaseYear:n.increaseYear,prevMonthButtonDisabled:b,nextMonthButtonDisabled:g,prevYearButtonDisabled:x,nextYearButtonDisabled:v})))},n.renderYearHeader=function(s){var a=s.monthDate,o=n.props,l=o.showYearPicker,c=o.yearItemNumber,d=c===void 0?t.defaultProps.yearItemNumber:c,u=Hr(a,d),m=u.startPeriod,f=u.endPeriod;return O.createElement("div",{className:"react-datepicker__header react-datepicker-year-header"},l?"".concat(m," - ").concat(f):de(a))},n.renderHeader=function(s){var a=s.monthDate,o=s.i,l=o===void 0?0:o,c={monthDate:a,i:l};switch(!0){case n.props.renderCustomHeader!==void 0:return n.renderCustomHeader(c);case(n.props.showMonthYearPicker||n.props.showQuarterYearPicker||n.props.showYearPicker):return n.renderYearHeader(c);default:return n.renderDefaultHeader(c)}},n.renderMonths=function(){var s,a;if(!(n.props.showTimeSelectOnly||n.props.showYearPicker)){for(var o=[],l=(s=n.props.monthsShown)!==null&&s!==void 0?s:t.defaultProps.monthsShown,c=n.props.showPreviousMonths?l-1:0,d=n.props.showMonthYearPicker||n.props.showQuarterYearPicker?Yr(n.state.date,c):os(n.state.date,c),u=(a=n.props.monthSelectedIn)!==null&&a!==void 0?a:c,m=0;m<l;++m){var f=m-u+c,h=n.props.showMonthYearPicker||n.props.showQuarterYearPicker?Yr(d,f):fr(d,f),y="month-".concat(m),w=m<l-1,b=m>0;o.push(O.createElement("div",{key:y,ref:function(g){n.monthContainer=g??void 0},className:"react-datepicker__month-container"},n.renderHeader({monthDate:h,i:m}),O.createElement(oI,he({},t.defaultProps,n.props,{containerRef:n.containerRef,ariaLabelPrefix:n.props.monthAriaLabelPrefix,day:h,onDayClick:n.handleDayClick,handleOnKeyDown:n.props.handleOnDayKeyDown,handleOnMonthKeyDown:n.props.handleOnKeyDown,onDayMouseEnter:n.handleDayMouseEnter,onMouseLeave:n.handleMonthMouseLeave,orderInDisplay:m,selectingDate:n.state.selectingDate,monthShowsDuplicateDaysEnd:w,monthShowsDuplicateDaysStart:b,dayNamesHeader:n.renderDayNamesHeader(h)}))))}return o}},n.renderYears=function(){if(!n.props.showTimeSelectOnly&&n.props.showYearPicker)return O.createElement("div",{className:"react-datepicker__year--container"},n.renderHeader({monthDate:n.state.date}),O.createElement(hI,he({},t.defaultProps,n.props,{selectingDate:n.state.selectingDate,date:n.state.date,onDayClick:n.handleDayClick,clearSelectingDate:n.clearSelectingDate,onYearMouseEnter:n.handleYearMouseEnter,onYearMouseLeave:n.handleYearMouseLeave})))},n.renderTimeSection=function(){if(n.props.showTimeSelect&&(n.state.monthContainer||n.props.showTimeSelectOnly))return O.createElement(mI,he({},t.defaultProps,n.props,{onChange:n.props.onTimeChange,format:n.props.timeFormat,intervals:n.props.timeIntervals,monthRef:n.state.monthContainer}))},n.renderInputTimeSection=function(){var s=n.props.selected?new Date(n.props.selected):void 0,a=s&&cd(s)&&!!n.props.selected,o=a?"".concat(X0(s.getHours()),":").concat(X0(s.getMinutes())):"";if(n.props.showTimeInput)return O.createElement(rI,he({},t.defaultProps,n.props,{date:s,timeString:o,onChange:n.props.onTimeChange}))},n.renderAriaLiveRegion=function(){var s,a=Hr(n.state.date,(s=n.props.yearItemNumber)!==null&&s!==void 0?s:t.defaultProps.yearItemNumber),o=a.startPeriod,l=a.endPeriod,c;return n.props.showYearPicker?c="".concat(o," - ").concat(l):n.props.showMonthYearPicker||n.props.showQuarterYearPicker?c=de(n.state.date):c="".concat(Vh(ut(n.state.date),n.props.locale)," ").concat(de(n.state.date)),O.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},n.state.isRenderAriaLiveMessage&&c)},n.renderChildren=function(){if(n.props.children)return O.createElement("div",{className:"react-datepicker__children-container"},n.props.children)},n.containerRef=p.createRef(),n.state={date:n.getDateInView(),selectingDate:void 0,monthContainer:void 0,isRenderAriaLiveMessage:!1},n}return Object.defineProperty(t,"defaultProps",{get:function(){return{monthsShown:1,forceShowMonthNavigation:!1,outsideClickIgnoreClass:i_,timeCaption:"Time",previousYearButtonLabel:"Previous Year",nextYearButtonLabel:"Next Year",previousMonthButtonLabel:"Previous Month",nextMonthButtonLabel:"Next Month",yearItemNumber:go}},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){var r=this;this.props.showTimeSelect&&(this.assignMonthContainer=function(){r.setState({monthContainer:r.monthContainer})}())},t.prototype.componentDidUpdate=function(r){var n=this;if(this.props.preSelection&&(!me(this.props.preSelection,r.preSelection)||this.props.monthSelectedIn!==r.monthSelectedIn)){var s=!xt(this.state.date,this.props.preSelection);this.setState({date:this.props.preSelection},function(){return s&&n.handleCustomMonthChange(n.state.date)})}else this.props.openToDate&&!me(this.props.openToDate,r.openToDate)&&this.setState({date:this.props.openToDate})},t.prototype.render=function(){var r=this.props.container||IL;return O.createElement(ld,{onClickOutside:this.handleClickOutside,style:{display:"contents"},ignoreClass:this.props.outsideClickIgnoreClass},O.createElement("div",{style:{display:"contents"},ref:this.containerRef},O.createElement(r,{className:nt("react-datepicker",this.props.className,{"react-datepicker--time-only":this.props.showTimeSelectOnly}),showTime:this.props.showTimeSelect||this.props.showTimeInput,showTimeSelectOnly:this.props.showTimeSelectOnly},this.renderAriaLiveRegion(),this.renderPreviousButton(),this.renderNextButton(),this.renderMonths(),this.renderYears(),this.renderTodayButton(),this.renderTimeSection(),this.renderInputTimeSection(),this.renderChildren())))},t}(p.Component),wI=function(e){var t=e.icon,r=e.className,n=r===void 0?"":r,s=e.onClick,a="react-datepicker__calendar-icon";if(typeof t=="string")return O.createElement("i",{className:"".concat(a," ").concat(t," ").concat(n),"aria-hidden":"true",onClick:s});if(O.isValidElement(t)){var o=t;return O.cloneElement(o,{className:"".concat(o.props.className||""," ").concat(a," ").concat(n),onClick:function(l){typeof o.props.onClick=="function"&&o.props.onClick(l),typeof s=="function"&&s(l)}})}return O.createElement("svg",{className:"".concat(a," ").concat(n),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",onClick:s},O.createElement("path",{d:"M96 32V64H48C21.5 64 0 85.5 0 112v48H448V112c0-26.5-21.5-48-48-48H352V32c0-17.7-14.3-32-32-32s-32 14.3-32 32V64H160V32c0-17.7-14.3-32-32-32S96 14.3 96 32zM448 192H0V464c0 26.5 21.5 48 48 48H400c26.5 0 48-21.5 48-48V192z"}))},o_=function(e){it(t,e);function t(r){var n=e.call(this,r)||this;return n.portalRoot=null,n.el=document.createElement("div"),n}return t.prototype.componentDidMount=function(){this.portalRoot=(this.props.portalHost||document).getElementById(this.props.portalId),this.portalRoot||(this.portalRoot=document.createElement("div"),this.portalRoot.setAttribute("id",this.props.portalId),(this.props.portalHost||document.body).appendChild(this.portalRoot)),this.portalRoot.appendChild(this.el)},t.prototype.componentWillUnmount=function(){this.portalRoot&&this.portalRoot.removeChild(this.el)},t.prototype.render=function(){return Tv.createPortal(this.props.children,this.el)},t}(p.Component),_I="[tabindex], a, button, input, select, textarea",jI=function(e){return(e instanceof HTMLAnchorElement||!e.disabled)&&e.tabIndex!==-1},l_=function(e){it(t,e);function t(r){var n=e.call(this,r)||this;return n.getTabChildren=function(){var s;return Array.prototype.slice.call((s=n.tabLoopRef.current)===null||s===void 0?void 0:s.querySelectorAll(_I),1,-1).filter(jI)},n.handleFocusStart=function(){var s=n.getTabChildren();s&&s.length>1&&s[s.length-1].focus()},n.handleFocusEnd=function(){var s=n.getTabChildren();s&&s.length>1&&s[0].focus()},n.tabLoopRef=p.createRef(),n}return t.prototype.render=function(){var r;return((r=this.props.enableTabLoop)!==null&&r!==void 0?r:t.defaultProps.enableTabLoop)?O.createElement("div",{className:"react-datepicker__tab-loop",ref:this.tabLoopRef},O.createElement("div",{className:"react-datepicker__tab-loop__start",tabIndex:0,onFocus:this.handleFocusStart}),this.props.children,O.createElement("div",{className:"react-datepicker__tab-loop__end",tabIndex:0,onFocus:this.handleFocusEnd})):this.props.children},t.defaultProps={enableTabLoop:!0},t}(p.Component);function NI(e){function t(r){var n,s=typeof r.hidePopper=="boolean"?r.hidePopper:!0,a=p.useRef(null),o=LL(he({open:!s,whileElementsMounted:uL,placement:r.popperPlacement,middleware:Cr([bL({padding:15}),vL(10),wL({element:a})],(n=r.popperModifiers)!==null&&n!==void 0?n:[],!0)},r.popperProps)),l=he(he({},r),{hidePopper:s,popperProps:he(he({},o),{arrowRef:a})});return O.createElement(e,he({},l))}return t.displayName="withFloating(".concat(e.displayName||e.name||"Component",")"),t}var kI=function(e){var t=e.className,r=e.wrapperClassName,n=e.hidePopper,s=n===void 0?!0:n,a=e.popperComponent,o=e.targetComponent,l=e.enableTabLoop,c=e.popperOnKeyDown,d=e.portalId,u=e.portalHost,m=e.popperProps,f=e.showArrow,h=void 0;if(!s){var y=nt("react-datepicker-popper",t);h=O.createElement(l_,{enableTabLoop:l},O.createElement("div",{ref:m.refs.setFloating,style:m.floatingStyles,className:y,"data-placement":m.placement,onKeyDown:c},a,f&&O.createElement(SL,{ref:m.arrowRef,context:m.context,fill:"currentColor",strokeWidth:1,height:8,width:16,style:{transform:"translateY(-1px)"},className:"react-datepicker__triangle"})))}e.popperContainer&&(h=p.createElement(e.popperContainer,{},h)),d&&!s&&(h=O.createElement(o_,{portalId:d,portalHost:u},h));var w=nt("react-datepicker-wrapper",r);return O.createElement(O.Fragment,null,O.createElement("div",{ref:m.refs.setReference,className:w},o),h)},SI=NI(kI);function CI(e,t){return e&&t?ut(e)!==ut(t)||de(e)!==de(t):e!==t}var _u="Date input not valid.",c_=function(e){it(t,e);function t(r){var n=e.call(this,r)||this;return n.calendar=null,n.input=null,n.getPreSelection=function(){return n.props.openToDate?n.props.openToDate:n.props.selectsEnd&&n.props.startDate?n.props.startDate:n.props.selectsStart&&n.props.endDate?n.props.endDate:be()},n.modifyHolidays=function(){var s;return(s=n.props.holidays)===null||s===void 0?void 0:s.reduce(function(a,o){var l=new Date(o.date);return cd(l)?Cr(Cr([],a,!0),[he(he({},o),{date:l})],!1):a},[])},n.calcInitialState=function(){var s,a=n.getPreSelection(),o=n_(n.props),l=s_(n.props),c=o&&Sr(a,Nl(o))?o:l&&Ln(a,H0(l))?l:a;return{open:n.props.startOpen||!1,preventFocus:!1,inputValue:null,preSelection:(s=n.props.selectsRange?n.props.startDate:n.props.selected)!==null&&s!==void 0?s:c,highlightDates:J0(n.props.highlightDates),focused:!1,shouldFocusDayInline:!1,isRenderAriaLiveMessage:!1,wasHidden:!1}},n.getInputValue=function(){var s,a=n.props,o=a.locale,l=a.startDate,c=a.endDate,d=a.rangeSeparator,u=a.selected,m=a.selectedDates,f=a.selectsMultiple,h=a.selectsRange,y=a.value,w=(s=n.props.dateFormat)!==null&&s!==void 0?s:t.defaultProps.dateFormat,b=n.state.inputValue;return typeof y=="string"?y:typeof b=="string"?b:h?OL(l,c,{dateFormat:w,locale:o,rangeSeparator:d}):f?AL(m??[],{dateFormat:w,locale:o}):Ut(u,{dateFormat:w,locale:o})},n.resetHiddenStatus=function(){n.setState(he(he({},n.state),{wasHidden:!1}))},n.setHiddenStatus=function(){n.setState(he(he({},n.state),{wasHidden:!0}))},n.setHiddenStateOnVisibilityHidden=function(){document.visibilityState==="hidden"&&n.setHiddenStatus()},n.clearPreventFocusTimeout=function(){n.preventFocusTimeout&&clearTimeout(n.preventFocusTimeout)},n.setFocus=function(){var s,a;(a=(s=n.input)===null||s===void 0?void 0:s.focus)===null||a===void 0||a.call(s,{preventScroll:!0})},n.setBlur=function(){var s,a;(a=(s=n.input)===null||s===void 0?void 0:s.blur)===null||a===void 0||a.call(s),n.cancelFocusInput()},n.deferBlur=function(){requestAnimationFrame(function(){n.setBlur()})},n.setOpen=function(s,a){a===void 0&&(a=!1),n.setState({open:s,preSelection:s&&n.state.open?n.state.preSelection:n.calcInitialState().preSelection,lastPreSelectChange:ju},function(){s||n.setState(function(o){return{focused:a?o.focused:!1}},function(){!a&&n.deferBlur(),n.setState({inputValue:null})})})},n.inputOk=function(){return qr(n.state.preSelection)},n.isCalendarOpen=function(){return n.props.open===void 0?n.state.open&&!n.props.disabled&&!n.props.readOnly:n.props.open},n.handleFocus=function(s){var a,o,l=n.state.wasHidden,c=l?n.state.open:!0;l&&n.resetHiddenStatus(),n.state.preventFocus||((o=(a=n.props).onFocus)===null||o===void 0||o.call(a,s),c&&!n.props.preventOpenOnFocus&&!n.props.readOnly&&n.setOpen(!0)),n.setState({focused:!0})},n.sendFocusBackToInput=function(){n.preventFocusTimeout&&n.clearPreventFocusTimeout(),n.setState({preventFocus:!0},function(){n.preventFocusTimeout=setTimeout(function(){n.setFocus(),n.setState({preventFocus:!1})})})},n.cancelFocusInput=function(){clearTimeout(n.inputFocusTimeout),n.inputFocusTimeout=void 0},n.deferFocusInput=function(){n.cancelFocusInput(),n.inputFocusTimeout=setTimeout(function(){return n.setFocus()},1)},n.handleDropdownFocus=function(){n.cancelFocusInput()},n.resetInputValue=function(){n.setState(he(he({},n.state),{inputValue:null}))},n.handleBlur=function(s){var a,o;(!n.state.open||n.props.withPortal||n.props.showTimeInput)&&((o=(a=n.props).onBlur)===null||o===void 0||o.call(a,s)),n.resetInputValue(),n.state.open&&n.props.open===!1&&n.setOpen(!1),n.setState({focused:!1})},n.handleCalendarClickOutside=function(s){var a,o;n.props.inline||n.setOpen(!1),(o=(a=n.props).onClickOutside)===null||o===void 0||o.call(a,s),n.props.withPortal&&s.preventDefault()},n.handleChange=function(){for(var s,a,o,l,c,d=[],u=0;u<arguments.length;u++)d[u]=arguments[u];var m=d[0];if(!(n.props.onChangeRaw&&(n.props.onChangeRaw.apply(n,d),!m||typeof m.isDefaultPrevented!="function"||m.isDefaultPrevented()))){n.setState({inputValue:(m==null?void 0:m.target)instanceof HTMLInputElement?m.target.value:null,lastPreSelectChange:DI});var f=n.props,h=f.selectsRange,y=f.startDate,w=f.endDate,b=(s=n.props.dateFormat)!==null&&s!==void 0?s:t.defaultProps.dateFormat,g=(a=n.props.strictParsing)!==null&&a!==void 0?a:t.defaultProps.strictParsing,x=(m==null?void 0:m.target)instanceof HTMLInputElement?m.target.value:"";if(h){var v=n.props.rangeSeparator,N=v.trim(),_=x.split(b.includes(N)?v:N,2).map(function(A){return A.trim()}),C=_[0],j=_[1],k=yu(C??"",b,n.props.locale,g),S=k?yu(j??"",b,n.props.locale,g):null,D=(y==null?void 0:y.getTime())!==(k==null?void 0:k.getTime()),R=(w==null?void 0:w.getTime())!==(S==null?void 0:S.getTime());if(!D&&!R||k&&Vt(k,n.props)||S&&Vt(S,n.props))return;(l=(o=n.props).onChange)===null||l===void 0||l.call(o,[k,S],m)}else{var P=yu(x,b,n.props.locale,g,(c=n.props.selected)!==null&&c!==void 0?c:void 0);(P||!x)&&n.setSelected(P,m,!0)}}},n.handleSelect=function(s,a,o){if(!n.props.readOnly){var l=n.props,c=l.selectsRange,d=l.startDate,u=l.endDate,m=l.swapRange,f=!c||d&&!u&&(m||!bu(s,d));n.props.shouldCloseOnSelect&&!n.props.showTimeSelect&&f&&n.sendFocusBackToInput(),n.props.onChangeRaw&&n.props.onChangeRaw(a),n.setSelected(s,a,!1,o),n.props.showDateSelect&&n.setState({isRenderAriaLiveMessage:!0}),!n.props.shouldCloseOnSelect||n.props.showTimeSelect?n.setPreSelection(s):f&&n.setOpen(!1)}},n.setSelected=function(s,a,o,l){var c,d,u=s;if(n.props.showYearPicker){if(u!==null&&kl(de(u),n.props))return}else if(n.props.showMonthYearPicker){if(u!==null&&r_(u,n.props))return}else if(u!==null&&Vt(u,n.props))return;var m=n.props,f=m.onChange,h=m.selectsRange,y=m.startDate,w=m.endDate,b=m.selectsMultiple,g=m.selectedDates,x=m.minTime,v=m.swapRange;if(!ns(n.props.selected,u)||n.props.allowSameDay||h||b)if(u!==null&&(n.props.selected&&(!o||!n.props.showTimeSelect&&!n.props.showTimeSelectOnly&&!n.props.showTimeInput)&&(u=vu(u,{hour:Gr(n.props.selected),minute:Kr(n.props.selected),second:Dn(n.props.selected)})),!o&&(n.props.showTimeSelect||n.props.showTimeSelectOnly)&&x&&(u=vu(u,{hour:x.getHours(),minute:x.getMinutes(),second:x.getSeconds()})),n.props.inline||n.setState({preSelection:u}),n.props.focusSelectedMonth||n.setState({monthSelectedIn:l})),h){var N=!y&&!w,_=y&&!w,C=!y&&!!w,j=y&&w;N?f==null||f([u,null],a):_?u===null?f==null||f([null,null],a):bu(u,y)?v?f==null||f([u,y],a):f==null||f([u,null],a):f==null||f([y,u],a):C&&(u&&bu(u,w)?f==null||f([u,w],a):f==null||f([u,null],a)),j&&(f==null||f([u,null],a))}else if(b){if(u!==null)if(!(g!=null&&g.length))f==null||f([u],a);else{var k=g.some(function(D){return me(D,u)});if(k){var S=g.filter(function(D){return!me(D,u)});f==null||f(S,a)}else f==null||f(Cr(Cr([],g,!0),[u],!1),a)}}else f==null||f(u,a);o||((d=(c=n.props).onSelect)===null||d===void 0||d.call(c,u,a),n.setState({inputValue:null}))},n.setPreSelection=function(s){if(!n.props.readOnly){var a=qr(n.props.minDate),o=qr(n.props.maxDate),l=!0;if(s){var c=Nl(s);if(a&&o)l=Qn(s,n.props.minDate,n.props.maxDate);else if(a){var d=Nl(n.props.minDate);l=Ln(s,d)||ns(c,d)}else if(o){var u=H0(n.props.maxDate);l=Sr(s,u)||ns(c,u)}}l&&n.setState({preSelection:s})}},n.toggleCalendar=function(){n.setOpen(!n.state.open)},n.handleTimeChange=function(s){var a,o;if(!(n.props.selectsRange||n.props.selectsMultiple)){var l=n.props.selected?n.props.selected:n.getPreSelection(),c=n.props.selected?s:vu(l,{hour:Gr(s),minute:Kr(s)});n.setState({preSelection:c}),(o=(a=n.props).onChange)===null||o===void 0||o.call(a,c),n.props.shouldCloseOnSelect&&!n.props.showTimeInput&&(n.sendFocusBackToInput(),n.setOpen(!1)),n.props.showTimeInput&&n.setOpen(!0),(n.props.showTimeSelectOnly||n.props.showTimeSelect)&&n.setState({isRenderAriaLiveMessage:!0}),n.setState({inputValue:null})}},n.onInputClick=function(){var s,a;!n.props.disabled&&!n.props.readOnly&&n.setOpen(!0),(a=(s=n.props).onInputClick)===null||a===void 0||a.call(s)},n.onInputKeyDown=function(s){var a,o,l,c,d,u;(o=(a=n.props).onKeyDown)===null||o===void 0||o.call(a,s);var m=s.key;if(!n.state.open&&!n.props.inline&&!n.props.preventOpenOnFocus){(m===K.ArrowDown||m===K.ArrowUp||m===K.Enter)&&((l=n.onInputClick)===null||l===void 0||l.call(n));return}if(n.state.open){if(m===K.ArrowDown||m===K.ArrowUp){s.preventDefault();var f=n.props.showTimeSelectOnly?".react-datepicker__time-list-item[tabindex='0']":n.props.showWeekPicker&&n.props.showWeekNumbers?'.react-datepicker__week-number[tabindex="0"]':n.props.showFullMonthYearPicker||n.props.showMonthYearPicker?'.react-datepicker__month-text[tabindex="0"]':'.react-datepicker__day[tabindex="0"]',h=((c=n.calendar)===null||c===void 0?void 0:c.containerRef.current)instanceof Element&&n.calendar.containerRef.current.querySelector(f);h instanceof HTMLElement&&h.focus({preventScroll:!0});return}var y=be(n.state.preSelection);m===K.Enter?(s.preventDefault(),s.target.blur(),n.inputOk()&&n.state.lastPreSelectChange===ju?(n.handleSelect(y,s),!n.props.shouldCloseOnSelect&&n.setPreSelection(y)):n.setOpen(!1)):m===K.Escape?(s.preventDefault(),s.target.blur(),n.sendFocusBackToInput(),n.setOpen(!1)):m===K.Tab&&n.setOpen(!1),n.inputOk()||(u=(d=n.props).onInputError)===null||u===void 0||u.call(d,{code:1,msg:_u})}},n.onPortalKeyDown=function(s){var a=s.key;a===K.Escape&&(s.preventDefault(),n.setState({preventFocus:!0},function(){n.setOpen(!1),setTimeout(function(){n.setFocus(),n.setState({preventFocus:!1})})}))},n.onDayKeyDown=function(s){var a,o,l,c,d,u,m=n.props,f=m.minDate,h=m.maxDate,y=m.disabledKeyboardNavigation,w=m.showWeekPicker,b=m.shouldCloseOnSelect,g=m.locale,x=m.calendarStartDay,v=m.adjustDateOnChange,N=m.inline;if((o=(a=n.props).onKeyDown)===null||o===void 0||o.call(a,s),!y){var _=s.key,C=s.shiftKey,j=be(n.state.preSelection),k=function(L,F){var U=F;switch(L){case K.ArrowRight:U=w?cc(F,1):cr(F,1);break;case K.ArrowLeft:U=w?E0(F,1):Z3(F,1);break;case K.ArrowUp:U=E0(F,1);break;case K.ArrowDown:U=cc(F,1);break;case K.PageUp:U=C?ha(F,1):os(F,1);break;case K.PageDown:U=C?Yr(F,1):fr(F,1);break;case K.Home:U=En(F,g,x);break;case K.End:U=BL(F);break}return U},S=function(L,F){for(var U=40,E=L,$=!1,B=0,H=k(L,F);!$;){if(B>=U){H=F;break}f&&H<f&&(E=K.ArrowRight,H=Vt(f,n.props)?k(E,H):f),h&&H>h&&(E=K.ArrowLeft,H=Vt(h,n.props)?k(E,H):h),Vt(H,n.props)?((E===K.PageUp||E===K.Home)&&(E=K.ArrowRight),(E===K.PageDown||E===K.End)&&(E=K.ArrowLeft),H=k(E,H)):$=!0,B++}return H};if(_===K.Enter){s.preventDefault(),n.handleSelect(j,s),!b&&n.setPreSelection(j);return}else if(_===K.Escape){s.preventDefault(),n.setOpen(!1),n.inputOk()||(c=(l=n.props).onInputError)===null||c===void 0||c.call(l,{code:1,msg:_u});return}var D=null;switch(_){case K.ArrowLeft:case K.ArrowRight:case K.ArrowUp:case K.ArrowDown:case K.PageUp:case K.PageDown:case K.Home:case K.End:D=S(_,j);break}if(!D){(u=(d=n.props).onInputError)===null||u===void 0||u.call(d,{code:1,msg:_u});return}if(s.preventDefault(),n.setState({lastPreSelectChange:ju}),v&&n.setSelected(D),n.setPreSelection(D),N){var R=ut(j),P=ut(D),A=de(j),I=de(D);R!==P||A!==I?n.setState({shouldFocusDayInline:!0}):n.setState({shouldFocusDayInline:!1})}}},n.onPopperKeyDown=function(s){var a=s.key;a===K.Escape&&(s.preventDefault(),n.sendFocusBackToInput(),n.setOpen(!1))},n.onClearClick=function(s){s&&s.preventDefault&&s.preventDefault(),n.sendFocusBackToInput();var a=n.props,o=a.selectsRange,l=a.onChange;o?l==null||l([null,null],s):l==null||l(null,s),n.setState({inputValue:null})},n.clear=function(){n.onClearClick()},n.onScroll=function(s){typeof n.props.closeOnScroll=="boolean"&&n.props.closeOnScroll?(s.target===document||s.target===document.documentElement||s.target===document.body)&&n.setOpen(!1):typeof n.props.closeOnScroll=="function"&&n.props.closeOnScroll(s)&&n.setOpen(!1)},n.renderCalendar=function(){var s,a;return!n.props.inline&&!n.isCalendarOpen()?null:O.createElement(bI,he({showMonthYearDropdown:void 0,ref:function(o){n.calendar=o}},n.props,n.state,{setOpen:n.setOpen,dateFormat:(s=n.props.dateFormatCalendar)!==null&&s!==void 0?s:t.defaultProps.dateFormatCalendar,onSelect:n.handleSelect,onClickOutside:n.handleCalendarClickOutside,holidays:XL(n.modifyHolidays()),outsideClickIgnoreClass:n.props.outsideClickIgnoreClass,onDropdownFocus:n.handleDropdownFocus,onTimeChange:n.handleTimeChange,className:n.props.calendarClassName,container:n.props.calendarContainer,handleOnKeyDown:n.props.onKeyDown,handleOnDayKeyDown:n.onDayKeyDown,setPreSelection:n.setPreSelection,dropdownMode:(a=n.props.dropdownMode)!==null&&a!==void 0?a:t.defaultProps.dropdownMode}),n.props.children)},n.renderAriaLiveRegion=function(){var s,a=n.props.locale,o=(s=n.props.dateFormat)!==null&&s!==void 0?s:t.defaultProps.dateFormat,l=n.props.showTimeInput||n.props.showTimeSelect,c=l?"PPPPp":"PPPP",d;return n.props.selectsRange?d="Selected start date: ".concat(Ut(n.props.startDate,{dateFormat:c,locale:a}),". ").concat(n.props.endDate?"End date: "+Ut(n.props.endDate,{dateFormat:c,locale:a}):""):n.props.showTimeSelectOnly?d="Selected time: ".concat(Ut(n.props.selected,{dateFormat:o,locale:a})):n.props.showYearPicker?d="Selected year: ".concat(Ut(n.props.selected,{dateFormat:"yyyy",locale:a})):n.props.showMonthYearPicker?d="Selected month: ".concat(Ut(n.props.selected,{dateFormat:"MMMM yyyy",locale:a})):n.props.showQuarterYearPicker?d="Selected quarter: ".concat(Ut(n.props.selected,{dateFormat:"yyyy, QQQ",locale:a})):d="Selected date: ".concat(Ut(n.props.selected,{dateFormat:c,locale:a})),O.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},d)},n.renderDateInput=function(){var s,a,o=nt(n.props.className,(s={},s[n.props.outsideClickIgnoreClass||t.defaultProps.outsideClickIgnoreClass]=n.state.open,s)),l=n.props.customInput||O.createElement("input",{type:"text"}),c=n.props.customInputRef||"ref";return p.cloneElement(l,(a={},a[c]=function(d){n.input=d},a.value=n.getInputValue(),a.onBlur=n.handleBlur,a.onChange=n.handleChange,a.onClick=n.onInputClick,a.onFocus=n.handleFocus,a.onKeyDown=n.onInputKeyDown,a.id=n.props.id,a.name=n.props.name,a.form=n.props.form,a.autoFocus=n.props.autoFocus,a.placeholder=n.props.placeholderText,a.disabled=n.props.disabled,a.autoComplete=n.props.autoComplete,a.className=nt(l.props.className,o),a.title=n.props.title,a.readOnly=n.props.readOnly,a.required=n.props.required,a.tabIndex=n.props.tabIndex,a["aria-describedby"]=n.props.ariaDescribedBy,a["aria-invalid"]=n.props.ariaInvalid,a["aria-labelledby"]=n.props.ariaLabelledBy,a["aria-required"]=n.props.ariaRequired,a))},n.renderClearButton=function(){var s=n.props,a=s.isClearable,o=s.disabled,l=s.selected,c=s.startDate,d=s.endDate,u=s.clearButtonTitle,m=s.clearButtonClassName,f=m===void 0?"":m,h=s.ariaLabelClose,y=h===void 0?"Close":h,w=s.selectedDates,b=s.readOnly;return a&&!b&&(l!=null||c!=null||d!=null||w!=null&&w.length)?O.createElement("button",{type:"button",className:nt("react-datepicker__close-icon",f,{"react-datepicker__close-icon--disabled":o}),disabled:o,"aria-label":y,onClick:n.onClearClick,title:u,tabIndex:-1}):null},n.state=n.calcInitialState(),n.preventFocusTimeout=void 0,n}return Object.defineProperty(t,"defaultProps",{get:function(){return{allowSameDay:!1,dateFormat:"MM/dd/yyyy",dateFormatCalendar:"LLLL yyyy",disabled:!1,disabledKeyboardNavigation:!1,dropdownMode:"scroll",preventOpenOnFocus:!1,monthsShown:1,outsideClickIgnoreClass:i_,readOnly:!1,rangeSeparator:e_,withPortal:!1,selectsDisabledDaysInRange:!1,shouldCloseOnSelect:!0,showTimeSelect:!1,showTimeInput:!1,showPreviousMonths:!1,showMonthYearPicker:!1,showFullMonthYearPicker:!1,showTwoColumnMonthYearPicker:!1,showFourColumnMonthYearPicker:!1,showYearPicker:!1,showQuarterYearPicker:!1,showWeekPicker:!1,strictParsing:!1,swapRange:!1,timeIntervals:30,timeCaption:"Time",previousMonthAriaLabel:"Previous Month",previousMonthButtonLabel:"Previous Month",nextMonthAriaLabel:"Next Month",nextMonthButtonLabel:"Next Month",previousYearAriaLabel:"Previous Year",previousYearButtonLabel:"Previous Year",nextYearAriaLabel:"Next Year",nextYearButtonLabel:"Next Year",timeInputLabel:"Time",enableTabLoop:!0,yearItemNumber:go,focusSelectedMonth:!1,showPopperArrow:!0,excludeScrollbar:!0,customTimeInput:null,calendarStartDay:void 0,toggleCalendarOnIconClick:!1,usePointerEvent:!1}},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){window.addEventListener("scroll",this.onScroll,!0),document.addEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},t.prototype.componentDidUpdate=function(r,n){var s,a,o,l;r.inline&&CI(r.selected,this.props.selected)&&this.setPreSelection(this.props.selected),this.state.monthSelectedIn!==void 0&&r.monthsShown!==this.props.monthsShown&&this.setState({monthSelectedIn:0}),r.highlightDates!==this.props.highlightDates&&this.setState({highlightDates:J0(this.props.highlightDates)}),!n.focused&&!ns(r.selected,this.props.selected)&&this.setState({inputValue:null}),n.open!==this.state.open&&(n.open===!1&&this.state.open===!0&&((a=(s=this.props).onCalendarOpen)===null||a===void 0||a.call(s)),n.open===!0&&this.state.open===!1&&((l=(o=this.props).onCalendarClose)===null||l===void 0||l.call(o)))},t.prototype.componentWillUnmount=function(){this.clearPreventFocusTimeout(),window.removeEventListener("scroll",this.onScroll,!0),document.removeEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},t.prototype.renderInputContainer=function(){var r=this.props,n=r.showIcon,s=r.icon,a=r.calendarIconClassname,o=r.calendarIconClassName,l=r.toggleCalendarOnIconClick,c=this.state.open;return a&&console.warn("calendarIconClassname props is deprecated. should use calendarIconClassName props."),O.createElement("div",{className:"react-datepicker__input-container".concat(n?" react-datepicker__view-calendar-icon":"")},n&&O.createElement(wI,he({icon:s,className:nt(o,!o&&a,c&&"react-datepicker-ignore-onclickoutside")},l?{onClick:this.toggleCalendar}:null)),this.state.isRenderAriaLiveMessage&&this.renderAriaLiveRegion(),this.renderDateInput(),this.renderClearButton())},t.prototype.render=function(){var r=this.renderCalendar();if(this.props.inline)return r;if(this.props.withPortal){var n=this.state.open?O.createElement(l_,{enableTabLoop:this.props.enableTabLoop},O.createElement("div",{className:"react-datepicker__portal",tabIndex:-1,onKeyDown:this.onPortalKeyDown},r)):null;return this.state.open&&this.props.portalId&&(n=O.createElement(o_,he({portalId:this.props.portalId},this.props),n)),O.createElement("div",null,this.renderInputContainer(),n)}return O.createElement(SI,he({},this.props,{className:this.props.popperClassName,hidePopper:!this.isCalendarOpen(),targetComponent:this.renderInputContainer(),popperComponent:r,popperOnKeyDown:this.onPopperKeyDown,showArrow:this.props.showPopperArrow}))},t}(p.Component),DI="input",ju="navigate";function EI({value:e,onChange:t,label:r="Site Submit"}){const[n,s]=p.useState(""),[a,o]=p.useState([]),[l,c]=p.useState(null),[d,u]=p.useState(!1),m=p.useRef(null),f=p.useRef(null);p.useEffect(()=>{e?M.from("site_submit").select("*").eq("id",e).single().then(({data:b})=>{b&&(c(b),s(b.code||""))}):(c(null),s(""))},[e]),p.useEffect(()=>{const g=setTimeout(async()=>{if(n.length===0){o([]);return}const{data:x}=await M.from("site_submit").select("*").or(`site_submit_name.ilike.%${n}%,code.ilike.%${n}%`).limit(10).order("site_submit_name");x&&o(x)},300);return()=>clearTimeout(g)},[n]),p.useEffect(()=>{const b=g=>{f.current&&!f.current.contains(g.target)&&m.current&&!m.current.contains(g.target)&&u(!1)};return document.addEventListener("mousedown",b),()=>document.removeEventListener("mousedown",b)},[]);const h=b=>{c(b),s(b.code||""),t(b.id),u(!1),o([])},y=b=>{s(b.target.value),u(!0),b.target.value===""&&(t(null),c(null))},w=()=>{m.current&&m.current.select(),n.length>0&&u(!0)};return i.jsxs("div",{className:"relative",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:r}),i.jsxs("div",{className:"relative mt-1",children:[i.jsx("input",{ref:m,type:"text",value:n,onChange:y,onFocus:w,placeholder:"Search by site submit name...",className:"block w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm"}),d&&a.length>0&&i.jsx("div",{ref:f,className:"absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-md shadow-lg max-h-48 overflow-auto",children:a.map(b=>i.jsxs("div",{onClick:()=>h(b),className:"p-2 hover:bg-gray-100 cursor-pointer text-sm",children:[i.jsx("div",{className:"font-medium",children:b.code}),b.site_submit_name&&i.jsx("div",{className:"text-xs text-gray-500",children:b.site_submit_name})]},b.id))})]}),l&&i.jsx("div",{className:"mt-1",children:i.jsx("button",{type:"button",className:"text-xs text-blue-600 hover:text-blue-800",onClick:()=>{console.log("View site submit:",l.id)},children:"View Site Submit Details "})})]})}function qh({value:e,onChange:t,propertyId:r,label:n="Property Unit"}){const[s,a]=p.useState(""),[o,l]=p.useState([]),[c,d]=p.useState(null),[u,m]=p.useState(!1),f=p.useRef(null),h=p.useRef(null);p.useEffect(()=>{e?M.from("property_unit").select("*").eq("id",e).single().then(({data:x})=>{x&&(d(x),a(x.property_unit_name||""))}):(d(null),a(""))},[e]),p.useEffect(()=>{const v=setTimeout(async()=>{if(!r){l([]);return}let N=M.from("property_unit").select("*").eq("property_id",r);s.length>0&&(N=N.ilike("property_unit_name",`%${s}%`));const{data:_}=await N.limit(20).order("property_unit_name");_&&l(_)},300);return()=>clearTimeout(v)},[s,r,u]),p.useEffect(()=>{const x=v=>{h.current&&!h.current.contains(v.target)&&f.current&&!f.current.contains(v.target)&&m(!1)};return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[]);const y=x=>{d(x),a(x.property_unit_name||""),t(x.id),m(!1)},w=x=>{a(x.target.value),m(!0),x.target.value===""&&(t(null),d(null))},b=()=>{r&&(f.current&&f.current.select(),m(!0))},g=x=>{const v=[];x.sqft&&v.push(`${Number(x.sqft).toLocaleString()} sqft`),x.rent&&v.push(`$${Number(x.rent).toLocaleString()}/mo`);const N=[];return x.inline===!0&&N.push("Inline"),x.end_cap===!0&&N.push("End Cap"),x.patio===!0&&N.push("Patio"),N.length>0&&v.push(N.join(", ")),v.join("  ")};return i.jsxs("div",{className:"relative",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:n}),i.jsxs("div",{className:"relative mt-1",children:[i.jsx("input",{ref:f,type:"text",value:s,onChange:w,onFocus:b,placeholder:r?"Search or select unit...":"Select a property first",disabled:!r,className:"block w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm disabled:bg-gray-100 disabled:cursor-not-allowed"}),u&&o.length>0&&r&&i.jsx("div",{ref:h,className:"absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-md shadow-lg max-h-48 overflow-auto",children:o.map(x=>i.jsxs("div",{onClick:()=>y(x),className:"p-2 hover:bg-gray-100 cursor-pointer text-sm",children:[i.jsx("div",{className:"font-medium",children:x.property_unit_name}),i.jsx("div",{className:"text-xs text-gray-500",children:g(x)})]},x.id))}),u&&o.length===0&&r&&s.length>0&&i.jsx("div",{className:"absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-md shadow-lg p-2 text-sm text-gray-500",children:"No units found for this property"})]}),c&&i.jsx("div",{className:"mt-1",children:i.jsx("button",{type:"button",className:"text-xs text-blue-600 hover:text-blue-800",onClick:()=>{console.log("View property unit:",c.id)},children:"View Property Unit Details "})})]})}function Gh({value:e,onChange:t,label:r="Property"}){const n=gr(),[s,a]=p.useState(""),[o,l]=p.useState([]),[c,d]=p.useState(null),[u,m]=p.useState(!1),[f,h]=p.useState(!1),y=p.useRef(null),w=p.useRef(null);p.useEffect(()=>{e?M.from("property").select("*").eq("id",e).single().then(({data:v})=>{v&&(d(v),a(v.property_name||""))}):(d(null),a(""))},[e]),p.useEffect(()=>{const N=setTimeout(async()=>{if(!s||s.trim().length===0){l([]);return}h(!0),console.log("Searching for:",s);const{data:_,error:C}=await M.from("property").select("*").ilike("property_name",`%${s}%`).limit(10).order("property_name");l(_||[]),h(!1)},300);return()=>clearTimeout(N)},[s]),p.useEffect(()=>{const v=N=>{w.current&&!w.current.contains(N.target)&&y.current&&!y.current.contains(N.target)&&m(!1)};return document.addEventListener("mousedown",v),()=>document.removeEventListener("mousedown",v)},[]);const b=v=>{d(v),a(v.property_name||""),t(v.id),m(!1),l([])},g=v=>{const N=v.target.value;a(N),N.length>0&&m(!0),c&&N!==c.property_name&&(d(null),t(null)),N===""&&(t(null),d(null),l([]),m(!1))},x=()=>{y.current&&y.current.select(),o.length>0&&m(!0)};return i.jsxs("div",{className:"relative",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:r}),i.jsxs("div",{className:"relative mt-1",children:[i.jsx("input",{ref:y,type:"text",value:s,onChange:g,onFocus:x,placeholder:"Type to search properties...",className:"block w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm"}),u&&i.jsx("div",{ref:w,className:"absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-md shadow-lg max-h-48 overflow-auto",children:f?i.jsx("div",{className:"p-2 text-sm text-gray-500",children:"Loading..."}):o.length>0?o.map(v=>{var N,_,C,j;return i.jsxs("div",{onClick:()=>b(v),className:"p-2 hover:bg-gray-100 cursor-pointer text-sm",children:[i.jsx("div",{className:"font-medium",children:v.property_name}),(((N=v.property_type)==null?void 0:N.label)||((_=v.property_stage)==null?void 0:_.label))&&i.jsx("div",{className:"text-xs text-gray-500",children:[(C=v.property_type)==null?void 0:C.label,(j=v.property_stage)==null?void 0:j.label].filter(Boolean).join("  ")})]},v.id)}):s.length>0?i.jsx("div",{className:"p-2 text-sm text-gray-500",children:"No properties found"}):null})]}),c&&i.jsx("div",{className:"mt-1",children:i.jsx("button",{type:"button",className:"text-xs text-blue-600 hover:text-blue-800 transition-colors",onClick:()=>{n(`/property/${c.id}`)},children:"View Property Details "})})]})}const PI={"Negotiating LOI":50,"At Lease/PSA":75,"Under Contract / Contingent":85,Booked:90,"Executed Payable":95,"Closed Paid":100,Lost:0};function TI({deal:e,onSave:t}){const[r,n]=p.useState(e),[s,a]=p.useState(!1),[o,l]=p.useState(null),[c,d]=p.useState([]),[u,m]=p.useState([]),[f,h]=p.useState(""),[y,w]=p.useState(""),[b,g]=p.useState([]),[x,v]=p.useState({}),[N,_]=p.useState(!1),[C,j]=p.useState(!1),k=p.useRef(null),S=p.useRef(!0);p.useEffect(()=>{n(e),v({}),j(!1),k.current=e.stage_id??null,S.current=!0},[e]),p.useEffect(()=>{M.from("deal_stage").select("id, label").then(({data:E})=>E&&d(E)),M.from("deal_team").select("id, label").then(({data:E})=>E&&m(E)),e.updated_by_id&&M.from("user").select("name").eq("id",e.updated_by_id).maybeSingle().then(({data:E})=>(E==null?void 0:E.name)&&h(E.name)),e.client_id?M.from("client").select("client_name").eq("id",e.client_id).maybeSingle().then(({data:E})=>(E==null?void 0:E.client_name)&&w(E.client_name)):w("")},[e.client_id,e.property_id]),p.useEffect(()=>{const $=setTimeout(async()=>{const B=y.trim();if(!B)return g([]);const{data:H}=await M.from("client").select("id, client_name").ilike("client_name",`%${B}%`).order("client_name",{ascending:!0}).limit(5);H&&g(H.map(J=>({id:J.id,label:J.client_name})))},150);return()=>clearTimeout($)},[y]);const D=(E,$)=>{E==="probability"&&j(!0);const B={...r,[E]:$};if(n(B),["deal_name","deal_value","commission_percent"].includes(E)){const H=A(E,$);v(J=>{const le={...J},oe=H[E];return oe?le[E]=oe:delete le[E],le})}if(E==="commission_percent"){const H=B.flat_fee_override??(B.deal_value??0)*(($??0)/100);(async()=>{if(!r.id){console.log("Skipping auto-save for new deal");return}const{data:le,error:oe}=await M.from("deal").update({commission_percent:$,fee:H}).eq("id",r.id).select().single();oe?console.error("Error auto-saving commission:",oe):le&&t(le)})()}},R=r.flat_fee_override??(r.deal_value??0)*((r.commission_percent??0)/100),P=()=>{var E;return(E=c.find($=>$.id===r.stage_id))==null?void 0:E.label};p.useEffect(()=>{if(!r.stage_id||c.length===0)return;const E=P();if(!E)return;const $=PI[E];if(S.current){if(S.current=!1,r.probability==null&&typeof $=="number"){n(J=>({...J,probability:$})),_(!0);const H=setTimeout(()=>_(!1),800);return()=>clearTimeout(H)}return}if(k.current!==r.stage_id&&typeof $=="number"){n(J=>({...J,probability:$})),j(!1),_(!0);const H=setTimeout(()=>_(!1),800);return k.current=r.stage_id,()=>clearTimeout(H)}k.current=r.stage_id},[r.stage_id,c]);const A=(E,$)=>{const B={};if(E==="deal_name"&&(!$||String($).trim().length===0)&&(B.deal_name="Deal Name is required."),E==="deal_value"&&($===null||$===""||isNaN(Number($))?B.deal_value="Enter a number.":Number($)<0&&(B.deal_value="Must be  0.")),E==="commission_percent"){const H=Number($);$===null||$===""||isNaN(H)?B.commission_percent="Enter a percent.":(H<0||H>100)&&(B.commission_percent="0100 only.")}return B},I=E=>{const $={};return Object.assign($,A("deal_name",E.deal_name)),Object.assign($,A("deal_value",E.deal_value)),Object.assign($,A("commission_percent",E.commission_percent)),$},L=async()=>{const E=I(r);if(v(E),Object.keys(E).length>0)return;a(!0);const $={deal_name:r.deal_name,client_id:r.client_id,property_id:r.property_id,property_unit_id:r.property_unit_id,site_submit_id:r.site_submit_id,deal_value:r.deal_value,commission_percent:r.commission_percent,flat_fee_override:r.flat_fee_override,fee:R,target_close_date:r.target_close_date,loi_signed_date:r.loi_signed_date,closed_date:r.closed_date,probability:r.probability,deal_team_id:r.deal_team_id,stage_id:r.stage_id,house_percent:r.house_percent,origination_percent:r.origination_percent,site_percent:r.site_percent,deal_percent:r.deal_percent,number_of_payments:r.number_of_payments,updated_at:new Date().toISOString()};let B,H;if(r.id){const J=await M.from("deal").update($).eq("id",r.id).select().single();B=J.data,H=J.error}else{$.created_at=new Date().toISOString();const J=await M.from("deal").insert([$]).select().single();B=J.data,H=J.error}a(!1),H?alert("Error saving: "+H.message):B&&t(B)},F=P(),U=F==="Closed Paid";return i.jsxs("div",{className:"relative",children:[i.jsx(el,{title:"Deal Context",help:"Name the opportunity, choose the client, property, and deal team.",children:i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsx(RI,{label:"Deal Name",value:r.deal_name,onChange:E=>D("deal_name",E)}),i.jsx(LI,{label:"Client",search:y,setSearch:w,suggestions:b,onSelect:(E,$)=>{D("client_id",E),w($),g([])}}),i.jsx(Gh,{value:r.property_id,onChange:E=>D("property_id",E),label:"Property"}),i.jsx(qh,{value:r.property_unit_id,onChange:E=>D("property_unit_id",E),propertyId:r.property_id,label:"Property Unit"}),i.jsx(EI,{value:r.site_submit_id,onChange:E=>D("site_submit_id",E),label:"Site Submit"}),i.jsx(nx,{label:"Deal Team",value:r.deal_team_id,onChange:E=>D("deal_team_id",E),options:u}),x.deal_name&&i.jsx(Nu,{msg:x.deal_name,className:"col-span-2"})]})}),i.jsx(el,{title:"Financials",help:"Set value and commission. Fee auto-calculates unless a flat fee is set.",children:i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsx(ts,{label:"Deal Value",value:r.deal_value,onChange:E=>D("deal_value",E===""?null:parseFloat(E)),format:E=>ji(E,2),editingField:o,setEditingField:l,fieldKey:"deal_value"}),x.deal_value&&i.jsx(Nu,{msg:x.deal_value}),i.jsx(ts,{label:"Commission %",value:r.commission_percent,onChange:E=>D("commission_percent",E===""?null:parseFloat(E)),format:E=>Vf(E,2),editingField:o,setEditingField:l,fieldKey:"commission_percent"}),x.commission_percent&&i.jsx(Nu,{msg:x.commission_percent}),i.jsx(ts,{label:"Flat Fee Override",value:r.flat_fee_override,onChange:E=>D("flat_fee_override",E===""?null:parseFloat(E)),format:E=>E===null?"":ji(E,2),editingField:o,setEditingField:l,fieldKey:"flat_fee_override"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Calculated Fee"}),i.jsx("div",{className:"mt-1 p-2 bg-gray-100 rounded text-sm",children:isNaN(R)?"":ji(R,2)})]})]})}),i.jsx(el,{title:"Stage & Probability",help:"Choosing a stage will set a default probability. You can override it.",children:i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsx(nx,{label:"Stage",value:r.stage_id,onChange:E=>D("stage_id",E),options:c}),i.jsx("div",{className:"rounded transition-colors duration-700 "+(N?"bg-yellow-50":"bg-transparent"),children:i.jsx(ts,{label:"Probability %",value:r.probability,onChange:E=>D("probability",E===""?null:parseFloat(E)),format:E=>UT(E),editingField:o,setEditingField:l,fieldKey:"probability"})})]})}),i.jsx(el,{title:"Timeline",help:"Target and actual dates. Closed Date enabled only at Closed Paid.",children:i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsx(ku,{label:"Target Close Date",value:r.target_close_date,onChange:E=>D("target_close_date",E)}),i.jsx(ku,{label:"LOI Signed Date",value:r.loi_signed_date,onChange:E=>D("loi_signed_date",E)}),i.jsx(ku,{label:"Closed Date",value:r.closed_date,onChange:E=>D("closed_date",E),disabled:!U,tooltip:U?void 0:"Set Stage to 'Closed Paid' to enable"})]})}),i.jsxs("div",{className:"sticky bottom-0 left-0 right-0 bg-white border-t mt-6 p-3 flex items-center justify-between shadow-sm",children:[i.jsx("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:r.updated_at?i.jsxs(i.Fragment,{children:[i.jsx("span",{children:"Last Updated by"}),i.jsx("span",{className:"font-medium",children:f||"Unknown"}),i.jsxs("span",{children:[new Date(r.updated_at).toLocaleDateString()," ",new Date(r.updated_at).toLocaleTimeString()]})]}):i.jsx("span",{children:"Not yet saved"})}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"text-xs text-gray-500",children:F?`Stage: ${F}`:"No stage selected"}),i.jsx("button",{onClick:L,disabled:s||Object.keys(x).length>0,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-60",children:s?"Saving...":"Save Deal"})]})]})]})}function el({title:e,help:t,children:r}){return i.jsxs("section",{className:"bg-white rounded-md border p-4 mb-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:e}),t&&i.jsx("span",{className:"text-gray-500 text-xs border rounded-full w-4 h-4 inline-flex items-center justify-center",title:t,"aria-label":t,children:"i"})]}),r]})}function Nu({msg:e,className:t=""}){return i.jsx("p",{className:"text-xs text-red-600 mt-1 "+t,children:e})}function RI({label:e,value:t,onChange:r,type:n="text",className:s=""}){return i.jsxs("div",{className:s,children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:e}),i.jsx("input",{type:n,value:t??"",onChange:a=>r(a.target.value),className:"mt-1 block w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm"})]})}function ku({label:e,value:t,onChange:r,disabled:n,tooltip:s}){const a=t?$h(t):null;return i.jsxs("div",{title:s,children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:e}),i.jsx(c_,{selected:a,onChange:o=>r(o?Pr(o,"yyyy-MM-dd"):null),className:`mt-1 block w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${n?"bg-gray-100 cursor-not-allowed":""}`,dateFormat:"MM/dd/yyyy",isClearable:!0,disabled:n})]})}function nx({label:e,value:t,onChange:r,options:n}){return i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:e}),i.jsxs("select",{value:t??"",onChange:s=>r(s.target.value),className:"mt-1 block w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",children:[i.jsx("option",{value:"",children:"-- Select --"}),n.map(s=>i.jsx("option",{value:s.id,children:s.label},s.id))]})]})}function LI({label:e,search:t,setSearch:r,suggestions:n,onSelect:s}){const a=p.useRef(null),o=()=>{a.current&&a.current.select()};return i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:e}),i.jsx("input",{ref:a,type:"text",value:t,onChange:l=>r(l.target.value),onFocus:o,placeholder:`Search ${e.toLowerCase()}...`,className:"mt-1 block w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm"}),n.filter(l=>l.label!==t).length>0&&i.jsx("ul",{className:"bg-white border border-gray-300 rounded mt-1 max-h-48 overflow-auto",children:n.filter(l=>l.label!==t).map(l=>i.jsx("li",{onClick:()=>s(l.id,l.label),className:"p-2 hover:bg-gray-100 cursor-pointer text-sm",children:l.label},l.id))})]})}const d_=p.createContext(null),u_=()=>{const e=p.useContext(d_);if(!e)throw new Error("usePanelManager must be used within a FloatingPanelManager");return e},II=({children:e})=>{const[t,r]=p.useState(null),n=o=>{r(o)},s=()=>{r(null)},a=o=>{t===o?s():n(o)};return i.jsx(d_.Provider,{value:{activePanel:t,openPanel:n,closePanel:s,togglePanel:a},children:e})},Xa=({type:e,icon:t,count:r,label:n,position:s})=>{const{activePanel:a,togglePanel:o}=u_(),l=a===e;return i.jsxs("div",{className:"relative group",children:[i.jsxs("button",{onClick:()=>o(e),className:`
          relative flex items-center justify-center w-10 h-10 rounded-full shadow-md
          transition-all duration-300 ease-out hover:scale-110 hover:shadow-lg
          backdrop-blur-sm border
          ${l?"bg-blue-600 text-white border-blue-500 shadow-blue-200":"bg-white/90 text-gray-600 hover:bg-white border-gray-200 hover:text-gray-800"}
        `,title:n,children:[i.jsx("span",{className:"text-sm",children:t}),r!==void 0&&r>0&&i.jsx("span",{className:`
            absolute -top-1 -right-1 flex items-center justify-center w-5 h-5 text-xs font-medium rounded-full
            border-2 border-white
            ${l?"bg-white text-blue-600":"bg-red-500 text-white"}
          `,children:r>99?"99+":r})]}),i.jsxs("div",{className:"absolute right-full mr-3 px-3 py-1.5 bg-gray-900 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none",children:[n,r!==void 0&&i.jsxs("span",{className:"ml-1 text-gray-300",children:["(",r,")"]}),i.jsx("div",{className:"absolute left-full top-1/2 transform -translate-y-1/2 w-0 h-0 border-l-4 border-l-gray-900 border-t-4 border-t-transparent border-b-4 border-b-transparent"})]})]})},MI=({children:e,contactCount:t=0,notesCount:r=0,filesCount:n=0,activityCount:s=0,paymentsCount:a=0})=>i.jsxs("div",{className:"relative",children:[e,i.jsxs("div",{className:"fixed right-4 top-1/2 transform -translate-y-1/2 space-y-3",style:{zIndex:50},children:[i.jsx(Xa,{type:"contacts",icon:"",count:t,label:"Contact Roles",position:0}),i.jsx(Xa,{type:"notes",icon:"",count:r,label:"Notes",position:1}),i.jsx(Xa,{type:"files",icon:"",count:n,label:"Files",position:2}),i.jsx(Xa,{type:"activity",icon:"",count:s,label:"Activity",position:3}),i.jsx(Xa,{type:"payments",icon:"",count:a,label:"Payments",position:4})]})]}),f_=e=>{const[t,r]=p.useState([]),[n,s]=p.useState(!0),[a,o]=p.useState(null);return p.useEffect(()=>{(async()=>{if(!e){r([]),s(!1);return}try{s(!0),o(null);const{data:c,error:d}=await M.from("deal_contact").select("id, contact_id, role_id, primary_contact").eq("deal_id",e);if(d)throw d;if(!c||c.length===0){r([]),s(!1);return}const u=[...new Set(c.map(v=>v.contact_id).filter(Boolean))],m=[...new Set(c.map(v=>v.role_id).filter(Boolean))],{data:f,error:h}=await M.from("contact").select("id, first_name, last_name, email, phone, mobile_phone").in("id",u);if(h)throw h;const{data:y,error:w}=await M.from("contact_role").select("role_id, label").in("role_id",m);if(w)throw w;const b=new Map;f==null||f.forEach(v=>{b.set(v.id,v)});const g=new Map;y==null||y.forEach(v=>{g.set(v.role_id,v)});const x=c.map(v=>{const N=b.get(v.contact_id),_=g.get(v.role_id);let C="Unknown Contact";if(N){const j=N.first_name||"",k=N.last_name||"";j&&k?C=`${j} ${k}`:j?C=j:k&&(C=k)}return{id:v.id,contact_name:C,contact_email:(N==null?void 0:N.email)||null,contact_phone:(N==null?void 0:N.phone)||null,contact_mobile:(N==null?void 0:N.mobile_phone)||null,role_label:(_==null?void 0:_.label)||"No Role",primary_contact:v.primary_contact||!1,contact_id:v.contact_id}});x.sort((v,N)=>v.primary_contact&&!N.primary_contact?-1:!v.primary_contact&&N.primary_contact?1:v.role_label.localeCompare(N.role_label)),r(x)}catch(c){console.error("Error fetching deal contacts:",c),o("Failed to load contacts")}finally{s(!1)}})()},[e]),{contacts:t,loading:n,error:a,refetch:()=>{e&&s(!0)}}},OI=({dealId:e})=>{const{activePanel:t,closePanel:r}=u_(),{contacts:n,loading:s,error:a}=f_(e),o=t==="contacts",l=d=>{const u=d.split(" ");return u.length>=2?`${u[0].charAt(0)}${u[u.length-1].charAt(0)}`.toUpperCase():d.charAt(0).toUpperCase()||"?"},c=(d,u)=>{d&&window.open(`tel:${d}`,"_self")};return o?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 bg-black/10 transition-all duration-300 z-40",onClick:r}),i.jsxs("div",{className:`
        fixed right-0 top-0 h-full w-80 bg-white shadow-2xl border-l border-gray-200
        transform transition-all duration-300 ease-out z-50
        ${o?"translate-x-0":"translate-x-full"}
        flex flex-col
      `,children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-100 bg-white shrink-0",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center shadow-sm",children:i.jsx("span",{className:"text-white text-sm",children:""})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Contacts"}),i.jsxs("p",{className:"text-xs text-gray-500",children:[n.length," contact",n.length!==1?"s":""," on this deal"]})]})]}),i.jsx("button",{onClick:r,className:"w-8 h-8 flex items-center justify-center rounded-lg hover:bg-gray-100 transition-colors",children:i.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsx("div",{className:"flex-1 overflow-y-auto",children:s?i.jsx("div",{className:"p-4 space-y-4",children:[...Array(3)].map((d,u)=>i.jsx("div",{className:"animate-pulse",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2"}),i.jsx("div",{className:"h-3 bg-gray-200 rounded w-2/3"})]})]})},u))}):a?i.jsxs("div",{className:"p-6 text-center",children:[i.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-3",children:i.jsx("span",{className:"text-red-500 text-lg",children:""})}),i.jsx("p",{className:"text-red-600 font-medium mb-1",children:"Error Loading Contacts"}),i.jsx("p",{className:"text-sm text-gray-500",children:a})]}):n.length===0?i.jsxs("div",{className:"p-6 text-center",children:[i.jsx("div",{className:"w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx("span",{className:"text-gray-300 text-2xl",children:""})}),i.jsx("p",{className:"text-gray-700 font-medium mb-2",children:"No Contacts Yet"}),i.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Add contacts to this deal to see them here"}),i.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",children:"Add Contact"})]}):i.jsx("div",{className:"divide-y divide-gray-50",children:n.map(d=>i.jsx("div",{className:"p-4 hover:bg-gray-25 transition-colors",children:i.jsxs("div",{className:"flex items-start space-x-3",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-400 to-blue-500 rounded-full flex items-center justify-center shadow-sm",children:i.jsx("span",{className:"text-white font-medium text-sm",children:l(d.contact_name)})})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[i.jsx("button",{className:"text-sm font-semibold text-gray-900 hover:text-blue-600 transition-colors truncate",onClick:()=>{console.log("View contact:",d.contact_id)},children:d.contact_name}),d.primary_contact&&i.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-green-100 text-green-700 border border-green-200",children:"Primary"})]}),i.jsx("p",{className:"text-xs font-medium text-blue-600 mb-2",children:d.role_label}),i.jsxs("div",{className:"space-y-1",children:[d.contact_email&&i.jsxs("p",{className:"text-xs text-gray-600 truncate",children:[" ",d.contact_email]}),d.contact_phone&&i.jsxs("button",{onClick:()=>c(d.contact_phone,d.contact_name),className:"text-xs text-gray-600 hover:text-blue-600 transition-colors cursor-pointer",children:[" ",d.contact_phone]}),d.contact_mobile&&i.jsxs("button",{onClick:()=>c(d.contact_mobile,d.contact_name),className:"text-xs text-gray-600 hover:text-blue-600 transition-colors cursor-pointer block",children:[" ",d.contact_mobile]})]})]})]})},d.id))})}),i.jsx("div",{className:"p-4 border-t border-gray-100 bg-gray-50 shrink-0",children:i.jsxs("button",{className:"w-full flex items-center justify-center px-4 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",children:[i.jsx("span",{className:"mr-2",children:"+"}),"Add Contact Role"]})})]})]}):null},Br=({label:e,value:t,onChange:r,disabled:n=!1})=>{const[s,a]=p.useState(!1),[o,l]=p.useState(""),c=t?`${t.toFixed(1)}%`:"0.0%",d=()=>{n||(a(!0),l((t==null?void 0:t.toString())||""))},u=()=>{const h=parseFloat(o);r(isNaN(h)?null:h),a(!1)},m=()=>{a(!1),l("")},f=h=>{h.key==="Enter"?(h.preventDefault(),h.stopPropagation(),u()):h.key==="Escape"&&(h.preventDefault(),h.stopPropagation(),m())};return s?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),i.jsx("input",{type:"number",step:"0.1",value:o,onChange:h=>l(h.target.value),onBlur:u,onKeyDown:f,className:"mt-1 block w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",autoFocus:!0})]}):i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:e}),i.jsx("div",{onClick:d,className:`mt-1 block w-full rounded border-gray-300 shadow-sm px-3 py-2 transition-colors border text-sm ${n?"bg-gray-100 cursor-not-allowed border-gray-200":"cursor-pointer hover:bg-blue-50 border-transparent hover:border-blue-200"}`,title:n?"Not editable":"Click to edit",children:c})]})},m_=({value:e,onChange:t,label:r="Referral Payee",tabIndex:n})=>{const[s,a]=p.useState(""),[o,l]=p.useState([]),c=p.useRef(null);p.useEffect(()=>{(async()=>{if(e){const{data:h}=await M.from("client").select("client_name").eq("id",e).single();h!=null&&h.client_name&&a(h.client_name)}else a("")})()},[e]),p.useEffect(()=>{const h=setTimeout(async()=>{const y=s.trim();if(!y)return l([]);const{data:w}=await M.from("client").select("id, client_name").ilike("client_name",`%${y}%`).order("client_name",{ascending:!0}).limit(5);w&&l(w.map(b=>({id:b.id,label:b.client_name})))},150);return()=>clearTimeout(h)},[s]);const d=()=>{c.current&&c.current.select()},u=(f,h)=>{t(f),a(h),l([])},m=f=>{const h=f.target.value;a(h),h===""&&t(null)};return i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:r}),i.jsx("input",{ref:c,type:"text",value:s,onChange:m,onFocus:d,placeholder:`Search ${r.toLowerCase()}...`,className:"mt-1 block w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",tabIndex:n}),o.filter(f=>f.label!==s).length>0&&i.jsx("ul",{className:"bg-white border border-gray-300 rounded mt-1 max-h-48 overflow-auto",children:o.filter(f=>f.label!==s).map(f=>i.jsx("li",{onClick:()=>u(f.id,f.label),className:"p-2 hover:bg-gray-100 cursor-pointer text-sm",children:f.label},f.id))})]})},Kh=(e,t=[])=>p.useMemo(()=>{const r=(e==null?void 0:e.fee)||0,n=(e==null?void 0:e.referral_fee_usd)||0,s=(e==null?void 0:e.house_usd)||0,a=r-n-s,o=(e==null?void 0:e.origination_percent)||0,l=(e==null?void 0:e.site_percent)||0,c=(e==null?void 0:e.deal_percent)||0,d=o/100*a,u=l/100*a,m=c/100*a,f=d+u+m,h=t.map(x=>{const v=(x==null?void 0:x.split_origination_percent)||0,N=(x==null?void 0:x.split_site_percent)||0,_=(x==null?void 0:x.split_deal_percent)||0,C=v/100*d,j=N/100*u,k=_/100*m,S=C+j+k;return{...x,calculatedOriginationUSD:C,calculatedSiteUSD:j,calculatedDealUSD:k,calculatedTotalUSD:S}}),y=h.reduce((x,v)=>x+(v.split_origination_percent||0),0),w=h.reduce((x,v)=>x+(v.split_site_percent||0),0),b=h.reduce((x,v)=>x+(v.split_deal_percent||0),0),g=h.reduce((x,v)=>x+v.calculatedTotalUSD,0);return{baseAmounts:{gci:r,referralFeeUsd:n,houseUsd:s,agci:a,originationPercent:o,sitePercent:l,dealPercent:c,originationUSD:d,siteUSD:u,dealUSD:m,totalDealUSD:f},brokerSplits:h,totals:{originationPercent:y,sitePercent:w,dealPercent:b,brokerUSD:g},validation:{isOriginationValid:y<=100,isSiteValid:w<=100,isDealValid:b<=100,areAllValid:y<=100&&w<=100&&b<=100}}},[e,t]),AI=({title:e,help:t,children:r})=>i.jsxs("section",{className:"bg-white rounded-md border p-4 mb-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:e}),t&&i.jsx("span",{className:"text-gray-500 text-xs border rounded-full w-4 h-4 inline-flex items-center justify-center",title:t,"aria-label":t,children:"i"})]}),r]}),$I=({deal:e,onFieldUpdate:t})=>{const{baseAmounts:r}=Kh(e),n=a=>a==null?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a),s=a=>a==null?"0.0%":`${a.toFixed(1)}%`;return i.jsx(AI,{title:"Commission Details",help:"Set commission percentages and amounts. Click any percentage to edit.",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Deal Fee"}),i.jsx("div",{className:"mt-1 p-2 bg-gray-100 rounded text-sm",children:n(e.fee)})]}),i.jsx(Br,{label:"Commission Rate %",value:e.commission_percent,onChange:a=>t("commission_percent",a)}),i.jsx(Br,{label:"Referral Fee %",value:e.referral_fee_percent,onChange:a=>t("referral_fee_percent",a)}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Referral Fee $"}),i.jsx("div",{className:"mt-1 p-2 bg-gray-100 rounded text-sm",children:n(e.referral_fee_usd)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Number of Payments"}),i.jsx("input",{type:"number",step:"1",min:"1",value:e.number_of_payments||1,onChange:a=>t("number_of_payments",parseInt(a.target.value)||1),className:"mt-1 block w-full rounded border-gray-300 shadow-sm cursor-pointer hover:bg-blue-50 px-3 py-2 transition-colors border border-transparent hover:border-blue-200 text-sm"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsx(m_,{value:e.referral_payee_client_id,onChange:a=>t("referral_payee_client_id",a),label:"Referral Payee"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"GCI"}),i.jsx("div",{className:"mt-1 p-2 bg-gray-100 rounded text-sm",children:n(e.gci)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"AGCI"}),i.jsx("div",{className:"mt-1 p-2 bg-gray-100 rounded text-sm",children:n(e.agci)})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsx(Br,{label:"House %",value:e.house_percent,onChange:a=>t("house_percent",a)}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"House $"}),i.jsx("div",{className:"mt-1 p-2 bg-gray-100 rounded text-sm",children:n(e.house_usd)})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsx(Br,{label:"Origination %",value:e.origination_percent,onChange:a=>t("origination_percent",a)}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Origination $"}),i.jsx("div",{className:"mt-1 p-2 bg-gray-100 rounded text-sm",children:n(r.originationUSD)})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsx(Br,{label:"Site %",value:e.site_percent,onChange:a=>t("site_percent",a)}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Site $"}),i.jsx("div",{className:"mt-1 p-2 bg-gray-100 rounded text-sm",children:n(r.siteUSD)})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsx(Br,{label:"Deal %",value:e.deal_percent,onChange:a=>t("deal_percent",a)}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Deal $"}),i.jsx("div",{className:"mt-1 p-2 bg-gray-100 rounded text-sm",children:n(r.dealUSD)})]})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[i.jsx("h4",{className:"text-xs font-medium text-blue-800 mb-2",children:"Broker Split Summary (Origination + Site + Deal)"}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-xs",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-blue-700",children:"Origination:"})," ",s(e.origination_percent)]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-blue-700",children:"Site:"})," ",s(e.site_percent)]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-blue-700",children:"Deal:"})," ",s(e.deal_percent)]}),i.jsxs("div",{className:"font-semibold",children:[i.jsx("span",{className:"text-blue-700",children:"Total:"})," ",s((e.origination_percent||0)+(e.site_percent||0)+(e.deal_percent||0))]})]}),i.jsx("div",{className:"mt-2 text-xs text-blue-600",children:"House % is separate and not included in the 100% split validation."})]})]})})},h_=({isOpen:e,onClose:t,onConfirm:r,title:n,itemName:s,message:a})=>e?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.962-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),i.jsx("div",{className:"ml-3",children:i.jsx("h3",{className:"text-lg font-medium text-gray-900",children:n})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("p",{className:"text-sm text-gray-600",children:["Are you sure you want to delete ",i.jsx("strong",{children:s}),"?"]}),a&&i.jsx("p",{className:"text-sm text-gray-600 mt-2",children:a})]}),i.jsxs("div",{className:"flex justify-end space-x-3",children:[i.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:"Cancel"}),i.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md transition-colors",children:"Delete"})]})]})}):null,Mr=e=>e==null||isNaN(e)?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(e),Su=({value:e,onChange:t,label:r})=>{const[n,s]=p.useState(!1),[a,o]=p.useState(""),l=e?`${e.toFixed(1)}%`:"0.0%",c=()=>{s(!0),o((e==null?void 0:e.toString())||"0")},d=()=>{const f=parseFloat(a);t(isNaN(f)?null:f),s(!1)},u=()=>{s(!1),o("")},m=f=>{f.key==="Enter"?d():f.key==="Escape"&&u()};return n?i.jsx("input",{type:"number",step:"0.1",value:a,onChange:f=>o(f.target.value),onBlur:d,onKeyDown:m,className:"w-16 px-1 py-0.5 text-sm border border-blue-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",autoFocus:!0}):i.jsx("span",{onClick:c,className:"cursor-pointer hover:bg-blue-50 px-1 py-0.5 rounded text-sm",title:`Click to edit ${r||"percentage"}`,children:l})},FI=({deal:e,onDealUpdate:t})=>{const[r,n]=p.useState([]),[s,a]=p.useState([]),[o,l]=p.useState(!0),[c,d]=p.useState(null),[u,m]=p.useState({isOpen:!1,splitId:"",brokerName:""}),{baseAmounts:f}=Kh(e,r),h=_=>{const C=s.find(j=>j.id===_);return C?C.name:"Unknown Broker"};p.useEffect(()=>{(async()=>{if(e.id)try{l(!0);const{data:C,error:j}=await M.from("commission_split").select("*").eq("deal_id",e.id).order("created_at");if(j)throw j;const{data:k,error:S}=await M.from("broker").select("*").order("name");if(S)throw S;n(C||[]),a(k||[])}catch(C){console.error("Error fetching commission data:",C),d("Failed to load commission splits")}finally{l(!1)}})()},[e.id]);const y=async(_,C,j)=>{console.log(" updateCommissionSplit called:",{splitId:_,field:C,value:j});try{const k=r.find(R=>R.id===_);if(!k)return;const S={...k};C==="split_origination_percent"?(S.split_origination_percent=j||0,S.split_origination_usd=(j||0)/100*f.originationUSD):C==="split_site_percent"?(S.split_site_percent=j||0,S.split_site_usd=(j||0)/100*f.siteUSD):C==="split_deal_percent"&&(S.split_deal_percent=j||0,S.split_deal_usd=(j||0)/100*f.dealUSD),S.split_broker_total=(S.split_origination_usd||0)+(S.split_site_usd||0)+(S.split_deal_usd||0);const{error:D}=await M.from("commission_split").update({split_origination_percent:S.split_origination_percent,split_origination_usd:S.split_origination_usd,split_site_percent:S.split_site_percent,split_site_usd:S.split_site_usd,split_deal_percent:S.split_deal_percent,split_deal_usd:S.split_deal_usd,split_broker_total:S.split_broker_total}).eq("id",_);if(D)throw D;n(R=>R.map(P=>P.id===_?S:P)),console.log(" Commission split updated successfully")}catch(k){console.error("Error updating commission split:",k),d("Failed to update commission split")}},w=async _=>{if(e.id)try{if(!s.find(D=>D.id===_))return;const j={deal_id:e.id,broker_id:_,split_origination_percent:0,split_origination_usd:0,split_site_percent:0,split_site_usd:0,split_deal_percent:0,split_deal_usd:0,split_broker_total:0},{data:k,error:S}=await M.from("commission_split").insert(j).select("*").single();if(S)throw S;n([...r,k])}catch(C){console.error("Error adding broker split:",C),d("Failed to add broker split")}},b=async _=>{try{const{error:C}=await M.from("commission_split").delete().eq("id",_);if(C){if(C.code==="23503"&&C.message.includes("payment_split")){d("Cannot delete this broker split because it has related payments. You must delete the payments first, or contact support to safely remove this split.");return}throw C}n(j=>j.filter(k=>k.id!==_)),d(null),m({isOpen:!1,splitId:"",brokerName:""})}catch(C){console.error("Error deleting broker split:",C),d("Failed to delete broker split: "+(C instanceof Error?C.message:"Unknown error")),m({isOpen:!1,splitId:"",brokerName:""})}},g=(_,C)=>{m({isOpen:!0,splitId:_,brokerName:C})},x=()=>{b(u.splitId)},v=()=>{m({isOpen:!1,splitId:"",brokerName:""})},N=s.filter(_=>!r.some(C=>C.broker_id===_.id));return o?i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Broker Commission Splits"}),i.jsx("div",{className:"text-gray-500",children:"Loading..."})]}):i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Broker Commission Splits"}),N.length>0&&i.jsxs("select",{className:"border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",onChange:_=>{_.target.value&&(w(_.target.value),_.target.value="")},defaultValue:"",children:[i.jsx("option",{value:"",children:"+ Add Broker"}),N.map(_=>i.jsx("option",{value:_.id,children:_.name},_.id))]})]}),c&&i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3 mb-4",children:i.jsx("p",{className:"text-red-600 text-sm",children:c})}),r.length===0?i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx("p",{children:"No broker splits configured for this deal."}),N.length>0&&i.jsx("p",{className:"text-sm mt-2",children:"Use the dropdown above to add brokers."})]}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"border-b border-gray-200",children:[i.jsx("th",{className:"text-left py-3 px-3 text-xs font-medium text-gray-500 uppercase tracking-wider w-48",children:"Broker"}),i.jsx("th",{className:"text-center py-3 px-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Origination %"}),i.jsx("th",{className:"text-right py-3 px-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Origination $"}),i.jsx("th",{className:"text-center py-3 px-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Site %"}),i.jsx("th",{className:"text-right py-3 px-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Site $"}),i.jsx("th",{className:"text-center py-3 px-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Deal %"}),i.jsx("th",{className:"text-right py-3 px-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Deal $"}),i.jsx("th",{className:"text-right py-3 px-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total $"}),i.jsx("th",{className:"w-16 text-center py-3 px-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{children:r.map(_=>i.jsxs("tr",{className:"border-b border-gray-100",children:[i.jsx("td",{className:"py-3 px-3 w-48 whitespace-nowrap",children:i.jsx("div",{className:"text-xs text-gray-900 font-medium",children:h(_.broker_id)})}),i.jsx("td",{className:"py-3 px-3 text-center",children:i.jsx(Su,{value:_.split_origination_percent,onChange:C=>y(_.id,"split_origination_percent",C),label:"Origination %"})}),i.jsx("td",{className:"py-3 px-3 text-right text-sm text-gray-900",children:Mr((_.split_origination_percent||0)/100*f.originationUSD)}),i.jsx("td",{className:"py-3 px-3 text-center",children:i.jsx(Su,{value:_.split_site_percent,onChange:C=>y(_.id,"split_site_percent",C),label:"Site %"})}),i.jsx("td",{className:"py-3 px-3 text-right text-sm text-gray-900",children:Mr((_.split_site_percent||0)/100*f.siteUSD)}),i.jsx("td",{className:"py-3 px-3 text-center",children:i.jsx(Su,{value:_.split_deal_percent,onChange:C=>y(_.id,"split_deal_percent",C),label:"Deal %"})}),i.jsx("td",{className:"py-3 px-3 text-right text-sm text-gray-900",children:Mr((_.split_deal_percent||0)/100*f.dealUSD)}),i.jsx("td",{className:"py-3 px-3 text-right text-sm font-medium text-gray-900",children:Mr((_.split_origination_percent||0)/100*f.originationUSD+(_.split_site_percent||0)/100*f.siteUSD+(_.split_deal_percent||0)/100*f.dealUSD)}),i.jsx("td",{className:"py-3 px-3 text-center",children:i.jsx("button",{onClick:()=>g(_.id,h(_.broker_id)),className:"text-red-500 hover:text-red-700 font-bold text-lg",title:"Delete broker split",children:""})})]},_.id))}),i.jsx("tfoot",{children:i.jsxs("tr",{className:"border-t-2 border-gray-300 font-semibold bg-gray-50",children:[i.jsx("td",{className:"py-3 px-3 text-sm text-gray-900",children:"TOTALS"}),i.jsx("td",{className:"py-3 px-3 text-center",children:(()=>{const _=r.reduce((j,k)=>j+(Number(k.split_origination_percent)||0),0),C=Math.abs(_-100)<.1;return i.jsxs("span",{className:`text-sm ${C?"text-blue-600":"text-red-600"}`,children:[_.toFixed(1),"%"]})})()}),i.jsx("td",{className:"py-3 px-3 text-right text-sm text-blue-600",children:Mr(r.reduce((_,C)=>_+(C.split_origination_percent||0)/100*f.originationUSD,0))}),i.jsx("td",{className:"py-3 px-3 text-center",children:(()=>{const _=r.reduce((j,k)=>j+(Number(k.split_site_percent)||0),0),C=Math.abs(_-100)<.1;return i.jsxs("span",{className:`text-sm ${C?"text-blue-600":"text-red-600"}`,children:[_.toFixed(1),"%"]})})()}),i.jsx("td",{className:"py-3 px-3 text-right text-sm text-blue-600",children:Mr(r.reduce((_,C)=>_+(C.split_site_percent||0)/100*f.siteUSD,0))}),i.jsx("td",{className:"py-3 px-3 text-center",children:(()=>{const _=r.reduce((j,k)=>j+(Number(k.split_deal_percent)||0),0),C=Math.abs(_-100)<.1;return i.jsxs("span",{className:`text-sm ${C?"text-blue-600":"text-red-600"}`,children:[_.toFixed(1),"%"]})})()}),i.jsx("td",{className:"py-3 px-3 text-right text-sm text-blue-600",children:Mr(r.reduce((_,C)=>_+(C.split_deal_percent||0)/100*f.dealUSD,0))}),i.jsx("td",{className:"py-3 px-3 text-right text-sm font-semibold text-blue-600",children:Mr(r.reduce((_,C)=>{const j=(C.split_origination_percent||0)/100*f.originationUSD,k=(C.split_site_percent||0)/100*f.siteUSD,S=(C.split_deal_percent||0)/100*f.dealUSD;return _+j+k+S},0))}),i.jsx("td",{className:"py-3 px-3"})]})})]})}),i.jsxs("div",{className:"mt-4 text-sm text-gray-600 space-y-1",children:[i.jsxs("p",{children:[" Split percentages are applied to AGCI: ",Mr(Number(e.agci||0))]}),i.jsx("p",{children:" These splits serve as templates for payment generation"}),i.jsx("p",{children:" Click on percentage values to edit them directly"})]}),i.jsx(h_,{isOpen:u.isOpen,onClose:v,onConfirm:x,title:"Delete Broker Split",itemName:u.brokerName,message:"This action cannot be undone. If this broker has related payments, the deletion will be blocked."})]})},sx=({title:e,help:t,children:r})=>i.jsxs("section",{className:"bg-white rounded-md border p-4 mb-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:e}),t&&i.jsx("span",{className:"text-gray-500 text-xs border rounded-full w-4 h-4 inline-flex items-center justify-center",title:t,"aria-label":t,children:"i"})]}),r]}),ax=new Map,BI=5*60*1e3,UI=({dealId:e,deal:t,onDealUpdate:r,onSwitchToPayments:n})=>{const[s,a]=p.useState(t),[o,l]=p.useState([]),[c,d]=p.useState([]),[u,m]=p.useState([]),[f,h]=p.useState(!0),[y,w]=p.useState(null),b=p.useCallback(j=>{if(!j)return[];const k=[],S=Number(j.origination_percent)||0,D=Number(j.site_percent)||0,R=Number(j.deal_percent)||0,P=Number(j.commission_percent)||0,A=Number(j.referral_fee_percent)||0,I=S+D+R;return I>100&&k.push(`Broker split percentages total ${I.toFixed(1)}% (over 100%)`),P>50&&k.push(`Commission rate ${P.toFixed(1)}% seems high`),A>100&&k.push(`Referral fee ${A.toFixed(1)}% cannot exceed 100%`),k},[]),g=p.useMemo(()=>u.length>0,[u.length]),x=p.useMemo(()=>b(s||t),[s,t,b]);p.useEffect(()=>{a(t)},[t]);const v=p.useCallback(async()=>{const j=ax.get(e),k=Date.now();if(j&&k-j.timestamp<BI){console.log("Using cached commission data for deal:",e),l(j.splits),d(j.brokers),m(j.payments),h(!1);return}try{h(!0);const[S,D]=await Promise.all([M.from("commission_split").select("*").eq("deal_id",e),M.from("broker").select("id, name")]);if(S.error)throw S.error;if(D.error)throw D.error;const R=S.data||[],P=D.data||[];d(P);const A=R.map(U=>{const E=P.find($=>$.id===U.broker_id);return{...U,broker_name:E?E.name:"Unknown Broker"}});l(A);const{data:I,error:L}=await M.from("payment").select("id, payment_sequence, payment_amount, payment_date_estimated, sf_payment_date_actual, deal_id").eq("deal_id",e);if(L)throw L;console.log("CommissionTab fetchCommissionData - payments found:",{dealId:e,paymentsCount:(I==null?void 0:I.length)||0,payments:(I==null?void 0:I.map(U=>({id:U.id,sequence:U.payment_sequence,amount:U.payment_amount,estimated_date:U.payment_date_estimated,actual_date:U.sf_payment_date_actual})))||[]}),m(I||[]);const F={splits:A,brokers:P,payments:I||[],timestamp:Date.now()};ax.set(e,F)}catch(S){const D=S instanceof Error?S.message:"An error occurred";w(D)}finally{h(!1)}},[e]);p.useEffect(()=>{v()},[v]);const N=j=>{const k=j.deal_value||0,S=j.commission_percent||0,D=j.referral_fee_percent||0,R=j.flat_fee_override??k*(S/100),P=R*(D/100),A=R-P,I=A*((j.house_percent||0)/100),L=A-I,F=L*((j.origination_percent||0)/100),U=L*((j.site_percent||0)/100),E=L*((j.deal_percent||0)/100);return{...j,fee:Math.round(R*100)/100,gci:Math.round(A*100)/100,referral_fee_usd:Math.round(P*100)/100,agci:Math.round(L*100)/100,house_usd:Math.round(I*100)/100,origination_usd:Math.round(F*100)/100,site_usd:Math.round(U*100)/100,deal_usd:Math.round(E*100)/100}},_=p.useCallback(async(j,k)=>{if(!s)return;const S={...s,[j]:k},D=["commission_percent","referral_fee_percent","house_percent","origination_percent","site_percent","deal_percent"];let R=S;D.includes(j)&&(R=N(S));const P={commission_percent:R.commission_percent,referral_fee_percent:R.referral_fee_percent,house_percent:R.house_percent,origination_percent:R.origination_percent,site_percent:R.site_percent,deal_percent:R.deal_percent,number_of_payments:R.number_of_payments,fee:R.fee,updated_at:new Date().toISOString()};R.gci!==void 0&&(P.gci=R.gci),R.referral_fee_usd!==void 0&&(P.referral_fee_usd=R.referral_fee_usd),R.agci!==void 0&&(P.agci=R.agci),R.house_usd!==void 0&&(P.house_usd=R.house_usd),R.origination_usd!==void 0&&(P.origination_usd=R.origination_usd),R.site_usd!==void 0&&(P.site_usd=R.site_usd),R.deal_usd!==void 0&&(P.deal_usd=R.deal_usd),j==="referral_payee_client_id"&&R.referral_payee_client_id!==void 0&&(P.referral_payee_client_id=R.referral_payee_client_id);try{console.log("Updating field:",j,"with value:",k),console.log("Update payload:",P);const{data:A,error:I}=await M.from("deal").update(P).eq("id",e).select().single();if(I)throw console.error("Supabase error:",I),I;console.log("Update successful:",A),a(A),r(A)}catch(A){const I=A instanceof Error?A.message:"Failed to save";console.error("Error saving:",A),alert(`Error saving: ${I}`)}},[s,e,r]),C=j=>j==null?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(j);return f?i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsx("div",{className:"text-sm text-gray-600",children:"Loading commission data..."})}):y?i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[i.jsx("h3",{className:"text-sm font-semibold text-red-800 mb-2",children:"Error Loading Commission Data"}),i.jsx("p",{className:"text-sm text-red-600",children:y}),i.jsx("button",{onClick:v,className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 text-sm",children:"Try Again"})]}):s?i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[i.jsx("h3",{className:"text-xs font-medium text-blue-800 mb-1",children:"Deal Fee"}),i.jsx("p",{className:"text-lg font-bold text-blue-900",children:C(s.fee)})]}),i.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[i.jsx("h3",{className:"text-xs font-medium text-purple-800 mb-1",children:"Number of Payments"}),i.jsx("p",{className:"text-lg font-bold text-purple-900",children:s.number_of_payments})]}),i.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[i.jsx("h3",{className:"text-xs font-medium text-orange-800 mb-1",children:"Commission Rate"}),i.jsx("p",{className:"text-lg font-bold text-orange-900",children:s.commission_percent?`${s.commission_percent.toFixed(1)}%`:"0%"})]})]}),x.length>0&&i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Validation Warnings"}),i.jsx("ul",{className:"mt-1 text-xs text-yellow-700 list-disc list-inside",children:x.map((j,k)=>i.jsx("li",{children:j},k))})]})]})}),g&&i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Payments Already Generated"}),i.jsxs("p",{className:"mt-1 text-xs text-yellow-700",children:["This deal already has ",u.length," payment",u.length!==1?"s":""," generated. To regenerate payments, you would need to delete the existing ones first."]})]})]})}),o.length===0&&i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"No Commission Splits Found"}),i.jsx("p",{className:"mt-1 text-xs text-blue-700",children:"Commission splits are imported from Salesforce. If this deal should have commission data, check that it exists in Salesforce and run the migration again."})]})]})}),i.jsx($I,{deal:s,onFieldUpdate:_}),i.jsx(FI,{deal:s,onDealUpdate:r}),i.jsxs(sx,{title:"Payment Management",help:"Manage payments based on commission splits",children:[i.jsx("div",{className:"flex justify-end mb-3",children:i.jsx("button",{onClick:n,className:"px-4 py-2 rounded font-medium text-sm bg-blue-600 text-white hover:bg-blue-700",children:"Go to Payments Tab"})}),o.length===0&&i.jsx("div",{className:"text-center text-gray-500 py-4",children:i.jsx("p",{className:"text-sm",children:"No commission splits available. Commission splits are needed for payment generation."})})]}),o.length>0&&i.jsx(sx,{title:"Quick Summary",help:"Overview of commission allocation",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:[i.jsx("h4",{className:"text-xs font-medium text-green-800 mb-1",children:"Total Commission Splits"}),i.jsx("p",{className:"text-lg font-bold text-green-900",children:o.length})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[i.jsx("h4",{className:"text-xs font-medium text-blue-800 mb-1",children:"Total Broker Amount"}),i.jsx("p",{className:"text-lg font-bold text-blue-900",children:C(o.reduce((j,k)=>j+(k.split_broker_total||0),0))})]}),i.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-3",children:[i.jsx("h4",{className:"text-xs font-medium text-purple-800 mb-1",children:"Payments Status"}),i.jsx("p",{className:"text-lg font-bold text-purple-900",children:g?`${u.length} Generated`:"Not Generated"})]}),i.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-3",children:[i.jsx("h4",{className:"text-xs font-medium text-orange-800 mb-1",children:"Per Payment Amount"}),i.jsx("p",{className:"text-lg font-bold text-orange-900",children:s.number_of_payments&&s.fee?C(s.fee/s.number_of_payments):"$0.00"})]})]})})]}):i.jsx("div",{className:"text-center text-gray-600 py-8",children:i.jsx("p",{className:"text-sm",children:"Deal not found"})})},p_=(e,t=[],r=[])=>{const n=p.useMemo(()=>{const c=e.fee||0,d=e.number_of_payments||1,u=d>0?c/d:0,m=u*d;return{calculatedPaymentAmount:u,totalCalculatedPayments:m}},[e.fee,e.number_of_payments]),s=p.useMemo(()=>{const c=n.calculatedPaymentAmount,d=e.referral_fee_usd||0,u=e.number_of_payments||1,m=d/u,h=(e.house_usd||0)/u,y=c-m-h,w=e.origination_percent||0,b=e.site_percent||0,g=e.deal_percent||0,x=w/100*y,v=b/100*y,N=g/100*y;return{gci:c,referral_fee_usd:m,house_usd:h,agci:y,origination_percent:w,origination_usd:x,site_percent:b,site_usd:v,deal_percent:g,deal_usd:N}},[n.calculatedPaymentAmount,e.fee,e.referral_fee_usd,e.house_usd,e.number_of_payments,e.origination_percent,e.site_percent,e.deal_percent]),a=p.useMemo(()=>c=>c.map(d=>{const u=(d.split_origination_percent||0)/100*s.origination_usd,m=(d.split_site_percent||0)/100*s.site_usd,f=(d.split_deal_percent||0)/100*s.deal_usd,h=u+m+f;return{broker_id:d.broker_id||"",origination_amount:u,site_amount:m,deal_amount:f,total_amount:h}}),[s]),o=p.useMemo(()=>{const c=[];let d=!0;return(!e.fee||e.fee<=0)&&(c.push("Commission fee is not set"),d=!1),(!e.number_of_payments||e.number_of_payments<1)&&(c.push("Number of payments must be at least 1"),d=!1),e.number_of_payments&&e.number_of_payments>10&&(c.push("Number of payments cannot exceed 10"),d=!1),(e.origination_percent||0)+(e.site_percent||0)+(e.deal_percent||0)===0&&c.push("Commission split percentages are not configured"),{canGeneratePayments:d,validationMessages:c}},[e.fee,e.number_of_payments,e.origination_percent,e.site_percent,e.deal_percent]),l=p.useMemo(()=>t.map(c=>({payment_id:c.payment_id,calculated_amount:n.calculatedPaymentAmount,database_amount:c.payment_amount||0,needs_update:Math.abs((c.payment_amount||0)-n.calculatedPaymentAmount)>.01})),[t,n.calculatedPaymentAmount]);return{calculatedPaymentAmount:n.calculatedPaymentAmount,totalCalculatedPayments:n.totalCalculatedPayments,paymentCommissionBreakdown:s,calculateBrokerSplitsForPayment:a,canGeneratePayments:o.canGeneratePayments,validationMessages:o.validationMessages,paymentComparisons:l}},WI=({deal:e,hasPayments:t,existingPayments:r=[],commissionSplits:n=[],onGeneratePayments:s,onUpdatePaymentAmounts:a,generatingPayments:o})=>{const{calculatedPaymentAmount:l,totalCalculatedPayments:c,paymentCommissionBreakdown:d,canGeneratePayments:u,validationMessages:m,paymentComparisons:f}=p_(e,r,n),h=e.number_of_payments||1,y=g=>g.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),w=f.some(g=>g.needs_update);r.length<h;const b=r.length===h;return i.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Payment Generation"}),t&&i.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[r.length," of ",h," Payments Created"]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"font-medium text-gray-900",children:"Payment Actions"}),i.jsxs("div",{className:"space-y-3",children:[b?i.jsxs("div",{className:"text-sm text-green-600 bg-green-50 border border-green-200 rounded-md p-3",children:[i.jsx("div",{className:"font-medium mb-1",children:" All Payments Created"}),i.jsxs("div",{children:["All ",h," payments have been created for this deal."]})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:s,disabled:!u||o,className:`w-full px-4 py-3 rounded-md font-medium transition-colors ${u&&!o?"bg-blue-600 text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:o?i.jsxs("div",{className:"flex items-center justify-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),t?"Creating Additional Payments...":"Generating Payments..."]}):t?`Create Remaining ${h-r.length} Payments`:`Generate ${h} Payment${h>1?"s":""}`}),t&&i.jsxs("div",{className:"text-sm text-blue-600 bg-blue-50 border border-blue-200 rounded-md p-3",children:[i.jsx("div",{className:"font-medium mb-1",children:" Safe Generation"}),i.jsx("div",{children:"This will create the remaining payments without affecting existing payment records or their associated invoice data."})]})]}),t&&w&&a&&i.jsx("button",{onClick:a,disabled:o,className:"w-full px-4 py-2 border border-amber-300 bg-amber-50 text-amber-700 rounded-md font-medium hover:bg-amber-100 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:"Update Payment Amounts"}),!u&&i.jsxs("div",{className:"text-sm text-gray-600 bg-gray-50 border border-gray-200 rounded-md p-3",children:[i.jsx("div",{className:"font-medium mb-1",children:"Configuration Required"}),i.jsx("div",{children:"Complete commission configuration in the Commission tab before generating payments."})]})]}),u&&h>1||t&&f.length>0?i.jsxs("div",{className:"mt-4 grid grid-cols-1 lg:grid-cols-2 gap-4",children:[u&&h>1&&i.jsxs("div",{className:"p-3 bg-green-50 border border-green-200 rounded-md",children:[i.jsx("div",{className:"text-sm font-medium text-green-800 mb-2",children:"Payment Schedule Preview"}),i.jsxs("div",{className:"text-sm text-green-700 space-y-1",children:[Array.from({length:h},(g,x)=>{const v=r.find(N=>N.payment_sequence===x+1);return i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("span",{children:["Payment ",x+1,":"]}),i.jsxs("div",{className:"text-right",children:[i.jsxs("div",{className:`font-medium ${v?"text-green-600":""}`,children:["$",y(l),v&&" "]}),i.jsxs("div",{className:"text-xs text-green-600 opacity-75",children:["AGCI: $",y(d.agci)]})]})]},x)}),i.jsxs("div",{className:"flex justify-between border-t pt-1 font-semibold",children:[i.jsx("span",{children:"Total:"}),i.jsxs("div",{className:"text-right",children:[i.jsxs("div",{children:["$",y(c)]}),i.jsxs("div",{className:"text-xs text-green-600 opacity-75 font-normal",children:["Total AGCI: $",y(d.agci*h)]})]})]})]})]}),t&&f.length>0&&i.jsxs("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded-md",children:[i.jsx("div",{className:"text-sm font-medium text-gray-800 mb-2",children:"Current vs Calculated"}),i.jsx("div",{className:"text-sm text-gray-700 space-y-1",children:f.map((g,x)=>i.jsxs("div",{className:"flex justify-between",children:[i.jsxs("span",{children:["Payment ",x+1,":"]}),i.jsxs("span",{className:g.needs_update?"text-amber-700 font-medium":"text-gray-600",children:["$",y(g.database_amount),"  $",y(g.calculated_amount),g.needs_update&&" "]})]},x))})]})]}):null]})]})};function HI({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"}))}const zI=p.forwardRef(HI),VI=zI;function YI({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 15 3 9m0 0 6-6M3 9h12a6 6 0 0 1 0 12h-3"}))}const qI=p.forwardRef(YI),ix=qI;function GI({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"}))}const KI=p.forwardRef(GI),Rs=KI;function QI({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const JI=p.forwardRef(QI),bc=JI;function XI({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))}const ZI=p.forwardRef(XI),ox=ZI;function eM({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))}const tM=p.forwardRef(eM),dd=tM;function rM({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"}))}const nM=p.forwardRef(rM),Qh=nM;function sM({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 15.75 7.5-7.5 7.5 7.5"}))}const aM=p.forwardRef(sM),iM=aM;function oM({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const lM=p.forwardRef(oM),g_=lM;function cM({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const dM=p.forwardRef(cM),uM=dM;function fM({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"}))}const mM=p.forwardRef(fM),ud=mM;function hM({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const pM=p.forwardRef(hM),gM=pM;function xM({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const yM=p.forwardRef(xM),vM=yM;function bM({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"}))}const wM=p.forwardRef(bM),_M=wM;function jM({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const NM=p.forwardRef(jM),em=NM;function kM({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m18.375 12.739-7.693 7.693a4.5 4.5 0 0 1-6.364-6.364l10.94-10.94A3 3 0 1 1 19.5 7.372L8.552 18.32m.009-.01-.01.01m5.699-9.941-7.81 7.81a1.5 1.5 0 0 0 2.112 2.13"}))}const SM=p.forwardRef(kM),CM=SM;function DM({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))}const EM=p.forwardRef(DM),PM=EM;function TM({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 0 0 2.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 0 1-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 0 0-1.091-.852H4.5A2.25 2.25 0 0 0 2.25 4.5v2.25Z"}))}const RM=p.forwardRef(TM),va=RM;function LM({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const IM=p.forwardRef(LM),lx=IM;function MM({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"}))}const OM=p.forwardRef(MM),wc=OM;function AM({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const $M=p.forwardRef(AM),x_=$M,y_=e=>{if(!e)return"Unknown";const[t,r,n]=e.split("-").map(Number);return new Date(t,r-1,n).toLocaleDateString()},zn=(e,t="Not set")=>e?y_(e):t,FM=e=>e||"",BM=({payment:e,totalPayments:t,isExpanded:r,onToggleExpansion:n,onUpdatePayment:s,onDeletePayment:a})=>(console.log(" PaymentSummaryRow payment dates:",{id:e.id,payment_sequence:e.payment_sequence,payment_date_estimated:e.payment_date_estimated,payment_received_date:e.payment_received_date}),i.jsxs("div",{className:"p-4 grid grid-cols-12 items-center gap-4",children:[i.jsxs("div",{className:"col-span-3 flex items-center space-x-3",children:[i.jsx("button",{onClick:n,className:"p-1 hover:bg-gray-200 rounded flex-shrink-0",children:r?i.jsx(dd,{className:"h-4 w-4 text-gray-500"}):i.jsx(Qh,{className:"h-4 w-4 text-gray-500"})}),i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsxs("div",{className:"text-sm font-medium text-gray-900 truncate",children:["Payment ",e.payment_sequence," of ",t]}),i.jsxs("div",{className:"text-xs text-gray-500",children:["$",(e.payment_amount||0).toLocaleString("en-US",{minimumFractionDigits:2})]})]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Invoice #"}),i.jsx("div",{className:"text-sm text-gray-900",children:e.orep_invoice||"-"})]}),i.jsxs("div",{className:"col-span-2 flex items-center space-x-2",children:[i.jsx("input",{type:"checkbox",checked:e.payment_received||!1,onChange:o=>s({payment_received:o.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded flex-shrink-0"}),i.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${e.payment_received?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:e.payment_received?"Received":"Pending"})]}),i.jsx("div",{className:"col-span-3",children:e.payment_received?i.jsx("div",{className:"w-full px-2 py-1 text-sm",children:i.jsxs("div",{className:"font-medium text-green-800",children:["Paid Date: ",y_(e.payment_received_date)]})}):i.jsxs("div",{children:[e.payment_date_estimated&&i.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Estimated Pmt Date"}),i.jsx("input",{type:"date",value:e.payment_date_estimated||"",onChange:o=>s({payment_date_estimated:o.target.value}),className:"w-full border border-gray-300 rounded-md px-2 py-1 text-sm",placeholder:"Estimated payment date"}),!e.payment_date_estimated&&i.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Set estimated payment date"})]})}),i.jsx("div",{className:"col-span-2 text-right",children:i.jsx("button",{onClick:a,className:"text-red-600 hover:text-red-900 text-sm whitespace-nowrap",children:"Delete"})})]})),UM=({split:e,brokerName:t,paymentAmount:r,onPercentageChange:n,validationTotals:s})=>i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[i.jsxs("div",{className:"flex justify-between items-start mb-4",children:[i.jsx("div",{children:i.jsx("h5",{className:"text-sm font-medium text-gray-900",children:t})}),i.jsx("div",{className:"text-right",children:i.jsxs("div",{className:"text-sm font-semibold text-gray-900",children:["$",(e.split_broker_total||0).toLocaleString("en-US",{minimumFractionDigits:2})]})})]}),i.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[i.jsxs("div",{className:"bg-white rounded-md p-2 border border-gray-200",children:[i.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Origination"}),i.jsx(Br,{label:"",value:e.split_origination_percent||0,onChange:a=>n("split_origination_percent",a)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["$",(e.split_origination_usd||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),i.jsxs("div",{className:"bg-white rounded-md p-2 border border-gray-200",children:[i.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Site"}),i.jsx(Br,{label:"",value:e.split_site_percent||0,onChange:a=>n("split_site_percent",a)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["$",(e.split_site_usd||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),i.jsxs("div",{className:"bg-white rounded-md p-2 border border-gray-200",children:[i.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Deal"}),i.jsx(Br,{label:"",value:e.split_deal_percent||0,onChange:a=>n("split_deal_percent",a)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["$",(e.split_deal_usd||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),i.jsxs("div",{className:"bg-white rounded-md p-2 border border-gray-200",children:[i.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Total"}),i.jsxs("div",{className:`text-sm font-semibold ${s&&!s.isValid?"text-red-600":"text-blue-600"}`,children:["$",(e.split_broker_total||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]}),s&&!s.isValid&&i.jsx("div",{className:"text-xs text-red-500 mt-1",children:"Check totals"})]})]})]}),Vs=e=>e==null||isNaN(e)?"$0.00":`$${e.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`,cx=({payeeName:e,amount:t,paid:r,onTogglePaid:n,disabled:s=!1})=>{const a=()=>{s||n(!r)};return i.jsxs("div",{className:`
        flex items-center justify-between p-4 rounded-lg border-2 transition-all duration-200 cursor-pointer
        ${r?"bg-green-50 border-green-200 hover:border-green-300":"bg-white border-gray-200 hover:border-gray-300"}
        ${s?"opacity-50 cursor-not-allowed":"hover:shadow-sm"}
      `,onClick:a,role:"button",tabIndex:0,onKeyDown:o=>{(o.key==="Enter"||o.key===" ")&&!s&&(o.preventDefault(),a())},"aria-label":`${r?"Mark as unpaid":"Mark as paid"} - ${e} - ${Vs(t)}`,children:[i.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[i.jsx("div",{className:`
          flex-shrink-0 w-6 h-6 rounded-md border-2 flex items-center justify-center transition-all duration-200
          ${r?"bg-green-500 border-green-500":"bg-white border-gray-300 hover:border-green-400"}
        `,children:r&&i.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:`
            text-sm font-medium truncate transition-colors duration-200
            ${r?"text-green-900":"text-gray-900"}
          `,children:e}),i.jsx("p",{className:`
            text-xs transition-colors duration-200
            ${r?"text-green-700":"text-gray-500"}
          `,children:r?"Check written":"Pending payment"})]})]}),i.jsxs("div",{className:"flex-shrink-0 text-right",children:[i.jsx("p",{className:`
          text-lg font-semibold transition-colors duration-200
          ${r?"text-green-900":"text-gray-900"}
        `,children:Vs(t)}),r&&i.jsxs("div",{className:"flex items-center justify-end mt-1",children:[i.jsx("svg",{className:"w-3 h-3 text-green-600 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),i.jsx("span",{className:"text-xs text-green-600 font-medium",children:"Paid"})]})]})]})},WM=({isOpen:e,onClose:t,payment:r,deal:n,clients:s,brokers:a,paymentSplits:o,onUpdateReferralPaid:l,onUpdatePaymentSplitPaid:c})=>{const[d,u]=p.useState([]),[m,f]=p.useState(!1);p.useEffect(()=>{if(e){const v=[];if(n.referral_payee_client_id&&n.referral_fee_usd&&n.referral_fee_usd>0){const N=s.find(k=>k.id===n.referral_payee_client_id),_=n.fee||n.deal_usd||0,C=r.payment_amount||0,j=_>0?n.referral_fee_usd*(C/_):0;j>0&&v.push({id:`referral-${r.id}`,type:"referral",payeeName:(N==null?void 0:N.client_name)||"Unknown Referral Client",amount:j,paid:r.referral_fee_paid||!1})}console.log(" Payment splits for disbursement modal:",o),o.forEach(N=>{const _=a.find(j=>j.id===N.broker_id),C=N.paid||!1;console.log(" Processing split:",{paymentSplitId:N.id,brokerName:_==null?void 0:_.name,brokerPaid:C,amount:N.split_broker_total}),N.split_broker_total&&N.split_broker_total>0&&v.push({id:N.id,type:"broker",payeeName:(_==null?void 0:_.name)||"Unknown Broker",amount:N.split_broker_total,paid:C})}),u(v)}},[e,r,n,s,a,o]);const h=async(v,N)=>{f(!0);try{v.type==="referral"?await l(r.id,N):await c(v.id,N),u(_=>_.map(C=>C.id===v.id?{...C,paid:N}:C))}catch(_){console.error("Error updating disbursement status:",_)}finally{f(!1)}},y=r.payment_amount||0,w=d.reduce((v,N)=>v+(N.paid?N.amount:0),0),b=y-w,g=d.filter(v=>v.paid).length,x=d.length;return e?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full mx-4 max-h-[90vh] overflow-hidden flex flex-col",children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-green-500 to-green-600 rounded-lg flex items-center justify-center shadow-sm",children:i.jsx("span",{className:"text-white text-sm",children:""})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Payment Disbursement"}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Payment ",r.payment_sequence," - ",Vs(y)]})]})]}),i.jsx("button",{onClick:t,className:"w-8 h-8 flex items-center justify-center rounded-lg hover:bg-gray-100 transition-colors",disabled:m,children:i.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsxs("div",{className:"p-4 bg-gray-50 border-b border-gray-200",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Disbursement Progress: ",g," of ",x," checks written"]}),i.jsxs("span",{className:"text-sm text-gray-600",children:[Math.round(g/Math.max(x,1)*100),"% Complete"]})]}),i.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:i.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:`${g/Math.max(x,1)*100}%`}})})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:d.length===0?i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx("span",{className:"text-gray-400 text-2xl",children:""})}),i.jsx("p",{className:"text-gray-700 font-medium mb-2",children:"No Disbursements Required"}),i.jsx("p",{className:"text-sm text-gray-500",children:"This payment has no referral fees or broker commissions to disburse."})]}):i.jsxs("div",{className:"space-y-4",children:[d.some(v=>v.type==="referral")&&i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-medium text-gray-700 uppercase tracking-wide mb-3",children:"Referral Payments"}),i.jsx("div",{className:"space-y-2",children:d.filter(v=>v.type==="referral").map(v=>i.jsx(cx,{payeeName:v.payeeName,amount:v.amount,paid:v.paid,onTogglePaid:N=>h(v,N),disabled:m},v.id))})]}),d.some(v=>v.type==="broker")&&i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-medium text-gray-700 uppercase tracking-wide mb-3",children:"Broker Commissions"}),i.jsx("div",{className:"space-y-2",children:d.filter(v=>v.type==="broker").map(v=>i.jsx(cx,{payeeName:v.payeeName,amount:v.amount,paid:v.paid,onTogglePaid:N=>h(v,N),disabled:m},v.id))})]})]})}),d.length>0&&i.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:i.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Payment Received:"}),i.jsx("p",{className:"font-semibold text-gray-900",children:Vs(y)})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Disbursed:"}),i.jsx("p",{className:"font-semibold text-green-600",children:Vs(w)})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Remaining:"}),i.jsx("p",{className:`font-semibold ${b>=0?"text-gray-900":"text-red-600"}`,children:Vs(b)})]})]})})]})}):null},HM=({payment:e,deal:t,clients:r,brokers:n,paymentSplits:s,commissionSplits:a,onUpdatePayment:o,onUpdateReferralPaid:l,onUpdatePaymentSplitPaid:c})=>{const[d,u]=p.useState(!1),m=()=>{if(!t.referral_payee_client_id)return"No referral payee set";if(!r||r.length===0)return"Client data not available";const w=r.find(b=>b.id===t.referral_payee_client_id);return w?w.client_name||"Unknown Client":"Client not found"},f=()=>{if(!t.referral_fee_usd||t.referral_fee_usd===0)return 0;const w=t.fee||t.deal_usd||0,b=e.payment_amount||0;return w===0?0:t.referral_fee_usd*(b/w)},h=(w,b,g=!1)=>{const x=e[b];return i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:w}),g&&x&&i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:zn(x)}),i.jsx("input",{type:"date",value:FM(x),onChange:v=>o({[b]:v.target.value||null}),className:"w-full border border-gray-300 rounded-md px-2 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})},y=(w,b,g)=>{const x=e[b];return i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:w}),i.jsx("input",{type:"text",value:x||"",onChange:v=>o({[b]:v.target.value||null}),placeholder:g,className:"w-full border border-gray-300 rounded-md px-2 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})};return i.jsxs("div",{className:"border-t border-gray-200 bg-gray-50",children:[i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-4",children:"Payment Details"}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h5",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide mb-3",children:"Payment Dates & Tracking"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-4 md:gap-6",children:[h("Estimated Payment Date","payment_date_estimated"),h("Payment Received Date","payment_received_date"),h("Invoice Date","payment_invoice_date"),y("OREP Invoice","orep_invoice","Enter OREP Invoice number")]})]}),(t.referral_payee_client_id||t.referral_fee_usd||t.referral_fee_percent)&&i.jsxs("div",{className:"mb-6",children:[i.jsx("h5",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide mb-3",children:"Referral Information"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"Referral Payee"}),i.jsx("div",{className:"w-full px-3 py-2 text-sm bg-gray-100 border border-gray-200 rounded-md text-gray-600",children:m()})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"Referral Fee"}),i.jsx("div",{className:"w-full px-3 py-2 text-sm bg-gray-100 border border-gray-200 rounded-md text-gray-600",children:(()=>{const w=f(),b=t.referral_fee_usd||0;return w===0?"No referral fee for this payment":i.jsxs(i.Fragment,{children:["$",w.toLocaleString("en-US",{minimumFractionDigits:2}),i.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["($",b.toLocaleString("en-US",{minimumFractionDigits:2})," total)"]}),t.referral_fee_percent&&i.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(",t.referral_fee_percent,"%)"]})]})})()})]})]})]}),(e.sf_payment_date_est||e.sf_payment_date_actual||e.sf_payment_date_received||e.sf_payment_invoice_date)&&i.jsxs("div",{className:"mt-6",children:[i.jsx("h5",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide mb-3",children:"Salesforce Date Fields (Read-only)"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-xs",children:[e.sf_payment_date_est&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-600",children:"SF Est Date:"})," ",i.jsx("span",{className:"text-gray-500",children:zn(e.sf_payment_date_est)})]}),e.sf_payment_date_actual&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-600",children:"SF Actual Date:"})," ",i.jsx("span",{className:"text-gray-500",children:zn(e.sf_payment_date_actual)})]}),e.sf_payment_date_received&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-600",children:"SF Received Date:"})," ",i.jsx("span",{className:"text-gray-500",children:zn(e.sf_payment_date_received)})]}),e.sf_payment_invoice_date&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-600",children:"SF Invoice Date:"})," ",i.jsx("span",{className:"text-gray-500",children:zn(e.sf_payment_invoice_date)})]})]})]}),i.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-xs text-gray-500",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Payment Received:"})," ",e.payment_received?"Yes":"No",e.payment_received_date&&i.jsxs("span",{className:"ml-1",children:["(",zn(e.payment_received_date),")"]})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"SF Payment Status:"})," ",e.sf_payment_status||"Not set"]}),e.qb_sync_status&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"QB Sync Status:"})," ",e.qb_sync_status]}),e.qb_last_sync&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Last QB Sync:"})," ",zn(e.qb_last_sync)]})]})}),i.jsx("div",{className:"mt-6 p-4 border border-blue-200 rounded-lg bg-blue-50",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("input",{type:"checkbox",id:`payment-received-${e.id}`,checked:e.payment_received||!1,onChange:async w=>{const b=w.target.checked;await o({payment_received:b}),b&&(t.referral_fee_usd&&t.referral_fee_usd>0||s&&s.some(g=>(g.split_broker_total||0)>0))&&u(!0)},className:"h-5 w-5 text-blue-600 rounded border-2 border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:`payment-received-${e.id}`,className:"text-sm font-semibold text-blue-900 cursor-pointer",children:"Payment Received"}),i.jsx("p",{className:"text-xs text-blue-700",children:e.payment_received?"Payment has been received - manage disbursements below":"Check when payment is received to manage disbursements"})]})]}),e.payment_received&&i.jsx("button",{onClick:()=>u(!0),className:"px-3 py-1.5 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Manage Disbursements"})]})})]}),d&&i.jsx(WM,{isOpen:d,onClose:()=>u(!1),payment:e,deal:t,clients:r||[],brokers:n||[],paymentSplits:s||[],onUpdateReferralPaid:l||(async()=>{}),onUpdatePaymentSplitPaid:c||(async()=>{})})]})},zM=e=>{const t={deal:0,site:0,origination:0,isValid:!0};return e.forEach(r=>{t.deal+=r.split_deal_percent||0,t.site+=r.split_site_percent||0,t.origination+=r.split_origination_percent||0}),t.isValid=t.deal===100&&t.site===100&&t.origination===100,t},VM=(e,t,r,n)=>e.map(s=>{let a=s.split_origination_usd||0,o=s.split_site_usd||0,l=s.split_deal_usd||0,c=s.split_broker_total||0;if(r&&n){const d=r.number_of_payments||1,u=(r.referral_fee_usd||0)/d,m=(r.house_usd||0)/d,f=n-u-m,h=(r.origination_percent||0)/100*f,y=(r.site_percent||0)/100*f,w=(r.deal_percent||0)/100*f;a=h*(s.split_origination_percent||0)/100,o=y*(s.split_site_percent||0)/100,l=w*(s.split_deal_percent||0)/100,c=a+o+l}return{...s,split_origination_usd:a,split_site_usd:o,split_deal_usd:l,split_broker_total:c}}),YM=()=>{const[e,t]=p.useState(!1),[r,n]=p.useState(null),s=p.useCallback(async u=>{t(!0),n(null);try{const{data:m,error:f}=await M.from("payment").select("*").eq("id",u).single();if(f)throw f;const{data:h,error:y}=await M.from("payment_split").select("*").eq("payment_id",u);if(y)throw y;return{payment:m,paymentSplits:h||[]}}catch(m){const f=m instanceof Error?m.message:"Failed to load disbursement data";return n(f),console.error("Error loading disbursement data:",m),null}finally{t(!1)}},[]),a=p.useCallback(async(u,m)=>{t(!0),n(null);try{const{error:f}=await M.from("payment").update({referral_fee_paid:m}).eq("id",u);if(f)throw f}catch(f){const h=f instanceof Error?f.message:"Failed to update referral payment status";throw n(h),console.error("Error updating referral paid status:",f),f}finally{t(!1)}},[]),o=p.useCallback(async(u,m)=>{t(!0),n(null),console.log(" Updating payment split paid status:",{splitId:u,paid:m});try{const{error:f,data:h}=await M.from("payment_split").update({paid:m}).eq("id",u).select();if(f)throw console.error(" Supabase error updating payment split:",f),f;console.log(" Payment split updated successfully:",h)}catch(f){const h=f instanceof Error?f.message:"Failed to update payment split status";throw n(h),console.error("Error updating payment split paid status:",f),f}finally{t(!1)}},[]),l=p.useCallback((u,m,f)=>{const h=u.payment_amount||0,y=f||0,w=u.referral_fee_paid&&y>0?y:0,b=m.reduce((S,D)=>S+(D.paid&&D.split_broker_total||0),0),g=w+b,x=h-g,v=y>0?1:0,N=m.filter(S=>(S.split_broker_total||0)>0).length,_=v+N,C=u.referral_fee_paid&&y>0?1:0,j=m.filter(S=>S.paid&&(S.split_broker_total||0)>0).length,k=C+j;return{paymentAmount:h,referralAmount:y,referralDisbursed:w,brokerDisbursed:b,totalDisbursed:g,remainingBalance:x,totalItems:_,paidItems:k,completionPercentage:_>0?Math.round(k/_*100):0,isOverDisbursed:g>h,isFullyDisbursed:k===_&&_>0}},[]),c=p.useCallback((u,m)=>m>u?{isValid:!1,message:`Disbursements exceed payment by $${(m-u).toLocaleString("en-US",{minimumFractionDigits:2})}`}:{isValid:!0},[]),d=p.useCallback(()=>{n(null)},[]);return{loading:e,error:r,loadDisbursementData:s,updateReferralPaid:a,updatePaymentSplitPaid:o,calculateDisbursementTotals:l,validateDisbursement:c,clearError:d}},qM=({payment:e,splits:t,brokers:r,clients:n,commissionSplits:s,dealAmounts:a,deal:o,onSplitPercentageChange:l,onUpdatePayment:c,onUpdatePaymentSplit:d})=>{const[u,m]=p.useState(!1),f=_=>{const C=r.find(j=>j.id===_);return C?C.name:"Unknown Broker"},y=(()=>{const _=e.payment_amount||0,C=o.number_of_payments||1,j=(o.referral_fee_usd||0)/C,k=(o.house_usd||0)/C;return _-j-k})(),w=VM(t,a,o,e.payment_amount||0),b=zM(w),{updateReferralPaid:g,updatePaymentSplitPaid:x}=YM(),v=async(_,C)=>{try{await g(_,C)}catch(j){console.error("Error updating referral payment status:",j)}},N=async(_,C)=>{try{await x(_,C),d&&(await d(_,{paid:C}),console.log(" Payment split paid status updated, parent state refreshed"))}catch(j){console.error("Error updating payment split status:",j)}};return i.jsxs("div",{className:"border-t border-gray-200 bg-white",children:[i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h4",{className:"text-base font-medium text-gray-900",children:"Commission Breakdown"}),i.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Payment #",e.payment_sequence,"  AGCI: $",y.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),i.jsx("div",{className:"space-y-4",children:w.map(_=>i.jsx(UM,{split:_,brokerName:f(_.broker_id),paymentAmount:e.payment_amount||0,onPercentageChange:(C,j)=>l(_.id,C,j),validationTotals:b},_.id))}),!b.isValid&&i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mt-4",children:[i.jsx("div",{className:"text-sm font-medium text-red-800",children:"Percentage Validation Errors:"}),i.jsxs("div",{className:"text-xs text-red-600 mt-1",children:[b.origination!==100&&`Origination: ${b.origination}% `,b.site!==100&&`Site: ${b.site}% `,b.deal!==100&&`Deal: ${b.deal}% `,"(must equal 100% each)"]})]})]}),i.jsxs("div",{className:"border-t border-gray-200",children:[i.jsx("div",{className:"p-4 bg-gray-50 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>m(!u),children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Payment Details"}),i.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Dates, tracking, and referral information"})]}),i.jsx("button",{className:"p-1 hover:bg-gray-200 rounded",children:u?i.jsx(dd,{className:"h-4 w-4 text-gray-500"}):i.jsx(Qh,{className:"h-4 w-4 text-gray-500"})})]})}),u&&i.jsx(HM,{payment:e,deal:o,clients:n,brokers:r,paymentSplits:t,commissionSplits:s,onUpdatePayment:c,onUpdateReferralPaid:v,onUpdatePaymentSplitPaid:N})]})]})},GM=({payments:e,paymentSplits:t,brokers:r,clients:n,commissionSplits:s,deal:a,onUpdatePayment:o,onDeletePayment:l,onUpdatePaymentSplit:c})=>{const[d,u]=p.useState(new Set),[m,f]=p.useState(!1),[h,y]=p.useState(null),w=N=>{u(_=>{const C=new Set(_);return C.has(N)?C.delete(N):C.add(N),C})},b=N=>t.filter(_=>_.payment_id===N),g=N=>{y(N),f(!0)},x=async()=>{if(h)try{await l(h.id),f(!1),y(null)}catch(N){console.error("Error deleting payment:",N)}},v=async(N,_,C)=>{try{const{error:j}=await M.from("payment_split").update({[_]:C||0}).eq("id",N);if(j)throw console.error("Supabase error:",j),j;c&&await c(N,_,C)}catch(j){console.error("Error updating payment split:",j),alert("Failed to update split percentage. Please try again.")}};return i.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg",children:[i.jsxs("div",{className:"p-6 border-b border-gray-200",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Payment Management"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage individual payments and track their status"})]}),i.jsx("div",{className:"space-y-3",children:e.map(N=>{const _=b(N.id),C=d.has(N.id);return i.jsxs("div",{className:"border border-gray-200 rounded-lg bg-white",children:[i.jsx(BM,{payment:N,totalPayments:e.length,isExpanded:C,onToggleExpansion:()=>w(N.id),onUpdatePayment:j=>o(N.id,j),onDeletePayment:()=>g(N)}),C&&i.jsx(qM,{payment:N,splits:_,brokers:r,clients:n,commissionSplits:s,dealAmounts:{origination_usd:a.origination_usd||0,site_usd:a.site_usd||0,deal_usd:a.deal_usd||0},deal:a,onSplitPercentageChange:v,onUpdatePayment:j=>o(N.id,j),onUpdatePaymentSplit:async(j,k)=>{c&&k.paid!==void 0&&await c(j,"paid",k.paid)}})]},N.id)})}),i.jsx(h_,{isOpen:m,onClose:()=>f(!1),onConfirm:x,title:"Delete Payment",itemName:h?`Payment ${h.payment_sequence} of ${e.length}`:"",message:"This will permanently delete the payment and all associated commission splits. This action cannot be undone."})]})},KM=({statusSummary:e,hasOverdue:t,completionRate:r})=>i.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[i.jsxs("div",{className:"mb-3",children:[i.jsx("div",{className:"text-sm font-medium text-gray-600",children:"Payment Status"}),e.total>0&&i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["(",Math.round(r),"% complete)"]})]}),i.jsxs("div",{className:"flex flex-wrap gap-2 text-xs",children:[e.received>0&&i.jsx("div",{className:"px-2 py-1 bg-green-100 rounded whitespace-nowrap",children:i.jsxs("span",{className:"text-green-800 font-bold",children:[" Received ",e.received]})}),e.sent>0&&i.jsx("div",{className:"px-2 py-1 bg-blue-100 rounded whitespace-nowrap",children:i.jsxs("span",{className:"text-blue-800 font-bold",children:[" Sent ",e.sent]})}),e.pending>0&&i.jsx("div",{className:"px-2 py-1 bg-yellow-100 rounded whitespace-nowrap",children:i.jsxs("span",{className:"text-yellow-800 font-bold",children:[" Pending ",e.pending]})}),e.overdue>0&&i.jsx("div",{className:"px-2 py-1 bg-red-100 rounded whitespace-nowrap",children:i.jsxs("span",{className:"text-red-800 font-bold",children:[" Overdue ",e.overdue]})})]}),t&&i.jsxs("div",{className:"mt-3 p-2 bg-red-50 border border-red-200 rounded text-xs text-red-700",children:[i.jsx("strong",{children:"Action needed:"})," ",e.overdue," payment",e.overdue!==1?"s":"",e.overdue===1?" is":" are"," overdue and require",e.overdue===1?"s":""," attention."]}),e.total>0&&i.jsx("div",{className:"mt-3",children:i.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:i.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:`${r}%`}})})})]}),QM=({deal:e,commissionSplits:t=[],onEditClick:r,className:n=""})=>{const{baseAmounts:s}=Kh(e,t),{gci:a,houseUsd:o,agci:l,originationPercent:c,sitePercent:d,dealPercent:u,originationUSD:m,siteUSD:f,dealUSD:h,totalDealUSD:y}=s,w=e.fee||0,b=e.referral_fee_percent||0,g=e.referral_fee_usd||b/100*w,x=D=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(D),v=w>0?o/w*100:0,N=w>0?g/w*100:0,_=w>0?o/w*100:0,C=w>0?m/w*100:0,j=w>0?f/w*100:0,k=w>0?h/w*100:0,S=N>0||_>0||C>0||j>0||k>0;return!e.fee||e.fee===0?i.jsxs("div",{className:`bg-white rounded-lg border p-4 ${n}`,children:[i.jsx("div",{className:"text-sm text-gray-500",children:"Commission breakdown will appear when commission fee is set"}),r&&i.jsx("button",{onClick:r,className:"mt-2 text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Set Commission Details "})]}):i.jsxs("div",{className:`bg-white rounded-lg border p-4 ${n}`,children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4",children:[i.jsxs("div",{className:"flex items-center flex-wrap gap-x-4 gap-y-2 text-sm",children:[i.jsxs("span",{className:"font-medium text-gray-900",children:["Total Commission: ",i.jsx("span",{className:"text-green-600",children:x(w)})]}),g>0&&i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"text-gray-400",children:""}),i.jsxs("span",{className:"text-gray-600",children:["Referral: ",i.jsx("span",{className:"text-orange-600",children:x(g)})]})]}),o>0&&i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"text-gray-400",children:""}),i.jsxs("span",{className:"text-gray-600",children:["House: ",i.jsx("span",{className:"text-gray-600",children:x(o)})]})]}),i.jsx("span",{className:"text-gray-400",children:""}),i.jsxs("span",{className:"text-gray-600",children:["AGCI: ",i.jsx("span",{className:"text-blue-600 font-medium",children:x(l)})]})]}),r&&i.jsx("button",{onClick:r,className:"mt-2 sm:mt-0 px-3 py-1 text-sm bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-md transition-colors",children:"Edit Commission"})]}),S&&i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex h-8 bg-gray-200 rounded-lg overflow-hidden",children:[N>0&&i.jsx("div",{className:"bg-orange-500 flex items-center justify-center relative group",style:{width:`${N}%`},title:`Referral: ${b}% of total - ${x(g)}`,children:N>15&&i.jsxs("span",{className:"text-white text-xs font-medium",children:[b.toFixed(1),"%"]})}),_>0&&i.jsx("div",{className:"bg-gray-500 flex items-center justify-center relative group",style:{width:`${_}%`},title:`House: ${v.toFixed(1)}% of total - ${x(o)}`,children:_>15&&i.jsxs("span",{className:"text-white text-xs font-medium",children:[v.toFixed(1),"%"]})}),C>0&&i.jsx("div",{className:"bg-blue-500 flex items-center justify-center relative group",style:{width:`${C}%`},title:`Origination: ${c}% of AGCI - ${x(m)}`,children:C>15&&i.jsxs("span",{className:"text-white text-xs font-medium",children:[c,"%"]})}),j>0&&i.jsx("div",{className:"bg-green-500 flex items-center justify-center relative group",style:{width:`${j}%`},title:`Site: ${d}% of AGCI - ${x(f)}`,children:j>15&&i.jsxs("span",{className:"text-white text-xs font-medium",children:[d,"%"]})}),k>0&&i.jsx("div",{className:"bg-purple-500 flex items-center justify-center relative group",style:{width:`${k}%`},title:`Deal: ${u}% of AGCI - ${x(h)}`,children:k>15&&i.jsxs("span",{className:"text-white text-xs font-medium",children:[u,"%"]})})]}),i.jsxs("div",{className:"flex flex-wrap items-center gap-x-6 gap-y-2",children:[g>0&&i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded mr-2"}),i.jsxs("span",{className:"text-sm text-gray-900",children:[i.jsx("span",{className:"font-medium",children:"Referral"})," ",x(g)]})]}),o>0&&i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"w-3 h-3 bg-gray-500 rounded mr-2"}),i.jsxs("span",{className:"text-sm text-gray-900",children:[i.jsx("span",{className:"font-medium",children:"House"})," ",x(o)]})]}),c>0&&i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded mr-2"}),i.jsxs("span",{className:"text-sm text-gray-900",children:[i.jsx("span",{className:"font-medium",children:"Origination"})," ",x(m)]})]}),d>0&&i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"w-3 h-3 bg-green-500 rounded mr-2"}),i.jsxs("span",{className:"text-sm text-gray-900",children:[i.jsx("span",{className:"font-medium",children:"Site"})," ",x(f)]})]}),u>0&&i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded mr-2"}),i.jsxs("span",{className:"text-sm text-gray-900",children:[i.jsx("span",{className:"font-medium",children:"Deal"})," ",x(h)]})]})]}),y!==l&&l>0&&i.jsx("div",{className:"text-xs text-amber-600 bg-amber-50 p-2 rounded",children:" Commission percentages don't total to 100% of AGCI"})]}),!S&&i.jsxs("div",{className:"text-center py-4",children:[i.jsx("div",{className:"text-sm text-gray-500 mb-2",children:"Commission breakdown percentages not configured"}),r&&i.jsx("button",{onClick:r,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Configure Commission Splits "})]})]})},JM=e=>{const t=o=>{if(o.payment_received)return"received";if(o.invoice_sent&&!o.payment_received){if(o.payment_date_estimated){const l=new Date(o.payment_date_estimated),c=new Date;if(c.setHours(0,0,0,0),l<c)return"overdue"}return"sent"}if(o.payment_date_estimated&&!o.invoice_sent){const l=new Date(o.payment_date_estimated),c=new Date;if(c.setHours(0,0,0,0),l<c)return"overdue"}return"pending"},r=e.reduce((o,l)=>{const c=t(l);return o[c]=(o[c]||0)+1,o.total++,o},{pending:0,sent:0,overdue:0,received:0,total:0}),n=r.overdue>0,s=r.overdue>0||r.sent>0,a=r.total>0?r.received/r.total*100:0;return{getPaymentStatus:t,statusSummary:r,hasOverdue:n,hasActionItems:s,completionRate:a}},Za=new Map,XM=3*60*1e3,ZM=({deal:e,onDealUpdate:t})=>{const[r,n]=p.useState([]),[s,a]=p.useState([]),[o,l]=p.useState([]),[c,d]=p.useState([]),[u,m]=p.useState([]),[f,h]=p.useState(!0),[y,w]=p.useState(null),[b,g]=p.useState(!1),{calculatedPaymentAmount:x,totalCalculatedPayments:v,paymentCommissionBreakdown:N,canGeneratePayments:_,validationMessages:C}=p_(e,r,o),j=p.useCallback(async()=>{if(!e.id)return;const E=Za.get(e.id),$=Date.now();if(E&&$-E.timestamp<XM){console.log(" Using cached payment data for deal:",e.id),n(E.payments),a(E.paymentSplits),l(E.commissionSplits),d(E.brokers),m(E.clients),h(!1);return}try{h(!0),w(null);const[B,H,J,le]=await Promise.all([M.from("payment").select("*").eq("deal_id",e.id).order("payment_sequence",{ascending:!0}),M.from("commission_split").select("*").eq("deal_id",e.id),M.from("broker").select("id, name").order("name"),M.from("client").select("*").order("client_name")]);if(B.error)throw B.error;if(H.error)throw H.error;if(J.error)throw J.error;if(le.error)throw le.error;const oe=B.data||[],se=H.data||[],ae=J.data||[],T=le.data||[];let ee=[];const q=oe.map(ce=>ce.id);if(q.length>0){const{data:ce,error:pe}=await M.from("payment_split").select("*").in("payment_id",q);if(pe)throw pe;ee=ce||[]}if(Za.set(e.id,{payments:oe,paymentSplits:ee,commissionSplits:se,brokers:ae,clients:T,timestamp:Date.now()}),Za.size>50){const ce=Za.keys().next().value;ce!==void 0&&Za.delete(ce)}n(oe),a(ee),l(se),d(ae),m(T)}catch(B){console.error("Error fetching payment data:",B),w(B instanceof Error?B.message:"Failed to load payment data")}finally{h(!1)}},[e.id]),k=async()=>{if(e.id)try{g(!0),w(null);const{data:E,error:$}=await M.rpc("generate_payments_for_deal",{deal_uuid:e.id});if($)throw $;await j()}catch(E){console.error("Error generating payments:",E),w(E instanceof Error?E.message:"Failed to generate payments")}finally{g(!1)}},S=async(E,$)=>{try{const{error:B}=await M.from("payment").update($).eq("id",E);if(B)throw B;n(H=>H.map(J=>J.id===E?{...J,...$}:J))}catch(B){console.error("Error updating payment:",B),w(B instanceof Error?B.message:"Failed to update payment")}},D=async E=>{try{const{error:$}=await M.from("payment_split").delete().eq("payment_id",E);if($)throw $;const{error:B}=await M.from("payment").delete().eq("id",E);if(B)throw B;n(H=>H.filter(J=>J.id!==E)),a(H=>H.filter(J=>J.payment_id!==E))}catch($){console.error("Error deleting payment:",$),w($ instanceof Error?$.message:"Failed to delete payment")}};if(p.useEffect(()=>{j()},[j]),f)return i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsx("div",{className:"text-gray-500",children:"Loading payment data..."})});const R=r.length>0;r.reduce((E,$)=>E+($.payment_amount||0),0);const P=e.fee||0,{statusSummary:A,hasOverdue:I,hasActionItems:L,completionRate:F}=JM(r),U=E=>E.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2});return i.jsxs("div",{className:"space-y-6",children:[y&&i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:i.jsx("div",{className:"text-red-700",children:y})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[i.jsx("div",{className:"text-sm font-medium text-blue-600",children:"Total Commission"}),i.jsxs("div",{className:"text-2xl font-bold text-blue-900",children:["$",U(P)]})]}),i.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[i.jsx("div",{className:"text-sm font-medium text-green-600",children:"Calculated Payments"}),i.jsxs("div",{className:"text-2xl font-bold text-green-900",children:["$",U(v)]}),i.jsxs("div",{className:"text-xs text-green-600 mt-1",children:[e.number_of_payments||1,"  $",U(x)]})]}),i.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[i.jsx("div",{className:"text-sm font-medium text-purple-600",children:"AGCI Available"}),i.jsxs("div",{className:"text-2xl font-bold text-purple-900",children:["$",U(e.agci||0)]}),i.jsx("div",{className:"text-xs text-purple-600 mt-1",children:"After house & referral fees"})]}),i.jsx(KM,{statusSummary:A,hasOverdue:I,completionRate:F})]}),i.jsx(QM,{deal:e,commissionSplits:o,className:"mb-6"}),i.jsx(WI,{deal:e,hasPayments:R,existingPayments:r,commissionSplits:o,onGeneratePayments:k,generatingPayments:b}),R?i.jsx("div",{className:"space-y-6",children:i.jsx(GM,{payments:r,paymentSplits:s,brokers:c,clients:u,commissionSplits:o,deal:e,onUpdatePayment:S,onDeletePayment:D,onUpdatePaymentSplit:async(E,$,B)=>{a(H=>H.map(J=>J.id===E?{...J,[$]:B!==null?B:$==="paid"?!1:0}:J))}})}):i.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:[i.jsx("div",{className:"text-gray-500 text-lg mb-2",children:"No payments generated yet"}),i.jsx("div",{className:"text-gray-400 text-sm",children:_?'Click "Generate Payments" above to create payment records':"Complete commission configuration to enable payment generation"}),C.length>0&&i.jsxs("div",{className:"mt-4 text-left max-w-md mx-auto",children:[i.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Required configuration:"}),i.jsx("ul",{className:"text-sm text-gray-500 space-y-1",children:C.map((E,$)=>i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"text-gray-400 mr-1",children:""}),E]},$))})]})]})]})};function eO(e){const[t,r]=p.useState([]),[n,s]=p.useState(!0),[a,o]=p.useState(null),l=async()=>{if(!e){r([]),s(!1);return}try{s(!0),o(null),console.log("Fetching activities for:",e);let d=M.from("activity").select(`
          *,
          activity_status!activity_status_id_fkey (
            name,
            color,
            is_closed
          ),
          activity_type!activity_activity_type_id_fkey (
            name,
            color
          ),
          activity_priority!activity_activity_priority_id_fkey (
            name,
            color
          ),
          activity_task_type!activity_activity_task_type_id_fkey (
            name,
            category
          ),
          owner:user!activity_owner_id_fkey (
            first_name,
            last_name,
            email
          ),
          contact!activity_contact_id_fkey (
            first_name,
            last_name,
            company
          )
        `);switch(e.type){case"deal":d=d.eq("deal_id",e.id);break;case"contact":d=d.eq("contact_id",e.id);break;case"client":d=d.eq("client_id",e.id);break;case"property":d=d.eq("property_id",e.id);break;case"site_submit":d=d.eq("site_submit_id",e.id);break;default:d=d.eq("related_object_type",e.type).eq("related_object_id",e.id);break}const{data:u,error:m}=await d.order("activity_date",{ascending:!1});if(m)throw console.error("Error fetching activities:",m),m;console.log(`Found ${(u==null?void 0:u.length)||0} activities for ${e.type}:${e.id}`),r(u||[])}catch(d){console.error("Error in fetchActivities:",d),o(d instanceof Error?d.message:"Failed to fetch activities")}finally{s(!1)}},c=()=>{l()};return p.useEffect(()=>{l()},[e==null?void 0:e.id,e==null?void 0:e.type]),{activities:t,loading:n,error:a,refetch:c}}function tO({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm13.36-1.814a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z",clipRule:"evenodd"}))}const rO=p.forwardRef(tO),dx=rO;function nO({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{d:"M1.5 8.67v8.58a3 3 0 0 0 3 3h15a3 3 0 0 0 3-3V8.67l-8.928 5.493a3 3 0 0 1-3.144 0L1.5 8.67Z"}),p.createElement("path",{d:"M22.5 6.908V6.75a3 3 0 0 0-3-3h-15a3 3 0 0 0-3 3v.158l9.714 5.978a1.5 1.5 0 0 0 1.572 0L22.5 6.908Z"}))}const sO=p.forwardRef(nO),aO=sO;function iO({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{fillRule:"evenodd",d:"M1.5 4.5a3 3 0 0 1 3-3h1.372c.86 0 1.61.586 1.819 1.42l1.105 4.423a1.875 1.875 0 0 1-.694 1.955l-1.293.97c-.135.101-.164.249-.126.352a11.285 11.285 0 0 0 6.697 6.697c.103.038.25.009.352-.126l.97-1.293a1.875 1.875 0 0 1 1.955-.694l4.423 1.105c.834.209 1.42.959 1.42 1.82V19.5a3 3 0 0 1-3 3h-2.25C8.552 22.5 1.5 15.448 1.5 6.75V4.5Z",clipRule:"evenodd"}))}const oO=p.forwardRef(iO),lO=oO;let cO=class{constructor(){this.lines=[],this.isHidden=!1,this.isSignature=!1,this.isQuoted=!1,this.isAnswer=!1}};var dO=cO;let uO=class{constructor(t,r,n,s,a){this._content=t,this._isHidden=r,this._isSignature=n,this._isQuoted=s,this._isAnswer=a}isHidden(){return this._isHidden}isSignature(){return this._isSignature}isQuoted(){return this._isQuoted}isAnswer(){return this._isAnswer}getContent(){return this._content}isEmpty(){return this.getContent().replace(/\n/g,"")===""}toString(){return this.getContent()}};var fO=uO;let mO=class{constructor(t=[]){this.fragments=t}getFragments(){return this.fragments}getVisibleText(){return this.filterText(t=>!t.isHidden())}getQuotedText(){return this.filterText(t=>t.isQuoted())}getAnswerText(){return this.filterText(t=>t.isAnswer())}filterText(t){return this.fragments.filter(t).join(`
`).replace(/~*$/,"")}};var hO=mO;const pO={},gO=Object.freeze(Object.defineProperty({__proto__:null,default:pO},Symbol.toStringTag,{value:"Module"})),xO=xx(gO);let ei,ux,yO=class{constructor(){this.SafeRegExp=ux!==!1?(()=>{if(typeof ei=="function")return ei;try{return ei=xO,typeof ei=="function"?ei:RegExp}catch{return ux=!1,RegExp}})():RegExp,this.answerHeadersRegex=this.buildRe2([/^>*-*\s*(On\s.+\s.+\n?wrote:{0,1})\s{0,1}-*$/m,/^>*-*\s*(Le\s.+\s.+\n?crit\s?:{0,1})\s{0,1}-*$/m,/^>*-*\s*(El\s.+\s.+\n?escribi:{0,1})\s{0,1}-*$/m,/^>*-*\s*(Il\s.+\s.+\n?scritto:{0,1})\s{0,1}-*$/m,/^>*-*\s*(Em\s.+\s.+\n?escreveu:{0,1})\s{0,1}-*$/m,/^>*\s*(Am\s.+\s)\n?\n?schrieb.+\s?(\[|<).+(\]|>):$/m,/^>*\s*(Op\s[\s\S]+?\n?schreef[\s\S]+:)$/m,/^>*\s*((W\sdniu|Dnia)\s[\s\S]+?(pisze|napisa(\(a\))?):)$/mu,/^>*\s*(Den\s.+\s\n?skrev\s.+:)$/m,/^>*\s*(pe\s.+\s.+\n?kirjoitti:)$/m,/^>*\s*(Am\s.+\sum\s.+\s\n?schrieb\s.+:)$/m,/^>*([\s\S]+)$/m,/^>*(20[0-9]{2}\..+\s:)$/m,/^>*(20[0-9]{2}\/.+:)$/m,/^>*(.+\s<.+>\sschrieb:)$/m,/^>*(.+\son.*at.*wrote:)$/m,/^>*\s*(From\s?:.+\s?\n?\s*[\[|<].+[\]|>])/m,/^>*\s*(Von\s?:.+\s?\n?\s*[\[|<].+[\]|>])/m,/^>*\s*(De\s?:.+\s?\n?\s*(\[|<).+(\]|>))/m,/^>*\s*(Van\s?:.+\s?\n?\s*(\[|<).+(\]|>))/m,/^>*\s*(Da\s?:.+\s?\n?\s*(\[|<).+(\]|>))/m,/^>*(20[0-9]{2})-([0-9]{2}).([0-9]{2}).([0-9]{2}):([0-9]{2})\n?(.*)>:$/m,/^>*\s*([a-z]{3,4}\.\s[\s\S]+\sskrev\s[\s\S]+:)$/m,/^>*([0-9]{2}).([0-9]{2}).(20[0-9]{2})(.*)(([0-9]{2}).([0-9]{2}))(.*)\"( *)<(.*)>( *):$/m,/^>*[0-9]{2}:[0-9]{2}(.*)[0-9]{4}(.*)\"( *)<(.*)>( *):$/,/^>*(.*)[0-9]{4}(.*)from(.*)<(.*)>:$/,/^>*-{1,12} ?(O|o)riginal (M|m)essage ?-{1,12}$/i,/^>*-{1,12} ?(O|o)prindelig (B|b)esked ?-{1,12}$/i,/^>*-{1,12} ?(M|m)essage d\'origine ?-{1,12}$/i]),this.signatureRegex=this.buildRe2([/^\s*-{2,4}$/,/^\s*_{2,4}$/,/^-- $/,/^\+{2,4}$/,/^\={2,4}$/,/^________________________________$/,/^Sent from (?:\s*.+)$/,/^Get Outlook for (?:\s*.+).*/m,/^Cheers,?!?$/mi,/^Best wishes,?!?$/mi,/^\w{0,20}\s?(\sand\s)?Regards,?!??$/mi,/^Von (?:\s*.+) gesendet$/,/^Gesendet von (?:\s*.+) fr (?:\s*.+)$/,/^Sendt fra (?:\s*.+)$/,/^Envoy depuis (?:\s*.+)$/,/^Envoy de mon (?:\s*.+)$/,/^Envoy  partir de (?:\s*.+)$/,/^Tlcharger Outlook pour (?:\s*.+).*/m,/^Bien . vous,?!?$/mi,/^\w{0,20}\s?cordialement,?!?$/mi,/^Bonne (journ.e|soir.e)!?$/mi,/^Enviado desde (?:\s*.+)$/,/^-*\s*(In\sdata\s.+\s.+\n?scritto:{0,1})\s{0,1}-*$/m,/^Verzonden vanaf (?:\s*.+)$/,/^Verstuurd vanaf (?:\s*.+)$/])}buildRe2(t){return t.map(r=>new this.SafeRegExp(r))}};var vO=new yO,bO=dO,wO=fO,_O=hO,ti=vO;const jO=/(>+)$/;let NO=class{constructor(){this.fragments=[]}stringReverse(t){let r="",n=t.length;for(;n>0;)r+=t.substring(n-1,n),n--;return r}stringRTrim(t,r){for(let n=t.length-1;n>=0;n--)if(r!=t.charAt(n)){t=t.substring(0,n+1);break}return t}stringLTrim(t){return t.replace(/^\s+/,"")}parse(t){t=t.replace(/\r\n/g,`
`),t=this.fixBrokenSignatures(t);let r=null;this.stringReverse(t).split(`
`).forEach(s=>{if(s=this.stringRTrim(s,`
`),this.isSignature(s)||(s=this.stringLTrim(s)),r){let o=r.lines[r.lines.length-1];this.isSignature(o)?(r.isSignature=!0,this.addFragment(r),r=null):s===""&&this.isAnswerHeader(o)&&(r.isAnswer=!0,this.addFragment(r),r=null)}let a=this.isQuote(s);(r===null||!this.isFragmentLine(r,s,a))&&(r!==null&&this.addFragment(r),r=new bO,r.isQuoted=a),r.lines.push(s)}),r!==null&&this.addFragment(r);let n=this.createEmail(this.fragments);return this.fragments=[],n}fixBrokenSignatures(t){let r=t;return ti.answerHeadersRegex.forEach(n=>{let s=r.match(n);if(s){const[a,o]=s;r=r.replace(o,o.replace(/\n/g," "))}}),r}getAnswerHeadersRegex(){return ti.answerHeadersRegex}setAnswerHeadersRegex(t){return ti.answerHeadersRegex=t,this}createEmail(t){let r=[];return t.reverse().forEach(n=>{r.push(new wO(this.stringReverse(n.lines.join(`
`)).replace(/^\n/g,""),n.isHidden,n.isSignature,n.isQuoted,n.isAnswer))}),new _O(r)}isAnswerHeader(t){let r=!1;return ti.answerHeadersRegex.forEach(n=>{n.test(this.stringReverse(t))&&(r=!0)}),r}isSignature(t){let r=this.stringReverse(t);return ti.signatureRegex.some(n=>n.test(r))}isQuote(t){return jO.test(t)}isEmpty(t){return t.lines.join("")===""}isFragmentLine(t,r,n){return t.isQuoted===n||t.isQuoted&&(this.isAnswerHeader(r)||r==="")}addFragment(t){(t.isSignature||t.isAnswer||this.isEmpty(t))&&(t.isHidden=!0),this.fragments.push(t)}};var kO=NO,SO=kO;let CO=class{read(t){return new SO().parse(t)}parseReply(t){return this.read(t).getVisibleText()}parseReplied(t){return this.read(t).getQuotedText()}};var v_=CO;const b_=tm(v_),DO=gx({__proto__:null,default:b_},[v_]);var w_={exports:{}};(function(e){(function(t){function r(d){function u(){return ws<np}function m(){return Ia[ws]}function f(){return ws}function h(z){ws=z}function y(){ws+=1}function w(){ws=0,np=Ia.length}function b(z,W){return{name:z,tokens:W||"",semantic:W||"",children:[]}}function g(z,W){var G;return W===null?null:(G=b(z),G.tokens=W.tokens,G.semantic=W.semantic,G.children.push(W),G)}function x(z,W){return W!==null&&(z.tokens+=W.tokens,z.semantic+=W.semantic),z.children.push(W),z}function v(z){var W;return u()?(W=m(),z(W)?(y(),b("token",W)):null):null}function N(){return null}function _(z){return function(){return g("literal",v(function(G){return G===z}))}}function C(){var z=arguments;return function(){var G,te,ne,Ce;for(Ce=f(),te=b("and"),G=0;G<z.length;G+=1){if(ne=z[G](),ne===null)return h(Ce),null;x(te,ne)}return te}}function j(){var z=arguments;return function(){var G,te,ne;for(ne=f(),G=0;G<z.length;G+=1){if(te=z[G](),te!==null)return te;h(ne)}return null}}function k(z){return function(){var G,te;return te=f(),G=z(),G!==null?G:(h(te),b("opt"))}}function S(z){return function(){var G=z();return G!==null&&(G.semantic=""),G}}function D(z){return function(){var G=z();return G!==null&&G.semantic.length>0&&(G.semantic=" "),G}}function R(z,W){return function(){var te,ne,Ce,Ir,sp;for(Ir=f(),te=b("star"),Ce=0,sp=W===void 0?0:W;(ne=z())!==null;)Ce=Ce+1,x(te,ne);return Ce>=sp?te:(h(Ir),null)}}function P(z){return z.replace(/([ \t]|\r\n)+/g," ").replace(/^\s*/,"").replace(/\s*$/,"")}function A(z){return z.charCodeAt(0)>=128}function I(){return g("cr",_("\r")())}function L(){return g("crlf",C(I,E)())}function F(){return g("dquote",_('"')())}function U(){return g("htab",_("	")())}function E(){return g("lf",_(`
`)())}function $(){return g("sp",_(" ")())}function B(){return g("vchar",v(function(W){var G=W.charCodeAt(0),te=33<=G&&G<=126;return d.rfc6532&&(te=te||A(W)),te}))}function H(){return g("wsp",j($,U)())}function J(){var z=g("quoted-pair",j(C(_("\\"),j(B,H)),O_)());return z===null?null:(z.semantic=z.semantic[1],z)}function le(){return g("fws",j($_,C(k(C(R(H),S(L))),R(H,1)))())}function oe(){return g("ctext",j(function(){return v(function(G){var te=G.charCodeAt(0),ne=33<=te&&te<=39||42<=te&&te<=91||93<=te&&te<=126;return d.rfc6532&&(ne=ne||A(G)),ne})},I_)())}function se(){return g("ccontent",j(oe,J,ae)())}function ae(){return g("comment",C(_("("),R(C(k(le),se)),k(le),_(")"))())}function T(){return g("cfws",j(C(R(C(k(le),ae),1),k(le)),le)())}function ee(){return g("atext",v(function(W){var G="a"<=W&&W<="z"||"A"<=W&&W<="Z"||"0"<=W&&W<="9"||["!","#","$","%","&","'","*","+","-","/","=","?","^","_","`","{","|","}","~"].indexOf(W)>=0;return d.rfc6532&&(G=G||A(W)),G}))}function q(){return g("atom",C(D(k(T)),R(ee,1),D(k(T)))())}function ce(){var z,W;return z=g("dot-atom-text",R(ee,1)()),z===null||(W=R(C(_("."),R(ee,1)))(),W!==null&&x(z,W)),z}function pe(){return g("dot-atom",C(S(k(T)),ce,S(k(T)))())}function ye(){return g("qtext",j(function(){return v(function(G){var te=G.charCodeAt(0),ne=te===33||35<=te&&te<=91||93<=te&&te<=126;return d.rfc6532&&(ne=ne||A(G)),ne})},M_)())}function Se(){return g("qcontent",j(ye,J)())}function Le(){return g("quoted-string",C(S(k(T)),S(F),R(C(k(D(le)),Se)),k(S(le)),S(F),S(k(T)))())}function Ie(){return g("word",j(q,Le)())}function _t(){return g("phrase",j(A_,R(Ie,1))())}function ot(){return g("address",j(sn,Zh)())}function sn(){return g("mailbox",j(Jh,pd)())}function Jh(){return g("name-addr",C(k(ep),Xh)())}function Xh(){return g("angle-addr",j(C(S(k(T)),_("<"),pd,_(">"),S(k(T))),F_)())}function Zh(){return g("group",C(ep,_(":"),k(C_),_(";"),S(k(T)))())}function ep(){return g("display-name",function(){var W=_t();return W!==null&&(W.semantic=P(W.semantic)),W}())}function md(){return g("mailbox-list",j(C(sn,R(C(_(","),sn))),W_)())}function yo(){return g("address-list",j(C(ot,R(C(_(d.addressListSeparator),ot))),H_)())}function C_(){return g("group-list",j(md,S(T),z_)())}function D_(){return g("local-part",j(V_,pe,Le)())}function E_(){return g("dtext",j(function(){return v(function(G){var te=G.charCodeAt(0),ne=33<=te&&te<=90||94<=te&&te<=126;return d.rfc6532&&(ne=ne||A(G)),ne})},q_)())}function P_(){return g("domain-literal",C(S(k(T)),_("["),R(C(k(le),E_)),k(le),_("]"),S(k(T)))())}function hd(){return g("domain",function(){var W=j(Y_,pe,P_)();return d.rejectTLD&&W&&W.semantic&&W.semantic.indexOf(".")<0?null:(W&&(W.semantic=W.semantic.replace(/\s+/g,"")),W)}())}function pd(){return g("addr-spec",C(D_,_("@"),hd)())}function T_(){return g("from",j(md,yo)())}function R_(){return g("sender",j(sn,ot)())}function L_(){return g("reply-to",yo())}function vo(){return d.strict?null:g("obs-NO-WS-CTL",v(function(z){var W=z.charCodeAt(0);return 1<=W&&W<=8||W===11||W===12||14<=W&&W<=31||W===127}))}function I_(){return d.strict?null:g("obs-ctext",vo())}function M_(){return d.strict?null:g("obs-qtext",vo())}function O_(){return d.strict?null:g("obs-qp",C(_("\\"),j(_("\0"),vo,E,I))())}function A_(){return d.strict?null:g("obs-phrase",C(Ie,R(j(Ie,_("."),d.atInDisplayName?_("@"):N,d.commaInDisplayName?_(","):N,D(T))))())}function $_(){return d.strict?null:g("obs-FWS",R(C(S(k(L)),H),1)())}function F_(){return d.strict?null:g("obs-angle-addr",C(S(k(T)),_("<"),B_,pd,_(">"),S(k(T)))())}function B_(){return d.strict?null:g("obs-route",C(U_,_(":"))())}function U_(){return d.strict?null:g("obs-domain-list",C(R(j(S(T),_(","))),_("@"),hd,R(C(_(","),S(k(T)),k(C(_("@"),hd)))))())}function W_(){return d.strict?null:g("obs-mbox-list",C(R(C(S(k(T)),_(","))),sn,R(C(_(","),k(C(sn,S(T))))))())}function H_(){return d.strict?null:g("obs-addr-list",C(R(C(S(k(T)),_(","))),ot,R(C(_(","),k(C(ot,S(T))))))())}function z_(){return d.strict?null:g("obs-group-list",C(R(C(S(k(T)),_(",")),1),S(k(T)))())}function V_(){return d.strict?null:g("obs-local-part",C(Ie,R(C(_("."),Ie)))())}function Y_(){return d.strict?null:g("obs-domain",C(q,R(C(_("."),q)))())}function q_(){return d.strict?null:g("obs-dtext",j(vo,J)())}function La(z,W){var G,te,ne;if(W==null)return null;for(te=[W];te.length>0;){if(ne=te.pop(),ne.name===z)return ne;for(G=ne.children.length-1;G>=0;G-=1)te.push(ne.children[G])}return null}function G_(z,W){var G,te,ne,Ce;if(W==null)return null;for(te=[W],Ce=[];te.length>0;)for(ne=te.pop(),ne.name===z&&Ce.push(ne),G=ne.children.length-1;G>=0;G-=1)te.push(ne.children[G]);return Ce}function gd(z,W){var G,te,ne,Ce,Ir;if(W==null)return null;for(te=[W],Ce=[],Ir={},G=0;G<z.length;G+=1)Ir[z[G]]=!0;for(;te.length>0;)if(ne=te.pop(),ne.name in Ir)Ce.push(ne);else for(G=ne.children.length-1;G>=0;G-=1)te.push(ne.children[G]);return Ce}function tp(z){var W,G,te,ne,Ce;if(z===null)return null;for(W=[],G=gd(["group","mailbox"],z),te=0;te<G.length;te+=1)ne=G[te],ne.name==="group"?W.push(K_(ne)):ne.name==="mailbox"&&W.push(rp(ne));return Ce={ast:z,addresses:W},d.simple&&(Ce=Q_(Ce)),d.oneResult?X_(Ce):d.simple?Ce&&Ce.addresses:Ce}function K_(z){var W,G=La("display-name",z),te=[],ne=gd(["mailbox"],z);for(W=0;W<ne.length;W+=1)te.push(rp(ne[W]));return{node:z,parts:{name:G},type:z.name,name:Bn(G),addresses:te}}function rp(z){var W=La("display-name",z),G=La("addr-spec",z),te=G_("cfws",z),ne=gd(["comment"],z),Ce=La("local-part",G),Ir=La("domain",G);return{node:z,parts:{name:W,address:G,local:Ce,domain:Ir,comments:te},type:z.name,name:Bn(W),address:Bn(G),local:Bn(Ce),domain:Bn(Ir),comments:J_(ne),groupName:Bn(z.groupName)}}function Bn(z){return z!=null?z.semantic:null}function Q_(z){var W;if(z&&z.addresses)for(W=0;W<z.addresses.length;W+=1)delete z.addresses[W].node;return z}function J_(z){var W="";if(z)for(var G=0;G<z.length;G+=1)W+=Bn(z[G]);return W}function X_(z){return!z||!d.partial&&z.addresses.length>1?null:z.addresses&&z.addresses[0]}var Ia,ws,np,bo,xd;if(d=c(d,{}),d===null)return null;if(Ia=d.input,xd={address:ot,"address-list":yo,"angle-addr":Xh,from:T_,group:Zh,mailbox:sn,"mailbox-list":md,"reply-to":L_,sender:R_}[d.startAt]||yo,!d.strict){if(w(),d.strict=!0,bo=xd(Ia),d.partial||!u())return tp(bo);d.strict=!1}return w(),bo=xd(Ia),!d.partial&&u()?null:tp(bo)}function n(d){return r(c(d,{oneResult:!0,rfc6532:!0,simple:!0,startAt:"address-list"}))}function s(d){return r(c(d,{rfc6532:!0,simple:!0,startAt:"address-list"}))}function a(d){return r(c(d,{rfc6532:!0,simple:!0,startAt:"from"}))}function o(d){return r(c(d,{oneResult:!0,rfc6532:!0,simple:!0,startAt:"sender"}))}function l(d){return r(c(d,{rfc6532:!0,simple:!0,startAt:"reply-to"}))}function c(d,u){function m(b){return Object.prototype.toString.call(b)==="[object String]"}function f(b){return b===Object(b)}function h(b){return b==null}var y,w;if(m(d))d={input:d};else if(!f(d))return null;if(!m(d.input)||!u)return null;y={oneResult:!1,partial:!1,rejectTLD:!1,rfc6532:!1,simple:!1,startAt:"address-list",strict:!1,atInDisplayName:!1,commaInDisplayName:!1,addressListSeparator:","};for(w in y)h(d[w])&&(d[w]=h(u[w])?y[w]:u[w]);return d}r.parseOneAddress=n,r.parseAddressList=s,r.parseFrom=a,r.parseSender=o,r.parseReplyTo=l,e.exports=r})()})(w_);var fx=w_.exports;const __=b_||DO;function EO(e,t){if(!e)return null;try{const r=new __().read(e),n=PO(e),s=r.getFragments().map(u=>({content:u.getContent(),isQuoted:u.isQuoted(),isSignature:u.isSignature(),isHidden:u.isHidden()})),a=s.filter(u=>!u.isQuoted&&!u.isSignature&&!u.isHidden),o=s.filter(u=>u.isQuoted&&!u.isHidden),l=s.filter(u=>u.isSignature),c=RO(e,n);return{headers:{...n,subject:n.subject||t||""},content:{visibleText:a.map(u=>u.content).join(`

`).trim(),signature:l.map(u=>u.content).join(`

`).trim(),fragments:s,emailThread:c},metadata:{isReply:r.getFragments().some(u=>u.isQuoted()),isForward:e.toLowerCase().includes("forwarded message")||e.toLowerCase().includes("fwd:")||e.toLowerCase().includes("forward:"),hasQuotedText:o.length>0,hasSignature:l.length>0}}}catch(r){return console.error("Error parsing email:",r),TO(e,t)}}function PO(e){const t={to:[],from:"",cc:[],bcc:[],date:"",replyTo:void 0},r=e.split(`
`).slice(0,30),n={from:/^(from|From|FROM):\s*(.+)$/,to:/^(to|To|TO):\s*(.+)$/,cc:/^(cc|Cc|CC):\s*(.+)$/,bcc:/^(bcc|Bcc|BCC):\s*(.+)$/,date:/^(date|Date|DATE|sent|Sent):\s*(.+)$/,replyTo:/^(reply-to|Reply-To|REPLY-TO):\s*(.+)$/};for(const s of r){const a=s.trim();if(a)for(const[o,l]of Object.entries(n)){const c=a.match(l);if(c){const d=c[2].trim();if(o==="to"||o==="cc"||o==="bcc"){const u=fx.parseAddressList(d);u?t[o]=u.map(m=>m.name?`${m.name} <${m.address}>`:m.address):t[o]=d.split(/[,;]/).map(m=>m.trim()).filter(Boolean)}else if(o==="from"||o==="replyTo"){const u=fx.parseOneAddress(d);u&&o==="from"?t.from=u.name?`${u.name} <${u.address}>`:u.address:u&&o==="replyTo"?t.replyTo=u.name?`${u.name} <${u.address}>`:u.address:(o==="from"&&(t.from=d),o==="replyTo"&&(t.replyTo=d))}else t[o]=d;break}}}return t}function TO(e,t){return{headers:{to:[],from:"",cc:[],bcc:[],subject:t||"",date:""},content:{visibleText:e.trim(),signature:"",fragments:[{content:e.trim(),isQuoted:!1,isSignature:!1,isHidden:!1}],emailThread:[{id:"fallback-email-0",headers:{from:"Unknown Sender",to:[],date:"",subject:t||"No Subject"},content:e.trim(),type:"current",level:0}]},metadata:{isReply:!1,isForward:!1,hasQuotedText:!1,hasSignature:!1}}}function Sl(e){return e?e.split(/\n\s*\n/).map(t=>t.replace(/\n/g," ").trim()).filter(t=>t.length>0):[]}function RO(e,t){const r=[];let n=0;const s=new __().read(e),a=s.getVisibleText().trim();a&&r.push({id:`email-${n++}`,headers:{from:t.from||"Unknown Sender",to:t.to||[],date:t.date||"",subject:t.subject||""},content:a,type:"current",level:0});const o=s.getFragments();let l="";return o.forEach(c=>{c.isQuoted()&&!c.isSignature()&&!c.isHidden()&&(l+=c.getContent()+`
`)}),l.trim()&&LO(l).forEach((d,u)=>{r.push({id:`email-${n++}`,headers:{from:d.from||"Unknown Sender",to:d.to||[],date:d.date||"",subject:d.subject||t.subject||""},content:d.content,signature:d.signature,type:"quoted",level:u+1})}),r}function LO(e){const t=[];return e.split(/(?=.*(?:wrote:|From:|said:))/i).forEach(n=>{const s=n.trim();if(!s||s.length<20)return;const a={from:"",to:[],date:"",subject:""},o=s.split(`
`);let l=0;for(let f=0;f<Math.min(o.length,10);f++){const h=o[f].trim(),y=h.match(/^From:\s*(.+)$/i)||h.match(/^(.+?)\s+wrote:/i)||h.match(/^(.+?)\s+said:/i);y&&(a.from=y[1].trim(),l=Math.max(l,f+1));const w=h.match(/^(?:Date|Sent|On):\s*(.+)$/i)||h.match(/^On\s+(.+?),\s*.+?\s+wrote:/i);w&&(a.date=w[1].trim(),l=Math.max(l,f+1));const b=h.match(/^To:\s*(.+)$/i);b&&(a.to=b[1].split(/[,;]/).map(x=>x.trim()),l=Math.max(l,f+1));const g=h.match(/^Subject:\s*(.+)$/i);g&&(a.subject=g[1].trim(),l=Math.max(l,f+1))}const c=o.slice(l).join(`
`).replace(/^>+\s*/gm,"").replace(/^\s*$/gm,"").trim(),d=c.match(/^(--\s*$|_{2,}$|-{2,}$)/m);let u=c,m="";if(d){const f=d.index||0;u=c.substring(0,f).trim(),m=c.substring(f).trim()}u&&(a.from||a.date)&&t.push({from:a.from,to:a.to,date:a.date,subject:a.subject,content:u,signature:m||void 0})}),t}const IO=({activity:e})=>{var l;const[t,r]=p.useState({}),n=EO(e.description||"",e.subject);if(!n||!((l=n.content)!=null&&l.emailThread))return i.jsx(MO,{activity:e});const s=n.headers.subject||e.subject||"No Subject",a=n.headers.date||(e.activity_date?Pr(new Date(e.activity_date),"MMM d, yyyy h:mm a"):"")||(e.created_at?Pr(new Date(e.created_at),"MMM d, yyyy h:mm a"):""),o=c=>{r(d=>({...d,[c]:!d[c]}))};return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"bg-white border rounded-lg shadow-sm",children:[i.jsx("div",{className:"px-4 py-3 border-b bg-gray-50",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(ud,{className:"w-5 h-5 text-blue-600"}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-medium text-gray-900",children:s}),i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.metadata.isReply&&i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(ix,{className:"w-3 h-3"}),i.jsx("span",{children:"Reply"})]}),n.metadata.isForward&&i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(VI,{className:"w-3 h-3"}),i.jsx("span",{children:"Forward"})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(CM,{className:"w-3 h-3"}),i.jsx("span",{children:"Email"})]})]})]})]}),i.jsx("div",{className:"text-right text-sm text-gray-500",children:a})]})}),i.jsx("div",{className:"px-4 py-3 bg-white",children:i.jsxs("div",{className:"grid grid-cols-1 gap-2 text-sm",children:[n.headers.from&&i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"w-12 text-gray-500 font-medium",children:"From:"}),i.jsx("span",{className:"text-gray-900",children:n.headers.from})]}),n.headers.to.length>0&&i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"w-12 text-gray-500 font-medium",children:"To:"}),i.jsx("span",{className:"text-gray-900",children:n.headers.to.join(", ")})]}),n.headers.cc.length>0&&i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"w-12 text-gray-500 font-medium",children:"CC:"}),i.jsx("span",{className:"text-gray-900",children:n.headers.cc.join(", ")})]})]})})]}),n.content.emailThread.map((c,d)=>{var u;return i.jsxs("div",{className:"bg-white border rounded-lg shadow-sm",children:[i.jsx("div",{className:`px-4 py-3 ${c.type==="current"?"bg-white":"bg-gray-50"} ${d===0?"":"border-b"}`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("div",{className:"flex-1",children:i.jsxs("div",{className:"flex items-center gap-3",children:[c.type==="quoted"&&i.jsx(ix,{className:"w-4 h-4 text-gray-500"}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"font-medium text-gray-900",children:c.headers.from||"Unknown Sender"}),c.type==="current"&&i.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:"Latest"})]}),c.headers.to.length>0&&i.jsxs("div",{className:"text-sm text-gray-600",children:["to ",c.headers.to.join(", ")]}),c.headers.date&&i.jsx("div",{className:"text-xs text-gray-500",children:c.headers.date})]})]})}),c.type==="quoted"&&i.jsx("button",{onClick:()=>o(c.id),className:"ml-4 p-1 hover:bg-gray-100 rounded",children:t[c.id]?i.jsx(iM,{className:"w-4 h-4 text-gray-500"}):i.jsx(dd,{className:"w-4 h-4 text-gray-500"})})]})}),(c.type==="current"||t[c.id])&&i.jsxs("div",{className:`px-4 py-4 ${c.type==="quoted"?"bg-gray-25 border-l-4 border-gray-200":""}`,children:[Sl(c.content).map((m,f)=>i.jsx("p",{className:`mb-3 last:mb-0 leading-relaxed ${c.type==="current"?"text-gray-700":"text-gray-600 text-sm"}`,children:m},f)),c.signature&&i.jsxs("div",{className:"mt-4 pt-3 border-t border-gray-200",children:[i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Signature"}),Sl(c.signature).map((m,f)=>i.jsx("p",{className:"text-gray-500 text-xs leading-relaxed",children:m},f))]})]}),c.type==="quoted"&&!t[c.id]&&i.jsxs("div",{className:"px-4 py-2 text-sm text-gray-500 bg-gray-50",children:[(u=Sl(c.content)[0])==null?void 0:u.substring(0,100),"..."]})]},c.id)}),i.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-xs text-gray-600",children:[e.sf_id&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Salesforce ID:"})," ",e.sf_id]}),e.created_at&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Logged:"})," ",Pr(new Date(e.created_at),"MMM d, yyyy h:mm a")]}),e.owner&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Logged by:"})," ",e.owner.first_name&&e.owner.last_name?`${e.owner.first_name} ${e.owner.last_name}`:e.owner.name]}),e.contact&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Related Contact:"})," ",e.contact.first_name," ",e.contact.last_name]})]})})]})},MO=({activity:e})=>i.jsx("div",{className:"space-y-4",children:i.jsxs("div",{className:"bg-white border rounded-lg shadow-sm",children:[i.jsx("div",{className:"px-4 py-3 border-b bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(ud,{className:"w-5 h-5 text-blue-600"}),i.jsx("h3",{className:"font-medium text-gray-900",children:e.subject||"Email Content"})]})}),i.jsx("div",{className:"px-4 py-4",children:e.description?Sl(e.description).map((t,r)=>i.jsx("p",{className:"text-gray-700 mb-3 last:mb-0 leading-relaxed",children:t},r)):i.jsx("p",{className:"text-gray-500 italic",children:"No email content available."})})]})}),OO=({activity:e,onActivityUpdate:t,onClose:r})=>{var m,f;const[n,s]=p.useState(!1),a=((m=e.activity_type)==null?void 0:m.name)||e.sf_task_subtype,o=a==="Task"||!a,l=["Email","ListEmail"].includes(a||""),c=((f=e.activity_status)==null?void 0:f.is_closed)||e.sf_is_closed||e.completed_call||e.sf_status&&["Completed","Complete","Closed"].includes(e.sf_status),d=()=>{o&&s(!n)},u=()=>{switch(a){case"Call":return i.jsx(va,{className:"w-5 h-5 text-blue-600"});case"Email":case"ListEmail":return i.jsx(ud,{className:"w-5 h-5 text-purple-600"});default:return i.jsx(bc,{className:"w-5 h-5 text-green-600"})}};return i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-4",children:[i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[u(),i.jsxs("div",{children:[i.jsx("h3",{className:"font-medium text-gray-900",children:e.subject||"Untitled Activity"}),i.jsxs("p",{className:"text-sm text-gray-600",children:[a,"  ",c?"Completed":"Open"]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[o&&i.jsx("button",{onClick:d,className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-white rounded-md transition-colors",title:n?"View mode":"Edit mode",children:n?i.jsx(vM,{className:"w-4 h-4"}):i.jsx(PM,{className:"w-4 h-4"})}),i.jsx("button",{onClick:r,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-white rounded-md transition-colors",title:"Close",children:i.jsx(x_,{className:"w-4 h-4"})})]})]}),o&&n?i.jsx(AO,{activity:e,onSave:h=>{t==null||t(h),s(!1)},onCancel:()=>s(!1)}):l?i.jsx(IO,{activity:e}):i.jsx($O,{activity:e})]})},AO=({activity:e,onSave:t,onCancel:r})=>{const[n,s]=p.useState(e.subject||""),[a,o]=p.useState(e.description||""),[l,c]=p.useState(e.activity_date?Pr(new Date(e.activity_date),"yyyy-MM-dd"):""),d=()=>{const u={...e,subject:n,description:a,activity_date:l||null,updated_at:new Date().toISOString()};t(u)};return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject"}),i.jsx("input",{type:"text",value:n,onChange:u=>s(u.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"Activity subject..."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),i.jsx("textarea",{value:a,onChange:u=>o(u.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"Activity description..."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Activity Date"}),i.jsx("input",{type:"date",value:l,onChange:u=>c(u.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{className:"flex gap-2 pt-2",children:[i.jsx("button",{onClick:d,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Save Changes"}),i.jsx("button",{onClick:r,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 focus:ring-2 focus:ring-gray-500 focus:ring-offset-2",children:"Cancel"})]})]})},$O=({activity:e})=>{var t,r,n;return(t=e.activity_type)!=null&&t.name||e.sf_task_subtype,i.jsxs("div",{className:"space-y-4",children:[e.description&&i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(uM,{className:"w-4 h-4 text-gray-500"}),i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Description"})]}),i.jsx("div",{className:"bg-white p-3 rounded-md border text-sm text-gray-700 whitespace-pre-wrap",children:e.description})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.activity_date&&i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx(Rs,{className:"w-4 h-4 text-gray-500 mt-0.5"}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Activity Date"}),i.jsx("p",{className:"text-sm text-gray-600",children:Pr(new Date(e.activity_date),"MMM d, yyyy")})]})]}),e.contact&&i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx(wc,{className:"w-4 h-4 text-gray-500 mt-0.5"}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Contact"}),i.jsxs("p",{className:"text-sm text-gray-600",children:[e.contact.first_name," ",e.contact.last_name]}),e.contact.email&&i.jsx("p",{className:"text-sm text-gray-500",children:e.contact.email})]})]}),e.call_duration_seconds&&i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx(g_,{className:"w-4 h-4 text-gray-500 mt-0.5"}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Call Duration"}),i.jsxs("p",{className:"text-sm text-gray-600",children:[Math.floor(e.call_duration_seconds/60),"m ",e.call_duration_seconds%60,"s"]})]})]}),e.call_disposition&&i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx(va,{className:"w-4 h-4 text-gray-500 mt-0.5"}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Call Outcome"}),i.jsx("p",{className:"text-sm text-gray-600",children:e.call_disposition})]})]}),e.owner&&i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx(wc,{className:"w-4 h-4 text-gray-500 mt-0.5"}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Assigned To"}),i.jsx("p",{className:"text-sm text-gray-600",children:e.owner.first_name&&e.owner.last_name?`${e.owner.first_name} ${e.owner.last_name}`:e.owner.name})]})]}),(((r=e.activity_task_type)==null?void 0:r.name)||e.sf_task_type)&&i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx(bc,{className:"w-4 h-4 text-gray-500 mt-0.5"}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Task Type"}),i.jsx("p",{className:"text-sm text-gray-600",children:((n=e.activity_task_type)==null?void 0:n.name)||e.sf_task_type})]})]})]}),e.sf_id&&i.jsxs("div",{className:"pt-4 border-t border-gray-200",children:[i.jsxs("p",{className:"text-xs text-gray-500",children:["Salesforce ID: ",e.sf_id]}),e.created_at&&i.jsxs("p",{className:"text-xs text-gray-500",children:["Created: ",Pr(new Date(e.created_at),"MMM d, yyyy h:mm a")]})]})]})},FO=(e,t)=>{var o,l;const r=((o=e.activity_status)==null?void 0:o.is_closed)||e.completed_call||e.sf_is_closed,n="w-5 h-5",s=((l=e.activity_type)==null?void 0:l.name)||e.sf_task_subtype,a=(()=>{switch(s){case"Call":return r?i.jsx(lO,{className:`${n} text-green-500`}):i.jsx(va,{className:`${n} text-blue-500`});case"Email":case"ListEmail":return r?i.jsx(aO,{className:`${n} text-green-500`}):i.jsx(ud,{className:`${n} text-blue-500`});case"Task":default:return r?i.jsx(dx,{className:`${n} text-green-500`}):i.jsx(bc,{className:`${n} text-gray-400 hover:text-gray-600`})}})();return(s==="Task"||!s)&&t?i.jsx("button",{onClick:t,className:"flex-shrink-0 p-0.5 rounded-full hover:bg-gray-100 transition-colors group",title:r?"Mark as incomplete":"Mark as complete","aria-label":r?"Mark as incomplete":"Mark as complete",children:r?i.jsx(dx,{className:`${n} text-green-500 group-hover:text-green-600`}):i.jsx(bc,{className:`${n} text-gray-400 group-hover:text-green-500 transition-colors`})}):a},BO=e=>{const t=e.activity_priority,r=(t==null?void 0:t.is_high_priority)||e.is_high_priority,n=(t==null?void 0:t.name)||(e.is_high_priority?e.sf_task_priority||"High Priority":null);return!r||!n?null:i.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",style:{backgroundColor:t!=null&&t.color?`${t.color}20`:"#FEF2F2"},children:[i.jsx(gM,{className:"w-3 h-3"}),n]})},UO=e=>{const t=e.activity_status,r=(t==null?void 0:t.name)||e.sf_status,n=(t==null?void 0:t.is_closed)||e.sf_is_closed;return r?i.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${n?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,style:{backgroundColor:t!=null&&t.color?`${t.color}20`:n?"#F0FDF4":"#F9FAFB",color:(t==null?void 0:t.color)||(n?"#166534":"#374151")},children:r}):null},WO=e=>{if(!e)return null;const t=Math.floor(e/60),r=e%60;return t>0?`${t}m ${r}s`:`${e}s`},HO=({activity:e,onActivityUpdate:t})=>{var f,h,y;const[r,n]=p.useState(!1),[s,a]=p.useState(!1),o=e.activity_date?new Date(e.activity_date):null,l=e.created_at?new Date(e.created_at):null,c=o||l,d=((f=e.activity_type)==null?void 0:f.name)||e.sf_task_subtype,u=()=>{n(!r)},m=async()=>{var w;if(!s){a(!0);try{const b=((w=e.activity_status)==null?void 0:w.is_closed)||e.completed_call||e.sf_is_closed,{data:g}=await M.from("activity_status").select("*").in("name",["Open","Completed"]);if(!g||g.length===0)throw new Error("Could not find Open/Completed statuses");const x=g.find(k=>{var S;return((S=k.name)==null?void 0:S.toLowerCase())==="open"}),v=g.find(k=>{var S;return((S=k.name)==null?void 0:S.toLowerCase())==="completed"}),N=b?x==null?void 0:x.id:v==null?void 0:v.id;if(!N)throw new Error(`Could not find ${b?"Open":"Completed"} status`);const _={status_id:N,updated_at:new Date().toISOString()};b?_.completed_at=null:_.completed_at=new Date().toISOString();const{data:C,error:j}=await M.from("activity").update(_).eq("id",e.id).select(`
          *,
          activity_status!activity_status_id_fkey (
            name,
            color,
            is_closed
          ),
          activity_type!activity_activity_type_id_fkey (
            name,
            color
          ),
          activity_priority!activity_activity_priority_id_fkey (
            name,
            color
          ),
          activity_task_type!activity_activity_task_type_id_fkey (
            name,
            category
          ),
          owner:user!activity_owner_id_fkey (
            first_name,
            last_name,
            email
          ),
          contact!activity_contact_id_fkey (
            first_name,
            last_name,
            company
          )
        `).single();if(j)throw j;t==null||t(C)}catch(b){console.error("Error toggling activity completion:",b),alert("Failed to update task status. Please try again.")}finally{a(!1)}}};return i.jsxs("div",{className:"border-b border-gray-100 last:border-b-0 py-4 first:pt-0 last:pb-0",children:[i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"flex-shrink-0 mt-1",children:FO(e,m)}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[i.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[i.jsx("button",{onClick:u,className:"flex-shrink-0 p-0.5 hover:bg-gray-100 rounded transition-colors","aria-label":r?"Collapse activity":"Expand activity",children:r?i.jsx(dd,{className:"w-4 h-4 text-gray-500"}):i.jsx(Qh,{className:"w-4 h-4 text-gray-500"})}),i.jsx("button",{onClick:u,className:"text-sm font-medium text-gray-900 hover:text-blue-600 transition-colors truncate text-left",children:e.subject||"Untitled Activity"})]}),i.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[BO(e),UO(e)]})]}),e.description&&!["Email","ListEmail"].includes(d||"")&&i.jsx("p",{className:"text-sm text-gray-600 mb-2 line-clamp-2",children:e.description}),i.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.contact&&i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(wc,{className:"w-4 h-4"}),i.jsxs("span",{children:[e.contact.first_name," ",e.contact.last_name]})]}),e.owner&&i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(wc,{className:"w-4 h-4"}),i.jsx("span",{children:e.owner.first_name&&e.owner.last_name?`${e.owner.first_name} ${e.owner.last_name}`:e.owner.name})]}),e.call_duration_seconds&&i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(g_,{className:"w-4 h-4"}),i.jsx("span",{children:WO(e.call_duration_seconds)})]}),(((h=e.activity_task_type)==null?void 0:h.name)||e.sf_task_type)&&i.jsx("div",{className:"flex items-center gap-1",children:i.jsx("span",{className:"font-medium",children:((y=e.activity_task_type)==null?void 0:y.name)||e.sf_task_type})})]}),c&&i.jsx("div",{className:"mt-2 text-xs text-gray-400",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("span",{children:[o&&Pr(o,"MMM d, yyyy"),!o&&l&&`Created ${C0(l,{addSuffix:!0})}`]}),o&&l&&o.getTime()!==l.getTime()&&i.jsxs("span",{children:["Created ",C0(l,{addSuffix:!0})]})]})})]})]}),r&&i.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:i.jsx(OO,{activity:e,onActivityUpdate:t,onClose:()=>n(!1)})})]})},zO=({isOpen:e,onClose:t,onSave:r,parentObject:n,dealId:s})=>{var oe,se,ae;const a=n||(s?{id:s,type:"deal",name:""}:null),[o,l]=p.useState({subject:"",owner_id:null,activity_date:new Date().toISOString().split("T")[0],activity_type_id:null,activity_task_type_id:null,activity_priority_id:null,status_id:null,related_object_type:(a==null?void 0:a.type)||"deal",related_object_id:(a==null?void 0:a.id)||null,description:""}),[c,d]=p.useState([]),[u,m]=p.useState([]),[f,h]=p.useState([]),[y,w]=p.useState([]),[b,g]=p.useState([]),[x,v]=p.useState([]),[N,_]=p.useState(""),[C,j]=p.useState(!1),[k,S]=p.useState(null),[D,R]=p.useState(!1),[P,A]=p.useState(!1),[I,L]=p.useState({}),F=[{value:"contact",label:"Contact"},{value:"client",label:"Client"},{value:"deal",label:"Deal"},{value:"property",label:"Property"},{value:"site_submit",label:"Site Submit"}];p.useEffect(()=>{(async()=>{if(e){R(!0);try{const[ee,q,ce,pe,ye]=await Promise.all([M.from("user").select("id, first_name, last_name, email").order("first_name, last_name"),M.from("activity_type").select("*").eq("active",!0).order("name"),M.from("activity_task_type").select("*").eq("active",!0).order("name"),M.from("activity_priority").select("*").eq("active",!0).order("name"),M.from("activity_status").select("*").eq("active",!0).order("name")]);if(ee.data){const Se=ee.data.filter(Le=>{const Ie=`${Le.first_name||""} ${Le.last_name||""}`.toLowerCase().trim();return!["automated process","chatter","insights","platform integration"].some(ot=>Ie.includes(ot))});d(Se)}if(q.data&&m(q.data),ce.data&&h(ce.data),pe.data&&w(pe.data),ye.data&&g(ye.data),q.data){const Se=q.data.find(Le=>Le.name==="Task");Se&&!o.activity_type_id&&l(Le=>({...Le,activity_type_id:Se.id}))}if(ye.data&&ye.data.length>0){const Le=ye.data.find(Ie=>{var _t;return((_t=Ie.name)==null?void 0:_t.toLowerCase())==="open"})||ye.data[0];l(Ie=>({...Ie,status_id:Le.id}))}if(a){let Se=null,Le="";switch(a.type){case"deal":Se=(await M.from("deal").select("id, deal_name").eq("id",a.id).single()).data,Le="deal_name";break;case"contact":Se=(await M.from("contact").select("id, first_name, last_name, company").eq("id",a.id).single()).data;break;case"client":Se=(await M.from("client").select("id, client_name").eq("id",a.id).single()).data,Le="client_name";break;case"property":Se=(await M.from("property").select("id, property_name").eq("id",a.id).single()).data,Le="property_name";break;case"site_submit":Se=(await M.from("site_submit").select("id, site_submit_name").eq("id",a.id).single()).data,Le="site_submit_name";break}if(Se){let Ie="";if(a.type==="contact"){const ot=Se;Ie=`${ot.first_name} ${ot.last_name}`,ot.company&&(Ie+=` (${ot.company})`)}else Ie=Se[Le];const _t={id:Se.id,label:Ie||a.name,type:a.type};S(_t),_(_t.label),l(ot=>({...ot,related_object_type:a.type,related_object_id:a.id}))}}}catch(ee){console.error("Error loading form data:",ee)}finally{R(!1)}}})()},[e]),p.useEffect(()=>{const T=async()=>{if(!o.related_object_type){v([]);return}try{let q,ce;switch(o.related_object_type){case"contact":q=M.from("contact").select("id, first_name, last_name, company"),ce="name";break;case"client":q=M.from("client").select("id, client_name"),ce="client_name";break;case"deal":q=M.from("deal").select("id, deal_name"),ce="deal_name";break;case"property":q=M.from("property").select("id, property_name"),ce="property_name";break;case"site_submit":q=M.from("site_submit").select("id, site_submit_name"),ce="site_submit_name";break;default:v([]);return}if(N&&N.length>0)switch(o.related_object_type){case"contact":q=q.or(`first_name.ilike.%${N}%,last_name.ilike.%${N}%,company.ilike.%${N}%`);break;case"client":q=q.ilike("client_name",`%${N}%`);break;case"deal":q=q.ilike("deal_name",`%${N}%`);break;case"property":q=q.ilike("property_name",`%${N}%`);break;case"site_submit":q=q.ilike("site_submit_name",`%${N}%`);break}const{data:pe,error:ye}=await q.order(ce).limit(20);if(ye){console.error("Error loading related options:",ye);return}if(pe){const Se=pe.map(Le=>{let Ie;if(o.related_object_type==="contact"){const _t=Le;Ie=`${_t.first_name} ${_t.last_name}`,_t.company&&(Ie+=` (${_t.company})`)}else Ie=Le[ce];return{id:Le.id,label:Ie,type:o.related_object_type}});v(Se)}}catch(q){console.error("Error loading related options:",q)}},ee=setTimeout(()=>{o.related_object_type&&T()},300);return()=>clearTimeout(ee)},[o.related_object_type,N]),p.useEffect(()=>{if(!e)l({subject:"",owner_id:null,activity_date:new Date().toISOString().split("T")[0],activity_type_id:null,activity_task_type_id:null,activity_priority_id:null,status_id:null,related_object_type:(a==null?void 0:a.type)||"deal",related_object_id:(a==null?void 0:a.id)||null,description:""}),L({}),_(""),S(null),j(!1);else if(e&&u.length>0){const T=u.find(ee=>ee.name==="Task");T&&!o.activity_type_id&&l(ee=>({...ee,activity_type_id:T.id}))}},[e,a,u,o.activity_type_id]);const U=(T,ee)=>{l(q=>({...q,[T]:ee})),I[T]&&L(q=>({...q,[T]:""}))},E=T=>{U("related_object_type",T),U("related_object_id",null),_(""),S(null),j(!1)},$=T=>{_(T),j(T.length>0),k&&!k.label.toLowerCase().includes(T.toLowerCase())&&(S(null),U("related_object_id",null))},B=T=>{S(T),_(T.label),U("related_object_id",T.id),j(!1)},H=x.filter(T=>T.label.toLowerCase().includes(N.toLowerCase())),J=()=>{var ee;const T={};return(ee=o.subject)!=null&&ee.trim()||(T.subject="Subject is required"),o.activity_type_id||(T.activity_type_id="Task type is required"),o.status_id||(T.status_id="Status is required"),o.activity_date||(T.activity_date="Due date is required"),L(T),Object.keys(T).length===0},le=async()=>{if(J()){A(!0);try{const T={subject:o.subject,owner_id:o.owner_id,activity_date:o.activity_date,activity_type_id:o.activity_type_id,activity_task_type_id:o.activity_task_type_id,activity_priority_id:o.activity_priority_id,status_id:o.status_id,description:o.description||null,deal_id:(a==null?void 0:a.type)==="deal"?a.id:null};if(o.related_object_type&&o.related_object_id)switch(o.related_object_type){case"contact":T.contact_id=o.related_object_id;break;case"client":T.client_id=o.related_object_id;break;case"deal":T.deal_id=o.related_object_id;break;case"property":T.property_id=o.related_object_id;break;case"site_submit":T.site_submit_id=o.related_object_id;break}console.log("About to insert activity data:",JSON.stringify(T,null,2));const{data:ee,error:q}=await M.from("activity").insert(T).select("*").single();if(q)throw q;r==null||r(ee),t()}catch(T){console.error("Error saving task:",T),console.error("Full error details:",JSON.stringify(T,null,2)),console.error("Form data that was being saved:",o),console.error("Activity data that was being attempted to save:",JSON.stringify({subject:o.subject,owner_id:o.owner_id,activity_date:o.activity_date,activity_type_id:o.activity_type_id,activity_task_type_id:o.activity_task_type_id,activity_priority_id:o.activity_priority_id,status_id:o.status_id,description:o.description,deal_id:(a==null?void 0:a.type)==="deal"?a.id:null,related_object_type:o.related_object_type,related_object_id:o.related_object_id},null,2)),alert(`Error saving task: ${T instanceof Error?T.message:"Unknown error"}. Check console for details.`)}finally{A(!1)}}};return e?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[60]",onClick:t}),i.jsxs("div",{className:`fixed inset-0 lg:inset-y-0 lg:right-0 lg:left-auto w-full lg:w-[600px] bg-white shadow-xl transform transition-transform duration-300 z-[60] ${e?"translate-x-0":"translate-x-full"} flex flex-col`,children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 bg-white",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Add New Task"}),i.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:i.jsx("svg",{className:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:D?i.jsx("div",{className:"flex items-center justify-center h-32",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Task Details"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject *"}),i.jsx("input",{type:"text",value:o.subject,onChange:T=>U("subject",T.target.value),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${I.subject?"border-red-300":""}`,placeholder:"Enter task subject"}),I.subject&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:I.subject})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assigned To"}),i.jsxs("select",{value:o.owner_id||"",onChange:T=>U("owner_id",T.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",children:[i.jsx("option",{value:"",children:"Select user..."}),c.map(T=>i.jsxs("option",{value:T.id,children:[T.first_name," ",T.last_name]},T.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Due Date *"}),i.jsx("input",{type:"date",value:o.activity_date,onChange:T=>U("activity_date",T.target.value),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${I.activity_date?"border-red-300":""}`}),I.activity_date&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:I.activity_date})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Classification"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Task Type *"}),i.jsxs("select",{value:o.activity_type_id||"",onChange:T=>U("activity_type_id",T.target.value||null),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${I.activity_type_id?"border-red-300":""}`,children:[i.jsx("option",{value:"",children:"Select type..."}),u.map(T=>i.jsx("option",{value:T.id,children:T.name},T.id))]}),I.activity_type_id&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:I.activity_type_id})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Task Category"}),i.jsxs("select",{value:o.activity_task_type_id||"",onChange:T=>U("activity_task_type_id",T.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",children:[i.jsx("option",{value:"",children:"Select category..."}),f.map(T=>i.jsxs("option",{value:T.id,children:[T.name," ",T.category&&`(${T.category})`]},T.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),i.jsxs("select",{value:o.activity_priority_id||"",onChange:T=>U("activity_priority_id",T.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",children:[i.jsx("option",{value:"",children:"Select priority..."}),y.map(T=>i.jsx("option",{value:T.id,children:T.name},T.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status *"}),i.jsxs("select",{value:o.status_id||"",onChange:T=>U("status_id",T.target.value||null),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${I.status_id?"border-red-300":""}`,children:[i.jsx("option",{value:"",children:"Select status..."}),b.filter(T=>{var ee;return["open","completed"].includes(((ee=T.name)==null?void 0:ee.toLowerCase())||"")}).map(T=>i.jsx("option",{value:T.id,children:T.name},T.id))]}),I.status_id&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:I.status_id})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Related To"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Related Object Type"}),i.jsx("select",{value:o.related_object_type,onChange:T=>E(T.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",children:F.map(T=>i.jsx("option",{value:T.value,children:T.label},T.value))})]}),i.jsxs("div",{className:"relative",children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Related ",(oe=F.find(T=>T.value===o.related_object_type))==null?void 0:oe.label]}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",value:N,onChange:T=>$(T.target.value),onFocus:()=>j(N.length>0),onBlur:()=>{setTimeout(()=>j(!1),150)},className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm pr-10",placeholder:`Search ${(se=F.find(T=>T.value===o.related_object_type))==null?void 0:se.label.toLowerCase()}s...`}),i.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:i.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),C&&H.length>0&&i.jsx("div",{className:"absolute z-10 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base ring-1 ring-black ring-opacity-5 overflow-auto focus:outline-none sm:text-sm",children:H.map(T=>i.jsx("button",{type:"button",className:"text-left w-full px-4 py-2 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-900 focus:outline-none focus:bg-blue-50",onMouseDown:ee=>{ee.preventDefault(),B(T)},children:T.label},T.id))}),C&&N.length>0&&H.length===0&&i.jsxs("div",{className:"absolute z-10 mt-1 w-full bg-white shadow-lg rounded-md py-2 px-4 text-sm text-gray-500",children:["No ",(ae=F.find(T=>T.value===o.related_object_type))==null?void 0:ae.label.toLowerCase(),"s found"]})]}),k&&i.jsxs("div",{className:"mt-2 flex items-center justify-between bg-blue-50 rounded-md px-3 py-2",children:[i.jsxs("span",{className:"text-sm text-blue-900",children:["Selected: ",k.label]}),i.jsx("button",{type:"button",onClick:()=>{S(null),_(""),U("related_object_id",null)},className:"text-blue-600 hover:text-blue-800",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Additional Details"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),i.jsx("textarea",{rows:4,value:o.description,onChange:T=>U("description",T.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"Enter task description..."})]})]})]})}),i.jsx("div",{className:"border-t border-gray-200 p-4 bg-gray-50",children:i.jsxs("div",{className:"flex justify-end space-x-3",children:[i.jsx("button",{type:"button",onClick:t,disabled:P,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:"Cancel"}),i.jsx("button",{type:"button",onClick:le,disabled:P||D,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:P?"Creating...":"Create Task"})]})})]})]}):null},VO=({isOpen:e,onClose:t,onCallLogged:r,parentObject:n})=>{const[s,a]=p.useState({subject:"",comments:"",contact_id:"",related_to:(n==null?void 0:n.id)||"",related_to_type:(n==null?void 0:n.type)||"",is_prospecting:!1,completed_call:!0,meeting_held:!1,is_property_prospecting_call:!1,completed_property_call:!1}),[o,l]=p.useState([]),[c,d]=p.useState([]),[u,m]=p.useState(""),[f,h]=p.useState((n==null?void 0:n.name)||""),[y,w]=p.useState(!1),[b,g]=p.useState(!1),[x,v]=p.useState(!1),[N,_]=p.useState({});p.useEffect(()=>{const D=setTimeout(async()=>{if(u.length<2){l([]);return}try{const{data:R,error:P}=await M.from("contact").select("id, first_name, last_name, company").or(`first_name.ilike.%${u}%,last_name.ilike.%${u}%,company.ilike.%${u}%`).limit(10);if(P)throw P;const A=(R||[]).map(I=>({id:I.id,name:`${I.first_name||""} ${I.last_name||""}`.trim(),type:"contact",subtitle:I.company||void 0}));l(A)}catch(R){console.error("Error searching contacts:",R)}},300);return()=>clearTimeout(D)},[u]),p.useEffect(()=>{const D=setTimeout(async()=>{if(f.length<2){d([]);return}try{const R=await Promise.all([M.from("deal").select("id, name").ilike("name",`%${f}%`).limit(5),M.from("contact").select("id, first_name, last_name, company").or(`first_name.ilike.%${f}%,last_name.ilike.%${f}%,company.ilike.%${f}%`).limit(5),M.from("client").select("id, name").ilike("name",`%${f}%`).limit(5)]),P=[];R[0].data&&R[0].data.forEach(A=>{P.push({id:A.id,name:A.name,type:"deal"})}),R[1].data&&R[1].data.forEach(A=>{P.push({id:A.id,name:`${A.first_name||""} ${A.last_name||""}`.trim(),type:"contact",subtitle:A.company||void 0})}),R[2].data&&R[2].data.forEach(A=>{P.push({id:A.id,name:A.name,type:"client"})}),d(P)}catch(R){console.error("Error searching related objects:",R)}},300);return()=>clearTimeout(D)},[f]),p.useEffect(()=>{e&&(a({subject:"",comments:"",contact_id:"",related_to:(n==null?void 0:n.id)||"",related_to_type:(n==null?void 0:n.type)||"",is_prospecting:!1,completed_call:!0,meeting_held:!1,is_property_prospecting_call:!1,completed_property_call:!1}),h((n==null?void 0:n.name)||""),m(""),_({}))},[e,n]);const C=async S=>{S.preventDefault();const D={};if(s.subject.trim()||(D.subject="Subject is required"),s.related_to||(D.related_to="Related to field is required"),Object.keys(D).length>0){_(D);return}v(!0);try{const{data:R,error:P}=await M.from("activity_type").select("id").eq("name","Call").single();if(P||!R)throw new Error("Could not find Call activity type");const{data:A,error:I}=await M.from("activity_status").select("id").eq("name","Completed").single();if(I||!A)throw new Error("Could not find Completed status");const L={subject:s.subject,description:s.comments||null,activity_type_id:R.id,status_id:A.id,activity_date:new Date().toISOString(),completed_at:new Date().toISOString(),contact_id:s.contact_id||null,is_prospecting:s.is_prospecting,completed_call:s.completed_call,meeting_held:s.meeting_held,is_property_prospecting_call:s.is_property_prospecting_call,completed_property_call:s.completed_property_call};switch(s.related_to_type){case"deal":L.deal_id=s.related_to;break;case"contact":L.contact_id=s.related_to;break;case"client":L.client_id=s.related_to;break;case"property":L.property_id=s.related_to;break;case"site_submit":L.site_submit_id=s.related_to;break;default:L.related_object_type=s.related_to_type,L.related_object_id=s.related_to;break}const{error:F}=await M.from("activity").insert([L]);if(F)throw F;r==null||r(),t()}catch(R){console.error("Error logging call:",R),_({general:"Failed to log call. Please try again."})}finally{v(!1)}},j=S=>{a(D=>({...D,contact_id:S.id})),m(S.name),w(!1)},k=S=>{a(D=>({...D,related_to:S.id,related_to_type:S.type})),h(S.name),g(!1)};return e?i.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:i.jsxs("div",{className:"relative top-20 mx-auto p-5 border w-11/12 max-w-2xl shadow-lg rounded-md bg-white",children:[i.jsxs("div",{className:"flex items-center justify-between pb-4 border-b",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(va,{className:"w-5 h-5 text-blue-600"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Log Call"})]}),i.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close modal",children:i.jsx(x_,{className:"w-5 h-5"})})]}),i.jsxs("form",{onSubmit:C,className:"mt-4 space-y-4",children:[N.general&&i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:i.jsx("p",{className:"text-sm text-red-600",children:N.general})}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"subject",className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject *"}),i.jsx("input",{type:"text",id:"subject",value:s.subject,onChange:S=>a(D=>({...D,subject:S.target.value})),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${N.subject?"border-red-300":"border-gray-300"}`,placeholder:"Enter call subject"}),N.subject&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:N.subject})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"comments",className:"block text-sm font-medium text-gray-700 mb-1",children:"Comments"}),i.jsx("textarea",{id:"comments",value:s.comments,onChange:S=>a(D=>({...D,comments:S.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter call notes or comments"})]}),i.jsxs("div",{className:"relative",children:[i.jsx("label",{htmlFor:"contact",className:"block text-sm font-medium text-gray-700 mb-1",children:"Related Contact"}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",value:u,onChange:S=>{m(S.target.value),w(!0)},onFocus:()=>w(!0),className:"w-full px-3 py-2 pl-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Search contacts..."}),i.jsx(em,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]}),y&&o.length>0&&i.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:o.map(S=>i.jsx("button",{type:"button",onClick:()=>j(S),className:"w-full px-3 py-2 text-left hover:bg-gray-50 focus:bg-gray-50 focus:outline-none",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-gray-900",children:S.name}),S.subtitle&&i.jsx("div",{className:"text-sm text-gray-500",children:S.subtitle})]}),s.contact_id===S.id&&i.jsx(ox,{className:"w-4 h-4 text-blue-600"})]})},S.id))})]}),i.jsxs("div",{className:"relative",children:[i.jsx("label",{htmlFor:"related",className:"block text-sm font-medium text-gray-700 mb-1",children:"Related To *"}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",value:f,onChange:S=>{h(S.target.value),g(!0)},onFocus:()=>g(!0),className:`w-full px-3 py-2 pl-10 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${N.related_to?"border-red-300":"border-gray-300"}`,placeholder:"Search deals, contacts, clients..."}),i.jsx(em,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]}),b&&c.length>0&&i.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:c.map(S=>i.jsx("button",{type:"button",onClick:()=>k(S),className:"w-full px-3 py-2 text-left hover:bg-gray-50 focus:bg-gray-50 focus:outline-none",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-gray-900",children:S.name}),i.jsx("div",{className:"text-sm text-gray-500 capitalize",children:S.type})]}),s.related_to===S.id&&s.related_to_type===S.type&&i.jsx(ox,{className:"w-4 h-4 text-blue-600"})]})},`${S.type}-${S.id}`))}),N.related_to&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:N.related_to})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Call Details"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:s.is_prospecting,onChange:S=>a(D=>({...D,is_prospecting:S.target.checked})),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Prospecting Call"})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:s.completed_call,onChange:S=>a(D=>({...D,completed_call:S.target.checked})),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Completed Call"})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:s.meeting_held,onChange:S=>a(D=>({...D,meeting_held:S.target.checked})),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Meeting Held"})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:s.is_property_prospecting_call,onChange:S=>a(D=>({...D,is_property_prospecting_call:S.target.checked})),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Property Prospecting Call"})]}),i.jsxs("label",{className:"flex items-center md:col-span-2",children:[i.jsx("input",{type:"checkbox",checked:s.completed_property_call,onChange:S=>a(D=>({...D,completed_property_call:S.target.checked})),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Completed Property Call"})]})]})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[i.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),i.jsx("button",{type:"submit",disabled:x,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:x?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Logging Call..."]}):i.jsxs(i.Fragment,{children:[i.jsx(va,{className:"w-4 h-4"}),"Log Call"]})})]})]})]})}):null},Cu=({title:e,help:t,children:r})=>i.jsxs("section",{className:"bg-white rounded-md border p-4 mb-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:e}),t&&i.jsx("span",{className:"text-gray-500 text-xs border rounded-full w-4 h-4 inline-flex items-center justify-center",title:t,"aria-label":t,children:"i"})]}),r]}),YO=({config:e})=>{const{parentObject:t,title:r="Activities",showSummary:n=!0,allowAdd:s=!0}=e,{activities:a,loading:o,error:l,refetch:c}=eO(t),[d,u]=p.useState(""),[m,f]=p.useState("all"),[h,y]=p.useState("all"),[w,b]=p.useState(!1),[g,x]=p.useState(!1),v=a.filter(_=>{var C,j,k,S;if(d){const D=d.toLowerCase(),R=(C=_.subject)==null?void 0:C.toLowerCase().includes(D),P=(j=_.description)==null?void 0:j.toLowerCase().includes(D),A=_.contact&&`${_.contact.first_name} ${_.contact.last_name}`.toLowerCase().includes(D);if(!R&&!P&&!A)return!1}if(m!=="all"&&((k=_.activity_type)==null?void 0:k.name)!==m)return!1;if(h!=="all"){const D=((S=_.activity_status)==null?void 0:S.is_closed)||_.sf_is_closed||_.completed_call||_.sf_status&&["Completed","Complete","Closed"].includes(_.sf_status);if(h==="completed"&&!D||h==="open"&&!D)return!1}return!0}),N=[...new Set(a.map(_=>{var C;return(C=_.activity_type)==null?void 0:C.name}).filter(Boolean))];return l?i.jsx(Cu,{title:r,children:i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:i.jsx("div",{className:"flex",children:i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error Loading Activities"}),i.jsx("div",{className:"mt-2 text-sm text-red-700",children:i.jsx("p",{children:l})}),i.jsx("div",{className:"mt-4",children:i.jsx("button",{onClick:c,className:"bg-red-100 px-3 py-2 rounded text-sm font-medium text-red-800 hover:bg-red-200",children:"Try Again"})})]})})})}):i.jsxs("div",{className:"space-y-4",children:[n&&i.jsxs(Cu,{title:"Activity Summary",help:`Overview of all activities related to this ${t.type}`,children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[i.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(Rs,{className:"w-8 h-8 text-blue-600"}),i.jsxs("div",{className:"ml-3",children:[i.jsx("p",{className:"text-sm font-medium text-blue-600",children:"Total Activities"}),i.jsx("p",{className:"text-2xl font-semibold text-blue-900",children:a.length})]})]})}),i.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(Rs,{className:"w-8 h-8 text-green-600"}),i.jsxs("div",{className:"ml-3",children:[i.jsx("p",{className:"text-sm font-medium text-green-600",children:"Completed"}),i.jsx("p",{className:"text-2xl font-semibold text-green-900",children:a.filter(_=>{var C;return((C=_.activity_status)==null?void 0:C.is_closed)||_.sf_is_closed||_.completed_call||_.sf_status&&["Completed","Complete","Closed"].includes(_.sf_status)}).length})]})]})}),i.jsx("div",{className:"bg-orange-50 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(Rs,{className:"w-8 h-8 text-orange-600"}),i.jsxs("div",{className:"ml-3",children:[i.jsx("p",{className:"text-sm font-medium text-orange-600",children:"Open"}),i.jsx("p",{className:"text-2xl font-semibold text-orange-900",children:a.filter(_=>{var C;return!((C=_.activity_status)!=null&&C.is_closed||_.sf_is_closed||_.completed_call||_.sf_status&&["Completed","Complete","Closed"].includes(_.sf_status))}).length})]})]})})]}),s&&i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{className:"inline-flex items-center gap-2 px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",onClick:()=>b(!0),children:[i.jsx(lx,{className:"w-4 h-4"}),"Add Activity"]}),i.jsxs("button",{className:"inline-flex items-center gap-2 px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",onClick:()=>x(!0),children:[i.jsx(va,{className:"w-4 h-4"}),"Log Call"]}),i.jsxs("button",{className:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",onClick:c,children:[i.jsx(Rs,{className:"w-4 h-4"}),"Refresh"]})]})]}),i.jsxs(Cu,{title:`Activity Timeline (${v.length})`,help:`Chronological list of all activities for this ${t.type}`,children:[i.jsxs("div",{className:"mb-4 space-y-3",children:[i.jsxs("div",{className:"relative",children:[i.jsx(em,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),i.jsx("input",{type:"text",placeholder:"Search activities...",value:d,onChange:_=>u(_.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(_M,{className:"w-4 h-4 text-gray-400"}),i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Type:"}),i.jsxs("select",{value:m,onChange:_=>f(_.target.value),className:"border border-gray-300 rounded text-sm px-2 py-1 focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"all",children:"All Types"}),N.map(_=>i.jsx("option",{value:_,children:_},_))]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Status:"}),i.jsxs("select",{value:h,onChange:_=>y(_.target.value),className:"border border-gray-300 rounded text-sm px-2 py-1 focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"all",children:"All Status"}),i.jsx("option",{value:"open",children:"Open"}),i.jsx("option",{value:"completed",children:"Completed"})]})]})]})]}),o?i.jsxs("div",{className:"flex items-center justify-center py-8",children:[i.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),i.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"Loading activities..."})]}):v.length===0?i.jsx("div",{className:"text-center py-8",children:a.length===0?i.jsxs("div",{children:[i.jsx(Rs,{className:"mx-auto h-12 w-12 text-gray-400"}),i.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No activities"}),i.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:["No activities have been recorded for this ",t.type," yet."]}),s&&i.jsx("div",{className:"mt-6",children:i.jsxs("button",{className:"inline-flex items-center gap-2 px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",onClick:()=>b(!0),children:[i.jsx(lx,{className:"w-4 h-4"}),"Add First Activity"]})})]}):i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-500",children:"No activities match your current filters."}),i.jsx("button",{onClick:()=>{u(""),f("all"),y("all")},className:"mt-2 text-sm text-blue-600 hover:text-blue-800",children:"Clear filters"})]})}):i.jsx("div",{className:"space-y-0",children:v.map(_=>i.jsx(HO,{activity:_,onActivityUpdate:C=>{console.log("Activity updated:",C),c()}},_.id))})]}),s&&i.jsx(zO,{isOpen:w,onClose:()=>b(!1),onSave:_=>{console.log("New activity created:",_),c(),b(!1)},parentObject:t}),s&&i.jsx(VO,{isOpen:g,onClose:()=>x(!1),onCallLogged:()=>{console.log("Call logged successfully"),c(),x(!1)},parentObject:t})]})},qO=({dealId:e})=>{const r={parentObject:{id:e,type:"deal",name:""},title:"Activities",showSummary:!0,allowAdd:!0,allowEdit:!0};return i.jsx(YO,{config:r})},GO=({deal:e})=>{const[t,r]=p.useState(null),[n,s]=p.useState(null),[a,o]=p.useState(!0);p.useEffect(()=>{(async()=>{try{if(e.client_id){const{data:m}=await M.from("client").select("id, client_name").eq("id",e.client_id).single();m&&r(m)}if(e.stage_id){const{data:m}=await M.from("deal_stage").select("id, label").eq("id",e.stage_id).single();m&&s(m)}}catch(m){console.error("Error fetching header data:",m)}finally{o(!1)}})()},[e.client_id,e.stage_id]);const l=u=>u==null?"$0":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(u),c=u=>{if(!u)return"Not set";try{return new Date(u).toLocaleDateString("en-US",{month:"numeric",day:"numeric",year:"numeric"})}catch{return"Invalid date"}},d=()=>i.jsxs("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"}),i.jsx("circle",{cx:"4",cy:"4",r:"1",fill:"currentColor"}),i.jsx("circle",{cx:"13",cy:"7",r:"1",fill:"currentColor"}),i.jsx("circle",{cx:"21",cy:"7",r:"1",fill:"currentColor"})]});return a?i.jsx("div",{className:"bg-gradient-to-r from-slate-800 to-slate-700 border-b border-slate-600 text-white px-6 py-4",children:i.jsx("div",{className:"max-w-7xl mx-auto",children:i.jsx("div",{className:"flex items-center space-x-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("div",{className:"w-8 h-8 bg-slate-600 rounded-lg flex items-center justify-center",children:i.jsx(d,{})}),i.jsx("span",{className:"text-sm font-medium text-slate-300",children:"Loading..."})]})})})}):i.jsx("div",{className:"bg-gradient-to-r from-slate-800 to-slate-700 border-b border-slate-600 text-white px-6 py-4",children:i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[i.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-slate-600 rounded-lg",children:[i.jsx(d,{}),i.jsx("span",{className:"text-white text-sm font-medium",children:"Deal"})]}),i.jsx("h1",{className:"text-xl font-bold leading-tight",children:e.deal_name||"Unnamed Deal"})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-slate-300 font-medium mb-1",children:"Account Name"}),i.jsx("div",{className:"text-white",children:(t==null?void 0:t.client_name)||"No Client"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-slate-300 font-medium mb-1",children:"Stage"}),i.jsx("div",{className:"text-white font-semibold",children:(n==null?void 0:n.label)||"No Stage"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-slate-300 font-medium mb-1",children:"Probability"}),i.jsx("div",{className:"text-white font-semibold",children:e.probability!==null?`${e.probability}%`:"0%"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-slate-300 font-medium mb-1",children:"Target Close Date"}),i.jsx("div",{className:"text-white",children:c(e.target_close_date)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-slate-300 font-medium mb-1",children:"Deal Value"}),i.jsx("div",{className:"text-white font-bold text-base",children:l(e.deal_value)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-slate-300 font-medium mb-1",children:"Fee"}),i.jsx("div",{className:"text-emerald-400 font-bold text-base",children:l(e.fee)})]})]})]})})};function mx(){const{dealId:e}=io(),t=pr(),[r,n]=p.useState(null),[s,a]=p.useState("overview"),[o,l]=p.useState(!1);console.log("DealDetailsPage - location:",t.pathname,"dealId from params:",e);const c=e||(t.pathname==="/deal/new"?"new":void 0),{contacts:d}=f_(c&&c!=="new"?c:null);p.useEffect(()=>{const f=async()=>{if(c==="new"){console.log("Creating new blank deal...");const w={id:null,deal_name:"",client_id:null,property_id:null,deal_stage_id:null,sf_broker:"",sf_address:"",sf_close_date:null,sf_contract_date:null,sf_list_date:null,deal_side:null,commission_rate:null,gross_commission:null,net_commission:null,house_percent:40,origination_percent:50,site_percent:25,deal_percent:25,number_of_payments:2,is_active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};console.log("Blank deal created:",w),n(w),l(!0);return}console.log("Fetching existing deal with ID:",c);const{data:h,error:y}=await M.from("deal").select("*").eq("id",c).single();y?console.error("Error fetching deal:",y):h&&(console.log("Existing deal loaded:",h),n(h),l(!1))};console.log("DealDetailsPage useEffect - actualDealId:",c,"type:",typeof c),c?(console.log("DealDetailsPage useEffect triggered with actualDealId:",c),c==="new"&&a("overview"),f()):console.log("No actualDealId provided - this should not happen for deal routes")},[c]);const u=f=>{n(f),o&&f.id&&l(!1)},m=async f=>{const h={...r,...f};return n(h),o&&h.id&&l(!1),Promise.resolve()};return console.log("DealDetailsPage render - deal:",r,"dealId:",e,"actualDealId:",c,"isNewDeal:",o),r?i.jsxs(II,{children:[i.jsxs(MI,{contactCount:d.length,notesCount:0,filesCount:0,activityCount:0,paymentsCount:0,children:[i.jsx(GO,{deal:r}),i.jsxs("div",{className:"p-4 max-w-4xl mx-auto",children:[i.jsx("div",{className:"border-b border-gray-200 mb-6",children:i.jsxs("nav",{className:"-mb-px flex space-x-8",children:[i.jsx("button",{onClick:()=>a("overview"),className:`py-2 px-1 border-b-2 font-medium text-sm ${s==="overview"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Overview"}),i.jsx("button",{onClick:()=>a("commission"),className:`py-2 px-1 border-b-2 font-medium text-sm ${s==="commission"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Commission"}),i.jsx("button",{onClick:()=>a("payments"),className:`py-2 px-1 border-b-2 font-medium text-sm ${s==="payments"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Payments"}),i.jsx("button",{onClick:()=>a("activity"),className:`py-2 px-1 border-b-2 font-medium text-sm ${s==="activity"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Activity"})]})}),s==="overview"&&i.jsx(TI,{deal:r,onSave:u}),s==="commission"&&i.jsx(i.Fragment,{children:o||!r.id?i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-4",children:i.jsx("div",{className:"flex",children:i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Save Deal First"}),i.jsx("div",{className:"mt-2 text-sm text-yellow-700",children:i.jsx("p",{children:"Please save the deal in the Overview tab before managing commission details."})})]})})}):i.jsx(UI,{dealId:r.id,deal:r,onDealUpdate:m,onSwitchToPayments:()=>a("payments")})}),s==="payments"&&i.jsx(i.Fragment,{children:o||!r.id?i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-4",children:i.jsx("div",{className:"flex",children:i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Save Deal First"}),i.jsx("div",{className:"mt-2 text-sm text-yellow-700",children:i.jsx("p",{children:"Please save the deal in the Overview tab before managing payments."})})]})})}):i.jsx(ZM,{deal:r,onDealUpdate:m})}),s==="activity"&&i.jsx(i.Fragment,{children:o||!r.id?i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-4",children:i.jsx("div",{className:"flex",children:i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Save Deal First"}),i.jsx("div",{className:"mt-2 text-sm text-yellow-700",children:i.jsx("p",{children:"Please save the deal in the Overview tab before viewing activities."})})]})})}):i.jsx(qO,{dealId:r.id})})]})]}),e&&e!=="new"&&i.jsx(OI,{dealId:e})]}):i.jsx("div",{className:"p-4",children:c==="new"?"Initializing new deal...":"Loading..."})}const j_=e=>{const[t,r]=p.useState(null),[n,s]=p.useState(!0),[a,o]=p.useState(null),l=p.useCallback(async()=>{if(!e){r(null),s(!1);return}try{s(!0),o(null);const{data:m,error:f}=await M.from("property").select("*").eq("id",e).single();if(f)throw f;const[h,y,w]=await Promise.all([m.property_type_id?M.from("property_type").select("*").eq("id",m.property_type_id).single():Promise.resolve({data:null,error:null}),m.property_stage_id?M.from("property_stage").select("*").eq("id",m.property_stage_id).single():Promise.resolve({data:null,error:null}),m.property_record_type_id?M.from("property_record_type").select("*").eq("id",m.property_record_type_id).single():Promise.resolve({data:null,error:null})]),b={...m,property_type:h.data||void 0,property_stage:y.data||void 0,property_record_type:w.data||void 0};r(b)}catch(m){console.error("Error fetching property:",m),o(m instanceof Error?m.message:"Failed to fetch property")}finally{s(!1)}},[e]);p.useEffect(()=>{l()},[l]);const c=p.useCallback(async m=>{if(!e)throw new Error("No property ID provided");try{o(null);const f={...m,updated_at:new Date().toISOString()},{data:h,error:y}=await M.from("property").update(f).eq("id",e).select("*").single();if(y)throw y;r(h)}catch(f){throw console.error("Error updating property:",f),o(f instanceof Error?f.message:"Failed to update property"),f}},[e]),d=p.useCallback(async m=>{try{o(null);const{data:f,error:h}=await M.from("property").insert([{...m,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]).select().single();if(h)throw h;return f}catch(f){throw console.error("Error creating property:",f),o(f instanceof Error?f.message:"Failed to create property"),f}},[]),u=p.useCallback(async()=>{await l()},[l]);return{property:t,loading:n,error:a,updateProperty:c,createProperty:d,refreshProperty:u}},KO=e=>{const[t,r]=p.useState(e||{}),[n,s]=p.useState(e||{}),a=p.useCallback(u=>{r(u)},[]),o=p.useCallback((u,m)=>{r(f=>({...f,[u]:m}))},[]),l=p.useCallback(u=>{const m=u||{};r(m),s(m)},[]),c=(()=>{var _,C,j,k;const u={},m=[];(_=t.property_name)!=null&&_.trim()||(u.property_name="Property name is required"),(C=t.address)!=null&&C.trim()||(u.address="Address is required"),(j=t.city)!=null&&j.trim()||(u.city="City is required"),(k=t.state)!=null&&k.trim()||(u.state="State is required");const f=Number(t.asking_lease_price),h=Number(t.asking_purchase_price);f<0&&(u.asking_lease_price="Lease price cannot be negative"),h<0&&(u.asking_purchase_price="Purchase price cannot be negative");const y=Number(t.rent_psf),w=Number(t.nnn_psf);y<0&&(u.rent_psf="Rent PSF cannot be negative"),w<0&&(u.nnn_psf="NNN PSF cannot be negative");const b=Number(t.building_sqft),g=Number(t.available_sqft);b<0&&(u.building_sqft="Building square footage cannot be negative"),g<0&&(u.available_sqft="Available square footage cannot be negative"),g>0&&b>0&&g>b&&m.push("Available square footage exceeds building square footage"),Number(t.traffic_count)<0&&(u.traffic_count="Traffic count cannot be negative");const v=Number(t.latitude),N=Number(t.longitude);return v&&(v<-90||v>90)&&(u.latitude="Latitude must be between -90 and 90"),N&&(N<-180||N>180)&&(u.longitude="Longitude must be between -180 and 180"),t.property_type_id||m.push("Property type is not set"),t.property_stage_id||m.push("Property stage is not set"),t.contact_id||m.push("No contact assigned to this property"),f===0&&h===0&&m.push("No pricing information available"),{isValid:Object.keys(u).length===0,errors:u,warnings:m}})(),d=JSON.stringify(t)!==JSON.stringify(n);return{formData:t,setFormData:a,updateField:o,validation:c,resetForm:l,isDirty:d}},QO=({property:e,isEditing:t,onToggleEdit:r,onBack:n,onGetLocation:s,onCallContact:a})=>{var l;const o=()=>i.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})});return i.jsx("div",{className:"sticky top-0 z-10 bg-gradient-to-r from-slate-800 to-slate-700 border-b border-slate-600 text-white shadow-sm",children:i.jsxs("div",{className:"px-4 sm:px-6 py-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("button",{onClick:n,className:"flex items-center justify-center w-8 h-8 rounded-lg bg-slate-600 hover:bg-slate-500 transition-colors",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),i.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-slate-600 rounded-lg",children:[i.jsx(o,{}),i.jsx("span",{className:"text-white text-sm font-medium",children:"Property"})]})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[s&&i.jsx("button",{onClick:s,className:"flex items-center justify-center w-10 h-10 rounded-lg bg-slate-600 hover:bg-slate-500 transition-colors",title:"Get current location",children:i.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})}),a&&e.contact_id&&i.jsx("button",{onClick:a,className:"flex items-center justify-center w-10 h-10 rounded-lg bg-green-600 hover:bg-green-500 transition-colors",title:"Call contact",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})})]})]}),i.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:i.jsxs("div",{children:[i.jsx("h1",{className:"text-xl font-bold leading-tight mb-2",children:e.property_name||e.address||"Unnamed Property"}),e.address&&e.property_name&&i.jsx("p",{className:"text-slate-300 text-sm",children:e.address})]})}),i.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4 mt-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-slate-300 font-medium mb-1",children:"Type"}),i.jsx("div",{className:"text-white",children:((l=e.property_type)==null?void 0:l.label)||"Not set"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-slate-300 font-medium mb-1",children:"Building Size"}),i.jsx("div",{className:"text-white",children:e.building_sqft?`${e.building_sqft.toLocaleString()} SF`:"Not set"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-slate-300 font-medium mb-1",children:"Available Size"}),i.jsx("div",{className:"text-white",children:e.available_sqft?`${e.available_sqft.toLocaleString()} SF`:"Not set"})]})]})]})})},cs=({label:e,value:t,onChange:r,field:n,placeholder:s,disabled:a=!1,tabIndex:o})=>{const[l,c]=p.useState(!1),[d,u]=p.useState(""),[m,f]=p.useState([]),[h,y]=p.useState(!1),[w,b]=p.useState(-1),[g,x]=p.useState(!1),v=p.useRef(null),N=p.useRef(null),_=t||"",C=async L=>{if(L.trim().length<2){f([]);return}x(!0);try{const{data:F,error:U}=await M.from("property").select(n).not(n,"is",null).ilike(n,`%${L}%`);if(U)throw U;const E={};F==null||F.forEach(B=>{const H=B[n];H&&(E[H]=(E[H]||0)+1)});const $=Object.entries(E).map(([B,H])=>({value:B,count:H})).sort((B,H)=>H.count-B.count).slice(0,8);f($)}catch(F){console.error("Error fetching suggestions:",F),f([])}finally{x(!1)}};p.useEffect(()=>{if(!l)return;const L=setTimeout(()=>{C(d)},300);return()=>clearTimeout(L)},[d,l,n]);const j=L=>{a||(c(!0),u(L!==void 0?L:t||""),y(!0),b(-1))},k=()=>{a||j()},S=L=>{r((L??d).trim()||null),c(!1),y(!1),f([]),b(-1)},D=()=>{c(!1),y(!1),f([]),u(""),b(-1)},R=L=>{u(L),S(L)},P=L=>{L.key==="Enter"?(L.preventDefault(),w>=0&&m[w]?S(m[w].value):S()):L.key==="Escape"?(L.preventDefault(),D()):L.key==="ArrowDown"?(L.preventDefault(),b(F=>F<m.length-1?F+1:F)):L.key==="ArrowUp"&&(L.preventDefault(),b(F=>F>0?F-1:-1))},A=L=>{const F=L.target.value;u(F),y(!0),b(-1)},I=()=>{setTimeout(()=>{var L;(L=N.current)!=null&&L.contains(document.activeElement)||S()},150)};return l?i.jsxs("div",{className:"relative",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),i.jsx("input",{ref:v,type:"text",value:d,onChange:A,onBlur:I,onKeyDown:P,placeholder:s,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base min-h-[44px]",tabIndex:o,autoFocus:!0}),h&&(m.length>0||g)&&i.jsxs("div",{ref:N,className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-48 overflow-y-auto",children:[g&&i.jsxs("div",{className:"px-3 py-2 text-sm text-gray-500 flex items-center gap-2",children:[i.jsx("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),"Loading suggestions..."]}),!g&&m.map((L,F)=>i.jsxs("button",{type:"button",onMouseDown:U=>{U.preventDefault(),R(L.value)},className:`w-full px-3 py-2 text-left hover:bg-blue-50 flex items-center justify-between ${F===w?"bg-blue-50 text-blue-900":"text-gray-900"}`,children:[i.jsx("span",{className:"truncate",children:L.value}),i.jsxs("span",{className:"text-xs text-gray-500 ml-2 flex-shrink-0",children:[L.count," properties"]})]},L.value)),!g&&m.length===0&&d.trim().length>=2&&i.jsxs("div",{className:"px-3 py-2 text-sm text-gray-500",children:["No matching ",e.toLowerCase()," found"]})]})]}):i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:e}),i.jsx("div",{onClick:()=>j(),onKeyDown:L=>{L.key==="Enter"||L.key===" "?(L.preventDefault(),j()):L.key.length===1&&!L.ctrlKey&&!L.metaKey&&!L.altKey&&(L.preventDefault(),j(L.key))},onFocus:k,tabIndex:o||0,className:`mt-1 px-3 py-2 rounded-md shadow-sm border text-base min-h-[44px] flex items-center transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${a?"bg-gray-100 cursor-not-allowed border-gray-200":"cursor-pointer hover:bg-blue-50 border-transparent hover:border-blue-200 bg-white"}`,title:a?"Not editable":"Click to edit - suggestions will appear as you type",role:"button","aria-label":`Click to edit ${e}`,children:i.jsx("span",{className:t?"text-gray-900":"text-gray-500",children:_})})]})},Ne=({label:e,value:t,onChange:r,type:n="text",placeholder:s,disabled:a=!1,multiline:o=!1,rows:l=1,inputMode:c,tabIndex:d,required:u=!1,defaultText:m="Click to add"})=>{const[f,h]=p.useState(!1),[y,w]=p.useState(""),b=t!=null&&t!==""&&t!==0?t:"",g=!t||typeof t=="string"&&t.trim()==="",x=u&&g,v=()=>{a||(h(!0),w((t==null?void 0:t.toString())||""))},N=()=>{a||v()},_=()=>{if(n==="number"){const k=parseFloat(y);r(isNaN(k)?null:k)}else r(y.trim()||null);h(!1)},C=()=>{h(!1),w("")},j=k=>{k.key==="Enter"&&!o?(k.preventDefault(),k.stopPropagation(),_()):k.key==="Escape"&&(k.preventDefault(),k.stopPropagation(),C())};if(f){const k=o?"textarea":"input";return i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),i.jsx(k,{type:o?void 0:n,inputMode:c,value:y,onChange:S=>w(S.target.value),onBlur:_,onKeyDown:j,placeholder:s,rows:o?l:void 0,className:`w-full px-3 py-2 rounded-md shadow-sm text-base min-h-[44px] resize-none ${x?"border-red-300 bg-red-50 focus:ring-red-500 focus:border-red-500":"border-gray-300 bg-white focus:ring-blue-500 focus:border-blue-500"}`,tabIndex:d,autoFocus:!0})]})}return i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:e}),i.jsx("div",{onClick:v,onKeyDown:k=>{k.key==="Enter"||k.key===" "?(k.preventDefault(),v()):k.key.length===1&&!k.ctrlKey&&!k.metaKey&&!k.altKey&&(k.preventDefault(),h(!0),w(k.key))},onFocus:N,tabIndex:d||0,className:`mt-1 px-3 py-2 rounded-md shadow-sm border text-base min-h-[44px] flex items-start transition-colors focus:outline-none focus:ring-2 ${a?"bg-gray-100 cursor-not-allowed border-gray-200":x?"cursor-pointer bg-red-50 border-red-300 hover:bg-red-100 hover:border-red-400 focus:ring-red-500 focus:border-red-500":"cursor-pointer hover:bg-blue-50 border-transparent hover:border-blue-200 bg-white focus:ring-blue-500 focus:border-blue-500"}`,title:a?"Not editable":"Click to edit",role:"button","aria-label":`Click to edit ${e}`,children:i.jsx("span",{className:t?"text-gray-900":x?"text-red-600 font-medium":"text-gray-500",children:o?i.jsx("div",{className:"whitespace-pre-wrap",children:b||(g?m:"")}):b||(g?m:"")})})]})},JO=({property:e,onFieldUpdate:t,onGetCurrentLocation:r})=>{var N,_,C,j,k;const[n,s]=p.useState(!1),[a,o]=p.useState("idle"),[l,c]=p.useState(!1),[d,u]=p.useState(!1),[m,f]=p.useState(!1),h=()=>{const S=e.verified_latitude&&e.verified_longitude,D=e.latitude&&e.longitude;return S?{lat:e.verified_latitude,lng:e.verified_longitude,source:"verified"}:D?{lat:e.latitude,lng:e.longitude,source:"regular"}:null},y=()=>{const S=h();return S?`https://www.google.com/maps?q=${S.lat},${S.lng}`:null},w=async()=>{const S=y();if(S)try{await navigator.clipboard.writeText(S),o("copied"),setTimeout(()=>o("idle"),2e3)}catch(D){console.error("Failed to copy to clipboard:",D),window.open(S,"_blank")}},b=async()=>{if(r)try{s(!0);const S=await r();t("latitude",S.lat),t("longitude",S.lng)}catch(S){console.error("Error getting current location:",S)}finally{s(!1)}},g=()=>{c(!0),setTimeout(()=>c(!1),3e3)},x=()=>{u(!0),setTimeout(()=>u(!1),3e3)},v=()=>{f(!0),setTimeout(()=>f(!1),4e3)};return i.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6 mb-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Location"})]}),r&&i.jsxs("button",{onClick:b,disabled:n,className:"flex items-center gap-2 px-3 py-1.5 bg-blue-50 text-blue-700 rounded-md hover:bg-blue-100 transition-colors text-sm disabled:opacity-50",children:[n?i.jsx("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}):i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})}),"Use Current Location"]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6",children:[i.jsx("div",{className:"sm:col-span-2",children:i.jsx(Ne,{label:"Street Address*",value:e.address,onChange:S=>t("address",S),placeholder:"123 Main Street",tabIndex:1})}),i.jsx(cs,{label:"City*",value:e.city,onChange:S=>t("city",S),field:"city",placeholder:"San Francisco",tabIndex:2}),i.jsx(cs,{label:"State*",value:e.state,onChange:S=>t("state",S),field:"state",placeholder:"CA",tabIndex:3}),i.jsxs("div",{className:"relative",children:[i.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[i.jsx("span",{className:"block text-sm font-medium text-gray-700",children:"ZIP Code"}),i.jsx("button",{type:"button",onClick:g,className:"text-gray-400 hover:text-gray-600 transition-colors",title:"Click for more info",children:i.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),i.jsx(Ne,{label:"",value:e.zip,onChange:S=>t("zip",S),placeholder:"94105",tabIndex:4}),l&&i.jsx("div",{className:"absolute top-full left-0 mt-1 w-64 z-10",children:i.jsxs("div",{className:"bg-gray-900 text-white text-xs rounded-lg p-3 shadow-lg relative",children:[i.jsx("div",{className:"absolute bottom-full left-4 w-0 h-0 border-l-4 border-r-4 border-b-4 border-l-transparent border-r-transparent border-b-gray-900"}),i.jsx("div",{className:"font-medium text-blue-200 mb-1",children:" Future Auto-Fill"}),i.jsx("p",{children:"Will auto-populate in the future from Google geocoding services."}),i.jsx("button",{onClick:()=>c(!1),className:"absolute top-1 right-1 text-gray-400 hover:text-white w-4 h-4 flex items-center justify-center",children:""})]})})]}),i.jsxs("div",{className:"relative",children:[i.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[i.jsx("span",{className:"block text-sm font-medium text-gray-700",children:"County"}),i.jsx("button",{type:"button",onClick:x,className:"text-gray-400 hover:text-gray-600 transition-colors",title:"Click for more info",children:i.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),i.jsx(cs,{label:"",value:e.county,onChange:S=>t("county",S),field:"county",placeholder:"San Francisco County",tabIndex:5}),d&&i.jsx("div",{className:"absolute top-full left-0 mt-1 w-64 z-10",children:i.jsxs("div",{className:"bg-gray-900 text-white text-xs rounded-lg p-3 shadow-lg relative",children:[i.jsx("div",{className:"absolute bottom-full left-4 w-0 h-0 border-l-4 border-r-4 border-b-4 border-l-transparent border-r-transparent border-b-gray-900"}),i.jsx("div",{className:"font-medium text-blue-200 mb-1",children:" Future Auto-Fill"}),i.jsx("p",{children:"Will auto-populate in the future from Google geocoding services."}),i.jsx("button",{onClick:()=>u(!1),className:"absolute top-1 right-1 text-gray-400 hover:text-white w-4 h-4 flex items-center justify-center",children:""})]})})]})]}),i.jsxs("div",{className:"border-t border-gray-200 pt-4 mb-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"GPS Coordinates"}),i.jsxs("div",{className:"relative",children:[i.jsxs("button",{type:"button",onClick:v,className:"flex items-center gap-2 px-3 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 text-sm rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-gray-500",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),"Verify Location"]}),m&&i.jsx("div",{className:"absolute bottom-full right-0 mb-2 w-64 z-10",children:i.jsxs("div",{className:"bg-gray-900 text-white text-xs rounded-lg p-3 shadow-lg relative",children:[i.jsx("div",{className:"absolute top-full right-4 w-0 h-0 border-l-4 border-r-4 border-t-4 border-l-transparent border-r-transparent border-t-gray-900"}),i.jsx("div",{className:"font-medium text-yellow-200 mb-1",children:" Future Feature"}),i.jsx("p",{children:"This will take you to a map where you can move the pin to the correct location and recode the address coordinates."}),i.jsx("button",{onClick:()=>f(!1),className:"absolute top-1 right-1 text-gray-400 hover:text-white w-4 h-4 flex items-center justify-center",children:""})]})})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(Ne,{label:"Latitude",value:e.latitude,onChange:S=>t("latitude",S),type:"number",placeholder:"37.7749",inputMode:"decimal",tabIndex:6}),i.jsx(Ne,{label:"Longitude",value:e.longitude,onChange:S=>t("longitude",S),type:"number",placeholder:"-122.4194",inputMode:"decimal",tabIndex:7}),i.jsx(Ne,{label:"Verified Latitude",value:e.verified_latitude,onChange:S=>t("verified_latitude",S),type:"number",placeholder:"37.7749",inputMode:"decimal",tabIndex:8}),i.jsx(Ne,{label:"Verified Longitude",value:e.verified_longitude,onChange:S=>t("verified_longitude",S),type:"number",placeholder:"-122.4194",inputMode:"decimal",tabIndex:9})]})]}),h()&&i.jsx("div",{className:"border-t border-gray-200 pt-4",children:i.jsxs("div",{className:"bg-gray-100 rounded-md p-6 text-center",children:[i.jsx("svg",{className:"w-12 h-12 text-gray-400 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),i.jsx("p",{className:"text-sm text-gray-600",children:"Map Preview"}),i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[(_=(N=h())==null?void 0:N.lat)==null?void 0:_.toFixed(6),", ",(j=(C=h())==null?void 0:C.lng)==null?void 0:j.toFixed(6),((k=h())==null?void 0:k.source)==="verified"&&i.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800",children:"Verified"})]}),i.jsxs("div",{className:"mt-3 flex gap-2 justify-center",children:[i.jsxs("button",{className:"flex items-center gap-1 px-3 py-1.5 text-xs text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-md transition-colors",onClick:()=>{const S=y();S&&window.open(S,"_blank")},children:[i.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),"Open in Maps"]}),i.jsx("button",{className:"flex items-center gap-1 px-3 py-1.5 text-xs text-gray-600 hover:text-gray-800 hover:bg-gray-50 rounded-md transition-colors",onClick:w,children:a==="copied"?i.jsxs(i.Fragment,{children:[i.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Copied!"]}):i.jsxs(i.Fragment,{children:[i.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copy Link"]})})]})]})})]})},pn=({label:e,value:t,onChange:r,placeholder:n="0",disabled:s=!1,tabIndex:a,helpText:o,showLarge:l=!1,colorScheme:c="gray"})=>{const[d,u]=p.useState(!1),[m,f]=p.useState(""),[h,y]=p.useState(!1),w=j=>j==null?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(j),b=t!=null?w(t):"Not set",g={green:"text-green-700",blue:"text-blue-700",purple:"text-purple-700",gray:"text-gray-900",orange:"text-orange-700"},x=j=>{s||h||(console.log(`[${e}] Starting edit, current value:`,t,"initialValue:",j),u(!0),y(!1),f(j!==void 0?j:(t==null?void 0:t.toString())||""))},v=()=>{s||x()},N=()=>{if(h)return;y(!0);const j=parseFloat(m.replace(/[^0-9.-]/g,""))||null;console.log(`[${e}] Saving value:`,m,"",j),r(j),u(!1),f(""),setTimeout(()=>y(!1),100)},_=()=>{u(!1),f("")},C=j=>{j.key==="Enter"?(j.preventDefault(),j.stopPropagation(),N()):j.key==="Escape"&&(j.preventDefault(),j.stopPropagation(),_())};return d?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),i.jsx("input",{type:"text",inputMode:"decimal",value:m,onChange:j=>f(j.target.value),onBlur:j=>{setTimeout(()=>{d&&!h&&N()},50)},onKeyDown:C,onFocus:j=>{setTimeout(()=>j.target.select(),0)},placeholder:n,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base min-h-[44px]",tabIndex:a,autoFocus:!0}),o&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:o})]}):i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),i.jsx("div",{onClick:()=>x(),onKeyDown:j=>{j.key==="Enter"||j.key===" "?(j.preventDefault(),x()):j.key.length===1&&!j.ctrlKey&&!j.metaKey&&!j.altKey&&(j.preventDefault(),x(j.key))},onFocus:v,tabIndex:a||0,className:`mt-1 px-3 py-2 rounded-md shadow-sm border ${l?"min-h-[48px]":"min-h-[44px]"} flex items-center transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${s?"bg-gray-100 cursor-not-allowed border-gray-200":"cursor-pointer hover:bg-blue-50 border-transparent hover:border-blue-200 bg-white"}`,title:s?"Not editable":"Click to edit",role:"button","aria-label":`Click to edit ${e}`,children:i.jsx("span",{className:`${t!==null?g[c]:"text-gray-500"} ${l?"text-lg font-semibold":"font-medium"}`,children:b})}),o&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:o})]})},_c=({label:e,value:t,onChange:r,placeholder:n="0.00",disabled:s=!1,tabIndex:a,helpText:o})=>{const[l,c]=p.useState(!1),[d,u]=p.useState(""),m=x=>x==null?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(x),f=t!=null?`${m(t)} / SF`:"Not set",h=x=>{s||(c(!0),u(x!==void 0?x:(t==null?void 0:t.toString())||""))},y=()=>{s||h()},w=()=>{const x=parseFloat(d.replace(/[^0-9.-]/g,""))||null;r(x),c(!1)},b=()=>{c(!1),u("")},g=x=>{x.key==="Enter"?(x.preventDefault(),x.stopPropagation(),w()):x.key==="Escape"&&(x.preventDefault(),x.stopPropagation(),b())};return l?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),i.jsx("input",{type:"text",inputMode:"decimal",value:d,onChange:x=>u(x.target.value),onBlur:w,onKeyDown:g,onFocus:x=>{setTimeout(()=>x.target.select(),0)},placeholder:n,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base min-h-[44px]",tabIndex:a,autoFocus:!0}),o&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:o})]}):i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),i.jsx("div",{onClick:()=>h(),onKeyDown:x=>{x.key==="Enter"||x.key===" "?(x.preventDefault(),h()):x.key.length===1&&!x.ctrlKey&&!x.metaKey&&!x.altKey&&(x.preventDefault(),h(x.key))},onFocus:y,tabIndex:a||0,className:`mt-1 px-3 py-2 rounded-md shadow-sm border text-base min-h-[44px] flex items-center transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${s?"bg-gray-100 cursor-not-allowed border-gray-200":"cursor-pointer hover:bg-blue-50 border-transparent hover:border-blue-200 bg-white"}`,title:s?"Not editable":"Click to edit",role:"button","aria-label":`Click to edit ${e}`,children:i.jsx("span",{className:`${t!==null?"text-gray-900":"text-gray-500"} font-medium`,children:f})}),o&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:o})]})},XO=({property:e,onFieldUpdate:t})=>{var c,d;const r=((d=(c=e.property_record_type)==null?void 0:c.label)==null?void 0:d.toLowerCase())||"",n=r.includes("land"),s=r.includes("shopping")||r.includes("retail"),a=!n&&!s,o=!n,l=!n;return i.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6 mb-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Financial Information"})]}),a&&i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6",children:i.jsx(pn,{label:"Asking Lease Price",value:e.asking_lease_price,onChange:u=>t("asking_lease_price",u),helpText:"Annual lease amount",showLarge:!0,colorScheme:"green",tabIndex:10})}),o&&i.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Per Square Foot Rates"}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i.jsx(_c,{label:"Rent PSF",value:e.rent_psf,onChange:u=>t("rent_psf",u),helpText:"Base rent per square foot",tabIndex:12}),i.jsx(_c,{label:"NNN PSF",value:e.nnn_psf,onChange:u=>t("nnn_psf",u),helpText:"Triple net charges per square foot",tabIndex:13})]}),e.rent_psf&&e.nnn_psf&&e.available_sqft&&i.jsxs("div",{className:"mt-4 p-3 bg-blue-50 rounded-md",children:[i.jsx("div",{className:"text-sm font-medium text-blue-900 mb-1",children:"All-In Rent Calculation"}),i.jsxs("div",{className:"text-lg font-bold text-blue-700",children:["$",(e.rent_psf+e.nnn_psf).toFixed(2)," / SF"]}),i.jsxs("div",{className:"text-sm text-blue-600",children:["Total annual: $",((e.rent_psf+e.nnn_psf)*e.available_sqft).toLocaleString()]})]})]}),l&&i.jsxs("div",{className:"border-t border-gray-200 pt-4 mt-4",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Square Footage"}),s?i.jsx("div",{className:"grid grid-cols-1 gap-4",children:i.jsx(Ne,{label:"Available Sqft",value:e.available_sqft,onChange:u=>t("available_sqft",u),type:"number",placeholder:"0",tabIndex:14})}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i.jsx(Ne,{label:"Building Size",value:e.building_sqft,onChange:u=>t("building_sqft",u),type:"number",placeholder:"0",tabIndex:14}),i.jsx(Ne,{label:"Available Size",value:e.available_sqft,onChange:u=>t("available_sqft",u),type:"number",placeholder:"0",tabIndex:15})]}),e.building_sqft&&e.available_sqft&&i.jsx("div",{className:"mt-3 p-2 bg-gray-50 rounded-md",children:i.jsxs("div",{className:"text-sm text-gray-600",children:["Occupancy: ",((e.building_sqft-e.available_sqft)/e.building_sqft*100).toFixed(1),"% (",(e.building_sqft-e.available_sqft).toLocaleString()," SF occupied)"]})})]})]}),n&&i.jsxs("div",{className:"border-t border-gray-200 pt-4 mt-4",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Land Information"}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[i.jsx(pn,{label:"Asking Purchase Price",value:e.asking_purchase_price,onChange:u=>t("asking_purchase_price",u),showLarge:!0,colorScheme:"blue",tabIndex:16}),i.jsx(pn,{label:"Asking Ground Lease Price",value:e.asking_lease_price,onChange:u=>t("asking_lease_price",u),showLarge:!0,colorScheme:"green",tabIndex:17})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[i.jsx(Ne,{label:"NNN",value:e.nnn_psf,onChange:u=>t("nnn_psf",u),type:"number",placeholder:"0",tabIndex:18}),i.jsx(Ne,{label:"Acres",value:e.acres,onChange:u=>t("acres",u),type:"number",placeholder:"0",tabIndex:19})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i.jsx(Ne,{label:"Building Sqft",value:e.building_sqft,onChange:u=>t("building_sqft",u),type:"number",placeholder:"0",tabIndex:20}),i.jsx(Ne,{label:"Lease Expiration Date",value:e.lease_expiration_date,onChange:u=>t("lease_expiration_date",u),type:"text",placeholder:"MM/DD/YYYY",tabIndex:21})]})]})]})},N_=({label:e,value:t,onChange:r,options:n,placeholder:s="Select...",disabled:a=!1,tabIndex:o,required:l=!1,defaultText:c="Not set"})=>{const[d,u]=p.useState(!1),m=n.find(v=>v.id===t),f=(m==null?void 0:m.label)||c,y=l&&!t,w=()=>{a||u(!0)},b=v=>{r(v||null),u(!1)},g=()=>{u(!1)},x=v=>{v.key==="Escape"&&(v.preventDefault(),v.stopPropagation(),g())};return d?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),i.jsxs("select",{value:t||"",onChange:v=>b(v.target.value),onBlur:g,onKeyDown:x,className:`w-full px-3 py-2 rounded-md shadow-sm text-base min-h-[44px] ${y?"border-red-300 bg-red-50 focus:ring-red-500 focus:border-red-500":"border-gray-300 bg-white focus:ring-blue-500 focus:border-blue-500"}`,tabIndex:o,autoFocus:!0,children:[i.jsx("option",{value:"",children:s}),n.map(v=>i.jsx("option",{value:v.id,children:v.label},v.id))]})]}):i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:e}),i.jsx("div",{onClick:w,onKeyDown:v=>{(v.key==="Enter"||v.key===" ")&&(v.preventDefault(),w())},onFocus:w,tabIndex:o||0,className:`mt-1 px-3 py-2 rounded-md shadow-sm border text-base min-h-[44px] flex items-center transition-colors focus:outline-none focus:ring-2 ${a?"bg-gray-100 cursor-not-allowed border-gray-200":y?"cursor-pointer bg-red-50 border-red-300 hover:bg-red-100 hover:border-red-400 focus:ring-red-500 focus:border-red-500":"cursor-pointer hover:bg-blue-50 border-transparent hover:border-blue-200 bg-white focus:ring-blue-500 focus:border-blue-500"}`,title:a?"Not editable":"Click to edit",role:"button","aria-label":`Click to edit ${e}`,children:i.jsx("span",{className:t?"text-gray-900":y?"text-red-600 font-medium":"text-gray-500",children:f})})]})},ZO=async e=>{try{const{data:t,error:r}=await M.from("property").select("sf_id").eq("id",e).single();if(r||!(t!=null&&t.sf_id))return console.log("No sf_id found for property:",r==null?void 0:r.message),null;const{data:n,error:s}=await M.from("salesforce_Property__c").select("RecordTypeId").eq("Id",t.sf_id).single();return s?(console.log("RecordTypeId field not found:",s.message),null):(n==null?void 0:n.RecordTypeId)||null}catch(t){return console.log("Error checking for legacy record type:",t),null}},eA=({property:e,isEditing:t,onFieldUpdate:r,propertyRecordTypes:n=[]})=>{const[s,a]=p.useState(!0),[o,l]=p.useState(null);return p.useEffect(()=>{(async()=>{if(e.id&&!e.property_record_type_id){const d=await ZO(e.id);console.log(" Legacy RecordTypeId found:",d),l(d)}})()},[e.id,e.property_record_type_id]),i.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6 mb-4",children:[i.jsxs("button",{onClick:()=>a(!s),className:"w-full flex items-center justify-between text-left",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Property Details"})]}),i.jsx("svg",{className:`w-5 h-5 text-gray-400 transform transition-transform ${s?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),s&&i.jsxs("div",{className:"mt-4 space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[i.jsxs("div",{children:[i.jsx(N_,{label:"Property Record Type",value:e.property_record_type_id,onChange:c=>r("property_record_type_id",c),options:n.map(c=>({id:c.id,label:c.label})),placeholder:n.length===0?"No record types available":"Select record type...",disabled:n.length===0,tabIndex:20}),o&&!e.property_record_type_id&&i.jsxs("div",{className:"mt-1 text-sm text-blue-600 bg-blue-50 px-2 py-1 rounded border border-blue-200",children:["Salesforce RecordTypeId: ",o]})]}),i.jsx(Ne,{label:"Property Name",value:e.property_name,onChange:c=>r("property_name",c),placeholder:"Property name or identifier",tabIndex:21})]}),i.jsx(Ne,{label:"Property Description",value:e.description,onChange:c=>r("description",c),placeholder:"Brief description of the property...",multiline:!0,rows:3}),i.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Location Details"}),i.jsx(cs,{label:"Trade Area",value:e.trade_area,onChange:c=>r("trade_area",c),field:"trade_area",placeholder:"Downtown, Suburb, etc."})]})]})]})},tA=({property:e,onFieldUpdate:t})=>{const[r,n]=p.useState(!1);return i.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6 mb-4",children:[i.jsxs("button",{onClick:()=>n(!r),className:"w-full flex items-center justify-between text-left",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Market Analysis"})]}),i.jsx("svg",{className:`w-5 h-5 text-gray-400 transform transition-transform ${r?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),r&&i.jsxs("div",{className:"mt-4 space-y-6",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Traffic Data"}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx(Ne,{label:"Traffic Count",value:e.traffic_count,onChange:s=>t("traffic_count",s),type:"number",inputMode:"numeric",placeholder:"0"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Daily vehicle count"})]}),i.jsxs("div",{children:[i.jsx(Ne,{label:"Secondary Traffic Count",value:e.traffic_count_2nd,onChange:s=>t("traffic_count_2nd",s),type:"number",inputMode:"numeric",placeholder:"0"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Secondary road/access point"})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Total Traffic"}),i.jsx("div",{className:"w-full px-3 py-2 bg-gray-50 border border-gray-200 rounded-md text-base min-h-[44px] flex items-center",children:i.jsx("span",{className:"text-gray-900 font-medium",children:((e.traffic_count||0)+(e.traffic_count_2nd||0)).toLocaleString()})})]}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Calculated total (vehicles/day)"})]})]})]}),i.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Demographics"}),i.jsxs("div",{className:"space-y-4",children:[i.jsx(Ne,{label:"Demographic Information",value:e.demographics,onChange:s=>t("demographics",s),placeholder:"Population, income levels, age groups, household composition, etc.",multiline:!0,rows:4}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[i.jsx(Ne,{label:"1 Mile Population",value:e["1_mile_pop"],onChange:s=>t("1_mile_pop",s),type:"number",inputMode:"numeric",placeholder:"Enter population count"}),i.jsx(Ne,{label:"HH Income - Median 3 Mile",value:e.hh_income_median_3_mile,onChange:s=>t("hh_income_median_3_mile",s),type:"number",inputMode:"numeric",placeholder:"Enter median income"}),i.jsx(Ne,{label:"3 Mile Population",value:e["3_mile_pop"],onChange:s=>t("3_mile_pop",s),type:"number",inputMode:"numeric",placeholder:"Enter population count"})]})]})]})]})]})},rA=({property:e,isEditing:t,onFieldUpdate:r})=>{const n=[{key:"costar_link",label:"CoStar",description:"Commercial real estate database",icon:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),color:"blue"},{key:"reonomy_link",label:"Reonomy",description:"Property intelligence platform",icon:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),color:"purple"},{key:"tax_url",label:"Tax Records",description:"Property tax information",icon:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),color:"green"},{key:"map_link",label:"Map View",description:"Interactive map link",icon:i.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),color:"orange"}],s=(o,l)=>{const c={blue:l?"bg-blue-600 hover:bg-blue-700 text-white border-blue-600":"bg-blue-50 text-blue-600 border-blue-200 hover:bg-blue-100",purple:l?"bg-purple-600 hover:bg-purple-700 text-white border-purple-600":"bg-purple-50 text-purple-600 border-purple-200 hover:bg-purple-100",green:l?"bg-green-600 hover:bg-green-700 text-white border-green-600":"bg-green-50 text-green-600 border-green-200 hover:bg-green-100",orange:l?"bg-orange-600 hover:bg-orange-700 text-white border-orange-600":"bg-orange-50 text-orange-600 border-orange-200 hover:bg-orange-100"};return c[o]||c.blue},a=o=>{try{return new URL(o),!0}catch{return!1}};return i.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6 mb-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"External Links"})]}),t?i.jsx("div",{className:"space-y-4",children:n.map(o=>i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:o.label}),i.jsx("input",{type:"url",value:e[o.key]||"",onChange:l=>r(o.key,l.target.value),placeholder:`https://example.com/${o.label.toLowerCase()}-link`,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base min-h-[44px]"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:o.description})]},o.key))}):i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:n.map(o=>{const l=e[o.key],c=l&&l.trim()!=="",d=c&&a(l);return i.jsx("button",{onClick:()=>{c&&d&&window.open(l,"_blank","noopener,noreferrer")},disabled:!c||!d,className:`w-full p-3 border rounded-lg text-left transition-colors disabled:opacity-50 disabled:cursor-not-allowed ${s(o.color,c&&d)}`,children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"flex-shrink-0",children:o.icon}),i.jsxs("div",{className:"flex-grow min-w-0",children:[i.jsx("div",{className:"font-medium text-sm",children:o.label}),i.jsx("div",{className:`text-xs opacity-75 truncate ${c&&d?"text-current":"text-gray-500"}`,children:c?d?"Click to open":"Invalid URL":o.description})]}),c&&d&&i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})})]})},o.key)})}),t&&i.jsxs("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[i.jsx("div",{className:"text-sm font-medium text-blue-900 mb-2",children:"Quick Actions"}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx("button",{onClick:()=>{if(e.latitude&&e.longitude){const o=`https://www.google.com/maps?q=${e.latitude},${e.longitude}`;r("map_link",o)}},disabled:!e.latitude||!e.longitude,className:"px-3 py-1.5 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:"Generate Map Link"}),i.jsx("button",{onClick:()=>{if(e.address&&e.city&&e.state){const l=`https://www.costar.com/search?q=${encodeURIComponent(`${e.address} ${e.city} ${e.state}`)}`;r("costar_link",l)}},disabled:!e.address||!e.city||!e.state,className:"px-3 py-1.5 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:"Generate CoStar Search"})]}),i.jsx("p",{className:"text-xs text-blue-700 mt-2",children:"Quick generation requires property address and coordinates to be set."})]})]})},nA=({property:e,isEditing:t,onFieldUpdate:r})=>{const[n,s]=p.useState(e.property_notes||""),[a,o]=p.useState(null),[l,c]=p.useState(!1),d=p.useRef(null),u=p.useRef(),m=()=>{d.current&&(d.current.style.height="auto",d.current.style.height=d.current.scrollHeight+"px")};p.useEffect(()=>{m()},[n,t]);const f=y=>{s(y),t&&(u.current&&clearTimeout(u.current),u.current=setTimeout(async()=>{try{c(!0),await r("property_notes",y),o(new Date)}catch(w){console.error("Auto-save failed:",w)}finally{c(!1)}},1e3))};p.useEffect(()=>()=>{u.current&&clearTimeout(u.current)},[]);const h=y=>{const b=new Date().getTime()-y.getTime(),g=Math.floor(b/6e4);return g<1?"just now":g===1?"1 minute ago":g<60?`${g} minutes ago`:y.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})};return i.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Property Notes"})]}),t&&i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[l&&i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),i.jsx("span",{children:"Saving..."})]}),!l&&a&&i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("svg",{className:"w-4 h-4 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),i.jsxs("span",{children:["Saved ",h(a)]})]})]})]}),t?i.jsxs("div",{className:"space-y-3",children:[i.jsx("textarea",{ref:d,value:n,onChange:y=>f(y.target.value),placeholder:"Add notes about this property, market conditions, tenant information, lease details, or any other relevant information...",className:"w-full px-3 py-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base resize-none overflow-hidden min-h-[120px]",style:{maxHeight:"400px"}}),i.jsxs("div",{className:"flex justify-between items-center text-xs text-gray-500",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("span",{children:[n.length," characters"]}),i.jsxs("div",{className:"hidden sm:flex items-center gap-2",children:[i.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-100 border rounded text-xs",children:"Cmd+S"}),i.jsx("span",{children:"to save manually"})]})]}),i.jsx("div",{className:"text-right",children:"Auto-saves after 1 second"})]}),i.jsxs("div",{className:"border-t border-gray-200 pt-3",children:[i.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Quick Templates"}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx("button",{onClick:()=>{const y=`Property visit completed on [DATE]
- Condition: 
- Tenant activity: 
- Market comparison: 
- Next steps: `;f(n+(n?`

`:"")+y)},className:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs hover:bg-gray-200",children:"Site Visit"}),i.jsx("button",{onClick:()=>{const y=`Market analysis as of [DATE]
- Comparable properties: 
- Pricing trends: 
- Occupancy rates: 
- Notable developments: `;f(n+(n?`

`:"")+y)},className:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs hover:bg-gray-200",children:"Market Update"}),i.jsx("button",{onClick:()=>{const y=`Contact follow-up [DATE]
- Person contacted: 
- Response: 
- Action items: 
- Next contact date: `;f(n+(n?`

`:"")+y)},className:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs hover:bg-gray-200",children:"Follow-up"})]})]})]}):i.jsx("div",{children:n?i.jsx("div",{className:"prose prose-sm max-w-none",children:i.jsx("div",{className:"whitespace-pre-wrap text-gray-700 leading-relaxed",children:n})}):i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx("svg",{className:"w-12 h-12 mx-auto mb-3 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),i.jsx("p",{className:"text-sm",children:"No notes added yet"}),i.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Click Edit to add property notes"})]})}),t&&i.jsx("div",{className:"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded-md",children:i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsxs("svg",{className:"w-5 h-5 text-yellow-600 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 18.5a5.5 5.5 0 100-11 5.5 5.5 0 000 11z"}),i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 2a10 10 0 100 20 10 10 0 000-20z"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-medium text-yellow-800",children:"Voice-to-Text Coming Soon"}),i.jsx("div",{className:"text-xs text-yellow-700 mt-1",children:"Future enhancement will allow voice dictation for faster note-taking during property visits."})]})]})})]})},k_=({isOpen:e,onClose:t,onSave:r,onUpdate:n,siteSubmitId:s,propertyId:a,assignmentId:o,propertyUnitId:l})=>{const[c,d]=p.useState({site_submit_name:"",client_id:null,property_id:a||null,property_unit_id:l||null,assignment_id:null,submit_stage_id:null,date_submitted:new Date().toISOString().split("T")[0],loi_written:!1,loi_date:"",delivery_date:"",delivery_timeframe:"",notes:"",customer_comments:"",competitor_data:"",record_type_id:null,verified_latitude:null,verified_longitude:null,year_1_rent:null,ti:null}),[u,m]=p.useState([]),[f,h]=p.useState([]),[y,w]=p.useState(!1),[b,g]=p.useState(!1),[x,v]=p.useState({}),[N,_]=p.useState(""),[C,j]=p.useState(!1);p.useEffect(()=>{e&&(async()=>{var A,I,L;w(!0);try{const[F,U]=await Promise.all([M.from("client").select("*").order("client_name"),M.from("submit_stage").select("*").order("name")]);if(F.data&&m(F.data),U.data&&h(U.data),a){const{data:E}=await M.from("property").select("property_name").eq("id",a).single();E!=null&&E.property_name&&_(E.property_name)}if(o&&!s){const{data:E}=await M.from("assignment").select("client_id, deal_id").eq("id",o).single();E&&d($=>({...$,client_id:E.client_id,assignment_id:o}))}if(s){const{data:E,error:$}=await M.from("site_submit").select("*").eq("id",s).single();$?console.error("Error loading site submit:",$):E&&(d({site_submit_name:E.site_submit_name||"",client_id:E.client_id,property_id:E.property_id,property_unit_id:E.property_unit_id,assignment_id:E.assignment_id,submit_stage_id:E.submit_stage_id,date_submitted:((A=E.date_submitted)==null?void 0:A.split("T")[0])||new Date().toISOString().split("T")[0],loi_written:E.loi_written||!1,loi_date:((I=E.loi_date)==null?void 0:I.split("T")[0])||"",delivery_date:((L=E.delivery_date)==null?void 0:L.split("T")[0])||"",delivery_timeframe:E.delivery_timeframe||"",notes:E.notes||"",customer_comments:E.customer_comments||"",competitor_data:E.competitor_data||"",record_type_id:E.record_type_id,verified_latitude:E.verified_latitude,verified_longitude:E.verified_longitude,year_1_rent:E.year_1_rent,ti:E.ti}),j(!0))}}catch(F){console.error("Error loading form data:",F)}finally{w(!1)}})()},[e,s,o]),p.useEffect(()=>{e||(d({site_submit_name:"",client_id:null,property_id:a||null,property_unit_id:l||null,assignment_id:o||null,submit_stage_id:null,date_submitted:new Date().toISOString().split("T")[0],loi_written:!1,loi_date:"",delivery_date:"",delivery_timeframe:"",notes:"",customer_comments:"",competitor_data:"",record_type_id:null,verified_latitude:null,verified_longitude:null,year_1_rent:null,ti:null}),v({}),j(!1),_(""))},[e,a,l]);const k=(P,A)=>{if(!P||!A)return"";const I=u.find(L=>L.id===P);return I?`${I.client_name} - ${A}`:""},S=(P,A)=>{if(d(I=>({...I,[P]:A})),x[P]&&v(I=>({...I,[P]:""})),P==="client_id"&&!C&&N){const I=k(A,N);I&&d(L=>({...L,site_submit_name:I}))}P==="property_id"&&!C&&c.client_id&&A&&M.from("property").select("property_name").eq("id",A).single().then(({data:I})=>{if(I!=null&&I.property_name){_(I.property_name);const L=k(c.client_id,I.property_name);L&&d(F=>({...F,site_submit_name:L}))}}),P==="site_submit_name"&&j(!0)},D=()=>{var A;const P={};return(A=c.site_submit_name)!=null&&A.trim()||(P.site_submit_name="Site submit name is required"),c.client_id||(P.client_id="Client selection is required"),!c.property_id&&!o&&(P.property_id="Property selection is required"),v(P),Object.keys(P).length===0},R=async()=>{if(D()){g(!0);try{if(s){const P={...c,date_submitted:c.date_submitted||null,loi_date:c.loi_date||null,delivery_date:c.delivery_date||null,updated_at:new Date().toISOString()},{data:A,error:I}=await M.from("site_submit").update(P).eq("id",s).select(`
            *,
            submit_stage!site_submit_submit_stage_id_fkey (
              name
            ),
            client!client_id (
              client_name
            )
          `).single();if(I)throw I;n==null||n(A)}else{const P={...c,date_submitted:c.date_submitted||null,loi_date:c.loi_date||null,delivery_date:c.delivery_date||null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};console.log("About to insert site submit data:",P),console.log("Form validation passed. FormData:",c);const{data:A,error:I}=await M.from("site_submit").insert(P).select(`
            *,
            submit_stage!site_submit_submit_stage_id_fkey (
              name
            ),
            client!client_id (
              client_name
            )
          `).single();if(I)throw I;r==null||r(A)}t()}catch(P){console.error("Error saving site submit:",P),console.error("Full error object:",JSON.stringify(P,null,2)),P instanceof Error&&console.error("Error message:",P.message),console.log("Attempted to save data:",s?"UPDATE":"CREATE"),console.log("Form data:",c),alert(`Error saving site submit: ${P instanceof Error?P.message:"Unknown error"}. Please check the console for details.`)}finally{g(!1)}}};return e?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[60]",onClick:t}),i.jsxs("div",{className:`fixed inset-0 lg:inset-y-0 lg:right-0 lg:left-auto w-full lg:w-[700px] bg-white shadow-xl transform transition-transform duration-300 z-[60] ${e?"translate-x-0":"translate-x-full"} flex flex-col`,children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 bg-white",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:s?"Edit Site Submit":"New Site Submit"}),i.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:i.jsx("svg",{className:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:y?i.jsx("div",{className:"flex items-center justify-center h-32",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Basic Information"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Site Submit Name *"}),i.jsx("input",{type:"text",value:c.site_submit_name,onChange:P=>S("site_submit_name",P.target.value),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${x.site_submit_name?"border-red-300":""}`,placeholder:"Enter site submit name"}),x.site_submit_name&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:x.site_submit_name})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client *"}),i.jsxs("select",{value:c.client_id||"",onChange:P=>S("client_id",P.target.value||null),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${x.client_id?"border-red-300":""}`,children:[i.jsx("option",{value:"",children:"Select a client..."}),u.map(P=>i.jsx("option",{value:P.id,children:P.client_name},P.id))]}),x.client_id&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:x.client_id})]}),i.jsx(Gh,{value:c.property_id,onChange:P=>S("property_id",P),label:"Property *"}),x.property_id&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:x.property_id}),c.property_id&&i.jsx(qh,{propertyId:c.property_id,value:c.property_unit_id,onChange:P=>S("property_unit_id",P),label:"Property Unit (Optional)"})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Submission Details"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Submit Stage"}),i.jsxs("select",{value:c.submit_stage_id||"",onChange:P=>S("submit_stage_id",P.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",children:[i.jsx("option",{value:"",children:"Select stage..."}),f.map(P=>i.jsx("option",{value:P.id,children:P.name},P.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date Submitted"}),i.jsx("input",{type:"date",value:c.date_submitted,onChange:P=>S("date_submitted",P.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm"})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("input",{type:"checkbox",id:"loi_written",checked:c.loi_written,onChange:P=>S("loi_written",P.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),i.jsx("label",{htmlFor:"loi_written",className:"text-sm font-medium text-gray-700",children:"LOI Written"})]}),c.loi_written&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"LOI Date"}),i.jsx("input",{type:"date",value:c.loi_date,onChange:P=>S("loi_date",P.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Delivery Date"}),i.jsx("input",{type:"date",value:c.delivery_date,onChange:P=>S("delivery_date",P.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Delivery Timeframe"}),i.jsx("input",{type:"text",value:c.delivery_timeframe,onChange:P=>S("delivery_timeframe",P.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"e.g., 30-60 days, Q1 2024"})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Financial Information"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year 1 Rent ($)"}),i.jsx("input",{type:"number",step:"0.01",value:c.year_1_rent||"",onChange:P=>S("year_1_rent",P.target.value?parseFloat(P.target.value):null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"TI ($)"}),i.jsx("input",{type:"number",step:"0.01",value:c.ti||"",onChange:P=>S("ti",P.target.value?parseFloat(P.target.value):null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"0.00"})]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Location Verification"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Verified Latitude"}),i.jsx("input",{type:"number",step:"any",value:c.verified_latitude||"",onChange:P=>S("verified_latitude",P.target.value?parseFloat(P.target.value):null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"e.g., 40.7128"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Verified Longitude"}),i.jsx("input",{type:"number",step:"any",value:c.verified_longitude||"",onChange:P=>S("verified_longitude",P.target.value?parseFloat(P.target.value):null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"e.g., -74.0060"})]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Notes & Comments"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),i.jsx("textarea",{rows:3,value:c.notes,onChange:P=>S("notes",P.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"Internal notes..."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer Comments"}),i.jsx("textarea",{rows:3,value:c.customer_comments,onChange:P=>S("customer_comments",P.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"Customer feedback or requirements..."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Competitor Data"}),i.jsx("textarea",{rows:3,value:c.competitor_data,onChange:P=>S("competitor_data",P.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"Competitive landscape information..."})]})]})]})}),i.jsx("div",{className:"border-t border-gray-200 p-4 bg-gray-50",children:i.jsxs("div",{className:"flex justify-end space-x-3",children:[i.jsx("button",{type:"button",onClick:t,disabled:b,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:"Cancel"}),i.jsx("button",{type:"button",onClick:R,disabled:b||y,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:b?"Saving...":"Save Site Submit"})]})})]})]}):null},sA=({isOpen:e,onClose:t,onSave:r,onUpdate:n,contactId:s,propertyId:a})=>{const[o,l]=p.useState({first_name:"",last_name:"",email:null,phone:null,mobile_phone:null,title:null,company:null,client_id:null,source_type:"Contact",mailing_street:null,mailing_city:null,mailing_state:null,mailing_zip:null,mailing_country:null,website:null,linked_in_profile_link:null,icsc_profile_link:null,linked_in_connection:!1,is_site_selector:!1,tenant_repped:!1,tenant_rep_contact_id:null,contact_tags:null}),[c,d]=p.useState([]),[u,m]=p.useState([]),[f,h]=p.useState(!1),[y,w]=p.useState(!1),[b,g]=p.useState({}),x=["Contact","Lead"],v=["AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"];p.useEffect(()=>{e&&(async()=>{h(!0);try{const[k,S]=await Promise.all([M.from("client").select("*").order("client_name"),M.from("contact").select("id, first_name, last_name, company").order("last_name, first_name")]);if(k.data&&d(k.data),S.data&&m(S.data),s){const{data:D,error:R}=await M.from("contact").select("*").eq("id",s).single();R?console.error("Error loading contact:",R):D&&l({first_name:D.first_name||"",last_name:D.last_name||"",email:D.email,phone:D.phone,mobile_phone:D.mobile_phone,title:D.title,company:D.company,client_id:D.client_id,source_type:D.source_type,mailing_street:D.mailing_street,mailing_city:D.mailing_city,mailing_state:D.mailing_state,mailing_zip:D.mailing_zip,mailing_country:D.mailing_country,website:D.website,linked_in_profile_link:D.linked_in_profile_link,icsc_profile_link:D.icsc_profile_link,linked_in_connection:D.linked_in_connection||!1,is_site_selector:D.is_site_selector||!1,tenant_repped:D.tenant_repped||!1,tenant_rep_contact_id:D.tenant_rep_contact_id,contact_tags:D.contact_tags})}}catch(k){console.error("Error loading form data:",k)}finally{h(!1)}})()},[e,s]),p.useEffect(()=>{e||(l({first_name:"",last_name:"",email:null,phone:null,mobile_phone:null,title:null,company:null,client_id:null,source_type:"Contact",mailing_street:null,mailing_city:null,mailing_state:null,mailing_zip:null,mailing_country:null,website:null,linked_in_profile_link:null,icsc_profile_link:null,linked_in_connection:!1,is_site_selector:!1,tenant_repped:!1,tenant_rep_contact_id:null,contact_tags:null}),g({}))},[e]);const N=(j,k)=>{l(S=>({...S,[j]:k})),b[j]&&g(S=>({...S,[j]:""}))},_=()=>{var k,S,D;const j={};return(k=o.first_name)!=null&&k.trim()||(j.first_name="First name is required"),(S=o.last_name)!=null&&S.trim()||(j.last_name="Last name is required"),(D=o.source_type)!=null&&D.trim()||(j.source_type="Source type is required"),o.email&&!/\S+@\S+\.\S+/.test(o.email)&&(j.email="Please enter a valid email address"),g(j),Object.keys(j).length===0},C=async()=>{if(_()){w(!0);try{if(s){const j={...o,updated_at:new Date().toISOString()},{data:k,error:S}=await M.from("contact").update(j).eq("id",s).select().single();if(S)throw S;n==null||n(k)}else{const j={...o,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{data:k,error:S}=await M.from("contact").insert(j).select().single();if(S)throw S;a&&k&&await M.from("property_contact").insert({property_id:a,contact_id:k.id}),r==null||r(k)}t()}catch(j){console.error("Error saving contact:",j),alert(`Error saving contact: ${j instanceof Error?j.message:"Unknown error"}. Please check the console for details.`)}finally{w(!1)}}};return e?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[60]",onClick:t}),i.jsxs("div",{className:`fixed inset-0 lg:inset-y-0 lg:right-0 lg:left-auto w-full lg:w-[800px] bg-white shadow-xl transform transition-transform duration-300 z-[60] ${e?"translate-x-0":"translate-x-full"} flex flex-col`,children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 bg-white",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:s?"Edit Contact":"New Contact"}),i.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:i.jsx("svg",{className:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:f?i.jsx("div",{className:"flex items-center justify-center h-32",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Basic Information"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name *"}),i.jsx("input",{type:"text",value:o.first_name,onChange:j=>N("first_name",j.target.value),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${b.first_name?"border-red-300":""}`,placeholder:"Enter first name"}),b.first_name&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:b.first_name})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name *"}),i.jsx("input",{type:"text",value:o.last_name,onChange:j=>N("last_name",j.target.value),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${b.last_name?"border-red-300":""}`,placeholder:"Enter last name"}),b.last_name&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:b.last_name})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),i.jsx("input",{type:"text",value:o.title||"",onChange:j=>N("title",j.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"Job title"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company"}),i.jsx("input",{type:"text",value:o.company||"",onChange:j=>N("company",j.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"Company name"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client"}),i.jsxs("select",{value:o.client_id||"",onChange:j=>N("client_id",j.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",children:[i.jsx("option",{value:"",children:"Select a client..."}),c.map(j=>i.jsx("option",{value:j.id,children:j.client_name},j.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Source Type *"}),i.jsxs("select",{value:o.source_type,onChange:j=>N("source_type",j.target.value),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${b.source_type?"border-red-300":""}`,children:[i.jsx("option",{value:"",children:"Select source..."}),x.map(j=>i.jsx("option",{value:j,children:j},j))]}),b.source_type&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:b.source_type})]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Contact Information"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),i.jsx("input",{type:"email",value:o.email||"",onChange:j=>N("email",j.target.value||null),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${b.email?"border-red-300":""}`,placeholder:"Enter email address"}),b.email&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:b.email})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),i.jsx("input",{type:"tel",value:o.phone||"",onChange:j=>N("phone",j.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"(555) 123-4567"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mobile Phone"}),i.jsx("input",{type:"tel",value:o.mobile_phone||"",onChange:j=>N("mobile_phone",j.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"(555) 123-4567"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Website"}),i.jsx("input",{type:"url",value:o.website||"",onChange:j=>N("website",j.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"https://example.com"})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Mailing Address"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Street Address"}),i.jsx("input",{type:"text",value:o.mailing_street||"",onChange:j=>N("mailing_street",j.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"123 Main St"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City"}),i.jsx("input",{type:"text",value:o.mailing_city||"",onChange:j=>N("mailing_city",j.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"City"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"State"}),i.jsxs("select",{value:o.mailing_state||"",onChange:j=>N("mailing_state",j.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",children:[i.jsx("option",{value:"",children:"Select state..."}),v.map(j=>i.jsx("option",{value:j,children:j},j))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ZIP Code"}),i.jsx("input",{type:"text",value:o.mailing_zip||"",onChange:j=>N("mailing_zip",j.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"12345"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Country"}),i.jsx("input",{type:"text",value:o.mailing_country||"",onChange:j=>N("mailing_country",j.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"United States"})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Professional Information"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"LinkedIn Profile"}),i.jsx("input",{type:"url",value:o.linked_in_profile_link||"",onChange:j=>N("linked_in_profile_link",j.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"https://linkedin.com/in/profile"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ICSC Profile Link"}),i.jsx("input",{type:"url",value:o.icsc_profile_link||"",onChange:j=>N("icsc_profile_link",j.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"https://icsc.com/profile"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tenant Rep Contact"}),i.jsxs("select",{value:o.tenant_rep_contact_id||"",onChange:j=>N("tenant_rep_contact_id",j.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",children:[i.jsx("option",{value:"",children:"Select contact..."}),u.map(j=>i.jsxs("option",{value:j.id,children:[j.first_name," ",j.last_name," ",j.company&&`(${j.company})`]},j.id))]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Professional Attributes"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("input",{type:"checkbox",id:"linked_in_connection",checked:o.linked_in_connection,onChange:j=>N("linked_in_connection",j.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),i.jsx("label",{htmlFor:"linked_in_connection",className:"text-sm text-gray-700",children:"LinkedIn Connection"})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("input",{type:"checkbox",id:"is_site_selector",checked:o.is_site_selector,onChange:j=>N("is_site_selector",j.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),i.jsx("label",{htmlFor:"is_site_selector",className:"text-sm text-gray-700",children:"Site Selector"})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("input",{type:"checkbox",id:"tenant_repped",checked:o.tenant_repped,onChange:j=>N("tenant_repped",j.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),i.jsx("label",{htmlFor:"tenant_repped",className:"text-sm text-gray-700",children:"Tenant Repped"})]})]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Tags & Tracking"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Tags"}),i.jsx("textarea",{rows:2,value:o.contact_tags||"",onChange:j=>N("contact_tags",j.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"Tags separated by commas (e.g., VIP, Decision Maker, Cold Lead)"})]}),s&&i.jsxs("div",{className:"bg-gray-50 p-3 rounded-md",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Record Information"}),i.jsxs("div",{className:"text-xs text-gray-500 space-y-1",children:[i.jsx("p",{children:"Created: "}),i.jsx("p",{children:"Last Updated: "})]})]})]})]})}),i.jsx("div",{className:"border-t border-gray-200 p-4 bg-gray-50",children:i.jsxs("div",{className:"flex justify-end space-x-3",children:[i.jsx("button",{type:"button",onClick:t,disabled:y,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:"Cancel"}),i.jsx("button",{type:"button",onClick:C,disabled:y||f,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:y?"Saving...":"Save Contact"})]})})]})]}):null},Du=({title:e,count:t,onAddNew:r,children:n,isExpanded:s=!0,onToggle:a,icon:o,isEmpty:l=!1})=>i.jsxs("div",{className:`bg-white border border-gray-200 rounded-lg mb-3 shadow-sm ${l?"opacity-60":""}`,children:[i.jsxs("div",{className:`flex items-center justify-between p-3 border-b border-gray-100 ${l?"bg-gray-50":"bg-gradient-to-r from-slate-50 to-gray-50"}`,children:[i.jsxs("button",{onClick:a,className:"flex items-center space-x-2 flex-1 text-left hover:bg-white/50 -mx-3 px-3 py-1 rounded-t-lg transition-colors",children:[i.jsx("svg",{className:`w-4 h-4 text-gray-400 transform transition-transform ${s?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),o&&i.jsx("div",{className:"w-4 h-4 flex items-center justify-center",children:i.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:o})})}),i.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:e}),i.jsx("span",{className:`inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium ${l?"bg-gray-200 text-gray-600":"bg-blue-100 text-blue-800"}`,children:t}),l&&i.jsx("span",{className:"text-xs text-gray-500 italic",children:"(Empty)"})]}),i.jsxs("button",{onClick:r,className:"flex items-center px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors ml-2",children:[i.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"New"]})]}),s&&i.jsx("div",{className:"max-h-48 overflow-y-auto",children:t===0?i.jsxs("div",{className:"p-4 text-center text-gray-500 text-sm",children:[i.jsx("div",{className:"w-12 h-12 mx-auto mb-2 bg-gray-100 rounded-full flex items-center justify-center",children:o&&i.jsx("svg",{className:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:o})})}),"No ",e.toLowerCase()," yet"]}):n})]}),aA=({contact:e,isExpanded:t=!1,onToggle:r,onEdit:n})=>{var o,l;const s=e.mobile_phone||e.phone,a=e.mobile_phone?"Mobile":"Phone";return i.jsxs("div",{className:"border-b border-gray-100 last:border-b-0",children:[i.jsxs("div",{className:"p-2 hover:bg-gray-50 cursor-pointer transition-colors flex items-center justify-between",onClick:r,children:[i.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[i.jsx("div",{className:"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center flex-shrink-0",children:i.jsxs("span",{className:"text-white font-medium text-xs",children:[((o=e.first_name)==null?void 0:o[0])||"?",((l=e.last_name)==null?void 0:l[0])||""]})}),i.jsx("div",{className:"flex-1 min-w-0",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsxs("span",{className:"text-sm font-medium text-gray-900 truncate",children:[e.first_name," ",e.last_name]}),s&&i.jsxs("span",{className:"text-xs text-gray-500 truncate",children:[a,": ",s]})]})})]}),i.jsx("svg",{className:`w-3 h-3 text-gray-400 transform transition-transform flex-shrink-0 ${t?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),t&&i.jsx("div",{className:"px-2 pb-2 bg-blue-25",children:i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded p-3 text-xs space-y-2",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("span",{className:"w-2 h-2 bg-blue-400 rounded-full"}),i.jsx("span",{className:"font-medium text-blue-900",children:"Contact Details"})]}),i.jsx("button",{onClick:c=>{c.stopPropagation(),n==null||n(e.id)},className:"text-blue-600 hover:text-blue-800 font-medium",children:"Edit"})]}),i.jsxs("div",{className:"space-y-1 ml-4",children:[e.title&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-blue-800",children:"Title:"})," ",i.jsx("span",{className:"text-blue-700",children:e.title})]}),e.company&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-blue-800",children:"Company:"})," ",i.jsx("span",{className:"text-blue-700",children:e.company})]}),e.email&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-blue-800",children:"Email:"})," ",i.jsx("span",{className:"text-blue-700",children:e.email})]}),e.phone&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-blue-800",children:"Phone:"})," ",i.jsx("span",{className:"text-blue-700",children:e.phone})]}),e.mobile_phone&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-blue-800",children:"Mobile:"})," ",i.jsx("span",{className:"text-blue-700",children:e.mobile_phone})]})]})]})})]})},iA=({siteSubmit:e,onClick:t})=>{var r,n;return i.jsx("div",{className:"p-2 hover:bg-green-50 cursor-pointer transition-colors border-b border-gray-100 last:border-b-0 group",onClick:()=>t==null?void 0:t(e.id),children:i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900 truncate group-hover:text-green-900",children:e.site_submit_name||e.sf_account||"Unnamed Submit"}),i.jsx("svg",{className:"w-3 h-3 text-gray-400 group-hover:text-green-600 opacity-0 group-hover:opacity-100 transition-opacity",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]}),i.jsxs("div",{className:"flex items-center justify-between mt-1",children:[i.jsx("p",{className:"text-xs text-green-600 font-medium",children:e.sf_submit_stage||"Site Submit"}),((r=e.property_unit)==null?void 0:r.property_unit_name)&&i.jsx("p",{className:"text-xs text-gray-600 font-medium",children:e.property_unit.property_unit_name}),i.jsx("p",{className:"text-xs text-gray-500 truncate ml-2",children:((n=e.client)==null?void 0:n.client_name)||"No client"})]})]})})})},oA=({deal:e,onClick:t})=>{var r,n;return i.jsx("div",{className:"p-2 hover:bg-blue-50 cursor-pointer transition-colors border-b border-gray-100 last:border-b-0 group",onClick:()=>t==null?void 0:t(e.id),children:i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900 truncate group-hover:text-blue-900",children:e.deal_name||"Unnamed Deal"}),i.jsx("svg",{className:"w-3 h-3 text-gray-400 group-hover:text-blue-600 opacity-0 group-hover:opacity-100 transition-opacity",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]}),i.jsxs("div",{className:"flex items-center justify-between mt-1",children:[i.jsx("p",{className:"text-xs text-blue-600 font-medium",children:((r=e.deal_stage)==null?void 0:r.label)||"No stage"}),i.jsx("p",{className:"text-xs text-gray-500 truncate ml-2",children:((n=e.client)==null?void 0:n.client_name)||"No client"})]})]})})})},lA=({propertyId:e,isMinimized:t=!1,onMinimize:r,onDealClick:n,onSiteSubmitModalChange:s,onContactModalChange:a})=>{const[o,l]=p.useState([]),[c,d]=p.useState([]),[u,m]=p.useState([]),[f,h]=p.useState(!1),[y,w]=p.useState(null),[b,g]=p.useState(!1),[x,v]=p.useState(null),[N,_]=p.useState(!1),[C,j]=p.useState(null),k=()=>({contacts:o.length>0,deals:c.length>0,siteSubmits:u.length>0}),[S,D]=p.useState(()=>{const L=localStorage.getItem(`expandedSidebarModules_${e}`);return L?JSON.parse(L):k()}),[R,P]=p.useState({});p.useEffect(()=>{if(!e)return;(async()=>{h(!0),w(null);try{const{data:F,error:U}=await M.from("property_contact").select(`
            *,
            contact!fk_property_contact_contact_id (*)
          `).eq("property_id",e);if(U)throw U;const E=[];F&&F.forEach(se=>{se.contact&&E.push({...se.contact,isPrimaryContact:!1})});const{data:$,error:B}=await M.from("property").select("contact_id").eq("id",e).single();if(!B&&($!=null&&$.contact_id)){const se=E.findIndex(ae=>ae.id===$.contact_id);if(se>=0)E[se].isPrimaryContact=!0;else{const{data:ae}=await M.from("contact").select("*").eq("id",$.contact_id).single();ae&&E.unshift({...ae,isPrimaryContact:!0})}}l(E);const{data:H,error:J}=await M.from("deal").select(`
            *,
            deal_stage (
              label,
              sort_order
            ),
            client!client_id (
              client_name
            )
          `).eq("property_id",e).order("created_at",{ascending:!1});if(J)throw J;d(H||[]);const{data:le,error:oe}=await M.from("site_submit").select(`
            *,
            client!client_id (
              client_name
            ),
            property_unit (
              property_unit_name
            )
          `).eq("property_id",e).order("created_at",{ascending:!1});if(oe)throw oe;m(le||[])}catch(F){console.error("Error loading sidebar data:",F),w(F instanceof Error?F.message:"Failed to load data")}finally{h(!1)}})()},[e]),p.useEffect(()=>{f||D(L=>{const F=k(),U=localStorage.getItem(`expandedSidebarModules_${e}`);return U?JSON.parse(U):F})},[o.length,c.length,u.length,f,e]);const A=L=>{const F={...S,[L]:!S[L]};D(F),localStorage.setItem(`expandedSidebarModules_${e}`,JSON.stringify(F))},I=L=>{const F={...R,[L]:!R[L]};P(F),localStorage.setItem(`expandedContacts_${e}`,JSON.stringify(F))};return i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:`fixed right-0 top-0 h-full bg-white border-l border-gray-200 shadow-xl transition-all duration-300 ${t?"w-12":"w-[500px]"} z-40 ${t?"overflow-hidden":"overflow-y-auto"}`,style:{top:"180px",height:"calc(100vh - 180px)"},children:[i.jsxs("div",{className:`flex items-center ${t?"justify-center":"justify-between"} p-2 border-b border-gray-200 bg-gray-50`,children:[!t&&i.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Property Info"}),i.jsx("button",{onClick:r,className:`p-2 hover:bg-blue-100 hover:text-blue-600 rounded-md transition-colors group ${t?"text-gray-600":"text-gray-500"}`,title:t?"Expand sidebar":"Minimize sidebar",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t?i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7M4 12h16"}):i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 5l7 7-7 7M20 12H4"})})})]}),!t&&i.jsx("div",{className:"p-3",children:f?i.jsx("div",{className:"p-4 space-y-3",children:[...Array(3)].map((L,F)=>i.jsx("div",{className:"animate-pulse",children:i.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[i.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2"}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"h-3 bg-gray-200 rounded"}),i.jsx("div",{className:"h-3 bg-gray-200 rounded w-2/3"})]})]})},F))}):y?i.jsxs("div",{className:"p-4 text-center text-red-600",children:[i.jsx("p",{className:"font-medium",children:"Error loading data"}),i.jsx("p",{className:"text-sm",children:y})]}):i.jsxs(i.Fragment,{children:[i.jsx(Du,{title:"Associated Contacts",count:o.length,onAddNew:()=>{j(null),_(!0),a==null||a(!0)},isExpanded:S.contacts,onToggle:()=>A("contacts"),icon:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z",isEmpty:o.length===0,children:o.map(L=>i.jsx(aA,{contact:L,isExpanded:R[L.id],onToggle:()=>I(L.id),onEdit:F=>{j(F),_(!0),a==null||a(!0)}},L.id))}),i.jsx(Du,{title:"Deals",count:c.length,onAddNew:()=>console.log("Add new deal"),isExpanded:S.deals,onToggle:()=>A("deals"),icon:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1",isEmpty:c.length===0,children:c.map(L=>i.jsx(oA,{deal:L,onClick:n},L.id))}),i.jsx(Du,{title:"Site Submits",count:u.length,onAddNew:()=>{v(null),g(!0),s==null||s(!0)},isExpanded:S.siteSubmits,onToggle:()=>A("siteSubmits"),icon:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",isEmpty:u.length===0,children:u.map(L=>i.jsx(iA,{siteSubmit:L,onClick:F=>{v(F),g(!0),s==null||s(!0)}},L.id))})]})})]}),i.jsx(k_,{isOpen:b,onClose:()=>{g(!1),v(null),s==null||s(!1)},siteSubmitId:x,propertyId:e,onSave:L=>{m(F=>[L,...F]),g(!1),s==null||s(!1)},onUpdate:L=>{m(F=>F.map(U=>U.id===L.id?L:U)),g(!1),s==null||s(!1)}}),i.jsx(sA,{isOpen:N,onClose:()=>{_(!1),j(null),a==null||a(!1)},contactId:C,propertyId:e,onSave:L=>{l(F=>[{...L,isPrimaryContact:!1},...F]),_(!1),a==null||a(!1)},onUpdate:L=>{l(F=>F.map(U=>U.id===L.id?{...L,isPrimaryContact:U.isPrimaryContact}:U)),_(!1),a==null||a(!1)}})]})},tl=({label:e,value:t,onChange:r,placeholder:n,required:s=!1,type:a="text",helpText:o})=>i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e," ",s&&i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:a,value:t||"",onChange:l=>r(l.target.value||null),placeholder:n,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm"}),o&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:o})]}),hx=({label:e,value:t,onChange:r,helpText:n})=>{const[s,a]=p.useState("");p.useEffect(()=>{t==null?a(""):a(t.toFixed(2))},[t]);const o=l=>{const c=l.target.value;console.log(`[${e}] User typed:`,c),a(c);const d=c===""?null:parseFloat(c);console.log(`[${e}] Parsed value:`,d),console.log(`[${e}] Calling onChange with:`,d),r(d)};return i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),i.jsxs("div",{className:"relative",children:[i.jsx("span",{className:"absolute left-3 top-2 text-gray-500 text-sm",children:"$"}),i.jsx("input",{type:"number",step:"0.01",min:"0",value:s,onChange:o,placeholder:"0.00",className:"w-full pl-8 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),n&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:n})]})},ri=({label:e,checked:t,onChange:r})=>i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:t,onChange:n=>r(n.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),i.jsx("label",{className:"ml-2 block text-sm text-gray-700",children:e})]}),cA=({propertyId:e,isEditing:t=!1,onUnitsChange:r,isExpanded:n=!1,onToggle:s})=>{const[a,o]=p.useState([]),[l,c]=p.useState(!1),[d,u]=p.useState(null);p.useEffect(()=>{if(!e)return;(async()=>{c(!0),u(null);try{const{data:b,error:g}=await M.from("property_unit").select("*").eq("property_id",e).order("property_unit_name");if(g)throw g;console.log("[loadUnits] Data from database:",b),b&&b.forEach((x,v)=>{console.log(`[loadUnits] Unit ${v+1}:`,{name:x.property_unit_name,rent:x.rent,nnn:x.nnn,rentType:typeof x.rent,nnnType:typeof x.nnn})}),o(b||[]),r==null||r(b||[])}catch(b){console.error("Error loading property units:",b),u(b instanceof Error?b.message:"Failed to load units")}finally{c(!1)}})()},[e,r]);const m=async()=>{const w={property_id:e,property_unit_name:`Unit ${a.length+1}`,sqft:null,rent:null,nnn:null,patio:!1,inline:!1,end_cap:!1,end_cap_drive_thru:!1,second_gen_restaurant:!1,lease_expiration_date:null,unit_notes:null};try{const{data:b,error:g}=await M.from("property_unit").insert([w]).select().single();if(g)throw g;const x=[...a,b];o(x),r==null||r(x)}catch(b){console.error("Error creating unit:",b),u(b instanceof Error?b.message:"Failed to create unit")}},f=async(w,b,g)=>{console.log(`[updateUnit] Updating unit ${w}, field: ${b}, value:`,g,typeof g);try{const x={[b]:g};console.log("[updateUnit] Sending to database:",x);const{error:v}=await M.from("property_unit").update(x).eq("id",w);if(v)throw v;const N=a.map(_=>_.id===w?{..._,[b]:g}:_);console.log("[updateUnit] Updated unit in array:",N.find(_=>_.id===w)),o(N),r==null||r(N)}catch(x){console.error("Error updating unit:",x),u(x instanceof Error?x.message:"Failed to update unit")}},h=async w=>{if(confirm("Are you sure you want to delete this unit?"))try{const{error:b}=await M.from("property_unit").delete().eq("id",w);if(b)throw b;const g=a.filter(x=>x.id!==w);o(g),r==null||r(g)}catch(b){console.error("Error deleting unit:",b),u(b instanceof Error?b.message:"Failed to delete unit")}};if(l)return i.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:i.jsxs("div",{className:"animate-pulse",children:[i.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/4 mb-4"}),i.jsx("div",{className:"space-y-3",children:[...Array(2)].map((w,b)=>i.jsx("div",{className:"h-24 bg-gray-200 rounded"},b))})]})});const y=()=>{if(l)return"Loading units...";if(a.length===0)return"No units yet";if(a.length===1){const v=a[0];let N=v.property_unit_name||"Unit";return v.sqft&&(N+=`  ${v.sqft.toLocaleString()} sqft`),v.rent&&(N+=`  $${v.rent.toFixed(2)} rent`),v.nnn&&(N+=`  $${v.nnn.toFixed(2)} NNN`),N}const w=a.reduce((v,N)=>v+(N.sqft||0),0),b=a.reduce((v,N)=>v+(N.rent||0),0),g=a.reduce((v,N)=>v+(N.nnn||0),0);let x=`${a.length} units`;return w>0&&(x+=`  ${w.toLocaleString()} total sqft`),b>0&&(x+=`  $${b.toLocaleString()} total rent`),g>0&&(x+=`  $${g.toLocaleString()} total NNN`),x};return i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[i.jsxs("button",{onClick:s,className:"w-full flex items-center justify-between p-6 hover:bg-gray-50 transition-colors",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("svg",{className:`w-5 h-5 text-gray-400 transform transition-transform ${n?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),i.jsxs("div",{className:"text-left",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Property Units"}),i.jsx("p",{className:"text-sm text-gray-500",children:y()})]})]}),i.jsx("div",{className:"flex items-center space-x-2",children:a.length>0&&i.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:a.length})})]}),n&&i.jsxs("div",{className:"px-6 pb-6 border-t border-gray-100",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4 pt-4",children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Manage individual units within this property"}),i.jsxs("button",{onClick:m,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Unit"]})]}),d&&i.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md",children:i.jsx("p",{className:"text-red-600 text-sm",children:d})}),a.length===0?i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:i.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),i.jsx("p",{className:"text-sm font-medium",children:"No units yet"}),i.jsx("p",{className:"text-xs mt-1",children:'Click "Add Unit" to start adding units to this property'})]}):i.jsx("div",{className:"space-y-4",children:a.map((w,b)=>{var g;return i.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Unit ",b+1]}),i.jsx("button",{onClick:()=>h(w.id),className:"p-1 text-red-600 hover:text-red-800 hover:bg-red-50 rounded",title:"Delete unit",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[i.jsx(tl,{label:"Unit Name",value:w.property_unit_name,onChange:x=>f(w.id,"property_unit_name",x),placeholder:"e.g., Suite 101",required:!0}),i.jsx(tl,{label:"Unit Notes",value:w.unit_notes,onChange:x=>f(w.id,"unit_notes",x),placeholder:"Any special notes about this unit"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[i.jsx(tl,{label:"Square Feet",value:((g=w.sqft)==null?void 0:g.toString())||null,onChange:x=>f(w.id,"sqft",x?Number(x):null),type:"number",placeholder:"0"}),i.jsx(hx,{label:"Rent",value:w.rent,onChange:x=>f(w.id,"rent",x),helpText:"Base rent amount"}),i.jsx(hx,{label:"NNN",value:w.nnn,onChange:x=>f(w.id,"nnn",x),helpText:"Net, Net, Net charges"}),i.jsx(tl,{label:"Lease Expiration",value:w.lease_expiration_date?new Date(w.lease_expiration_date).toISOString().split("T")[0]:null,onChange:x=>f(w.id,"lease_expiration_date",x?new Date(x).toISOString():null),type:"date"})]}),i.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[i.jsx("div",{className:"text-sm font-medium text-gray-700 mb-3",children:"Unit Features"}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4",children:[i.jsx(ri,{label:"Patio",checked:w.patio||!1,onChange:x=>f(w.id,"patio",x)}),i.jsx(ri,{label:"Inline",checked:w.inline||!1,onChange:x=>f(w.id,"inline",x)}),i.jsx(ri,{label:"End Cap",checked:w.end_cap||!1,onChange:x=>f(w.id,"end_cap",x)}),i.jsx(ri,{label:"End Cap Drive Thru",checked:w.end_cap_drive_thru||!1,onChange:x=>f(w.id,"end_cap_drive_thru",x)}),i.jsx(ri,{label:"2nd Gen Restaurant",checked:w.second_gen_restaurant||!1,onChange:x=>f(w.id,"second_gen_restaurant",x)})]})]})]},w.id)})}),a.length>0&&i.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-md",children:i.jsx("p",{className:"text-blue-800 text-sm",children:" Units are automatically saved as you make changes. You can add, edit, or remove units at any time."})})]})]})},dA=({propertyId:e,mode:t="view",initialLocation:r,onSave:n,onBack:s=()=>window.history.back()})=>{const a=gr(),[o,l]=p.useState(!1),[c,d]=p.useState([]),[u,m]=p.useState([]),[f,h]=p.useState([]),[y,w]=p.useState("idle"),[b,g]=p.useState(!1),[x,v]=p.useState(!1),[N,_]=p.useState(!1),[C,j]=p.useState(!1),{property:k,loading:S,error:D,updateProperty:R,createProperty:P,refreshProperty:A}=j_(e),{formData:I,updateField:L,validation:F,isDirty:U,resetForm:E}=KO(k||void 0);p.useEffect(()=>{(async()=>{try{const[ae,T,ee]=await Promise.all([M.from("property_type").select("*").eq("active",!0).order("sort_order"),M.from("property_stage").select("*").eq("active",!0).order("sort_order"),M.from("property_record_type").select("*").eq("active",!0).order("sort_order")]);ae.data&&d(ae.data),T.data&&m(T.data),ee.data?h(ee.data):(console.log("No property record types found in lookup table"),h([]))}catch(ae){console.error("Error loading dropdown data:",ae),h([])}})()},[]),p.useEffect(()=>{t==="create"&&r&&!I.latitude&&!I.longitude&&(L("latitude",r.lat),L("longitude",r.lng))},[t,r,I.latitude,I.longitude,L]),p.useEffect(()=>{k&&E(k)},[k,E]);const $=async()=>{},B=async(se,ae)=>{if(L(se,ae),e&&t!=="create")try{w("saving"),await R({[se]:ae}),w("saved"),setTimeout(()=>w("idle"),2e3)}catch(T){console.error("Auto-save failed:",T),w("error")}},H=()=>new Promise((se,ae)=>{if(!navigator.geolocation){ae(new Error("Geolocation is not supported by this browser"));return}navigator.geolocation.getCurrentPosition(T=>{se({lat:T.coords.latitude,lng:T.coords.longitude})},T=>{ae(new Error("Failed to get current location: "+T.message))},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5})}),J=()=>{console.log("Call contact for property:",e)},le=se=>{a(`/deal/${se}`)};if(S)return i.jsx("div",{className:"min-h-screen bg-gray-50",children:i.jsxs("div",{className:"animate-pulse",children:[i.jsx("div",{className:"bg-slate-800 h-32"}),i.jsxs("div",{className:"flex h-screen",children:[i.jsx("div",{className:"flex-1 p-4 space-y-4",children:i.jsxs("div",{className:"bg-white rounded-lg p-6 space-y-4",children:[i.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4"}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"h-4 bg-gray-200 rounded"}),i.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"})]})]})}),i.jsx("div",{className:"w-80 bg-white border-l border-gray-200 p-4",children:i.jsxs("div",{className:"animate-pulse space-y-4",children:[i.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"h-8 bg-gray-200 rounded"}),i.jsx("div",{className:"h-8 bg-gray-200 rounded"})]})]})})]})]})});if(D&&t!=="create")return i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsx("div",{className:"bg-white rounded-lg border border-red-200 p-6 max-w-md mx-4",children:i.jsxs("div",{className:"text-red-600 text-center",children:[i.jsx("svg",{className:"w-12 h-12 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.732 15.5c-.77.833.192 2.5 1.732 2.5z"})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Error Loading Property"}),i.jsx("p",{className:"text-sm text-gray-600 mb-4",children:D}),i.jsx("button",{onClick:s,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm",children:"Go Back"})]})})});const oe=t==="create"?I:k||I;return i.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[i.jsx(QO,{property:{...oe,property_type:c.find(se=>se.id===oe.property_type_id),property_stage:u.find(se=>se.id===oe.property_stage_id)},isEditing:o,onToggleEdit:$,onBack:s,onGetLocation:()=>H().then(se=>{B("latitude",se.lat),B("longitude",se.lng)}),onCallContact:J}),i.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[i.jsx("div",{className:`flex-1 overflow-y-auto transition-all duration-300 ease-in-out ${N?"lg:-translate-x-[350px]":C?"lg:-translate-x-[400px]":""}`,children:i.jsxs("div",{className:"max-w-4xl mx-auto p-4 pb-8",children:[o&&F.warnings.length>0&&i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Recommendations"}),i.jsx("ul",{className:"mt-1 text-xs text-yellow-700 list-disc list-inside",children:F.warnings.map((se,ae)=>i.jsx("li",{children:se},ae))})]})]})}),o&&y!=="idle"&&i.jsxs("div",{className:`p-2 rounded-md text-sm mb-4 ${y==="saving"?"bg-blue-50 text-blue-700":y==="saved"?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:[y==="saving"&&"Saving changes...",y==="saved"&&"Changes saved successfully",y==="error"&&"Error saving changes"]}),i.jsx(eA,{property:oe,isEditing:o,onFieldUpdate:B,propertyRecordTypes:f}),i.jsx(JO,{property:oe,onFieldUpdate:B,onGetCurrentLocation:H}),e&&i.jsx(cA,{propertyId:e,isEditing:o,isExpanded:x,onToggle:()=>v(!x),onUnitsChange:se=>{console.log("Units updated:",se)}}),i.jsx(XO,{property:{...oe,property_record_type:f.find(se=>se.id===oe.property_record_type_id)},onFieldUpdate:B}),i.jsx(tA,{property:oe,onFieldUpdate:B}),i.jsx(rA,{property:oe,isEditing:o,onFieldUpdate:B}),i.jsx(nA,{property:oe,isEditing:o,onFieldUpdate:B}),o&&!F.isValid&&i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Please fix these errors:"}),i.jsx("ul",{className:"mt-1 text-xs text-red-700 list-disc list-inside",children:Object.entries(F.errors).map(([se,ae])=>i.jsxs("li",{children:[i.jsxs("strong",{children:[se,":"]})," ",ae]},se))})]})]})})]})}),e&&i.jsx(lA,{propertyId:e,isMinimized:b,onMinimize:()=>g(!b),onDealClick:le,onSiteSubmitModalChange:_,onContactModalChange:j})]})]})};function uA(){const{propertyId:e}=io(),t=gr(),[r,n]=p.useState(null),[s,a]=p.useState(!0),[o,l]=p.useState(null),c=e==="create";p.useEffect(()=>{(async()=>{if(!e||c){a(!1);return}try{a(!0);const{data:f,error:h}=await M.from("property").select("*").eq("id",e).single();if(h)throw h;n(f)}catch(f){console.error("Error fetching property:",f),l(f instanceof Error?f.message:"Failed to load property")}finally{a(!1)}})()},[e,c]);const d=()=>{t(-1)},u=m=>{n(m),c&&t(`/property/${m.id}`)};return s?i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),i.jsx("div",{className:"text-sm text-gray-600",children:"Loading property..."})]})}):o&&!c?i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsx("div",{className:"bg-white rounded-lg border border-red-200 p-6 max-w-md mx-4",children:i.jsxs("div",{className:"text-red-600 text-center",children:[i.jsx("svg",{className:"w-12 h-12 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.732 15.5c-.77.833.192 2.5 1.732 2.5z"})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Property Not Found"}),i.jsx("p",{className:"text-sm text-gray-600 mb-4",children:o}),i.jsx("button",{onClick:d,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm",children:"Go Back"})]})})}):i.jsx(dA,{propertyId:c?void 0:e,mode:c?"create":"view",onSave:u,onBack:d})}const fA=()=>{const{contactId:e}=io(),t=gr(),r=e==="new",[n,s]=p.useState({first_name:"",last_name:"",email:null,phone:null,mobile_phone:null,title:null,company:null,client_id:null,source_type:"Contact",mailing_street:null,mailing_city:null,mailing_state:null,mailing_zip:null,mailing_country:null,website:null,linked_in_profile_link:null,icsc_profile_link:null,linked_in_connection:!1,is_site_selector:!1,tenant_repped:!1,tenant_rep_contact_id:null,contact_tags:null}),[a,o]=p.useState([]),[l,c]=p.useState([]),[d,u]=p.useState(!1),[m,f]=p.useState(!1),[h,y]=p.useState({}),w=["Contact","Lead"],b=["AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"];p.useEffect(()=>{(async()=>{u(!0);try{const[C,j]=await Promise.all([M.from("client").select("*").order("client_name"),M.from("contact").select("id, first_name, last_name, company").order("last_name, first_name")]);if(C.data&&o(C.data),j.data&&c(j.data),e&&!r){const{data:k,error:S}=await M.from("contact").select("*").eq("id",e).single();S?console.error("Error loading contact:",S):k&&s({first_name:k.first_name||"",last_name:k.last_name||"",email:k.email,phone:k.phone,mobile_phone:k.mobile_phone,title:k.title,company:k.company,client_id:k.client_id,source_type:k.source_type,mailing_street:k.mailing_street,mailing_city:k.mailing_city,mailing_state:k.mailing_state,mailing_zip:k.mailing_zip,mailing_country:k.mailing_country,website:k.website,linked_in_profile_link:k.linked_in_profile_link,icsc_profile_link:k.icsc_profile_link,linked_in_connection:k.linked_in_connection||!1,is_site_selector:k.is_site_selector||!1,tenant_repped:k.tenant_repped||!1,tenant_rep_contact_id:k.tenant_rep_contact_id,contact_tags:k.contact_tags})}}catch(C){console.error("Error loading form data:",C)}finally{u(!1)}})()},[e,r]);const g=(_,C)=>{s(j=>({...j,[_]:C})),h[_]&&y(j=>({...j,[_]:""}))},x=()=>{var C,j,k;const _={};return(C=n.first_name)!=null&&C.trim()||(_.first_name="First name is required"),(j=n.last_name)!=null&&j.trim()||(_.last_name="Last name is required"),(k=n.source_type)!=null&&k.trim()||(_.source_type="Source type is required"),n.email&&!/\S+@\S+\.\S+/.test(n.email)&&(_.email="Please enter a valid email address"),y(_),Object.keys(_).length===0},v=async()=>{if(x()){f(!0);try{if(e&&!r){const _={...n,updated_at:new Date().toISOString()},{data:C,error:j}=await M.from("contact").update(_).eq("id",e).select().single();if(j)throw j}else{const _={...n,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{data:C,error:j}=await M.from("contact").insert(_).select().single();if(j)throw j;C&&t(`/contact/${C.id}`,{replace:!0})}alert("Contact saved successfully!")}catch(_){console.error("Error saving contact:",_),alert(`Error saving contact: ${_ instanceof Error?_.message:"Unknown error"}. Please check the console for details.`)}finally{f(!1)}}},N=async()=>{if(!(!e||r)&&confirm("Are you sure you want to delete this contact? This action cannot be undone."))try{const{error:_}=await M.from("contact").delete().eq("id",e);if(_)throw _;alert("Contact deleted successfully!"),t("/master-pipeline")}catch(_){console.error("Error deleting contact:",_),alert(`Error deleting contact: ${_ instanceof Error?_.message:"Unknown error"}`)}};return i.jsx("div",{className:"min-h-screen bg-gray-50",children:i.jsxs("div",{className:"max-w-4xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[i.jsx("div",{className:"bg-white shadow rounded-lg mb-6",children:i.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:r?"New Contact":"Edit Contact"}),i.jsx("p",{className:"mt-1 text-sm text-gray-500",children:r?"Create a new contact record":"Update contact information"})]}),i.jsxs("div",{className:"flex space-x-3",children:[i.jsx("button",{onClick:()=>t("/master-pipeline"),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Back to Pipeline"}),!r&&i.jsx("button",{onClick:N,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 border border-transparent rounded-md hover:bg-red-700",children:"Delete"}),i.jsx("button",{onClick:v,disabled:m||d,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 disabled:opacity-50",children:m?"Saving...":"Save Contact"})]})]})})}),i.jsx("div",{className:"bg-white shadow rounded-lg",children:i.jsx("div",{className:"p-6 space-y-8",children:d?i.jsx("div",{className:"flex items-center justify-center h-32",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Basic Information"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name *"}),i.jsx("input",{type:"text",value:n.first_name,onChange:_=>g("first_name",_.target.value),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${h.first_name?"border-red-300":""}`,placeholder:"Enter first name"}),h.first_name&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:h.first_name})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name *"}),i.jsx("input",{type:"text",value:n.last_name,onChange:_=>g("last_name",_.target.value),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${h.last_name?"border-red-300":""}`,placeholder:"Enter last name"}),h.last_name&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:h.last_name})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),i.jsx("input",{type:"text",value:n.title||"",onChange:_=>g("title",_.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"Job title"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company"}),i.jsx("input",{type:"text",value:n.company||"",onChange:_=>g("company",_.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"Company name"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client"}),i.jsxs("select",{value:n.client_id||"",onChange:_=>g("client_id",_.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",children:[i.jsx("option",{value:"",children:"Select a client..."}),a.map(_=>i.jsx("option",{value:_.id,children:_.client_name},_.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Source Type *"}),i.jsxs("select",{value:n.source_type,onChange:_=>g("source_type",_.target.value),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${h.source_type?"border-red-300":""}`,children:[i.jsx("option",{value:"",children:"Select source..."}),w.map(_=>i.jsx("option",{value:_,children:_},_))]}),h.source_type&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:h.source_type})]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Contact Information"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),i.jsx("input",{type:"email",value:n.email||"",onChange:_=>g("email",_.target.value||null),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${h.email?"border-red-300":""}`,placeholder:"Enter email address"}),h.email&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:h.email})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),i.jsx("input",{type:"tel",value:n.phone||"",onChange:_=>g("phone",_.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"(555) 123-4567"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mobile Phone"}),i.jsx("input",{type:"tel",value:n.mobile_phone||"",onChange:_=>g("mobile_phone",_.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"(555) 123-4567"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Website"}),i.jsx("input",{type:"url",value:n.website||"",onChange:_=>g("website",_.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"https://example.com"})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Mailing Address"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Street Address"}),i.jsx("input",{type:"text",value:n.mailing_street||"",onChange:_=>g("mailing_street",_.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"123 Main St"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City"}),i.jsx("input",{type:"text",value:n.mailing_city||"",onChange:_=>g("mailing_city",_.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"City"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"State"}),i.jsxs("select",{value:n.mailing_state||"",onChange:_=>g("mailing_state",_.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",children:[i.jsx("option",{value:"",children:"Select state..."}),b.map(_=>i.jsx("option",{value:_,children:_},_))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ZIP Code"}),i.jsx("input",{type:"text",value:n.mailing_zip||"",onChange:_=>g("mailing_zip",_.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"12345"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Country"}),i.jsx("input",{type:"text",value:n.mailing_country||"",onChange:_=>g("mailing_country",_.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"United States"})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Professional Information"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"LinkedIn Profile"}),i.jsx("input",{type:"url",value:n.linked_in_profile_link||"",onChange:_=>g("linked_in_profile_link",_.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"https://linkedin.com/in/profile"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ICSC Profile Link"}),i.jsx("input",{type:"url",value:n.icsc_profile_link||"",onChange:_=>g("icsc_profile_link",_.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"https://icsc.com/profile"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tenant Rep Contact"}),i.jsxs("select",{value:n.tenant_rep_contact_id||"",onChange:_=>g("tenant_rep_contact_id",_.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",children:[i.jsx("option",{value:"",children:"Select contact..."}),l.map(_=>i.jsxs("option",{value:_.id,children:[_.first_name," ",_.last_name," ",_.company&&`(${_.company})`]},_.id))]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Professional Attributes"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("input",{type:"checkbox",id:"linked_in_connection",checked:n.linked_in_connection,onChange:_=>g("linked_in_connection",_.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),i.jsx("label",{htmlFor:"linked_in_connection",className:"text-sm text-gray-700",children:"LinkedIn Connection"})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("input",{type:"checkbox",id:"is_site_selector",checked:n.is_site_selector,onChange:_=>g("is_site_selector",_.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),i.jsx("label",{htmlFor:"is_site_selector",className:"text-sm text-gray-700",children:"Site Selector"})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("input",{type:"checkbox",id:"tenant_repped",checked:n.tenant_repped,onChange:_=>g("tenant_repped",_.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),i.jsx("label",{htmlFor:"tenant_repped",className:"text-sm text-gray-700",children:"Tenant Repped"})]})]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Tags & Tracking"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Tags"}),i.jsx("textarea",{rows:2,value:n.contact_tags||"",onChange:_=>g("contact_tags",_.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"Tags separated by commas (e.g., VIP, Decision Maker, Cold Lead)"})]})]})]})})})]})})},mA=()=>{const{siteSubmitId:e}=io(),t=gr(),r=e==="new",[n,s]=p.useState({site_submit_name:"",client_id:null,property_id:null,property_unit_id:null,assignment_id:null,submit_stage_id:null,date_submitted:new Date().toISOString().split("T")[0],loi_written:!1,loi_date:"",delivery_date:"",delivery_timeframe:"",notes:"",customer_comments:"",competitor_data:"",record_type_id:null,verified_latitude:null,verified_longitude:null,year_1_rent:null,ti:null}),[a,o]=p.useState([]),[l,c]=p.useState([]),[d,u]=p.useState(!1),[m,f]=p.useState(!1),[h,y]=p.useState({}),[w,b]=p.useState(""),[g,x]=p.useState(!1);p.useEffect(()=>{(async()=>{var S,D,R;u(!0);try{const[P,A]=await Promise.all([M.from("client").select("*").order("client_name"),M.from("submit_stage").select("*").order("name")]);if(P.data&&o(P.data),A.data&&c(A.data),e&&!r){const{data:I,error:L}=await M.from("site_submit").select("*").eq("id",e).single();L?console.error("Error loading site submit:",L):I&&(s({site_submit_name:I.site_submit_name||"",client_id:I.client_id,property_id:I.property_id,property_unit_id:I.property_unit_id,assignment_id:I.assignment_id,submit_stage_id:I.submit_stage_id,date_submitted:((S=I.date_submitted)==null?void 0:S.split("T")[0])||new Date().toISOString().split("T")[0],loi_written:I.loi_written||!1,loi_date:((D=I.loi_date)==null?void 0:D.split("T")[0])||"",delivery_date:((R=I.delivery_date)==null?void 0:R.split("T")[0])||"",delivery_timeframe:I.delivery_timeframe||"",notes:I.notes||"",customer_comments:I.customer_comments||"",competitor_data:I.competitor_data||"",record_type_id:I.record_type_id,verified_latitude:I.verified_latitude,verified_longitude:I.verified_longitude,year_1_rent:I.year_1_rent,ti:I.ti}),x(!0))}}catch(P){console.error("Error loading form data:",P)}finally{u(!1)}})()},[e,r]);const v=(k,S)=>{if(!k||!S)return"";const D=a.find(R=>R.id===k);return D?`${D.client_name} - ${S}`:""},N=(k,S)=>{if(s(D=>({...D,[k]:S})),h[k]&&y(D=>({...D,[k]:""})),k==="client_id"&&!g&&w){const D=v(S,w);D&&s(R=>({...R,site_submit_name:D}))}k==="property_id"&&!g&&n.client_id&&S&&M.from("property").select("property_name").eq("id",S).single().then(({data:D})=>{if(D!=null&&D.property_name){b(D.property_name);const R=v(n.client_id,D.property_name);R&&s(P=>({...P,site_submit_name:R}))}}),k==="site_submit_name"&&x(!0)},_=()=>{var S;const k={};return(S=n.site_submit_name)!=null&&S.trim()||(k.site_submit_name="Site submit name is required"),n.client_id||(k.client_id="Client selection is required"),n.property_id||(k.property_id="Property selection is required"),y(k),Object.keys(k).length===0},C=async()=>{if(_()){f(!0);try{if(e&&!r){const k={...n,date_submitted:n.date_submitted||null,loi_date:n.loi_date||null,delivery_date:n.delivery_date||null,updated_at:new Date().toISOString()},{data:S,error:D}=await M.from("site_submit").update(k).eq("id",e).select().single();if(D)throw D}else{const k={...n,date_submitted:n.date_submitted||null,loi_date:n.loi_date||null,delivery_date:n.delivery_date||null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{data:S,error:D}=await M.from("site_submit").insert(k).select().single();if(D)throw D;S&&t(`/site-submit/${S.id}`,{replace:!0})}alert("Site submit saved successfully!")}catch(k){console.error("Error saving site submit:",k),alert(`Error saving site submit: ${k instanceof Error?k.message:"Unknown error"}. Please check the console for details.`)}finally{f(!1)}}},j=async()=>{if(!(!e||r)&&confirm("Are you sure you want to delete this site submit? This action cannot be undone."))try{const{error:k}=await M.from("site_submit").delete().eq("id",e);if(k)throw k;alert("Site submit deleted successfully!"),t("/master-pipeline")}catch(k){console.error("Error deleting site submit:",k),alert(`Error deleting site submit: ${k instanceof Error?k.message:"Unknown error"}`)}};return i.jsx("div",{className:"min-h-screen bg-gray-50",children:i.jsxs("div",{className:"max-w-4xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[i.jsx("div",{className:"bg-white shadow rounded-lg mb-6",children:i.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:r?"New Site Submit":"Edit Site Submit"}),i.jsx("p",{className:"mt-1 text-sm text-gray-500",children:r?"Create a new site submit record":"Update site submit information"})]}),i.jsxs("div",{className:"flex space-x-3",children:[i.jsx("button",{onClick:()=>t("/master-pipeline"),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Back to Pipeline"}),!r&&i.jsx("button",{onClick:j,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 border border-transparent rounded-md hover:bg-red-700",children:"Delete"}),i.jsx("button",{onClick:C,disabled:m||d,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 disabled:opacity-50",children:m?"Saving...":"Save Site Submit"})]})]})})}),i.jsx("div",{className:"bg-white shadow rounded-lg",children:i.jsx("div",{className:"p-6 space-y-8",children:d?i.jsx("div",{className:"flex items-center justify-center h-32",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Basic Information"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Site Submit Name *"}),i.jsx("input",{type:"text",value:n.site_submit_name,onChange:k=>N("site_submit_name",k.target.value),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${h.site_submit_name?"border-red-300":""}`,placeholder:"Enter site submit name"}),h.site_submit_name&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:h.site_submit_name})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client *"}),i.jsxs("select",{value:n.client_id||"",onChange:k=>N("client_id",k.target.value||null),className:`block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm ${h.client_id?"border-red-300":""}`,children:[i.jsx("option",{value:"",children:"Select a client..."}),a.map(k=>i.jsx("option",{value:k.id,children:k.client_name},k.id))]}),h.client_id&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:h.client_id})]}),i.jsx(Gh,{value:n.property_id,onChange:k=>N("property_id",k),label:"Property *"}),h.property_id&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:h.property_id}),n.property_id&&i.jsx(qh,{propertyId:n.property_id,value:n.property_unit_id,onChange:k=>N("property_unit_id",k),label:"Property Unit (Optional)"})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Submission Details"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Submit Stage"}),i.jsxs("select",{value:n.submit_stage_id||"",onChange:k=>N("submit_stage_id",k.target.value||null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",children:[i.jsx("option",{value:"",children:"Select stage..."}),l.map(k=>i.jsx("option",{value:k.id,children:k.name},k.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date Submitted"}),i.jsx("input",{type:"date",value:n.date_submitted,onChange:k=>N("date_submitted",k.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm"})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("input",{type:"checkbox",id:"loi_written",checked:n.loi_written,onChange:k=>N("loi_written",k.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),i.jsx("label",{htmlFor:"loi_written",className:"text-sm font-medium text-gray-700",children:"LOI Written"})]}),n.loi_written&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"LOI Date"}),i.jsx("input",{type:"date",value:n.loi_date,onChange:k=>N("loi_date",k.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Delivery Date"}),i.jsx("input",{type:"date",value:n.delivery_date,onChange:k=>N("delivery_date",k.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Delivery Timeframe"}),i.jsx("input",{type:"text",value:n.delivery_timeframe,onChange:k=>N("delivery_timeframe",k.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"e.g., 30-60 days, Q1 2024"})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Financial Information"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year 1 Rent ($)"}),i.jsx("input",{type:"number",step:"0.01",value:n.year_1_rent||"",onChange:k=>N("year_1_rent",k.target.value?parseFloat(k.target.value):null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"TI ($)"}),i.jsx("input",{type:"number",step:"0.01",value:n.ti||"",onChange:k=>N("ti",k.target.value?parseFloat(k.target.value):null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"0.00"})]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Location Verification"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Verified Latitude"}),i.jsx("input",{type:"number",step:"any",value:n.verified_latitude||"",onChange:k=>N("verified_latitude",k.target.value?parseFloat(k.target.value):null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"e.g., 40.7128"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Verified Longitude"}),i.jsx("input",{type:"number",step:"any",value:n.verified_longitude||"",onChange:k=>N("verified_longitude",k.target.value?parseFloat(k.target.value):null),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"e.g., -74.0060"})]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Notes & Comments"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),i.jsx("textarea",{rows:3,value:n.notes,onChange:k=>N("notes",k.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"Internal notes..."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer Comments"}),i.jsx("textarea",{rows:3,value:n.customer_comments,onChange:k=>N("customer_comments",k.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"Customer feedback or requirements..."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Competitor Data"}),i.jsx("textarea",{rows:3,value:n.competitor_data,onChange:k=>N("competitor_data",k.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"Competitive landscape information..."})]})]})]})})})]})})};function hA({assignment:e,onSave:t}){const[r,n]=p.useState(e),[s,a]=p.useState(!1),[o,l]=p.useState(null),[c,d]=p.useState({}),[u,m]=p.useState([]);p.useState([]),p.useState([]);const[f,h]=p.useState([]),[y,w]=p.useState(""),[b,g]=p.useState([]),[x,v]=p.useState(""),[N,_]=p.useState([]);p.useEffect(()=>{const D={...e};if(e.assignment_value&&e.commission){const R=(e.assignment_value||0)*((e.commission||0)/100);D.fee=Math.round(R*100)/100}n(D),d({}),g([]),_([]),e.client_id?M.from("client").select("client_name").eq("id",e.client_id).single().then(({data:R})=>{R&&w(R.client_name||"")}):w(""),e.deal_id?M.from("deal").select("deal_name").eq("id",e.deal_id).single().then(({data:R})=>{R&&v(R.deal_name||"")}):v("")},[e]),p.useEffect(()=>{(async()=>{const{data:R}=await M.from("assignment_priority").select("*").eq("active",!0).order("sort_order");R&&m(R);const{data:P}=await M.from("user").select("id, name").order("name");P&&h(P.map(A=>({id:A.id,label:A.name||"Unknown User"})))})()},[]),p.useEffect(()=>{const D=setTimeout(async()=>{if(y.trim().length>0){const{data:R}=await M.from("client").select("id, client_name").ilike("client_name",`%${y}%`).limit(5);R&&g(R.map(P=>({id:P.id,label:P.client_name||"Unnamed Client"})))}else g([])},300);return()=>clearTimeout(D)},[y]),p.useEffect(()=>{const D=setTimeout(async()=>{if(x.trim().length>0){const{data:R}=await M.from("deal").select("id, deal_name").ilike("deal_name",`%${x}%`).limit(5);R&&_(R.map(P=>({id:P.id,label:P.deal_name||"Unnamed Deal"})))}else _([])},300);return()=>clearTimeout(D)},[x]);const C=async(D,R)=>{let P={...r,[D]:R};if(D==="assignment_value"||D==="commission"){const A=D==="assignment_value"?R:P.assignment_value,I=D==="commission"?R:P.commission,L=(A||0)*((I||0)/100);P.fee=Math.round(L*100)/100}if(n(P),c[D]&&d(A=>{const I={...A};return delete I[D],I}),r.id&&r.id!=="new")try{const A={assignment_name:P.assignment_name,assignment_value:P.assignment_value,client_id:P.client_id,deal_id:P.deal_id,owner_id:P.owner_id,priority_id:P.priority_id,transaction_type_id:P.transaction_type_id,due_date:P.due_date,commission:P.commission,fee:P.fee,referral_fee:P.referral_fee,referral_payee_id:P.referral_payee_id,scoped:P.scoped,site_criteria:P.site_criteria,updated_at:new Date().toISOString()},{data:I,error:L}=await M.from("assignment").update(A).eq("id",r.id).select().single();if(L)throw L;I&&t(I)}catch(A){console.error("Error auto-saving assignment:",A),alert(`Auto-save failed: ${A instanceof Error?A.message:"Unknown error"}`)}},j=()=>{var R;const D={};return(R=r.assignment_name)!=null&&R.trim()||(D.assignment_name="Assignment name is required"),r.priority_id||(D.priority_id="Priority is required"),d(D),Object.keys(D).length===0},k=async()=>{if(!j())return;a(!0);const D=(r.assignment_value||0)*((r.commission||0)/100),R={assignment_name:r.assignment_name,assignment_value:r.assignment_value,client_id:r.client_id,deal_id:r.deal_id,owner_id:r.owner_id,priority_id:r.priority_id,transaction_type_id:r.transaction_type_id,due_date:r.due_date,commission:r.commission,fee:Math.round(D*100)/100,referral_fee:r.referral_fee,referral_payee_id:r.referral_payee_id,scoped:r.scoped,site_criteria:r.site_criteria,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};try{const{data:P,error:A}=await M.from("assignment").insert([R]).select().single();if(A)throw A;P&&t(P)}catch(P){console.error("Error creating assignment:",P),alert(`Error creating assignment: ${P instanceof Error?P.message:"Unknown error"}`)}finally{a(!1)}},S=D=>{if(!D)return null;try{return $h(D)}catch{return null}};return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Assignment Details"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assignment Name *"}),i.jsx("input",{type:"text",value:r.assignment_name||"",onChange:D=>C("assignment_name",D.target.value),className:`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 ${c.assignment_name?"border-red-500":"border-gray-300"}`,placeholder:"Enter assignment name",tabIndex:1}),c.assignment_name&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.assignment_name})]}),i.jsx(ts,{label:"Assignment Value",value:r.assignment_value,onChange:D=>C("assignment_value",D===""?null:parseFloat(D)),format:D=>ji(D,2),editingField:o,setEditingField:l,fieldKey:"assignment_value",tabIndex:2}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority *"}),i.jsxs("select",{value:r.priority_id||"",onChange:D=>C("priority_id",D.target.value||null),className:`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 ${c.priority_id?"border-red-500":"border-gray-300"}`,tabIndex:3,children:[i.jsx("option",{value:"",children:"Select priority..."}),u.map(D=>i.jsx("option",{value:D.id,children:D.label},D.id))]}),c.priority_id&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.priority_id})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Owner"}),i.jsxs("select",{value:r.owner_id||"",onChange:D=>C("owner_id",D.target.value||null),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500",tabIndex:4,children:[i.jsx("option",{value:"",children:"Select owner..."}),f.map(D=>i.jsx("option",{value:D.id,children:D.label},D.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Due Date"}),i.jsx(c_,{selected:S(r.due_date),onChange:D=>C("due_date",D?D.toISOString().split("T")[0]:null),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholderText:"Select due date",dateFormat:"yyyy-MM-dd",tabIndex:5})]})]})]}),i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Relationships"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client"}),i.jsx("input",{type:"text",value:y,onChange:D=>w(D.target.value),onFocus:D=>D.target.select(),placeholder:"Search clients...",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500",tabIndex:6}),b.filter(D=>D.label!==y).length>0&&i.jsx("ul",{className:"bg-white border border-gray-300 rounded mt-1 max-h-48 overflow-auto shadow-lg",children:b.filter(D=>D.label!==y).map(D=>i.jsx("li",{onClick:()=>{C("client_id",D.id),w(D.label),g([])},className:"px-3 py-2 hover:bg-gray-100 cursor-pointer text-sm",children:D.label},D.id))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Deal"}),i.jsx("input",{type:"text",value:x,onChange:D=>v(D.target.value),onFocus:D=>D.target.select(),placeholder:"Search deals...",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500",tabIndex:7}),N.filter(D=>D.label!==x).length>0&&i.jsx("ul",{className:"bg-white border border-gray-300 rounded mt-1 max-h-48 overflow-auto shadow-lg",children:N.filter(D=>D.label!==x).map(D=>i.jsx("li",{onClick:()=>{C("deal_id",D.id),v(D.label),_([])},className:"px-3 py-2 hover:bg-gray-100 cursor-pointer text-sm",children:D.label},D.id))})]})]})]}),i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Financial Details"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsx(ts,{label:"Commission %",value:r.commission,onChange:D=>C("commission",D===""?null:parseFloat(D)),format:D=>Vf(D,2),editingField:o,setEditingField:l,fieldKey:"commission",tabIndex:8}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Calculated Fee"}),i.jsx("div",{className:"mt-1 p-2 bg-gray-100 rounded text-sm",children:ji(r.fee,2)})]}),i.jsx(ts,{label:"Referral Fee %",value:r.referral_fee,onChange:D=>C("referral_fee",D===""?null:parseFloat(D)),format:D=>Vf(D,2),editingField:o,setEditingField:l,fieldKey:"referral_fee",tabIndex:9}),i.jsx(m_,{value:r.referral_payee_id,onChange:D=>C("referral_payee_id",D),label:"Referral Payee",tabIndex:10})]})]}),i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Additional Details"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",id:"scoped",checked:r.scoped||!1,onChange:D=>C("scoped",D.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded",tabIndex:11}),i.jsx("label",{htmlFor:"scoped",className:"ml-2 block text-sm text-gray-900",children:"Scoped Assignment"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Site Criteria"}),i.jsx("textarea",{value:r.site_criteria||"",onChange:D=>C("site_criteria",D.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Enter site criteria...",tabIndex:12})]})]})]}),r.id==="new"&&i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{onClick:k,disabled:s,className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",tabIndex:13,children:s?"Creating...":"Create Assignment"})})]})}const pA=({title:e,count:t,onAddNew:r,children:n,isExpanded:s=!0,onToggle:a,icon:o,isEmpty:l=!1})=>i.jsxs("div",{className:`bg-white border border-gray-200 rounded-lg mb-3 shadow-sm ${l?"opacity-60":""}`,children:[i.jsxs("div",{className:`flex items-center justify-between p-3 border-b border-gray-100 ${l?"bg-gray-50":"bg-gradient-to-r from-slate-50 to-gray-50"}`,children:[i.jsxs("button",{onClick:a,className:"flex items-center space-x-2 flex-1 text-left hover:bg-white/50 -mx-3 px-3 py-1 rounded-t-lg transition-colors",children:[i.jsx("svg",{className:`w-4 h-4 text-gray-400 transform transition-transform ${s?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),o&&i.jsx("div",{className:"w-4 h-4 flex items-center justify-center",children:i.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:o})})}),i.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:e}),i.jsx("span",{className:`inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium ${l?"bg-gray-200 text-gray-600":"bg-blue-100 text-blue-800"}`,children:t}),l&&i.jsx("span",{className:"text-xs text-gray-500 italic",children:"(Empty)"})]}),i.jsxs("button",{onClick:r,className:"flex items-center px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors ml-2",children:[i.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"New"]})]}),s&&i.jsx("div",{className:"max-h-[560px] overflow-y-auto",children:t===0?i.jsxs("div",{className:"p-4 text-center text-gray-500 text-sm",children:[i.jsx("div",{className:"w-12 h-12 mx-auto mb-2 bg-gray-100 rounded-full flex items-center justify-center",children:o&&i.jsx("svg",{className:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:o})})}),"No ",e.toLowerCase()," yet"]}):n})]}),gA=({siteSubmit:e,onClick:t})=>{var r,n;return i.jsx("div",{className:"p-2 hover:bg-green-50 cursor-pointer transition-colors border-b border-gray-100 last:border-b-0 group",onClick:()=>t==null?void 0:t(e.id),children:i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900 truncate group-hover:text-green-900",children:e.site_submit_name||e.sf_account||"Unnamed Submit"}),i.jsx("svg",{className:"w-3 h-3 text-gray-400 group-hover:text-green-600 opacity-0 group-hover:opacity-100 transition-opacity",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]}),i.jsxs("div",{className:"flex items-center justify-between mt-1",children:[i.jsx("p",{className:"text-xs text-green-600 font-medium",children:e.sf_submit_stage||"Site Submit"}),((r=e.property_unit)==null?void 0:r.property_unit_name)&&i.jsx("p",{className:"text-xs text-gray-600 font-medium",children:e.property_unit.property_unit_name}),i.jsx("p",{className:"text-xs text-gray-500 truncate ml-2",children:((n=e.client)==null?void 0:n.client_name)||"No client"})]})]})})})},xA=({assignmentId:e,isMinimized:t=!1,onMinimize:r,onSiteSubmitModalChange:n})=>{const[s,a]=p.useState([]),[o,l]=p.useState(!1),[c,d]=p.useState(null),[u,m]=p.useState(!1),[f,h]=p.useState(null),[y,w]=p.useState(()=>{const g=localStorage.getItem(`expandedSidebarModules_assignment_${e}`);return g?JSON.parse(g):{siteSubmits:!0}});p.useEffect(()=>{if(!e||e==="new"){a([]),l(!1);return}(async()=>{l(!0),d(null);try{const{data:x,error:v}=await M.from("site_submit").select(`
            *,
            client!client_id (
              client_name
            ),
            property_unit (
              property_unit_name
            )
          `).eq("assignment_id",e).order("created_at",{ascending:!1});if(v)throw v;a(x||[])}catch(x){console.error("Error loading assignment sidebar data:",x),d(x instanceof Error?x.message:"Failed to load data")}finally{l(!1)}})()},[e]),p.useEffect(()=>{o||w(g=>{const x={siteSubmits:s.length>0},v=localStorage.getItem(`expandedSidebarModules_assignment_${e}`);return v?JSON.parse(v):x})},[s.length,o,e]);const b=g=>{const x={...y,[g]:!y[g]};w(x),localStorage.setItem(`expandedSidebarModules_assignment_${e}`,JSON.stringify(x))};return i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:`fixed right-0 bg-white border-l border-gray-200 shadow-xl transition-all duration-300 ${t?"w-12":"w-[500px]"} z-40 ${t?"overflow-hidden":"overflow-visible"}`,style:{top:"180px",height:t?"60px":`${Math.min(120+s.length*52,120+10*52)}px`},children:[i.jsxs("div",{className:`flex items-center ${t?"justify-center":"justify-between"} p-2 border-b border-gray-200 bg-gray-50`,children:[!t&&i.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Assignment Info"}),i.jsx("button",{onClick:r,className:`p-2 hover:bg-blue-100 hover:text-blue-600 rounded-md transition-colors group ${t?"text-gray-600":"text-gray-500"}`,title:t?"Expand sidebar":"Minimize sidebar",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t?i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7M4 12h16"}):i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 5l7 7-7 7M20 12H4"})})})]}),!t&&i.jsx("div",{className:"p-3",children:o?i.jsx("div",{className:"p-4 space-y-3",children:i.jsx("div",{className:"animate-pulse",children:i.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[i.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2"}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"h-3 bg-gray-200 rounded"}),i.jsx("div",{className:"h-3 bg-gray-200 rounded w-2/3"})]})]})})}):c?i.jsxs("div",{className:"p-4 text-center text-red-600",children:[i.jsx("p",{className:"font-medium",children:"Error loading data"}),i.jsx("p",{className:"text-sm",children:c})]}):i.jsx(i.Fragment,{children:i.jsx(pA,{title:"Associated Site Submits",count:s.length,onAddNew:()=>{if(e==="new"){alert("Please save the assignment first before adding site submits.");return}h(null),m(!0),n==null||n(!0)},isExpanded:y.siteSubmits,onToggle:()=>b("siteSubmits"),icon:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",isEmpty:s.length===0,children:s.map(g=>i.jsx(gA,{siteSubmit:g,onClick:x=>{h(x),m(!0),n==null||n(!0)}},g.id))})})})]}),e!=="new"&&i.jsx(k_,{isOpen:u,onClose:()=>{m(!1),h(null),n==null||n(!1)},siteSubmitId:f,assignmentId:e,onSave:g=>{a(x=>[g,...x]),m(!1),n==null||n(!1)},onUpdate:g=>{a(x=>x.map(v=>v.id===g.id?g:v)),m(!1),n==null||n(!1)}})]})};function px(){const{assignmentId:e}=io(),t=pr(),[r,n]=p.useState(null),[s,a]=p.useState(!1),[o,l]=p.useState(!0),[c,d]=p.useState(null),[u,m]=p.useState(!1),[f,h]=p.useState(!1),y=e||(t.pathname==="/assignment/new"?"new":void 0);p.useEffect(()=>{const b=async()=>{if(y==="new"){console.log("Creating new blank assignment...");const g={id:"new",assignment_name:"",assignment_value:null,client_id:null,deal_id:null,owner_id:null,priority_id:null,transaction_type_id:null,due_date:null,progress:null,commission:null,fee:null,referral_fee:null,referral_payee_id:null,scoped:null,site_criteria:null,sf_id:null,sf_account_id:null,sf_opportunity_id:null,sf_owner_id:null,sf_priority:null,sf_referral_payee:null,sf_scoped_formula:null,sf_transaction_type:null,sf_num_of_pursuing_ownership:null,sf_num_of_site_submits:null,sf_number_of_pursuing_ownership:null,sf_number_of_site_submits:null,created_at:null,updated_at:null,created_by_id:null,updated_by_id:null,sf_created_by_id:null,updated_by_sf_id:null};console.log("Blank assignment created:",g),n(g),a(!0),l(!1);return}if(!y){d("No assignment ID provided"),l(!1);return}try{console.log("Fetching existing assignment with ID:",y);const{data:g,error:x}=await M.from("assignment").select("*").eq("id",y).single();x?(console.error("Error fetching assignment:",x),d(`Failed to load assignment: ${x.message}`)):g?(console.log("Assignment loaded:",g),n(g),a(!1)):d("Assignment not found")}catch(g){console.error("Unexpected error:",g),d("An unexpected error occurred")}finally{l(!1)}};console.log("AssignmentDetailsPage useEffect - actualAssignmentId:",y,"type:",typeof y),y?(console.log("AssignmentDetailsPage useEffect triggered with actualAssignmentId:",y),b()):(console.log("No actualAssignmentId provided - this should not happen for assignment routes"),d("Invalid assignment route"),l(!1))},[y]);const w=b=>{n(b),s&&b.id&&b.id!=="new"&&(a(!1),window.history.replaceState(null,"",`/assignment/${b.id}`))};return o?i.jsx("div",{className:"p-4",children:y==="new"?"Initializing new assignment...":"Loading assignment..."}):c?i.jsx("div",{className:"p-4 max-w-4xl mx-auto",children:i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[i.jsx("h3",{className:"text-sm font-semibold text-red-800 mb-2",children:"Error Loading Assignment"}),i.jsx("p",{className:"text-sm text-red-600",children:c}),i.jsx("button",{onClick:()=>window.history.back(),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 text-sm",children:"Go Back"})]})}):r?i.jsxs("div",{className:"min-h-screen bg-gray-100 flex flex-col",children:[i.jsx("div",{className:"bg-white border-b border-gray-200",children:i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"flex justify-between items-center py-6 md:justify-start md:space-x-10",children:[i.jsx("div",{className:"flex justify-start lg:w-0 lg:flex-1",children:i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:s?"New Assignment":r.assignment_name||"Unnamed Assignment"})}),!s&&i.jsx("div",{className:"flex items-center space-x-2",children:r.progress&&typeof r.progress=="string"&&!r.progress.includes("<")&&i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${r.progress==="Completed"?"bg-green-100 text-green-800":r.progress==="In Progress"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:r.progress})})]})})}),i.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[i.jsx("div",{className:`flex-1 overflow-y-auto transition-all duration-300 ease-in-out ${f?"lg:-translate-x-[350px]":u?"":"lg:-translate-x-[100px]"}`,children:i.jsx("div",{className:"max-w-4xl mx-auto p-4 pb-8",children:i.jsx(hA,{assignment:r,onSave:w})})}),i.jsx(xA,{assignmentId:y||"new",isMinimized:u,onMinimize:()=>m(!u),onSiteSubmitModalChange:h})]})]}):i.jsx("div",{className:"p-4 max-w-4xl mx-auto",children:i.jsx("div",{className:"text-center text-gray-600 py-8",children:i.jsx("p",{className:"text-sm",children:"Assignment not found"})})})}class yA{constructor(){this.NOMINATIM_BASE_URL="https://nominatim.openstreetmap.org/search",this.USER_AGENT="PropertyKanbanApp/1.0"}async geocodeAddress(t){try{const r=t.trim().replace(/\s+/g," ");if(!r)return{error:"Address is required"};const n=await fetch(`${this.NOMINATIM_BASE_URL}?`+new URLSearchParams({q:r,format:"json",limit:"1",addressdetails:"1",countrycodes:"us"}),{headers:{"User-Agent":this.USER_AGENT}});if(!n.ok)throw new Error(`Geocoding API responded with status: ${n.status}`);const s=await n.json();if(!s||s.length===0)return{error:"Address not found",code:"NOT_FOUND"};const a=s[0],o=a.address||{};return{latitude:parseFloat(a.lat),longitude:parseFloat(a.lon),formatted_address:a.display_name,city:o.city||o.town||o.village||o.hamlet,state:o.state,zip:o.postcode,county:o.county}}catch(r){return console.error("Geocoding error:",r),{error:r instanceof Error?r.message:"Geocoding failed",code:"GEOCODING_ERROR"}}}async reverseGeocode(t,r){try{const n=await fetch("https://nominatim.openstreetmap.org/reverse?"+new URLSearchParams({lat:t.toString(),lon:r.toString(),format:"json",addressdetails:"1"}),{headers:{"User-Agent":this.USER_AGENT}});if(!n.ok)throw new Error(`Reverse geocoding API responded with status: ${n.status}`);const s=await n.json();if(!s)return{error:"Location not found",code:"NOT_FOUND"};const a=s.address||{};return{latitude:t,longitude:r,formatted_address:s.display_name,city:a.city||a.town||a.village||a.hamlet,state:a.state,zip:a.postcode,county:a.county}}catch(n){return console.error("Reverse geocoding error:",n),{error:n instanceof Error?n.message:"Reverse geocoding failed",code:"REVERSE_GEOCODING_ERROR"}}}buildAddressString(t,r,n,s){const a=[t];return r&&a.push(r),n&&a.push(n),s&&a.push(s),a.join(", ")}isValidCoordinates(t,r){return t>=-90&&t<=90&&r>=-180&&r<=180}async getCurrentLocation(){return new Promise(t=>{if(!navigator.geolocation){t({error:"Geolocation is not supported by this browser",code:"NOT_SUPPORTED"});return}navigator.geolocation.getCurrentPosition(r=>{t({lat:r.coords.latitude,lng:r.coords.longitude})},r=>{let n="Failed to get current location",s="LOCATION_ERROR";switch(r.code){case r.PERMISSION_DENIED:n="Location access denied by user",s="PERMISSION_DENIED";break;case r.POSITION_UNAVAILABLE:n="Location information unavailable",s="POSITION_UNAVAILABLE";break;case r.TIMEOUT:n="Location request timed out",s="TIMEOUT";break}t({error:n,code:s})},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5})})}}const Eu=new yA;function vA(){const[e,t]=p.useState(!1),[r,n]=p.useState(null),s=p.useCallback(()=>{n(null)},[]),a=p.useCallback(async l=>{t(!0),n(null);try{const c=Eu.buildAddressString(l.address||"",l.city,l.state,l.zip);if(!c.trim())throw new Error("No address provided for geocoding");console.log(" Geocoding address:",c);const d=await Eu.geocodeAddress(c);if("error"in d)return n(d.error),console.error("Geocoding failed:",d.error),l;const u=d,m={...l,latitude:u.latitude,longitude:u.longitude};return!l.city&&u.city&&(m.city=u.city),!l.state&&u.state&&(m.state=u.state),!l.zip&&u.zip&&(m.zip=u.zip),!l.county&&u.county&&(m.county=u.county),console.log(" Geocoding successful:",{address:c,coordinates:[u.latitude,u.longitude]}),m}catch(c){const d=c instanceof Error?c.message:"Geocoding failed";return n(d),console.error("Geocoding error:",c),l}finally{t(!1)}},[]),o=p.useCallback(async()=>{n(null);try{const l=await Eu.getCurrentLocation();return"error"in l?(n(l.error),null):l}catch(l){const c=l instanceof Error?l.message:"Failed to get current location";return n(c),null}},[]);return{isGeocoding:e,geocodeError:r,geocodeProperty:a,getCurrentLocation:o,clearError:s}}function bA(){const[e,t]=p.useState([]),[r,n]=p.useState(!0),[s,a]=p.useState(null);return p.useEffect(()=>{(async()=>{try{n(!0),a(null);const{data:l,error:c}=await M.from("property_record_type").select("*").eq("active",!0).order("sort_order");if(c)throw c;t(l||[])}catch(l){const c=l instanceof Error?l.message:"Failed to fetch property record types";a(c),console.error("Error fetching property record types:",l)}finally{n(!1)}})()},[]),{propertyRecordTypes:e,isLoading:r,error:s}}const wA=()=>{const e=gr(),[t,r]=p.useState(!1),{isGeocoding:n,geocodeError:s,geocodeProperty:a,getCurrentLocation:o,clearError:l}=vA(),{propertyRecordTypes:c,isLoading:d,error:u}=bA(),{createProperty:m}=j_(),[f,h]=p.useState({property_record_type_id:null,property_name:"",address:"",city:"",state:"",zip:"",trade_area:"",asking_lease_price:null,asking_purchase_price:null,rent_psf:null,nnn_psf:null,property_notes:"",acres:null,units:[]}),y=(T,ee)=>{h(q=>({...q,[T]:ee}))},w=()=>{const T={id:`temp_${Date.now()}`,property_unit_name:null,sqft:null,rent:null,nnn:null,patio:!1,inline:!1,end_cap:!1,end_cap_drive_thru:!1,second_gen_restaurant:!1,created_at:null,created_by_id:null,created_by_sf_id:null,deal_id:null,lease_expiration_date:null,property_id:null,sf_id:crypto.randomUUID(),site_submit_id:null,unit_notes:null,updated_at:null,updated_by_id:null,updated_by_sf_id:null};h(ee=>({...ee,units:[...ee.units,T]}))},b=(T,ee,q)=>{h(ce=>({...ce,units:ce.units.map(pe=>pe.id===T?{...pe,[ee]:q}:pe)}))},g=T=>{h(ee=>({...ee,units:ee.units.filter(q=>q.id!==T)}))},x=p.useMemo(()=>{var Le;const T=c.find(Ie=>Ie.id===f.property_record_type_id),ee=((Le=T==null?void 0:T.label)==null?void 0:Le.toLowerCase())||"",q=ee.includes("land"),ce=ee.includes("shopping")||ee.includes("retail");return{isLandType:q,isShoppingCenterType:ce,showLeaseFields:!q&&!ce,showPSFFields:!q,showPurchaseFields:q,selectedRecordType:T,recordTypeLabel:ee}},[f.property_record_type_id,c]),{isLandType:v,isShoppingCenterType:N,showLeaseFields:_,showPSFFields:C,showPurchaseFields:j,selectedRecordType:k,recordTypeLabel:S}=x;p.useEffect(()=>{if(!f.property_record_type_id)return;const T={};v&&!C&&(f.rent_psf||f.nnn_psf)&&(T.rent_psf=null,T.nnn_psf=null),N&&f.asking_purchase_price&&(T.asking_purchase_price=null),_&&f.asking_purchase_price&&(T.asking_purchase_price=null),Object.keys(T).length>0&&h(ee=>({...ee,...T}))},[v,N,_,C,f.property_record_type_id]);const D=async T=>{if(T.preventDefault(),l(),!f.property_record_type_id){alert("Please select a property record type");return}if(!f.property_name.trim()||!f.address.trim()||!f.city.trim()||!f.state.trim()){alert("Please fill in all required fields (Property Record Type, Property Name, Address, City, State)");return}r(!0);try{console.log("Creating new property:",f);const ee={property_record_type_id:f.property_record_type_id,property_name:f.property_name,address:f.address,city:f.city,state:f.state,zip:f.zip,trade_area:f.trade_area,asking_lease_price:f.asking_lease_price,asking_purchase_price:f.asking_purchase_price,rent_psf:f.rent_psf,nnn_psf:f.nnn_psf,property_notes:f.property_notes,acres:f.acres},q=await m(ee);if(console.log(" Property created successfully:",q),N&&f.units.length>0){console.log("Creating property units:",f.units);const ce=f.units.filter(pe=>pe.property_unit_name&&pe.property_unit_name.trim()).map(pe=>{var ye;return{property_id:q.id,property_unit_name:((ye=pe.property_unit_name)==null?void 0:ye.trim())||null,sqft:pe.sqft,rent:pe.rent,nnn:pe.nnn,patio:pe.patio,inline:pe.inline,end_cap:pe.end_cap,end_cap_drive_thru:pe.end_cap_drive_thru,second_gen_restaurant:pe.second_gen_restaurant,sf_id:crypto.randomUUID(),lease_expiration_date:pe.lease_expiration_date,unit_notes:pe.unit_notes,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),created_by_id:null,created_by_sf_id:null,deal_id:null,site_submit_id:null,updated_by_id:null,updated_by_sf_id:null}});if(ce.length>0){const{data:pe,error:ye}=await M.from("property_unit").insert(ce).select();ye?console.error("Error creating property units:",ye):console.log(" Property units created successfully:",pe)}}a(q).then(ce=>{ce.latitude&&ce.longitude?console.log(" Property geocoded successfully:",{coordinates:[ce.latitude,ce.longitude]}):s&&console.warn(" Property created but geocoding failed:",s)}).catch(ce=>{console.warn(" Property created but geocoding failed:",ce)}),e(`/property/${q.id}`)}catch(ee){console.error("Error creating property:",ee),alert("Failed to create property. Please try again.")}finally{r(!1)}},R=()=>{e(-1)},[P,A]=p.useState(!1),[I,L]=p.useState(!1),[F,U]=p.useState({}),[E,$]=p.useState(!1),[B,H]=p.useState(!1),J=()=>{A(!0),setTimeout(()=>A(!1),4e3)},le=()=>{L(!0),setTimeout(()=>L(!1),4e3)},oe=T=>{U(ee=>({...ee,[T]:!0})),setTimeout(()=>{U(ee=>({...ee,[T]:!1}))},4e3)},se=()=>{$(!0),setTimeout(()=>{$(!1)},4e3)},ae=()=>{H(!0),setTimeout(()=>{H(!1)},4e3)};return i.jsx("div",{className:"min-h-screen bg-gray-50 py-6",children:i.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6",children:[i.jsx("div",{className:"mb-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Add New Property"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Enter essential property information to get started"})]}),i.jsxs("button",{onClick:R,className:"flex items-center gap-2 px-3 py-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-md transition-colors",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Cancel"]})]})}),u&&i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Unable to load property types"}),i.jsx("div",{className:"mt-2 text-sm text-red-700",children:i.jsx("p",{children:u})})]})]})}),s&&i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-4",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.728-.833-2.498 0L4.316 15.5C3.546 16.333 4.508 18 6.048 18z"})})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Geocoding Notice"}),i.jsxs("div",{className:"mt-2 text-sm text-yellow-700",children:[i.jsx("p",{children:s}),i.jsx("p",{className:"mt-1",children:"Don't worry - your property will still be created. You can manually enter coordinates later if needed."})]}),i.jsx("div",{className:"mt-3",children:i.jsx("button",{type:"button",onClick:l,className:"text-sm text-yellow-600 hover:text-yellow-500 underline",children:"Dismiss"})})]})]})}),i.jsxs("form",{onSubmit:D,className:"space-y-6",children:[i.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Property Type"}),i.jsx("span",{className:"text-red-500 text-sm",children:"*Required"})]}),i.jsx("div",{className:"max-w-md",children:i.jsx(N_,{label:"Property Record Type*",value:f.property_record_type_id,onChange:T=>y("property_record_type_id",T),options:c.map(T=>({id:T.id,label:T.label})),placeholder:d?"Loading...":c.length===0?"No record types available":"Select property type...",disabled:d||c.length===0,tabIndex:1,required:!0,defaultText:"Select Property Type"})})]}),i.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Property Details"})]}),i.jsxs("div",{className:"relative",children:[i.jsx("button",{type:"button",onClick:le,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-gray-500",title:"Pin current location",children:i.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})}),I&&i.jsx("div",{className:"absolute top-full right-0 mt-2 w-72 z-10",children:i.jsxs("div",{className:"bg-gray-900 text-white text-xs rounded-lg p-3 shadow-lg relative",children:[i.jsx("div",{className:"absolute bottom-full right-4 w-0 h-0 border-l-4 border-r-4 border-b-4 border-l-transparent border-r-transparent border-b-gray-900"}),i.jsx("div",{className:"font-medium text-yellow-200 mb-1",children:" Future Feature"}),i.jsx("p",{children:"This will drop your current location geocode to create an address and geocode from where your computer or phone are located."}),i.jsx("button",{onClick:()=>L(!1),className:"absolute top-1 right-1 text-gray-400 hover:text-white w-4 h-4 flex items-center justify-center",children:""})]})})]})]}),i.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[i.jsx(Ne,{label:"Property Name*",value:f.property_name,onChange:T=>y("property_name",T),placeholder:"Downtown Office Building",tabIndex:2,required:!0,defaultText:"Enter Property Name"}),i.jsx(Ne,{label:"Street Address*",value:f.address,onChange:T=>y("address",T),placeholder:"123 Main Street",tabIndex:3}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[i.jsx(cs,{label:"City*",value:f.city,onChange:T=>y("city",T),field:"city",placeholder:"San Francisco",tabIndex:4}),i.jsx(cs,{label:"State*",value:f.state,onChange:T=>y("state",T),field:"state",placeholder:"CA",tabIndex:5}),i.jsx(Ne,{label:"ZIP Code",value:f.zip,onChange:T=>y("zip",T),placeholder:"94105",tabIndex:6})]}),i.jsxs("div",{className:"flex items-end gap-4 mt-4",children:[i.jsx("div",{className:"flex-1",children:i.jsx(cs,{label:"Trade Area",value:f.trade_area,onChange:T=>y("trade_area",T),field:"trade_area",placeholder:"Downtown, Suburb, etc.",tabIndex:7})}),i.jsxs("div",{className:"relative pb-1",children:[i.jsxs("button",{type:"button",onClick:J,className:"flex items-center gap-2 px-3 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 text-sm rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-gray-500",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),"Verify Location"]}),P&&i.jsx("div",{className:"absolute bottom-full right-0 mb-2 w-64 z-10",children:i.jsxs("div",{className:"bg-gray-900 text-white text-xs rounded-lg p-3 shadow-lg relative",children:[i.jsx("div",{className:"absolute top-full right-4 w-0 h-0 border-l-4 border-r-4 border-t-4 border-l-transparent border-r-transparent border-t-gray-900"}),i.jsx("div",{className:"font-medium text-yellow-200 mb-1",children:" Future Feature"}),i.jsx("p",{children:"This will take you to a map where you can move the pin to the correct location and recode the address coordinates."}),i.jsx("button",{onClick:()=>A(!1),className:"absolute top-1 right-1 text-gray-400 hover:text-white w-4 h-4 flex items-center justify-center",children:""})]})})]})]})]})]}),f.property_record_type_id&&i.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})}),i.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Financial Information",v&&" (Land)",N&&" (Retail/Shopping)",!v&&!N&&" (Building)"]}),i.jsx("span",{className:"text-sm text-gray-500 ml-2",children:"(Optional - can be added later)"})]}),v&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i.jsx(pn,{label:"Asking Purchase Price",value:f.asking_purchase_price,onChange:T=>y("asking_purchase_price",T),helpText:"Land purchase price",colorScheme:"blue",showLarge:!0,tabIndex:8}),i.jsx(pn,{label:"Asking Ground Lease Price",value:f.asking_lease_price,onChange:T=>y("asking_lease_price",T),helpText:"Annual ground lease amount",colorScheme:"green",showLarge:!0,tabIndex:9}),i.jsx(Ne,{label:"Acres",value:f.acres,onChange:T=>y("acres",T),type:"number",placeholder:"5.25",inputMode:"decimal",tabIndex:10})]}),i.jsxs("div",{className:"flex justify-end relative",children:[i.jsxs("button",{type:"button",onClick:ae,className:"flex items-center gap-2 px-4 py-2 bg-green-50 text-green-700 rounded-md hover:bg-green-100 transition-colors text-sm font-medium focus:outline-none focus:ring-2 focus:ring-green-500",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Create Submit"]}),B&&i.jsx("div",{className:"absolute bottom-full right-0 mb-2 w-64 z-10",children:i.jsxs("div",{className:"bg-gray-900 text-white text-xs rounded-lg p-3 shadow-lg relative",children:[i.jsx("div",{className:"absolute top-full right-4 w-0 h-0 border-l-4 border-r-4 border-t-4 border-l-transparent border-r-transparent border-t-gray-900"}),i.jsx("div",{className:"font-medium text-green-200 mb-1",children:" Future Feature"}),i.jsx("p",{children:"This will create a site submit for this land property to track development prospects and opportunities."}),i.jsx("button",{onClick:()=>H(!1),className:"absolute top-1 right-1 text-gray-400 hover:text-white w-4 h-4 flex items-center justify-center",children:""})]})})]})]}),_&&i.jsx("div",{className:"space-y-4",children:i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:i.jsx(pn,{label:"Asking Lease Price",value:f.asking_lease_price,onChange:T=>y("asking_lease_price",T),helpText:"Annual lease amount",colorScheme:"green",showLarge:!0,tabIndex:8})})}),C&&i.jsxs("div",{className:"border-t border-gray-200 pt-4 mt-4",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Per Square Foot Rates"}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i.jsx(_c,{label:"Rent PSF",value:f.rent_psf,onChange:T=>y("rent_psf",T),helpText:"Base rent per square foot",tabIndex:9}),i.jsx(_c,{label:"NNN PSF",value:f.nnn_psf,onChange:T=>y("nnn_psf",T),helpText:"Triple net charges per square foot",tabIndex:10})]})]}),i.jsx("div",{className:"mt-4 p-3 bg-gray-50 rounded-md",children:i.jsx("p",{className:"text-sm text-gray-600",children:" Additional financial fields like square footage, occupancy rates, and detailed lease terms can be added in the detailed property view after creation."})})]}),!f.property_record_type_id&&i.jsxs("section",{className:"bg-gray-50 rounded-lg border border-gray-200 p-6",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})}),i.jsx("h3",{className:"text-lg font-medium text-gray-500",children:"Financial Information"})]}),i.jsx("p",{className:"text-sm text-gray-500",children:"Select a property record type above to see relevant financial fields."})]}),N&&i.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Shopping Center Units"})]}),i.jsxs("button",{type:"button",onClick:w,className:"flex items-center gap-2 px-3 py-2 bg-blue-50 text-blue-700 rounded-md hover:bg-blue-100 transition-colors text-sm",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Unit"]})]}),f.units.length===0?i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx("div",{className:"mb-2",children:i.jsx("svg",{className:"w-12 h-12 text-gray-300 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),i.jsx("p",{className:"text-sm",children:"No units added yet."}),i.jsx("p",{className:"text-xs mt-1 text-gray-400",children:'Use the "Add Unit" button to start adding units to this shopping center.'}),i.jsxs("div",{className:"mt-4 relative inline-block",children:[i.jsxs("button",{type:"button",onClick:se,className:"flex items-center gap-2 px-4 py-2 bg-green-50 text-green-700 rounded-md hover:bg-green-100 transition-colors text-sm font-medium focus:outline-none focus:ring-2 focus:ring-green-500",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Create Submit"]}),E&&i.jsx("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-64 z-10",children:i.jsxs("div",{className:"bg-gray-900 text-white text-xs rounded-lg p-3 shadow-lg relative",children:[i.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-l-transparent border-r-transparent border-t-gray-900"}),i.jsx("div",{className:"font-medium text-green-200 mb-1",children:" Future Feature"}),i.jsx("p",{children:"This will create a site submit on the property level for tracking prospects when no specific units are defined."}),i.jsx("button",{onClick:()=>$(!1),className:"absolute top-1 right-1 text-gray-400 hover:text-white w-4 h-4 flex items-center justify-center",children:""})]})})]})]}):i.jsx("div",{className:"space-y-4",children:f.units.map((T,ee)=>i.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsx("div",{className:"flex items-center gap-2",children:i.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Unit ",ee+1]})}),i.jsx("button",{type:"button",onClick:()=>g(T.id),className:"text-red-500 hover:text-red-700 text-lg font-bold",title:"Delete unit",children:""})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsx("div",{className:"md:col-span-2",children:i.jsx(Ne,{label:"Unit Name",value:T.property_unit_name,onChange:q=>b(T.id,"property_unit_name",q),placeholder:"e.g., Suite A, Space 101, etc.",tabIndex:11})}),i.jsx("div",{children:i.jsx(Ne,{label:"Unit Notes",value:T.unit_notes,onChange:q=>b(T.id,"unit_notes",q),placeholder:"Optional notes",multiline:!0,rows:1,tabIndex:15})}),i.jsx("div",{children:i.jsx(Ne,{label:"Square Feet",value:T.sqft,onChange:q=>b(T.id,"sqft",q),type:"number",placeholder:"1,200",inputMode:"numeric",tabIndex:12})}),i.jsx("div",{children:i.jsx(pn,{label:"Rent",value:T.rent,onChange:q=>b(T.id,"rent",q),helpText:"Unit rent amount",tabIndex:13})}),i.jsx("div",{children:i.jsx(pn,{label:"NNN",value:T.nnn,onChange:q=>b(T.id,"nnn",q),helpText:"Net Net Net charges",tabIndex:14})}),i.jsx("div",{className:"md:col-span-3",children:i.jsx(Ne,{label:"Lease Expiration Date",value:T.lease_expiration_date?new Date(T.lease_expiration_date).toISOString().split("T")[0]:null,onChange:q=>b(T.id,"lease_expiration_date",q?new Date(q).toISOString():null),type:"date",placeholder:"YYYY-MM-DD",tabIndex:16})})]}),i.jsxs("div",{className:"mt-4 pt-3 border-t border-gray-200",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Unit Features"}),i.jsxs("div",{className:"relative",children:[i.jsxs("button",{type:"button",onClick:()=>oe(T.id),className:"flex items-center gap-2 px-3 py-1.5 bg-green-50 text-green-700 rounded-md hover:bg-green-100 transition-colors text-xs font-medium focus:outline-none focus:ring-2 focus:ring-green-500",children:[i.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Create Submit"]}),F[T.id]&&i.jsx("div",{className:"absolute bottom-full right-0 mb-2 w-64 z-10",children:i.jsxs("div",{className:"bg-gray-900 text-white text-xs rounded-lg p-3 shadow-lg relative",children:[i.jsx("div",{className:"absolute top-full right-4 w-0 h-0 border-l-4 border-r-4 border-t-4 border-l-transparent border-r-transparent border-t-gray-900"}),i.jsx("div",{className:"font-medium text-green-200 mb-1",children:" Future Feature"}),i.jsx("p",{children:"This will create a site submit on the unit for tracking tenant prospects and submissions."}),i.jsx("button",{onClick:()=>U(q=>({...q,[T.id]:!1})),className:"absolute top-1 right-1 text-gray-400 hover:text-white w-4 h-4 flex items-center justify-center",children:""})]})})]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:T.patio,onChange:q=>b(T.id,"patio",q.target.checked),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Patio"})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:T.inline,onChange:q=>b(T.id,"inline",q.target.checked),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Inline"})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:T.end_cap,onChange:q=>b(T.id,"end_cap",q.target.checked),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"End Cap"})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:T.end_cap_drive_thru,onChange:q=>b(T.id,"end_cap_drive_thru",q.target.checked),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"End Cap Drive-Thru"})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:T.second_gen_restaurant,onChange:q=>b(T.id,"second_gen_restaurant",q.target.checked),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"2nd Gen Restaurant"})]})]})]})]},T.id))}),i.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-md",children:i.jsx("p",{className:"text-sm text-blue-700",children:" Units can be added now or later in the detailed property view. Adding units helps track individual tenant spaces and their lease details."})})]}),i.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Initial Notes"})]}),i.jsx("textarea",{value:f.property_notes,onChange:T=>y("property_notes",T.target.value),placeholder:"Add any initial notes about this property, market conditions, or other relevant information...",className:"w-full px-3 py-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base resize-none min-h-[100px]",tabIndex:10}),i.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"You can add more detailed notes and use quick templates after the property is created."})]}),i.jsxs("div",{className:"flex items-center justify-between pt-6 border-t border-gray-200",children:[i.jsxs("div",{className:"text-sm text-gray-500",children:[i.jsx("span",{className:"text-red-500",children:"*"})," Required fields: Property Record Type, Property Name, Address, City, State"]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("button",{type:"button",onClick:R,className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:"Cancel"}),i.jsxs("button",{type:"submit",disabled:t||n,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[(t||n)&&i.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),n?"Adding Location...":t?"Creating Property...":"Create Property"]})]})]})]}),i.jsx("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-md",children:i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsxs("svg",{className:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-medium text-blue-800",children:"Automatic Location Detection"}),i.jsx("div",{className:"text-xs text-blue-700 mt-1",children:"The system automatically converts your address into GPS coordinates for mapping and location features. This happens in the background and won't delay property creation."}),n&&i.jsxs("div",{className:"mt-2 flex items-center gap-2 text-blue-600",children:[i.jsx("div",{className:"w-3 h-3 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),i.jsx("span",{className:"text-xs",children:"Detecting location..."})]})]})]})})]})})},fd=()=>{const[e,t]=p.useState(!1),[r,n]=p.useState(null),s=p.useCallback(async(o,l={})=>{const{limit:c=10,types:d=["deal","client","contact","property","site_submit","assignment"],includeInactive:u=!1}=l;if(!o.trim())return[];console.log(` Starting search for: "${o}" with options:`,l),t(!0),n(null);const m=[],f=o.trim().toLowerCase();try{if(d.includes("deal")){console.log(" Searching deals...");const{data:w,error:b}=await M.from("deal").select(`
            *,
            client!client_id (client_name),
            deal_stage (label, sort_order),
            property (property_name, address, city, state)
          `).or(`deal_name.ilike.%${f}%,sf_broker.ilike.%${f}%,sf_address.ilike.%${f}%`).limit(Math.ceil(c/d.length));if(b)throw b;w&&(console.log(` Found ${w.length} deals:`,w),w.forEach(g=>{var k,S,D,R,P,A,I,L;const x=g.deal_name||"Unnamed Deal",v=x.toLowerCase().includes(f),N=(k=g.sf_broker)==null?void 0:k.toLowerCase().includes(f),_=(S=g.sf_address)==null?void 0:S.toLowerCase().includes(f);let C=0;x.toLowerCase().startsWith(f)?C+=10:v&&(C+=5),N&&(C+=3),_&&(C+=2);const j=[(D=g.property)==null?void 0:D.address,(R=g.property)==null?void 0:R.city,(P=g.property)==null?void 0:P.state].filter(Boolean).join(", ");m.push({id:g.id,type:"deal",title:x,subtitle:((A=g.client)==null?void 0:A.client_name)||"No Client",description:((I=g.property)==null?void 0:I.property_name)||j,metadata:((L=g.deal_stage)==null?void 0:L.label)||"No Stage",url:`/deal/${g.id}`,score:C})}))}if(d.includes("client")){const{data:w,error:b}=await M.from("client").select("*").or(`client_name.ilike.%${f}%,description.ilike.%${f}%,sf_client_type.ilike.%${f}%`).limit(Math.ceil(c/d.length));if(b)throw b;w&&w.forEach(g=>{var _,C;const x=g.client_name,v=x.toLowerCase().includes(f);let N=0;x.toLowerCase().startsWith(f)?N+=10:v&&(N+=5),(_=g.description)!=null&&_.toLowerCase().includes(f)&&(N+=4),(C=g.sf_client_type)!=null&&C.toLowerCase().includes(f)&&(N+=3),m.push({id:g.id,type:"client",title:x,subtitle:"Client",description:g.sf_client_type||g.description||"",metadata:g.website||"",url:`/client/${g.id}`,score:N})})}if(d.includes("contact")){const{data:w,error:b}=await M.from("contact").select(`
            *,
            client!client_id (client_name)
          `).or(`first_name.ilike.%${f}%,last_name.ilike.%${f}%,company.ilike.%${f}%,email.ilike.%${f}%,title.ilike.%${f}%`).limit(Math.ceil(c/d.length));if(b)throw b;w&&w.forEach(g=>{var k,S,D,R;const x=g.first_name||"",v=g.last_name||"",N=`${x} ${v}`.trim(),_=N||"Unnamed Contact";let C=0;x.toLowerCase().startsWith(f)||v.toLowerCase().startsWith(f)?C+=10:N.toLowerCase().includes(f)&&(C+=7),(k=g.company)!=null&&k.toLowerCase().includes(f)&&(C+=5),(S=g.email)!=null&&S.toLowerCase().includes(f)&&(C+=4),(D=g.title)!=null&&D.toLowerCase().includes(f)&&(C+=3);const j=[g.email,g.phone,g.mobile_phone].filter(Boolean)[0]||"";m.push({id:g.id,type:"contact",title:_,subtitle:g.company||g.title||"Contact",description:j,metadata:((R=g.client)==null?void 0:R.client_name)||g.source_type||"",url:`/contact/${g.id}`,score:C})})}if(d.includes("property")){const{data:w,error:b}=await M.from("property").select(`
            *,
            property_type (label),
            property_stage (label)
          `).or(`property_name.ilike.%${f}%,address.ilike.%${f}%,city.ilike.%${f}%,state.ilike.%${f}%,trade_area.ilike.%${f}%`).limit(Math.ceil(c/d.length));if(b)throw b;w&&w.forEach(g=>{var C,j,k,S,D,R;const x=g.property_name||"Unnamed Property",v=x.toLowerCase().includes(f);let N=0;x.toLowerCase().startsWith(f)?N+=10:v&&(N+=7),(C=g.address)!=null&&C.toLowerCase().includes(f)&&(N+=6),(j=g.city)!=null&&j.toLowerCase().includes(f)&&(N+=5),(k=g.state)!=null&&k.toLowerCase().includes(f)&&(N+=4),(S=g.trade_area)!=null&&S.toLowerCase().includes(f)&&(N+=3);const _=[g.address,g.city,g.state].filter(Boolean).join(", ");m.push({id:g.id,type:"property",title:x,subtitle:_||"Property",description:((D=g.property_type)==null?void 0:D.label)||g.trade_area||"",metadata:((R=g.property_stage)==null?void 0:R.label)||"",url:`/property/${g.id}`,score:N})})}if(d.includes("site_submit")){console.log(" Searching site submits...");const{data:w,error:b}=await M.from("site_submit").select(`
            *,
            client!client_id (client_name),
            property (property_name, address, city, state),
            property_unit (property_unit_name)
          `).or(`site_submit_name.ilike.%${f}%,sf_account.ilike.%${f}%,notes.ilike.%${f}%`).limit(Math.ceil(c/d.length));if(b)throw b;w&&(console.log(` Found ${w.length} site submits:`,w),w.forEach(g=>{var C,j,k,S,D,R,P;const x=g.site_submit_name||"Unnamed Site Submit",v=x.toLowerCase().includes(f);let N=0;x.toLowerCase().startsWith(f)?N+=10:v&&(N+=7),(C=g.sf_account)!=null&&C.toLowerCase().includes(f)&&(N+=5),(j=g.notes)!=null&&j.toLowerCase().includes(f)&&(N+=3);const _=((k=g.property)==null?void 0:k.property_name)||[(S=g.property)==null?void 0:S.address,(D=g.property)==null?void 0:D.city,(R=g.property)==null?void 0:R.state].filter(Boolean).join(", ");m.push({id:g.id,type:"site_submit",title:x,subtitle:((P=g.client)==null?void 0:P.client_name)||"No Client",description:_,metadata:"Site Submit",url:`/site-submit/${g.id}`,score:N})}))}if(d.includes("assignment")){console.log(" Searching assignments...");const{data:w,error:b}=await M.from("assignment").select("*").or(`assignment_name.ilike.%${f}%,site_criteria.ilike.%${f}%`).limit(Math.ceil(c/d.length));if(b)throw b;w&&w.forEach(g=>{var _;const x=g.assignment_name||"Unnamed Assignment",v=x.toLowerCase().includes(f);let N=0;x.toLowerCase().startsWith(f)?N+=10:v&&(N+=7),(_=g.site_criteria)!=null&&_.toLowerCase().includes(f)&&(N+=5),m.push({id:g.id,type:"assignment",title:x,subtitle:"Assignment",description:g.progress||"",metadata:"",url:`/assignment/${g.id}`,score:N})})}const h={deal:1,property:2,client:3,contact:4,site_submit:5,assignment:6};m.sort((w,b)=>{const g=(b.score||0)-(w.score||0);if(g!==0)return g;const x=h[w.type]-h[b.type];return x!==0?x:w.title.localeCompare(b.title)});const y=m.slice(0,c);return console.log(` Search completed. Found ${m.length} total results, returning ${y.length}`),console.log("Final results:",y),y}catch(h){return console.error(" Search error:",h),n(h instanceof Error?h.message:"Search failed"),[]}finally{t(!1)}},[]),a=p.useCallback(async(o,l,c=10)=>s(o,{types:[l],limit:c}),[s]);return{search:s,searchByType:a,loading:e,error:r}},_A=({isOpen:e,onClose:t,initialQuery:r=""})=>{const[n,s]=p.useState(r),[a,o]=p.useState(["deal","client","contact","property","site_submit"]),[l,c]=p.useState([]),[d,u]=p.useState(1),[m]=p.useState(20),{search:f,loading:h,error:y}=fd(),w=gr();p.useEffect(()=>{s(r)},[r]),p.useEffect(()=>{e&&n.trim()&&b()},[e,n,a]);const b=async()=>{if(!n.trim()){c([]);return}const S=await f(n,{types:a,limit:100});c(S),u(1)},g=S=>{o(D=>D.includes(S)?D.filter(R=>R!==S):[...D,S])},x=S=>{S.url&&(w(S.url),t())},v=S=>{switch(S){case"deal":return i.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})});case"client":return i.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})});case"contact":return i.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})});case"property":return i.jsx("svg",{className:"w-4 h-4 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})});case"site_submit":return i.jsx("svg",{className:"w-4 h-4 text-teal-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});default:return null}},N=S=>{switch(S){case"deal":return"Deals";case"client":return"Clients";case"contact":return"Contacts";case"property":return"Properties";case"site_submit":return"Site Submits";default:return""}},_=Math.ceil(l.length/m),C=(d-1)*m,j=C+m,k=l.slice(C,j);return e?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50",onClick:t}),i.jsxs("div",{className:"fixed inset-4 lg:inset-20 bg-white rounded-lg shadow-xl z-50 flex flex-col",children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[i.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Advanced Search"}),i.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:i.jsx("svg",{className:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsxs("div",{className:"p-6 border-b border-gray-200",children:[i.jsx("div",{className:"mb-4",children:i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m21 21-6-6m2-5a7 7 0 1 1-14 0 7 7 0 0 1 14 0Z"})})}),i.jsx("input",{type:"text",value:n,onChange:S=>s(S.target.value),onKeyDown:S=>{S.key==="Enter"&&b()},className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-lg",placeholder:"Search across all your data...",autoFocus:!0})]})}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx("span",{className:"text-sm font-medium text-gray-700 mr-2",children:"Search in:"}),["deal","client","contact","property","site_submit"].map(S=>i.jsxs("button",{onClick:()=>g(S),className:`inline-flex items-center px-3 py-1.5 rounded-full text-sm font-medium transition-colors ${a.includes(S)?"bg-blue-100 text-blue-800 border border-blue-200":"bg-gray-100 text-gray-700 border border-gray-200 hover:bg-gray-200"}`,children:[i.jsx("span",{className:"mr-1.5",children:v(S)}),N(S)]},S))]})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[h&&i.jsxs("div",{className:"flex items-center justify-center h-32",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),i.jsx("span",{className:"ml-3 text-gray-600",children:"Searching..."})]}),y&&i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:i.jsxs("div",{className:"text-red-700",children:[i.jsx("strong",{children:"Search Error:"})," ",y]})}),!h&&!y&&l.length===0&&n.trim()&&i.jsxs("div",{className:"text-center py-12",children:[i.jsx("svg",{className:"w-12 h-12 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No results found"}),i.jsx("p",{className:"text-gray-500",children:"Try adjusting your search terms or selected categories."})]}),!h&&!y&&k.length>0&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"mb-4 text-sm text-gray-600",children:["Showing ",C+1,"-",Math.min(j,l.length)," of ",l.length," results"]}),i.jsx("div",{className:"space-y-3",children:k.map(S=>i.jsx("div",{onClick:()=>x(S),className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors",children:i.jsxs("div",{className:"flex items-start space-x-3",children:[i.jsx("div",{className:"flex-shrink-0 mt-1",children:v(S.type)}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center justify-between mb-1",children:[i.jsx("h4",{className:"text-lg font-medium text-gray-900 truncate",children:S.title}),i.jsx("span",{className:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:N(S.type).slice(0,-1)})]}),S.subtitle&&i.jsx("p",{className:"text-sm text-gray-600 mb-1",children:S.subtitle}),i.jsxs("div",{className:"flex items-center justify-between",children:[S.description&&i.jsx("p",{className:"text-sm text-gray-500 truncate",children:S.description}),S.metadata&&i.jsx("span",{className:"ml-2 text-sm text-gray-400 truncate",children:S.metadata})]})]})]})},`${S.type}-${S.id}`))}),_>1&&i.jsxs("div",{className:"mt-6 flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-gray-500",children:["Page ",d," of ",_]}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{onClick:()=>u(S=>Math.max(1,S-1)),disabled:d===1,className:"px-3 py-1.5 text-sm border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),i.jsx("button",{onClick:()=>u(S=>Math.min(_,S+1)),disabled:d===_,className:"px-3 py-1.5 text-sm border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]})]})]}):null},S_=({placeholder:e="Search deals, clients, contacts, properties, site submits, assignments...",className:t="",onSelect:r})=>{const[n,s]=p.useState(""),[a,o]=p.useState([]),[l,c]=p.useState(!1),[d,u]=p.useState(-1),[m,f]=p.useState(!1),{search:h,loading:y}=fd(),w=p.useRef(null),b=p.useRef(null),g=gr();p.useEffect(()=>{(async()=>{try{console.log(" Testing database connectivity...");const{data:k,error:S}=await M.from("deal").select("id, deal_name").limit(1);S?console.error(" Database connection error:",S):console.log(" Database connected successfully, sample data:",k)}catch(k){console.error(" Database test failed:",k)}})()},[]),p.useEffect(()=>{if(console.log(` MasterSearchBox query changed: "${n}"`),!n.trim()){console.log(" Empty query, clearing results"),o([]),c(!1);return}console.log(` Setting up debounced search for: "${n}"`);const j=setTimeout(async()=>{console.log(` Executing search for: "${n}"`);try{const k=await h(n,{limit:10});console.log(` MasterSearchBox received ${k.length} results:`,k),o(k),c(k.length>0)}catch(k){console.error(" Search failed in MasterSearchBox:",k)}},300);return()=>{console.log(` Clearing timeout for: "${n}"`),clearTimeout(j)}},[n,h]),p.useEffect(()=>{const j=k=>{w.current&&!w.current.contains(k.target)&&(c(!1),u(-1))};return document.addEventListener("mousedown",j),()=>document.removeEventListener("mousedown",j)},[]);const x=j=>{s(j.target.value),u(-1)},v=j=>{var k;if(!(!l||a.length===0))switch(j.key){case"ArrowDown":j.preventDefault(),u(S=>S<a.length-1?S+1:S);break;case"ArrowUp":j.preventDefault(),u(S=>S>0?S-1:-1);break;case"Enter":j.preventDefault(),j.ctrlKey||j.metaKey?(f(!0),c(!1)):d>=0?N(a[d]):a.length>0&&N(a[0]);break;case"Escape":c(!1),u(-1),(k=b.current)==null||k.blur();break}},N=j=>{s(j.title),c(!1),u(-1),r?r(j):j.url&&g(j.url)},_=j=>{switch(j){case"deal":return i.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})});case"client":return i.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})});case"contact":return i.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})});case"property":return i.jsx("svg",{className:"w-4 h-4 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})});case"site_submit":return i.jsx("svg",{className:"w-4 h-4 text-teal-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});default:return i.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}},C=j=>{switch(j){case"deal":return"Deal";case"client":return"Client";case"contact":return"Contact";case"property":return"Property";case"site_submit":return"Site Submit";default:return""}};return i.jsxs("div",{ref:w,className:`relative ${t}`,children:[i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m21 21-6-6m2-5a7 7 0 1 1-14 0 7 7 0 0 1 14 0Z"})})}),i.jsx("input",{ref:b,type:"text",value:n,onChange:x,onKeyDown:v,onFocus:()=>{a.length>0&&c(!0)},className:"block w-full pl-9 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:e}),y&&i.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})})]}),l&&a.length>0&&i.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-md shadow-lg max-h-96 overflow-y-auto",children:[a.map((j,k)=>i.jsx("div",{className:`px-4 py-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 ${k===d?"bg-blue-50":""}`,onClick:()=>N(j),children:i.jsxs("div",{className:"flex items-start space-x-3",children:[i.jsx("div",{className:"flex-shrink-0 mt-0.5",children:_(j.type)}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:j.title}),i.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800",children:C(j.type)})]}),j.subtitle&&i.jsx("p",{className:"text-sm text-gray-600 truncate",children:j.subtitle}),i.jsxs("div",{className:"flex items-center justify-between mt-1",children:[j.description&&i.jsx("p",{className:"text-xs text-gray-500 truncate",children:j.description}),j.metadata&&i.jsx("span",{className:"ml-2 text-xs text-gray-400 truncate",children:j.metadata})]})]})]})},`${j.type}-${j.id}`)),i.jsxs("div",{className:"px-4 py-2 border-t border-gray-200 bg-gray-50",children:[i.jsx("button",{onClick:()=>{f(!0),c(!1)},className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:"View all results in advanced search"}),i.jsx("span",{className:"text-xs text-gray-500 ml-2",children:"(Ctrl+Enter)"})]})]}),l&&a.length===0&&n.trim()&&!y&&i.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-md shadow-lg",children:[i.jsxs("div",{className:"px-4 py-3 text-sm text-gray-500 text-center",children:['No results found for "',n,'"']}),i.jsx("div",{className:"px-4 py-2 border-t border-gray-200 bg-gray-50",children:i.jsx("button",{onClick:()=>{f(!0),c(!1)},className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:"Try advanced search"})})]}),i.jsx(_A,{isOpen:m,onClose:()=>f(!1),initialQuery:n})]})},rl=({isOpen:e,onClose:t,title:r,searchType:n,onSearch:s,onSelect:a})=>{const[o,l]=p.useState(""),[c,d]=p.useState([]),[u,m]=p.useState(!1),[f,h]=p.useState(-1),y=p.useRef(null);p.useEffect(()=>{e&&(setTimeout(()=>{var x;(x=y.current)==null||x.focus()},100),l(""),d([]),h(-1))},[e]),p.useEffect(()=>{if(!o.trim()){d([]);return}m(!0);const x=setTimeout(async()=>{try{const v=await s(o);d(v),h(-1)}catch(v){console.error("Search error:",v),d([])}finally{m(!1)}},300);return()=>clearTimeout(x)},[o,s]);const w=x=>{if(c.length)switch(x.key){case"ArrowDown":x.preventDefault(),h(v=>v<c.length-1?v+1:v);break;case"ArrowUp":x.preventDefault(),h(v=>v>0?v-1:-1);break;case"Enter":x.preventDefault(),f>=0?b(c[f]):c.length>0&&b(c[0]);break;case"Escape":t();break}},b=x=>{a(x)},g=x=>{switch(x){case"deal":return i.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})});case"contact":return i.jsx("svg",{className:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})});case"property":return i.jsx("svg",{className:"w-5 h-5 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})});default:return i.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}};return e?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50",onClick:t}),i.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:i.jsx("div",{className:"flex min-h-full items-start justify-center p-4 text-center sm:p-0",children:i.jsxs("div",{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-2xl",children:[i.jsx("div",{className:"bg-white px-6 py-4 border-b border-gray-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:r}),i.jsxs("button",{onClick:t,className:"rounded-md bg-white text-gray-400 hover:text-gray-500 focus:outline-none",children:[i.jsx("span",{className:"sr-only",children:"Close"}),i.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})]})]})}),i.jsx("div",{className:"px-6 py-4",children:i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m21 21-6-6m2-5a7 7 0 1 1-14 0 7 7 0 0 1 14 0Z"})})}),i.jsx("input",{ref:y,type:"text",value:o,onChange:x=>l(x.target.value),onKeyDown:w,className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 text-lg",placeholder:`Search ${n}s...`}),u&&i.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:i.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-500"})})]})}),i.jsxs("div",{className:"px-6 pb-6",children:[o.trim()&&!u&&c.length===0&&i.jsxs("div",{className:"text-center py-8 text-gray-500",children:['No results found for "',o,'"']}),c.length>0&&i.jsx("div",{className:"max-h-96 overflow-y-auto",children:i.jsx("div",{className:"space-y-2",children:c.map((x,v)=>i.jsx("div",{className:`p-4 border border-gray-200 rounded-lg cursor-pointer transition-colors ${v===f?"bg-blue-50 border-blue-200":"hover:bg-gray-50"}`,onClick:()=>b(x),children:i.jsxs("div",{className:"flex items-start space-x-3",children:[i.jsx("div",{className:"flex-shrink-0 mt-0.5",children:g(x.type)}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("p",{className:"text-base font-medium text-gray-900 truncate",children:x.title}),i.jsx("span",{className:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 capitalize",children:x.type})]}),x.subtitle&&i.jsx("p",{className:"text-sm text-gray-600 truncate mt-1",children:x.subtitle}),i.jsxs("div",{className:"flex items-center justify-between mt-1",children:[x.description&&i.jsx("p",{className:"text-xs text-gray-500 truncate",children:x.description}),x.metadata&&i.jsx("span",{className:"ml-2 text-xs text-gray-400 truncate",children:x.metadata})]})]})]})},`${x.type}-${x.id}`))})})]}),i.jsx("div",{className:"bg-gray-50 px-6 py-3",children:i.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-500",children:[i.jsx("span",{children:c.length>0&&`${c.length} result${c.length===1?"":"s"} found`}),i.jsx("span",{children:"Press  to navigate, Enter to select, Esc to close"})]})})]})})})]}):null},nl=({title:e,items:t})=>{const[r,n]=p.useState(!1),s=p.useRef(null);return p.useEffect(()=>{const a=o=>{s.current&&!s.current.contains(o.target)&&n(!1)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[]),i.jsxs("div",{className:"relative",ref:s,children:[i.jsxs("button",{onClick:()=>n(!r),className:"flex items-center px-4 py-2 rounded hover:bg-blue-100 transition-colors",children:[e,i.jsx("svg",{className:`w-4 h-4 ml-1 transition-transform ${r?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),r&&i.jsx("div",{className:"absolute left-0 mt-2 w-48 bg-white border border-gray-200 rounded-md shadow-lg z-50",children:i.jsx("div",{className:"py-1",children:t.map((a,o)=>i.jsx("button",{onClick:()=>{a.action(),n(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors",children:a.label},o))})})]})};function jA(){const e=pr(),t=gr(),{user:r,signOut:n}=mC(),{searchByType:s}=fd(),[a,o]=p.useState({properties:!1,contacts:!1,deals:!1,assignments:!1}),l=y=>`px-4 py-2 rounded hover:bg-blue-100 ${e.pathname===y?"bg-blue-200 font-semibold":""}`,c=async()=>{await n()},d=async(y,w)=>{if(!y.trim())return[];try{return await s(y,w,20)}catch(b){return console.error(`Error searching ${w}:`,b),[]}},u=[{label:"Add New Property",action:()=>t("/property/new")},{label:"Search Properties",action:()=>o(y=>({...y,properties:!0}))}],m=[{label:"Add New Contact",action:()=>t("/contact/new")},{label:"Search Contacts",action:()=>o(y=>({...y,contacts:!0}))}],f=[{label:"Add New Deal",action:()=>t("/deal/new")},{label:"Search Deals",action:()=>o(y=>({...y,deals:!0}))}],h=[{label:"Add New Assignment",action:()=>t("/assignment/new")},{label:"Search Assignments",action:()=>o(y=>({...y,assignments:!0}))}];return i.jsxs("nav",{className:"bg-white shadow p-4",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx(Uc,{to:"/master-pipeline",className:l("/master-pipeline"),children:"Master Pipeline"}),i.jsx(nl,{title:"Properties",items:u}),i.jsx(nl,{title:"Contacts",items:m}),i.jsx(nl,{title:"Deals",items:f}),i.jsx(nl,{title:"Assignments",items:h})]}),i.jsx("div",{className:"flex-1 max-w-2xl mx-8",children:i.jsx(S_,{})}),r&&i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx("span",{className:"text-sm text-gray-600",children:r.email}),i.jsx("button",{onClick:c,className:"px-3 py-1 text-sm bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"Sign Out"})]})]}),a.properties&&i.jsx(rl,{isOpen:a.properties,onClose:()=>o(y=>({...y,properties:!1})),title:"Search Properties",searchType:"property",onSearch:y=>d(y,"property"),onSelect:y=>{t(y.url||"/"),o(w=>({...w,properties:!1}))}}),a.contacts&&i.jsx(rl,{isOpen:a.contacts,onClose:()=>o(y=>({...y,contacts:!1})),title:"Search Contacts",searchType:"contact",onSearch:y=>d(y,"contact"),onSelect:y=>{t(y.url||"/"),o(w=>({...w,contacts:!1}))}}),a.deals&&i.jsx(rl,{isOpen:a.deals,onClose:()=>o(y=>({...y,deals:!1})),title:"Search Deals",searchType:"deal",onSearch:y=>d(y,"deal"),onSelect:y=>{t(y.url||"/"),o(w=>({...w,deals:!1}))}}),a.assignments&&i.jsx(rl,{isOpen:a.assignments,onClose:()=>o(y=>({...y,assignments:!1})),title:"Search Assignments",searchType:"assignment",onSearch:y=>d(y,"assignment"),onSelect:y=>{t(y.url||"/"),o(w=>({...w,assignments:!1}))}})]})}const NA=()=>{const e=t=>{console.log("Selected search result:",t),alert(`Selected: ${t.title} (${t.type})`)};return i.jsx("div",{className:"min-h-screen bg-gray-100 p-8",children:i.jsxs("div",{className:"max-w-4xl mx-auto",children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Master Search Test Page"}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-8",children:[i.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Search Features"}),i.jsxs("ul",{className:"list-disc list-inside space-y-2 text-gray-700 mb-6",children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Real-time Search:"})," As you type, results appear instantly"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Multi-entity Search:"})," Searches across Deals, Clients, Contacts, Properties, and Site Submits"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Intelligent Ranking:"})," Results are ranked by relevance and type priority"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Keyboard Navigation:"})," Use arrow keys to navigate, Enter to select"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Advanced Search:"})," Press Ctrl+Enter or click the link for detailed search"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Quick Access:"})," Click any result to navigate to that item"]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium",children:"Try searching for:"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"font-medium text-green-600",children:"Deals:"}),i.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-1",children:[i.jsx("li",{children:"Deal names"}),i.jsx("li",{children:"Account names"}),i.jsx("li",{children:"Deal notes"})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"font-medium text-blue-600",children:"Clients:"}),i.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-1",children:[i.jsx("li",{children:"Client names"}),i.jsx("li",{children:"Account names"}),i.jsx("li",{children:"Client types"})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"font-medium text-purple-600",children:"Contacts:"}),i.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-1",children:[i.jsx("li",{children:"First/last names"}),i.jsx("li",{children:"Company names"}),i.jsx("li",{children:"Email addresses"}),i.jsx("li",{children:"Job titles"})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"font-medium text-orange-600",children:"Properties:"}),i.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-1",children:[i.jsx("li",{children:"Property names"}),i.jsx("li",{children:"Street addresses"}),i.jsx("li",{children:"Cities and states"}),i.jsx("li",{children:"Trade areas"})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"font-medium text-teal-600",children:"Site Submits:"}),i.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-1",children:[i.jsx("li",{children:"Submit names"}),i.jsx("li",{children:"Account names"}),i.jsx("li",{children:"Submit notes"})]})]})]})]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[i.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Test the Search"}),i.jsx(S_,{onSelect:e,placeholder:"Try searching for anything...",className:"w-full"}),i.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[i.jsx("h3",{className:"font-medium mb-2",children:"Keyboard shortcuts:"}),i.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[i.jsxs("li",{children:[i.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-200 rounded text-xs",children:"/"})," Navigate results"]}),i.jsxs("li",{children:[i.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-200 rounded text-xs",children:"Enter"})," Select result"]}),i.jsxs("li",{children:[i.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-200 rounded text-xs",children:"Ctrl+Enter"})," Open advanced search"]}),i.jsxs("li",{children:[i.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-200 rounded text-xs",children:"Esc"})," Close dropdown"]})]})]})]})]})})},kA=()=>{const[e,t]=p.useState(""),[r,n]=p.useState([]),[s,a]=p.useState(!1),[o,l]=p.useState(null),c=async()=>{if(e.trim()){a(!0),l(null);try{console.log("Simple search for:",e);const{data:d,error:u}=await M.from("deal").select("id, deal_name, created_at").ilike("deal_name",`%${e}%`).limit(5);if(u)throw u;console.log("Simple search results:",d),n(d||[])}catch(d){console.error("Simple search error:",d),l(d instanceof Error?d.message:"Search failed")}finally{a(!1)}}};return i.jsxs("div",{className:"p-6 bg-white rounded-lg shadow",children:[i.jsx("h2",{className:"text-xl font-bold mb-4",children:"Simple Search Test"}),i.jsxs("div",{className:"flex space-x-4 mb-4",children:[i.jsx("input",{type:"text",value:e,onChange:d=>t(d.target.value),onKeyDown:d=>d.key==="Enter"&&c(),placeholder:"Search deals...",className:"flex-1 px-3 py-2 border rounded-md"}),i.jsx("button",{onClick:c,disabled:s,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:s?"Searching...":"Search"})]}),o&&i.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md mb-4",children:i.jsxs("p",{className:"text-red-700",children:["Error: ",o]})}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("h3",{className:"font-medium",children:["Results (",r.length,"):"]}),r.map(d=>i.jsxs("div",{className:"p-3 bg-gray-50 rounded border",children:[i.jsx("div",{className:"font-medium",children:d.deal_name||"Unnamed Deal"}),i.jsxs("div",{className:"text-sm text-gray-600",children:["ID: ",d.id]}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Created: ",d.created_at]})]},d.id)),r.length===0&&e&&!s&&i.jsx("div",{className:"text-gray-500",children:"No results found"})]})]})},SA=()=>{const[e,t]=p.useState(""),[r,n]=p.useState({}),{search:s,loading:a,error:o}=fd();p.useEffect(()=>{(async()=>{var d,u,m,f,h;try{console.log("Testing database connections...");const[y,w,b,g,x]=await Promise.all([M.from("deal").select("id, deal_name").limit(3),M.from("client").select("id, client_name").limit(3),M.from("contact").select("id, first_name, last_name").limit(3),M.from("property").select("id, property_name").limit(3),M.from("site_submit").select("id, site_submit_name").limit(3)]);console.log("Database test results:",{deals:y,clients:w,contacts:b,properties:g,siteSubmits:x}),n({deals:{count:((d=y.data)==null?void 0:d.length)||0,error:y.error,sample:y.data},clients:{count:((u=w.data)==null?void 0:u.length)||0,error:w.error,sample:w.data},contacts:{count:((m=b.data)==null?void 0:m.length)||0,error:b.error,sample:b.data},properties:{count:((f=g.data)==null?void 0:f.length)||0,error:g.error,sample:g.data},siteSubmits:{count:((h=x.data)==null?void 0:h.length)||0,error:x.error,sample:x.data}})}catch(y){console.error("Database test failed:",y),n({error:y instanceof Error?y.message:"Unknown error"})}})()},[]);const l=async()=>{if(e.trim()){console.log(`Testing search for: "${e}"`);try{const c=await s(e,{limit:5});console.log("Search results:",c),alert(`Found ${c.length} results. Check console for details.`)}catch(c){console.error("Search test failed:",c),alert(`Search failed: ${c instanceof Error?c.message:"Unknown error"}`)}}};return i.jsx("div",{className:"min-h-screen bg-gray-100 p-8",children:i.jsxs("div",{className:"max-w-4xl mx-auto",children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Search Debug Page"}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Database Connection Test"}),i.jsx("div",{className:"space-y-4",children:Object.entries(r).map(([c,d])=>i.jsxs("div",{className:"border-l-4 border-blue-500 pl-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h3",{className:"font-medium capitalize",children:c}),i.jsx("span",{className:`px-2 py-1 rounded text-xs ${d!=null&&d.error?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:d!=null&&d.error?"Error":`${(d==null?void 0:d.count)||0} records`})]}),(d==null?void 0:d.error)&&i.jsx("p",{className:"text-sm text-red-600 mt-1",children:d.error.message||JSON.stringify(d.error)}),(d==null?void 0:d.sample)&&d.sample.length>0&&i.jsxs("div",{className:"mt-2",children:[i.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Sample data:"}),i.jsx("pre",{className:"text-xs bg-gray-50 p-2 rounded overflow-x-auto",children:JSON.stringify(d.sample,null,2)})]})]},c))})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Manual Search Test"}),i.jsxs("div",{className:"flex space-x-4 mb-4",children:[i.jsx("input",{type:"text",value:e,onChange:c=>t(c.target.value),placeholder:"Enter search term...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),i.jsx("button",{onClick:l,disabled:a,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:a?"Searching...":"Test Search"})]}),o&&i.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:i.jsxs("p",{className:"text-red-700",children:["Search Error: ",o]})})]}),i.jsx(kA,{}),i.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 mt-6",children:[i.jsx("h2",{className:"text-xl font-semibold mb-4 text-yellow-800",children:"Debug Instructions"}),i.jsxs("ul",{className:"space-y-2 text-yellow-700",children:[i.jsx("li",{children:"1. Open your browser's developer console (F12)"}),i.jsx("li",{children:"2. Check the database connection results above"}),i.jsx("li",{children:"3. Try the manual search test"}),i.jsx("li",{children:"4. Try the simple search test"}),i.jsx("li",{children:"5. Look for any error messages in the console"}),i.jsx("li",{children:"6. Check network tab for failed API requests"})]})]})]})})};function CA(){return i.jsx(hC,{children:i.jsx(pC,{children:i.jsxs("div",{className:"min-h-screen bg-gray-100",children:[i.jsx(jA,{}),i.jsxs(yk,{children:[i.jsx(Et,{path:"/",element:i.jsx(gk,{to:"/master-pipeline",replace:!0})}),i.jsx(Et,{path:"/master-pipeline",element:i.jsx(BT,{})}),i.jsx(Et,{path:"/deal/new",element:i.jsx(mx,{})}),i.jsx(Et,{path:"/deal/:dealId",element:i.jsx(mx,{})}),i.jsx(Et,{path:"/assignment/new",element:i.jsx(px,{})}),i.jsx(Et,{path:"/assignment/:assignmentId",element:i.jsx(px,{})}),i.jsx(Et,{path:"/property/new",element:i.jsx(wA,{})}),i.jsx(Et,{path:"/property/:propertyId",element:i.jsx(uA,{})}),i.jsx(Et,{path:"/contact/:contactId",element:i.jsx(fA,{})}),i.jsx(Et,{path:"/site-submit/:siteSubmitId",element:i.jsx(mA,{})}),i.jsx(Et,{path:"/search-test",element:i.jsx(NA,{})}),i.jsx(Et,{path:"/search-debug",element:i.jsx(SA,{})})]})]})})})}Pu.createRoot(document.getElementById("root")).render(i.jsx(O.StrictMode,{children:i.jsx(Wk,{children:i.jsx(CA,{})})}));
